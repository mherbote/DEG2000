'S Y S   2 . 1 3'	MACRO-80 3.44	09-Dec-81	PAGE	1


                                            TITLE   'S Y S   2 . 1 3'
                                            PAGE    87
'S Y S   2 . 1 3'	MACRO-80 3.44	09-Dec-81	PAGE	1-1


                                
                                
                                ; Verbindungsadressen zu BASIC
  0150                          BC.D017     EQU     00150H
  015E                          BC.D024     EQU     0015EH
  0160                          BC.D025     EQU     00160H
  0162                          BC.D026     EQU     00162H
  019A                          BC.D047     EQU     0019AH
  01AB                          BC.D058     EQU     001ABH
  0300                          BC.INIT     EQU     00300H
  0303                          BC.RECOV    EQU     00303H
  0306                          BC.USR      EQU     00306H
  0309                          BC.CIN      EQU     00309H
  030C                          BC.RIV      EQU     0030CH
  030F                          BC.CON      EQU     0030FH
  0312                          BC.WRTV     EQU     00312H
  0315                          BC.LISTX    EQU     00315H
  0318                          BC.CSTSX    EQU     00318H
  0327                          BC.PAR      EQU     00327H
  032A                          BC.RUCK     EQU     0032AH
  03A6                          BC.GRF1     EQU     003A6H
  03C6                          BC.SVC1     EQU     003C6H
  0451                          BC.C006     EQU     00451H
  0948                          BC.C032     EQU     00948H
  171B                          BC.C091     EQU     0171BH
  1F40                          BC.CALL1    EQU     01F40H
  1F4B                          BC.CALL2    EQU     01F4BH
  1F57                          BC.D101     EQU     01F57H
  2CC0                          BC.GRF2     EQU     02CC0H
  2D98                          BC.SVC2     EQU     02D98H
  2FB7                          BC.D131     EQU     02FB7H
  3010                          BC.RECOV1   EQU     03010H
  30B2                          BC.ANF      EQU     030B2H
                                
                                ; Verbindungsadressen zu SYS 1.2
  4000                          S0.TINIT    EQU     04000H              ; Initialisierung der Tastatur
  4003                          S0.TA1      EQU     04003H              ; U_Int - Abfrage
  4006                          S0.TA2      EQU     04006H              ; Tastencode-Eingabe
  400C                          S0.TFE      EQU     0400CH              ; Warten auf Tastenende
  400F                          S0.TIM      EQU     0400FH              ; Ansteuerung der INS_MOD - Diode
  4012                          S0.TEM      EQU     04012H              ; Ansteuerung der Ebenen  - Dioden
  4015                          S0.TBEL     EQU     04015H              ; Ansteuerung der Fehleranzeigen
                                
  4046                          S0.MRES     EQU     04046H              ; Drucker - Initialisierung
  4049                          S0.PRIO     EQU     04049H              ; Ausgabe eines Zeichens an den Drucker
                                
  4069                          KR.BRKMB    EQU     04069H              ; Steuerteil der Kassettenroutine Emulator
  2B03                          UB.KTAB     EQU     02B03H              ; Steuertabelle Kassette SYS 1.2
                                
                                            .PHASE  0B000H-20H
                                ;--------------------------\            ; Vorspann fuer BIN-Datei
  AFE0    F0                                DB      0F0H                ; Startbyte ---> weitere BIN-Datei
  AFE1    53 31 32                          DB      'S12'               ;                Name der BIN-Datei
  AFE4                                      DS      25,0
  AFFD    02                                DB      002H                ; HS-Bereich : 2
  AFFE    B000                              DW      0B000H              ; Ladeadresse: B000H
                                ;--------------------------/
                                
                                        ;     INCLUDE KS01.MAC
                                        ;     INCLUDE K209.MAC
                                        ;     INCLUDE MS05.MAC
                                        ;     INCLUDE TS06.MAC
                                        ;     INCLUDE S213.MAC
                         C                  INCLUDE Speicher.MAC
                         C      ;           PN      KS
                         C                  TITLE   'Arbeitsbereich zur Geraetebedienroutine KMBG'
                         C                  PAGE
'Arbeitsbereich zur Geraetebedienroutine KMBG'	MACRO-80 3.44	09-Dec-81	PAGE	1-2


                         C      
                         C      ;****************************************************************
                         C      ;*               Arbeitsbereich zur Geraetebedienroutine KMBG   *
                         C      ;****************************************************************
  B000    0000           C      KS.AEATB:   DW      0                   ;Adresse E/A-Tabelle
  B002    0000           C      KS.PZAUS:   DW      0                   ;Pufferzeiger Ausgabe
  B004    0000           C      KS.PZEIN:   DW      0                   ;Pufferzeiger Eingabe
  B006    0000           C      KS.ZAUS:    DW      0                   ;Zaehler Ausgabe
  B008    0000           C      KS.ZEIN:    DW      0                   ;Zaehler Eingabe
  B00A    00             C      KS.Z1:      DB      0                   ;Zaehler Schreib-/Lese wdhg.
  B00B    00             C      KS.Z2:      DB      0                   ;Zaehler Blocklueckenverl.
  B00C    0000           C      KS.CRCZ:    DW      0                   ;CRC-Zeichen
  B00E    00             C      KS.FEHLZ:   DB      0                   ;Interner Fehleranzeiger
                         C      ;****************************************************************
                         C      ;*               Bedeutung des internen Fehleranzeigers         *
                         C      ;*               Bit     Fehler                                 *
                         C      ;*               -----------------------------------------------*
                         C      ;*               0     kein Echosignal vom Eingabekanal bei RAW *
                         C      ;*               1     letzter Interrupt nicht gekommen bei RAW *
                         C      ;*               2     Status waehrend der Datenuebertragung    *
                         C      ;*               3     CRC-Zeichen fehlerhaft beim Lesen        *
                         C      ;*               4     RAW-Fehler                               *
                         C      ;****************************************************************
  B00F    0000           C      KS.POS:     DW      0                   ;Position des Fehlers im Datensatz
  B011    00             C      KS.SDAT:    DB      0                   ;Solldaten
  B012    00             C      KS.IDAT:    DB      0                   ;Istdaten
  B013                   C      KS.PUFFS:   DS      260,0               ;Pufferspeicher
                         C      ;****************************************************************
                         C      ;*               Arbeitszellen fuer CRC-Routine                 *
                         C      ;****************************************************************
  B117    00             C      KS.KOMDO:   DB      0                   ;Kommando
  B118    00             C      KS.ZEITK:   DB      0                   ;Zeitkonstante
  B119    0000           C      KS.ADR:     DW      0                   ;Adresse
  B11B    00             C      KS.CONTR:   DB      0                   ;Ereigniskontrolle
                         C      ;
                         C      ;           END
                         C      ;           PN      K209
                         C                  TITLE   'Steuervektor zum Programm K1'
                         C                  PAGE
'Steuervektor zum Programm K1'	MACRO-80 3.44	09-Dec-81	PAGE	1-3


                         C      
                         C      ;****************************************************************
                         C      ;*               Steuervektor zum Programm K1                   *
                         C      ;*  Version      -----------------------------------------------*
                         C      ;*               Programmierer: M. Herbote --- K EAW  ZFT (WFT) *
                         C      ;*  V 2 . 1      -----------------------------------------------*
                         C      ;*               Stand        : 24.November 1983                *
                         C      ;****************************************************************
                         C      
  B11C    0000           C      K2.RCZ:     DW      0                   ;record - counter
  B11E    0000           C      K2.BLK:     DW      0                   ;block  - counter
  B120    0000           C      K2.BLZ:     DW      0                   ;aktuelle Blocklaenge Text
  B122    0000           C      K2.RCZB:    DW      0                   ;bearbeitete Satzanzahl
  B124    0000           C      K2.TXOP:    DW      0                   ;aktuelle Adresse Textanfang
  B126    0000           C      K2.TXANF:   DW      0                   ;Adresse  Textanfang
  B128    0000           C      K2.TXEND:   DW      0                   ;Adresse  Textende
  B12A    0000           C      K2.GNW1:    DW      0                   ;Adresse  Geraetesatzzaehler
  B12C    0000           C      K2.PTADR:   DW      0                   ;Anzahl zu suchender BM
  B12E    0000           C      K2.ADREA:   DW      0                   ;Adresse  E/A-Tabelle
  B130    0000           C      K2.GADR:    DW      0                   ;Geraeteadresse
  B132    0000           C      K2.FKADR:   DW      0                   ;Fehlerausschriftadresse
  B134    0000           C      K2.SKADR:   DW      0                   ;Statusausschriftadresse
  B136    0000           C      K2.FRADR:   DW      0                   ;Rueckkehradresse bei Fehler
  B138    0000           C      K2.LRECL:   DW      0                   ;physische Satzlaenge
                         C      
  B13A                   C      K2.ADRK:    DS      40,0
  B162                   C      K2.RBER:    DS      40,0                ;Rettebereich Monitorsteuervekor
                         C      
                         C      ;           END
                         C      ;           PN      MS05
                         C                  TITLE   'Steuervektor Monitorroutine'
                         C                  PAGE
'Steuervektor Monitorroutine'	MACRO-80 3.44	09-Dec-81	PAGE	1-4


                         C      
                         C      ;****************************************************************
                         C      ;*               Steuervektor Monitorroutine                    *
                         C      ;****************************************************************
  B18A    00             C      MS.ZPOL:    DB      0                   ;Zeilennr.  Leseposition
  B18B    00             C      MS.SPOL:    DB      0                   ;Spaltennr. Leseposition
  B18C    00             C      MS.ZPOS:    DB      0                   ;Zeilennr.  Schreibposition
  B18D    00             C      MS.SPOS:    DB      0                   ;Spaltennr. Schreibposition
  B18E    00             C      MS.ZMIN:    DB      0                   ;Merker Anfangszeile
  B18F    00             C      MS.SMIN:    DB      0                   ;Merker Anfangsspalte
  B190    00             C      MS.ZMAX:    DB      0                   ;Merker Endzeile
  B191    00             C      MS.SMAX:    DB      0                   ;Merker Endspalte
  B192    00             C      MS.ZANZ:    DB      0                   ;Merker Zeilenanzahl  BWS
  B193    00             C      MS.SPANZ:   DB      0                   ;Merker Spaltenanzahl BWS
  B194    0000           C      MS.BWSA:    DW      0                   ;Anf.adr. Bildwiederholspeicher
  B196    00             C      MS.DIREL:   DB      0                   ;Kommando forts. Lesepos.
  B197    00             C      MS.DIRES:   DB      0                   ;Kommando forts. Schreibpos.
  B198    00             C      MS.CMD:     DB      0                   ;Routinenkommando
  B199    00             C      MS.TK:      DB      0                   ;zu schreibendes bzw. zu lesendes Zeichen
  B19A    0000           C      MS.RADR:    DW      0                   ;Benutzeradresse Rollfunktion
                         C      ;
  B19C    00             C      MS.MCZ:     DB      0                   ;Zeichenmerker Cursorposition
  B19D    00             C      MS.MCUR:    DB      0                   ;Merker zum Cursor
                         C                                              ;MCUR = 0   Cursor aus
                         C                                              ;MCUR = 1   Cursor ein und gesetzt
                         C                                              ;MCUR = 2   Cursor ein und Zeichen
  B19E    00             C      MS.CZEIT:   DB      0                   ;Zeitvariable Cursorblinken
                         C      
                         C      
                         C      ;           END
                         C      ;           PN      TS06
                         C                  TITLE   'Funktionsadresstabellen'
                         C                  PAGE
'Funktionsadresstabellen'	MACRO-80 3.44	09-Dec-81	PAGE	1-5


                         C      
                         C      ;****************************************************************
                         C      ;*               Tabellen der Funktionsadressen                 *
                         C      ;****************************************************************
  B19F    0000           C      TS.TAB1:    DW      0                   ;P1
  B1A1    0000           C                  DW      0                   ;P2
  B1A3    0000           C                  DW      0                   ;P3
  B1A5    0000           C                  DW      0                   ;P4
  B1A7    0000           C                  DW      0                   ;P5
  B1A9    0000           C                  DW      0                   ;P6
  B1AB    0000           C                  DW      0                   ;P7
  B1AD    0000           C                  DW      0                   ;P8
  B1AF    0000           C                  DW      0                   ;P9
  B1B1    0000           C                  DW      0                   ;P10
  B1B3    0000           C                  DW      0                   ;P11
  B1B5    0000           C                  DW      0                   ;P12
  B1B7    0000           C                  DW      0                   ;P13
  B1B9    0000           C                  DW      0                   ;P14
  B1BB    0000           C                  DW      0                   ;P15
  B1BD    0000           C                  DW      0                   ;P16
  B1BF    0000           C                  DW      0                   ;P17
  B1C1    0000           C                  DW      0                   ;P18
  B1C3    0000           C                  DW      0                   ;P19
  B1C5    0000           C                  DW      0                   ;P20
  B1C7    0000           C                  DW      0                   ;P21
  B1C9    0000           C                  DW      0                   ;P22
  B1CB    0000           C                  DW      0                   ;P23
  B1CD    0000           C                  DW      0                   ;P24
  B1CF    0000           C                  DW      0                   ;P25
  B1D1    0000           C                  DW      0                   ;P26
  B1D3    0000           C                  DW      0                   ;P27
  B1D5    0000           C                  DW      0                   ;P28
  B1D7    0000           C                  DW      0                   ;P29
  B1D9    0000           C                  DW      0                   ;P30
  B1DB    0000           C                  DW      0                   ;P31
  B1DD    0000           C                  DW      0                   ;P32
  B1DF    0000           C                  DW      0                   ;P33
  B1E1    0000           C                  DW      0                   ;P34
  B1E3    0000           C                  DW      0                   ;P35
  B1E5    0000           C                  DW      0                   ;P36
  B1E7    0000           C                  DW      0                   ;P37
  B1E9    0000           C                  DW      0                   ;P38
  B1EB    0000           C                  DW      0                   ;P39
  B1ED    0000           C                  DW      0                   ;P40
  B1EF    0000           C                  DW      0                   ;P41
  B1F1    0000           C                  DW      0                   ;P42
  B1F3    0000           C                  DW      0                   ;P43
  B1F5    0000           C                  DW      0                   ;P44
  B1F7    0000           C                  DW      0                   ;P45
  B1F9    0000           C                  DW      0                   ;P46
  B1FB    0000           C                  DW      0                   ;P47
  B1FD    0000           C                  DW      0                   ;P48
                         C                  PAGE
'Funktionsadresstabellen'	MACRO-80 3.44	09-Dec-81	PAGE	1-6


                         C      
  B1FF    0000           C      TS.TAB2:    DW      0                   ;INS MOD
  B201    0000           C                  DW      0                   ;DEL
  B203    0000           C                  DW      0                   ;INS LINE
  B205    0000           C                  DW      0                   ;DEL LINE
  B207    0000           C                  DW      0                   ;SCH LINKS
  B209    0000           C                  DW      0                   ;C HOCH
  B20B    0000           C                  DW      0                   ;SCH RECHTS
  B20D    0000           C                  DW      0                   ;C LINKS
  B20F    0000           C                  DW      0                   ;HOME Fkt.
  B211    0000           C                  DW      0                   ;C RECHTS
  B213    0000           C                  DW      0                   ;C naechste Zeile Anfang
  B215    0000           C                  DW      0                   ;C RUNTER
  B217    0000           C      TS.TAB3:    DW      0                   ;00
  B219    0000           C                  DW      0                   ;000
  B21B    0000           C                  DW      0                   ;NEG QUIT
  B21D    0000           C                  DW      0                   ;SYS
  B21F    0000           C                  DW      0                   ;END
  B221    0000           C                  DW      0                   ;ABS
  B223    0000           C      TS.TAB4:    DW      0                   ;POS QUIT
  B225    0000           C                  DW      0                   ;TABS
  B227    0000           C                  DW      0                   ;TABL
  B229    0000           C                  DW      0                   ;CI
  B22B    0000           C                  DW      0                   ;M
  B22D    0000           C      TS.EINA:    DW      0                   ;Auswerten Alphataste
  B22F    0000           C      TS.TABU:    DW      0                   ;Auswerten ET2 :=: Tabulator
  B231    0000           C      TS.NEWL:    DW      0                   ;Auswerten ET1 :=: new line
  B233    0000           C      TS.TAB5:    DW      0                   ;Ebene 0
  B235    0000           C                  DW      0                   ;Ebene 1
  B237    0000           C                  DW      0                   ;Ebene 2
  B239    0000           C                  DW      0                   ;Ebene 3
                         C      ;****************************************************************
                         C      ;*               Tastaturmerker                                 *
                         C      ;****************************************************************
  B23B    00             C      TS.PTAST:   DB      0                   ;I/O-Adresse der Tastatur
  B23C    00             C      TS.TK:      DB      0                   ;Speicher Tastencode
  B23D    00             C      TS.PTK:     DB      0                   ;Speicher P-Tastennummer
  B23E    00             C      TS.EMERK:   DB      0                   ;Funktionstasten-Ebenen-Merker
  B23F    00             C      TS.SPMER:   DB      0                   ;Tastaturgruppenmerker
  B240    00             C      TS.UMERK:   DB      0                   ;Merker  INS MOD ein/aus
  B241    00             C      TS.KGMER:   DB      0                   ;Merker  Programmier-/Schreibmasch.Tast.
  B242    00             C      TS.ZSMER:   DB      0                   ;Merker  Z-Schnellschreiben
  B243    00             C      TS.ZEIT1:   DB      0                   ;Zeitkonstante 1
  B244    00             C      TS.ZEIT2:   DB      0                   ;Zeitkonstante 2
  B245    00             C      TS.ZEI21:   DB      0                   ;Zwsp. ZEIT2-ZEIT1
  B246    00             C      TS.ZSTC:    DB      0                   ;Zaehler Z-Schnell 0,5 s
  B247    00             C      TS.MIO:     DB      0                   ;memory - I/O - Schalter
  B248    00             C      TS.MBF:     DB      0                   ;Merker Bedienfolge ein/aus
  B249    0000           C      TS.BFOL1:   DW      0                   ;Pointer Bedienfolgesp. bei Erzeugung
  B24B    0000           C      TS.BFOL2:   DW      0                   ;Pointer Bedienfolgesp. bei Abarbeitung
  B24D    0000           C      TS.STACK:   DW      0                   ;Zeiger zum aktuellen Keller
                         C      ;
                         C      ;           END
                         C      ;           PN      S213
                         C                  TITLE   'Variablen'
                         C                  PAGE
'Variablen'	MACRO-80 3.44	09-Dec-81	PAGE	1-7


                         C      
                         C      ;****************************************************************
                         C      ;*               Systemvariable                                 *
                         C      ;****************************************************************
  B24F    0000           C      S2.TPA:     DW      0                   ;Textpufferanfang
  B251    0000           C      S2.TPE:     DW      0                   ;Textpufferende
  B253    0000           C      S2.WINA:    DW      0                   ;Windowanfang
  B255    0000           C      S2.WINE:    DW      0                   ;Windowende
  B257    0000           C      S2.END:     DW      0                   ;Ende des belegten Textpuffers
  B259    0000           C      S2.POIE:    DW      0                   ;Pointer Eingabepuffer
  B25B    0000           C      S2.POIA:    DW      0                   ;Pointer Ausgabepuffer
  B25D    0000           C      S2.RADR:    DW      0                   ;Rueckkehradresse bei UP - Routinen
                         C      ;****************************************************************
                         C      ;*             Variablen fuer S9                                *
                         C      ;****************************************************************
  B25F    00             C      S2.IM:      DB      0                   ;Merker fuer Input -Eroeffnung
  B260    00             C      S2.OM:      DB      0                   ;Merker fuer Output-Eroeffnung
  B261    00             C      S2.VZM:     DB      0                   ;Merker Anzahl Verzeichniseintr.
  B262    00             C      S2.ZZ:      DB      0                   ;Zeilenzaehler SL 6001
  B263    00             C      S2.CST:     DB      0                   ;Merker , ob eine Taste gedrueckt wurde
  B264    00             C      S2.IOC:     DB      0                   ;Erweiterung fuer SWITCH
                         C      ;****************************************************************
                         C      ;*             Variablen fuer LO                                *
                         C      ;****************************************************************
  B265    20 20 20 20    C      S2.PRGN:    DB      '      '
  B269    20 20          C      
  B26B    00             C      S2.DNR:     DB      0                   ;Dateinummer
  B26C    0000           C      S2.RBBR:    DW      0
                         C      ;****************************************************************
                         C      ;*             Variablen fuer   D E B U G                       *
                         C      ;****************************************************************
  B26E    0000           C      S2.AADR:    DW      0                   ;Anzeigeadresse     D2 (REAS)
  B270    0000           C      S2.KADR:    DW      0                   ;Korrekturadresse   D2 (REAS)
  B272    00             C      S2.ZP:      DB      0                   ;Zeilenposition     D2 (REAS)
  B273    00             C      S2.SP1:     DB      0                   ;Spaltenposition 1  D2 (REAS)
  B274    00             C      S2.SP2:     DB      0                   ;Spaltenposition 2  D2 (REAS)
  B275    00             C      S2.SP3:     DB      0                   ;Spaltenposition 3  D2 (REAS)
  B276                   C      S2.TRB:     DS      20,0                ;Merker fuer die letzten 20 Befehle
  B28A    00             C      S2.AFOR:    DB      0                   ;Anzeigeformat im Eingabebereich
  B28B    00             C      S2.BZ:      DB      0                   ;Bytezahl der Anzeige : 1 bzw. 2
  B28C    0000           C      S2.TE:      DW      0                   ;Hilfsvariable
  B28E    00             C      S2.DL:      DB      0
  B28F    00             C      S2.DH:      DB      0
  B290    0000           C      S2.PAR1:    DW      0                   ;Zwischenspeicher fuer 1.Parameter
  B292    0000           C      S2.DMANF:   DW      0                   ;erstes angezeigtes Byte bei MeDC
  B294    0000           C      S2.DMCUR:   DW      0                   ;Cursorposition              MeDC
  B296    0000           C      S2.DMBA:    DW      0                   ;Bereichdefinition Anfang    MeDC
  B298    0000           C      S2.DMBE:    DW      0                   ;Bereichdefinition Ende      MeDC
  B29A                   C      S2.DM1:     DS      16,0                ;Zwischenspeicher
  B2AA    00             C      S2.DM2:     DB      0
  B2AB    00             C      S2.DMH:     DB      0
  B2AC    00             C      S2.DML:     DB      0
  B2AD    0000           C      S2.SMHL:    DW      0
  B2AF    00             C      S2.S1:      DB      0                   ;Zusatzspeichermerker SYS0/bit 4
  B2B0                   C      S2.S2:      DS      8,0                 ;Zusatzspeichermerker SYS2
                         C      
                         C                  TITLE   'Variablen fuer die  USER - CPU '
                         C                  PAGE
'Variablen fuer die  USER - CPU '	MACRO-80 3.44	09-Dec-81	PAGE	1-8


                         C      
                         C      ;****************************************************************
                         C      ;*             Interruptmerker                       USER - CPU *
                         C      ;****************************************************************
  B2B8    00             C      S2.DDEI:    DB      0                   ;Merker  = 0 DI  /  = FFH EI
  B2B9    00             C      S2.DDIM:    DB      0                   ;Merker  IM0 , IM1 , IM2
  B2BA    00             C      S2.DDI:     DB      0                   ;I-Register
  B2BB    00             C      S2.DDR:     DB      0                   ;R-Register
                         C      ;****************************************************************
                         C      ;*             Befehlszaehler                        USER - CPU *
                         C      ;****************************************************************
  B2BC    0000           C      S2.DDPC:    DW      0
                         C      ;****************************************************************
                         C      ;*             Stackpointer                          USER - CPU *
                         C      ;****************************************************************
  B2BE    0000           C      S2.DDSP:    DW      0
                         C      ;****************************************************************
                         C      ;*             Indexregister                         USER - CPU *
                         C      ;****************************************************************
  B2C0    0000           C      S2.DDIX:    DW      0
  B2C2    0000           C      S2.DDIY:    DW      0
                         C      ;****************************************************************
                         C      ;*             Zweitregistersatz                     USER - CPU *
                         C      ;****************************************************************
  B2C4                   C      S2.DDBCS    EQU     $                   ;BC'
  B2C4    00             C      S2.DDCS:    DB      0
  B2C5    00             C      S2.DDBS:    DB      0
                         C      ;
  B2C6                   C      S2.DDDES    EQU     $                   ;DE'
  B2C6    00             C      S2.DDES:    DB      0
  B2C7    00             C      S2.DDDS:    DB      0
                         C      ;
  B2C8                   C      S2.DDHLS    EQU     $                   ;HL'
  B2C8    00             C      S2.DDLS:    DB      0
  B2C9    00             C      S2.DDHS:    DB      0
                         C      ;
  B2CA                   C      S2.DDAFS    EQU     $                   ;AF'
  B2CA    00             C      S2.DDFS:    DB      0
  B2CB    00             C      S2.DDAS:    DB      0
                         C      ;****************************************************************
                         C      ;*             Erstregistersatz                      USER - CPU *
                         C      ;****************************************************************
  B2CC                   C      S2.DDBC     EQU     $                   ;BC
  B2CC    00             C      S2.DDC:     DB      0
  B2CD    00             C      S2.DDB:     DB      0
                         C      ;
  B2CE                   C      S2.DDDE     EQU     $                   ;DE
  B2CE    00             C      S2.DDE:     DB      0
  B2CF    00             C      S2.DDD:     DB      0
                         C      ;
  B2D0                   C      S2.DDHL     EQU     $                   ;HL
  B2D0    00             C      S2.DDL:     DB      0
  B2D1    00             C      S2.DDH:     DB      0
                         C      ;
  B2D2                   C      S2.DDAF     EQU     $                   ;AF
  B2D2    00             C      S2.DDF:     DB      0
  B2D3    00             C      S2.DDA:     DB      0
                         C      
  B2D4                   C      S2.STACK    EQU     $
                         C      
  B2D4                   C                  DS      0C000H-S2.STACK,0
                         C      
                         C      ;           END
                                            .DEPHASE
                                
                                            .PHASE  0C000H
                                        ;     INCLUDE S165.MAC
                                        ;     INCLUDE S310.MAC
                                        ;     INCLUDE MO26.MAC
                                        ;     INCLUDE TA35.MAC   ;???   TA36
                                        ;     INCLUDE K158.MAC
                                        ;     INCLUDE LO28.MAC
                                        ;     INCLUDE S975.MAC   ;???   S967
                                        ;     INCLUDE S424.MAC   ;???   S425
                                        ;     INCLUDE SM01.MAC
                                        ;     INCLUDE S052.MAC   ;???   S053
                         C                  INCLUDE System.MAC
                         C      ;           PN      S165
                         C                  TITLE   '*** Betriebssystem  DEG2000 ***'
                         C                  PAGE
'*** Betriebssystem  DEG2000 ***'	MACRO-80 3.44	09-Dec-81	PAGE	1-9


                         C      
                         C      ;****************************************************************
                         C      ;*               S  Y  S  T  E  M   ----   D  E  G  2  0  0  0  *
                         C      ;*  Version      -----------------------------------------------*
                         C      ;*               Programmierer: M. Herbote --- K EAW  ZFT (WFT) *
                         C      ;*  V 2 . 1      -----------------------------------------------*
                         C      ;*               Stand        : 15.Maerz 1985                   *
                         C      ;****************************************************************
                         C      
  C000    F5C3           C      S0.ENTRY:   DW      S0.DEG2
  C002    56 32 2E 31    C                  DB      'V2.1/150385     '
  C006    2F 31 35 30    C      
  C00A    33 38 35 20    C      
  C00E    20 20 20 20    C      
                         C      
                         C      ;****************************************************************
                         C      ;*               System - Verstaendigungsbereich                *
                         C      ;****************************************************************
  C012                   C      S1.TA       EQU     $                   ;1. Tastaturroutine
  C012    C3 D143        C                  JP      TA.TA1              ;   Einlesen U/INT
  C015    C3 D15B        C                  JP      TA.TA2              ;   Einlesen Tastaturcode
  C018    C3 D40E        C                  JP      TA.LOE              ;   loeschen aller Tast.rout.adr.
  C01B    C3 D426        C                  JP      TA.LOES             ;   wie TA.LOE und Standardbel.
  C01E    C3 D23D        C                  JP      TA.ABFR             ;   Bereitstellen Tastaturcode
                         C                                              ;   und Abarbeitung Tastaturroutine
  C021    C3 D327        C                  JP      TA.TFE              ;   Warteschleife bis Tastenende
                         C      
  C024                   C      S1.MO       EQU     $                   ;2. Monitorroutine
  C024    C3 CB16        C                  JP      MO.MONI             ;   Eintrittspunkt Monitorroutine
  C027    C3 F5EE        C                  JP      S0.BWSUZ            ;   einzelnes Zeichen auf BWS
  C02A    C3 F60C        C                  JP      S0.BWSUS            ;   gesamten  BWSA    auf BWS
                         C      
  C02D                   C      S1.SM       EQU     $                   ;3. Druckerroutine
  C02D    C3 F588        C                  JP      SM.MRES             ;   Initialisierung Drucker
  C030    C3 F59C        C                  JP      SM.PRIO             ;   Zeichenausgabe  Drucker
                         C      
  C033                   C      S1.LA       EQU     $                   ;4. allgemeine Adressen
  C033    C3 CA65        C                  JP      S1.OPEN
  C036    C3 CA65        C                  JP      S1.CLOS
  C039    C3 CA65        C                  JP      S1.LESV
  C03C    C3 CA65        C                  JP      S1.LESR
  C03F    C3 CA65        C                  JP      S1.SCHR
                         C      
                         C                  PAGE
'*** Betriebssystem  DEG2000 ***'	MACRO-80 3.44	09-Dec-81	PAGE	1-10


                         C      
                         C      ;****************************************************************
                         C      ;*               R S T 3 8 -  /  N M I -  Eintrittsadresse      *
                         C      ;****************************************************************
  C042                   C      S1.RST38    EQU     $
  C042    ED 73 B2BE     C      S1.NMI:     LD      (S2.DDSP),SP        ;CPU - Zustand retten
  C046    ED 73 B24D     C                  LD      (TS.STACK),SP
  C04A    31 B2D4        C                  LD      SP,S2.STACK
  C04D    F5             C                  PUSH    AF
  C04E    E5             C                  PUSH    HL
  C04F    D5             C                  PUSH    DE
  C050    C5             C                  PUSH    BC
  C051    08             C                  EX      AF,AF'              ;'
  C052    D9             C                  EXX
  C053    F5             C                  PUSH    AF
  C054    E5             C                  PUSH    HL
  C055    D5             C                  PUSH    DE
  C056    C5             C                  PUSH    BC
  C057    FD E5          C                  PUSH    IY
  C059    DD E5          C                  PUSH    IX
  C05B    ED 57          C                  LD      A,I
  C05D    32 B2BA        C                  LD      (S2.DDI),A
  C060    ED 7B B2BE     C                  LD      SP,(S2.DDSP)
  C064    E1             C                  POP     HL
  C065    E5             C                  PUSH    HL
  C066    22 B2BC        C                  LD      (S2.DDPC),HL
  C069    3E A0          C                  LD      A,S0.PTAST          ;Tastaturinitialisierung
  C06B    32 B23B        C                  LD      (TS.PTAST),A
  C06E    CD D1A3        C                  CALL    TA.PIOPR
  C071    CD D215        C                  CALL    TA.E0IN
  C074    21 B2B8        C                  LD      HL,S2.DDEI
  C077    22 B292        C                  LD      (S2.DMANF),HL
  C07A    21 C2A0        C      S1.RST:     LD      HL,S1.INIT6
  C07D    E5             C                  PUSH    HL
  C07E    21 C7FE        C                  LD      HL,S1.DB0
  C081    E5             C                  PUSH    HL
  C082    ED 45          C                  RETN
                         C      ;****************************************************************
                         C      ;*               Eintrittsadresse   D E G 2                     *
                         C      ;****************************************************************
  C084    3E C3          C      S1.RES1:    LD      A,0C3H
  C086    32 0000        C                  LD      (00000H),A
  C089    32 0038        C                  LD      (00038H),A
  C08C    32 0066        C                  LD      (00066H),A
  C08F    21 C0B0        C                  LD      HL,S1.RES
  C092    22 0001        C                  LD      (00001H),HL
  C095    21 C042        C                  LD      HL,S1.RST38
  C098    22 0039        C                  LD      (00039H),HL
  C09B    21 C042        C                  LD      HL,S1.NMI
  C09E    22 0067        C                  LD      (00067H),HL
  C0A1    AF             C                  XOR     A
  C0A2    32 A800        C                  LD      (S0.DEAT),A
                         C      
  C0A5    21 F636        C                  LD      HL,S0.BWSB
  C0A8    11 B2D4        C                  LD      DE,S2.STACK
  C0AB    01 000A        C                  LD      BC,S0.BASCL-S0.BWSB
  C0AE    ED B0          C                  LDIR
                         C      
                         C                  PAGE
'*** Betriebssystem  DEG2000 ***'	MACRO-80 3.44	09-Dec-81	PAGE	1-11


                         C      
                         C      ;****************************************************************
                         C      ;*              R E S E T -  Eintrittsadresse                   *
                         C      ;****************************************************************
  C0B0    F3             C      S1.RES:     DI
  C0B1    ED 5E          C                  IM      2
                         C      ;****************************************************************
                         C      ;*                Anfangswertzuweisung von System - Variablen   *
                         C      ;****************************************************************
  C0B3    31 B000        C                  LD      SP,S0.STACK+2
  C0B6    21 C114        C                  LD      HL,S1.SYSTB
  C0B9    E5             C                  PUSH    HL
  C0BA    ED 73 B24D     C                  LD      (TS.STACK),SP
  C0BE    21 A000        C                  LD      HL,S0.BWSA
  C0C1    22 B194        C                  LD      (MS.BWSA),HL
  C0C4    21 0100        C                  LD      HL,S0.TPA
  C0C7    22 B24F        C                  LD      (S2.TPA),HL
  C0CA    21 80FF        C                  LD      HL,S0.TPE
  C0CD    22 B251        C                  LD      (S2.TPE),HL
  C0D0    AF             C                  XOR     A
  C0D1    32 B264        C                  LD      (S2.IOC),A
  C0D4    3D             C                  DEC     A
  C0D5    32 B197        C                  LD      (MS.DIRES),A
                         C      ;****************************************************************
                         C      ;*            Initialisierung der PIO-s auf der AKB             *
                         C      ;*            und Initialisierung der Tastatur                  *
                         C      ;****************************************************************
  C0D8    3E A0          C                  LD      A,S0.PTAST
  C0DA    32 B23B        C                  LD      (TS.PTAST),A
  C0DD    CD D1A3        C                  CALL    TA.PIOPR
  C0E0    CD D215        C                  CALL    TA.E0IN
                         C      
  C0E3    DD 21 0013     C                  LD      IX,S3.KS1-S3.SEAT   ;Initialisierung KMBG
  C0E7    11 A803        C                  LD      DE,S0.DEAT+3
  C0EA    DD 19          C                  ADD     IX,DE
  C0EC    DD 36 02 30    C                  LD      (IX+2),S0.AKB
  C0F0    CD F659        C                  CALL    S0.KRZU
                         C      ;            CALL    0    ;???        KR.INIT
  C0F3    CD F63C        C                  CALL    S0.BWSAB
  C0F6    21 BBF0        C                  LD      HL,S0.PFFA
  C0F9    E5             C                  PUSH    HL
  C0FA    D1             C                  POP     DE
  C0FB    CD DB85        C                  CALL    K1.FU
                         C      ;****************************************************************
                         C      ;*              Bild loeschen                                   *
                         C      ;****************************************************************
  C0FE    AF             C                  XOR     A                   ;ZANZ=  , SPANZ=   laut Modul S0.
  C0FF    32 B198        C                  LD      (MS.CMD),A
  C102    CD CB16        C                  CALL    MO.MONI
  C105    21 B198        C                  LD      HL,MS.CMD           ;ZMIN=SMIN=1 , ZMAX=ZANZ , SMAX=SPANZ
  C108    34             C                  INC     (HL)
  C109    CD CB16        C                  CALL    MO.MONI
  C10C    3E 04          C                  LD      A,4                 ;gesamtes Bild loeschen
  C10E    32 B198        C                  LD      (MS.CMD),A
  C111    CD CB16        C                  CALL    MO.MONI
                         C      
                         C                  PAGE
'*** Betriebssystem  DEG2000 ***'	MACRO-80 3.44	09-Dec-81	PAGE	1-12


                         C      
                         C      ;****************************************************************
                         C      ;*               Aufbau des Systemgrundbildes                   *
                         C      ;****************************************************************
  C114    3E F5          C      S1.SYSTB:   LD      A,HIGH(S0.IV)
  C116    ED 47          C                  LD      I,A
  C118    31 AFFE        C                  LD      SP,S0.STACK
  C11B    ED 73 B24D     C                  LD      (TS.STACK),SP
  C11F    21 A000        C                  LD      HL,S0.BWSA
  C122    22 B194        C                  LD      (MS.BWSA),HL
  C125    3E C0          C                  LD      A,11000000B
  C127    32 B196        C                  LD      (MS.DIREL),A
  C12A    32 B197        C                  LD      (MS.DIRES),A
  C12D    21 F636        C                  LD      HL,S0.BWSB
  C130    11 B2D4        C                  LD      DE,S2.STACK
  C133    01 000A        C                  LD      BC,S0.BASCL-S0.BWSB
  C136    ED B0          C                  LDIR
                         C      
  C138    AF             C                  XOR     A                   ;ZANZ,SPANZ belegen
  C139    32 B198        C                  LD      (MS.CMD),A
  C13C    CD CB16        C                  CALL    MO.MONI
                         C      
  C13F    3E 02          C                  LD      A,2                 ;ZMIN=SMIN=1 , ZMAX=ZANZ , SMAX=SPANZ
  C141    32 B198        C                  LD      (MS.CMD),A
  C144    CD CB16        C                  CALL    MO.MONI
                         C      
  C147    3E 05          C                  LD      A,5                 ;Bildfenster loeschen
  C149    32 B198        C                  LD      (MS.CMD),A
  C14C    CD CB16        C                  CALL    MO.MONI
                         C      
  C14F    CD C3BF        C                  CALL    S1.ANZEI            ;Anzeige: DEG 2000
  C152    0F00           C                  DW      00F00H              ;ZPOS=0  , SPOS=15
  C154    08             C                  DB      8                   ;Textlaenge
  C155    44 45 47 20    C                  DB      'DEG 2000'
  C159    32 30 30 30    C      
  C15D    00             C                  DB      0
                         C      
  C15E    CD C3BF        C                  CALL    S1.ANZEI            ;Anzeige: Betriebssystem
  C161    1F00           C                  DW      01F00H              ;ZPOS=0  , SPOS=31
  C163    0E             C                  DB      14                  ;Textlaenge
  C164    42 65 74 72    C                  DB      'Betriebssystem'
  C168    69 65 62 73    C      
  C16C    73 79 73 74    C      
  C170    65 6D          C      
  C172    00             C                  DB      0
                         C      
  C173    CD C3BF        C                  CALL    S1.ANZEI            ;Anzeige: Version i.ii/i
  C176    0F01           C                  DW      00F01H              ;ZPOS=1  , SPOS=15
  C178    0E             C                  DB      14
  C179    56 65 72 73    C                  DB      'Version '
  C17D    69 6F 6E 20    C      
  C181    32             C                  DB      S0.V1
  C182    2E             C                  DB      '.'
  C183    31             C                  DB      S0.V2
  C184    33             C                  DB      S0.V3
  C185    2F             C                  DB      '/'
  C186    45             C                  DB      S0.V7
  C187    00             C                  DB      0
                         C      
  C188    CD C67C        C                  CALL    S1.STAT
  C18B    CD C191        C                  CALL    S1.DAT              ;Datum anzeigen
                         C      
  C18E    C3 C20A        C                  JP      S1.SYSTC            ;ueberspringen des UPs  DAT
                         C      
                         C                  PAGE
'*** Betriebssystem  DEG2000 ***'	MACRO-80 3.44	09-Dec-81	PAGE	1-13


                         C      
                         C      ;****************************************************************
                         C      ;*                              Anzeige: Datum:                 *
                         C      ;****************************************************************
  C191    CD C3BF        C      S1.DAT:     CALL    S1.ANZEI            ;Anzeige: Datum:
  C194    0F02           C                  DW      00F02H              ;ZPOS=2  , SPOS=15
  C196    08             C                  DB      8
  C197    44 61 74 75    C                  DB      'Datum:  '
  C19B    6D 3A 20 20    C      
  C19F    00             C                  DB      0
                         C      
  C1A0    3E 18          C                  LD      A,24                ;Anzeige des Datums
  C1A2    32 B198        C                  LD      (MS.CMD),A
  C1A5    06 02          C                  LD      B,2
  C1A7    21 0004        C                  LD      HL,S3.DATUM-S3.SEAT
  C1AA    11 A800        C                  LD      DE,S0.DEAT
  C1AD    19             C                  ADD     HL,DE
  C1AE    CD CB16        C                  CALL    MO.MONI
  C1B1    3E 14          C                  LD      A,20
  C1B3    32 B198        C                  LD      (MS.CMD),A
  C1B6    3E 2E          C                  LD      A,'.'
  C1B8    32 B199        C                  LD      (MS.TK),A
  C1BB    CD CB16        C                  CALL    MO.MONI
  C1BE    3E 18          C                  LD      A,24
  C1C0    32 B198        C                  LD      (MS.CMD),A
  C1C3    06 02          C                  LD      B,2
  C1C5    21 0004        C                  LD      HL,S3.DATUM-S3.SEAT
  C1C8    11 A802        C                  LD      DE,S0.DEAT+2
  C1CB    19             C                  ADD     HL,DE
  C1CC    CD CB16        C                  CALL    MO.MONI
  C1CF    3E 14          C                  LD      A,20
  C1D1    32 B198        C                  LD      (MS.CMD),A
  C1D4    3E 2E          C                  LD      A,'.'
  C1D6    32 B199        C                  LD      (MS.TK),A
  C1D9    CD CB16        C                  CALL    MO.MONI
  C1DC    3E 18          C                  LD      A,24
  C1DE    32 B198        C                  LD      (MS.CMD),A
  C1E1    06 02          C                  LD      B,2
  C1E3    21 0004        C                  LD      HL,S3.DATUM-S3.SEAT
  C1E6    11 A804        C                  LD      DE,S0.DEAT+4
  C1E9    19             C                  ADD     HL,DE
  C1EA    CD CB16        C                  CALL    MO.MONI
                         C      
                         C      ;                               Anzeige: :
  C1ED    2E 0A          C                  LD      L,S0.SYSZ-1         ;ZPOS=SYSZ , SPOS=0
  C1EF    26 00          C                  LD      H,0
  C1F1    22 B18C        C                  LD      (MS.ZPOS),HL
  C1F4    3E 14          C                  LD      A,20
  C1F6    32 B198        C                  LD      (MS.CMD),A
  C1F9    3E 3A          C                  LD      A,':'
  C1FB    32 B199        C                  LD      (MS.TK),A
  C1FE    CD CB16        C                  CALL    MO.MONI
                         C      
  C201    3E 15          C                  LD      A,21                ;SPOS=SPOS+1
  C203    32 B198        C                  LD      (MS.CMD),A
  C206    CD CB16        C                  CALL    MO.MONI
  C209    C9             C                  RET
                         C      
                         C                  PAGE
'*** Betriebssystem  DEG2000 ***'	MACRO-80 3.44	09-Dec-81	PAGE	1-14


                         C      
                         C      ;****************************************************************
                         C      ;*                Anfangswertzuweisung von System - Variablen   *
                         C      ;****************************************************************
  C20A    21 2918        C      S1.SYSTC:   LD      HL,S0.SKADR
  C20D    22 B134        C                  LD      (K2.SKADR),HL
                         C      
  C210    21 2917        C                  LD      HL,S0.FKADR
  C213    22 B132        C                  LD      (K2.FKADR),HL
                         C      
  C216    21 C114        C                  LD      HL,S1.SYSTB
  C219    22 B136        C                  LD      (K2.FRADR),HL
                         C      
  C21C    21 0100        C                  LD      HL,S0.LRECL         ;physische Blocklaenge Kassette
  C21F    22 B138        C                  LD      (K2.LRECL),HL
                         C      
  C222    3E 02          C                  LD      A,S0.ZEIT1
  C224    32 B243        C                  LD      (TS.ZEIT1),A
                         C      
  C227    3E 10          C                  LD      A,S0.ZEIT2
  C229    32 B244        C                  LD      (TS.ZEIT2),A
                         C      
                         C      ;****************************************************************
                         C      ;*               Tastaturaktivierung                            *
                         C      ;****************************************************************
  C22C    CD D426        C                  CALL    TA.LOES             ;loeschen aller Tast.r.adr.
                         C      
  C22F    21 0000        C                  LD      HL,0                ;D0.DD            ;Routine  Debug ;!!!
  C232    22 B201        C                  LD      (TS.TAB2+2),HL
  C235    21 F5BD        C                  LD      HL,S0.DEG1          ;Routine  ABS
  C238    22 B221        C                  LD      (TS.TAB3+10),HL
  C23B    21 C36F        C                  LD      HL,S1.START         ;Routine  POS_QUIT  und  ET1
  C23E    22 B223        C                  LD      (TS.TAB4),HL
  C241    22 B231        C                  LD      (TS.NEWL),HL
  C244    3E AE          C                  LD      A,10101110B         ;Sperrinitialisierung
  C246    32 B23F        C                  LD      (TS.SPMER),A
                         C      
                         C                  PAGE
'*** Betriebssystem  DEG2000 ***'	MACRO-80 3.44	09-Dec-81	PAGE	1-15


                         C      
                         C      ;****************************************************************
                         C      ;*               Abfrage nach Ausgangszustand des Geraetes      *
                         C      ;****************************************************************
  C249    DD 21 0000     C      S1.SYSTD:   LD      IX,S3.MASK1-S3.SEAT
  C24D    11 A800        C                  LD      DE,S0.DEAT
  C250    DD 19          C                  ADD     IX,DE
  C252    DD 7E 00       C                  LD      A,(IX+0)
  C255    EE AA          C                  XOR     0AAH                ;M1='10101010' ?
  C257    20 17          C                  JR      NZ,S1.INITE
  C259    DD 7E 01       C                  LD      A,(IX+1)
  C25C    EE 55          C                  XOR     055H                ;M2='01010101' ?
  C25E    20 10          C                  JR      NZ,S1.INITE
  C260    DD 7E 02       C                  LD      A,(IX+2)
  C263    EE FF          C                  XOR     0FFH                ;M3='11111111' ?
  C265    20 09          C                  JR      NZ,S1.INITE
  C267    DD 7E 03       C                  LD      A,(IX+3)
  C26A    EE 00          C                  XOR     000H                ;M4='00000000' ?
  C26C    20 02          C                  JR      NZ,S1.INITE
  C26E    18 28          C                  JR      S1.INIT5
                         C      ;****************************************************************
                         C      ;*               Ausgangszustand des Geraetes                   *
                         C      ;****************************************************************
  C270    21 CA66        C      S1.INITE:   LD      HL,S3.SEAT          ;EA dyn := EA eprom
  C273    11 A800        C                  LD      DE,S0.DEAT
  C276    01 0400        C                  LD      BC,1024
  C279    ED B0          C                  LDIR
  C27B    CD C191        C                  CALL    S1.DAT
                         C      
  C27E    CD C3BF        C                  CALL    S1.ANZEI            ;Aufforderung zur Datumseingabe
  C281    0A             C                  DB      S0.SYSZ-1           ;ZPOS=SYSZ
  C282    02             C                  DB      2                   ;SPOS=3
  C283    05             C                  DB      5
  C284    44 41 54 45    C                  DB      'DATE '
  C288    20             C      
  C289    00             C                  DB      0                   ;Eingabelaenge
                         C      
  C28A    2E 0B          C                  LD      L,S0.SYSZ           ;ZMIN=SYSZ , SMIN=8
  C28C    26 08          C                  LD      H,8
  C28E    22 B18E        C                  LD      (MS.ZMIN),HL
  C291    26 0D          C                  LD      H,13                ;ZMAX=SYSZ , SMAX=13
  C293    22 B190        C                  LD      (MS.ZMAX),HL
  C296    18 08          C                  JR      S1.INIT6
                         C      ;****************************************************************
                         C      ;*               Cursor setzen und Eintritt in die              *
                         C      ;*               Tastatur - Abfrageschleife                     *
                         C      ;****************************************************************
  C298    3E 03          C      S1.INIT5:   LD      A,3                 ;ZMIN=ZMAX=SYSZ , SMIN=3 , SMAX=16
  C29A    32 B198        C                  LD      (MS.CMD),A
  C29D    CD CB16        C                  CALL    MO.MONI
  C2A0    3E 06          C      S1.INIT6:   LD      A,6                 ;Cursor setzen
  C2A2    32 B198        C                  LD      (MS.CMD),A
  C2A5    CD CB16        C                  CALL    MO.MONI
                         C      ;****************************************************************
                         C      ;*            Tastaturabfrageschleife                           *
                         C      ;****************************************************************
  C2A8    CD D327        C      S1.TFE:     CALL    TA.TFE              ;Warten auf Tastenende
  C2AB    ED 7B B24D     C      S1.ABFR:    LD      SP,(TS.STACK)       ;Kellerzeiger zuruecksetzen
  C2AF    CD D23D        C                  CALL    TA.ABFR             ;Tastaturabfrage
  C2B2    18 F7          C                  JR      S1.ABFR
                         C      
                         C                  TITLE   'Tastenroutinen'
                         C                  PAGE
'Tastenroutinen'	MACRO-80 3.44	09-Dec-81	PAGE	1-16


                         C      
                         C      ;****************************************************************
                         C      ;*               Tastenroutine -   ==>                          *
                         C      ;****************************************************************
  C2B4    3A B197        C      S1.CNRS:    LD      A,(MS.DIRES)
  C2B7    F5             C                  PUSH    AF
  C2B8    CB 87          C                  RES     0,A
  C2BA    CB 8F          C                  RES     1,A
  C2BC    CB 97          C                  RES     2,A
  C2BE    32 B197        C      S1.CURS1:   LD      (MS.DIRES),A
  C2C1    3E 15          C                  LD      A,21
  C2C3    32 B198        C                  LD      (MS.CMD),A
  C2C6    CD CB16        C                  CALL    MO.MONI
  C2C9    F1             C                  POP     AF
  C2CA    32 B197        C                  LD      (MS.DIRES),A
  C2CD    3E 01          C                  LD      A,1
  C2CF    32 B242        C                  LD      (TS.ZSMER),A
  C2D2    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*               Tastenroutine -  <==                           *
                         C      ;****************************************************************
  C2D3    3A B197        C      S1.CNLS:    LD      A,(MS.DIRES)
  C2D6    F5             C                  PUSH    AF
  C2D7    CB 87          C                  RES     0,A
  C2D9    CB 8F          C                  RES     1,A
  C2DB    CB D7          C                  SET     2,A
  C2DD    18 DF          C                  JR      S1.CURS1
                         C      ;****************************************************************
                         C      ;*               Tastenroutine -  runter                        *
                         C      ;****************************************************************
  C2DF    3A B197        C      S1.CNUS:    LD      A,(MS.DIRES)
  C2E2    F5             C                  PUSH    AF
  C2E3    CB 87          C                  RES     0,A
  C2E5    CB CF          C                  SET     1,A
  C2E7    CB D7          C                  SET     2,A
  C2E9    18 D3          C                  JR      S1.CURS1
                         C      ;****************************************************************
                         C      ;*               Tastenroutine -  hoch                          *
                         C      ;****************************************************************
  C2EB    3A B197        C      S1.CNOS:    LD      A,(MS.DIRES)
  C2EE    F5             C                  PUSH    AF
  C2EF    CB 87          C                  RES     0,A
  C2F1    CB CF          C                  SET     1,A
  C2F3    CB 97          C                  RES     2,A
  C2F5    18 C7          C                  JR      S1.CURS1
                         C      ;****************************************************************
                         C      ;*               Tastenroutine -  HOME-Funktion                 *
                         C      ;****************************************************************
  C2F7    3E 16          C      S1.HOME:    LD      A,22
  C2F9    32 B198        C      S1.CURS2:   LD      (MS.CMD),A
  C2FC    CD CB16        C                  CALL    MO.MONI
  C2FF    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*               Tastenroutine -  naechste Zeile Anfang         *
                         C      ;****************************************************************
  C300    3E 17          C      S1.CNZA:    LD      A,23
  C302    18 F5          C                  JR      S1.CURS2
                         C      
                         C                  PAGE
'Tastenroutinen'	MACRO-80 3.44	09-Dec-81	PAGE	1-17


                         C      
                         C      ;****************************************************************
                         C      ;*               Tastenroutine - DEL LINE                       *
                         C      ;****************************************************************
  C304    3E 0D          C      S1.DELZL:   LD      A,13
  C306    32 B198        C                  LD      (MS.CMD),A
  C309    CD CB16        C                  CALL    MO.MONI
  C30C    3E 0A          C                  LD      A,10
  C30E    32 B198        C                  LD      (MS.CMD),A
  C311    CD CB16        C                  CALL    MO.MONI
  C314    CD C4D7        C                  CALL    S1.SZAHL
  C317    47             C      S1.DEL2:    LD      B,A
  C318    3E 20          C                  LD      A,' '
  C31A    32 B199        C                  LD      (MS.TK),A
  C31D    3E 14          C                  LD      A,20
  C31F    32 B198        C                  LD      (MS.CMD),A
  C322    CD CB16        C      S1.DEL1:    CALL    MO.MONI
  C325    10 FB          C                  DJNZ    S1.DEL1
  C327    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*               Tastenroutine - Alphazeichen                   *
                         C      ;****************************************************************
  C328    32 B199        C      S1.AEIN:    LD      (MS.TK),A
  C32B    3E 14          C                  LD      A,20
  C32D    32 B198        C                  LD      (MS.CMD),A
  C330    CD CB16        C                  CALL    MO.MONI
  C333    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*               Tastenroutine - Taste 00  ,  Taste 000         *
                         C      ;****************************************************************
  C334    3E 30          C      S1.NN:      LD      A,'0'
  C336    32 B199        C                  LD      (MS.TK),A
  C339    3E 14          C                  LD      A,20
  C33B    32 B198        C                  LD      (MS.CMD),A
  C33E    CD CB16        C      S1.NN1:     CALL    MO.MONI
  C341    CD CB16        C                  CALL    MO.MONI
  C344    C9             C                  RET
                         C      
  C345    3E 30          C      S1.NNN:     LD      A,'0'
  C347    32 B199        C                  LD      (MS.TK),A
  C34A    3E 14          C                  LD      A,20
  C34C    32 B198        C                  LD      (MS.CMD),A
  C34F    CD CB16        C                  CALL    MO.MONI
  C352    18 EA          C                  JR      S1.NN1
                         C      ;****************************************************************
                         C      ;*               Tastenroutine - Hart COPY                      *
                         C      ;****************************************************************
  C354    06 16          C      S1.HCOPY:   LD      B,S0.ZANZ-2         ;ZANZ-2  auszugebende Zeilen
  C356    2A B194        C                  LD      HL,(MS.BWSA)
  C359    C5             C      S1.HC1:     PUSH    BC                  ;Zyklus ueber ZANZ-2  Zeilen
  C35A    3A B193        C                  LD      A,(MS.SPANZ)        ;Spaltenanzahl laden
  C35D    47             C                  LD      B,A
  C35E    7E             C      S1.HC2:     LD      A,(HL)              ;Zyklus ueber eine Zeile
  C35F    4F             C                  LD      C,A                 ;auszugebendes Zeichen laden
  C360    23             C                  INC     HL
  C361    CD F59C        C                  CALL    SM.PRIO             ;ein Zeichen ausgeben
  C364    10 F8          C                  DJNZ    S1.HC2              ;naechstes Zeichen
  C366    0E 1E          C                  LD      C,1EH               ;Zeilenende ausgeben
  C368    CD F59C        C                  CALL    SM.PRIO
  C36B    C1             C                  POP     BC
  C36C    10 EB          C                  DJNZ    S1.HC1              ;naechste  Zeile
  C36E    C9             C                  RET
                         C      
                         C                  PAGE
'Tastenroutinen'	MACRO-80 3.44	09-Dec-81	PAGE	1-18


                         C      
                         C      ;****************************************************************
                         C      ;*               Tastenroutine - Starttaste (POS QUIT)          *
                         C      ;****************************************************************
  C36F    3E 0C          C      S1.START:   LD      A,12                ;HL:=SZA
  C371    32 B198        C                  LD      (MS.CMD),A
  C374    CD CB16        C                  CALL    MO.MONI
  C377    3E 1E          C                  LD      A,30                ;ZPOL,SPOL:=HL
  C379    32 B198        C                  LD      (MS.CMD),A
  C37C    CD CB16        C                  CALL    MO.MONI
  C37F    3E 28          C                  LD      A,40                ;Zeichen vom BWS lesen
  C381    32 B198        C                  LD      (MS.CMD),A
  C384    CD CB16        C                  CALL    MO.MONI
  C387    3A B199        C                  LD      A,(MS.TK)
  C38A    FE 3A          C                  CP      ':'
  C38C    C0             C                  RET     NZ
  C38D    CD C4C1        C                  CALL    S1.SZEI
  C390    C8             C                  RET     Z
  C391    2B             C                  DEC     HL
  C392    EB             C                  EX      DE,HL
  C393    21 0000        C      S1.SUCHE:   LD      HL,0
  C396    E5             C                  PUSH    HL
  C397    E5             C                  PUSH    HL
  C398    C1             C      S1.SUCH2:   POP     BC
  C399    E1             C                  POP     HL
  C39A    D5             C                  PUSH    DE
  C39B    7D             C      S1.SUCH1:   LD      A,L
  C39C    5C             C                  LD      E,H
  C39D    ED A1          C                  CPI
  C39F    E2 C114        C                  JP      PO,S1.SYSTB
  C3A2    20 F7          C                  JR      NZ,S1.SUCH1
  C3A4    7B             C                  LD      A,E
  C3A5    BE             C                  CP      (HL)
  C3A6    20 F3          C                  JR      NZ,S1.SUCH1
  C3A8    D1             C                  POP     DE
  C3A9    E5             C                  PUSH    HL
  C3AA    C5             C                  PUSH    BC
  C3AB    06 04          C                  LD      B,4                 ;Programmanfang suchen
  C3AD    23             C                  INC     HL
  C3AE    CD C4B6        C                  CALL    S1.VERGL
  C3B1    20 E5          C                  JR      NZ,S1.SUCH2
  C3B3    C1             C                  POP     BC
  C3B4    D1             C                  POP     DE
  C3B5    3E 02          C                  LD      A,2                 ;ZMIN=SMIN=1 , ZMAX=ZANZ-2 , SMAX=SPANZ
  C3B7    32 B198        C                  LD      (MS.CMD),A
  C3BA    CD CB16        C                  CALL    MO.MONI
  C3BD    FB             C                  EI
  C3BE    E9             C                  JP      (HL)
                         C      
                         C                  TITLE   'Unterprogramme'
                         C                  PAGE
'Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-19


                         C      
                         C      ;****************************************************************
                         C      ;*               Unterprogramm zur Bedienerkommunikation        *
                         C      ;*               -----------------------------------------------*
                         C      ;*  CALL ANZEI   Aufruf des Unterprogrammes                     *
                         C      ;*  DB   zpos    zpos    ...   Zeilenpos. -1 fuer Kommunikation *
                         C      ;*  DB   spos    spos    ...   Spaltenpos.-1 fuer Kommunikation *
                         C      ;*  DB   alae    alae    ...   Laenge des Anzeigetextes         *
                         C      ;*                             bit 7=0   es folgt atext         *
                         C      ;*                                 7=1   es folgt adr(atext)    *
                         C      ;*                             bit 6=0   bit 5...0 Textlaenge   *
                         C      ;*                                 alae=0 keine Textanzeige, es *
                         C      ;*                                 entfaellt der Parameter atext*
                         C      ;*                                 6=1   Text mit Endekenng. -1 *
                         C      ;*                                                              *
                         C      ;*  DB   atext   atext   ...   Anzeigetext  bzw.                *
                         C      ;*  DA   adr(atext)      ...   Adresse des Anzeigetextes        *
                         C      ;*                                                              *
                         C      ;*  DB   elae    elae    ...   Eingabebereichslaenge            *
                         C      ;*                             bei elae=0 keine Eingabe,        *
                         C      ;*                             es entfallen die nachf. Param.   *
                         C      ;*  DB   spmer   spmer   ...   Wert fuer  TS.SPMER              *
                         C      ;*  DA   nquit   nquit   ...   Routinenadr. fuer  NEG QUIT      *
                         C      ;*  DA   pquit   pquit   ...   Routinenadr. fuer  POS QUIT      *
                         C      ;*  DA   aein    aein    ...   Routinenadr. fuer  Alphnum-Tasten*
                         C      ;*               -----------------------------------------------*
                         C      ;*               wenn elae=0 , dann Programmfortsetzung beim    *
                         C      ;*                             naechsten Befehl nach  elae      *
                         C      ;*               wenn elae>0 , dann Programmfortsetzung bei der *
                         C      ;*                             Tastaturabfrageschleife          *
                         C      ;*               -----------------------------------------------*
                         C      ;*               in  HL  wird die Adresse des Eingabebereiches  *
                         C      ;*               und in  BC  die Bereichslaenge uebergeben      *
                         C      ;****************************************************************
  C3BF    FD E3          C      S1.ANZEI:   EX      (SP),IY             ;IY ==> Keller , Paradr ==> IY
  C3C1    DD E5          C                  PUSH    IX                  ;Register retten
  C3C3    F5             C                  PUSH    AF
  C3C4    D5             C                  PUSH    DE
  C3C5    3E 01          C                  LD      A,1                 ;def. gesamtes Bild als Fenster
  C3C7    32 B198        C                  LD      (MS.CMD),A
  C3CA    CD CB16        C                  CALL    MO.MONI
  C3CD    FD 23          C                  INC     IY                  ;IY auf  atext  positionieren
  C3CF    FD 23          C                  INC     IY
  C3D1    FD 23          C                  INC     IY
  C3D3    FD E5          C                  PUSH    IY
  C3D5    FD 6E FD       C                  LD      L,(IY-3)            ;ZPOS
  C3D8    FD 66 FE       C                  LD      H,(IY-2)            ;SPOS
  C3DB    22 B18C        C                  LD      (MS.ZPOS),HL
  C3DE    FD CB FF 76    C                  BIT     6,(IY-1)            ;Test, ob Laengenangabe
  C3E2    20 0D          C                  JR      NZ,S1.ANZ6
  C3E4    FD 7E FF       C                  LD      A,(IY-1)            ;Laengenbyte
  C3E7    E6 3F          C                  AND     3FH
  C3E9    28 42          C                  JR      Z,S1.ANZ1           ;Anzeige ueberspringen
  C3EB    47             C                  LD      B,A
  C3EC    3E 18          C                  LD      A,24
  C3EE    32 B198        C                  LD      (MS.CMD),A
  C3F1    E1             C      S1.ANZ6:    POP     HL                  ;Textadresse
  C3F2    FD CB FF 7E    C                  BIT     7,(IY-1)
  C3F6    28 06          C                  JR      Z,S1.ANZ3
  C3F8    FD 6E 00       C                  LD      L,(IY)
  C3FB    FD 66 01       C                  LD      H,(IY+1)
  C3FE    FD 23          C      S1.ANZ3:    INC     IY
  C400    FD 23          C                  INC     IY
  C402    FD E5          C                  PUSH    IY
  C404    FD CB FD 76    C                  BIT     6,(IY-3)
  C408    20 0E          C                  JR      NZ,S1.ANZ4
  C40A    CD CB16        C                  CALL    MO.MONI
  C40D    FD CB FD 7E    C                  BIT     7,(IY-3)
  C411    20 1A          C                  JR      NZ,S1.ANZ1
  C413    FD E1          C                  POP     IY
  C415    E5             C                  PUSH    HL
  C416    18 15          C                  JR      S1.ANZ1
                         C      
  C418    3E 14          C      S1.ANZ4:    LD      A,20
  C41A    32 B198        C                  LD      (MS.CMD),A
  C41D    7E             C      S1.ANZ5:    LD      A,(HL)
  C41E    23             C                  INC     HL
  C41F    FE FF          C                  CP      -1
  C421    28 0A          C                  JR      Z,S1.ANZ1
  C423    32 B199        C                  LD      (MS.TK),A
  C426    E5             C                  PUSH    HL
  C427    CD CB16        C                  CALL    MO.MONI
'Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-20


  C42A    E1             C                  POP     HL
  C42B    18 F0          C                  JR      S1.ANZ5
                         C      
  C42D    FD E1          C      S1.ANZ1:    POP     IY
  C42F    3E 0B          C                  LD      A,11
  C431    32 B198        C                  LD      (MS.CMD),A
  C434    CD CB16        C                  CALL    MO.MONI
  C437    E5             C                  PUSH    HL
  C438    FD 7E 00       C                  LD      A,(IY)              ;Eingabelaenge
  C43B    06 00          C                  LD      B,0
  C43D    4F             C                  LD      C,A
  C43E    C5             C                  PUSH    BC
  C43F    B7             C                  OR      A
  C440    28 50          C                  JR      Z,S1.ANZ2           ;keine Eingabe gefordert
                         C      
                         C                  PAGE
'Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-21


                         C      
  C442    2A B18C        C                  LD      HL,(MS.ZPOS)        ;ZMIN und SMIN ermitteln
  C445    24             C                  INC     H
  C446    2C             C                  INC     L
  C447    22 B18E        C                  LD      (MS.ZMIN),HL
  C44A    7C             C                  LD      A,H                 ;ZMAX und SMAX ermitteln
  C44B    0D             C                  DEC     C
  C44C    81             C                  ADD     A,C
  C44D    67             C                  LD      H,A
  C44E    22 B190        C                  LD      (MS.ZMAX),HL
  C451    CD D426        C                  CALL    TA.LOES
  C454    2A B24D        C                  LD      HL,(TS.STACK)
  C457    E5             C                  PUSH    HL
  C458    FD 6E 02       C                  LD      L,(IY+2)            ;Routine  NEG QUIT
  C45B    FD 66 03       C                  LD      H,(IY+3)
  C45E    E5             C                  PUSH    HL
  C45F    FD 6E 04       C                  LD      L,(IY+4)            ;Routine  POS QUIT
  C462    FD 66 05       C                  LD      H,(IY+5)
  C465    E5             C                  PUSH    HL
  C466    ED 73 B24D     C                  LD      (TS.STACK),SP
  C46A    21 C49D        C                  LD      HL,S1.ANZ7
  C46D    22 B223        C                  LD      (TS.TAB4),HL
  C470    21 C4AC        C                  LD      HL,S1.ANZ8
  C473    22 B21B        C                  LD      (TS.TAB3+4),HL
  C476    FD 6E 06       C                  LD      L,(IY+6)            ;Routine  alphanum. Tasten
  C479    FD 66 07       C                  LD      H,(IY+7)
  C47C    22 B22D        C                  LD      (TS.EINA),HL
  C47F    FD 7E 01       C                  LD      A,(IY+1)
  C482    32 B23F        C                  LD      (TS.SPMER),A
  C485    3E 06          C                  LD      A,6                 ;Cursor setzen
  C487    32 B198        C                  LD      (MS.CMD),A
  C48A    CD CB16        C                  CALL    MO.MONI
  C48D    21 C2A8        C                  LD      HL,S1.TFE
  C490    E5             C                  PUSH    HL
  C491    C9             C                  RET                         ;zur Tastaturabfrageschleife
                         C      
                         C      
  C492    C1             C      S1.ANZ2:    POP     BC                  ;Register herstellen
  C493    E1             C                  POP     HL
  C494    D1             C                  POP     DE
  C495    F1             C                  POP     AF
  C496    DD E1          C                  POP     IX
  C498    FD 23          C                  INC     IY
  C49A    FD E3          C                  EX      (SP),IY
  C49C    C9             C                  RET                         ;Ruecksprung zum naechsten Befehl
                         C      
  C49D    FD E1          C      S1.ANZ7:    POP     IY                  ;RET TA.MM   Rueckkehr POS_QUIT
  C49F    FD E1          C                  POP     IY                  ;RET ABFR
  C4A1    FD E1          C                  POP     IY                  ;POS QUIT
  C4A3    E1             C                  POP     HL                  ;NEG QUIT
  C4A4    FD 2B          C      S1.ANZ9:    DEC     IY
  C4A6    E1             C                  POP     HL                  ;TS.STACK
  C4A7    22 B24D        C                  LD      (TS.STACK),HL
  C4AA    18 E6          C                  JR      S1.ANZ2
                         C      
  C4AC    FD E1          C      S1.ANZ8:    POP     IY                  ;RET TA.MM   Rueckkehr NEG_QUIT
  C4AE    FD E1          C                  POP     IY                  ;RET ABFR
  C4B0    FD E1          C                  POP     IY                  ;POS QUIT
  C4B2    FD E1          C                  POP     IY                  ;NEG QUIT
  C4B4    18 EE          C                  JR      S1.ANZ9
                         C      
                         C                  PAGE
'Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-22


                         C      
                         C      ;****************************************************************
                         C      ;*               Vergleich der Zeichenketten                    *
                         C      ;****************************************************************
  C4B6    D5             C      S1.VERGL:   PUSH    DE                  ;DE = gegebene  ZK
  C4B7    1A             C      S1.VERG1:   LD      A,(DE)              ;B  = Laenge
  C4B8    BE             C                  CP      (HL)                ;HL = vermutete ZK
  C4B9    20 04          C                  JR      NZ,S1.VERG2
  C4BB    13             C                  INC     DE
  C4BC    23             C                  INC     HL
  C4BD    10 F8          C                  DJNZ    S1.VERG1
  C4BF    D1             C      S1.VERG2:   POP     DE                  ;Z  = 1 : Kette gefunden B = 0
  C4C0    C9             C                  RET                         ;HL = Kette + 1    DE := DE
                         C      ;****************************************************************
                         C      ;*               Zeichen suchen                                 *
                         C      ;****************************************************************
  C4C1    3A B193        C      S1.SZEI:    LD      A,(MS.SPANZ)
  C4C4    47             C      S1.SZEI1:   LD      B,A
  C4C5    05             C                  DEC     B
  C4C6    3E 28          C                  LD      A,40
  C4C8    32 B198        C                  LD      (MS.CMD),A
  C4CB    CD CB16        C      S1.SZEI2:   CALL    MO.MONI
  C4CE    3A B199        C                  LD      A,(MS.TK)
  C4D1    FE 20          C                  CP      ' '
  C4D3    C0             C                  RET     NZ
  C4D4    10 F5          C                  DJNZ    S1.SZEI2
  C4D6    C9             C                  RET                         ;Z = 0 falls kein Zeichen
                         C      ;****************************************************************
                         C      ;*               Spalten- bzw. Zeilenanzahl berechnen           *
                         C      ;****************************************************************
  C4D7    E5             C      S1.SZAHL:   PUSH    HL
  C4D8    2A B18F        C                  LD      HL,(MS.SMIN)
  C4DB    3A B191        C      S1.SZA1:    LD      A,(MS.SMAX)
  C4DE    18 07          C                  JR      S1.ZAHL
  C4E0    E5             C      S1.ZZAHL:   PUSH    HL
  C4E1    2A B18E        C                  LD      HL,(MS.ZMIN)
  C4E4    3A B190        C      S1.ZZA1:    LD      A,(MS.ZMAX)
  C4E7    95             C      S1.ZAHL:    SUB     L
  C4E8    3C             C                  INC     A
  C4E9    E1             C                  POP     HL
  C4EA    C9             C                  RET                         ;A = Zeilen- bzw. Spaltenanzahl
                         C      ;
  C4EB    FB             C      S1.IO:      EI
  C4EC    ED 4D          C                  RETI
                         C      
                         C      ;****************************************************************
                         C      ;*              Anzeige eines Fehlertextes bei S0.FKADR und     *
                         C      ;*              Sprung zur Systemgrundanzeige                   *
                         C      ;*              HL  Adresse des Fehlertextes (38 Byte)          *
                         C      ;****************************************************************
  C4EE    CD C511        C      S1.FEH:     CALL    S1.FEH1
  C4F1    C3 C114        C                  JP      S1.SYSTB
                         C      
                         C                  PAGE
'Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-23


                         C      
                         C      ;****************************************************************
                         C      ;*               Anzeige eines Fehlertextes bei S0.FKADR und    *
                         C      ;*          bei  FEHRR und POS/NEG QUIT       Ruecksprung       *
                         C      ;*          bei  FEHR  und NEG QUIT           Sprung zum System *
                         C      ;*          bei  FEHR  und POS QUIT           Ruecksprung       *
                         C      ;*               HL  Adresse des Fehlertextes (38 Byte)         *
                         C      ;*               DE  Tastenroutinenadresse  POS QUIT            *
                         C      ;*               BC  Tastenroutinenadresse  NEG QUIT  nur FEHRR *
                         C      ;****************************************************************
  C4F4    01 C114        C      S1.FEHR:    LD      BC,S1.SYSTB
  C4F7    C5             C      S1.FEHRR:   PUSH    BC
  C4F8    D5             C                  PUSH    DE
  C4F9    CD C511        C                  CALL    S1.FEH1
  C4FC    CD D40E        C                  CALL    TA.LOE
  C4FF    E1             C                  POP     HL
  C500    22 B223        C                  LD      (TS.TAB4),HL
  C503    E1             C                  POP     HL
  C504    22 B21B        C                  LD      (TS.TAB3+4),HL
  C507    3E 80          C                  LD      A,10000000B
  C509    32 B23F        C                  LD      (TS.SPMER),A
  C50C    21 C2A8        C                  LD      HL,S1.TFE
  C50F    E5             C                  PUSH    HL
  C510    C9             C                  RET
                         C      
  C511    E5             C      S1.FEH1:    PUSH    HL
  C512    AF             C                  XOR     A
  C513    32 B247        C                  LD      (TS.MIO),A
  C516    CD D66D        C                  CALL    K1.MVS
  C519    E1             C                  POP     HL
  C51A    ED 5B B132     C                  LD      DE,(K2.FKADR)
  C51E    15             C                  DEC     D
  C51F    1D             C                  DEC     E
  C520    ED 53 B18C     C                  LD      (MS.ZPOS),DE
  C524    3E 18          C                  LD      A,24
  C526    32 B198        C                  LD      (MS.CMD),A
  C529    06 26          C                  LD      B,38
  C52B    CD CB16        C                  CALL    MO.MONI
  C52E    CD D684        C                  CALL    K1.MVL
  C531    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*               Unterprogramm bestimmt Parameter nach          *
                         C      ;*               Befehlsname                                    *
                         C      ;*               D             = Parameter binaer               *
                         C      ;*               DM1 ... DM1+8 = Parameter hexadezimal          *
                         C      ;****************************************************************
  C532    26 07          C      S1.INPTR:   LD      H,7
  C534    2E 0A          C                  LD      L,S0.SYSZ-1
  C536    22 B18A        C                  LD      (MS.ZPOL),HL
  C539    06 09          C                  LD      B,9
  C53B    21 B29A        C                  LD      HL,S2.DM1
  C53E    3E 2C          C                  LD      A,44
  C540    32 B198        C                  LD      (MS.CMD),A
  C543    CD CB16        C                  CALL    MO.MONI
  C546    21 B29A        C                  LD      HL,S2.DM1
  C549    CD C5CC        C                  CALL    S1.HBKON
  C54C    57             C                  LD      D,A
  C54D    C9             C                  RET
                         C      
                         C                  PAGE
'Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-24


                         C      
                         C      ;****************************************************************
                         C      ;*               Konvertierung Binaerwert in  HL                *
                         C      ;*               ==> ISO - Dezimalwert ab  (DE)                 *
                         C      ;****************************************************************
  C54E    01 2710        C      S1.HDI:     LD      BC,10000
  C551    CD C56C        C                  CALL    S1.HDI1
  C554    01 03E8        C                  LD      BC,1000
  C557    CD C56C        C                  CALL    S1.HDI1
  C55A    01 0064        C                  LD      BC,100
  C55D    CD C56C        C                  CALL    S1.HDI1
  C560    01 000A        C                  LD      BC,10
  C563    CD C56C        C                  CALL    S1.HDI1
  C566    7D             C                  LD      A,L
  C567    F6 30          C                  OR      30H
  C569    12             C                  LD      (DE),A
  C56A    13             C                  INC     DE
  C56B    C9             C                  RET
  C56C    CD C589        C      S1.HDI1:    CALL    S1.DIV
  C56F    F6 30          C                  OR      30H
  C571    FE 30          C                  CP      30H
  C573    20 0D          C                  JR      NZ,S1.HDI3
  C575    47             C                  LD      B,A
  C576    1B             C                  DEC     DE
  C577    1A             C                  LD      A,(DE)
  C578    13             C                  INC     DE
  C579    FE 3A          C                  CP      ':'
  C57B    30 08          C                  JR      NC,S1.HDI2
  C57D    FE 30          C                  CP      '0'
  C57F    38 04          C                  JR      C,S1.HDI2
  C581    78             C                  LD      A,B
  C582    12             C      S1.HDI3:    LD      (DE),A
  C583    13             C                  INC     DE
  C584    C9             C                  RET
  C585    3E 20          C      S1.HDI2:    LD      A,' '
  C587    18 F9          C                  JR      S1.HDI3
                         C      ;****************************************************************
                         C      ;*               Division HL/BC                                 *
                         C      ;****************************************************************
  C589    AF             C      S1.DIV:     XOR     A
  C58A    ED 42          C      S1.DIV1:    SBC     HL,BC
  C58C    3C             C                  INC     A
  C58D    30 FB          C                  JR      NC,S1.DIV1
  C58F    09             C                  ADD     HL,BC
  C590    3D             C                  DEC     A                   ;A:=HL/BC  HL:=Rest
  C591    C9             C                  RET
                         C      
                         C                  PAGE
'Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-25


                         C      
                         C      ;****************************************************************
                         C      ;*               Konvertierung ISO - Dezimalwert ab  (DE)       *
                         C      ;*               ==>  Binaerwert in  HL                         *
                         C      ;*               Zahl < 10000                                   *
                         C      ;****************************************************************
  C592    0E 06          C      S1.IDH:     LD      C,6
  C594    CD C5B4        C                  CALL    S1.IDH1
  C597    D8             C                  RET     C                   ;CY = 1 Fehler: keine Zahl ab (DE)
  C598    26 00          C                  LD      H,0
  C59A    6F             C      S1.IDH2:    LD      L,A
  C59B    13             C                  INC     DE
  C59C    0D             C                  DEC     C
  C59D    C8             C                  RET     Z                   ;Z  = 1 Fehler: Stellenzahl > 5
  C59E    CD C5B4        C      S1.IDH3:    CALL    S1.IDH1
  C5A1    38 0D          C                  JR      C,S1.IDHE           ;CY = 1 wenn Zahl zu Ende
  C5A3    CD C5C3        C                  CALL    S1.MUL10
  C5A6    38 06          C                  JR      C,S1.IDHF           ;CY = 1 wenn Zahl > FFFFH
  C5A8    85             C                  ADD     A,L
  C5A9    30 EF          C                  JR      NC,S1.IDH2
  C5AB    24             C                  INC     H
  C5AC    18 EC          C                  JR      S1.IDH2
  C5AE    AF             C      S1.IDHF:    XOR     A
  C5AF    C9             C                  RET                         ;Z  = 1 Fehler: Zahl > FFFFH
  C5B0    3E 01          C      S1.IDHE:    LD      A,1
  C5B2    B7             C                  OR      A
  C5B3    C9             C                  RET                         ;Z  = CY = 0  kein Fehler
  C5B4    1A             C      S1.IDH1:    LD      A,(DE)
  C5B5    CD C5BC        C                  CALL    S1.SIEBD
  C5B8    D8             C                  RET     C
  C5B9    E6 0F          C                  AND     0FH
  C5BB    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*               Test: ISO - Zeichen = Ziffer ?                 *
                         C      ;****************************************************************
  C5BC    FE 30          C      S1.SIEBD:   CP      '0'
  C5BE    D8             C                  RET     C
  C5BF    FE 3A          C                  CP      ':'
  C5C1    3F             C                  CCF
  C5C2    C9             C                  RET                         ;CY = 1 wenn A keine Dez.Ziffer
                         C      ;****************************************************************
                         C      ;*               Multiplikation  HL * 10                        *
                         C      ;****************************************************************
  C5C3    D5             C      S1.MUL10:   PUSH    DE
  C5C4    E5             C                  PUSH    HL
  C5C5    D1             C                  POP     DE
  C5C6    29             C                  ADD     HL,HL
  C5C7    29             C                  ADD     HL,HL
  C5C8    19             C                  ADD     HL,DE
  C5C9    29             C                  ADD     HL,HL
  C5CA    D1             C                  POP     DE
  C5CB    C9             C                  RET                         ;HL := HL * 10
                         C      
                         C                  PAGE
'Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-26


                         C      
                         C      ;****************************************************************
                         C      ;*               Hexadezimal - Binaer - Konvertierung           *
                         C      ;*               HL = Anfangsadresse des Hexazeichens           *
                         C      ;*               A  = Binaerzeichen                             *
                         C      ;****************************************************************
  C5CC    C5             C      S1.HBKON:   PUSH    BC
  C5CD    06 00          C                  LD      B,0
  C5CF    7E             C                  LD      A,(HL)              ;1.Zeichen
  C5D0    23             C                  INC     HL
  C5D1    CD C5E8        C                  CALL    S1.KON1
  C5D4    38 10          C                  JR      C,S1.HBK1
  C5D6    CB 10          C                  RL      B
  C5D8    CB 10          C                  RL      B
  C5DA    CB 10          C                  RL      B
  C5DC    CB 10          C                  RL      B
  C5DE    7E             C                  LD      A,(HL)              ;2.Zeichen
  C5DF    23             C                  INC     HL
  C5E0    CD C5E8        C                  CALL    S1.KON1
  C5E3    38 01          C                  JR      C,S1.HBK1
  C5E5    78             C                  LD      A,B
  C5E6    C1             C      S1.HBK1:    POP     BC
  C5E7    C9             C                  RET
  C5E8    D6 30          C      S1.KON1:    SUB     30H                 ;Test , ob Hexazeichen
  C5EA    D8             C                  RET     C                   ;kein Hexzeichen
  C5EB    FE 0A          C                  CP      10
  C5ED    38 0B          C                  JR      C,S1.KON3           ;Hexzeichen  0 ... 9
  C5EF    FE 17          C                  CP      17H
  C5F1    3F             C                  CCF
  C5F2    D8             C                  RET     C                   ;kein Hexzeichen
  C5F3    FE 11          C                  CP      11H
  C5F5    D8             C                  RET     C                   ;kein Hexzeichen
  C5F6    E6 0F          C                  AND     0FH                 ;Hexzeichen  A ... F
  C5F8    C6 09          C                  ADD     A,9
  C5FA    B0             C      S1.KON3:    OR      B
  C5FB    47             C                  LD      B,A
  C5FC    37             C                  SCF                         ;CY = 0  Zeichen ist ein Hexazeichen
  C5FD    3F             C                  CCF
  C5FE    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*               Konvertiere 8 Bit von Register A in ASCII      *
                         C      ;*               Hexadezimal auf  (HL)                          *
                         C      ;****************************************************************
  C5FF    F5             C      S1.BHKON:   PUSH    AF                  ;rette A
  C600    1F             C                  RRA
  C601    1F             C                  RRA
  C602    1F             C                  RRA
  C603    1F             C                  RRA
  C604    CD C60E        C                  CALL    S1.KON2             ;konvertiere high order 4 Bits
  C607    23             C                  INC     HL
  C608    F1             C                  POP     AF
  C609    CD C60E        C                  CALL    S1.KON2             ;konvertiere  low order 4 Bits
  C60C    23             C                  INC     HL
  C60D    C9             C                  RET
  C60E    E6 0F          C      S1.KON2:    AND     0FH                 ;Maske fuer   low order 4 Bits
  C610    FE 0A          C                  CP      10
  C612    38 02          C                  JR      C,S1.HB10
  C614    C6 07          C                  ADD     A,7
  C616    C6 30          C      S1.HB10:    ADD     A,30H
  C618    77             C                  LD      (HL),A
  C619    C9             C                  RET
                         C      
                         C                  PAGE
'Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-27


                         C      
                         C      ;****************************************************************
                         C      ;*               Zeichen suchen                                 *
                         C      ;*               (DE),(D+1),... = Suchbereich                   *
                         C      ;*               B              = Laenge                        *
                         C      ;****************************************************************
  C61A    EB             C      S1.SUZEI:   EX      DE,HL
  C61B    CD C4CB        C                  CALL    S1.SZEI2
  C61E    EB             C                  EX      DE,HL               ;A  = Zeichen , DE = Adresse
  C61F    C9             C                  RET                         ;Z  = 1 wenn kein Zeichen
                         C      ;****************************************************************
                         C      ;*               Zahl suchen                                    *
                         C      ;*               (DE),(DE+1),... = Suchbereich                  *
                         C      ;*               B               = Laenge                       *
                         C      ;****************************************************************
  C620    CD C61A        C      S1.SUZA:    CALL    S1.SUZEI
  C623    C8             C                  RET     Z                   ;Z  = 1 : kein Zeichen
  C624    CD C592        C      S1.SUZA1:   CALL    S1.IDH
  C627    D8             C                  RET     C                   ;Z  = 0 CY = 1 : falsche Zahl
  C628    C0             C                  RET     NZ                  ;Z  = 0 CY = 0 : HL = Zahl
  C629    3E 01          C      S1.SUZA3:   LD      A,1
  C62B    B7             C                  OR      A
  C62C    37             C                  SCF
  C62D    C9             C                  RET                         ;Z  = 0 CY = 1 : falsche Zahl
                         C      ;****************************************************************
                         C      ;*               Zahl lesen und pruefen: A' < Zahl =< (IX+0)    *
                         C      ;*               falls Bedingung erfuellt: L  = Zahl Z = CY = 0 *
                         C      ;*               falls keine Zeichen     : Z  = 1               *
                         C      ;*               falls falsche Zahl      : CY = 1               *
                         C      ;****************************************************************
  C62E    CD C620        C      S1.LT1Z:    CALL    S1.SUZA
  C631    D8             C                  RET     C
  C632    C8             C                  RET     Z
  C633    7C             C                  LD      A,H
  C634    B7             C                  OR      A
  C635    20 F2          C                  JR      NZ,S1.SUZA3
  C637    DD 7E 00       C                  LD      A,(IX+0)
  C63A    BD             C                  CP      L
  C63B    D8             C                  RET     C
  C63C    08             C                  EX      AF,AF'              ;'
  C63D    BD             C                  CP      L
  C63E    3F             C                  CCF
  C63F    C9             C                  RET
  C640    DD E9          C      S1.MX:      JP      (IX)
  C642    E5             C      S1.RNR:     PUSH    HL                  ;Rechtsrotieren vor   (HL)
  C643    D1             C                  POP     DE                  ;BC = Anzahl
  C644    1A             C                  LD      A,(DE)
  C645    2B             C                  DEC     HL
  C646    ED B8          C                  LDDR
  C648    12             C                  LD      (DE),A
  C649    C9             C                  RET
  C64A    E5             C      S1.RNL:     PUSH    HL                  ;Linksrotieren hinter (HL)
  C64B    D1             C                  POP     DE                  ;BC = Anzahl
  C64C    1A             C                  LD      A,(DE)
  C64D    23             C                  INC     HL
  C64E    ED B0          C                  LDIR
  C650    12             C                  LD      (DE),A
  C651    C9             C                  RET
                         C      
                         C                  PAGE
'Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-28


                         C      
                         C      ;****************************************************************
                         C      ;*               C R C - Kontrollsumme   berechnen              *
                         C      ;*               -----------------------------------------------*
                         C      ;*               Eingabe:  HL  ... Anfang des Bereiches         *
                         C      ;*                         BC  ... Laenge des Bereiches         *
                         C      ;*               Ausgabe:  DE  ... CRC-Summe ueber den Bereich  *
                         C      ;****************************************************************
  C652    11 FFFF        C      S1.CHK:     LD      DE,0FFFFH
  C655    7E             C      S1.CHK1:    LD      A,(HL)
  C656    AA             C                  XOR     D
  C657    57             C                  LD      D,A
  C658    0F             C                  RRCA
  C659    0F             C                  RRCA
  C65A    0F             C                  RRCA
  C65B    0F             C                  RRCA
  C65C    E6 0F          C                  AND     00FH
  C65E    AA             C                  XOR     D
  C65F    57             C                  LD      D,A
  C660    0F             C                  RRCA
  C661    0F             C                  RRCA
  C662    0F             C                  RRCA
  C663    F5             C                  PUSH    AF
  C664    E6 1F          C                  AND     01FH
  C666    AB             C                  XOR     E
  C667    5F             C                  LD      E,A
  C668    F1             C                  POP     AF
  C669    F5             C                  PUSH    AF
  C66A    0F             C                  RRCA
  C66B    E6 F0          C                  AND     0F0H
  C66D    AB             C                  XOR     E
  C66E    5F             C                  LD      E,A
  C66F    F1             C                  POP     AF
  C670    E6 E0          C                  AND     0E0H
  C672    AA             C                  XOR     D
  C673    53             C                  LD      D,E
  C674    5F             C                  LD      E,A
  C675    23             C                  INC     HL
  C676    0B             C                  DEC     BC
  C677    78             C                  LD      A,B
  C678    B1             C                  OR      C
  C679    20 DA          C                  JR      NZ,S1.CHK1
  C67B    C9             C                  RET
                         C      
                         C                  PAGE
'Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-29


                         C      
                         C      ;****************************************************************
                         C      ;*               Systemzustaende anzeigen                       *
                         C      ;****************************************************************
  C67C    CD CF4B        C      S1.STAT:    CALL    MO.BWSE
  C67F    23             C                  INC     HL
  C680    CD CF5E        C                  CALL    MO.DESZ
  C683    B7             C                  OR      A
  C684    ED 52          C                  SBC     HL,DE
  C686    ED 52          C                  SBC     HL,DE
  C688    E5             C                  PUSH    HL
  C689    EB             C                  EX      DE,HL
  C68A    21 C6DF        C                  LD      HL,S1.STT1
  C68D    01 001B        C                  LD      BC,27
  C690    ED B0          C                  LDIR
  C692    E1             C                  POP     HL
  C693    CD CF5E        C                  CALL    MO.DESZ
  C696    19             C                  ADD     HL,DE
  C697    EB             C                  EX      DE,HL
  C698    3A B264        C                  LD      A,(S2.IOC)
  C69B    B7             C                  OR      A
  C69C    28 05          C                  JR      Z,S1.STTT1
  C69E    21 C6FA        C                  LD      HL,S1.STT2
  C6A1    18 03          C                  JR      S1.STTT2
  C6A3    21 C701        C      S1.STTT1:   LD      HL,S1.STT3
  C6A6    01 0007        C      S1.STTT2:   LD      BC,7
  C6A9    ED B0          C                  LDIR
  C6AB    3A B241        C                  LD      A,(TS.KGMER)
  C6AE    B7             C                  OR      A
  C6AF    28 05          C                  JR      Z,S1.STTT3
  C6B1    21 C708        C                  LD      HL,S1.STT4
  C6B4    18 03          C                  JR      S1.STTT4
  C6B6    21 C70F        C      S1.STTT3:   LD      HL,S1.STT5
  C6B9    01 0007        C      S1.STTT4:   LD      BC,7
  C6BC    ED B0          C                  LDIR
  C6BE    3A B240        C                  LD      A,(TS.UMERK)
  C6C1    B7             C                  OR      A
  C6C2    28 05          C                  JR      Z,S1.STTT5
  C6C4    21 C6FA        C                  LD      HL,S1.STT2
  C6C7    18 03          C                  JR      S1.STTT6
  C6C9    21 C701        C      S1.STTT5:   LD      HL,S1.STT3
  C6CC    01 0007        C      S1.STTT6:   LD      BC,7
  C6CF    ED B0          C                  LDIR
  C6D1    21 0003        C                  LD      HL,3
  C6D4    19             C                  ADD     HL,DE
  C6D5    3A B23E        C                  LD      A,(TS.EMERK)
  C6D8    C6 30          C                  ADD     A,30H
  C6DA    77             C                  LD      (HL),A
  C6DB    CD CB45        C                  CALL    MO.BWSUS
  C6DE    C9             C                  RET
                         C      
  C6DF    49 4F 43 5F    C      S1.STT1:    DB      'IOC___TAS___INS MOD___EBENE'
  C6E3    5F 5F 54 41    C      
  C6E7    53 5F 5F 5F    C      
  C6EB    49 4E 53 20    C      
  C6EF    4D 4F 44 5F    C      
  C6F3    5F 5F 45 42    C      
  C6F7    45 4E 45       C      
  C6FA    45 49 4E 20    C      S1.STT2:    DB      'EIN    '
  C6FE    20 20 20       C      
  C701    41 55 53 20    C      S1.STT3:    DB      'AUS    '
  C705    20 20 20       C      
  C708    53 20 20 20    C      S1.STT4:    DB      'S      '
  C70C    20 20 20       C      
  C70F    50 20 20 20    C      S1.STT5:    DB      'P      '
  C713    20 20 20       C      
                         C      
                         C                  TITLE   'System-Kommandos'
                         C                  PAGE
'System-Kommandos'	MACRO-80 3.44	09-Dec-81	PAGE	1-30


                         C      
                         C      ;****************************************************************
                         C      ;*               Kommandos  D A T E  ,  S T A S  ,  P T A S  ,  *
                         C      ;*                          D I N I  ,  I O C E  ,  I O C A     *
                         C      ;****************************************************************
  C716    C716           C                  DW      $
  C718    44 41 54 45    C                  DB      'DATE'
  C71C    26 07          C                  LD      H,7                 ;ZPOL=SYSZ , SPOL=7
  C71E    2E 0A          C                  LD      L,S0.SYSZ-1
  C720    22 B18A        C                  LD      (MS.ZPOL),HL
  C723    21 0004        C                  LD      HL,S3.DATUM-S3.SEAT
  C726    11 A800        C                  LD      DE,S0.DEAT
  C729    19             C                  ADD     HL,DE
  C72A    06 06          C                  LD      B,6
  C72C    3E 2C          C                  LD      A,44
  C72E    32 B198        C                  LD      (MS.CMD),A
  C731    CD CB16        C                  CALL    MO.MONI
  C734    2A B194        C                  LD      HL,(MS.BWSA)        ;Testen, ob Datum vorhanden
  C737    11 0327        C                  LD      DE,10*80 + 7
  C73A    19             C                  ADD     HL,DE
  C73B    7E             C                  LD      A,(HL)        
  C73C    FE 20          C                  CP      ' '
  C73E    20 10          C                  JR      NZ,S1.DATE
                         C                                              ;Kein Datum, dann akt. Datum holen
  C740    C5             C                  PUSH    BC
  C741    D5             C                  PUSH    DE
  C742    21 0004        C                  LD      HL,S3.DATUM-S3.SEAT
  C745    11 A800        C                  LD      DE,S0.DEAT
  C748    19             C                  ADD     HL,DE
  C749    01 06FD        C                  LD      BC,006FDH           ;actual Date ermitteln
  C74C    ED B2          C                  INIR
  C74E    D1             C                  POP     DE
  C74F    C1             C                  POP     BC
                         C      ;
  C750    E1             C      S1.DATE:    POP     HL
  C751    E1             C                  POP     HL
  C752    C9             C                  RET
                         C      ;
                         C      ;
  C753    C753           C                  DW      $
  C755    53 54 41 53    C                  DB      'STAS'
  C759    3E 01          C                  LD      A,1
  C75B    32 B241        C      S1.STAS1:   LD      (TS.KGMER),A
  C75E    18 F0          C                  JR      S1.DATE
                         C      
  C760    C760           C                  DW      $
  C762    50 54 41 53    C                  DB      'PTAS'
  C766    AF             C                  XOR     A
  C767    18 F2          C                  JR      S1.STAS1
                         C      
                         C      
  C769    C769           C                  DW      $
  C76B    49 4F 43 45    C                  DB      'IOCE'
  C76F    3E 01          C                  LD      A,1
  C771    32 B264        C      S1.IOCC:    LD      (S2.IOC),A
  C774    18 DA          C                  JR      S1.DATE
                         C      
  C776    C776           C                  DW      $
  C778    49 4F 43 41    C                  DB      'IOCA'
  C77C    AF             C                  XOR     A
  C77D    18 F2          C                  JR      S1.IOCC
                         C      
                         C                  PAGE
'System-Kommandos'	MACRO-80 3.44	09-Dec-81	PAGE	1-31


                         C      
  C77F    C77F           C                  DW      $
  C781    44 49 4E 49    C                  DB      'DINI'
  C785    DD 21 0096     C                  LD      IX,S3.PRIN-S3.SEAT
  C789    11 A803        C                  LD      DE,S0.DEAT+3
  C78C    DD 19          C                  ADD     IX,DE
  C78E    26 07          C                  LD      H,7                 ;ZPOL=SYSZ , SPOL=8
  C790    2E 0A          C                  LD      L,S0.SYSZ-1
  C792    22 B18A        C                  LD      (MS.ZPOL),HL
  C795    3E 1F          C                  LD      A,31                ;HL:=ZPOS,SPOS
  C797    32 B198        C                  LD      (MS.CMD),A
  C79A    CD CB16        C                  CALL    MO.MONI
  C79D    7E             C                  LD      A,(HL)              ;char per inch
  C79E    23             C                  INC     HL
  C79F    FE 30          C                  CP      '0'
  C7A1    28 0A          C                  JR      Z,S1.CPI10
  C7A3    FE 32          C                  CP      '2'
  C7A5    20 0A          C                  JR      NZ,S1.CPI
  C7A7    DD CB 04 C6    C                  SET     0,(IX+4)
  C7AB    18 04          C                  JR      S1.CPI
  C7AD    DD CB 04 86    C      S1.CPI10:   RES     0,(IX+4)
  C7B1    7E             C      S1.CPI:     LD      A,(HL)              ;line per inch
  C7B2    23             C                  INC     HL
  C7B3    FE 36          C                  CP      '6'
  C7B5    28 0A          C                  JR      Z,S1.LPI6
  C7B7    FE 38          C                  CP      '8'
  C7B9    20 0A          C                  JR      NZ,S1.LPI
  C7BB    DD CB 04 CE    C                  SET     1,(IX+4)
  C7BF    18 04          C                  JR      S1.LPI
  C7C1    DD CB 04 8E    C      S1.LPI6:    RES     1,(IX+4)
  C7C5    7E             C      S1.LPI:     LD      A,(HL)              ;ohne/mit Nulldurchstreichung
  C7C6    23             C                  INC     HL
  C7C7    FE 4F          C                  CP      'O'
  C7C9    28 08          C                  JR      Z,S1.ONULL
  C7CB    FE 4D          C                  CP      'M'
  C7CD    20 04          C                  JR      NZ,S1.ONULL
  C7CF    3E FF          C                  LD      A,-1
  C7D1    18 01          C                  JR      S1.NULL
  C7D3    AF             C      S1.ONULL:   XOR     A
  C7D4    DD 77 0C       C      S1.NULL:    LD      (IX+12),A
  C7D7    CD C02D        C                  CALL    S1.SM
  C7DA    C3 C750        C                  JP      S1.DATE
                         C      
                         C      
  C7DD    C7DD           C                  DW      $
  C7DF    45 58 45 43    C                  DB      'EXEC'
  C7E3    CD C532        C                  CALL    S1.INPTR
  C7E6    CD C5CC        C                  CALL    S1.HBKON
  C7E9    5F             C                  LD      E,A
  C7EA    D5             C                  PUSH    DE
  C7EB    E1             C                  POP     HL
  C7EC    E9             C                  JP      (HL)
                         C      
                         C                  PAGE
'System-Kommandos'	MACRO-80 3.44	09-Dec-81	PAGE	1-32


                         C      
                         C      ;****************************************************************
                         C      ;*              M E M O --- Anzeige von 16 x 16 Byte = 256 Byte *
                         C      ;****************************************************************
  C7ED    C7ED           C                  DW      $
  C7EF    4D 45 4D 4F    C                  DB      'MEMO'
  C7F3    CD C532        C                  CALL    S1.INPTR            ;Anfangsanzeigeadresse uebernehmen
  C7F6    CD C5CC        C                  CALL    S1.HBKON
  C7F9    5F             C                  LD      E,A
  C7FA    ED 53 B292     C                  LD      (S2.DMANF),DE
  C7FE    CD D426        C      S1.DB0:     CALL    TA.LOES
  C801    21 C825        C                  LD      HL,S1.ANZUM         ;Routine  ASCII- / Hex- Mode
  C804    22 B1FF        C                  LD      (TS.TAB2),HL
  C807    21 C896        C                  LD      HL,S1.NEGDB         ;Routine  blaettern zurueck
  C80A    22 B21B        C                  LD      (TS.TAB3+4),HL
  C80D    21 C877        C                  LD      HL,S1.POSDB         ;Routine  blaettern vor
  C810    22 B223        C                  LD      (TS.TAB4),HL
  C813    21 CA02        C                  LD      HL,S1.HCDB0         ;Hardcopyroutine
  C816    22 B21F        C                  LD      (TS.TAB3+8),HL
  C819    21 C929        C                  LD      HL,S1.SYDB1         ;Routine  aktivieren Korrektur
  C81C    22 B221        C                  LD      (TS.TAB3+10),HL
  C81F    21 C86E        C                  LD      HL,S1.EINDB         ;Routine  alphanum. Tasten
  C822    22 B22D        C                  LD      (TS.EINA),HL
  C825    CD C8B0        C      S1.ANZUM:   CALL    S1.ANZU1
  C828    01 0100        C      S1.DB1:     LD      BC,100H             ;Anzeigebild aufbauen
  C82B    11 0200        C                  LD      DE,200H
  C82E    CD C935        C      S1.DB111:   CALL    S1.MEAA
  C831    3A B240        C                  LD      A,(TS.UMERK)        ;Bildfenster fuer Eingabe definieren
  C834    B7             C                  OR      A
  C835    20 0D          C                  JR      NZ,S1.DB12
  C837    21 0700        C      S1.DB10:    LD      HL,00700H           ;ZPOS= 1 , SPOS= 8
  C83A    22 B18C        C      S1.DB11:    LD      (MS.ZPOS),HL
  C83D    24             C                  INC     H                   ;ZMIN= 1 , SPOS=..
  C83E    2C             C                  INC     L
  C83F    22 B18E        C                  LD      (MS.ZMIN),HL
  C842    18 0C          C                  JR      S1.DB13
  C844    3A B193        C      S1.DB12:    LD      A,(MS.SPANZ)        ;A S C II
  C847    FE 50          C                  CP      80
  C849    20 EC          C                  JR      NZ,S1.DB10
  C84B    21 3B00        C                  LD      HL,03B00H           ;ZPOS= 1 , SPOS=60
  C84E    18 EA          C                  JR      S1.DB11
  C850    3A B240        C      S1.DB13:    LD      A,(TS.UMERK)
  C853    B7             C                  OR      A
  C854    20 05          C                  JR      NZ,S1.DB14
  C856    21 3910        C                  LD      HL,03910H           ;ZMAX=16 , SMAX=57
  C859    18 0F          C                  JR      S1.DB16
  C85B    3A B193        C      S1.DB14:    LD      A,(MS.SPANZ)
  C85E    FE 50          C                  CP      80
  C860    20 05          C                  JR      NZ,S1.DB15
  C862    21 4B10        C                  LD      HL,04B10H           ;ZMAX=16 , SMAX=75
  C865    18 03          C                  JR      S1.DB16
  C867    21 2710        C      S1.DB15:    LD      HL,02710H           ;ZMAX=16 , SMAX=39
  C86A    22 B190        C      S1.DB16:    LD      (MS.ZMAX),HL
  C86D    C9             C                  RET
                         C      
                         C                  PAGE
'System-Kommandos'	MACRO-80 3.44	09-Dec-81	PAGE	1-33


                         C      
  C86E    CD C328        C      S1.EINDB:   CALL    S1.AEIN
  C871    21 B242        C      S1.DB9:     LD      HL,TS.ZSMER
  C874    36 01          C                  LD      (HL),1
  C876    C9             C                  RET
                         C      
  C877    2A B292        C      S1.POSDB:   LD      HL,(S2.DMANF)       ;eine Anzeigeseite weiter
  C87A    3A B240        C                  LD      A,(TS.UMERK)
  C87D    B7             C                  OR      A
  C87E    11 0100        C                  LD      DE,100H
  C881    28 0A          C                  JR      Z,S1.POS2
  C883    3A B193        C      S1.POS1:    LD      A,(MS.SPANZ)
  C886    FE 50          C                  CP      80
  C888    28 03          C                  JR      Z,S1.POS2
  C88A    11 0200        C                  LD      DE,200H
  C88D    19             C      S1.POS2:    ADD     HL,DE
  C88E    22 B292        C      S1.DB2:     LD      (S2.DMANF),HL
  C891    CD C871        C                  CALL    S1.DB9
  C894    18 92          C                  JR      S1.DB1
                         C      
  C896    2A B292        C      S1.NEGDB:   LD      HL,(S2.DMANF)
  C899    3A B240        C                  LD      A,(TS.UMERK)
  C89C    B7             C                  OR      A
  C89D    11 0100        C                  LD      DE,100H
  C8A0    28 0A          C                  JR      Z,S1.NEG2
  C8A2    3A B193        C      S1.NEG1:    LD      A,(MS.SPANZ)
  C8A5    FE 50          C                  CP      80
  C8A7    28 03          C                  JR      Z,S1.NEG2
  C8A9    11 0200        C                  LD      DE,200H
  C8AC    ED 52          C      S1.NEG2:    SBC     HL,DE
  C8AE    18 DE          C                  JR      S1.DB2
                         C      
  C8B0    3A B240        C      S1.ANZU1:   LD      A,(TS.UMERK)
  C8B3    B7             C                  OR      A
  C8B4    20 04          C                  JR      NZ,$+6
  C8B6    3E AA          C                  LD      A,10101010B
  C8B8    18 02          C                  JR      $+4
  C8BA    3E FF          C                  LD      A,11111111B
  C8BC    32 B23F        C                  LD      (TS.SPMER),A
  C8BF    C9             C                  RET
                         C      
  C8C0    C5             C      S1.ANZU2:   PUSH    BC
  C8C1    C5             C                  PUSH    BC
  C8C2    CD C8B0        C                  CALL    S1.ANZU1
  C8C5    C1             C                  POP     BC
  C8C6    D1             C                  POP     DE
  C8C7    C3 C82E        C                  JP      S1.DB111
                         C      
                         C                  PAGE
'System-Kommandos'	MACRO-80 3.44	09-Dec-81	PAGE	1-34


                         C      
                         C      ;****************************************************************
                         C      ;*               Abspeichern der Korrekturen                    *
                         C      ;****************************************************************
  C8CA    01 0100        C      S1.SYSDB:   LD      BC,100H             ;Anzahl anzuzeigender Byte
  C8CD    D9             C      S1.SYDB2:   EXX
  C8CE    06 10          C                  LD      B,16                ;max. Anzahl Zeilen
  C8D0    2A B194        C                  LD      HL,(MS.BWSA)        ;BWS      - Anfangsadresse
  C8D3    11 0007        C                  LD      DE,7
  C8D6    19             C                  ADD     HL,DE
  C8D7    ED 5B B292     C                  LD      DE,(S2.DMANF)       ;Speicher - Anfangsadresse
  C8DB    C5             C      S1.SDB1:    PUSH    BC
  C8DC    E5             C                  PUSH    HL
  C8DD    3A B240        C                  LD      A,(TS.UMERK)        ;INS_MOD ein/aus ?
  C8E0    B7             C                  OR      A
  C8E1    20 21          C                  JR      NZ,S1.SDB5
                         C      
  C8E3    06 04          C                  LD      B,4                 ;INS_MOD aus
  C8E5    C5             C      S1.SDB2:    PUSH    BC
  C8E6    06 04          C                  LD      B,4
  C8E8    CD C5CC        C      S1.SDB3:    CALL    S1.HBKON
  C8EB    12             C                  LD      (DE),A
  C8EC    CD C9FB        C                  CALL    S1.INC1
  C8EF    28 34          C                  JR      Z,S1.SDB9           ;alle Byte uebernommen
  C8F1    D9             C                  EXX
  C8F2    10 F4          C                  DJNZ    S1.SDB3             ;naechstes Byte
  C8F4    23             C                  INC     HL
  C8F5    C1             C                  POP     BC
  C8F6    10 ED          C                  DJNZ    S1.SDB2             ;naechste  Vierergruppe
  C8F8    06 00          C      S1.SDB4:    LD      B,0                 ;BWS-Adresse erhoehen
  C8FA    3A B193        C                  LD      A,(MS.SPANZ)
  C8FD    4F             C                  LD      C,A
  C8FE    E1             C                  POP     HL
  C8FF    09             C                  ADD     HL,BC
  C900    C1             C                  POP     BC
  C901    10 D8          C                  DJNZ    S1.SDB1                ;naechste  BWS-Zeile
  C903    C9             C                  RET
                         C      
  C904    3A B193        C      S1.SDB5:    LD      A,(MS.SPANZ)        ;INS_MOD ein
  C907    FE 50          C                  CP      80
  C909    20 08          C                  JR      NZ,S1.SDB6
  C90B    01 0034        C                  LD      BC,52
  C90E    09             C                  ADD     HL,BC
  C90F    06 10          C                  LD      B,16
  C911    18 02          C                  JR      S1.SDB7
  C913    06 20          C      S1.SDB6:    LD      B,32
  C915    7E             C      S1.SDB7:    LD      A,(HL)
  C916    FE 2E          C                  CP      '.'
  C918    28 01          C                  JR      Z,S1.SDB8
  C91A    12             C                  LD      (DE),A
  C91B    CD C9FB        C      S1.SDB8:    CALL    S1.INC1
  C91E    28 06          C                  JR      Z,S1.SDB10          ;alle Byte uebernommen
  C920    D9             C                  EXX
  C921    10 F2          C                  DJNZ    S1.SDB7             ;naechstes Byte
  C923    18 D3          C                  JR      S1.SDB4             ;naechste  Zeile
                         C      
  C925    C1             C      S1.SDB9:    POP     BC
  C926    E1             C      S1.SDB10:   POP     HL
  C927    C1             C                  POP     BC
  C928    C9             C                  RET
                         C      
  C929    CD C8CA        C      S1.SYDB1:   CALL    S1.SYSDB
  C92C    C3 C828        C                  JP      S1.DB1
                         C      
                         C      
                         C      ;****************************************************************
                         C      ;*            Aufbau des Speicheranzeigebildes                  *
                         C      ;****************************************************************
  C92F    01 0100        C      S1.MEA:     LD      BC,100H
  C932    11 0200        C                  LD      DE,200H
  C935    2A B194        C      S1.MEAA:    LD      HL,(MS.BWSA)
  C938    23             C                  INC     HL
  C939    E5             C                  PUSH    HL
  C93A    D9             C                  EXX
  C93B    ED 5B B292     C                  LD      DE,(S2.DMANF)
  C93F    D9             C                  EXX
  C940    3A B193        C                  LD      A,(MS.SPANZ)
  C943    FE 50          C                  CP      80
  C945    20 31          C                  JR      NZ,S1.MEA5
  C947    C5             C                  PUSH    BC                  ;BWS = 80 Spalten
  C948    D1             C                  POP     DE
  C949    D9             C                  EXX
'System-Kommandos'	MACRO-80 3.44	09-Dec-81	PAGE	1-35


  C94A    CD C995        C      S1.MEA11:   CALL    S1.HXN1             ;Puffer fuellen
  C94D    06 10          C                  LD      B,16
  C94F    CD C9E4        C      S1.MEA12:   CALL    S1.MEAU2
  C952    E1             C      S1.MEA13:   POP     HL
  C953    D5             C                  PUSH    DE
  C954    EB             C                  EX      DE,HL               ;Puffer ===> BWSA
  C955    CD CF4B        C                  CALL    MO.BWSE
  C958    23             C                  INC     HL
  C959    01 0050        C                  LD      BC,80
  C95C    ED B0          C                  LDIR
  C95E    EB             C                  EX      DE,HL
  C95F    D1             C                  POP     DE
  C960    E5             C                  PUSH    HL
  C961    D9             C                  EXX
  C962    C5             C                  PUSH    BC                  ;Anzahl noch anzuzeigender Byte
  C963    D1             C                  POP     DE
  C964    78             C                  LD      A,B
  C965    B1             C                  OR      C
  C966    28 28          C                  JR      Z,S1.MEA14          ;alle Byte angezeigt
  C968    D9             C                  EXX
  C969    3A B193        C                  LD      A,(MS.SPANZ)        ;naechste Zeile aufbereiten
  C96C    FE 50          C                  CP      80
  C96E    28 DA          C                  JR      Z,S1.MEA11
  C970    3A B240        C                  LD      A,(TS.UMERK)
  C973    B7             C                  OR      A
  C974    28 0B          C                  JR      Z,S1.MEA21
  C976    18 11          C                  JR      S1.MEA31
                         C      
  C978    3A B240        C      S1.MEA5:    LD      A,(TS.UMERK)        ;BWS < 80 Spalten
  C97B    B7             C                  OR      A
  C97C    20 08          C                  JR      NZ,S1.MEA6
  C97E    C5             C                  PUSH    BC                  ;BWS < 80 Spalten, INS_MOD aus
  C97F    D1             C                  POP     DE
  C980    D9             C                  EXX
  C981    CD C995        C      S1.MEA21:   CALL    S1.HXN1
  C984    18 CC          C                  JR      S1.MEA13
                         C      
  C986    D5             C      S1.MEA6:    PUSH    DE                  ;BWS < 80 Spalten, INS_MOD ein
  C987    C1             C                  POP     BC
  C988    D9             C                  EXX
  C989    CD C9B0        C      S1.MEA31:   CALL    S1.PULOE
  C98C    06 20          C                  LD      B,32
  C98E    18 BF          C                  JR      S1.MEA12
                         C      
  C990    E1             C      S1.MEA14:   POP     HL
  C991    CD F60C        C                  CALL    S0.BWSUS            ;BWSA ===> BWS
  C994    C9             C                  RET
                         C      
  C995    CD CF4B        C      S1.HXN1:    CALL    MO.BWSE
  C998    23             C                  INC     HL
  C999    D5             C                  PUSH    DE                  ;(S2.DMANF)
  C99A    CD C9B0        C                  CALL    S1.PULOE
  C99D    7A             C                  LD      A,D                 ;Zeilenadresse aufbereiten
  C99E    CD C5FF        C                  CALL    S1.BHKON
  C9A1    7B             C                  LD      A,E
  C9A2    CD C5FF        C                  CALL    S1.BHKON
  C9A5    23             C                  INC     HL
  C9A6    23             C                  INC     HL
  C9A7    CD C9BF        C                  CALL    S1.MEAU1
  C9AA    D1             C                  POP     DE                  ;(S2.DMANF)
  C9AB    D9             C                  EXX
  C9AC    D5             C                  PUSH    DE                  ;Anzahl Byte erneut bereitstellen
  C9AD    C1             C                  POP     BC
  C9AE    D9             C                  EXX
  C9AF    C9             C                  RET
                         C      
  C9B0    E5             C      S1.PULOE:   PUSH    HL
  C9B1    D5             C                  PUSH    DE
  C9B2    E5             C                  PUSH    HL                  ;Puffer loeschen
  C9B3    D1             C                  POP     DE
  C9B4    13             C                  INC     DE
  C9B5    01 004F        C                  LD      BC,79
  C9B8    36 20          C                  LD      (HL),' '
  C9BA    ED B0          C                  LDIR
  C9BC    D1             C                  POP     DE                  ;(S2.DMANF)
  C9BD    E1             C                  POP     HL                  ;Pufferanfangsadresse
  C9BE    C9             C                  RET
                         C      
                         C                  PAGE
'System-Kommandos'	MACRO-80 3.44	09-Dec-81	PAGE	1-36


                         C      
                         C      ;****************************************************************
                         C      ;*               Hexadezimale Darstellung                       *
                         C      ;****************************************************************
  C9BF    06 04          C      S1.MEAU1:   LD      B,4                 ;vier Vierergruppen aufbereiten
  C9C1    C5             C      S1.MEA2:    PUSH    BC
  C9C2    06 04          C                  LD      B,4
  C9C4    1A             C      S1.MEA3:    LD      A,(DE)              ;Vierergruppe
  C9C5    CD C5FF        C                  CALL    S1.BHKON
  C9C8    CD C9FB        C                  CALL    S1.INC1
  C9CB    28 0F          C                  JR      Z,S1.MEA4
  C9CD    D9             C                  EXX
  C9CE    10 F4          C                  DJNZ    S1.MEA3             ;naechstes Byte
  C9D0    23             C                  INC     HL
  C9D1    C1             C                  POP     BC
  C9D2    10 ED          C                  DJNZ    S1.MEA2             ;naechste  Vierergruppe
  C9D4    C9             C                  RET
                         C      
  C9D5    C5             C      S1.MEA32:   PUSH    BC
  C9D6    06 04          C                  LD      B,4
  C9D8    23             C      S1.MEA33:   INC     HL
  C9D9    23             C                  INC     HL
  C9DA    23             C                  INC     HL
  C9DB    D9             C                  EXX
  C9DC    D9             C      S1.MEA4:    EXX
  C9DD    10 F9          C                  DJNZ    S1.MEA33
  C9DF    23             C                  INC     HL
  C9E0    C1             C                  POP     BC                  ;Vierergruppenzaehler
  C9E1    10 F2          C                  DJNZ    S1.MEA32
  C9E3    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*               A S C II - Darstellung                         *
                         C      ;****************************************************************
  C9E4    1A             C      S1.MEAU2:   LD      A,(DE)
  C9E5    FE 20          C                  CP      ' '
  C9E7    38 04          C                  JR      C,S1.MEA7
  C9E9    FE 7E          C                  CP      '~'
  C9EB    38 02          C                  JR      C,S1.MEA9
  C9ED    3E 2E          C      S1.MEA7:    LD      A,'.'
  C9EF    77             C      S1.MEA9:    LD      (HL),A
  C9F0    CD C9FB        C                  CALL    S1.INC1
  C9F3    28 04          C                  JR      Z,S1.MEA8
  C9F5    D9             C                  EXX
  C9F6    10 EC          C                  DJNZ    S1.MEAU2            ;naechstes Byte
  C9F8    C9             C                  RET
                         C      
  C9F9    D9             C      S1.MEA8:    EXX
  C9FA    C9             C                  RET
                         C      
                         C      
  C9FB    23             C      S1.INC1:    INC     HL
  C9FC    13             C                  INC     DE
  C9FD    D9             C                  EXX
  C9FE    0B             C      S1.INC2:    DEC     BC
  C9FF    78             C                  LD      A,B
  CA00    B1             C                  OR      C
  CA01    C9             C                  RET
                         C      
                         C                  PAGE
'System-Kommandos'	MACRO-80 3.44	09-Dec-81	PAGE	1-37


                         C      
                         C      ;****************************************************************
                         C      ;*               Hard-COPY - Routine fuer  M E M O              *
                         C      ;****************************************************************
  CA02    CD CA08        C      S1.HCDB0:   CALL    S1.HCDB
  CA05    C3 C877        C                  JP      S1.POSDB            ;naechste Seite anzeigen
                         C      
  CA08    DD E5          C      S1.HCDB:    PUSH    IX
  CA0A    FD E5          C                  PUSH    IY
  CA0C    3A B240        C                  LD      A,(TS.UMERK)
  CA0F    B7             C                  OR      A
  CA10    28 07          C                  JR      Z,S1.HCDB1
  CA12    AF             C                  XOR     A
  CA13    32 B240        C                  LD      (TS.UMERK),A
  CA16    CD C825        C                  CALL    S1.ANZUM
  CA19    DD 2A B292     C      S1.HCDB1:   LD      IX,(S2.DMANF)       ;Anzeigeanfangsadresse
  CA1D    FD 2A B194     C                  LD      IY,(MS.BWSA)
  CA21    FD 23          C                  INC     IY
  CA23    06 10          C                  LD      B,16                ;Anzahl Zeilen
  CA25    C5             C      S1.HCDB2:   PUSH    BC                  ;Zyklus ueber 16 Zeilen
  CA26    06 3A          C                  LD      B,58                ;Zeilenanfadr und Hex-Darstellung
  CA28    FD 7E 00       C      S1.HCDB3:   LD      A,(IY)              ;uebernehmen
  CA2B    FD 23          C                  INC     IY
  CA2D    4F             C                  LD      C,A
  CA2E    CD F59C        C                  CALL    SM.PRIO             ;ein Zeichen drucken
  CA31    10 F5          C                  DJNZ    S1.HCDB3               ;naechstes Zeichen
  CA33    06 10          C                  LD      B,16                ;ASCII-Darstellung uebernehmen
  CA35    DD 7E 00       C      S1.HCDB4:   LD      A,(IX)
  CA38    DD 23          C                  INC     IX
  CA3A    FE 7F          C                  CP      7FH
  CA3C    30 04          C                  JR      NC,S1.HCDB5
  CA3E    FE 20          C                  CP      ' '
  CA40    30 02          C                  JR      NC,S1.HCDB6
  CA42    3E 2E          C      S1.HCDB5:   LD      A,'.'
  CA44    4F             C      S1.HCDB6:   LD      C,A
  CA45    CD F59C        C                  CALL    SM.PRIO             ;ASCII-Zeichen drucken
  CA48    10 EB          C                  DJNZ    S1.HCDB4            ;naechstes Zeichen
  CA4A    0E 1E          C                  LD      C,1EH               ;Zeilenende ausgeben
  CA4C    CD F59C        C                  CALL    SM.PRIO
  CA4F    06 16          C                  LD      B,22                ;IY korrigieren
  CA51    FD 23          C      S1.HCDB7:   INC     IY
  CA53    10 FC          C                  DJNZ    S1.HCDB7
  CA55    C1             C                  POP     BC
  CA56    10 CD          C                  DJNZ    S1.HCDB2               ;naechste Zeile
  CA58    0E 1E          C                  LD      C,1EH               ;zwei Leerzeilen ausgeben
  CA5A    CD F59C        C                  CALL    SM.PRIO
  CA5D    CD F59C        C                  CALL    SM.PRIO
  CA60    FD E1          C                  POP     IY
  CA62    DD E1          C                  POP     IX
  CA64    C9             C                  RET
                         C      
  CA65                   C      S1.OPEN     EQU     $
  CA65                   C      S1.CLOS     EQU     $
  CA65                   C      S1.LESV     EQU     $
  CA65                   C      S1.LESR     EQU     $
  CA65                   C      S1.SCHR     EQU     $
  CA65    C9             C                  RET
                         C      
                         C      ;           END
                         C      ;           PN      S310
                         C                  TITLE   'Generierprogramm fuer die E-/A-Tabelle'
                         C                  PAGE
'Generierprogramm fuer die E-/A-Tabelle'	MACRO-80 3.44	09-Dec-81	PAGE	1-38


                         C      
                         C      ;****************************************************************
                         C      ;*               Generierprogramm fuer die E-/A-Tabelle         *
                         C      ;*  Version      -----------------------------------------------*
                         C      ;*               Programmierer: M. Herbote --- K EAW  ZFT (WFT) *
                         C      ;*  V 2 . 1      -----------------------------------------------*
                         C      ;*               Stand        : 27.Januar 1984                  *
                         C      ;****************************************************************
                         C      
                         C      
                         C      ;****************************************************************
                         C      ;*               Macro zu Erzeugung des Steuervektors nach      *
                         C      ;*               ROBOTRON - MOS                                 *
                         C      ;****************************************************************
                         C      S3.RMOS     MACRO   SB,FB,BA,SA,CMD,ENTRY,PUADR,PULAE,INF1,INF2,INF3
                         C                  DB      SB                  ;Statusbyte
                         C                  DB      FB                  ;Fehlerbyte
                         C                  DB      BA                  ;Basisadresse
                         C                  DB      SA                  ;Subadresse
                         C                  DB      CMD                 ;Kommando
                         C                  DW      ENTRY               ;Rueckehradresse
                         C                  DW      PUADR               ;Pufferadresse
                         C                  DB      HIGH(PULAE)         ;Pufferlaenge
                         C                  DB      LOW(PULAE)
                         C                  DB      INF1                ;Informationsbyte 1
                         C                  DB      INF2                ;Informationsbyte 2
                         C                  DB      INF3                ;Informationsbyte 3
                         C                  ENDM
                         C      
                         C      ;****************************************************************
                         C      ;*               allgemeine Speicherplaetze der statischen      *
                         C      ;*               E-/A-Tabelle                                   *
                         C      ;****************************************************************
  CA66                   C      S3.SEAT     EQU     $
  CA66    AA             C      S3.MASK1:   DB      0AAH                ;Systemmaske 1
  CA67    55             C      S3.MASK2:   DB      055H                ;Systemmaske 2
  CA68    FF             C      S3.MASK3:   DB      0FFH                ;Systemmaske 3
  CA69    00             C      S3.MASK4:   DB      000H                ;Systemmaske 4
                         C      
  CA6A    3232           C      S3.DATUM:   DW      S0.D1               ;Stand des Systems
  CA6C    3330           C                  DW      S0.D2
  CA6E    3538           C                  DW      S0.D3
                         C      
  CA70    BBF0           C      S3.PUFA:    DW      S0.PFFA             ;Adresse des Ausgabepuffers
  CA72    B7E0           C      S3.PUFI:    DW      S0.PFFI             ;Adresse des Eingabepuffers
  CA74    0400           C      S3.LANG:    DW      1024                ;Pufferlaenge
                         C      
  CA76    00             C                  DB      0
  CA77    00             C                  DB      0
  CA78    00             C      S3.STI:     DB      0
                         C      
                         C                  TITLE   'Kanal - Tabellen'
                         C                  PAGE
'Kanal - Tabellen'	MACRO-80 3.44	09-Dec-81	PAGE	1-39


                         C      
                         C      ;****************************************************************
                         C      ;*               K a s s e t t e 1                              *
                         C      ;****************************************************************
  CA79    1B             C      S3.KS1:     DB      S3.KS2-S3.KS1       ;Laengenbyte
  CA7A    C0             C                  DB      11000000B           ;Typ - Kennsatz ja , SYS-Geraet
  CA7B    C1             C                  DB      11000001B           ;Geraetebyte
                         C                  S3.RMOS 0,0,S0.AKB,1,0,0,S0.PFFI,100H,0,0,0
  CA7C    00             C+                 DB      0                  ;Statusbyte
  CA7D    00             C+                 DB      0                  ;Fehlerbyte
  CA7E    30             C+                 DB      S0.AKB                  ;Basisadresse
  CA7F    01             C+                 DB      1                  ;Subadresse
  CA80    00             C+                 DB      0                 ;Kommando
  CA81    0000           C+                 DW      0               ;Rueckehradresse
  CA83    B7E0           C+                 DW      S0.PFFI               ;Pufferadresse
  CA85    01             C+                 DB      HIGH(100H)         ;Pufferlaenge
  CA86    00             C+                 DB      LOW(100H)
  CA87    00             C+                 DB      0                ;Informationsbyte 1
  CA88    00             C+                 DB      0                ;Informationsbyte 2
  CA89    00             C+                 DB      0                ;Informationsbyte 3
  CA8A    0000           C                  DW      0                   ;OPEN
  CA8C    0000           C                  DW      0                   ;CLOSE
  CA8E    0000           C                  DW      0                   ;READ
  CA90    0000           C                  DW      0                   ;WRITE
  CA92    0000           C                  DW      0                   ;KONV
                         C      ;****************************************************************
                         C      ;*               K a s s e t t e 2                              *
                         C      ;****************************************************************
  CA94    1B             C      S3.KS2:     DB      S3.DFU-S3.KS2       ;Laengenbyte
  CA95    80             C                  DB      10000000B           ;Typ - Kennsatz ja
  CA96    C1             C                  DB      11000001B           ;Geraetebyte
                         C                  S3.RMOS 0,0,S0.AKB,2,0,0,S0.PFFI,100H,0,0,0
  CA97    00             C+                 DB      0                  ;Statusbyte
  CA98    00             C+                 DB      0                  ;Fehlerbyte
  CA99    30             C+                 DB      S0.AKB                  ;Basisadresse
  CA9A    02             C+                 DB      2                  ;Subadresse
  CA9B    00             C+                 DB      0                 ;Kommando
  CA9C    0000           C+                 DW      0               ;Rueckehradresse
  CA9E    B7E0           C+                 DW      S0.PFFI               ;Pufferadresse
  CAA0    01             C+                 DB      HIGH(100H)         ;Pufferlaenge
  CAA1    00             C+                 DB      LOW(100H)
  CAA2    00             C+                 DB      0                ;Informationsbyte 1
  CAA3    00             C+                 DB      0                ;Informationsbyte 2
  CAA4    00             C+                 DB      0                ;Informationsbyte 3
  CAA5    0000           C                  DW      0                   ;OPEN
  CAA7    0000           C                  DW      0                   ;CLOSE
  CAA9    0000           C                  DW      0                   ;READ
  CAAB    0000           C                  DW      0                   ;WRITE
  CAAD    0000           C                  DW      0                   ;KONV
                         C      
                         C                  PAGE
'Kanal - Tabellen'	MACRO-80 3.44	09-Dec-81	PAGE	1-40


                         C      
                         C      ;****************************************************************
                         C      ;*               D F U - Fernuebertragung                       *
                         C      ;****************************************************************
  CAAF    1B             C      S3.DFU:     DB      S3.LBL-S3.DFU       ;Laengenbyte
  CAB0    80             C                  DB      10000000B           ;Typ - Kennsatz ja
  CAB1    C0             C                  DB      11000000B           ;Geraetebyte
                         C                  S3.RMOS 0,0,S0.V24,0,0,0,S0.PFFI,400H,0,0,0
  CAB2    00             C+                 DB      0                  ;Statusbyte
  CAB3    00             C+                 DB      0                  ;Fehlerbyte
  CAB4    50             C+                 DB      S0.V24                  ;Basisadresse
  CAB5    00             C+                 DB      0                  ;Subadresse
  CAB6    00             C+                 DB      0                 ;Kommando
  CAB7    0000           C+                 DW      0               ;Rueckehradresse
  CAB9    B7E0           C+                 DW      S0.PFFI               ;Pufferadresse
  CABB    04             C+                 DB      HIGH(400H)         ;Pufferlaenge
  CABC    00             C+                 DB      LOW(400H)
  CABD    00             C+                 DB      0                ;Informationsbyte 1
  CABE    00             C+                 DB      0                ;Informationsbyte 2
  CABF    00             C+                 DB      0                ;Informationsbyte 3
  CAC0    0000           C                  DW      0                   ;OPEN
  CAC2    0000           C                  DW      0                   ;CLOSE
  CAC4    0000           C                  DW      0                   ;READ
  CAC6    0000           C                  DW      0                   ;WRITE
  CAC8    0000           C                  DW      0                   ;KONV
                         C      ;****************************************************************
                         C      ;*               L B - L e s e r                                *
                         C      ;****************************************************************
  CACA    19             C      S3.LBL:     DB      S3.LBS-S3.LBL       ;Laengenbyte
  CACB    00             C                  DB      00000000B           ;Typ - Kennsatz nein
  CACC    40             C                  DB      01000000B           ;Geraetebyte
                         C                  S3.RMOS 0,0,S0.ADA,0,02H,0,S0.PFFI,400H,7FH,19H,0
  CACD    00             C+                 DB      0                  ;Statusbyte
  CACE    00             C+                 DB      0                  ;Fehlerbyte
  CACF    00             C+                 DB      S0.ADA                  ;Basisadresse
  CAD0    00             C+                 DB      0                  ;Subadresse
  CAD1    02             C+                 DB      02H                 ;Kommando
  CAD2    0000           C+                 DW      0               ;Rueckehradresse
  CAD4    B7E0           C+                 DW      S0.PFFI               ;Pufferadresse
  CAD6    04             C+                 DB      HIGH(400H)         ;Pufferlaenge
  CAD7    00             C+                 DB      LOW(400H)
  CAD8    7F             C+                 DB      7FH                ;Informationsbyte 1
  CAD9    19             C+                 DB      19H                ;Informationsbyte 2
  CADA    00             C+                 DB      0                ;Informationsbyte 3
  CADB    0000           C                  DW      0                   ;OPEN
  CADD    0000           C                  DW      0                   ;CLOSE
  CADF    0000           C                  DW      0                   ;READ
  CAE1    0000           C                  DW      0                   ;KONV
                         C      ;****************************************************************
                         C      ;*               L B - S t a n z e r                            *
                         C      ;****************************************************************
  CAE3    19             C      S3.LBS:     DB      S3.PRIN-S3.LBS      ;Laengenbyte
  CAE4    00             C                  DB      00000000B           ;Typ - Kennsatz nein
  CAE5    80             C                  DB      10000000B           ;Geraetebyte
                         C                  S3.RMOS 0,0,S0.ADA,0,0,0,S0.PFFA,400H,80H,19H,0
  CAE6    00             C+                 DB      0                  ;Statusbyte
  CAE7    00             C+                 DB      0                  ;Fehlerbyte
  CAE8    00             C+                 DB      S0.ADA                  ;Basisadresse
  CAE9    00             C+                 DB      0                  ;Subadresse
  CAEA    00             C+                 DB      0                 ;Kommando
  CAEB    0000           C+                 DW      0               ;Rueckehradresse
  CAED    BBF0           C+                 DW      S0.PFFA               ;Pufferadresse
  CAEF    04             C+                 DB      HIGH(400H)         ;Pufferlaenge
  CAF0    00             C+                 DB      LOW(400H)
  CAF1    80             C+                 DB      80H                ;Informationsbyte 1
  CAF2    19             C+                 DB      19H                ;Informationsbyte 2
  CAF3    00             C+                 DB      0                ;Informationsbyte 3
  CAF4    0000           C                  DW      0                   ;OPEN
  CAF6    0000           C                  DW      0                   ;CLOSE
  CAF8    0000           C                  DW      0                   ;WRITE
  CAFA    0000           C                  DW      0                   ;KONV
                         C      ;****************************************************************
                         C      ;*               P R I N - Drucker                              *
                         C      ;****************************************************************
  CAFC    19             C      S3.PRIN:    DB      S3.ENDEA-S3.PRIN    ;Laengenbyte
  CAFD    00             C                  DB      00000000B           ;Typ - Kennsatz nein
  CAFE    81             C                  DB      10000001B           ;Geraetebyte
                         C                  S3.RMOS 0,0,S0.DRU,S0.IVSYS,0,0,S0.PFFA,400H,0,0,0
  CAFF    00             C+                 DB      0                  ;Statusbyte
  CB00    00             C+                 DB      0                  ;Fehlerbyte
  CB01    40             C+                 DB      S0.DRU                  ;Basisadresse
  CB02    58             C+                 DB      S0.IVSYS                  ;Subadresse
'Kanal - Tabellen'	MACRO-80 3.44	09-Dec-81	PAGE	1-41


  CB03    00             C+                 DB      0                 ;Kommando
  CB04    0000           C+                 DW      0               ;Rueckehradresse
  CB06    BBF0           C+                 DW      S0.PFFA               ;Pufferadresse
  CB08    04             C+                 DB      HIGH(400H)         ;Pufferlaenge
  CB09    00             C+                 DB      LOW(400H)
  CB0A    00             C+                 DB      0                ;Informationsbyte 1
  CB0B    00             C+                 DB      0                ;Informationsbyte 2
  CB0C    00             C+                 DB      0                ;Informationsbyte 3
  CB0D    F588           C                  DW      SM.MRES             ;OPEN
  CB0F    0000           C                  DW      0                   ;CLOSE
  CB11    F59C           C                  DW      SM.PRIO             ;WRITE
  CB13    0000           C                  DW      0                   ;KONV
                         C      
  CB15    00             C      S3.ENDEA:   DB      0                   ;Ende - Kanaltabellen
                         C      
                         C                  PAGE
'Kanal - Tabellen'	MACRO-80 3.44	09-Dec-81	PAGE	1-42


                         C      
                         C      ;****************************************************************
                         C      ;*               K S K         Kennsatz-Section Kassette        *
                         C      ;****************************************************************
  CB16                   C      S3.KSK1     EQU     $                   ;Kassettengeraet 1
                         C      
  CB16                   C      S3.RCZ1     EQU     S3.KSK1             ;record counter
  CB18                   C      S3.BLK1     EQU     S3.RCZ1+2           ;block  counter
  CB1A                   C      S3.MRP1     EQU     S3.BLK1+2           ;MRES - Parameterbereich
                         C      
                         C      
                         C      
  CB3A                   C      S3.KSK2     EQU     S3.MRP1+32          ;Kassettengeraet 2
                         C      
  CB3A                   C      S3.RCZ2     EQU     S3.KSK2             ;record counter
  CB3C                   C      S3.BLK2     EQU     S3.RCZ2+2           ;block  counter
  CB3E                   C      S3.MRP2     EQU     S3.BLK2+2           ;MRES - Parameterbereich
                         C      
                         C      
                         C      ;           END
                         C      ;           PN      MO26
                         C                  TITLE   'Monitorroutine'
                         C                  PAGE
'Monitorroutine'	MACRO-80 3.44	09-Dec-81	PAGE	1-43


                         C      
                         C      ;****************************************************************
                         C      ;*               Monitorroutine                                 *
                         C      ;*  Version      -----------------------------------------------*
                         C      ;*               Programmierer: M. Herbote --- K EAW  ZFT (WFT) *
                         C      ;*  V 2 . 1      -----------------------------------------------*
                         C      ;*               Stand        : 05.April 1984                   *
                         C      ;****************************************************************
                         C      
                         C      
                         C      ;****************************************************************
                         C      ;*                1.Aufteilung des Monitorbildes                *
                         C      ;*                ------------------------------                *
                         C      ;*   1         a       i   k         b                   m      *
                         C      ;*   -----------------------------------------------------      *
                         C      ;* 1 !A       !       SSA LSA         !                  !      *
                         C      ;*   !                                                   !      *
                         C      ;*   !- - - - ! - - - - - - - - - - - ! - - - - - - - - -!      *
                         C      ;* c !         AF    SSAF LSAF                           !      *
                         C      ;*   !        !                       !                  !      *
                         C      ;*   !                                                   !      *
                         C      ;* j !SZA     !SZAF    S              !                  !      *
                         C      ;*   !                                                   !      *
                         C      ;* l !LZA     !LZAF        L          !                  !      *
                         C      ;*   !                                                   !      *
                         C      ;*   !        !                       !                  !      *
                         C      ;* d !                                                   !      *
                         C      ;*   !- - - - ! - - - - - - - - - - - ! - - - - - - - - -!      *
                         C      ;*   !                                                   !      *
                         C      ;* n !        !                       !                  !      *
                         C      ;*   -----------------------------------------------------      *
                         C      ;*                                                              *
                         C      ;*                2.Kommandos und ihre Bedeutung                *
                         C      ;*                ------------------------------                *
                         C      ;*    Schreibposition          !   Leseposition                 *
                         C      ;*  ---------------------------!------------------------------  *
                         C      ;*  = 10 ZPOS,SPOS:=HL         ! = 30 ZPOL,SPOL:=HL             *
                         C      ;*  = 11 HL:=ZPOS,SPOS         ! = 31 HL:=ZPOL,SPOL             *
                         C      ;*  = 12 HL:=SZA               ! = 32 HL:=LZA                   *
                         C      ;*  = 13 HL:=SZAF              ! = 33 HL:=LZAF                  *
                         C      ;*  = 14 HL:=SSA               ! = 34 HL:=LSA                   *
                         C      ;*  = 15 HL:=SSAF              ! = 35 HL:=LSAF                  *
                         C      ;*  = 20 Zeichen schreiben     ! = 40 Zeichen lesen             *
                         C      ;*  = 21 akt. Position + 1     ! = 41 akt. Position + 1         *
                         C      ;*  = 22 HOME-Fkt. Schreibpos. ! = 42 HOME-Fkt. Lesepos.        *
                         C      ;*  = 23 n. Zeile Anf. "       ! = 43 n. Zeile Anf. "           *
                         C      ;*  = 24 Vektor schreiben      ! = 44 Vektor lesen              *
                         C      ;*                                                              *
                         C      ;*                                                              *
                         C      ;*                                                              *
                         C      ;*                                                              *
                         C      ;****************************************************************
                         C      
                         C                  PAGE
'Monitorroutine'	MACRO-80 3.44	09-Dec-81	PAGE	1-44


                         C      
                         C      ;****************************************************************
                         C      ;*  =  0 ZANZ:=24,SPANZ:=80                                     *
                         C      ;*  =  1 ZMIN,SMIN:=1,ZMAX,SMAX:=ZANZ,SPANZ                     *
                         C      ;*  =  2 ZMIN,SMIN:=1,ZMAX:=ZANZ-2,SMAX:=SPANZ                  *
                         C      ;*  =  3 ZMIN,ZMAX:=SYSZ,SMIN:=3,SMAX:=16                       *
                         C      ;*  =  4 gesamtes Bild loeschen                                 *
                         C      ;*  =  5 Bildfenster   loeschen                                 *
                         C      ;*  =  6 Cursor setzen                                          *
                         C      ;*  =  7 Cursor loeschen                                        *
                         C      ;*                                                              *
                         C      ;*  = 50 HL:=AF                                                 *
                         C      ;*  = 51 BC:=Laenge Bildspeicher                                *
                         C      ;*  = 52 HL:=Ende   Bildspeicher                                *
                         C      ;*  = 53 Bildfensterinhalt eine Zeile  nach oben                *
                         C      ;*  = 54 Bildfensterinhalt eine Zeile  nach unten               *
                         C      ;*  = 55 Bildfensterinhalt eine Spalte nach links               *
                         C      ;*  = 56 Bildfensterinhalt eine Spalte nach unten               *
                         C      ;*                                                              *
                         C      ;*                3.Bedeutung von  DIRES  und  DIREL            *
                         C      ;*                ----------------------------------            *
                         C      ;*  Bit 7 = 0   Schreib-/Lese-position nicht weiter setzen      *
                         C      ;*        = 1   Schreib-/Lese-position       weiter setzen      *
                         C      ;*      6 = 0   Schreib-/Lese-position umlaufend auf Zeile      *
                         C      ;*        = 1   Schreib-/Lese-position umlaufend im Bild        *
                         C      ;*      5 = 0   Rollfunktion ausgeschaltet  (nur DIRES)         *
                         C      ;*        = 1   Rollfunktion eingeschaltet  (nur DIRES)         *
                         C      ;*      4 = 0   Bildfensterinhalt rollen    (nur DIRES)         *
                         C      ;*        = 1   gesamte Zeile     rollen    (nur DIRES)         *
                         C      ;*      3 = 0   mit  Umladen  BWSA ===> BWS                     *
                         C      ;*        = 1   ohne Umladen  BWSA ===> BWS                     *
                         C      ;*                                                              *
                         C      ;*      2,1,0   geben die Richtung an , in welcher die          *
                         C      ;*              Schreib-/Lese-position weitergesetzt werden     *
                         C      ;*              soll                                            *
                         C      ;*                            010                               *
                         C      ;*                        (011) (001)                           *
                         C      ;*                      100         000                         *
                         C      ;*                        (101) (111)                           *
                         C      ;*                            110                               *
                         C      ;*                                                              *
                         C      ;*                                                              *
                         C      ;*                                                              *
                         C      ;****************************************************************
                         C      
                         C                  TITLE   'Eintritt in die Routine'
                         C                  PAGE
'Eintritt in die Routine'	MACRO-80 3.44	09-Dec-81	PAGE	1-45


                         C      
                         C      ;****************************************************************
                         C      ;*               Eintritt in die Monitorroutine und             *
                         C      ;*               Verzweigen zu den einzelnen Kommandos          *
                         C      ;****************************************************************
  CB16    DD E5          C      MO.MONI:    PUSH    IX
  CB18    FD E5          C                  PUSH    IY
  CB1A    F5             C                  PUSH    AF
  CB1B    D5             C                  PUSH    DE
  CB1C    C5             C                  PUSH    BC
  CB1D    3A B198        C                  LD      A,(MS.CMD)
  CB20    FE 39          C                  CP      57
  CB22    30 16          C                  JR      NC,MO.ENMO
  CB24    E5             C                  PUSH    HL
  CB25    87             C                  ADD     A,A
  CB26    06 00          C                  LD      B,0
  CB28    4F             C                  LD      C,A
  CB29    21 CB59        C                  LD      HL,MO.MOTAB
  CB2C    09             C                  ADD     HL,BC
  CB2D    7E             C                  LD      A,(HL)
  CB2E    23             C                  INC     HL
  CB2F    66             C                  LD      H,(HL)
  CB30    6F             C                  LD      L,A
  CB31    E5             C                  PUSH    HL
  CB32    DD E1          C                  POP     IX
  CB34    E1             C                  POP     HL
  CB35    C1             C                  POP     BC
  CB36    C5             C                  PUSH    BC
  CB37    CD CB42        C                  CALL    MO.MORT
  CB3A    C1             C      MO.ENMO:    POP     BC
  CB3B    D1             C                  POP     DE
  CB3C    F1             C                  POP     AF
  CB3D    FD E1          C                  POP     IY
  CB3F    DD E1          C                  POP     IX
  CB41    C9             C                  RET
  CB42    DD E9          C      MO.MORT:    JP      (IX)
  CB44    C9             C      MO.ENMOT:   RET
                         C      
                         C      
  CB45    3A B197        C      MO.BWSUS:   LD      A,(MS.DIRES)
  CB48    CB 5F          C                  BIT     3,A
  CB4A    C0             C                  RET     NZ
  CB4B    CD F60C        C                  CALL    S0.BWSUS
  CB4E    C9             C                  RET
                         C      
  CB4F    3A B197        C      MO.BWSUZ:   LD      A,(MS.DIRES)
  CB52    CB 5F          C                  BIT     3,A
  CB54    C0             C                  RET     NZ
  CB55    CD F5EE        C                  CALL    S0.BWSUZ
  CB58    C9             C                  RET
                         C      
                         C                  TITLE   'Tabelle der Routinenadressen'
                         C                  PAGE
'Tabelle der Routinenadressen'	MACRO-80 3.44	09-Dec-81	PAGE	1-46


                         C      
                         C      ;****************************************************************
                         C      ;*               Tabelle mit den Adressen der Monitorroutinen   *
                         C      ;****************************************************************
  CB59    CBCB           C      MO.MOTAB:   DW      MO.ANZ              ;CMD = 00
  CB5B    CBD5           C                  DW      MO.VOLLB            ;    = 01
  CB5D    CBE4           C                  DW      MO.VB2              ;    = 02
  CB5F    CBF5           C                  DW      MO.SYSB             ;    = 03
  CB61    CC04           C                  DW      MO.BILO             ;    = 04
  CB63    CC1A           C                  DW      MO.FSLO             ;    = 05
  CB65    CD26           C                  DW      MO.SETC             ;    = 06
  CB67    CD49           C                  DW      MO.RESC             ;    = 07
  CB69    CB44           C                  DW      MO.ENMOT            ;    = 08
  CB6B    CB44           C                  DW      MO.ENMOT            ;    = 09
  CB6D    CF75           C                  DW      MO.LCPOS            ;    = 10
  CB6F    CEFC           C                  DW      MO.CPOS             ;    = 11
  CB71    CF2A           C                  DW      MO.SZA              ;    = 12
  CB73    CF3C           C                  DW      MO.SZAF             ;    = 13
  CB75    CF06           C                  DW      MO.SSA              ;    = 14
  CB77    CF18           C                  DW      MO.SSAF             ;    = 15
  CB79    CB44           C                  DW      MO.ENMOT            ;    = 16
  CB7B    CB44           C                  DW      MO.ENMOT            ;    = 17
  CB7D    CB44           C                  DW      MO.ENMOT            ;    = 18
  CB7F    CB44           C                  DW      MO.ENMOT            ;    = 19
  CB81    CFE1           C                  DW      MO.MZS              ;    = 20
  CB83    CFEB           C                  DW      MO.MPS              ;    = 21
  CB85    CFB1           C                  DW      MO.HOMES            ;    = 22
  CB87    CFCB           C                  DW      MO.CNZAS            ;    = 23
  CB89    D107           C                  DW      MO.MVS              ;    = 24
  CB8B    CB44           C                  DW      MO.ENMOT            ;    = 25
  CB8D    CB44           C                  DW      MO.ENMOT            ;    = 26
  CB8F    CB44           C                  DW      MO.ENMOT            ;    = 27
  CB91    CB44           C                  DW      MO.ENMOT            ;    = 28
  CB93    CB44           C                  DW      MO.ENMOT            ;    = 29
  CB95    CF93           C                  DW      MO.LCPOL            ;    = 30
  CB97    CF01           C                  DW      MO.CPOL             ;    = 31
  CB99    CF33           C                  DW      MO.LZA              ;    = 32
  CB9B    CF41           C                  DW      MO.LZAF             ;    = 33
  CB9D    CF13           C                  DW      MO.LSA              ;    = 34
  CB9F    CF25           C                  DW      MO.LSAF             ;    = 35
  CBA1    CB44           C                  DW      MO.ENMOT            ;    = 36
  CBA3    CB44           C                  DW      MO.ENMOT            ;    = 37
  CBA5    CB44           C                  DW      MO.ENMOT            ;    = 38
  CBA7    CB44           C                  DW      MO.ENMOT            ;    = 39
  CBA9    CFF3           C                  DW      MO.MZL              ;    = 40
  CBAB    CFFA           C                  DW      MO.MPL              ;    = 41
  CBAD    CFBE           C                  DW      MO.HOMEL            ;    = 42
  CBAF    CFD6           C                  DW      MO.CNZAL            ;    = 43
  CBB1    D125           C                  DW      MO.MVL              ;    = 44
  CBB3    CB44           C                  DW      MO.ENMOT            ;    = 45
  CBB5    CB44           C                  DW      MO.ENMOT            ;    = 46
  CBB7    CB44           C                  DW      MO.ENMOT            ;    = 47
  CBB9    CB44           C                  DW      MO.ENMOT            ;    = 48
  CBBB    CB44           C                  DW      MO.ENMOT            ;    = 49
  CBBD    CF46           C                  DW      MO.BWSAF            ;    = 50
  CBBF    CF65           C                  DW      MO.BWSL             ;    = 51
  CBC1    CF4B           C                  DW      MO.BWSE             ;    = 52
  CBC3    CC58           C                  DW      MO.ROOB             ;    = 53
  CBC5    CC8F           C                  DW      MO.ROUN             ;    = 54
  CBC7    CCBA           C                  DW      MO.ROLI             ;    = 55
  CBC9    CCD7           C                  DW      MO.RORE             ;    = 56
                         C      
                         C                  TITLE   'Anfangswert UPs'
                         C                  PAGE
'Anfangswert UPs'	MACRO-80 3.44	09-Dec-81	PAGE	1-47


                         C      
                         C      ;****************************************************************
                         C      ;*               belegen der Steuerwerte  SPANZ  und  ZANZ      *
                         C      ;****************************************************************
  CBCB    E5             C      MO.ANZ:     PUSH    HL
  CBCC    26 50          C                  LD      H,S0.SPANZ
  CBCE    2E 18          C                  LD      L,S0.ZANZ
  CBD0    22 B192        C                  LD      (MS.ZANZ),HL
  CBD3    E1             C                  POP     HL
  CBD4    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*               volles Bild  ===> BWS - Format                 *
                         C      ;****************************************************************
  CBD5    E5             C      MO.VOLLB:   PUSH    HL
  CBD6    21 0101        C                  LD      HL,0101H            ;SMIN=1        ZMIN=1
  CBD9    22 B18E        C                  LD      (MS.ZMIN),HL
  CBDC    2A B192        C                  LD      HL,(MS.ZANZ)        ;SMAX=SPANZ    ZMAX=ZANZ
  CBDF    22 B190        C                  LD      (MS.ZMAX),HL
  CBE2    E1             C                  POP     HL
  CBE3    C9             C                  RET
                         C      
                         C      ;****************************************************************
                         C      ;*               volles Bild minus 2 Zeilen ===> BWS - Format   *
                         C      ;****************************************************************
  CBE4    E5             C      MO.VB2:     PUSH    HL
  CBE5    21 0101        C                  LD      HL,0101H            ;SMIN=1        ZMIN=1
  CBE8    22 B18E        C                  LD      (MS.ZMIN),HL
  CBEB    2A B192        C                  LD      HL,(MS.ZANZ)        ;SMAX=SPANZ    ZMAX=ZANZ-2
  CBEE    2D             C                  DEC     L
  CBEF    2D             C                  DEC     L
  CBF0    22 B190        C                  LD      (MS.ZMAX),HL
  CBF3    E1             C                  POP     HL
  CBF4    C9             C                  RET
                         C      
                         C      ;****************************************************************
                         C      ;*               Systemzeile   ===>  BWS - Format               *
                         C      ;****************************************************************
  CBF5    E5             C      MO.SYSB:    PUSH    HL
  CBF6    26 03          C                  LD      H,3                 ;SMIN=3
  CBF8    2E 0B          C                  LD      L,S0.SYSZ           ;ZMIN=SYSZ
  CBFA    22 B18E        C                  LD      (MS.ZMIN),HL
  CBFD    26 18          C                  LD      H,24                ;SMAX=24
  CBFF    22 B190        C                  LD      (MS.ZMAX),HL
  CC02    E1             C                  POP     HL
  CC03    C9             C                  RET
                         C      
                         C                  PAGE
'Anfangswert UPs'	MACRO-80 3.44	09-Dec-81	PAGE	1-48


                         C      
                         C      ;****************************************************************
                         C      ;*               gesamtes Bild loeschen                         *
                         C      ;****************************************************************
  CC04    E5             C      MO.BILO:    PUSH    HL
  CC05    2A B194        C                  LD      HL,(MS.BWSA)
  CC08    23             C                  INC     HL
  CC09    EB             C                  EX      DE,HL
  CC0A    2A B194        C                  LD      HL,(MS.BWSA)
  CC0D    CD CF65        C                  CALL    MO.BWSL
  CC10    0B             C                  DEC     BC
  CC11    36 20          C                  LD      (HL),' '
  CC13    ED B0          C                  LDIR
  CC15    CD CB45        C                  CALL    MO.BWSUS
  CC18    E1             C                  POP     HL
  CC19    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*               Bildfenster loeschen                           *
                         C      ;****************************************************************
  CC1A    E5             C      MO.FSLO:    PUSH    HL
  CC1B    2A B190        C                  LD      HL,(MS.ZMAX)
  CC1E    ED 5B B18E     C                  LD      DE,(MS.ZMIN)
  CC22    AF             C                  XOR     A
  CC23    ED 52          C                  SBC     HL,DE
  CC25    45             C                  LD      B,L
  CC26    04             C                  INC     B
  CC27    C5             C                  PUSH    BC                  ;Anzahl Fensterzeilen
  CC28    4C             C                  LD      C,H
  CC29    C5             C                  PUSH    BC                  ;Anzahl Fensterspalten-1
  CC2A    CD CF46        C                  CALL    MO.BWSAF
  CC2D    E5             C                  PUSH    HL
  CC2E    36 20          C                  LD      (HL),' '            ;erste Zeile loeschen
  CC30    23             C                  INC     HL
  CC31    EB             C                  EX      DE,HL
  CC32    E1             C                  POP     HL
  CC33    E5             C                  PUSH    HL
  CC34    06 00          C                  LD      B,0
  CC36    ED B0          C                  LDIR
  CC38    E1             C      MO.FSLO1:   POP     HL                  ;weitere Zeilen loeschen
  CC39    D1             C                  POP     DE
  CC3A    C1             C                  POP     BC
  CC3B    05             C                  DEC     B
  CC3C    28 15          C                  JR      Z,MO.FSLO2
  CC3E    C5             C                  PUSH    BC
  CC3F    D5             C                  PUSH    DE
  CC40    06 00          C                  LD      B,0
  CC42    4B             C                  LD      C,E
  CC43    0C             C                  INC     C
  CC44    E5             C                  PUSH    HL
  CC45    3A B193        C                  LD      A,(MS.SPANZ)
  CC48    16 00          C                  LD      D,0
  CC4A    5F             C                  LD      E,A
  CC4B    19             C                  ADD     HL,DE
  CC4C    EB             C                  EX      DE,HL
  CC4D    E1             C                  POP     HL
  CC4E    D5             C                  PUSH    DE
  CC4F    ED B0          C                  LDIR
  CC51    18 E5          C                  JR      MO.FSLO1
  CC53    CD CB45        C      MO.FSLO2:   CALL    MO.BWSUS
  CC56    E1             C                  POP     HL
  CC57    C9             C                  RET
                         C                  TITLE   'Bildfensterinhalt rollen'
                         C                  PAGE
'Bildfensterinhalt rollen'	MACRO-80 3.44	09-Dec-81	PAGE	1-49


                         C      
                         C      ;****************************************************************
                         C      ;*               Bildfensterinhalt um eine Zeile nach oben      *
                         C      ;****************************************************************
  CC58    E5             C      MO.ROOB:    PUSH    HL
  CC59    CD CCFA        C                  CALL    MO.RORL1
  CC5C    28 19          C                  JR      Z,MO.ROOB2
  CC5E    F5             C                  PUSH    AF
  CC5F    CD CF46        C                  CALL    MO.BWSAF            ;DE ermitteln
  CC62    E5             C      MO.ROOB1:   PUSH    HL
  CC63    CD CF5E        C                  CALL    MO.DESZ             ;HL ermitteln
  CC66    19             C                  ADD     HL,DE
  CC67    D1             C                  POP     DE
  CC68    D5             C                  PUSH    DE
  CC69    CD CD1C        C                  CALL    MO.RORL5
  CC6C    CD CF5E        C                  CALL    MO.DESZ
  CC6F    E1             C                  POP     HL
  CC70    19             C                  ADD     HL,DE
  CC71    F1             C                  POP     AF
  CC72    3D             C                  DEC     A
  CC73    F5             C                  PUSH    AF
  CC74    20 EC          C                  JR      NZ,MO.ROOB1
  CC76    F1             C                  POP     AF
  CC77    CD CCFE        C      MO.ROOB2:   CALL    MO.RORL7
  CC7A    CD CF46        C                  CALL    MO.BWSAF
  CC7D    CD CF52        C                  CALL    MO.PNSP
  CC80    36 20          C      MO.ROOB3:   LD      (HL),' '
  CC82    E5             C                  PUSH    HL
  CC83    D1             C                  POP     DE
  CC84    13             C                  INC     DE
  CC85    CD CD0A        C                  CALL    MO.RORL3
  CC88    28 03          C                  JR      Z,MO.ROOB4
  CC8A    CD CD20        C                  CALL    MO.RORL6
  CC8D    18 C4          C      MO.ROOB4:   JR      MO.FSLO2
                         C      ;****************************************************************
                         C      ;*               Bildfensterinhalt um eine Zeile nach unten     *
                         C      ;****************************************************************
  CC8F    E5             C      MO.ROUN:    PUSH    HL
  CC90    CD CCFA        C                  CALL    MO.RORL1
  CC93    28 20          C                  JR      Z,MO.ROUN2
  CC95    F5             C                  PUSH    AF                  ;DE ermitteln
  CC96    CD CF46        C                  CALL    MO.BWSAF
  CC99    CD CF52        C                  CALL    MO.PNSP
  CC9C    E5             C      MO.ROUN1:   PUSH    HL
  CC9D    CD CF5E        C                  CALL    MO.DESZ             ;HL ermitteln
  CCA0    B7             C                  OR      A
  CCA1    ED 52          C                  SBC     HL,DE
  CCA3    D1             C                  POP     DE
  CCA4    D5             C                  PUSH    DE
  CCA5    CD CD1C        C                  CALL    MO.RORL5
  CCA8    CD CF5E        C                  CALL    MO.DESZ
  CCAB    E1             C                  POP     HL
  CCAC    B7             C                  OR      A
  CCAD    ED 52          C                  SBC     HL,DE
  CCAF    F1             C                  POP     AF
  CCB0    3D             C                  DEC     A
  CCB1    F5             C                  PUSH    AF
  CCB2    20 E8          C                  JR      NZ,MO.ROUN1
  CCB4    F1             C                  POP     AF
  CCB5    CD CF46        C      MO.ROUN2:   CALL    MO.BWSAF
  CCB8    18 C6          C                  JR      MO.ROOB3
                         C      
                         C                  PAGE
'Bildfensterinhalt rollen'	MACRO-80 3.44	09-Dec-81	PAGE	1-50


                         C      
                         C      ;****************************************************************
                         C      ;*               Bildfensterinhalt um eine Spalte nach links    *
                         C      ;****************************************************************
  CCBA    E5             C      MO.ROLI:    PUSH    HL
  CCBB    CD CD05        C                  CALL    MO.RORL2
  CCBE    08             C                  EX      AF,AF'              ;'
  CCBF    CD CF46        C                  CALL    MO.BWSAF
  CCC2    C5             C      MO.ROLI1:   PUSH    BC
  CCC3    E5             C                  PUSH    HL
  CCC4    E5             C                  PUSH    HL
  CCC5    D1             C                  POP     DE
  CCC6    23             C                  INC     HL
  CCC7    08             C                  EX      AF,AF'              ;'
  CCC8    B7             C                  OR      A
  CCC9    28 03          C                  JR      Z,MO.ROLI2
  CCCB    CD CD20        C                  CALL    MO.RORL6
  CCCE    E1             C      MO.ROLI2:   POP     HL
  CCCF    C1             C                  POP     BC
  CCD0    CD CD11        C                  CALL    MO.RORL4
  CCD3    10 ED          C                  DJNZ    MO.ROLI1
  CCD5    18 B6          C      MO.ROLI3:   JR      MO.ROOB4
                         C      ;****************************************************************
                         C      ;*               Bildfensterinhalt um eine Spalte nach rechts   *
                         C      ;****************************************************************
  CCD7    E5             C      MO.RORE:    PUSH    HL
  CCD8    CD CD05        C                  CALL    MO.RORL2
  CCDB    CD CF46        C                  CALL    MO.BWSAF
  CCDE    16 00          C                  LD      D,0
  CCE0    5F             C                  LD      E,A
  CCE1    08             C                  EX      AF,AF'              ;'
  CCE2    19             C                  ADD     HL,DE
  CCE3    C5             C      MO.RORE1:   PUSH    BC
  CCE4    E5             C                  PUSH    HL
  CCE5    E5             C                  PUSH    HL
  CCE6    D1             C                  POP     DE
  CCE7    2B             C                  DEC     HL
  CCE8    08             C                  EX      AF,AF'              ;'
  CCE9    B7             C                  OR      A
  CCEA    28 05          C                  JR      Z,MO.RORE2
  CCEC    06 00          C                  LD      B,0
  CCEE    4F             C                  LD      C,A
  CCEF    ED B8          C                  LDDR
  CCF1    E1             C      MO.RORE2:   POP     HL
  CCF2    C1             C                  POP     BC
  CCF3    CD CD11        C                  CALL    MO.RORL4
  CCF6    10 EB          C                  DJNZ    MO.RORE1
  CCF8    18 DB          C                  JR      MO.ROLI3
                         C      
                         C                  PAGE
'Bildfensterinhalt rollen'	MACRO-80 3.44	09-Dec-81	PAGE	1-51


                         C      
  CCFA    DD 21 B18E     C      MO.RORL1:   LD      IX,MS.ZMIN
  CCFE    DD 7E 02       C      MO.RORL7:   LD      A,(IX+2)
  CD01    DD 96 00       C                  SUB     (IX+0)
  CD04    C9             C                  RET
                         C      
  CD05    CD CCFA        C      MO.RORL2:   CALL    MO.RORL1
  CD08    47             C                  LD      B,A
  CD09    04             C                  INC     B
  CD0A    DD 7E 03       C      MO.RORL3:   LD      A,(IX+3)
  CD0D    DD 96 01       C                  SUB     (IX+1)
  CD10    C9             C                  RET
                         C      
  CD11    08             C      MO.RORL4:   EX      AF,AF'              ;'
  CD12    EB             C                  EX      DE,HL
  CD13    36 20          C                  LD      (HL),' '
  CD15    26 00          C                  LD      H,0
  CD17    DD 6E 05       C                  LD      L,(IX+5)
  CD1A    19             C                  ADD     HL,DE
  CD1B    C9             C                  RET
                         C      
  CD1C    CD CD0A        C      MO.RORL5:   CALL    MO.RORL3
  CD1F    3C             C                  INC     A
  CD20    06 00          C      MO.RORL6:   LD      B,0
  CD22    4F             C                  LD      C,A
  CD23    ED B0          C                  LDIR
  CD25    C9             C                  RET
                         C      
                         C                  TITLE   'Cursor Operationen'
                         C                  PAGE
'Cursor Operationen'	MACRO-80 3.44	09-Dec-81	PAGE	1-52


                         C      
                         C      ;****************************************************************
                         C      ;*               Cursor setzen bzw. loeschen an der             *
                         C      ;*               aktuellen Schreibposition                      *
                         C      ;****************************************************************
  CD26    E5             C      MO.SETC:    PUSH    HL
  CD27    C5             C                  PUSH    BC
  CD28    F5             C                  PUSH    AF
  CD29    3A B18D        C                  LD      A,(MS.SPOS)         ;X-Koordinate
  CD2C    32 CD43        C                  LD      (MO.SETC1+2),A
  CD2F    3A B18C        C                  LD      A,(MS.ZPOS)         ;Y-Koordinate
  CD32    32 CD44        C                  LD      (MO.SETC1+3),A
  CD35    21 CD41        C                  LD      HL,MO.SETC1         ;Emulator-Routine ansprechen
  CD38    01 0540        C                  LD      BC,00540H
  CD3B    ED B3          C                  OTIR
  CD3D    F1             C                  POP     AF
  CD3E    C1             C                  POP     BC
  CD3F    E1             C                  POP     HL
  CD40    C9             C                  RET
  CD41    F0             C      MO.SETC1:   DB      0F0H
  CD42    01             C                  DB      001H                ;Cursor Ein
  CD43    00             C                  DB      0                   ;X
  CD44    00             C                  DB      0                   ;Y
  CD45    FF             C                  DB      0FFH
                         C      
  CD46    CD CEFC        C                  CALL    MO.CPOS
                         C      
                         C      
                         C      
                         C      ;
  CD49    E5             C      MO.RESC:    PUSH    HL
  CD4A    C5             C                  PUSH    BC
  CD4B    21 CD56        C                  LD      HL,MO.RESC1         ;Emulator-Routine ansprechen
  CD4E    01 0340        C                  LD      BC,00340H
  CD51    ED B3          C                  OTIR
  CD53    C1             C                  POP     BC
  CD54    E1             C                  POP     HL
  CD55    C9             C                  RET
  CD56    F0             C      MO.RESC1:   DB      0F0H
  CD57    02             C                  DB      002H                ;Cursor Aus
  CD58    FF             C                  DB      0FFH            
                         C      ;****************************************************************
                         C      ;*               DZPOS , DSPOS , DZPOL , DSPOL                  *
                         C      ;****************************************************************
  CD59    21 B18A        C      MO.DZPOL:   LD      HL,MS.ZPOL          ;Lesezeilennr.     decr.
  CD5C    CD CD76        C                  CALL    MO.DECZ
  CD5F    18 06          C                  JR      MO.DIL
  CD61    21 B18B        C      MO.DSPOL:   LD      HL,MS.SPOL          ;Lesespaltennr.    decr.
  CD64    CD CD88        C                  CALL    MO.DECS
  CD67    C5             C      MO.DIL:     PUSH    BC
  CD68    CD CF01        C                  CALL    MO.CPOL
  CD6B    C1             C                  POP     BC
  CD6C    3F             C                  CCF                         ;Z = CY = 1  falls Uebertrag
  CD6D    C9             C                  RET
  CD6E    21 B18C        C      MO.DZPOS:   LD      HL,MS.ZPOS          ;Schreibzeilennr.  decr.
  CD71    CD CD76        C                  CALL    MO.DECZ
  CD74    18 22          C                  JR      MO.DIS
  CD76    C5             C      MO.DECZ:    PUSH    BC
  CD77    3A B190        C                  LD      A,(MS.ZMAX)
  CD7A    47             C                  LD      B,A
  CD7B    3A B18E        C                  LD      A,(MS.ZMIN)
  CD7E    18 10          C                  JR      MO.DEC2
  CD80    21 B18D        C      MO.DSPOS:   LD      HL,MS.SPOS          ;Schreibspaltennr. decr.
  CD83    CD CD88        C                  CALL    MO.DECS
  CD86    18 10          C                  JR      MO.DIS
  CD88    C5             C      MO.DECS:    PUSH    BC
  CD89    3A B191        C                  LD      A,(MS.SMAX)
  CD8C    47             C                  LD      B,A
  CD8D    3A B18F        C                  LD      A,(MS.SMIN)
  CD90    3D             C      MO.DEC2:    DEC     A
  CD91    BE             C                  CP      (HL)
  CD92    28 15          C                  JR      Z,MO.DEC3           ;Z=1,CY=0 falls Uebertrag
  CD94    35             C                  DEC     (HL)
  CD95    C3 CEFA        C                  JP      MO.INC4
  CD98    C5             C      MO.DIS:     PUSH    BC
  CD99    CD CEFC        C                  CALL    MO.CPOS
  CD9C    C1             C                  POP     BC
  CD9D    3F             C                  CCF                         ;Z = CY = 1  falls Uebertrag
  CD9E    C9             C                  RET
  CD9F    ED 4B B192     C      MO.ROLL:    LD      BC,(MS.ZANZ)        ;Standardanschlussroutine Rollfkt.
  CDA3    36 20          C      MO.ROL1:    LD      (HL),' '            ;loeschen der Zeile auf blank
  CDA5    23             C                  INC     HL
'Cursor Operationen'	MACRO-80 3.44	09-Dec-81	PAGE	1-53


  CDA6    10 FB          C                  DJNZ    MO.ROL1
  CDA8    C9             C                  RET
                         C                  PAGE
'Cursor Operationen'	MACRO-80 3.44	09-Dec-81	PAGE	1-54


                         C      
  CDA9    F5             C      MO.DEC3:    PUSH    AF                  ;Rollfunktion
  CDAA    C5             C                  PUSH    BC                  ;rollen nach unten raus
  CDAB    D5             C                  PUSH    DE
  CDAC    E5             C                  PUSH    HL
  CDAD    21 B197        C                  LD      HL,MS.DIRES         ;Abfrage , ob Rollen ein
  CDB0    CB 6E          C                  BIT     5,(HL)
  CDB2    28 71          C                  JR      Z,MO.DEC4
  CDB4    CB 66          C                  BIT     4,(HL)
  CDB6    28 74          C                  JR      Z,MO.DEC6
  CDB8    2A B18C        C                  LD      HL,(MS.ZPOS)        ;ZPOS , SPOS retten
  CDBB    E5             C                  PUSH    HL
  CDBC    2A B190        C                  LD      HL,(MS.ZMAX)
  CDBF    25             C                  DEC     H
  CDC0    2D             C                  DEC     L
  CDC1    22 B18C        C                  LD      (MS.ZPOS),HL
  CDC4    CD CF4B        C                  CALL    MO.BWSE             ;DE ermitteln
  CDC7    23             C                  INC     HL
  CDC8    EB             C                  EX      DE,HL
  CDC9    CD CF2A        C                  CALL    MO.SZA              ;HL ermitteln
  CDCC    ED 4B B193     C                  LD      BC,(MS.SPANZ)       ;BC ermitteln
  CDD0    06 00          C                  LD      B,0
  CDD2    ED B0          C                  LDIR                        ;letzte Zeile retten
                         C      
                         C      
                         C      
  CDD4    CD CF2A        C                  CALL    MO.SZA              ;HL ermitteln
  CDD7    2B             C                  DEC     HL
  CDD8    E5             C                  PUSH    HL
  CDD9    CD CF5E        C                  CALL    MO.DESZ             ;DE ermitteln
  CDDC    19             C                  ADD     HL,DE
  CDDD    E5             C                  PUSH    HL
  CDDE    2A B18E        C                  LD      HL,(MS.ZMIN)        ;BC ermitteln
  CDE1    3A B190        C                  LD      A,(MS.ZMAX)
  CDE4    95             C                  SUB     L
  CDE5    F5             C                  PUSH    AF
  CDE6    21 0000        C                  LD      HL,0
  CDE9    CD CF52        C                  CALL    MO.PNSP
  CDEC    F1             C                  POP     AF
  CDED    E5             C                  PUSH    HL
  CDEE    C1             C                  POP     BC
  CDEF    D1             C                  POP     DE
  CDF0    E1             C                  POP     HL
  CDF1    FE 00          C                  CP      0
  CDF3    28 02          C                  JR      Z,MO.DEC5
  CDF5    ED B8          C                  LDDR                        ;Bildfensterzeilen um 1 Zeile nach unten
                         C      
                         C                  PAGE
'Cursor Operationen'	MACRO-80 3.44	09-Dec-81	PAGE	1-55


                         C      
  CDF7    E1             C      MO.DEC5:    POP     HL                  ;rueckspeichern von ZPOS , SPOS
  CDF8    22 B18C        C                  LD      (MS.ZPOS),HL
  CDFB    2A B19A        C                  LD      HL,(MS.RADR)        ;Verzweigen zur Anschlussroutine
  CDFE    E5             C                  PUSH    HL
  CDFF    DD E1          C                  POP     IX
  CE01    CD CF4B        C                  CALL    MO.BWSE             ;Parameter in HL = Adresse der
  CE04    23             C                  INC     HL                  ;rausgerollten Zeile
  CE05    CD CB42        C                  CALL    MO.MORT
                         C      
                         C      
                         C      
  CE08    CD CF4B        C                  CALL    MO.BWSE             ;HL ermitteln
  CE0B    23             C                  INC     HL
  CE0C    E5             C                  PUSH    HL
  CE0D    CD CF2A        C                  CALL    MO.SZA              ;DE ermitteln
  CE10    EB             C                  EX      DE,HL
  CE11    E1             C                  POP     HL
  CE12    ED 4B B193     C                  LD      BC,(MS.SPANZ)       ;BC ermitteln
  CE16    06 00          C                  LD      B,0
  CE18    ED B0          C                  LDIR                        ;aktuelle Zeile neu belegen
                         C      
                         C      
                         C      
  CE1A    CD CB45        C                  CALL    MO.BWSUS
  CE1D    E1             C      MO.DEC7:    POP     HL
  CE1E    D1             C                  POP     DE
  CE1F    C1             C                  POP     BC
  CE20    F1             C                  POP     AF
  CE21    3F             C                  CCF
  CE22    C3 CEFA        C                  JP      MO.INC4
                         C      
  CE25    E1             C      MO.DEC4:    POP     HL
  CE26    D1             C                  POP     DE
  CE27    C1             C                  POP     BC
  CE28    F1             C                  POP     AF
  CE29    C3 CEF7        C                  JP      MO.INC3
                         C      
  CE2C    CD CC8F        C      MO.DEC6:    CALL    MO.ROUN
  CE2F    18 EC          C                  JR      MO.DEC7
                         C      
                         C                  PAGE
'Cursor Operationen'	MACRO-80 3.44	09-Dec-81	PAGE	1-56


                         C      
                         C      ;****************************************************************
                         C      ;*                IZPOS , ISPOS , IZPOL , ISPOL                 *
                         C      ;****************************************************************
  CE31    21 B18A        C      MO.IZPOL:   LD      HL,MS.ZPOL          ;Lesezeilennr.     incr.
  CE34    CD CE4C        C                  CALL    MO.INCZ
  CE37    C3 CD67        C                  JP      MO.DIL
  CE3A    21 B18B        C      MO.ISPOL:   LD      HL,MS.SPOL          ;Lesespaltennr.    incr.
  CE3D    CD CE5F        C                  CALL    MO.INCS
  CE40    C3 CD67        C                  JP      MO.DIL
  CE43    21 B18C        C      MO.IZPOS:   LD      HL,MS.ZPOS          ;Schreibzeilennr.  incr.
  CE46    CD CE4C        C                  CALL    MO.INCZ
  CE49    C3 CD98        C                  JP      MO.DIS
  CE4C    C5             C      MO.INCZ:    PUSH    BC
  CE4D    3A B18E        C                  LD      A,(MS.ZMIN)
  CE50    47             C                  LD      B,A
  CE51    3A B190        C                  LD      A,(MS.ZMAX)
  CE54    18 11          C                  JR      MO.INC2
  CE56    21 B18D        C      MO.ISPOS:   LD      HL,MS.SPOS          ;Schreibspaltennr. incr.
  CE59    CD CE5F        C                  CALL    MO.INCS
  CE5C    C3 CD98        C                  JP      MO.DIS
  CE5F    C5             C      MO.INCS:    PUSH    BC
  CE60    3A B18F        C                  LD      A,(MS.SMIN)
  CE63    47             C                  LD      B,A
  CE64    3A B191        C                  LD      A,(MS.SMAX)
  CE67    4F             C      MO.INC2:    LD      C,A
  CE68    7E             C                  LD      A,(HL)
  CE69    3C             C                  INC     A
  CE6A    B9             C                  CP      C
  CE6B    DA CEF9        C                  JP      C,MO.INC1
  CE6E    F5             C                  PUSH    AF                  ;Rollfunktion
  CE6F    C5             C                  PUSH    BC                  ;rollen nach oben raus
  CE70    D5             C                  PUSH    DE
  CE71    E5             C                  PUSH    HL
  CE72    21 B197        C                  LD      HL,MS.DIRES         ;Abfrage , ob Rollen ein
  CE75    CB 6E          C                  BIT     5,(HL)
  CE77    28 7A          C                  JR      Z,MO.INC5
  CE79    CB 66          C                  BIT     4,(HL)
  CE7B    28 71          C                  JR      Z,MO.INC7
  CE7D    2A B18C        C                  LD      HL,(MS.ZPOS)        ;retten von ZPOS , SPOS
  CE80    E5             C                  PUSH    HL
  CE81    2A B18E        C                  LD      HL,(MS.ZMIN)
  CE84    25             C                  DEC     H
  CE85    2D             C                  DEC     L
  CE86    22 B18C        C                  LD      (MS.ZPOS),HL
  CE89    CD CF4B        C                  CALL    MO.BWSE             ;DE ermitteln
  CE8C    23             C                  INC     HL
  CE8D    EB             C                  EX      DE,HL
  CE8E    2A B194        C                  LD      HL,(MS.BWSA)        ;HL ermitteln
  CE91    3A B18E        C                  LD      A,(MS.ZMIN)
  CE94    3D             C                  DEC     A
  CE95    CD CF52        C                  CALL    MO.PNSP
  CE98    E5             C                  PUSH    HL
  CE99    ED 4B B193     C                  LD      BC,(MS.SPANZ)       ;BC ermitteln
  CE9D    06 00          C                  LD      B,0
  CE9F    ED B0          C                  LDIR                        ;erste Zeile retten
                         C      
                         C                  PAGE
'Cursor Operationen'	MACRO-80 3.44	09-Dec-81	PAGE	1-57


                         C      
  CEA1    E1             C                  POP     HL                  ;DE ermitteln
  CEA2    E5             C                  PUSH    HL
  CEA3    CD CF5E        C                  CALL    MO.DESZ             ;HL ermitteln
  CEA6    19             C                  ADD     HL,DE
  CEA7    E5             C                  PUSH    HL
  CEA8    2A B18E        C                  LD      HL,(MS.ZMIN)        ;BC ermitteln
  CEAB    3A B190        C                  LD      A,(MS.ZMAX)
  CEAE    95             C                  SUB     L
  CEAF    F5             C                  PUSH    AF
  CEB0    21 0000        C                  LD      HL,0
  CEB3    CD CF52        C                  CALL    MO.PNSP
  CEB6    F1             C                  POP     AF
  CEB7    E5             C                  PUSH    HL
  CEB8    C1             C                  POP     BC
  CEB9    E1             C                  POP     HL
  CEBA    D1             C                  POP     DE
  CEBB    FE 00          C                  CP      0
  CEBD    28 02          C                  JR      Z,MO.INC6
  CEBF    ED B0          C                  LDIR                        ;Bildfensterzeilen um 1 Zeile nach oben
                         C      
  CEC1    E1             C      MO.INC6:    POP     HL                  ;rueckspeichern von ZPOS , SPOS
  CEC2    22 B18C        C                  LD      (MS.ZPOS),HL
  CEC5    2A B19A        C                  LD      HL,(MS.RADR)        ;Verzweigung zur Anschlussroutine
  CEC8    E5             C                  PUSH    HL
  CEC9    DD E1          C                  POP     IX
  CECB    CD CF4B        C                  CALL    MO.BWSE             ;Parameter in HL = Adresse der
  CECE    23             C                  INC     HL                  ;rausgerollten Zeile
  CECF    CD CB42        C                  CALL    MO.MORT
  CED2    CD CF4B        C                  CALL    MO.BWSE             ;HL ermitteln
  CED5    23             C                  INC     HL
  CED6    E5             C                  PUSH    HL
  CED7    CD CF2A        C                  CALL    MO.SZA                 ;DE ermitteln
  CEDA    EB             C                  EX      DE,HL
  CEDB    E1             C                  POP     HL
  CEDC    ED 4B B193     C                  LD      BC,(MS.SPANZ)       ;BC ermitteln
  CEE0    06 00          C                  LD      B,0
  CEE2    ED B0          C                  LDIR                        ;aktuelle Zeile belegen
  CEE4    CD CB45        C                  CALL    MO.BWSUS
  CEE7    E1             C      MO.INC8:    POP     HL
  CEE8    D1             C                  POP     DE
  CEE9    C1             C                  POP     BC
  CEEA    F1             C                  POP     AF
  CEEB    3F             C                  CCF
  CEEC    18 0C          C                  JR      MO.INC4
                         C      
  CEEE    CD CC58        C      MO.INC7:    CALL    MO.ROOB
  CEF1    18 F4          C                  JR      MO.INC8
                         C      
  CEF3    E1             C      MO.INC5:    POP     HL
  CEF4    D1             C                  POP     DE
  CEF5    C1             C                  POP     BC
  CEF6    F1             C                  POP     AF
  CEF7    05             C      MO.INC3:    DEC     B
  CEF8    78             C                  LD      A,B
  CEF9    77             C      MO.INC1:    LD      (HL),A
  CEFA    C1             C      MO.INC4:    POP     BC
  CEFB    C9             C                  RET
                         C      
                         C                  PAGE
'Cursor Operationen'	MACRO-80 3.44	09-Dec-81	PAGE	1-58


                         C      
                         C      ;****************************************************************
                         C      ;*               aktuelle Schreib-/Lese- position ==> HL        *
                         C      ;****************************************************************
  CEFC    CD CF06        C      MO.CPOS:    CALL    MO.SSA              ;Schreib-
  CEFF    18 2C          C                  JR      MO.SZA1
                         C      
  CF01    CD CF13        C      MO.CPOL:    CALL    MO.LSA              ;Lese-
  CF04    18 30          C                  JR      MO.LZA1
                         C      ;****************************************************************
                         C      ;*               Spaltenanfang       Schreib-/Lese- position    *
                         C      ;****************************************************************
  CF06    2A B18D        C      MO.SSA:     LD      HL,(MS.SPOS)        ;Schreib-
  CF09    26 00          C      MO.SSA1:    LD      H,0
  CF0B    F5             C                  PUSH    AF
  CF0C    ED 5B B194     C                  LD      DE,(MS.BWSA)
  CF10    19             C                  ADD     HL,DE
  CF11    F1             C                  POP     AF
  CF12    C9             C                  RET
                         C      
  CF13    2A B18B        C      MO.LSA:     LD      HL,(MS.SPOL)        ;Lese-
  CF16    18 F1          C                  JR      MO.SSA1
                         C      ;****************************************************************
                         C      ;*               Formatspaltenanfang Schreib-/Lese- position    *
                         C      ;****************************************************************
  CF18    CD CF06        C      MO.SSAF:    CALL    MO.SSA              ;Schreib-
  CF1B    F5             C      MO.SSAF1:   PUSH    AF
  CF1C    3A B18E        C                  LD      A,(MS.ZMIN)
  CF1F    3D             C                  DEC     A
  CF20    CD CF52        C      MO.SSAF2:   CALL    MO.PNSP
  CF23    F1             C                  POP     AF
  CF24    C9             C                  RET
                         C      
  CF25    CD CF13        C      MO.LSAF:    CALL    MO.LSA              ;Lese-
  CF28    18 F1          C                  JR      MO.SSAF1
                         C      ;****************************************************************
                         C      ;*               Zeilenanfang        Schreib-/Lese- position    *
                         C      ;****************************************************************
  CF2A    2A B194        C      MO.SZA:     LD      HL,(MS.BWSA)        ;Schreib-
  CF2D    F5             C      MO.SZA1:    PUSH    AF
  CF2E    3A B18C        C                  LD      A,(MS.ZPOS)
  CF31    18 ED          C                  JR      MO.SSAF2
                         C      
  CF33    2A B194        C      MO.LZA:     LD      HL,(MS.BWSA)        ;Lese-
  CF36    F5             C      MO.LZA1:    PUSH    AF
  CF37    3A B18A        C                  LD      A,(MS.ZPOL)
  CF3A    18 E4          C                  JR      MO.SSAF2
                         C      ;****************************************************************
                         C      ;*               Formatzeilenanfang  Schreib-/Lese- position    *
                         C      ;****************************************************************
  CF3C    CD CF6F        C      MO.SZAF:    CALL    MO.POSA             ;Schreib-
  CF3F    18 EC          C                  JR      MO.SZA1
                         C      
  CF41    CD CF6F        C      MO.LZAF:    CALL    MO.POSA             ;Lese-
  CF44    18 F0          C                  JR      MO.LZA1
                         C      
                         C                  PAGE
'Cursor Operationen'	MACRO-80 3.44	09-Dec-81	PAGE	1-59


                         C      
                         C      ;****************************************************************
                         C      ;*               Formatanfang BWS                               *
                         C      ;****************************************************************
  CF46    CD CF6F        C      MO.BWSAF:   CALL    MO.POSA
  CF49    18 D0          C                  JR      MO.SSAF1
                         C      
                         C      ;****************************************************************
                         C      ;*               Ende         BWS                               *
                         C      ;****************************************************************
  CF4B    2A B194        C      MO.BWSE:    LD      HL,(MS.BWSA)
  CF4E    2B             C                  DEC     HL
  CF4F    3A B192        C      MO.ADDBL:   LD      A,(MS.ZANZ)         ;HL=HL+BWSL
  CF52    B7             C      MO.PNSP:    OR      A                   ;HL:=HL+A*(SPANZ)
  CF53    C8             C                  RET     Z
  CF54    D5             C                  PUSH    DE
  CF55    CD CF5E        C                  CALL    MO.DESZ
  CF58    19             C      MO.PNSP1:   ADD     HL,DE
  CF59    3D             C                  DEC     A
  CF5A    20 FC          C                  JR      NZ,MO.PNSP1
  CF5C    D1             C                  POP     DE
  CF5D    C9             C                  RET
                         C      
  CF5E    ED 5B B193     C      MO.DESZ:    LD      DE,(MS.SPANZ)       ;DE:=Spaltenanzahl
  CF62    16 00          C                  LD      D,0
  CF64    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*               Laenge       BWS                               *
                         C      ;****************************************************************
  CF65    E5             C      MO.BWSL:    PUSH    HL
  CF66    21 0000        C                  LD      HL,0
  CF69    CD CF4F        C                  CALL    MO.ADDBL
  CF6C    E3             C                  EX      (SP),HL
  CF6D    C1             C                  POP     BC                  ;BC=BWSL  A=0
  CF6E    C9             C                  RET                         ;HL,DE unveraendert
                         C      
  CF6F    2A B18F        C      MO.POSA:    LD      HL,(MS.SMIN)
  CF72    2D             C                  DEC     L
  CF73    18 94          C                  JR      MO.SSA1
                         C      
                         C                  PAGE
'Cursor Operationen'	MACRO-80 3.44	09-Dec-81	PAGE	1-60


                         C      
                         C      ;****************************************************************
                         C      ;*               LCPOS , LCPOL                                  *
                         C      ;****************************************************************
  CF75    E5             C      MO.LCPOS:   PUSH    HL                  ; HL ==> aktuelle Schreibposition
  CF76    D5             C                  PUSH    DE
  CF77    ED 5B B194     C                  LD      DE,(MS.BWSA)
  CF7B    B7             C                  OR      A
  CF7C    ED 52          C                  SBC     HL,DE
  CF7E    CD CF5E        C                  CALL    MO.DESZ
  CF81    AF             C                  XOR     A
  CF82    ED 52          C      MO.LCP1:    SBC     HL,DE
  CF84    3C             C                  INC     A
  CF85    30 FB          C                  JR      NC,MO.LCP1
  CF87    19             C                  ADD     HL,DE
  CF88    3D             C                  DEC     A
  CF89    32 B18C        C                  LD      (MS.ZPOS),A
  CF8C    7D             C                  LD      A,L
  CF8D    32 B18D        C                  LD      (MS.SPOS),A
  CF90    D1             C                  POP     DE
  CF91    E1             C                  POP     HL
  CF92    C9             C                  RET
                         C      ;
  CF93    E5             C      MO.LCPOL:   PUSH    HL
  CF94    D5             C                  PUSH    DE
  CF95    ED 5B B194     C                  LD      DE,(MS.BWSA)
  CF99    B7             C                  OR      A
  CF9A    ED 52          C                  SBC     HL,DE
  CF9C    CD CF5E        C                  CALL    MO.DESZ
  CF9F    AF             C                  XOR     A
  CFA0    ED 52          C      MO.LCP2:    SBC     HL,DE
  CFA2    3C             C                  INC     A
  CFA3    30 FB          C                  JR      NC,MO.LCP2
  CFA5    19             C                  ADD     HL,DE
  CFA6    3D             C                  DEC     A
  CFA7    32 B18A        C                  LD      (MS.ZPOL),A
  CFAA    7D             C                  LD      A,L
  CFAB    32 B18B        C                  LD      (MS.SPOL),A
  CFAE    D1             C                  POP     DE
  CFAF    E1             C                  POP     HL
  CFB0    C9             C                  RET
                         C      
                         C                  PAGE
'Cursor Operationen'	MACRO-80 3.44	09-Dec-81	PAGE	1-61


                         C      
                         C      ;****************************************************************
                         C      ;*               HOME - Funktion  Schreibposition               *
                         C      ;****************************************************************
  CFB1    2A B18E        C      MO.HOMES:   LD      HL,(MS.ZMIN)
  CFB4    22 B18C        C                  LD      (MS.ZPOS),HL
  CFB7    CD CD6E        C                  CALL    MO.DZPOS
  CFBA    CD CD80        C                  CALL    MO.DSPOS
  CFBD    C9             C                  RET
                         C      
                         C      ;****************************************************************
                         C      ;*               HOME - Funktion  Leseposition                  *
                         C      ;****************************************************************
  CFBE    2A B18E        C      MO.HOMEL:   LD      HL,(MS.ZMIN)
  CFC1    22 B18A        C                  LD      (MS.ZPOL),HL
  CFC4    CD CD59        C                  CALL    MO.DZPOL
  CFC7    CD CD61        C                  CALL    MO.DSPOL
  CFCA    C9             C                  RET
                         C      
                         C      ;****************************************************************
                         C      ;*               Anfangsposition naechste Zeile Schreiben       *
                         C      ;****************************************************************
  CFCB    3A B18F        C      MO.CNZAS:   LD      A,(MS.SMIN)
  CFCE    3D             C                  DEC     A
  CFCF    32 B18D        C                  LD      (MS.SPOS),A
  CFD2    CD CE43        C                  CALL    MO.IZPOS
  CFD5    C9             C                  RET
                         C      
                         C      ;****************************************************************
                         C      ;*               Anfangsposition naechste Zeile Lesen           *
                         C      ;****************************************************************
  CFD6    3A B18F        C      MO.CNZAL:   LD      A,(MS.SMIN)
  CFD9    3D             C                  DEC     A
  CFDA    32 B18B        C                  LD      (MS.SPOL),A
  CFDD    CD CE31        C                  CALL    MO.IZPOL
  CFE0    C9             C                  RET
                         C      
                         C                  TITLE   'Schreiben/Lesen eines Zeichens'
                         C                  PAGE
'Schreiben/Lesen eines Zeichens'	MACRO-80 3.44	09-Dec-81	PAGE	1-62


                         C      
                         C      ;****************************************************************
                         C      ;*               Schreiben eines Zeichens auf Bildschirm        *
                         C      ;****************************************************************
  CFE1    CD CEFC        C      MO.MZS:     CALL    MO.CPOS
  CFE4    3A B199        C                  LD      A,(MS.TK)
  CFE7    77             C                  LD      (HL),A
  CFE8    CD CB4F        C                  CALL    MO.BWSUZ
  CFEB    21 D00F        C      MO.MPS:     LD      HL,MO.ZSTAB
  CFEE    3A B197        C                  LD      A,(MS.DIRES)
  CFF1    18 0D          C                  JR      MO.MSL
                         C      ;****************************************************************
                         C      ;*               Lesen     eines Zeichens vom Bildschirm        *
                         C      ;****************************************************************
  CFF3    CD CF01        C      MO.MZL:     CALL    MO.CPOL
  CFF6    7E             C                  LD      A,(HL)
  CFF7    32 B199        C                  LD      (MS.TK),A
  CFFA    21 D01F        C      MO.MPL:     LD      HL,MO.ZLTAB
  CFFD    3A B196        C                  LD      A,(MS.DIREL)
  D000    CB 7F          C      MO.MSL:     BIT     7,A
  D002    C8             C                  RET     Z
  D003    E6 07          C                  AND     07H
  D005    87             C                  ADD     A,A
  D006    06 00          C                  LD      B,0
  D008    4F             C                  LD      C,A
  D009    09             C                  ADD     HL,BC
  D00A    7E             C                  LD      A,(HL)
  D00B    23             C                  INC     HL
  D00C    66             C                  LD      H,(HL)
  D00D    6F             C                  LD      L,A
  D00E    E9             C                  JP      (HL)
                         C      ;****************************************************************
                         C      ;*               ZSTAB  und  ZLTAB                              *
                         C      ;****************************************************************
  D00F    D02F           C      MO.ZSTAB:   DW      MO.MZSO
  D011    D0C5           C                  DW      MO.MZSNO
  D013    D0A3           C                  DW      MO.MZSN
  D015    D0C5           C                  DW      MO.MZSNW
  D017    D069           C                  DW      MO.MZSW
  D019    D0C5           C                  DW      MO.MZSSW
  D01B    D0B3           C                  DW      MO.MZSS
  D01D    D0C5           C                  DW      MO.MZSSO
  D01F    D0C6           C      MO.ZLTAB:   DW      MO.MZLO
  D021    D106           C                  DW      MO.MZLNO
  D023    D0E6           C                  DW      MO.MZLN
  D025    D106           C                  DW      MO.MZLNW
  D027    D0D6           C                  DW      MO.MZLW
  D029    D106           C                  DW      MO.MZLSW
  D02B    D0F6           C                  DW      MO.MZLS
  D02D    D106           C                  DW      MO.MZLSO
                         C      
                         C                  PAGE
'Schreiben/Lesen eines Zeichens'	MACRO-80 3.44	09-Dec-81	PAGE	1-63


                         C      
                         C      ;****************************************************************
                         C      ;*               MZSO , MZSW , MZSN , MZSS                      *
                         C      ;****************************************************************
  D02F    3A B197        C      MO.MZSO:    LD      A,(MS.DIRES)
  D032    F5             C                  PUSH    AF
  D033    CB 6F          C                  BIT     5,A
  D035    28 11          C                  JR      Z,MO.MZSO1
  D037    21 B190        C                  LD      HL,MS.ZMAX
  D03A    3A B18C        C                  LD      A,(MS.ZPOS)
  D03D    3C             C                  INC     A
  D03E    BE             C                  CP      (HL)
  D03F    28 1A          C                  JR      Z,MO.MZSO3
  D041    F1             C                  POP     AF
  D042    F5             C                  PUSH    AF
  D043    CB AF          C                  RES     5,A
  D045    32 B197        C                  LD      (MS.DIRES),A
  D048    CD CE56        C      MO.MZSO1:   CALL    MO.ISPOS
  D04B    F5             C      MO.MZSO2:   PUSH    AF
  D04C    D1             C                  POP     DE
  D04D    F1             C                  POP     AF
  D04E    D5             C                  PUSH    DE
  D04F    32 B197        C                  LD      (MS.DIRES),A
  D052    CB 77          C                  BIT     6,A
  D054    28 6D          C                  JR      Z,MO.MZSL
  D056    F1             C                  POP     AF
  D057    DC CE43        C                  CALL    C,MO.IZPOS
  D05A    C9             C                  RET
  D05B    CD CE56        C      MO.MZSO3:   CALL    MO.ISPOS
  D05E    20 EB          C                  JR      NZ,MO.MZSO2
  D060    3A B18F        C                  LD      A,(MS.SMIN)
  D063    3D             C                  DEC     A
  D064    32 B18D        C                  LD      (MS.SPOS),A
  D067    18 E2          C                  JR      MO.MZSO2
                         C      
                         C                  PAGE
'Schreiben/Lesen eines Zeichens'	MACRO-80 3.44	09-Dec-81	PAGE	1-64


                         C      
  D069    3A B197        C      MO.MZSW:    LD      A,(MS.DIRES)
  D06C    F5             C                  PUSH    AF
  D06D    CB 6F          C                  BIT     5,A
  D06F    28 11          C                  JR      Z,MO.MZSW1
  D071    21 B18E        C                  LD      HL,MS.ZMIN
  D074    3A B18C        C                  LD      A,(MS.ZPOS)
  D077    3C             C                  INC     A
  D078    BE             C                  CP      (HL)
  D079    28 1A          C                  JR      Z,MO.MZSW3
  D07B    F1             C                  POP     AF
  D07C    F5             C                  PUSH    AF
  D07D    CB AF          C                  RES     5,A
  D07F    32 B197        C                  LD      (MS.DIRES),A
  D082    CD CD80        C      MO.MZSW1:   CALL    MO.DSPOS
  D085    F5             C      MO.MZSW2:   PUSH    AF
  D086    D1             C                  POP     DE
  D087    F1             C                  POP     AF
  D088    D5             C                  PUSH    DE
  D089    32 B197        C                  LD      (MS.DIRES),A
  D08C    CB 77          C                  BIT     6,A
  D08E    28 33          C                  JR      Z,MO.MZSL
  D090    F1             C                  POP     AF
  D091    DC CD6E        C                  CALL    C,MO.DZPOS
  D094    C9             C                  RET
  D095    CD CD80        C      MO.MZSW3:   CALL    MO.DSPOS
  D098    20 EB          C                  JR      NZ,MO.MZSW2
  D09A    3A B191        C                  LD      A,(MS.SMAX)
  D09D    3D             C                  DEC     A
  D09E    32 B18D        C                  LD      (MS.SPOS),A
  D0A1    18 E2          C                  JR      MO.MZSW2
                         C      
  D0A3    CD CD6E        C      MO.MZSN:    CALL    MO.DZPOS
  D0A6    F5             C                  PUSH    AF
  D0A7    3A B197        C                  LD      A,(MS.DIRES)
  D0AA    CB 77          C                  BIT     6,A
  D0AC    28 15          C                  JR      Z,MO.MZSL
  D0AE    F1             C                  POP     AF
  D0AF    DC CD80        C                  CALL    C,MO.DSPOS
  D0B2    C9             C                  RET
                         C      
  D0B3    CD CE43        C      MO.MZSS:    CALL    MO.IZPOS
  D0B6    F5             C                  PUSH    AF
  D0B7    3A B197        C                  LD      A,(MS.DIRES)
  D0BA    CB 77          C                  BIT     6,A
  D0BC    28 05          C                  JR      Z,MO.MZSL
  D0BE    F1             C                  POP     AF
  D0BF    DC CE56        C                  CALL    C,MO.ISPOS
  D0C2    C9             C                  RET
                         C      
  D0C3    F1             C      MO.MZSL:    POP     AF
  D0C4    C9             C                  RET
                         C      
  D0C5                   C      MO.MZSNO    EQU     $
  D0C5                   C      MO.MZSNW    EQU     $
  D0C5                   C      MO.MZSSW    EQU     $
  D0C5    C9             C      MO.MZSSO:   RET
                         C      
                         C                  PAGE
'Schreiben/Lesen eines Zeichens'	MACRO-80 3.44	09-Dec-81	PAGE	1-65


                         C      
                         C      ;****************************************************************
                         C      ;*               MZLO , MZLW , MZLN , MZLS                      *
                         C      ;****************************************************************
  D0C6    CD CE3A        C      MO.MZLO:    CALL    MO.ISPOL
  D0C9    F5             C                  PUSH    AF
  D0CA    3A B196        C                  LD      A,(MS.DIREL)
  D0CD    CB 77          C                  BIT     6,A
  D0CF    28 F2          C                  JR      Z,MO.MZSL
  D0D1    F1             C                  POP     AF
  D0D2    DC CE31        C                  CALL    C,MO.IZPOL
  D0D5    C9             C                  RET
  D0D6    CD CD61        C      MO.MZLW:    CALL    MO.DSPOL
  D0D9    F5             C                  PUSH    AF
  D0DA    3A B196        C                  LD      A,(MS.DIREL)
  D0DD    CB 77          C                  BIT     6,A
  D0DF    28 E2          C                  JR      Z,MO.MZSL
  D0E1    F1             C                  POP     AF
  D0E2    DC CD59        C                  CALL    C,MO.DZPOL
  D0E5    C9             C                  RET
  D0E6    CD CD59        C      MO.MZLN:    CALL    MO.DZPOL
  D0E9    F5             C                  PUSH    AF
  D0EA    3A B196        C                  LD      A,(MS.DIREL)
  D0ED    CB 77          C                  BIT     6,A
  D0EF    28 D2          C                  JR      Z,MO.MZSL
  D0F1    F1             C                  POP     AF
  D0F2    DC CD61        C                  CALL    C,MO.DSPOL
  D0F5    C9             C                  RET
  D0F6    CD CE31        C      MO.MZLS:    CALL    MO.IZPOL
  D0F9    F5             C                  PUSH    AF
  D0FA    3A B196        C                  LD      A,(MS.DIREL)
  D0FD    CB 77          C                  BIT     6,A
  D0FF    28 C2          C                  JR      Z,MO.MZSL
  D101    F1             C                  POP     AF
  D102    DC CE3A        C                  CALL    C,MO.ISPOL
  D105    C9             C                  RET
  D106                   C      MO.MZLNO    EQU     $
  D106                   C      MO.MZLNW    EQU     $
  D106                   C      MO.MZLSW    EQU     $
  D106    C9             C      MO.MZLSO:   RET
                         C      
                         C                  TITLE   'Vektor lesen/schreiben'
                         C                  PAGE
'Vektor lesen/schreiben'	MACRO-80 3.44	09-Dec-81	PAGE	1-66


                         C      
                         C      ;****************************************************************
                         C      ;*               Vektor schreiben                               *
                         C      ;*               -----------------------------------------------*
                         C      ;*               HL = auszugebender Vektor                      *
                         C      ;*               B  = Laenge des    Vektors                     *
                         C      ;****************************************************************
  D107    3A B197        C      MO.MVS:     LD      A,(MS.DIRES)
  D10A    F5             C                  PUSH    AF
  D10B    CB FF          C                  SET     7,A
  D10D    CB F7          C                  SET     6,A
  D10F    32 B197        C                  LD      (MS.DIRES),A
  D112    7E             C      MO.MVS1:    LD      A,(HL)
  D113    23             C                  INC     HL
  D114    E5             C                  PUSH    HL
  D115    C5             C                  PUSH    BC
  D116    32 B199        C                  LD      (MS.TK),A
  D119    CD CFE1        C                  CALL    MO.MZS
  D11C    C1             C                  POP     BC
  D11D    E1             C                  POP     HL
  D11E    10 F2          C                  DJNZ    MO.MVS1
  D120    F1             C                  POP     AF
  D121    32 B197        C                  LD      (MS.DIRES),A
  D124    C9             C                  RET
                         C      
                         C      ;****************************************************************
                         C      ;*                Vektor lesen                                  *
                         C      ;*                ----------------------------------------------*
                         C      ;*                HL = Zieladresse des einzulesenden Vektors    *
                         C      ;*                B  = Laenge des Vektors                       *
                         C      ;****************************************************************
  D125    3A B196        C      MO.MVL:     LD      A,(MS.DIREL)
  D128    F5             C                  PUSH    AF
  D129    CB FF          C                  SET     7,A
  D12B    CB F7          C                  SET     6,A
  D12D    32 B196        C                  LD      (MS.DIREL),A
  D130    E5             C      MO.MVL1:    PUSH    HL
  D131    C5             C                  PUSH    BC
  D132    CD CFF3        C                  CALL    MO.MZL
  D135    C1             C                  POP     BC
  D136    E1             C                  POP     HL
  D137    3A B199        C                  LD      A,(MS.TK)
  D13A    77             C                  LD      (HL),A
  D13B    23             C                  INC     HL
  D13C    10 F2          C                  DJNZ    MO.MVL1
  D13E    F1             C                  POP     AF
  D13F    32 B196        C                  LD      (MS.DIREL),A
  D142    C9             C                  RET
                         C      
                         C      ;           END
                         C      ;           PN      TA35
                         C                  TITLE   'Tastaturroutine'
                         C                  PAGE
'Tastaturroutine'	MACRO-80 3.44	09-Dec-81	PAGE	1-67


                         C      
                         C      ;****************************************************************
                         C      ;*               Tastaturroutine                                *
                         C      ;*  Version      -----------------------------------------------*
                         C      ;*               Programmierer: M. Herbote --- K EAW  ZFT (WFT) *
                         C      ;*  V 2 . 1      -----------------------------------------------*
                         C      ;*               Stand        : 06.Maerz 1985                   *
                         C      ;****************************************************************
                         C      
                         C      ;****************************************************************
                         C      ;*               symbolische Adressen und ihre Bedeutung        *
                         C      ;* symbol.Adr. ! Bedeutung                                      *
                         C      ;*-------------!------------------------------------------------*
                         C      ;* TA.TA1      ! Abfrage nach gedrueckter Taste                 *
                         C      ;* TA.TA2      ! Einlesen des Tastaturcodes                     *
                         C      ;* TA.PIOPR    ! programmieren des Tastatur-PIO                 *
                         C      ;* TA.E0IN     ! Anfangswerte fuer EMERK , UMERK und KGMER      *
                         C      ;* TA.LOE      ! loeschen aller Tastenroutinenadressen          *
                         C      ;* TA.LOES     ! wie TA.LOE mit Belegung Standardroutinen       *
                         C      ;* TA.ABFR     ! Tastaturabfrage und Ausfuehrung Tastenfunktion *
                         C      ;* TA.TFE      ! Warteschleife bis keine Taste mehr gedrueckt   *
                         C      ;*-------------!------------------------------------------------*
                         C      ;* Tabellen mit den Funktionsadressen der einzelnen Tasten      *
                         C      ;* TS.TAB1     ! Funktionstasten  P01 bis P48                   *
                         C      ;* TS.TAB2     ! INS MOD   , DEL      , INS LINE   , DEL LINE , *
                         C      ;*             ! SCH LINKS , C HOCH   , SCH RECHTS ,            *
                         C      ;*             ! C LINKS   , HOME     , C RECHTS   ,            *
                         C      ;*             ! CNZA      , C RUNTER                           *
                         C      ;* TS.TAB3     ! 00 , 000  , NEG QUIT , SYS  , END , ABS        *
                         C      ;* TS.TAB4     ! POS QUIT  , TABS     , TABL , CI  , M          *
                         C      ;* TS.EINA     ! Auswerten der alphanumerischen Tasten          *
                         C      ;* TS.TABU     ! Auswerten der Taste  ET2 == HT                 *
                         C      ;* TS.NEWL     ! Auswerten der Taste  ET1 == RS                 *
                         C      ;* TS.TAB5     ! Ebene 0   , Ebene 1  , Ebene 2    , Ebenen 3   *
                         C      ;*-------------!------------------------------------------------*
                         C      ;* TS.PTAST    ! I/O-Adresse der Tastatur                       *
                         C      ;* TS.TK       ! Zwischenspeicher fuer den Tastaturcode         *
                         C      ;* TS.PTK      ! Zwischenspeicher fuer die P-Tastennummer       *
                         C      ;* TS.EMERK    ! Merker fuer die aktive P-Tastenebene           *
                         C      ;* TS.SPMER    ! Tastaturgruppenmerker                          *
                         C      ;*             ! Bit ! Hexacode    ! Funktion                   *
                         C      ;*             !-----!-------------!----------------------------*
                         C      ;*             ! 0   ! 00-1F       ! Steuer- / Sonder-zeichen   *
                         C      ;*             ! 1   ! 20,2C       !  ,                         *
                         C      ;*             ! 2   ! 2B,2D,2E    ! +-.                        *
                         C      ;*             ! 3   ! 30-39       ! 0123456789                 *
                         C      ;*             ! 4   !             ! !"%&'()*/:;<=>?[\]^_{|}`~  *
                         C      ;*             ! 5   ! 40-5A,23,24 ! A...Z@#$   Grossbuchstaben *
                         C      ;*             ! 6   ! 61-7A       ! a...z      Kleinbuchstaben *
                         C      ;*             ! 7   ! 80-FF       ! Funktionstasten            *
                         C      ;* TS.UMERK    ! =0 INS MOD aus   =1 INS MOD ein                *
                         C      ;* TS.KGMER    ! =0 Programmier-  =1 Schreibmaschinen- Tastatur *
                         C      ;* TS.ZSMER    ! =0 Schnellschreiben nicht erlaubt              *
                         C      ;* TS.ZEIT1    ! Zeitkonstante 1 fuer die Warteschleife         *
                         C      ;* TS.ZEIT2    ! Zeitkonstante 2 fuer die Warteschleife         *
                         C      ;* TS.MIO      ! =0 I/O -         =1 memory - Bereitstellung    *
                         C      ;* TS.MBF      ! =0 kein          =1 Abspeichern als Bedienfolge*
                         C      ;* TS.BFOL1    ! Pointer Bedienfolgespeicher bei Aufbau         *
                         C      ;* TS.BFOL2    ! Pointer Bedienfolgespeicher bei Abarbeitung    *
                         C      ;* TS.STACK    ! Zeiger zum aktuellen Keller                    *
                         C      ;****************************************************************
                         C                  PAGE
'Tastaturroutine'	MACRO-80 3.44	09-Dec-81	PAGE	1-68


                         C      
                         C      ;****************************************************************
                         C      ;*               Verbindungs - Macro zur Version 1.2            *
                         C      ;****************************************************************
                         C      TA.TAST     MACRO   UP
                         C                  PUSH    AF
                         C                  CALL    S0.TAZU
                         C                  POP     AF
                         C                  CALL    UP
                         C                  PUSH    AF
                         C                  PUSH    BC
                         C                  PUSH    DE
                         C                  CALL    S2.STACK
                         C                  POP     DE
                         C                  POP     BC
                         C                  POP     AF
                         C                  ENDM
                         C      ;****************************************************************
                         C      ;*               UP zum Abfragen nach gedrueckter Taste         *
                         C      ;****************************************************************
  D143    3A B23B        C      TA.TA1:     LD      A,(TS.PTAST)
                         C                  TA.TAST S0.TA1
  D146    F5             C+                 PUSH    AF
  D147    CD F655        C+                 CALL    S0.TAZU
  D14A    F1             C+                 POP     AF
  D14B    CD 4003        C+                 CALL    S0.TA1
  D14E    F5             C+                 PUSH    AF
  D14F    C5             C+                 PUSH    BC
  D150    D5             C+                 PUSH    DE
  D151    CD B2D4        C+                 CALL    S2.STACK
  D154    D1             C+                 POP     DE
  D155    C1             C+                 POP     BC
  D156    F1             C+                 POP     AF
  D157    32 B245        C                  LD      (TS.ZEI21),A
  D15A    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*               UP zum einlesen des Tastaturcodes              *
                         C      ;****************************************************************
  D15B    3A B23B        C      TA.TA2:     LD      A,(TS.PTAST)
                         C                  TA.TAST S0.TA2
  D15E    F5             C+                 PUSH    AF
  D15F    CD F655        C+                 CALL    S0.TAZU
  D162    F1             C+                 POP     AF
  D163    CD 4006        C+                 CALL    S0.TA2
  D166    F5             C+                 PUSH    AF
  D167    C5             C+                 PUSH    BC
  D168    D5             C+                 PUSH    DE
  D169    CD B2D4        C+                 CALL    S2.STACK
  D16C    D1             C+                 POP     DE
  D16D    C1             C+                 POP     BC
  D16E    F1             C+                 POP     AF
  D16F    47             C                  LD      B,A
  D170    3A B245        C                  LD      A,(TS.ZEI21)
  D173    CB 57          C                  BIT     2,A
  D175    20 2A          C                  JR      NZ,TA.TA21
  D177    78             C                  LD      A,B                 ;Auswertung der CTRL-Tasten
  D178    FE 85          C                  CP      85H
  D17A    30 25          C                  JR      NC,TA.TA21
  D17C    FE 84          C                  CP      84H
  D17E    20 04          C                  JR      NZ,TA.TA22
  D180    06 F4          C                  LD      B,0F4H              ;SCH_LINKS
  D182    18 1D          C                  JR      TA.TA21
  D184    FE 80          C      TA.TA22:    CP      80H
  D186    38 03          C                  JR      C,TA.TA23
  D188    C6 31          C                  ADD     A,31H               ;TABS,TABL,CI,M
  D18A    47             C                  LD      B,A
  D18B    FE 70          C      TA.TA23:    CP      70H
  D18D    30 12          C                  JR      NC,TA.TA21
  D18F    FE 60          C                  CP      60H
  D191    38 03          C                  JR      C,TA.TA24
  D193    C6 80          C                  ADD     A,80H               ;Tastencode  E0H ... EFH
  D195    47             C                  LD      B,A
  D196    FE 50          C      TA.TA24:    CP      50H
  D198    30 07          C                  JR      NC,TA.TA21
  D19A    FE 40          C                  CP      40H
  D19C    38 03          C                  JR      C,TA.TA21
  D19E    C6 90          C                  ADD     A,90H               ;Tastencode  D0H ... DFH
  D1A0    47             C                  LD      B,A
  D1A1    78             C      TA.TA21:    LD      A,B
  D1A2    C9             C                  RET
                         C      
                         C                  TITLE   'Init. und Zusatzfkt. Tastatur'
'Init. und Zusatzfkt. Tastatur'	MACRO-80 3.44	09-Dec-81	PAGE	1-69


                         C                  PAGE
'Init. und Zusatzfkt. Tastatur'	MACRO-80 3.44	09-Dec-81	PAGE	1-70


                         C      
                         C      ;****************************************************************
                         C      ;*               Init. und Zusatzfunktionen der Tastatur        *
                         C      ;****************************************************************
  D1A3    3A B23B        C      TA.PIOPR:   LD      A,(TS.PTAST)
                         C                  TA.TAST S0.TINIT
  D1A6    F5             C+                 PUSH    AF
  D1A7    CD F655        C+                 CALL    S0.TAZU
  D1AA    F1             C+                 POP     AF
  D1AB    CD 4000        C+                 CALL    S0.TINIT
  D1AE    F5             C+                 PUSH    AF
  D1AF    C5             C+                 PUSH    BC
  D1B0    D5             C+                 PUSH    DE
  D1B1    CD B2D4        C+                 CALL    S2.STACK
  D1B4    D1             C+                 POP     DE
  D1B5    C1             C+                 POP     BC
  D1B6    F1             C+                 POP     AF
  D1B7    C9             C                  RET
                         C      
  D1B8    CD D143        C      TA.TA3:     CALL    TA.TA1
  D1BB    20 FB          C                  JR      NZ,TA.TA3
  D1BD    CD D15B        C                  CALL    TA.TA2
  D1C0    C9             C                  RET
                         C      
  D1C1    3A B23B        C      TA.TRTFE:   LD      A,(TS.PTAST)
                         C                  TA.TAST S0.TFE
  D1C4    F5             C+                 PUSH    AF
  D1C5    CD F655        C+                 CALL    S0.TAZU
  D1C8    F1             C+                 POP     AF
  D1C9    CD 400C        C+                 CALL    S0.TFE
  D1CC    F5             C+                 PUSH    AF
  D1CD    C5             C+                 PUSH    BC
  D1CE    D5             C+                 PUSH    DE
  D1CF    CD B2D4        C+                 CALL    S2.STACK
  D1D2    D1             C+                 POP     DE
  D1D3    C1             C+                 POP     BC
  D1D4    F1             C+                 POP     AF
  D1D5    C9             C                  RET
                         C      
  D1D6    3A B23B        C      TA.TIM:     LD      A,(TS.PTAST)        ;Ansteuerung der INS_MOD Diode
                         C                  TA.TAST S0.TIM
  D1D9    F5             C+                 PUSH    AF
  D1DA    CD F655        C+                 CALL    S0.TAZU
  D1DD    F1             C+                 POP     AF
  D1DE    CD 400F        C+                 CALL    S0.TIM
  D1E1    F5             C+                 PUSH    AF
  D1E2    C5             C+                 PUSH    BC
  D1E3    D5             C+                 PUSH    DE
  D1E4    CD B2D4        C+                 CALL    S2.STACK
  D1E7    D1             C+                 POP     DE
  D1E8    C1             C+                 POP     BC
  D1E9    F1             C+                 POP     AF
  D1EA    C9             C                  RET
                         C      
  D1EB    3A B23B        C      TA.TEM:     LD      A,(TS.PTAST)        ;Ansteuerung der Ebenen- Dioden
                         C                  TA.TAST S0.TEM
  D1EE    F5             C+                 PUSH    AF
  D1EF    CD F655        C+                 CALL    S0.TAZU
  D1F2    F1             C+                 POP     AF
  D1F3    CD 4012        C+                 CALL    S0.TEM
  D1F6    F5             C+                 PUSH    AF
  D1F7    C5             C+                 PUSH    BC
  D1F8    D5             C+                 PUSH    DE
  D1F9    CD B2D4        C+                 CALL    S2.STACK
  D1FC    D1             C+                 POP     DE
  D1FD    C1             C+                 POP     BC
  D1FE    F1             C+                 POP     AF
  D1FF    C9             C                  RET
                         C      
  D200    3A B23B        C      TA.TBEL:    LD      A,(TS.PTAST)        ;Ansteuerung der Fehleranzeigen
                         C                  TA.TAST S0.TBEL
  D203    F5             C+                 PUSH    AF
  D204    CD F655        C+                 CALL    S0.TAZU
  D207    F1             C+                 POP     AF
  D208    CD 4015        C+                 CALL    S0.TBEL
  D20B    F5             C+                 PUSH    AF
  D20C    C5             C+                 PUSH    BC
  D20D    D5             C+                 PUSH    DE
  D20E    CD B2D4        C+                 CALL    S2.STACK
  D211    D1             C+                 POP     DE
  D212    C1             C+                 POP     BC
  D213    F1             C+                 POP     AF
'Init. und Zusatzfkt. Tastatur'	MACRO-80 3.44	09-Dec-81	PAGE	1-71


  D214    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*               Ebene 0 , INS MOD auf aus und KGMER auf PTAS   *
                         C      ;****************************************************************
  D215    AF             C      TA.E0IN:    XOR     A
  D216    32 B241        C                  LD      (TS.KGMER),A
  D219    32 B23E        C                  LD      (TS.EMERK),A
  D21C    32 B240        C                  LD      (TS.UMERK),A
  D21F    32 B247        C                  LD      (TS.MIO),A
  D222    32 B248        C                  LD      (TS.MBF),A
                         C      
  D225    06 01          C                  LD      B,001H              ;INS_MOD aus, Ebene 1 ???  AUS/EIN 7, 17 ???
  D227    C5             C                  PUSH    BC
                         C      ;???            CALL    TA.TIM
  D228    C1             C                  POP     BC
                         C      ;???            CALL    TA.TEM
                         C      
  D229    C9             C                  RET
                         C      
  D22A    3A B23E        C      TA.BBB:     LD      A,(TS.EMERK)
  D22D    3C             C                  INC     A
  D22E    47             C                  LD      B,A
  D22F    3E 80          C                  LD      A,080H
  D231    07             C                  RLCA                        ;<--!
  D232    10 FD          C                  DJNZ    $-1                 ;---!
  D234    47             C                  LD      B,A
  D235    3A B240        C                  LD      A,(TS.UMERK)
  D238    B7             C                  OR      A
  D239    C8             C                  RET     Z
  D23A    CB F8          C                  SET     7,B
  D23C    C9             C                  RET
                         C      
                         C                  TITLE   'Abfrageschleife'
                         C                  PAGE
'Abfrageschleife'	MACRO-80 3.44	09-Dec-81	PAGE	1-72


                         C      
                         C      ;****************************************************************
                         C      ;*               Tastaturabfrageschleife                        *
                         C      ;****************************************************************
  D23D    3A B247        C      TA.ABFR:    LD      A,(TS.MIO)          ;Tastencode von Tastatur bzw. vomSpeicher
  D240    B7             C                  OR      A
  D241    28 0A          C                  JR      Z,TA.ABFR1
  D243    2A B24B        C                  LD      HL,(TS.BFOL2)
  D246    7E             C                  LD      A,(HL)
  D247    23             C                  INC     HL
  D248    22 B24B        C                  LD      (TS.BFOL2),HL
  D24B    18 03          C                  JR      TA.ABFR2
  D24D    CD D1B8        C      TA.ABFR1:   CALL    TA.TA3              ;Tastencode einlesen
  D250    B7             C      TA.ABFR2:   OR      A
  D251    CA D327        C                  JP      Z,TA.TFE            ;Kode=00H ungueltig
  D254    FE 7F          C                  CP      7FH
  D256    CA D327        C                  JP      Z,TA.TFE            ;Kode=7FH ungueltig
  D259    32 B23C        C                  LD      (TS.TK),A           ;Tastencode abspeichern
  D25C    3A B248        C                  LD      A,(TS.MBF)          ;Tastencode nach Bedienfolgespeicher ?
  D25F    B7             C                  OR      A
  D260    3A B23C        C                  LD      A,(TS.TK)
  D263    28 08          C                  JR      Z,TA.ABFR3
  D265    2A B249        C                  LD      HL,(TS.BFOL1)
  D268    77             C                  LD      (HL),A
  D269    23             C                  INC     HL
  D26A    22 B249        C                  LD      (TS.BFOL1),HL
  D26D    3A B241        C      TA.ABFR3:   LD      A,(TS.KGMER)
  D270    B7             C                  OR      A
  D271    3A B23C        C                  LD      A,(TS.TK)
  D274    28 18          C                  JR      Z,TA.ABF14
  D276    FE 7E          C                  CP      7EH
  D278    30 14          C                  JR      NC,TA.ABF14
  D27A    FE 61          C                  CP      61H
  D27C    30 0A          C                  JR      NC,TA.ABF15
  D27E    FE 5E          C                  CP      5EH
  D280    30 0C          C                  JR      NC,TA.ABF14
  D282    FE 41          C                  CP      41H
  D284    30 06          C                  JR      NC,TA.ABF16
  D286    18 06          C                  JR      TA.ABF14
  D288    D6 20          C      TA.ABF15:   SUB     20H
  D28A    18 02          C                  JR      TA.ABF14
  D28C    C6 20          C      TA.ABF16:   ADD     A,20H
  D28E    FE 80          C      TA.ABF14:   CP      80H
  D290    D2 D337        C                  JP      NC,TA.ABF20         ;Kode > 7FH    Funktionstasten
  D293    FE 09          C                  CP      09H
  D295    CA D402        C                  JP      Z,TA.ET2            ;Taste ET2 == 09H == HT == Tabulator
  D298    FE 1E          C                  CP      1EH
  D29A    CA D408        C                  JP      Z,TA.ET1            ;Taste ET1 == 1EH == RS
  D29D    21 B23F        C      TA.ABF1:    LD      HL,TS.SPMER         ;Auswertung Alphatastatur
  D2A0    FE 3A          C                  CP      3AH
  D2A2    30 57          C                  JR      NC,TA.ABF10
  D2A4    FE 20          C                  CP      20H
  D2A6    30 29          C                  JR      NC,TA.ABF6
  D2A8    CB 46          C                  BIT     0,(HL)              ;Kodegruppe 1   00H - 1FH
  D2AA    28 7B          C                  JR      Z,TA.TFE
                         C      
                         C                  PAGE
'Abfrageschleife'	MACRO-80 3.44	09-Dec-81	PAGE	1-73


                         C      
  D2AC    2A B22D        C      TA.ABF2:    LD      HL,(TS.EINA)
  D2AF    4F             C      TA.ABF3:    LD      C,A
  D2B0    7C             C                  LD      A,H
  D2B1    B5             C                  OR      L
  D2B2    28 73          C                  JR      Z,TA.TFE
                         C      
  D2B4    3E 07          C                  LD      A,7                 ;Cursor loeschen
  D2B6    32 B198        C                  LD      (MS.CMD),A
  D2B9    CD CB16        C                  CALL    MO.MONI
                         C      
  D2BC    79             C                  LD      A,C
  D2BD    CD D2D0        C                  CALL    TA.MM
                         C      
  D2C0    3E 06          C                  LD      A,6                 ;Cursor setzen
  D2C2    32 B198        C                  LD      (MS.CMD),A
  D2C5    CD CB16        C                  CALL    MO.MONI
                         C      
  D2C8    3A B247        C                  LD      A,(TS.MIO)
  D2CB    B7             C                  OR      A
  D2CC    CA D469        C                  JP      Z,TA.WART
  D2CF    C9             C                  RET
                         C      
                         C      ;
  D2D0    E9             C      TA.MM:      JP      (HL)
                         C      ;
                         C      
  D2D1    FE 30          C      TA.ABF6:    CP      30H                 ;Kodegruppe 2,3,4,5   20H - 39H
  D2D3    30 20          C                  JR      NC,TA.ABF9
  D2D5    FE 2B          C                  CP      '+'
  D2D7    28 16          C                  JR      Z,TA.ABF8
  D2D9    FE 2D          C                  CP      '-'
  D2DB    28 12          C                  JR      Z,TA.ABF8
  D2DD    FE 2E          C                  CP      '.'
  D2DF    28 0E          C                  JR      Z,TA.ABF8
  D2E1    FE 20          C                  CP      ' '
  D2E3    28 04          C                  JR      Z,TA.ABF7
  D2E5    FE 2C          C                  CP      ','
  D2E7    20 12          C                  JR      NZ,TA.ABF10
                         C      
  D2E9    CB 4E          C      TA.ABF7:    BIT     1,(HL)              ;Kodegruppe 2   20H , 2CH
  D2EB    28 3A          C                  JR      Z,TA.TFE
  D2ED    18 BD          C                  JR      TA.ABF2
                         C      
  D2EF    CB 56          C      TA.ABF8:    BIT     2,(HL)              ;Kodegruppe 3   2BH , 2DH , 2EH
  D2F1    28 34          C                  JR      Z,TA.TFE
  D2F3    18 B7          C                  JR      TA.ABF2
                         C      
  D2F5    CB 5E          C      TA.ABF9:    BIT     3,(HL)              ;Kodegruppe 4   30H - 39H
  D2F7    28 2E          C                  JR      Z,TA.TFE
  D2F9    18 B1          C                  JR      TA.ABF2
                         C      
                         C                  PAGE
'Abfrageschleife'	MACRO-80 3.44	09-Dec-81	PAGE	1-74


                         C      
  D2FB    FE 23          C      TA.ABF10:   CP      '#'                 ;Kodegruppe 5,6,7
  D2FD    28 1C          C                  JR      Z,TA.ABF12
  D2FF    FE 24          C                  CP      '$'
  D301    28 18          C                  JR      Z,TA.ABF12
  D303    FE 40          C                  CP      40H
  D305    38 0E          C                  JR      C,TA.ABF11
  D307    FE 7B          C                  CP      7BH
  D309    30 0A          C                  JR      NC,TA.ABF11
  D30B    FE 61          C                  CP      61H
  D30D    30 12          C                  JR      NC,TA.ABF13
  D30F    FE 5B          C                  CP      5BH
  D311    30 02          C                  JR      NC,TA.ABF11
  D313    18 06          C                  JR      TA.ABF12
                         C      
  D315    CB 66          C      TA.ABF11:   BIT     4,(HL)              ;Kodegruppe 5   !"%&'()*/:;<=>?[\]^_{|}`~
  D317    28 0E          C                  JR      Z,TA.TFE
  D319    18 91          C                  JR      TA.ABF2
                         C      
  D31B    CB 6E          C      TA.ABF12:   BIT     5,(HL)              ;Kodegruppe 6   A bis Z , @ # $
  D31D    28 08          C                  JR      Z,TA.TFE
  D31F    18 8B          C                  JR      TA.ABF2
                         C      
  D321    CB 76          C      TA.ABF13:   BIT     6,(HL)              ;Kodegruppe 7   a bis z
  D323    28 02          C                  JR      Z,TA.TFE
  D325    18 85          C                  JR      TA.ABF2
                         C      
                         C      ;****************************************************************
                         C      ;*             Warten auf Tastenende                            *
                         C      ;****************************************************************
  D327    AF             C      TA.TFE:     XOR     A                   ;warten auf Tastenende
  D328    32 B242        C                  LD      (TS.ZSMER),A
  D32B    32 B246        C                  LD      (TS.ZSTC),A
  D32E    3A B247        C                  LD      A,(TS.MIO)
  D331    B7             C                  OR      A
  D332    C0             C                  RET     NZ
                         C      
  D333    CD D1C1        C                  CALL    TA.TRTFE
                         C      
  D336    C9             C                  RET
                         C      
                         C                  PAGE
'Abfrageschleife'	MACRO-80 3.44	09-Dec-81	PAGE	1-75


                         C      
  D337    FE FC          C      TA.ABF20:   CP      0FCH                ;Funktionstasten   Code > 7FH
  D339    D2 D38B        C                  JP      NC,TA.EW1           ;Ebenenumschalter E=0 - E=3
  D33C    FE F0          C                  CP      0F0H
  D33E    D2 D3A9        C                  JP      NC,TA.STEUT         ;Kursorsteuertasten
  D341    FE D0          C                  CP      0D0H
  D343    D2 D3DB        C                  JP      NC,TA.STZ           ;Hexatasten 00H - 1FH
  D346    FE CA          C                  CP      0CAH
  D348    D2 D3E0        C                  JP      NC,TA.FKT2          ;Fkt.tasten 00,000,NEG QUIT,SYS,END,ABS
  D34B    FE C0          C                  CP      0C0H
  D34D    D2 D3FD        C                  JP      NC,TA.HZE           ;Hexatasten 0 - 9
  D350    21 B23F        C                  LD      HL,TS.SPMER
  D353    CB 7E          C                  BIT     7,(HL)
  D355    28 D0          C                  JR      Z,TA.TFE
  D357    FE B0          C                  CP      0B0H
  D359    D2 D3F5        C                  JP      NC,TA.FKT1          ;Fkt.tasten POS QUIT,TABS,TABL,USP1,USP2
                         C      ;
  D35C    AF             C                  XOR     A                   ;Fkt.tasten P1 - P12
  D35D    21 B23E        C                  LD      HL,TS.EMERK
  D360    BE             C                  CP      (HL)
  D361    28 21          C                  JR      Z,TA.EAW4
  D363    21 B23E        C                  LD      HL,TS.EMERK
  D366    46             C                  LD      B,(HL)
  D367    3A B23C        C                  LD      A,(TS.TK)
  D36A    D6 80          C                  SUB     80H
  D36C    C6 0C          C      TA.EAW2:    ADD     A,12
  D36E    10 FC          C                  DJNZ    TA.EAW2
  D370    3C             C      TA.EAW3:    INC     A
  D371    32 B23D        C                  LD      (TS.PTK),A
  D374    3D             C                  DEC     A
  D375    87             C                  ADD     A,A
  D376    06 00          C                  LD      B,0
  D378    4F             C                  LD      C,A
  D379    21 B19F        C                  LD      HL,TS.TAB1
  D37C    09             C                  ADD     HL,BC
  D37D    7E             C      TA.ABFR9:   LD      A,(HL)
  D37E    23             C                  INC     HL
  D37F    66             C                  LD      H,(HL)
  D380    6F             C                  LD      L,A
  D381    C3 D2AF        C                  JP      TA.ABF3
  D384    3A B23C        C      TA.EAW4:    LD      A,(TS.TK)
  D387    D6 80          C                  SUB     80H
  D389    18 E5          C                  JR      TA.EAW3
                         C      
  D38B    21 B23F        C      TA.EW1:     LD      HL,TS.SPMER         ;Funktionstasten FCH - FFH
  D38E    CB 7E          C                  BIT     7,(HL)
  D390    CA D327        C                  JP      Z,TA.TFE
  D393    2F             C                  CPL
  D394    32 B23E        C                  LD      (TS.EMERK),A
  D397    CD C67C        C                  CALL    S1.STAT
                         C      
  D39A    CD D22A        C                  CALL    TA.BBB
  D39D    CD D1EB        C                  CALL    TA.TEM
                         C      
  D3A0    3A B23E        C                  LD      A,(TS.EMERK)
  D3A3    21 B233        C                  LD      HL,TS.TAB5
  D3A6    C3 D3ED        C                  JP      TA.FKT3
                         C      
                         C                  PAGE
'Abfrageschleife'	MACRO-80 3.44	09-Dec-81	PAGE	1-76


                         C      
  D3A9    21 B23F        C      TA.STEUT:   LD      HL,TS.SPMER         ;Funktionstasten F0H - FBH
  D3AC    CB 7E          C                  BIT     7,(HL)
  D3AE    CA D327        C                  JP      Z,TA.TFE
  D3B1    FE F0          C                  CP      0F0H
  D3B3    28 0D          C                  JR      Z,TA.INSMD
  D3B5    D6 F0          C                  SUB     0F0H
  D3B7    87             C                  ADD     A,A
  D3B8    06 00          C      TA.STEU1:   LD      B,0
  D3BA    4F             C                  LD      C,A
  D3BB    21 B1FF        C                  LD      HL,TS.TAB2
  D3BE    09             C                  ADD     HL,BC
  D3BF    C3 D37D        C                  JP      TA.ABFR9
                         C      
  D3C2    3A B240        C      TA.INSMD:   LD      A,(TS.UMERK)
  D3C5    B7             C                  OR      A
  D3C6    28 03          C                  JR      Z,TA.INSME
  D3C8    3D             C                  DEC     A                   ;INS_MOD ausschalten
  D3C9    18 01          C                  JR      TA.INSML
  D3CB    3C             C      TA.INSME:   INC     A                   ;INS_MOD einschalten
  D3CC    32 B240        C      TA.INSML:   LD      (TS.UMERK),A
                         C      
  D3CF    CD D22A        C                  CALL    TA.BBB
  D3D2    CD D1D6        C                  CALL    TA.TIM
                         C      
  D3D5    CD C67C        C                  CALL    S1.STAT
  D3D8    AF             C                  XOR     A
  D3D9    18 DD          C                  JR      TA.STEU1
                         C      
  D3DB    D6 D0          C      TA.STZ:     SUB     0D0H                ;Funktionstasten D0H - EFH
  D3DD    C3 D29D        C                  JP      TA.ABF1
                         C      
  D3E0    21 B23F        C      TA.FKT2:    LD      HL,TS.SPMER         ;Fkt.tasten 00,000,NEG QUIT,SYS,END,ABS
  D3E3    CB 7E          C                  BIT     7,(HL)
  D3E5    CA D327        C                  JP      Z,TA.TFE
  D3E8    D6 CA          C                  SUB     0CAH
  D3EA    21 B217        C                  LD      HL,TS.TAB3
  D3ED    87             C      TA.FKT3:    ADD     A,A
  D3EE    06 00          C                  LD      B,0
  D3F0    4F             C                  LD      C,A
  D3F1    09             C                  ADD     HL,BC
  D3F2    C3 D37D        C                  JP      TA.ABFR9
                         C      
  D3F5    D6 B0          C      TA.FKT1:    SUB     0B0H                ;Fkt.tasten POS QUIT,TABS,TABL,USP1,USP2
  D3F7    87             C                  ADD     A,A
  D3F8    21 B223        C                  LD      HL,TS.TAB4
  D3FB    18 F0          C                  JR      TA.FKT3
                         C      
  D3FD    D6 90          C      TA.HZE:     SUB     90H                 ;Hexatasten 0 - 9
  D3FF    C3 D29D        C                  JP      TA.ABF1
                         C      
  D402    2A B22F        C      TA.ET2:     LD      HL,(TS.TABU)
  D405    C3 D2AF        C                  JP      TA.ABF3
                         C      
  D408    2A B231        C      TA.ET1:     LD      HL,(TS.NEWL)
  D40B    C3 D2AF        C                  JP      TA.ABF3
                         C                  PAGE
'Abfrageschleife'	MACRO-80 3.44	09-Dec-81	PAGE	1-77


                         C      
                         C      ;****************************************************************
                         C      ;*               loeschen aller Tastenroutinenadressen          *
                         C      ;****************************************************************
  D40E    AF             C      TA.LOE:     XOR     A
  D40F    32 B23F        C                  LD      (TS.SPMER),A
  D412    21 B19F        C                  LD      HL,TS.TAB1
  D415    36 00          C                  LD      (HL),0
  D417    11 B1A0        C                  LD      DE,TS.TAB1+1
  D41A    01 009B        C                  LD      BC,TS.PTAST-TS.TAB1-1
  D41D    ED B0          C                  LDIR
  D41F    21 C354        C                  LD      HL,S1.HCOPY
  D422    22 B21F        C                  LD      (TS.TAB3+8),HL
  D425    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*               wie LOE  , zusaetzlich werden Standardroutinen *
                         C      ;*               eingetragen: Cursortasten , DEL LINE , SYS ,   *
                         C      ;*                            alphanum. Tasten                  *
                         C      ;****************************************************************
  D426    CD D40E        C      TA.LOES:    CALL    TA.LOE
  D429    21 D435        C                  LD      HL,TA.TRTAB
  D42C    11 B1FF        C                  LD      DE,TS.TAB2
  D42F    01 0034        C                  LD      BC,TS.TAB5-TS.TAB2
  D432    ED B0          C                  LDIR
  D434    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*               Standardbelegung der Tastaturadress-Tabellen   *
                         C      ;****************************************************************
  D435    0000           C      TA.TRTAB:   DW      0                   ;TS.TAB2   INS MOD
  D437    0000           C                  DW      0                   ;          DEL
  D439    0000           C                  DW      0                   ;          INS LINE
  D43B    C304           C                  DW      S1.DELZL            ;          DEL LINE
                         C      
  D43D    0000           C                  DW      0                   ;          SCH LINKS
  D43F    C2EB           C                  DW      S1.CNOS             ;          C   HOCH
  D441    0000           C                  DW      0                   ;          SCH RECHTS
  D443    C2D3           C                  DW      S1.CNLS             ;          C   LINKS
  D445    C2F7           C                  DW      S1.HOME             ;          HOME
  D447    C2B4           C                  DW      S1.CNRS             ;          C   RECHTS
  D449    C300           C                  DW      S1.CNZA             ;          CNZA
  D44B    C2DF           C                  DW      S1.CNUS             ;          C   RUNTER
                         C      
  D44D    C334           C                  DW      S1.NN               ;TS.TAB3   00
  D44F    C345           C                  DW      S1.NNN              ;          000
  D451    0000           C                  DW      0                   ;          NEG QUIT
  D453    C114           C                  DW      S1.SYSTB            ;          SYS
  D455    C354           C                  DW      S1.HCOPY            ;          HCOPY
  D457    0000           C                  DW      0                   ;          ABS
                         C      
  D459    0000           C                  DW      0                   ;TS.TAB4   POS QUIT
  D45B    0000           C                  DW      0                   ;          TABS
  D45D    0000           C                  DW      0                   ;          TABL
  D45F    0000           C                  DW      0                   ;          CI
  D461    0000           C                  DW      0                   ;          M
                         C      
  D463    C328           C                  DW      S1.AEIN             ;TS.EINA
                         C      
  D465    0000           C                  DW      0                   ;TS.TABU
                         C      
  D467    0000           C                  DW      0                   ;TS.NEWL
                         C      
                         C                  TITLE   'Warteschleife'
                         C                  PAGE
'Warteschleife'	MACRO-80 3.44	09-Dec-81	PAGE	1-78


                         C      
                         C      ;****************************************************************
                         C      ;*               Warteschleife fuer Schnellschreiben            *
                         C      ;****************************************************************
  D469    DD E5          C      TA.WART:    PUSH    IX
  D46B    DD 21 B243     C                  LD      IX,TS.ZEIT1
  D46F    DD 7E 01       C      TA.WART0:   LD      A,(IX+1)
  D472    DD 96 00       C                  SUB     (IX+0)
  D475    DD 77 02       C                  LD      (IX+2),A
  D478    06 82          C                  LD      B,130
  D47A    3A B242        C      TA.WART1:   LD      A,(TS.ZSMER)
  D47D    B7             C                  OR      A
  D47E    28 27          C                  JR      Z,TA.WART2
  D480    C5             C                  PUSH    BC
  D481    CD D143        C                  CALL    TA.TA1
  D484    C1             C                  POP     BC
  D485    20 20          C                  JR      NZ,TA.WART2
  D487    C5             C                  PUSH    BC
  D488    CD D15B        C                  CALL    TA.TA2
  D48B    C1             C                  POP     BC
  D48C    21 B23C        C                  LD      HL,TS.TK
  D48F    BE             C                  CP      (HL)
  D490    20 15          C                  JR      NZ,TA.WART2
  D492    10 E6          C                  DJNZ    TA.WART1
  D494    3A B246        C                  LD      A,(TS.ZSTC)
  D497    DD BE 02       C                  CP      (IX+2)
  D49A    38 05          C                  JR      C,TA.WART3
  D49C    DD BE 01       C                  CP      (IX+1)
  D49F    28 0B          C                  JR      Z,TA.WART4
  D4A1    3C             C      TA.WART3:   INC     A
  D4A2    32 B246        C                  LD      (TS.ZSTC),A
  D4A5    18 C8          C                  JR      TA.WART0
                         C      
  D4A7    DD E1          C      TA.WART2:   POP     IX
  D4A9    C3 D327        C                  JP      TA.TFE
                         C      
  D4AC    DD 7E 02       C      TA.WART4:   LD      A,(IX+2)
  D4AF    32 B246        C                  LD      (TS.ZSTC),A
  D4B2    AF             C                  XOR     A
  D4B3    32 B23C        C                  LD      (TS.TK),A
  D4B6    DD E1          C                  POP     IX
  D4B8    C9             C                  RET
                         C      
                         C      
                         C      ;           END
                         C      ;           PN      K158
                         C                  TITLE   'Basisroutinen Kassette'
                         C                  PAGE
'Basisroutinen Kassette'	MACRO-80 3.44	09-Dec-81	PAGE	1-79


                         C      
                         C      ;****************************************************************
                         C      ;*               Basisroutinen Kassette                         *
                         C      ;*  Version      -----------------------------------------------*
                         C      ;*               Programmierer: M. Herbote --- K EAW  ZFT (WFT) *
                         C      ;*  V 2 . 1      -----------------------------------------------*
                         C      ;*               Stand        : 10.April 1984                   *
                         C      ;****************************************************************
                         C      
                         C      
                         C      ;****************************************************************
                         C      ;*                                                              *
                         C      ;*   Die unterste Schicht wird von der  ROBOTRON - OEM-Routine  *
                         C      ;*   gebildet. Sie enthaelt die Routinen:                       *
                         C      ;*   INIT  ...   Initialisieren der  AKB - PIO s  und           *
                         C      ;*   BRKMB ...   Ausfuehrung eines Kassettenkommandos           *
                         C      ;*                                                              *
                         C      ;*   Nachfolgende Tabelle zeigt die implementierten Basis-      *
                         C      ;*   routinen und ihre Kommandos.                               *
                         C      ;*                                                              *
                         C      ;*   symb. Adr. OEM-Komm. SYS-Komm.                             *
                         C      ;*   ---------------------------------------------------------  *
                         C      ;*   GNRE       31H       KiRE      reservieren ein             *
                         C      ;*   GNRA       41H                 reservieren aus             *
                         C      ;*                        KiRA      enthaelt GNRE,GNRW,GNRA     *
                         C      ;*   GNRW       21H       KiRW      rewind                      *
                         C      ;*   GNRP                 KiR+      einen  Block vor            *
                         C      ;*   GNRM                 KiR-      einen  Block zurueck        *
                         C      ;*   GNLP       71H       KiL+      eine   Datei vor            *
                         C      ;*   GNLPN                          um (D) Dateien vor          *
                         C      ;*   GNLM       75H       KiL-      eine   Datei zurueck        *
                         C      ;*   GNLMN                          um (D) Dateien zurueck      *
                         C      ;*   GNCLS   51,61,15,11H KiCL      Abschluss einer Ausg.datei  *
                         C      ;*                                                              *
                         C      ;*   GNRD       02H                 einen  Block  ==>  KS.PUFFS *
                         C      ;*   GNRDR                KiXA,-XE  (K2.TXANF-K2.TXEND) fuellen *
                         C      ;*   EIN                            S0.PFFI  fuellen            *
                         C      ;*   EINP                           einen  Block  ==>  S0.PFFI  *
                         C      ;*   LESV                           Eingabe eines Zeichens vw.  *
                         C      ;*   LESR                           Eingabe eines Zeichens rw.  *
                         C      ;*                                                              *
                         C      ;*   GNWR       00H                 einen  Block ausgeben       *
                         C      ;*   GNWRT                KiY       (K2.TXANF-K2.TXEND) ausgeben*
                         C      ;*   AUS                            S0.PFFA  ausgeben           *
                         C      ;*   SCHR                           Ausgabe eines Zeichens      *
                         C      ;*                                                              *
                         C      ;*   GNRWR      08H                 einen  Block zurueckschr.   *
                         C      ;*                                                              *
                         C      ;*   MRCAT                          Zugriff auf MRES-Katalog    *
                         C      ;*   MREPO                KiME      MRES-Eingabedatei eroeffnen *
                         C      ;*   MRAPO                KiMA      MRES-Ausgabedatei eroeffnen *
                         C      ;*   MRCLS                KiMC      MRES-Ausgabedatei abschl.   *
                         C      ;*                                                              *
                         C      ;****************************************************************
                         C      
  D4B9    20 46 65 68    C      K1.ADRK1:   DB      ' Fehler- Status:    .. Nummer:    ..  '
  D4BD    6C 65 72 2D    C      
  D4C1    20 53 74 61    C      
  D4C5    74 75 73 3A    C      
  D4C9    20 20 20 20    C      
  D4CD    2E 2E 20 4E    C      
  D4D1    75 6D 6D 65    C      
  D4D5    72 3A 20 20    C      
  D4D9    20 20 2E 2E    C      
  D4DD    20 20          C      
  D4DF    20 47 65 72    C      K1.ADRK2:   DB      ' Ger: .   Datei:  ....   Satz:  ....  '
  D4E3    3A 20 2E 20    C      
  D4E7    20 20 44 61    C      
  D4EB    74 65 69 3A    C      
  D4EF    20 20 2E 2E    C      
  D4F3    2E 2E 20 20    C      
  D4F7    20 53 61 74    C      
  D4FB    7A 3A 20 20    C      
  D4FF    2E 2E 2E 2E    C      
  D503    20 20          C      
  D505    20 20 20 4B    C      K1.ADRK3:   DB      '   Kassette fuehrt ein Kommando aus   '
  D509    61 73 73 65    C      
  D50D    74 74 65 20    C      
  D511    66 75 65 68    C      
  D515    72 74 20 65    C      
  D519    69 6E 20 4B    C      
  D51D    6F 6D 6D 61    C      
'Basisroutinen Kassette'	MACRO-80 3.44	09-Dec-81	PAGE	1-80


  D521    6E 64 6F 20    C      
  D525    61 75 73 20    C      
  D529    20 20          C      
  D52B    20 20 20 20    C      K1.ADRK4:   DB      '                                      '
  D52F    20 20 20 20    C      
  D533    20 20 20 20    C      
  D537    20 20 20 20    C      
  D53B    20 20 20 20    C      
  D53F    20 20 20 20    C      
  D543    20 20 20 20    C      
  D547    20 20 20 20    C      
  D54B    20 20 20 20    C      
  D54F    20 20          C      
                         C      
                         C                  TITLE   'K M B G  allgemeine Unterprogramme'
                         C                  PAGE
'K M B G  allgemeine Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-81


                         C      
                         C      ;****************************************************************
                         C      ;*  K M B G      Aktivierung Geraeteroutine                     *
                         C      ;****************************************************************
  D551    DD E5          C      K1.ARMB:    PUSH    IX
  D553    FD E5          C                  PUSH    IY
  D555    CD D66D        C                  CALL    K1.MVS              ;Anzeige Kassettengeraet arbeitet
  D558    2A B132        C                  LD      HL,(K2.FKADR)
  D55B    11 D505        C                  LD      DE,K1.ADRK3
  D55E    CD D64C        C                  CALL    K1.MONI
  D561    CD D684        C                  CALL    K1.MVL
                         C                  ; LD      (IX+5),LOW(K1.ARMB1)
                         C                  ; LD      (IX+6),HIGH(K1.ARMB1)
  D564    DD E5          C      K1.ARMBM:   PUSH    IX
  D566    CD F659        C                  CALL    S0.KRZU             ;BAMOS-Routine zuschalten
  D569    CD D57C        C                  CALL    K1.IX2V1            ;???? ;IX-Bereich ===> V1
  D56C    CD 4069        C                  CALL    KR.BRKMB            ;Ausfuehrung Kassettenkommando
  D56F    DD E1          C                  POP     IX
  D571    CD D596        C                  CALL    K1.V12IX            ;V1 ===> IX-Bereich
                         C      ; K1.ARMB0:   HALT                        ;warten auf Routinen-Ende
                         C      ;             JR      K1.ARMB0
                         C      ; K1.ARMB1:   INC     SP                  ;stack-pointer korrigieren
                         C      ;             INC     SP
  D574    CD B2D4        C                  CALL    S2.STACK            ;BAMOS-Routine wegschalten
  D577    FD E1          C                  POP     IY
  D579    DD E1          C                  POP     IX
  D57B    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*  K M B G      IX-Bereich to SYS V1.2                         *
                         C      ;****************************************************************
  D57C    E5             C      K1.IX2V1:   PUSH    HL
  D57D    D5             C                  PUSH    DE
  D57E    C5             C                  PUSH    BC
  D57F    DD E5          C                  PUSH    IX
  D581    E1             C                  POP     HL
  D582    DD 21 2B03     C                  LD      IX,UB.KTAB
  D586    DD 36 FE 02    C                  LD      (IX-2),2            ;HS-Bereich V2.13 (K0.HSB)
  D58A    11 2B03        C                  LD      DE,UB.KTAB
  D58D    01 000B        C                  LD      BC,11
  D590    ED B0          C                  LDIR
  D592    C1             C                  POP     BC
  D593    D1             C                  POP     DE
  D594    E1             C                  POP     HL
  D595    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*  K M B G      SYS V1.2 to IX-Bereich                         *
                         C      ;****************************************************************
  D596    E5             C      K1.V12IX:   PUSH    HL
  D597    D5             C                  PUSH    DE
  D598    C5             C                  PUSH    BC
  D599    DD E5          C                  PUSH    IX
  D59B    DD E5          C                  PUSH    IX
  D59D    D1             C                  POP     DE
  D59E    21 2B03        C                  LD      HL,UB.KTAB          ;Statusbyte und Fehlerbyte holen
  D5A1    01 0002        C                  LD      BC,2
  D5A4    ED B0          C                  LDIR
  D5A6    DD E1          C                  POP     IX
  D5A8    21 2B02        C                  LD      HL,UB.KTAB-1        ;Laenge der Daten im Puffer (1 BM, 2 SL, 20H oder 80H)
  D5AB    46             C                  LD      B,(HL)
  D5AC    DD 70 0D       C                  LD      (IX+13),B
  D5AF    C1             C                  POP     BC
  D5B0    D1             C                  POP     DE
  D5B1    E1             C                  POP     HL
  D5B2    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*  K M B G      Fehlertest nach CALL ARMB                      *
                         C      ;****************************************************************
  D5B3    DD CB 00 7E    C      K1.ARBT:    BIT     7,(IX+0)
  D5B7    C2 D6A1        C                  JP      NZ,K1.ERRT
  D5BA    CD D65D        C                  CALL    K1.FL
  D5BD    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*  K M B G      Unterprogramme fuer RCZx +- 1 und BLKx +-1     *
                         C      ;****************************************************************
  D5BE    FD 66 FF       C      K1.BLKP:    LD      H,(IY-1)            ;BLK x  +  1
  D5C1    FD 6E FE       C                  LD      L,(IY-2)
  D5C4    23             C                  INC     HL
  D5C5    FD 74 FF       C                  LD      (IY-1),H
  D5C8    FD 75 FE       C                  LD      (IY-2),L
  D5CB    C9             C                  RET
                         C      
  D5CC    FD 66 FF       C      K1.BLKM:    LD      H,(IY-1)            ;BLK x  -  1
'K M B G  allgemeine Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-82


  D5CF    FD 6E FE       C                  LD      L,(IY-2)
  D5D2    2B             C                  DEC     HL
  D5D3    FD 74 FF       C                  LD      (IY-1),H
  D5D6    FD 75 FE       C                  LD      (IY-2),L
  D5D9    C9             C                  RET
                         C      
  D5DA    FD 66 FD       C      K1.RCZP:    LD      H,(IY-3)            ;RCZ x  +  1
  D5DD    FD 6E FC       C                  LD      L,(IY-4)
  D5E0    23             C                  INC     HL
  D5E1    FD 74 FD       C                  LD      (IY-3),H
  D5E4    FD 75 FC       C                  LD      (IY-4),L
  D5E7    C9             C                  RET
                         C      
  D5E8    FD 66 FD       C      K1.RCZM:    LD      H,(IY-3)            ;RCZ x  -  1
  D5EB    FD 6E FC       C                  LD      L,(IY-4)
  D5EE    2B             C                  DEC     HL
  D5EF    FD 74 FD       C                  LD      (IY-3),H
  D5F2    FD 75 FC       C                  LD      (IY-4),L
  D5F5    C9             C                  RET
                         C      
                         C                  PAGE
'K M B G  allgemeine Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-83


                         C      
                         C      ;****************************************************************
                         C      ;*  K M B G      RCZx loeschen                                  *
                         C      ;****************************************************************
  D5F6    AF             C      K1.RCZN:    XOR     A                   ;RCZ x  :=  0
  D5F7    FD 77 FD       C      K1.RCZS:    LD      (IY-3),A            ;RCZ x  :=  (A)
  D5FA    FD 77 FC       C                  LD      (IY-4),A
  D5FD    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*  K M B G      HL und BC laden aus E/A-Tabelle                *
                         C      ;****************************************************************
  D5FE    DD 66 08       C      K1.LHLBC:   LD      H,(IX+8)
  D601    DD 6E 07       C                  LD      L,(IX+7)
  D604    DD 46 09       C                  LD      B,(IX+9)
  D607    DD 4E 0A       C                  LD      C,(IX+10)
  D60A    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*  K M B G      Bandmarke gelesen ?                            *
                         C      ;****************************************************************
  D60B    DD 7E 09       C      K1.BM:      LD      A,(IX+9)
  D60E    DD B6 0A       C                  OR      (IX+10)
  D611    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*  K M B G      zweiter Leseversuch nach Fehler 17             *
                         C      ;****************************************************************
  D612    DD 7E 01       C      K1.F17:     LD      A,(IX+1)            ;Fehlerbyte
  D615    FE 17          C                  CP      17H
  D617    C0             C                  RET     NZ
  D618    DD 36 04 15    C                  LD      (IX+4),15H          ;CMD einen Block zurueck
  D61C    CD D551        C                  CALL    K1.ARMB
  D61F    CD D5B3        C                  CALL    K1.ARBT
  D622    DD 36 04 02    C                  LD      (IX+4),02H          ;CMD Wiedergabe
  D626    CD D551        C                  CALL    K1.ARMB
  D629    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*  K M B G      IX und IY  mit Anfangswerten laden             *
                         C      ;****************************************************************
  D62A    DD 21 0013     C      K1.RGL1:    LD      IX,S3.KS1-S3.SEAT
  D62E    11 A803        C                  LD      DE,S0.DEAT+3
  D631    DD 19          C                  ADD     IX,DE
  D633    FD 21 00B0     C                  LD      IY,S3.KSK1-S3.SEAT
  D637    13             C                  INC     DE
  D638    FD 19          C                  ADD     IY,DE
  D63A    C9             C                  RET
                         C      
  D63B    DD 21 002E     C      K1.RGL2:    LD      IX,S3.KS2-S3.SEAT
  D63F    11 A803        C                  LD      DE,S0.DEAT+3
  D642    DD 19          C                  ADD     IX,DE
  D644    FD 21 00D4     C                  LD      IY,S3.KSK2-S3.SEAT
  D648    13             C                  INC     DE
  D649    FD 19          C                  ADD     IY,DE
  D64B    C9             C                  RET
                         C      
                         C                  PAGE
'K M B G  allgemeine Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-84


                         C      
                         C      ;****************************************************************
                         C      ;*  K M B G      Anzeigetext    ===>    K2.S/F-KADR             *
                         C      ;****************************************************************
  D64C    25             C      K1.MONI:    DEC     H                   ;(HL) ...  K2.S/F-KADR
  D64D    2D             C                  DEC     L                   ;(DE) ...  ADRKi
  D64E    22 B18C        C                  LD      (MS.ZPOS),HL
  D651    EB             C                  EX      DE,HL
  D652    06 26          C                  LD      B,38
  D654    3E 18          C                  LD      A,24
  D656    32 B198        C                  LD      (MS.CMD),A
  D659    CD CB16        C                  CALL    MO.MONI
  D65C    C9             C                  RET
                         C      
  D65D    CD D66D        C      K1.FL:      CALL    K1.MVS              ;Fehlerzeile loeschen
  D660    2A B132        C                  LD      HL,(K2.FKADR)
  D663    11 D52B        C                  LD      DE,K1.ADRK4
  D666    CD D64C        C                  CALL    K1.MONI
  D669    CD D684        C                  CALL    K1.MVL
  D66C    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*  K M B G      Monitorvektor retten und wiederherstellen      *
                         C      ;***************************************************************
  D66D    21 B18A        C      K1.MVS:     LD      HL,MS.ZPOL
  D670    11 B162        C                  LD      DE,K2.RBER
  D673    01 0015        C                  LD      BC,21
  D676    ED B0          C                  LDIR
  D678    21 DEC9        C                  LD      HL,K1.ZMIN
  D67B    11 B18E        C                  LD      DE,MS.ZMIN
  D67E    01 000A        C                  LD      BC,10
  D681    ED B0          C                  LDIR
  D683    C9             C                  RET
                         C      
  D684    21 B162        C      K1.MVL:     LD      HL,K2.RBER
  D687    11 B18A        C                  LD      DE,MS.ZPOL
  D68A    01 0015        C                  LD      BC,21
  D68D    ED B0          C                  LDIR
  D68F    C9             C                  RET
                         C      
  D690    E5             C      K1.ZPR2:    PUSH    HL
  D691    C5             C                  PUSH    BC
  D692    ED 6F          C                  RLD
  D694    E6 0F          C                  AND     0FH
  D696    C6 30          C                  ADD     A,30H
  D698    FE 3A          C                  CP      3AH
  D69A    38 02          C                  JR      C,K1.ZPR3
  D69C    C6 07          C                  ADD     A,7
  D69E    C1             C      K1.ZPR3:    POP     BC
  D69F    E1             C                  POP     HL
  D6A0    C9             C                  RET
                         C      
                         C                  PAGE
'K M B G  allgemeine Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-85


                         C      
                         C      ;****************************************************************
                         C      ;*  K M B G      Anzeige Geraetefehler                          *
                         C      ;****************************************************************
  D6A1    CD D66D        C      K1.ERRT:    CALL    K1.MVS
  D6A4    21 D4B9        C                  LD      HL,K1.ADRK1
  D6A7    11 B13A        C                  LD      DE,K2.ADRK
  D6AA    01 0026        C                  LD      BC,38
  D6AD    ED B0          C                  LDIR
  D6AF    DD E5          C                  PUSH    IX
  D6B1    DD E5          C                  PUSH    IX
  D6B3    DD 21 B13A     C                  LD      IX,K2.ADRK
  D6B7    E1             C                  POP     HL                  ;Statusaufbereitung
  D6B8    CD D690        C                  CALL    K1.ZPR2
  D6BB    DD 77 14       C                  LD      (IX+20),A
  D6BE    CD D690        C                  CALL    K1.ZPR2
  D6C1    DD 77 15       C                  LD      (IX+21),A
  D6C4    36 00          C                  LD      (HL),0              ;reset status
  D6C6    23             C                  INC     HL                  ;Fehleraufbereitung
  D6C7    CD D690        C                  CALL    K1.ZPR2
  D6CA    DD 77 22       C                  LD      (IX+34),A
  D6CD    CD D690        C                  CALL    K1.ZPR2
  D6D0    DD 77 23       C                  LD      (IX+35),A
  D6D3    36 00          C                  LD      (HL),0              ;reset fehler
  D6D5    2A B132        C                  LD      HL,(K2.FKADR)
  D6D8    11 B13A        C                  LD      DE,K2.ADRK
  D6DB    CD D64C        C                  CALL    K1.MONI
  D6DE    DD E1          C                  POP     IX
  D6E0    CD D684        C                  CALL    K1.MVL
  D6E3    CD D6EE        C                  CALL    K1.GNSTS
  D6E6    AF             C                  XOR     A                   ;Tastaturroutine ruecksetzen auf Tasteneingabe
  D6E7    32 B247        C                  LD      (TS.MIO),A
  D6EA    2A B136        C                  LD      HL,(K2.FRADR)
  D6ED    E9             C                  JP      (HL)
                         C      ;****************************************************************
                         C      ;*  K M B G    Anzeige STATUS                                   *
                         C      ;****************************************************************
  D6EE    CD D66D        C      K1.GNSTS:   CALL    K1.MVS
  D6F1    FD 6E FC       C                  LD      L,(IY-4)            ;RCZ:=RCZx
  D6F4    FD 66 FD       C                  LD      H,(IY-3)
  D6F7    22 B11C        C                  LD      (K2.RCZ),HL
  D6FA    FD 6E FE       C                  LD      L,(IY-2)            ;BLK:=BLKx
  D6FD    FD 66 FF       C                  LD      H,(IY-1)
  D700    22 B11E        C                  LD      (K2.BLK),HL
  D703    21 D4DF        C                  LD      HL,K1.ADRK2
  D706    11 B13A        C                  LD      DE,K2.ADRK
  D709    01 0026        C                  LD      BC,38
  D70C    ED B0          C                  LDIR
  D70E    11 B140        C                  LD      DE,K2.ADRK+6
  D711    DD 7E 03       C                  LD      A,(IX+3)            ;Geraeteadressenaufbereitung
  D714    C6 30          C                  ADD     A,30H
  D716    12             C                  LD      (DE),A
  D717    2A B11E        C                  LD      HL,(K2.BLK)         ;Blockzaehleraufbereitung
  D71A    11 B14B        C                  LD      DE,K2.ADRK+17
  D71D    CD C54E        C                  CALL    S1.HDI
  D720    2A B11C        C                  LD      HL,(K2.RCZ)         ;Satzzaehleraufbereitung
  D723    11 B159        C                  LD      DE,K2.ADRK+31
  D726    CD C54E        C                  CALL    S1.HDI
  D729    2A B134        C                  LD      HL,(K2.SKADR)
  D72C    11 B13A        C                  LD      DE,K2.ADRK
  D72F    CD D64C        C                  CALL    K1.MONI
  D732    CD D684        C                  CALL    K1.MVL
  D735    C9             C                  RET
                         C                  TITLE   'K M B G  reservieren ein/aus und rewind'
                         C      
                         C      ;****************************************************************
                         C      ;*  K M B G    Reservieren Geraet x ein                         *
                         C      ;****************************************************************
  D736    DD 36 04 31    C      K1.GNRE1:   LD      (IX+4),31H          ;CMD reservieren ein
  D73A    CD D551        C                  CALL    K1.ARMB
  D73D    DD CB 00 66    C                  BIT     4,(IX)
  D741    C4 D6A1        C                  CALL    NZ,K1.ERRT
  D744    C9             C                  RET
  D745    CD D736        C      K1.GNRE:    CALL    K1.GNRE1
  D748    CD D736        C                  CALL    K1.GNRE1
  D74B    CD D65D        C                  CALL    K1.FL
  D74E    DD CB FF 4E    C                  BIT     1,(IX-1)
  D752    C0             C                  RET     NZ
  D753    CD D5F6        C                  CALL    K1.RCZN             ;RCZx:=0
  D756    FD 77 FF       C                  LD      (IY-1),A            ;BLKx:=1
  D759    3C             C                  INC     A
  D75A    FD 77 FE       C                  LD      (IY-2),A
'K M B G  reservieren ein/aus und rewind'	MACRO-80 3.44	09-Dec-81	PAGE	1-86


  D75D    DD CB FF CE    C                  SET     1,(IX-1)
  D761    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*  K M B G    Reservieren Geraet x aus                         *
                         C      ;****************************************************************
  D762    DD 36 04 41    C      K1.GNRA:    LD      (IX+4),41H          ;CMD reservieren aus
  D766    CD D551        C                  CALL    K1.ARMB
  D769    CD D5B3        C                  CALL    K1.ARBT
  D76C    DD CB FF 8E    C                  RES     1,(IX-1)            ;OPEN-bit           zuruecksetzen
  D770    DD CB FF 96    C                  RES     2,(IX-1)            ;Richtungsbit       zuruecksetzen
  D774    DD CB FF 9E    C                  RES     3,(IX-1)            ;Verarbeitungsbit   zuruecksetzen
  D778    DD CB FF A6    C                  RES     4,(IX-1)            ;Konvertierungsbit  zuruecksetzen
  D77C    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*  K M B G    REWIND - Routine                                 *
                         C      ;****************************************************************
  D77D    CD D78E        C      K1.GNRW:    CALL    K1.RW3
  D780    CD D5F6        C                  CALL    K1.RCZN             ;RCZx:=0
  D783    FD 77 FF       C                  LD      (IY-1),A            ;BLKx:=1
  D786    3C             C                  INC     A
  D787    FD 77 FE       C                  LD      (IY-2),A
  D78A    CD D65D        C                  CALL    K1.FL
  D78D    C9             C                  RET
  D78E    DD 36 04 21    C      K1.RW3:     LD      (IX+4),21H          ;CMD  rewind
  D792    CD D551        C                  CALL    K1.ARMB
  D795    CD D79B        C      K1.RW1:     CALL    K1.BERT
  D798    D0             C                  RET     NC
  D799    18 FA          C                  JR      K1.RW1
                         C      
  D79B    CD F659        C      K1.BERT:    CALL    S0.KRZU
                         C      ;            CALL    0   ;??? KR.BERT
  D79E    CD B2D4        C                  CALL    S2.STACK
  D7A1    C9             C                  RET
                         C      
                         C                  TITLE   'K M B G  set RCD +- 1'
                         C                  PAGE
'K M B G  set RCD +- 1'	MACRO-80 3.44	09-Dec-81	PAGE	1-87


                         C      
                         C      ;****************************************************************
                         C      ;*  K M B G    set record + 1                                   *
                         C      ;****************************************************************
  D7A2    DD 36 04 02    C      K1.GNRP:    LD      (IX+4),02H          ;CMD wiedergabe
  D7A6    CD D551        C                  CALL    K1.ARMB
  D7A9    CD D5B3        C                  CALL    K1.ARBT
  D7AC    CD D5DA        C                  CALL    K1.RCZP
  D7AF    CD D60B        C                  CALL    K1.BM               ;RCD = BM ?
  D7B2    06 00          C                  LD      B,0
  D7B4    C0             C                  RET     NZ
  D7B5    04             C                  INC     B
  D7B6    CD D5BE        C                  CALL    K1.BLKP
  D7B9    CD D5F6        C                  CALL    K1.RCZN             ;RCZx:=0
  D7BC    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*  K M B G    set record - 1                                   *
                         C      ;****************************************************************
  D7BD    DD 36 04 15    C      K1.GNRM:    LD      (IX+4),15H          ;CMD einen block zurueck
  D7C1    CD D551        C                  CALL    K1.ARMB
  D7C4    CD D5B3        C                  CALL    K1.ARBT
  D7C7    DD 36 04 02    C                  LD      (IX+4),02H          ;CMD wiedergabe
  D7CB    CD D551        C                  CALL    K1.ARMB
  D7CE    CD D5B3        C                  CALL    K1.ARBT
  D7D1    DD 36 04 15    C                  LD      (IX+4),15H          ;CMD einen block zurueck
  D7D5    CD D551        C                  CALL    K1.ARMB
  D7D8    CD D5B3        C                  CALL    K1.ARBT
  D7DB    CD D5E8        C                  CALL    K1.RCZM
  D7DE    CD D60B        C                  CALL    K1.BM                  ;RCD = BM ?
  D7E1    06 00          C                  LD      B,0
  D7E3    C0             C                  RET     NZ
  D7E4    04             C                  INC     B
  D7E5    CD D5CC        C                  CALL    K1.BLKM
  D7E8    3E FF          C                  LD      A,0FFH              ;RCZx:=FFFFH
  D7EA    CD D5F7        C                  CALL    K1.RCZS
  D7ED    C9             C                  RET
                         C      
                         C                  TITLE   'K M B G  suche BM'
                         C                  PAGE
'K M B G  suche BM'	MACRO-80 3.44	09-Dec-81	PAGE	1-88


                         C      
                         C      ;****************************************************************
                         C      ;*  K M B G    suchen Bandmarke                                 *
                         C      ;****************************************************************
  D7EE    16 01          C      K1.GNLP:    LD      D,1                 ;vorwaerts     ====>
  D7F0    D5             C      K1.GNLPN:   PUSH    DE
  D7F1    FD 7E FD       C                  LD      A,(IY-3)            ;RCZx = 0 ?
  D7F4    FD B6 FC       C                  OR      (IY-4)
  D7F7    28 19          C                  JR      Z,K1.LP2
  D7F9    FD 7E FF       C                  LD      A,(IY-1)            ;RCZx > 0 , BLKx = 1 ?
  D7FC    B7             C                  OR      A
  D7FD    20 0C          C                  JR      NZ,K1.LP1
  D7FF    FD 7E FE       C                  LD      A,(IY-2)
  D802    FE 01          C                  CP      1
  D804    20 05          C                  JR      NZ,K1.LP1
  D806    CD D78E        C                  CALL    K1.RW3              ;BLKx = 1
  D809    18 07          C                  JR      K1.LP2
  D80B    3E 01          C      K1.LP1:     LD      A,1                 ;BLKx > 1
  D80D    06 75          C                  LD      B,75H
  D80F    CD D858        C                  CALL    K1.RW4
  D812    F1             C      K1.LP2:     POP     AF
  D813    B7             C                  OR      A
  D814    28 0C          C                  JR      Z,K1.LP3
  D816    F5             C                  PUSH    AF
  D817    06 71          C                  LD      B,71H
  D819    CD D858        C                  CALL    K1.RW4
  D81C    C1             C                  POP     BC                  ;BLKx := BLKx + N
  D81D    CD D5BE        C                  CALL    K1.BLKP
  D820    10 FB          C                  DJNZ    $-3
  D822    CD D5F6        C      K1.LP3:     CALL    K1.RCZN             ;RCZx := 0
  D825    C9             C                  RET
  D826    16 01          C      K1.GNLM:    LD      D,1                 ;rueckwaerts   <====
  D828    FD 7E FF       C      K1.GNLMN:   LD      A,(IY-1)
  D82B    B7             C                  OR      A
  D82C    20 0E          C                  JR      NZ,K1.LM1
  D82E    FD 7E FE       C                  LD      A,(IY-2)
  D831    3D             C                  DEC     A                   ;A := i-1
  D832    92             C                  SUB     D                   ;A := i-1-N
  D833    CA D77D        C                  JP      Z,K1.GNRW
  D836    F2 D83C        C                  JP      P,K1.LM1
  D839    C3 D77D        C                  JP      K1.GNRW
  D83C    FD 7E FD       C      K1.LM1:     LD      A,(IY-3)            ;RCZx = 0 ?
  D83F    FD B6 FC       C                  OR      (IY-4)
  D842    D5             C                  PUSH    DE
  D843    28 01          C                  JR      Z,K1.LM2
  D845    14             C                  INC     D
  D846    7A             C      K1.LM2:     LD      A,D
  D847    06 75          C                  LD      B,75H
  D849    CD D858        C                  CALL    K1.RW4
  D84C    C1             C                  POP     BC                  ;BLKx := BLKx - N
  D84D    78             C                  LD      A,B
  D84E    B7             C                  OR      A
  D84F    28 05          C                  JR      Z,K1.LM3
  D851    CD D5CC        C                  CALL    K1.BLKM
  D854    10 FB          C                  DJNZ    $-3
  D856    18 CA          C      K1.LM3:     JR      K1.LP3
  D858    B7             C      K1.RW4:     OR      A                   ;Anzahl Bandmarken = 0 ?
  D859    C8             C                  RET     Z
  D85A    DD 70 04       C                  LD      (IX+4),B            ;Kommando
  D85D    DD 36 09 00    C                  LD      (IX+9),0
  D861    DD 77 0A       C                  LD      (IX+10),A           ;Anzahl Bandmarken
  D864    CD D551        C                  CALL    K1.ARMB
  D867    CD D5B3        C                  CALL    K1.ARBT
  D86A    C9             C                  RET
                         C                  TITLE   'K M B G   CLOSE'
                         C      
                         C      ;****************************************************************
                         C      ;*  K M B G    CLOSE - Routine                                  *
                         C      ;****************************************************************
  D86B    DD 36 04 51    C      K1.GNCLS:   LD      (IX+4),51H          ;CMD write BM
  D86F    CD D551        C                  CALL    K1.ARMB
  D872    CD D5B3        C                  CALL    K1.ARBT
  D875    DD 36 04 61    C                  LD      (IX+4),61H          ;CMD write end of volume
  D879    CD D551        C                  CALL    K1.ARMB
  D87C    CD D5B3        C                  CALL    K1.ARBT
  D87F    DD 36 04 15    C                  LD      (IX+4),15H          ;CMD ein block zurueck
  D883    CD D551        C                  CALL    K1.ARMB
  D886    CD D5B3        C                  CALL    K1.ARBT
  D889    DD 36 04 11    C                  LD      (IX+4),11H          ;CMD ein block vor
  D88D    CD D551        C                  CALL    K1.ARMB
  D890    CD D5B3        C                  CALL    K1.ARBT
  D893    CD D5BE        C      K1.RD1:     CALL    K1.BLKP
'K M B G   CLOSE'	MACRO-80 3.44	09-Dec-81	PAGE	1-89


  D896    18 BE          C                  JR      K1.LM3
                         C      
                         C                  TITLE   'K M B G  READ-Routinen'
                         C                  PAGE
'K M B G  READ-Routinen'	MACRO-80 3.44	09-Dec-81	PAGE	1-90


                         C      
                         C      ;****************************************************************
                         C      ;*  K M B G    READ - Routine : einen Block ===> KS.PUFFS       *
                         C      ;****************************************************************
  D898    DD 36 04 02    C      K1.GNRD:    LD      (IX+4),02H          ;CMD  wiedergabe
  D89C    CD D551        C                  CALL    K1.ARMB
  D89F    CD D612        C                  CALL    K1.F17
  D8A2    CD D5B3        C                  CALL    K1.ARBT
  D8A5    CD D60B        C                  CALL    K1.BM
  D8A8    28 E9          C                  JR      Z,K1.RD1
  D8AA    CD D5DA        C                  CALL    K1.RCZP
  D8AD    CD F659        C      K1.PUFT:    CALL    S0.KRZU             ;Kass.puffer V1.1 aktivieren
  D8B0    CD D5FE        C                  CALL    K1.LHLBC            ;Kass.puffer V1.1 ===> V2.1
  D8B3    11 B014        C                  LD      DE,KS.PUFFS+1
  D8B6    DD 72 08       C                  LD      (IX+8),D
  D8B9    DD 73 07       C                  LD      (IX+7),E
  D8BC    ED B0          C                  LDIR
  D8BE    CD B2D4        C                  CALL    S2.STACK            ;Kass.puffer V1.1 entaktivieren
  D8C1    C9             C                  RET
                         C      
                         C      ;****************************************************************
                         C      ;*  K M B G    READ - Routine :  Speicherbereich fuellen        *
                         C      ;****************************************************************
  D8C2    2A B126        C      K1.GNRDR:   LD      HL,(K2.TXANF)
  D8C5    22 B124        C                  LD      (K2.TXOP),HL
                         C      
  D8C8    2A B128        C      K1.GNRZ:    LD      HL,(K2.TXEND)
  D8CB    ED 4B B124     C                  LD      BC,(K2.TXOP)
  D8CF    B7             C                  OR      A
  D8D0    ED 42          C                  SBC     HL,BC
  D8D2    28 2D          C                  JR      Z,K1.GNRZE
  D8D4    FA D901        C                  JP      M,K1.GNRZE
  D8D7    DD CB FF 5E    C                  BIT     3,(IX-1)            ;Verarbeitungsbit  NL/SL  ?
  D8DB    20 05          C                  JR      NZ,$+7
  D8DD    01 0100        C                  LD      BC,256              ;no       label
  D8E0    18 03          C                  JR      $+5
  D8E2    01 0080        C                  LD      BC,128              ;standard label
  D8E5    ED 42          C                  SBC     HL,BC
  D8E7    FA D901        C                  JP      M,K1.GNRZE
                         C      
  D8EA    CD D898        C                  CALL    K1.GNRD
                         C      
  D8ED    CD D60B        C                  CALL    K1.BM
  D8F0    28 0F          C                  JR      Z,K1.GNRZE
  D8F2    CD D5FE        C                  CALL    K1.LHLBC
  D8F5    ED 5B B124     C                  LD      DE,(K2.TXOP)
  D8F9    ED B0          C                  LDIR
  D8FB    ED 53 B124     C                  LD      (K2.TXOP),DE
  D8FF    18 C7          C                  JR      K1.GNRZ
                         C      
  D901    2A B124        C      K1.GNRZE:   LD      HL,(K2.TXOP)
  D904    22 B128        C                  LD      (K2.TXEND),HL
  D907    C9             C                  RET
                         C      
                         C                  TITLE   'K M B G  WRITE-Routinen'
                         C                  PAGE
'K M B G  WRITE-Routinen'	MACRO-80 3.44	09-Dec-81	PAGE	1-91


                         C      
                         C      ;****************************************************************
                         C      ;*  K M B G    WRITE - Routine :  einen Block schreiben         *
                         C      ;****************************************************************
  D908    CD D5FE        C      K1.GNWR:    CALL    K1.LHLBC            ;Ausgabeblock ==> KS.PUFFS von V2
  D90B    11 B014        C                  LD      DE,KS.PUFFS+1
  D90E    DD 72 08       C                  LD      (IX+8),D
  D911    DD 73 07       C                  LD      (IX+7),E
  D914    ED B0          C                  LDIR
  D916    E5             C                  PUSH    HL
  D917    DD 36 04 00    C                  LD      (IX+4),00H          ;CMD write record mit RAW
  D91B    CD D551        C                  CALL    K1.ARMB
  D91E    CD D5B3        C                  CALL    K1.ARBT
  D921    CD D5DA        C                  CALL    K1.RCZP
  D924    E1             C                  POP     HL
  D925    DD 74 08       C                  LD      (IX+8),H
  D928    DD 75 07       C                  LD      (IX+7),L
  D92B    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*  K M B G    WRITE - Routine :   einen Block zurueckschreiben *
                         C      ;****************************************************************
  D92C    E5             C      K1.GNRWR:   PUSH    HL                  ;Pufferadresse
  D92D    C5             C                  PUSH    BC                  ;Pufferlaenge
  D92E    DD 36 04 02    C                  LD      (IX+4),2            ;CMD  wiedergabe
  D932    CD D551        C                  CALL    K1.ARMB
  D935    CD D612        C                  CALL    K1.F17
  D938    CD D5B3        C                  CALL    K1.ARBT
  D93B    CD D5DA        C                  CALL    K1.RCZP
  D93E    E1             C                  POP     HL                  ;neue Blocklaenge
  D93F    E5             C                  PUSH    HL
  D940    DD 46 09       C                  LD      B,(IX+9)            ;alte Blocklaenge
  D943    DD 4E 0A       C                  LD      C,(IX+10)
  D946    B7             C                  OR      A
  D947    ED 42          C                  SBC     HL,BC               ;alte = neue Blocklaenge ?
  D949    20 29          C                  JR      NZ,K1.GNRW3         ;Z-FF=0 ... Block nicht zur.geschr.
  D94B    DD 36 04 15    C                  LD      (IX+4),15H          ;CMD ein block zurueck
  D94F    CD D551        C                  CALL    K1.ARMB
  D952    CD D5B3        C                  CALL    K1.ARBT
  D955    C1             C                  POP     BC
  D956    E1             C                  POP     HL
  D957    11 B014        C      K1.GNRW2:   LD      DE,KS.PUFFS+1
  D95A    DD 72 08       C                  LD      (IX+8),D
  D95D    DD 73 07       C                  LD      (IX+7),E
  D960    DD 70 09       C                  LD      (IX+9),B
  D963    DD 71 0A       C                  LD      (IX+10),C
  D966    ED B0          C                  LDIR
  D968    DD 36 04 08    C      K1.GNRW1:   LD      (IX+4),8            ;CMD write record ohne RAW
  D96C    CD D551        C                  CALL    K1.ARMB
  D96F    CD D5B3        C                  CALL    K1.ARBT
  D972    AF             C                  XOR     A                   ;Z-FF=1 ... Block zurueckgeschr.
  D973    C9             C                  RET
  D974    C1             C      K1.GNRW3:   POP     BC
  D975    E1             C                  POP     HL
  D976    C9             C                  RET
                         C      
                         C                  PAGE
'K M B G  WRITE-Routinen'	MACRO-80 3.44	09-Dec-81	PAGE	1-92


                         C      
                         C      ;****************************************************************
                         C      ;*  K M B G    WRITE - Routine :  aus Speicherbereich ausgeben  *
                         C      ;****************************************************************
  D977    2A B126        C      K1.GNWRT:   LD      HL,(K2.TXANF)
  D97A    DD 75 07       C                  LD      (IX+7),L            ;Pufferadresse ===> E/A-Tabelle
  D97D    DD 74 08       C                  LD      (IX+8),H
  D980    DD CB FF 5E    C                  BIT     3,(IX-1)            ;Verarbeitungsbit  NL/SL  ?
  D984    20 05          C                  JR      NZ,$+7
  D986    21 0100        C                  LD      HL,256              ;no       label
  D989    18 03          C                  JR      $+5
  D98B    21 0080        C                  LD      HL,128              ;standard label
  D98E    DD 74 09       C                  LD      (IX+9),H            ;Pufferlaenge  ===> E/A-Tabelle
  D991    DD 75 0A       C                  LD      (IX+10),L
                         C      
  D994    2A B128        C      K1.GNZKL:   LD      HL,(K2.TXEND)       ;Endeadresse Text
  D997    DD 56 08       C                  LD      D,(IX+8)            ;operative Anfangsadresse
  D99A    DD 5E 07       C                  LD      E,(IX+7)
  D99D    B7             C                  OR      A
  D99E    ED 52          C                  SBC     HL,DE               ;noch auszugeb. Textlaenge
  D9A0    28 38          C                  JR      Z,K1.WRTEN          ;Ende bei Textlaenge gleich Null
  D9A2    FA D9DA        C                  JP      M,K1.WRTEN
  D9A5    22 B120        C                  LD      (K2.BLZ),HL         ;merken Textlaenge
  D9A8    DD CB FF 5E    C                  BIT     3,(IX-1)            ;Verarbeitungsbit  NL/SL  ?
  D9AC    20 05          C                  JR      NZ,$+7
  D9AE    11 0100        C                  LD      DE,256              ;no       label
  D9B1    18 03          C                  JR      $+5
  D9B3    11 0080        C                  LD      DE,128              ;standard label
  D9B6    B7             C                  OR      A
  D9B7    ED 52          C                  SBC     HL,DE               ;Textlaenge groesser LRECL
  D9B9    F2 D9D5        C                  JP      P,K1.GNTS1
  D9BC    19             C                  ADD     HL,DE               ;reset
  D9BD    11 0020        C                  LD      DE,32
  D9C0    B7             C                  OR      A
  D9C1    ED 52          C                  SBC     HL,DE
  D9C3    F2 D9CB        C                  JP      P,K1.GNTS2          ;Satz groesser 32 Byte
                         C      ; Korrektur fuer Saetze kleiner 32 Byte
  D9C6    3E 20          C                  LD      A,32                ;L-Teil der Textlaenge
  D9C8    32 B120        C                  LD      (K2.BLZ),A
                         C      ; Modifikation Record-Laenge
  D9CB    3A B120        C      K1.GNTS2:   LD      A,(K2.BLZ)
  D9CE    DD 36 09 00    C                  LD      (IX+9),0            ;Ausgabelaenge setzen
  D9D2    DD 77 0A       C                  LD      (IX+10),A
                         C      ; Ausgabe eines Blockes
  D9D5    CD D908        C      K1.GNTS1:   CALL    K1.GNWR
  D9D8    18 BA          C                  JR      K1.GNZKL
                         C      ; Aufrufende
  D9DA    C9             C      K1.WRTEN:   RET
                         C      
                         C                  TITLE   'K M B G  Komplex-Routinen Teil I '
                         C                  PAGE
'K M B G  Komplex-Routinen Teil I '	MACRO-80 3.44	09-Dec-81	PAGE	1-93


                         C      
                         C      ;****************************************************************
                         C      ;*  K M B G      K o m p l e x - R o u t i n e n  Teil I        *
                         C      ;*                zum Aufruf der Kassettengrundroutinen         *
                         C      ;****************************************************************
  D9DB    D9DB           C                  DW      $                   ;K 1 R E   ---   K 2 R E
  D9DD    4B 31 52 45    C                  DB      'K1RE'
  D9E1    CD D62A        C                  CALL    K1.RGL1
  D9E4    18 09          C                  JR      K1.SRV
                         C      
  D9E6    D9E6           C                  DW      $
  D9E8    4B 32 52 45    C                  DB      'K2RE'
  D9EC    CD D63B        C                  CALL    K1.RGL2
  D9EF    CD D745        C      K1.SRV:     CALL    K1.GNRE
  D9F2    18 65          C                  JR      K1.STS
                         C      
                         C      
                         C      
  D9F4    D9F4           C                  DW      $                   ;K 1 R A   ---   K 2 R A
  D9F6    4B 31 52 41    C                  DB      'K1RA'
  D9FA    CD D62A        C                  CALL    K1.RGL1
  D9FD    18 09          C                  JR      K1.UNL
                         C      
  D9FF    D9FF           C                  DW      $
  DA01    4B 32 52 41    C                  DB      'K2RA'
  DA05    CD D63B        C                  CALL    K1.RGL2
  DA08    CD D745        C      K1.UNL:     CALL    K1.GNRE
  DA0B    CD D77D        C                  CALL    K1.GNRW
  DA0E    CD D762        C                  CALL    K1.GNRA
  DA11    18 46          C                  JR      K1.STS
                         C      
                         C      
                         C      
  DA13    DA13           C                  DW      $                   ;K 1 R W   ---   K 2 R W
  DA15    4B 31 52 57    C                  DB      'K1RW'
  DA19    CD D62A        C                  CALL    K1.RGL1
  DA1C    18 09          C                  JR      K1.RV1
                         C      
  DA1E    DA1E           C                  DW      $
  DA20    4B 32 52 57    C                  DB      'K2RW'
  DA24    CD D63B        C                  CALL    K1.RGL2
  DA27    CD D77D        C      K1.RV1:     CALL    K1.GNRW
  DA2A    18 2D          C                  JR      K1.STS
                         C      
                         C                  PAGE
'K M B G  Komplex-Routinen Teil I '	MACRO-80 3.44	09-Dec-81	PAGE	1-94


                         C      
  DA2C    DA2C           C                  DW      $                   ;K 1 C L   ---   K 2 C L
  DA2E    4B 31 43 4C    C                  DB      'K1CL'
  DA32    CD D62A        C                  CALL    K1.RGL1
  DA35    18 09          C                  JR      K1.CLS
                         C      
  DA37    DA37           C                  DW      $
  DA39    4B 32 43 4C    C                  DB      'K2CL'
  DA3D    CD D63B        C                  CALL    K1.RGL2
  DA40    CD D86B        C      K1.CLS:     CALL    K1.GNCLS
  DA43    18 14          C                  JR      K1.STS
                         C      
                         C      
                         C      
  DA45    DA45           C                  DW      $                   ;K 1 S T   ---   K 2 S T
  DA47    4B 31 53 54    C                  DB      'K1ST'
  DA4B    CD D62A        C                  CALL    K1.RGL1
  DA4E    18 09          C                  JR      K1.STS
                         C      
  DA50    DA50           C                  DW      $
  DA52    4B 32 53 54    C                  DB      'K2ST'
  DA56    CD D63B        C                  CALL    K1.RGL2
  DA59    CD D6EE        C      K1.STS:     CALL    K1.GNSTS
  DA5C    E1             C                  POP     HL                  ;Ruecksprung zum System
  DA5D    E1             C                  POP     HL
  DA5E    C9             C                  RET
                         C      
                         C      
                         C      
  DA5F    DA5F           C                  DW      $                   ;K 1 R +   ---   K 2 R +
  DA61    4B 31 52 2B    C                  DB      'K1R+'
  DA65    CD D62A        C                  CALL    K1.RGL1
  DA68    18 09          C                  JR      K1.RP
                         C      
  DA6A    DA6A           C                  DW      $
  DA6C    4B 32 52 2B    C                  DB      'K2R+'
  DA70    CD D63B        C                  CALL    K1.RGL2
  DA73    CD D7A2        C      K1.RP:      CALL    K1.GNRP
  DA76    18 E1          C                  JR      K1.STS
                         C      
                         C      
                         C      
  DA78    DA78           C                  DW      $                   ;K 1 R -   ---   K 2 R -
  DA7A    4B 31 52 2D    C                  DB      'K1R-'
  DA7E    CD D62A        C                  CALL    K1.RGL1
  DA81    18 09          C                  JR      K1.RM
                         C      
  DA83    DA83           C                  DW      $
  DA85    4B 32 52 2D    C                  DB      'K2R-'
  DA89    CD D63B        C                  CALL    K1.RGL2
  DA8C    CD D7BD        C      K1.RM:      CALL    K1.GNRM
  DA8F    18 C8          C                  JR      K1.STS
                         C      
                         C                  PAGE
'K M B G  Komplex-Routinen Teil I '	MACRO-80 3.44	09-Dec-81	PAGE	1-95


                         C      
  DA91    DA91           C                  DW      $                   ;K 1 L +   ---   K 2 L +
  DA93    4B 31 4C 2B    C                  DB      'K1L+'
  DA97    CD D62A        C                  CALL    K1.RGL1
  DA9A    18 09          C                  JR      K1.LP
                         C      
  DA9C    DA9C           C                  DW      $
  DA9E    4B 32 4C 2B    C                  DB      'K2L+'
  DAA2    CD D63B        C                  CALL    K1.RGL2
  DAA5    CD D7EE        C      K1.LP:      CALL    K1.GNLP
  DAA8    18 AF          C                  JR      K1.STS
                         C      
                         C      
                         C      
  DAAA    DAAA           C                  DW      $                   ;K 1 L -   ---   K 2 L -
  DAAC    4B 31 4C 2D    C                  DB      'K1L-'
  DAB0    CD D62A        C                  CALL    K1.RGL1
  DAB3    18 09          C                  JR      K1.LM
                         C      
  DAB5    DAB5           C                  DW      $
  DAB7    4B 32 4C 2D    C                  DB      'K2L-'
  DABB    CD D63B        C                  CALL    K1.RGL2
  DABE    CD D826        C      K1.LM:      CALL    K1.GNLM
  DAC1    18 96          C      K1.STS1:    JR      K1.STS
                         C      
                         C      
                         C      
  DAC3    DAC3           C                  DW      $                   ;K 1 Y     ---   K 2 Y
  DAC5    4B 31 59 20    C                  DB      'K1Y '
  DAC9    CD D62A        C                  CALL    K1.RGL1
  DACC    18 09          C                  JR      K1.WR1
                         C      
  DACE    DACE           C                  DW      $
  DAD0    4B 32 59 20    C                  DB      'K2Y '
  DAD4    CD D63B        C                  CALL    K1.RGL2
  DAD7    2A B24F        C      K1.WR1:     LD      HL,(S2.TPA)
  DADA    22 B126        C                  LD      (K2.TXANF),HL
  DADD    2A B257        C                  LD      HL,(S2.END)
  DAE0    22 B128        C                  LD      (K2.TXEND),HL
  DAE3    CD D977        C                  CALL    K1.GNWRT
  DAE6    18 D9          C                  JR      K1.STS1
                         C      
                         C                  PAGE
'K M B G  Komplex-Routinen Teil I '	MACRO-80 3.44	09-Dec-81	PAGE	1-96


                         C      
  DAE8    DAE8           C                  DW      $                   ;K 1 X A   ---   K 2 X A
  DAEA    4B 31 58 41    C                  DB      'K1XA'
  DAEE    CD D62A        C                  CALL    K1.RGL1
  DAF1    18 09          C                  JR      K1.XA
                         C      
  DAF3    DAF3           C                  DW      $
  DAF5    4B 32 58 41    C                  DB      'K2XA'
  DAF9    CD D63B        C                  CALL    K1.RGL2
  DAFC    2A B24F        C      K1.XA:      LD      HL,(S2.TPA)
  DAFF    22 B126        C      K1.XA1:     LD      (K2.TXANF),HL
  DB02    2A B251        C                  LD      HL,(S2.TPE)
  DB05    22 B128        C                  LD      (K2.TXEND),HL
  DB08    CD D8C2        C                  CALL    K1.GNRDR
  DB0B    2A B128        C                  LD      HL,(K2.TXEND)
  DB0E    22 B257        C                  LD      (S2.END),HL
  DB11    18 AE          C                  JR      K1.STS1
                         C      
                         C      
                         C      
  DB13    DB13           C                  DW      $                   ;K 1 X E   ---   K 2 X E
  DB15    4B 31 58 45    C                  DB      'K1XE'
  DB19    CD D62A        C                  CALL    K1.RGL1
  DB1C    18 09          C                  JR      K1.XE
                         C      
  DB1E    DB1E           C                  DW      $
  DB20    4B 32 58 45    C                  DB      'K2XE'
  DB24    CD D63B        C                  CALL    K1.RGL2
  DB27    2A B257        C      K1.XE:      LD      HL,(S2.END)
  DB2A    23             C                  INC     HL
  DB2B    18 D2          C                  JR      K1.XA1
                         C      
                         C                  TITLE   'K M B G  Komplex-Routinen Teil II'
                         C                  PAGE
'K M B G  Komplex-Routinen Teil II'	MACRO-80 3.44	09-Dec-81	PAGE	1-97


                         C      
                         C      ;****************************************************************
                         C      ;*  K M B G      K o m p l e x - R o u t i n e n   Teil II      *
                         C      ;****************************************************************
                         C      
                         C      ;****************************************************************
                         C      ;*               E i n g a b e - P u f f e r    fuellen         *
                         C      ;****************************************************************
  DB2D    21 B7E0        C      K1.EIN:     LD      HL,S0.PFFI          ;Eingabeparameter:
  DB30    E5             C                  PUSH    HL                  ; BC  ...  zu belegender Puffer
  DB31    E5             C                  PUSH    HL
  DB32    22 B126        C                  LD      (K2.TXANF),HL
  DB35    22 B259        C                  LD      (S2.POIE),HL
  DB38    09             C                  ADD     HL,BC
  DB39    22 B128        C                  LD      (K2.TXEND),HL
  DB3C    E1             C                  POP     HL                  ;Puffer loeschen
  DB3D    D1             C                  POP     DE
  DB3E    CD DB85        C                  CALL    K1.FU
  DB41    CD D8C2        C                  CALL    K1.GNRDR            ;Puffer fuellen
  DB44    CD D6EE        C                  CALL    K1.GNSTS
  DB47    C9             C                  RET
                         C      
  DB48    CD D898        C      K1.EINP:    CALL    K1.GNRD             ;einen Block einlesen in den Eingabepuffer
  DB4B    21 B7E0        C      K1.EINP1:   LD      HL,S0.PFFI
  DB4E    E5             C                  PUSH    HL
  DB4F    E5             C                  PUSH    HL
  DB50    D1             C                  POP     DE
  DB51    CD DB85        C                  CALL    K1.FU
  DB54    CD D5FE        C                  CALL    K1.LHLBC
  DB57    D1             C                  POP     DE
  DB58    ED 53 B259     C                  LD      (S2.POIE),DE
  DB5C    78             C                  LD      A,B
  DB5D    B1             C                  OR      C
  DB5E    28 02          C                  JR      Z,K1.EINP2
  DB60    ED B0          C                  LDIR
  DB62    CD D6EE        C      K1.EINP2:   CALL    K1.GNSTS
  DB65    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*               A u s g a b e - P u f f e r   leeren           *
                         C      ;****************************************************************
  DB66    2A B25B        C      K1.AUS:     LD      HL,(S2.POIA)
  DB69    22 B128        C                  LD      (K2.TXEND),HL
  DB6C    21 BBF0        C                  LD      HL,S0.PFFA
  DB6F    C5             C                  PUSH    BC
  DB70    E5             C                  PUSH    HL
  DB71    E5             C                  PUSH    HL
  DB72    22 B126        C                  LD      (K2.TXANF),HL
  DB75    22 B25B        C                  LD      (S2.POIA),HL
  DB78    CD D977        C                  CALL    K1.GNWRT
  DB7B    CD D6EE        C                  CALL    K1.GNSTS
  DB7E    E1             C                  POP     HL
  DB7F    D1             C                  POP     DE
  DB80    CD DB85        C                  CALL    K1.FU
  DB83    C1             C                  POP     BC
  DB84    C9             C                  RET
                         C      
  DB85    13             C      K1.FU:      INC     DE
  DB86    01 0400        C                  LD      BC,400H
  DB89    36 0D          C                  LD      (HL),00DH
  DB8B    ED B0          C                  LDIR
  DB8D    C9             C                  RET
                         C      
                         C                  PAGE
'K M B G  Komplex-Routinen Teil II'	MACRO-80 3.44	09-Dec-81	PAGE	1-98


                         C      
                         C      ;****************************************************************
                         C      ;*               E i n g a b e z e i c h e n  ===>   A          *
                         C      ;****************************************************************
  DB8E    D5             C      K1.LESV:    PUSH    DE
  DB8F    E5             C                  PUSH    HL
  DB90    2A B259        C                  LD      HL,(S2.POIE)
  DB93    7E             C                  LD      A,(HL)
  DB94    23             C                  INC     HL
  DB95    22 B259        C                  LD      (S2.POIE),HL
  DB98    11 BBE0        C                  LD      DE,S0.PFFI+400H
  DB9B    B7             C                  OR      A
  DB9C    ED 52          C                  SBC     HL,DE
  DB9E    C5             C                  PUSH    BC
  DB9F    F5             C                  PUSH    AF
  DBA0    01 0400        C                  LD      BC,400H
  DBA3    CC DB2D        C                  CALL    Z,K1.EIN
  DBA6    F1             C                  POP     AF
  DBA7    C1             C                  POP     BC
  DBA8    E1             C                  POP     HL
  DBA9    D1             C                  POP     DE
  DBAA    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*               Zeichen im Register A ausgeben                 *
                         C      ;****************************************************************
  DBAB    D5             C      K1.SCHR:    PUSH    DE
  DBAC    E5             C                  PUSH    HL
  DBAD    2A B25B        C                  LD      HL,(S2.POIA)
  DBB0    77             C                  LD      (HL),A
  DBB1    23             C                  INC     HL
  DBB2    22 B25B        C                  LD      (S2.POIA),HL
  DBB5    11 BFF0        C                  LD      DE,S0.PFFA+400H
  DBB8    B7             C                  OR      A
  DBB9    ED 52          C                  SBC     HL,DE
  DBBB    CC DB66        C                  CALL    Z,K1.AUS
  DBBE    E1             C                  POP     HL
  DBBF    D1             C                  POP     DE
  DBC0    C9             C                  RET
                         C      
                         C                  PAGE
'K M B G  Komplex-Routinen Teil II'	MACRO-80 3.44	09-Dec-81	PAGE	1-99


                         C      
                         C      ;****************************************************************
                         C      ;*               Zugriff auf  M R E S - Katalog                 *
                         C      ;****************************************************************
  DBC1    CD D745        C      K1.MRCAT:   CALL    K1.GNRE
  DBC4    CD D77D        C                  CALL    K1.GNRW
  DBC7    16 02          C                  LD      D,2                 ;auf Verzeichnisbloecke pos.
  DBC9    CD D7F0        C                  CALL    K1.GNLPN
  DBCC    CD D898        C                  CALL    K1.GNRD             ;ersten zwei Verz.eintr. einlesen
  DBCF    CD D898        C                  CALL    K1.GNRD
  DBD2    3A B015        C                  LD      A,(KS.PUFFS+2)      ;naechste freie Datei
  DBD5    F5             C                  PUSH    AF
  DBD6    3A B017        C                  LD      A,(KS.PUFFS+4)      ;Anzahl Dateien
  DBD9    3D             C                  DEC     A
  DBDA    28 30          C                  JR      Z,K1.MRC5
  DBDC    47             C                  LD      B,A
  DBDD    C5             C      K1.MRC1:    PUSH    BC
  DBDE    DD E5          C                  PUSH    IX
  DBE0    CD D898        C                  CALL    K1.GNRD             ;einen       Verz.eintr. einlesen
  DBE3    21 B014        C                  LD      HL,KS.PUFFS+1
  DBE6    E5             C                  PUSH    HL
  DBE7    DD E1          C                  POP     IX
  DBE9    FD 7E 06       C                  LD      A,(IY+6)            ;Dateityp
  DBEC    DD BE 06       C                  CP      (IX+6)
  DBEF    20 16          C                  JR      NZ,K1.MRC3
  DBF1    FD 7E 07       C                  LD      A,(IY+7)            ;Dateiattribut
  DBF4    FE 20          C                  CP      ' '
  DBF6    28 05          C                  JR      Z,K1.MRC2
  DBF8    DD BE 07       C                  CP      (IX+7)
  DBFB    20 0A          C                  JR      NZ,K1.MRC3
  DBFD    FD E5          C      K1.MRC2:    PUSH    IY                  ;Dateiname
  DBFF    D1             C                  POP     DE
  DC00    06 06          C                  LD      B,6
  DC02    CD C4B6        C                  CALL    S1.VERGL
  DC05    28 0B          C                  JR      Z,K1.MRC4
  DC07    DD E1          C      K1.MRC3:    POP     IX
  DC09    C1             C                  POP     BC
  DC0A    10 D1          C                  DJNZ    K1.MRC1
  DC0C    CD D6EE        C      K1.MRC5:    CALL    K1.GNSTS
  DC0F    D1             C                  POP     DE
  DC10    37             C                  SCF                         ;CY=1  keine Datei vorhanden
  DC11    C9             C                  RET
  DC12    DD 56 17       C      K1.MRC4:    LD      D,(IX+17H)
  DC15    DD E1          C                  POP     IX
  DC17    D5             C                  PUSH    DE
  DC18    CD D6EE        C                  CALL    K1.GNSTS
  DC1B    D1             C                  POP     DE
  DC1C    C1             C                  POP     BC
  DC1D    C1             C                  POP     BC
  DC1E    37             C                  SCF                         ;CY=0        Datei vorhanden
  DC1F    3F             C                  CCF
  DC20    C9             C                  RET
                         C      
                         C                  PAGE
'K M B G  Komplex-Routinen Teil II'	MACRO-80 3.44	09-Dec-81	PAGE	1-100


                         C      
                         C      ;****************************************************************
                         C      ;*          M R E S  Eingabedatei eroeffnen                     *
                         C      ;****************************************************************
  DC21    CD DBC1        C      K1.MREPO:   CALL    K1.MRCAT
  DC24    30 0D          C                  JR      NC,K1.MRPO4
  DC26    CD D77D        C                  CALL    K1.GNRW             ;Datei nicht im Verzeichnis
  DC29    CD D762        C                  CALL    K1.GNRA
  DC2C    CD D6EE        C                  CALL    K1.GNSTS
  DC2F    3E 01          C                  LD      A,1
  DC31    B7             C                  OR      A                   ;Z-FF = 0
  DC32    C9             C                  RET
                         C      
  DC33    D5             C      K1.MRPO4:   PUSH    DE                  ;Dateifolgenummer
  DC34    3E 02          C                  LD      A,2
  DC36    82             C                  ADD     A,D
  DC37    F5             C                  PUSH    AF
  DC38    CD D77D        C                  CALL    K1.GNRW
  DC3B    D1             C                  POP     DE
  DC3C    CD D7F0        C                  CALL    K1.GNLPN
  DC3F    CD D898        C                  CALL    K1.GNRD             ;Verzeichnissatz der Datei einlesen
  DC42    21 B014        C                  LD      HL,KS.PUFFS+1
  DC45    F1             C                  POP     AF
  DC46    BE             C                  CP      (HL)
  DC47    28 0A          C                  JR      Z,K1.MRPO5
                         C      
  DC49    CD D77D        C      K1.MRPO3:   CALL    K1.GNRW             ;Datei nicht richtig pos.
  DC4C    CD D762        C                  CALL    K1.GNRA
  DC4F    3E 02          C                  LD      A,2
  DC51    B7             C                  OR      A                   ;Z-FF = 0
  DC52    C9             C                  RET
                         C      
  DC53    DD CB FF CE    C      K1.MRPO5:   SET     1,(IX-1)            ;OPEN bit          setzen
  DC57    DD CB FF DE    C                  SET     3,(IX-1)            ;Verarbeitungsbit  setzen
  DC5B    01 0400        C                  LD      BC,400H             ;Eingabepuffer fuellen
  DC5E    CD DB2D        C                  CALL    K1.EIN
  DC61    AF             C                  XOR     A                   ;Z-FF = 1
  DC62    C9             C                  RET
                         C      
                         C                  PAGE
'K M B G  Komplex-Routinen Teil II'	MACRO-80 3.44	09-Dec-81	PAGE	1-101


                         C      
                         C      ;****************************************************************
                         C      ;*               M R E S  Ausgabedatei eroeffnen                *
                         C      ;****************************************************************
  DC63    CD DBC1        C      K1.MRAPO:   CALL    K1.MRCAT
  DC66    30 32          C                  JR      NC,K1.MRAP2
                         C      
  DC68    D5             C      K1.MRAP4:   PUSH    DE                  ;(D) ... zu positionierende Datei
  DC69    3E 02          C                  LD      A,2
  DC6B    82             C                  ADD     A,D
  DC6C    F5             C                  PUSH    AF
  DC6D    CD D77D        C                  CALL    K1.GNRW
  DC70    D1             C                  POP     DE
  DC71    CD D7F0        C                  CALL    K1.GNLPN
  DC74    CD D898        C                  CALL    K1.GNRD
  DC77    21 B014        C                  LD      HL,KS.PUFFS+1
  DC7A    F1             C                  POP     AF
  DC7B    BE             C                  CP      (HL)
  DC7C    20 CB          C                  JR      NZ,K1.MRPO3         ;Datei nicht richtig pos.
  DC7E    FD 77 17       C                  LD      (IY+17H),A          ;Dateinummer
  DC81    21 BBF0        C                  LD      HL,S0.PFFA          ;Ausgabe - Pointer setzen
  DC84    22 B25B        C                  LD      (S2.POIA),HL
  DC87    E5             C                  PUSH    HL
  DC88    D1             C                  POP     DE
  DC89    CD DB85        C                  CALL    K1.FU
  DC8C    DD CB FF CE    C      K1.MRAP1:   SET     1,(IX-1)            ;OPEN bit          setzen
  DC90    DD CB FF D6    C                  SET     2,(IX-1)            ;Richtungsbit      setzen
  DC94    DD CB FF DE    C                  SET     3,(IX-1)            ;Verarbeitungsbit  setzen
  DC98    AF             C                  XOR     A                   ;Z-FF = 1
  DC99    C9             C                  RET
                         C      
  DC9A    ED 53 B26C     C      K1.MRAP2:   LD      (S2.RBBR),DE        ;Dateiname schon vergeben
  DC9E    21 E3C8        C                  LD      HL,LO.TXT11
  DCA1    11 DCAE        C                  LD      DE,K1.MRAP3
  DCA4    01 DCB6        C                  LD      BC,K1.MRAP5
  DCA7    ED 73 B24D     C                  LD      (TS.STACK),SP
  DCAB    C3 C4F7        C                  JP      S1.FEHRR
                         C      
  DCAE    3A B26D        C      K1.MRAP3:   LD      A,(S2.RBBR+1)       ;POS QUIT
  DCB1    57             C                  LD      D,A
  DCB2    E1             C                  POP     HL
  DCB3    E1             C                  POP     HL
  DCB4    18 B2          C                  JR      K1.MRAP4
                         C      
  DCB6    CD D77D        C      K1.MRAP5:   CALL    K1.GNRW             ;NEG QUIT
  DCB9    CD D762        C                  CALL    K1.GNRA
  DCBC    3E 03          C                  LD      A,3
  DCBE    B7             C                  OR      A                   ;Z-FF = 0
  DCBF    C9             C                  RET
                         C      
                         C                  PAGE
'K M B G  Komplex-Routinen Teil II'	MACRO-80 3.44	09-Dec-81	PAGE	1-102


                         C      
                         C      ;****************************************************************
                         C      ;*               M R E S  Ausgabedatei abschliessen und         *
                         C      ;*                        Verzeichniseintrag realisieren        *
                         C      ;****************************************************************
  DCC0    DD 36 07 F0    C      K1.MRCLS:   LD      (IX+7),LOW(S0.PFFA)   ;Pufferadresse
  DCC4    DD 36 08 BB    C                  LD      (IX+8),HIGH(S0.PFFA)
  DCC8    DD 36 09 00    C                  LD      (IX+9),0            ;Blocklaenge eintragen
  DCCC    DD 36 0A 80    C                  LD      (IX+10),80H
  DCD0    CD D908        C      K1.MRCL1:   CALL    K1.GNWR
  DCD3    2A B25B        C                  LD      HL,(S2.POIA)
  DCD6    DD 56 08       C                  LD      D,(IX+8)
  DCD9    DD 5E 07       C                  LD      E,(IX+7)
  DCDC    B7             C                  OR      A
  DCDD    ED 52          C                  SBC     HL,DE
  DCDF    28 03          C                  JR      Z,K1.MRCL2
  DCE1    F2 DCD0        C                  JP      P,K1.MRCL1
                         C      
  DCE4    FD 66 FD       C      K1.MRCL2:   LD      H,(IY-3)            ;Satzanzahl im Verzeichnisblock merken
  DCE7    FD 6E FC       C                  LD      L,(IY-4)
  DCEA    2B             C                  DEC     HL
  DCEB    FD 75 19       C                  LD      (IY+25),L
  DCEE    FD 74 1A       C                  LD      (IY+26),H
  DCF1    CD D86B        C                  CALL    K1.GNCLS            ;Bandmarke schreiben
                         C      
  DCF4    21 B014        C                  LD      HL,KS.PUFFS+1       ;1.Satz der naechsten Datei aufb.
  DCF7    DD 74 08       C                  LD      (IX+8),H            ;Ausgabeadresse
  DCFA    DD 75 07       C                  LD      (IX+7),L
  DCFD    DD 36 0A 20    C                  LD      (IX+10),32          ;Ausgabelaenge
  DD01    11 B015        C                  LD      DE,KS.PUFFS+2
  DD04    01 001F        C                  LD      BC,31
  DD07    36 00          C                  LD      (HL),0
  DD09    ED B0          C                  LDIR
  DD0B    FD 7E 17       C                  LD      A,(IY+17H)          ;Dateinummer
  DD0E    3C             C                  INC     A
  DD0F    32 B014        C                  LD      (KS.PUFFS+1),A
  DD12    CD D908        C                  CALL    K1.GNWR                ;Verz.satz ausgeben
  DD15    CD D6EE        C                  CALL    K1.GNSTS
                         C      
                         C                  PAGE
'K M B G  Komplex-Routinen Teil II'	MACRO-80 3.44	09-Dec-81	PAGE	1-103


                         C      
  DD18    CD D77D        C                  CALL    K1.GNRW             ;Kassette auf Verzeichnis pos.
  DD1B    16 02          C                  LD      D,2
  DD1D    CD D7F0        C                  CALL    K1.GNLPN
  DD20    CD D898        C                  CALL    K1.GNRD             ;Ausgleich-Satz
  DD23    CD D898        C                  CALL    K1.GNRD             ;DS       -Satz
  DD26    3A B017        C                  LD      A,(KS.PUFFS+4)      ;auf Verzeichnissatz pos.
  DD29    47             C                  LD      B,A
  DD2A    3E 01          C                  LD      A,1
  DD2C    3C             C      K1.MRCL3:   INC     A
  DD2D    F5             C                  PUSH    AF
  DD2E    C5             C                  PUSH    BC
  DD2F    CD D898        C                  CALL    K1.GNRD
  DD32    3A B02B        C                  LD      A,(KS.PUFFS+18H)
  DD35    FD BE 17       C                  CP      (IY+17H)
  DD38    C1             C                  POP     BC
  DD39    28 04          C                  JR      Z,K1.MRCL4
  DD3B    F1             C                  POP     AF
  DD3C    10 EE          C                  DJNZ    K1.MRCL3
  DD3E    F5             C                  PUSH    AF
  DD3F    CD D7BD        C      K1.MRCL4:   CALL    K1.GNRM
  DD42    FD E5          C                  PUSH    IY                  ;aktuelles Datum in  KSK  eintragen
  DD44    E1             C                  POP     HL
  DD45    01 000E        C                  LD      BC,14
  DD48    09             C                  ADD     HL,BC
  DD49    EB             C                  EX      DE,HL
  DD4A    21 0004        C                  LD      HL,S3.DATUM-S3.SEAT
  DD4D    01 A800        C                  LD      BC,S0.DEAT
  DD50    09             C                  ADD     HL,BC
  DD51    01 0006        C                  LD      BC,6
  DD54    ED B0          C                  LDIR
  DD56    FD 36 14 32    C                  LD      (IY+20),S0.V1       ;System-Signum eintragen
  DD5A    FD 36 15 31    C                  LD      (IY+21),S0.V2
  DD5E    FD 36 16 33    C                  LD      (IY+22),S0.V3
  DD62    FD 36 18 00    C                  LD      (IY+24),0
  DD66    FD E5          C                  PUSH    IY
  DD68    E1             C                  POP     HL
  DD69    01 0020        C                  LD      BC,32
  DD6C    CD D92C        C                  CALL    K1.GNRWR
  DD6F    CD D6EE        C                  CALL    K1.GNSTS
  DD72    CD D77D        C                  CALL    K1.GNRW             ;DS - Satz korrigieren
  DD75    16 02          C                  LD      D,2
  DD77    CD D7F0        C                  CALL    K1.GNLPN
  DD7A    CD D898        C                  CALL    K1.GNRD
  DD7D    CD D898        C                  CALL    K1.GNRD
  DD80    FD 7E 17       C                  LD      A,(IY+17H)          ;naechste freie Datei
  DD83    3C             C                  INC     A
  DD84    32 B015        C                  LD      (KS.PUFFS+2),A
  DD87    F1             C                  POP     AF                  ;Anzahl Verzeichniseintraege
  DD88    32 B017        C                  LD      (KS.PUFFS+4),A
  DD8B    CD D5FE        C                  CALL    K1.LHLBC
  DD8E    11 BBF0        C                  LD      DE,S0.PFFA
  DD91    ED B0          C                  LDIR
  DD93    CD D7BD        C                  CALL    K1.GNRM
  DD96    CD D7BD        C                  CALL    K1.GNRM
  DD99    CD D7A2        C                  CALL    K1.GNRP
  DD9C    21 BBF0        C                  LD      HL,S0.PFFA
  DD9F    01 0020        C                  LD      BC,32
  DDA2    CD D957        C                  CALL    K1.GNRW2
  DDA5    CD D77D        C                  CALL    K1.GNRW
  DDA8    CD D762        C                  CALL    K1.GNRA
  DDAB    C9             C                  RET
                         C                  TITLE   'K M B G  Komplex-Routinen Teil III'
                         C                  PAGE
'K M B G  Komplex-Routinen Teil III'	MACRO-80 3.44	09-Dec-81	PAGE	1-104


                         C      
                         C      ;****************************************************************
                         C      ;*  K M B G      K o m p l e x - R o u t i n e n   Teil III     *
                         C      ;****************************************************************
  DDAC    DDAC           C                  DW      $                   ;X K A 1  n   ---   X K A 2  n
  DDAE    58 4B 41 31    C                  DB      'XKA1'
  DDB2    CD D62A        C                  CALL    K1.RGL1
  DDB5    18 09          C                  JR      K1.M0
                         C      
  DDB7    DDB7           C                  DW      $
  DDB9    58 4B 41 32    C                  DB      'XKA2'
  DDBD    CD D63B        C                  CALL    K1.RGL2
  DDC0    26 07          C      K1.M0:      LD      H,7                 ;SPOL= 8
  DDC2    2E 0A          C                  LD      L,S0.SYSZ-1         ;ZPOL=SYSZ
  DDC4    22 B18A        C                  LD      (MS.ZPOL),HL
  DDC7    21 B13A        C                  LD      HL,K2.ADRK
  DDCA    06 06          C                  LD      B,6
  DDCC    3E 2C          C                  LD      A,44
  DDCE    32 B198        C                  LD      (MS.CMD),A
  DDD1    CD CB16        C                  CALL    MO.MONI
  DDD4    11 B13A        C                  LD      DE,K2.ADRK
  DDD7    CD C592        C                  CALL    S1.IDH
  DDDA    7D             C                  LD      A,L
  DDDB    32 B12C        C                  LD      (K2.PTADR),A
  DDDE    2A B24F        C                  LD      HL,(S2.TPA)
  DDE1    22 B126        C                  LD      (K2.TXANF),HL
  DDE4    2A B251        C                  LD      HL,(S2.TPE)
  DDE7    22 B128        C                  LD      (K2.TXEND),HL
  DDEA    CD D745        C                  CALL    K1.GNRE
  DDED    CD D77D        C                  CALL    K1.GNRW
  DDF0    3A B12C        C                  LD      A,(K2.PTADR)
  DDF3    3D             C                  DEC     A
  DDF4    28 04          C                  JR      Z,K1.M2
  DDF6    57             C                  LD      D,A
  DDF7    CD D7F0        C                  CALL    K1.GNLPN
  DDFA    CD D8C2        C      K1.M2:      CALL    K1.GNRDR
  DDFD    2A B128        C                  LD      HL,(K2.TXEND)
  DE00    22 B257        C                  LD      (S2.END),HL
  DE03    CD D77D        C                  CALL    K1.GNRW
  DE06    CD D762        C                  CALL    K1.GNRA
  DE09    C3 DA59        C                  JP      K1.STS
                         C      
                         C                  PAGE
'K M B G  Komplex-Routinen Teil III'	MACRO-80 3.44	09-Dec-81	PAGE	1-105


                         C      
  DE0C    DE0C           C                  DW      $                   ;Y K A 1  n   ---   Y K A 2  n
  DE0E    59 4B 41 31    C                  DB      'YKA1'
  DE12    CD D62A        C                  CALL    K1.RGL1
  DE15    18 09          C                  JR      K1.M3
                         C      
  DE17    DE17           C                  DW      $
  DE19    59 4B 41 32    C                  DB      'YKA2'
  DE1D    CD D63B        C                  CALL    K1.RGL2
  DE20    26 07          C      K1.M3:      LD      H,7                 ;SPOL= 8
  DE22    2E 0A          C                  LD      L,S0.SYSZ-1         ;ZPOL=SYSZ
  DE24    22 B18A        C                  LD      (MS.ZPOL),HL
  DE27    21 B13A        C                  LD      HL,K2.ADRK
  DE2A    06 06          C                  LD      B,6
  DE2C    3E 2C          C                  LD      A,44
  DE2E    32 B198        C                  LD      (MS.CMD),A
  DE31    CD CB16        C                  CALL    MO.MONI
  DE34    11 B13A        C                  LD      DE,K2.ADRK
  DE37    CD C592        C                  CALL    S1.IDH
  DE3A    7D             C                  LD      A,L
  DE3B    32 B12C        C                  LD      (K2.PTADR),A
  DE3E    2A B24F        C                  LD      HL,(S2.TPA)
  DE41    22 B126        C                  LD      (K2.TXANF),HL
  DE44    2A B257        C                  LD      HL,(S2.END)
  DE47    22 B128        C                  LD      (K2.TXEND),HL
  DE4A    CD D745        C                  CALL    K1.GNRE
  DE4D    CD D77D        C                  CALL    K1.GNRW
  DE50    3A B12C        C                  LD      A,(K2.PTADR)
  DE53    3D             C                  DEC     A
  DE54    28 04          C                  JR      Z,K1.M5
  DE56    57             C                  LD      D,A
  DE57    CD D7F0        C                  CALL    K1.GNLPN
  DE5A    CD D977        C      K1.M5:      CALL    K1.GNWRT
  DE5D    CD D86B        C                  CALL    K1.GNCLS
  DE60    CD D77D        C                  CALL    K1.GNRW
  DE63    CD D762        C                  CALL    K1.GNRA
  DE66    C3 DA59        C      K1.M6:      JP      K1.STS
                         C      
                         C                  PAGE
'K M B G  Komplex-Routinen Teil III'	MACRO-80 3.44	09-Dec-81	PAGE	1-106


                         C      
                         C      ;****************************************************************
                         C      ;*               Systemkommandos fuer  MRES - OPEN/CLOSE        *
                         C      ;****************************************************************
  DE69    DE69           C                  DW      $                   ;K 1 M E   ---   K 2 M E
  DE6B    4B 31 4D 45    C                  DB      'K1ME'
  DE6F    CD D62A        C                  CALL    K1.RGL1
  DE72    18 09          C                  JR      K1.ME1
                         C      
  DE74    DE74           C                  DW      $
  DE76    4B 32 4D 45    C                  DB      'K2ME'
  DE7A    CD D63B        C                  CALL    K1.RGL2
  DE7D    CD DC21        C      K1.ME1:     CALL    K1.MREPO
  DE80    18 E4          C      K1.ME2:     JR      K1.M6
                         C      
                         C      
                         C      
  DE82    DE82           C                  DW      $                   ;K 1 M A   ---   K 2 M A
  DE84    4B 31 4D 41    C                  DB      'K1MA'
  DE88    CD D62A        C                  CALL    K1.RGL1
  DE8B    18 09          C                  JR      K1.ME3
                         C      
  DE8D    DE8D           C                  DW      $
  DE8F    4B 32 4D 41    C                  DB      'K2MA'
  DE93    CD D63B        C                  CALL    K1.RGL2
  DE96    CD DC63        C      K1.ME3:     CALL    K1.MRAPO
  DE99    18 E5          C                  JR      K1.ME2
                         C      
                         C      
                         C      
  DE9B    DE9B           C                  DW      $                   ;K 1 M C   ---   K 2 M C
  DE9D    4B 31 4D 43    C                  DB      'K1MC'
  DEA1    CD D62A        C                  CALL    K1.RGL1
  DEA4    18 09          C                  JR      K1.ME4
                         C      
  DEA6    DEA6           C                  DW      $
  DEA8    4B 32 4D 43    C                  DB      'K2MC'
  DEAC    CD D63B        C                  CALL    K1.RGL2
  DEAF    CD DCC0        C      K1.ME4:     CALL    K1.MRCLS
  DEB2    18 CC          C                  JR      K1.ME2
                         C      
                         C                  PAGE
'K M B G  Komplex-Routinen Teil III'	MACRO-80 3.44	09-Dec-81	PAGE	1-107


                         C      
                         C      ;****************************************************************
                         C      ;*  K M B G      T e s t a u f r u f  von   BRKMB               *
                         C      ;****************************************************************
  DEB4    DEB4           C                  DW      $                   ;K M B G
  DEB6    4B 4D 42 47    C                  DB      'KMBG'
  DEBA    DD 21 0013     C                  LD      IX,S3.KS1-S3.SEAT
  DEBE    11 A803        C                  LD      DE,S0.DEAT+3
  DEC1    DD 19          C                  ADD     IX,DE
  DEC3    CD D564        C                  CALL    K1.ARMBM
  DEC6    E1             C                  POP     HL
  DEC7    E1             C                  POP     HL
  DEC8    C9             C                  RET
                         C      
                         C      
                         C      
  DEC9    01             C      K1.ZMIN:    DB      1
  DECA    01             C                  DB      1
  DECB    18             C                  DB      S0.ZANZ
  DECC    50             C                  DB      S0.SPANZ
  DECD    18             C                  DB      S0.ZANZ
  DECE    50             C                  DB      S0.SPANZ
  DECF    A000           C                  DW      S0.BWSA
  DED1    C0             C                  DB      0C0H
  DED2    C0             C                  DB      0C0H
                         C      
                         C      
                         C      
                         C      ;           END
                         C      ;           PN      LO28
                         C                  TITLE   'LOADer / SAVE fuer MRES - Dateien'
                         C                  PAGE
'LOADer / SAVE fuer MRES - Dateien'	MACRO-80 3.44	09-Dec-81	PAGE	1-108


                         C      
                         C      ;****************************************************************
                         C      ;*               absoluter LOADer fuer  M R E S - P   - Dateien *
                         C      ;*               relativer LOADer fuer  M R E S - R/O - Dateien *
                         C      ;*                         SAVE   fuer  M R E S - P   - Dateien *
                         C      ;*  Version      -----------------------------------------------*
                         C      ;*               Programmierer: M. Herbote --- K EAW  ZFT (WFT) *
                         C      ;*  V 2 . 1      -----------------------------------------------*
                         C      ;*               Stand        : 09.November 1984                *
                         C      ;****************************************************************
                         C                  TITLE   'abs. / rel. LOADer'
  DED3    56 32 2E 31    C                  DB      'V2.1/091184'
  DED7    2F 30 39 31    C      
  DEDB    31 38 34       C      
                         C      
  DEDE    DEDE           C                  DW      $
  DEE0    4C 50 31 20    C                  DB      'LP1 '
  DEE4    3E 01          C                  LD      A,1
  DEE6    18 08          C                  JR      LO.LO11
                         C      
  DEE8    DEE8           C                  DW      $
  DEEA    4C 50 32 20    C                  DB      'LP2 '
  DEEE    3E 02          C                  LD      A,2
  DEF0    32 B26C        C      LO.LO11:    LD      (S2.RBBR),A
  DEF3    3E 01          C                  LD      A,1
  DEF5    32 B26D        C                  LD      (S2.RBBR+1),A
  DEF8    CD DF0F        C                  CALL    LO.LOEIN
                         C      
  DEFB    CD C3BF        C      LO.LO1:     CALL    S1.ANZEI            ;Eingabe des Dateinamens
  DEFE    0C             C                  DB      S0.SYSZ+1           ;ZPOS=SYSZ+2
  DEFF    15             C                  DB      21                  ;SPOS=22
  DF00    00             C                  DB      0
  DF01    06             C                  DB      6                   ;Eingabelaenge
  DF02    AA             C                  DB      10101010B           ;TS.SPMER
  DF03    0000           C                  DW      0                   ;NEG QUIT
  DF05    DF26           C                  DW      LO.LO2              ;POS QUIT
  DF07    DF09           C                  DW      LO.EIN              ;EINA
                         C      
  DF09    FE 2C          C      LO.EIN:     CP      ','                 ;Tastenroutine alphanum. Tasten
  DF0B    C8             C                  RET     Z
  DF0C    C3 C328        C                  JP      S1.AEIN
                         C      
  DF0F    CD C3BF        C      LO.LOEIN:   CALL    S1.ANZEI            ;Anzeige: MRES - Eingabedatei:
  DF12    0C             C                  DB      S0.SYSZ+1           ;ZPOS=SYSZ+2
  DF13    00             C                  DB      0                   ;SPOS=1
  DF14    95             C                  DB      21+80H              ;Textlaenge
  DF15    E2B6           C                  DW      LO.TXT1
  DF17    00             C                  DB      0                   ;Eingabelaenge
  DF18    C9             C                  RET
                         C      
  DF19    CD DF0F        C      LO.LOAUS:   CALL    LO.LOEIN
  DF1C    CD C3BF        C                  CALL    S1.ANZEI            ;Anzeige: MRES - Ausgabedatei:
  DF1F    0C             C                  DB      S0.SYSZ+1           ;ZPOS=SYSZ+2
  DF20    07             C                  DB      7                   ;SPOS= 8
  DF21    83             C                  DB      3+80H               ;Textlaenge
  DF22    E353           C                  DW      LO.TXT15
  DF24    00             C                  DB      0                   ;Eingabelaenge
  DF25    C9             C                  RET
                         C      
                         C                  PAGE
'abs. / rel. LOADer'	MACRO-80 3.44	09-Dec-81	PAGE	1-109


                         C      
  DF26    C5             C      LO.LO2:     PUSH    BC
  DF27    E5             C                  PUSH    HL
  DF28    CD E2A7        C                  CALL    LO.RGL
  DF2B    FD E5          C      LO.LO4:     PUSH    IY                  ;Programmname aus BWS uebernehmen
  DF2D    D1             C                  POP     DE
  DF2E    E1             C                  POP     HL
  DF2F    C1             C                  POP     BC
  DF30    ED B0          C                  LDIR
  DF32    EB             C                  EX      DE,HL
  DF33    3A B26D        C                  LD      A,(S2.RBBR+1)       ;Abfrage, ob abs. oder rel. LOAD
  DF36    FE 02          C                  CP      2
  DF38    28 64          C                  JR      Z,LO.LO8
  DF3A    36 50          C                  LD      (HL),'P'            ;Dateityp   in PAR-Bereich eintr.
  DF3C    23             C                  INC     HL
  DF3D    36 20          C                  LD      (HL),' '            ;Dateiattr. in PAR-Bereich eintr.
  DF3F    3A B26D        C                  LD      A,(S2.RBBR+1)       ;Abfrage, ob LOAD oder SAVE
  DF42    FE 03          C                  CP      3
  DF44    CA E073        C                  JP      Z,LO.SAV4
                         C      
  DF47    CD E106        C                  CALL    LO.AL               ;posit. und laden der Datei
                         C      
  DF4A    28 13          C                  JR      Z,LO.LO7
  DF4C    FE 02          C      LO.LO13:    CP      2
  DF4E    28 05          C                  JR      Z,LO.LO5
  DF50    21 E37C        C                  LD      HL,LO.TXT9
  DF53    18 03          C                  JR      LO.LO6
                         C      
  DF55    21 E3A2        C      LO.LO5:     LD      HL,LO.TXT10
  DF58    ED 5B B136     C      LO.LO6:     LD      DE,(K2.FRADR)
  DF5C    C3 C4F4        C                  JP      S1.FEHR
                         C      
  DF5F    D5             C      LO.LO7:     PUSH    DE
  DF60    7A             C                  LD      A,D                 ;Startadresse vorhanden ?
  DF61    B3             C                  OR      E
  DF62    CA C114        C                  JP      Z,S1.SYSTB
                         C      
  DF65    CD C3BF        C      LO.LO14:    CALL    S1.ANZEI            ;Anzeige: Programm starten ?
  DF68    0D             C                  DB      S0.SYSZ+2           ;ZPOS=SYSZ+3
  DF69    00             C                  DB      0                   ;SPOS=1
  DF6A    95             C                  DB      21+80H
  DF6B    E2CB           C                  DW      LO.TXT2
  DF6D    00             C                  DB      0
                         C      
  DF6E    CD D40E        C                  CALL    TA.LOE              ;Tastaturaktivierung
  DF71    E1             C                  POP     HL                  ;POS QUIT
  DF72    22 B223        C                  LD      (TS.TAB4),HL
  DF75    21 C114        C                  LD      HL,S1.SYSTB         ;NEG QUIT
  DF78    22 B21B        C                  LD      (TS.TAB3+4),HL
  DF7B    3E 80          C                  LD      A,10000000B
  DF7D    32 B23F        C                  LD      (TS.SPMER),A
  DF80    C9             C                  RET
                         C      
                         C                  PAGE
'abs. / rel. LOADer'	MACRO-80 3.44	09-Dec-81	PAGE	1-110


                         C      
                         C      ;****************************************************************
                         C      ;*               Eintrittspunkt Relativloader                   *
                         C      ;****************************************************************
  DF81    DF81           C                  DW      $
  DF83    52 4C 44 31    C                  DB      'RLD1'
  DF87    3E 01          C                  LD      A,1
  DF89    32 B26C        C      LO.LO12:    LD      (S2.RBBR),A
  DF8C    3E 02          C                  LD      A,2
  DF8E    32 B26D        C                  LD      (S2.RBBR+1),A
  DF91    C3 DEF8        C                  JP      LO.LO1-3
                         C      
  DF94    DF94           C                  DW      $
  DF96    52 4C 44 32    C                  DB      'RLD2'
  DF9A    3E 02          C                  LD      A,2
  DF9C    18 EB          C                  JR      LO.LO12
                         C      
  DF9E    23             C      LO.LO8:     INC     HL                  ;Dateiattr. in PAR-Bereich eintragen
  DF9F    36 20          C                  LD      (HL),' '
  DFA1    CD C3BF        C                  CALL    S1.ANZEI            ;Anzeige: MRES - Dateityp
  DFA4    0E             C                  DB      S0.SYSZ+3           ;ZPOS=SYSZ+4
  DFA5    00             C                  DB      0                   ;SPOS=1
  DFA6    95             C                  DB      21+80H
  DFA7    E326           C                  DW      LO.TXT7
  DFA9    01             C                  DB      1
  DFAA    A0             C                  DB      10100000B
  DFAB    0000           C                  DW      0
  DFAD    DFBB           C                  DW      LO.LO15
  DFAF    DFB1           C                  DW      LO.EIN2
                         C      
  DFB1    FE 4F          C      LO.EIN2:    CP      'O'
  DFB3    28 03          C                  JR      Z,LO.EIN3
  DFB5    FE 52          C                  CP      'R'
  DFB7    C0             C                  RET     NZ
  DFB8    C3 C328        C      LO.EIN3:    JP      S1.AEIN
                         C      
                         C                  PAGE
'abs. / rel. LOADer'	MACRO-80 3.44	09-Dec-81	PAGE	1-111


                         C      
  DFBB    C5             C      LO.LO15:    PUSH    BC
  DFBC    E5             C                  PUSH    HL
  DFBD    3A B26C        C                  LD      A,(S2.RBBR)         ;Dateityp   in PAR-Bereich eintragen
  DFC0    FE 02          C                  CP      2
  DFC2    28 05          C                  JR      Z,LO.LO18
  DFC4    21 00B0        C                  LD      HL,S3.KSK1-S3.SEAT
  DFC7    18 03          C                  JR      LO.LO19
  DFC9    21 00D4        C      LO.LO18:    LD      HL,S3.KSK2-S3.SEAT
  DFCC    11 A80A        C      LO.LO19:    LD      DE,S0.DEAT+10
  DFCF    19             C                  ADD     HL,DE
  DFD0    EB             C                  EX      DE,HL
  DFD1    E1             C                  POP     HL
  DFD2    C1             C                  POP     BC
  DFD3    ED B0          C                  LDIR
  DFD5    21 E2E0        C                  LD      HL,LO.TXT3          ;Anzeige: Ladeanfangs-Adresse: 0000H
  DFD8    11 DFE1        C                  LD      DE,LO.LO9
  DFDB    06 0F          C                  LD      B,S0.SYSZ+4
  DFDD    CD E21B        C                  CALL    LO.TXT
  DFE0    C9             C                  RET
  DFE1    06 0F          C      LO.LO9:     LD      B,S0.SYSZ+4         ;Ladeanfangsadresse umwandeln
  DFE3    CD E285        C                  CALL    LO.TR1
  DFE6    ED 53 B265     C                  LD      (S2.PRGN),DE
  DFEA    21 E2F6        C                  LD      HL,LO.TXT5          ;Anzeige: Start      -Adresse: 0000H
  DFED    11 DFF6        C                  LD      DE,LO.LO10
  DFF0    06 11          C                  LD      B,S0.SYSZ+6
  DFF2    CD E21B        C                  CALL    LO.TXT
  DFF5    C9             C                  RET
  DFF6    06 11          C      LO.LO10:    LD      B,S0.SYSZ+6         ;Startadresse umwandeln
  DFF8    CD E285        C                  CALL    LO.TR1
  DFFB    ED 53 B267     C                  LD      (S2.PRGN+2),DE
  DFFF    CD E2A7        C                  CALL    LO.RGL
  E002    CD E137        C                  CALL    LO.RL               ;posit. und laden der Datei
  E005    C2 DF4C        C                  JP      NZ,LO.LO13          ;Sprung zur Fehlerbehandlung
  E008    E5             C                  PUSH    HL
  E009    3E 02          C                  LD      A,2
  E00B    32 B198        C                  LD      (MS.CMD),A
  E00E    CD CB16        C                  CALL    MO.MONI
  E011    26 00          C                  LD      H,0                 ;Anzeige: Ladeende   -Adresse: 0000H
  E013    2E 10          C                  LD      L,S0.SYSZ+5
  E015    22 B18C        C                  LD      (MS.ZPOS),HL
  E018    3E 18          C                  LD      A,24
  E01A    32 B198        C                  LD      (MS.CMD),A
  E01D    06 0B          C                  LD      B,11
  E01F    21 E2EB        C                  LD      HL,LO.TXT4
  E022    CD CB16        C                  CALL    MO.MONI
  E025    06 0F          C                  LD      B,15
  E027    21 E317        C                  LD      HL,LO.TXT6
  E02A    CD CB16        C                  CALL    MO.MONI
  E02D    21 B29A        C                  LD      HL,S2.DM1           ;Ladeendeadresse umwandeln
  E030    D1             C                  POP     DE
  E031    7A             C                  LD      A,D
  E032    CD C5FF        C                  CALL    S1.BHKON
  E035    7B             C                  LD      A,E
  E036    CD C5FF        C                  CALL    S1.BHKON
  E039    3E 15          C                  LD      A,21                ;Ladeendeadresse anzeigen
  E03B    32 B18D        C                  LD      (MS.SPOS),A
  E03E    06 04          C                  LD      B,4
  E040    21 B29A        C                  LD      HL,S2.DM1
  E043    CD CB16        C                  CALL    MO.MONI
  E046    2A B267        C                  LD      HL,(S2.PRGN+2)
  E049    E5             C                  PUSH    HL
  E04A    C3 DF65        C                  JP      LO.LO14
                         C      
                         C                  TITLE   'S A V E'
                         C      ;****************************************************************
                         C      ;*                  Eintrittspunkt  S A V E                     *
                         C      ;****************************************************************
  E04D    E04D           C                  DW      $
  E04F    53 41 56 45    C                  DB      'SAVE'
  E053    3E 03          C                  LD      A,3                 ;Merker SAVE
  E055    32 B26D        C                  LD      (S2.RBBR+1),A
  E058    26 07          C                  LD      H,7                 ;ZPOS=SYSZ , SPOS= 8
  E05A    2E 0A          C                  LD      L,S0.SYSZ-1
  E05C    22 B18C        C                  LD      (MS.ZPOS),HL
  E05F    3E 0B          C                  LD      A,11                ;HL:=ZPOS,SPOS
  E061    32 B198        C                  LD      (MS.CMD),A
  E064    CD CB16        C                  CALL    MO.MONI
  E067    7E             C                  LD      A,(HL)              ;Geraetenummer
  E068    E6 0F          C                  AND     00FH
  E06A    32 B26C        C                  LD      (S2.RBBR),A         ;Geraeteadresse
  E06D    CD DF19        C      LO.SAV3:    CALL    LO.LOAUS
'S A V E'	MACRO-80 3.44	09-Dec-81	PAGE	1-112


  E070    C3 DEFB        C                  JP      LO.LO1
                         C      
  E073    06 06          C      LO.SAV4:    LD      B,6                 ;Kommentar eintragen
  E075    23             C                  INC     HL
  E076    36 20          C                  LD      (HL),' '
  E078    10 FB          C                  DJNZ    $-3
  E07A    CD E2A7        C                  CALL    LO.RGL
  E07D    CD DC63        C                  CALL    K1.MRAPO
  E080    28 06          C                  JR      Z,LO.SAV7
  E082    CD D65D        C                  CALL    K1.FL
  E085    C3 C114        C                  JP      S1.SYSTB
                         C      
  E088    21 E301        C      LO.SAV7:    LD      HL,LO.TXT12         ;Anzeige: SAVEanfangs-Adresse: 0000H
  E08B    11 E094        C                  LD      DE,LO.SAV8
  E08E    06 0F          C                  LD      B,S0.SYSZ+4
  E090    CD E21B        C                  CALL    LO.TXT
  E093    C9             C                  RET
                         C      
  E094    06 0F          C      LO.SAV8:    LD      B,S0.SYSZ+4         ;SAVEanfangsadresse umwandeln
  E096    CD E285        C                  CALL    LO.TR1
  E099    ED 53 B265     C                  LD      (S2.PRGN),DE
  E09D    21 E30C        C                  LD      HL,LO.TXT13         ;Anzeige: SAVEende   -Adresse: 0000H
  E0A0    11 E0A9        C                  LD      DE,LO.SAV9
  E0A3    06 10          C                  LD      B,S0.SYSZ+5
  E0A5    CD E21B        C                  CALL    LO.TXT
  E0A8    C9             C                  RET
                         C      
  E0A9    06 10          C      LO.SAV9:    LD      B,S0.SYSZ+5         ;SAVEendeadresse umwandeln
  E0AB    CD E285        C                  CALL    LO.TR1
  E0AE    ED 53 B267     C                  LD      (S2.PRGN+2),DE
  E0B2    CD E2A7        C                  CALL    LO.RGL
  E0B5    CD E1D3        C                  CALL    LO.SAVE
  E0B8    CD C3BF        C                  CALL    S1.ANZEI
  E0BB    11             C                  DB      S0.SYSZ+6
  E0BC    00             C                  DB      0
  E0BD    98             C                  DB      24+80H
  E0BE    E33B           C                  DW      LO.TXT14
  E0C0    01             C                  DB      1
  E0C1    80             C                  DB      10000000B
  E0C2    E0E0           C                  DW      LO.SAV13
  E0C4    E0C8           C                  DW      LO.SAV12
  E0C6    0000           C                  DW      0
                         C      
  E0C8    26 00          C      LO.SAV12:   LD      H,0                 ;weitere Bloecke
  E0CA    2E 0C          C                  LD      L,S0.SYSZ+1
  E0CC    22 B18E        C                  LD      (MS.ZMIN),HL
  E0CF    26 50          C                  LD      H,80
  E0D1    2E 11          C                  LD      L,S0.SYSZ+6
  E0D3    22 B190        C                  LD      (MS.ZMAX),HL
  E0D6    3E 05          C                  LD      A,5
  E0D8    32 B198        C                  LD      (MS.CMD),A
  E0DB    CD CB16        C                  CALL    MO.MONI
  E0DE    18 A8          C                  JR      LO.SAV7
                         C      
  E0E0    21 E2F6        C      LO.SAV13:   LD      HL,LO.TXT5          ;keine weiteren Bloecke
  E0E3    11 E0EC        C                  LD      DE,LO.SAV14
  E0E6    06 12          C                  LD      B,S0.SYSZ+7
  E0E8    CD E21B        C                  CALL    LO.TXT
  E0EB    C9             C                  RET
                         C      
  E0EC    CD E2A7        C      LO.SAV14:   CALL    LO.RGL
  E0EF    06 12          C                  LD      B,S0.SYSZ+7         ;Startadress-Block ausgeben
  E0F1    CD E285        C                  CALL    LO.TR1
  E0F4    AF             C                  XOR     A
  E0F5    CD DBAB        C                  CALL    K1.SCHR
  E0F8    7A             C                  LD      A,D
  E0F9    CD DBAB        C                  CALL    K1.SCHR
  E0FC    7B             C                  LD      A,E
  E0FD    CD DBAB        C                  CALL    K1.SCHR
  E100    CD DCC0        C                  CALL    K1.MRCLS
  E103    C3 C114        C                  JP      S1.SYSTB
                         C      
                         C                  TITLE   'Unterprogramme'
                         C                  PAGE
'Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-113


                         C      
                         C      ;****************************************************************
                         C      ;*               Unterprogramm: absoluter LOAD                  *
                         C      ;*               -----------------------------------------------*
                         C      ;*               Eingabeparameter: K2.MRPAR ... Dateiname       *
                         C      ;*                                          ... Dateityp    P   *
                         C      ;*                                          ... Dateiattribut   *
                         C      ;*               Ausgabeparameter: DE       ... Startadresse    *
                         C      ;*                                 Z-FF = 1 ... normales Ende   *
                         C      ;*                                 Z-FF = 0 ... abnorm.  Ende   *
                         C      ;*                                 A    = 1 ... Datei nicht da  *
                         C      ;*                                 A    = 2 ... Datei nicht pos.*
                         C      ;****************************************************************
  E106    CD DC21        C      LO.AL:      CALL    K1.MREPO
  E109    C0             C                  RET     NZ
                         C      
  E10A    CD DB8E        C      LO.UW:      CALL    K1.LESV
  E10D    47             C                  LD      B,A
  E10E    B7             C                  OR      A
  E10F    28 11          C                  JR      Z,LO.UWEND
  E111    CD DB8E        C                  CALL    K1.LESV
  E114    57             C                  LD      D,A
  E115    CD DB8E        C                  CALL    K1.LESV
  E118    5F             C                  LD      E,A
  E119    CD DB8E        C      LO.UW1:     CALL    K1.LESV
  E11C    12             C                  LD      (DE),A
  E11D    13             C                  INC     DE
  E11E    10 F9          C                  DJNZ    LO.UW1
  E120    18 E8          C                  JR      LO.UW
                         C      
  E122    CD DB8E        C      LO.UWEND:   CALL    K1.LESV
  E125    57             C                  LD      D,A
  E126    CD DB8E        C                  CALL    K1.LESV
  E129    5F             C                  LD      E,A
  E12A    D5             C                  PUSH    DE
  E12B    CD D77D        C                  CALL    K1.GNRW
  E12E    CD D762        C                  CALL    K1.GNRA
  E131    CD D6EE        C                  CALL    K1.GNSTS
  E134    D1             C                  POP     DE
  E135    AF             C                  XOR     A
  E136    C9             C                  RET
                         C      
                         C                  PAGE
'Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-114


                         C      
                         C      ;****************************************************************
                         C      ;*               Unterprogramm: relativer LOAD                  *
                         C      ;*               -----------------------------------------------*
                         C      ;*               Eingabeparameter: K2.MRPAR ... Dateiname       *
                         C      ;*                                          ... Dateityp  R / O *
                         C      ;*                                          ... Dateiattribut   *
                         C      ;*                                 S2.PRGN  ... Ladeanfangsadr. *
                         C      ;*               Ausgabeparameter: HL       ... Ladeendeadresse *
                         C      ;*                                 Z-FF = 1 ... normales Ende   *
                         C      ;*                                 Z-FF = 0 ... abnorm.  Ende   *
                         C      ;*                                 A    = 1 ... Datei nicht da  *
                         C      ;*                                 A    = 2 ... Datei nicht pos.*
                         C      ;****************************************************************
  E137    CD DC21        C      LO.RL:      CALL    K1.MREPO
  E13A    C0             C                  RET     NZ
                         C      
  E13B    2A B265        C      LO.RL1:     LD      HL,(S2.PRGN)
  E13E    0E 01          C                  LD      C,1
  E140    CD E1B8        C                  CALL    LO.RLUP
                         C      
  E143    CB 5F          C      LO.RL2:     BIT     3,A
  E145    20 6B          C                  JR      NZ,LO.DF
  E147    CB 67          C                  BIT     4,A
  E149    20 53          C                  JR      NZ,LO.RL8
  E14B    E6 07          C                  AND     7
  E14D    28 5E          C                  JR      Z,LO.RL9
  E14F    47             C                  LD      B,A
  E150    CD E1B8        C      LO.RL3:     CALL    LO.RLUP
  E153    77             C                  LD      (HL),A
  E154    23             C                  INC     HL
  E155    10 F9          C                  DJNZ    LO.RL3
  E157    CD E1B8        C                  CALL    LO.RLUP
  E15A    CB 7F          C                  BIT     7,A
  E15C    20 E5          C                  JR      NZ,LO.RL2
  E15E    CB 6F          C                  BIT     5,A
  E160    28 50          C                  JR      Z,LO.DF
  E162    CB 77          C                  BIT     6,A
  E164    20 4C          C                  JR      NZ,LO.DF
  E166    CB 57          C                  BIT     2,A
  E168    20 48          C                  JR      NZ,LO.DF
  E16A    E6 03          C      LO.RL4:     AND     3
  E16C    F5             C                  PUSH    AF
  E16D    E5             C                  PUSH    HL
  E16E    CD E1B8        C                  CALL    LO.RLUP
  E171    67             C                  LD      H,A
  E172    CD E1B8        C                  CALL    LO.RLUP
  E175    6F             C                  LD      L,A
  E176    C5             C                  PUSH    BC
  E177    3A B265        C                  LD      A,(S2.PRGN)         ;Anfangslade-adresse ==> BC
  E17A    4F             C                  LD      C,A
  E17B    3A B266        C                  LD      A,(S2.PRGN+1)
  E17E    47             C                  LD      B,A
  E17F    09             C                  ADD     HL,BC
  E180    EB             C                  EX      DE,HL
  E181    C1             C                  POP     BC
  E182    E1             C                  POP     HL
  E183    F1             C                  POP     AF
  E184    28 04          C                  JR      Z,LO.RL5
  E186    CB 47          C                  BIT     0,A
  E188    28 09          C                  JR      Z,LO.RL6
  E18A    73             C      LO.RL5:     LD      (HL),E
  E18B    23             C                  INC     HL
  E18C    FE 03          C                  CP      3
  E18E    28 03          C                  JR      Z,LO.RL6
  E190    B7             C                  OR      A
  E191    20 02          C                  JR      NZ,LO.RL7
  E193    72             C      LO.RL6:     LD      (HL),D
  E194    23             C                  INC     HL
  E195    CD E1B8        C      LO.RL7:     CALL    LO.RLUP
  E198    CB 7F          C                  BIT     7,A
  E19A    20 A7          C                  JR      NZ,LO.RL2
  E19C    18 14          C                  JR      LO.DF
  E19E    CD E1B8        C      LO.RL8:     CALL    LO.RLUP
  E1A1    F5             C                  PUSH    AF
  E1A2    CD E1B8        C                  CALL    LO.RLUP
  E1A5    D1             C                  POP     DE
  E1A6    5F             C                  LD      E,A
  E1A7    19             C                  ADD     HL,DE
  E1A8    CD E1B8        C                  CALL    LO.RLUP
  E1AB    18 96          C                  JR      LO.RL2
  E1AD    CD E1B8        C      LO.RL9:     CALL    LO.RLUP
'Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-115


  E1B0    18 B8          C                  JR      LO.RL4
                         C      
  E1B2    21 E356        C      LO.DF:      LD      HL,LO.TXT8
  E1B5    C3 C4EE        C                  JP      S1.FEH
                         C      
  E1B8    CD DB8E        C      LO.RLUP:    CALL    K1.LESV
  E1BB    0D             C                  DEC     C
  E1BC    C0             C                  RET     NZ
  E1BD    A7             C                  AND     A
  E1BE    28 04          C                  JR      Z,LO.RL10
  E1C0    4F             C                  LD      C,A
  E1C1    0C             C                  INC     C
  E1C2    18 F4          C                  JR      LO.RLUP
  E1C4    D1             C      LO.RL10:    POP     DE
  E1C5    2B             C                  DEC     HL
  E1C6    E5             C                  PUSH    HL
  E1C7    CD D77D        C                  CALL    K1.GNRW
  E1CA    CD D762        C                  CALL    K1.GNRA
  E1CD    CD D6EE        C                  CALL    K1.GNSTS
  E1D0    E1             C                  POP     HL
  E1D1    AF             C                  XOR     A
  E1D2    C9             C                  RET
                         C      
                         C                  PAGE
'Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-116


                         C      
                         C      ;****************************************************************
                         C      ;*               Unterprogramm: SAVE                            *
                         C      ;*               -----------------------------------------------*
                         C      ;*               Eingabeparameter: S2.PRGN  ... SAVEanfangsadr. *
                         C      ;*                                 S2.PRGN+2... SAVEendeadresse *
                         C      ;****************************************************************
  E1D3    CD E210        C      LO.SAVE:    CALL    LO.SV4              ;einen Bereich ausgeben
  E1D6    23             C                  INC     HL
  E1D7    7C             C                  LD      A,H
  E1D8    B5             C                  OR      L
  E1D9    28 15          C                  JR      Z,LO.SAV2
  E1DB    01 007D        C                  LD      BC,7DH              ;Blocklaenge
  E1DE    B7             C                  OR      A
  E1DF    ED 42          C                  SBC     HL,BC
  E1E1    38 05          C                  JR      C,LO.SAV1
  E1E3    CD E1F1        C                  CALL    LO.SV1
  E1E6    18 EB          C                  JR      LO.SAVE
  E1E8    CD E210        C      LO.SAV1:    CALL    LO.SV4
  E1EB    23             C                  INC     HL
  E1EC    7D             C                  LD      A,L
  E1ED    CD E1F3        C                  CALL    LO.SV2
  E1F0    C9             C      LO.SAV2:    RET
                         C      
  E1F1    3E 7D          C      LO.SV1:     LD      A,7DH               ;einen Block ausgeben
  E1F3    F5             C      LO.SV2:     PUSH    AF
  E1F4    CD DBAB        C                  CALL    K1.SCHR             ;Blocklaenge  ausgeben
  E1F7    ED 5B B265     C                  LD      DE,(S2.PRGN)        ;Blockadresse ausgeben
  E1FB    7A             C                  LD      A,D
  E1FC    CD DBAB        C                  CALL    K1.SCHR
  E1FF    7B             C                  LD      A,E
  E200    CD DBAB        C                  CALL    K1.SCHR
  E203    C1             C                  POP     BC
  E204    1A             C      LO.SV3:     LD      A,(DE)
  E205    CD DBAB        C                  CALL    K1.SCHR             ;Datenbytes ausgeben
  E208    13             C                  INC     DE
  E209    10 F9          C                  DJNZ    LO.SV3
  E20B    ED 53 B265     C                  LD      (S2.PRGN),DE
  E20F    C9             C                  RET
                         C      
  E210    2A B267        C      LO.SV4:     LD      HL,(S2.PRGN+2)
  E213    ED 5B B265     C                  LD      DE,(S2.PRGN)
  E217    B7             C                  OR      A
  E218    ED 52          C                  SBC     HL,DE
  E21A    C9             C                  RET
                         C      
                         C                  PAGE
'Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-117


                         C      
  E21B    D5             C      LO.TXT:     PUSH    DE
  E21C    E5             C                  PUSH    HL
  E21D    3E 02          C                  LD      A,2                 ;Bildfenster vergroessern
  E21F    32 B198        C                  LD      (MS.CMD),A
  E222    CD CB16        C                  CALL    MO.MONI
  E225    26 00          C                  LD      H,0                 ;ZPOS = SYSZ+  , SPOS = 0
  E227    68             C                  LD      L,B
  E228    22 B18C        C                  LD      (MS.ZPOS),HL
  E22B    3E 18          C                  LD      A,24
  E22D    32 B198        C                  LD      (MS.CMD),A
  E230    06 0B          C                  LD      B,11
  E232    E1             C                  POP     HL
  E233    CD CB16        C                  CALL    MO.MONI
  E236    06 0F          C                  LD      B,15                ;Anzeige: -Adresse: 0000H
  E238    21 E317        C                  LD      HL,LO.TXT6
  E23B    CD CB16        C                  CALL    MO.MONI
  E23E    2A B18C        C                  LD      HL,(MS.ZPOS)        ;ZPOS = SYSZ+  , SPOS = 21
  E241    26 15          C                  LD      H,21
  E243    22 B18C        C                  LD      (MS.ZPOS),HL
  E246    24             C                  INC     H                   ;ZMIN = SYSZ+  , SMIN = 22
  E247    2C             C                  INC     L
  E248    22 B18E        C                  LD      (MS.ZMIN),HL
  E24B    24             C                  INC     H                   ;ZMAX = SYSZ+  , SMAX = 25
  E24C    24             C                  INC     H
  E24D    24             C                  INC     H
  E24E    22 B190        C                  LD      (MS.ZMAX),HL
                         C      
  E251    CD D40E        C                  CALL    TA.LOE
  E254    21 C114        C                  LD      HL,S1.SYSTB
  E257    22 B21D        C                  LD      (TS.TAB3+6),HL
  E25A    21 E276        C                  LD      HL,LO.EIN1
  E25D    22 B22D        C                  LD      (TS.EINA),HL
  E260    21 C2D3        C                  LD      HL,S1.CNLS
  E263    22 B20D        C                  LD      (TS.TAB2+14),HL
  E266    21 C2B4        C                  LD      HL,S1.CNRS
  E269    22 B211        C                  LD      (TS.TAB2+18),HL
  E26C    E1             C                  POP     HL
  E26D    22 B223        C                  LD      (TS.TAB4),HL
  E270    3E A8          C                  LD      A,10101000B
  E272    32 B23F        C                  LD      (TS.SPMER),A
  E275    C9             C                  RET
                         C      
  E276    FE 40          C      LO.EIN1:    CP      '@'
  E278    C8             C                  RET     Z
  E279    FE 23          C                  CP      '#'
  E27B    C8             C                  RET     Z
  E27C    FE 24          C                  CP      '$'
  E27E    C8             C                  RET     Z
  E27F    FE 47          C                  CP      'G'
  E281    D0             C                  RET     NC
  E282    C3 C328        C                  JP      S1.AEIN
                         C      
                         C                  PAGE
'Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-118


                         C      
  E285    26 15          C      LO.TR1:     LD      H,21                ;ZPOS=SYSZ+   , SPOS=22
  E287    68             C                  LD      L,B
  E288    22 B18C        C                  LD      (MS.ZPOS),HL
  E28B    3E 0B          C                  LD      A,11                ;HL:=ZPOS,SPOS
  E28D    32 B198        C                  LD      (MS.CMD),A
  E290    CD CB16        C                  CALL    MO.MONI
  E293    11 B29A        C                  LD      DE,S2.DM1
  E296    01 0004        C                  LD      BC,4
  E299    ED B0          C                  LDIR
  E29B    21 B29A        C                  LD      HL,S2.DM1
  E29E    CD C5CC        C                  CALL    S1.HBKON
  E2A1    57             C                  LD      D,A
  E2A2    CD C5CC        C                  CALL    S1.HBKON
  E2A5    5F             C                  LD      E,A
  E2A6    C9             C                  RET
                         C      
  E2A7    3A B26C        C      LO.RGL:     LD      A,(S2.RBBR)         ;laden IX,IY entspr. Geraet 1/2
  E2AA    FE 02          C                  CP      2
  E2AC    28 04          C                  JR      Z,LO.RGL1
  E2AE    CD D62A        C                  CALL    K1.RGL1
  E2B1    C9             C                  RET
  E2B2    CD D63B        C      LO.RGL1:    CALL    K1.RGL2
  E2B5    C9             C                  RET
                         C      
                         C                  TITLE   'Zeichenketten-Konstanten'
                         C                  PAGE
'Zeichenketten-Konstanten'	MACRO-80 3.44	09-Dec-81	PAGE	1-119


                         C      
  E2B6    4D 52 45 53    C      LO.TXT1:    DB      'MRES - Eingabedatei: '
  E2BA    20 2D 20 45    C      
  E2BE    69 6E 67 61    C      
  E2C2    62 65 64 61    C      
  E2C6    74 65 69 3A    C      
  E2CA    20             C      
  E2CB    50 72 6F 67    C      LO.TXT2:    DB      'Programm starten ?   '
  E2CF    72 61 6D 6D    C      
  E2D3    20 73 74 61    C      
  E2D7    72 74 65 6E    C      
  E2DB    20 3F 20 20    C      
  E2DF    20             C      
  E2E0    4C 61 64 65    C      LO.TXT3:    DB      'Ladeanfangs'
  E2E4    61 6E 66 61    C      
  E2E8    6E 67 73       C      
  E2EB    4C 61 64 65    C      LO.TXT4:    DB      'Ladeende   '
  E2EF    65 6E 64 65    C      
  E2F3    20 20 20       C      
  E2F6    53 74 61 72    C      LO.TXT5:    DB      'Start      '
  E2FA    74 20 20 20    C      
  E2FE    20 20 20       C      
  E301    53 41 56 45    C      LO.TXT12:   DB      'SAVEanfangs'
  E305    61 6E 66 61    C      
  E309    6E 67 73       C      
  E30C    53 41 56 45    C      LO.TXT13:   DB      'SAVEende   '
  E310    65 6E 64 65    C      
  E314    20 20 20       C      
  E317    2D 41 64 72    C      LO.TXT6:    DB      '-Adresse: 0000H'
  E31B    65 73 73 65    C      
  E31F    3A 20 30 30    C      
  E323    30 30 48       C      
  E326    4D 52 45 53    C      LO.TXT7:    DB      'MRES - Dateityp    : '
  E32A    20 2D 20 44    C      
  E32E    61 74 65 69    C      
  E332    74 79 70 20    C      
  E336    20 20 20 3A    C      
  E33A    20             C      
  E33B    77 65 69 74    C      LO.TXT14:   DB      'weitere Bloecke ausgeben'
  E33F    65 72 65 20    C      
  E343    42 6C 6F 65    C      
  E347    63 6B 65 20    C      
  E34B    61 75 73 67    C      
  E34F    65 62 65 6E    C      
  E353    41 75 73       C      LO.TXT15:   DB      'Aus'
                         C      
  E356    44 61 74 65    C      LO.TXT8:    DB      'Datenfehler in R bzw. O - MRES-Datei  '
  E35A    6E 66 65 68    C      
  E35E    6C 65 72 20    C      
  E362    69 6E 20 52    C      
  E366    20 62 7A 77    C      
  E36A    2E 20 4F 20    C      
  E36E    2D 20 4D 52    C      
  E372    45 53 2D 44    C      
  E376    61 74 65 69    C      
  E37A    20 20          C      
  E37C    44 61 74 65    C      LO.TXT9:    DB      'Datei ist nicht im Verzeichnis        '
  E380    69 20 69 73    C      
  E384    74 20 6E 69    C      
  E388    63 68 74 20    C      
  E38C    69 6D 20 56    C      
  E390    65 72 7A 65    C      
  E394    69 63 68 6E    C      
  E398    69 73 20 20    C      
  E39C    20 20 20 20    C      
  E3A0    20 20          C      
  E3A2    44 61 74 65    C      LO.TXT10:   DB      'Datei kann nicht positioniert werden  '
  E3A6    69 20 6B 61    C      
  E3AA    6E 6E 20 6E    C      
  E3AE    69 63 68 74    C      
  E3B2    20 70 6F 73    C      
  E3B6    69 74 69 6F    C      
  E3BA    6E 69 65 72    C      
  E3BE    74 20 77 65    C      
  E3C2    72 64 65 6E    C      
  E3C6    20 20          C      
  E3C8    6B 61 6E 6E    C      LO.TXT11:   DB      'kann die Datei ueberschrieben werden ?'
  E3CC    20 64 69 65    C      
  E3D0    20 44 61 74    C      
  E3D4    65 69 20 75    C      
  E3D8    65 62 65 72    C      
  E3DC    73 63 68 72    C      
'Zeichenketten-Konstanten'	MACRO-80 3.44	09-Dec-81	PAGE	1-120


  E3E0    69 65 62 65    C      
  E3E4    6E 20 77 65    C      
  E3E8    72 64 65 6E    C      
  E3EC    20 3F          C      
                         C      
                         C      
                         C      ;           END
                         C      ;           PN      S975
                         C                  TITLE   'Anschlussroutinen fuer  B A S I C'
                         C                  PAGE
'Anschlussroutinen fuer  B A S I C'	MACRO-80 3.44	09-Dec-81	PAGE	1-121


                         C      
                         C      ;****************************************************************
                         C      ;*               Anschlussroutinen fuer  B A S I C              *
                         C      ;*  Version      -----------------------------------------------*
                         C      ;*               Programmierer: M. Herbote --- K EAW  ZFT (WFT) *
                         C      ;*  V 2 . 1      -----------------------------------------------*
                         C      ;*               Stand        : 14.Maerz 1985                   *
                         C      ;****************************************************************
                         C      
  E3EE    56 32 2E 31    C                  DB      'V2.1/140385'
  E3F2    2F 31 34 30    C      
  E3F6    33 38 35       C      
                         C      
                         C      ;****************************************************************
                         C      ;*            B A S I C   -   N e u s t a r t                   *
                         C      ;****************************************************************
  E3F9    E3F9           C                  DW      $
  E3FB    42 53 43 4E    C                  DB      'BSCN'
  E3FF    CD F640        C      S9.BASC:    CALL    S0.BASCL
  E402    21 0100        C                  LD      HL,00100H           ;BASIC - CRC-Summe kontrollieren
  E405    01 3000        C                  LD      BC,03000H
  E408    CD C652        C                  CALL    S1.CHK
  E40B    21 B783        C                  LD      HL,0B783H           ;CRC-Summe 100-30FF   (06D97H alt)
  E40E    B7             C                  OR      A
  E40F    ED 52          C                  SBC     HL,DE
  E411    28 09          C                  JR      Z,S9.BASC1
  E413    21 E45F        C                  LD      HL,S9.FT1
  E416    11 E41C        C                  LD      DE,S9.BASC1
  E419    CD C4F4        C                  CALL    S1.FEHR
  E41C    21 C0B0        C      S9.BASC1:   LD      HL,S1.RES           ;RESET-Adresse eintragen
  E41F    22 3011        C                  LD      (BC.RECOV1+1),HL
  E422    21 E631        C                  LD      HL,S9.ANFPG         ;Anfangsprogramm laden
  E425    22 30B3        C                  LD      (BC.ANF+1),HL
  E428    21 EE20        C                  LD      HL,S9.OUT
  E42B    11 0070        C                  LD      DE,00070H
  E42E    01 002B        C                  LD      BC,S9.OUTLG-S9.OUT
  E431    ED B0          C                  LDIR
  E433    CD E4AB        C                  CALL    S9.BSC
  E436    C3 0300        C                  JP      BC.INIT
                         C      ;****************************************************************
                         C      ;*            B A S I C   -   R e s t a r t                     *
                         C      ;****************************************************************
  E439    E439           C                  DW      $
  E43B    42 53 43 52    C                  DB      'BSCR'
  E43F    21 0327        C      S9.BSCR:    LD      HL,BC.PAR
  E442    01 2C90        C                  LD      BC,BC.D131-BC.PAR   ;02C90H
  E445    CD C652        C                  CALL    S1.CHK
  E448    21 B7F8        C                  LD      HL,0B7F8H           ;CRC-Summe 327-2FB7
  E44B    B7             C                  OR      A
  E44C    ED 52          C                  SBC     HL,DE
  E44E    28 09          C                  JR      Z,S9.BASC2
  E450    21 E485        C                  LD      HL,S9.FT2
  E453    11 E459        C                  LD      DE,S9.BASC2
  E456    CD C4F4        C                  CALL    S1.FEHR
  E459    CD E4AB        C      S9.BASC2:   CALL    S9.BSC
  E45C    C3 0303        C                  JP      BC.RECOV
                         C      
  E45F    43 52 43 20    C      S9.FT1:     DB      'CRC - Fehler in  B A S I C - P R O M  '
  E463    2D 20 46 65    C      
  E467    68 6C 65 72    C      
  E46B    20 69 6E 20    C      
  E46F    20 42 20 41    C      
  E473    20 53 20 49    C      
  E477    20 43 20 2D    C      
  E47B    20 50 20 52    C      
  E47F    20 4F 20 4D    C      
  E483    20 20          C      
  E485    43 52 43 20    C      S9.FT2:     DB      'CRC - Fehler in  B A S I C, ==> BSCN !'
  E489    2D 20 46 65    C      
  E48D    68 6C 65 72    C      
  E491    20 69 6E 20    C      
  E495    20 42 20 41    C      
  E499    20 53 20 49    C      
  E49D    20 43 2C 20    C      
  E4A1    3D 3D 3E 20    C      
  E4A5    42 53 43 4E    C      
  E4A9    20 21          C      
                         C      
                         C                  PAGE
'Anschlussroutinen fuer  B A S I C'	MACRO-80 3.44	09-Dec-81	PAGE	1-122


                         C      
  E4AB    21 E532        C      S9.BSC:     LD      HL,S9.ATAB1         ;Anschl.rout.adr. in BASIC-Workspace eintragen
  E4AE    11 0306        C                  LD      DE,00306H
  E4B1    01 0021        C                  LD      BC,S9.ATAB2-S9.ATAB1
  E4B4    ED B0          C                  LDIR
  E4B6    21 E553        C                  LD      HL,S9.ATAB2         ;Adressen in zusaetzl. Verst.bereich eintragen
  E4B9    11 B400        C                  LD      DE,0B400H
  E4BC    01 0028        C                  LD      BC,S9.HOME1-S9.ATAB2
  E4BF    ED B0          C                  LDIR
  E4C1    21 0070        C                  LD      HL,00070H           ;Erweiterung OUT-Befehl aktivieren
  E4C4    22 1714        C                  LD      (01714H),HL
  E4C7    21 0082        C                  LD      HL,00082H           ;SVC-Befehl aktivieren
  E4CA    22 03C6        C                  LD      (BC.SVC1),HL
  E4CD    21 5620        C                  LD      HL,05620H           ;" V"
  E4D0    22 2D99        C                  LD      (BC.SVC2+1),HL
  E4D3    21 C320        C                  LD      HL,0C320H           ;" C"
  E4D6    22 2D9B        C                  LD      (BC.SVC2+3),HL
                         C      
                         C                  ; LD      HL,0009BH           ;GRF-Befehl aktivieren
                         C                  ; LD      (BC.GRF1),HL
                         C                  ; LD      HL,02047H           ;"G "
                         C                  ; LD      (BC.GRF2),HL
                         C                  ; LD      HL,05220H           ;" R"
                         C                  ; LD      (BC.GRF2+2),HL
                         C                  ; LD      HL,0C620H           ;" F"
                         C                  ; LD      (BC.GRF2+4),HL
                         C      
  E4D9    21 0100        C                  LD      HL,S0.LRECL         ;Satzlaenge fuer Kassette eintr.
  E4DC    22 B138        C                  LD      (K2.LRECL),HL
  E4DF    21 0000        C                  LD      HL,0
  E4E2    22 B18C        C                  LD      (MS.ZPOS),HL        ;ZPOS= 1 , SPOS= 1
  E4E5    3E 05          C                  LD      A,5                 ;Bildfenster loeschen
  E4E7    32 B198        C                  LD      (MS.CMD),A
  E4EA    CD CB16        C                  CALL    MO.MONI
  E4ED    21 B197        C                  LD      HL,MS.DIRES         ;Bildrollen einschalten
  E4F0    CB EE          C                  SET     5,(HL)              ;rollen allgemein
  E4F2    CB A6          C                  RES     4,(HL)              ;rollen Fensterinhalt
  E4F4    21 CD9F        C                  LD      HL,MO.ROLL
  E4F7    22 B19A        C                  LD      (MS.RADR),HL
  E4FA    21 E43F        C                  LD      HL,S9.BSCR
  E4FD    22 B136        C                  LD      (K2.FRADR),HL
  E500    CD E510        C                  CALL    S9.TALOE            ;Tastatur aktivieren
  E503    AF             C                  XOR     A
  E504    32 B263        C                  LD      (S2.CST),A          ;Statusanzeige "gedrueckte Taste"
  E507    21 B25F        C                  LD      HL,S2.IM
  E50A    77             C                  LD      (HL),A              ;S2.IM    loeschen
  E50B    23             C                  INC     HL
  E50C    77             C                  LD      (HL),A              ;S2.OM    loeschen
  E50D    23             C                  INC     HL
  E50E    77             C                  LD      (HL),A              ;S2.VZM   loeschen
  E50F    C9             C                  RET
  E510    CD D40E        C      S9.TALOE:   CALL    TA.LOE
  E513    21 E637        C                  LD      HL,S9.BCTB1
  E516    11 B19F        C                  LD      DE,TS.TAB1
  E519    01 0018        C                  LD      BC,S9.BCTB2-S9.BCTB1
  E51C    ED B0          C                  LDIR
  E51E    21 E64F        C                  LD      HL,S9.BCTB2
  E521    11 B1FF        C                  LD      DE,TS.TAB2
  E524    01 0034        C                  LD      BC,S9.TAS-S9.BCTB2
  E527    ED B0          C                  LDIR
  E529    3E FE          C                  LD      A,11111110B
  E52B    32 B23F        C                  LD      (TS.SPMER),A
  E52E    CD B415        C                  CALL    0B415H              ;HOME-Taste aktivieren JA/NEIN
  E531    C9             C                  RET
                         C                  PAGE
'Anschlussroutinen fuer  B A S I C'	MACRO-80 3.44	09-Dec-81	PAGE	1-123


                         C      
                         C      ;****************************************************************
                         C      ;*               Sprungtabelle , die in den Workspace von       *
                         C      ;*               B A S I C  eingetragen wird                    *
                         C      ;****************************************************************
  E532    C3 ECFA        C      S9.ATAB1:   JP      S9.USER             ;USR     -Routine
  E535    C3 E694        C                  JP      S9.CIN              ;Konsolen-Inputroutine
  E538    C3 EB80        C                  JP      S9.RIV              ;Leser   -Inputroutine
  E53B    C3 E6E3        C                  JP      S9.CON              ;Konsolen-Outputroutine
  E53E    C3 EC1B        C                  JP      S9.WRTV             ;Stanzer -Outputroutine
  E541    C3 EC6D        C                  JP      S9.LISTX            ;Drucker -Outputroutine
  E544    C3 E6C8        C                  JP      S9.CSTSX            ;Konsolen-Statusroutine
  E547    AF             C                  XOR     A                   ;Konfigurationstest     IOCHK
  E548    C9             C                  RET
  E549    00             C                  NOP
  E54A    C3 EC8E        C                  JP      S9.IOSTX            ;SWITCH  -Routine
  E54D    C3 EE1B        C                  JP      S9.MEMCK            ;uebergibt Standardspeichergroesse
  E550    C3 C114        C                  JP      S1.SYSTB            ;Rueckkehr zum Betriebssystem
                         C      
                         C      
                         C      
                         C      ;****************************************************************
                         C      ;*               zusaetzlicher Verstaendigungsbereich           *
                         C      ;****************************************************************
  E553    C3 F0DD        C      S9.ATAB2:   JP      S9.ABAUP            ;B400
  E556    C3 F11C        C                  JP      S9.RBAUP            ;B403
  E559    C3 EF0A        C                  JP      S9.OPEN             ;B406
  E55C    C3 EFAB        C                  JP      S9.CLOSE            ;B409
  E55F    C3 F021        C                  JP      S9.READ             ;B40C
  E562    C3 F04B        C                  JP      S9.WRITE            ;B40F
  E565    C3 ECF9        C                  JP      S9.IOX              ;B412
  E568    C9             C                  RET                         ;B415
  E569    E57B           C                  DW      S9.HOME1            ;B416
  E56B    C3 0000        C                  JP      0                   ;B418
  E56E    C3 F29C        C                  JP      S9.BLD1             ;B41B
  E571    00             C                  DB      0                   ;B41E ... Eingabekonv.(RS),wenn FFH
  E572    1E             C                  DB      01EH                ;B41F ... Eingabe-Zeilenendezeichen
  E573    00             C                  DB      0                   ;B420 ... Ausgabekonv.(RS),wenn FFH
  E574    1E             C                  DB      01EH                ;B421 ... Ausgabe-Zeilenendezeichen
  E575    C9             C                  RET                         ;B422 ... Eingabe-Kodetransformation
  E576    ECF9           C                  DW      S9.IOX
  E578    C9             C                  RET                         ;B425 ... Ausgabe-Kodetransformation
  E579    ECF9           C                  DW      S9.IOX
                         C      
  E57B    21 0000        C      S9.HOME1:   LD      HL,0
  E57E    22 B20F        C                  LD      (TS.TAB2+16),HL
  E581    C9             C                  RET
                         C      
                         C                  TITLE   'Anfangsprogramm'
                         C                  PAGE
'Anfangsprogramm'	MACRO-80 3.44	09-Dec-81	PAGE	1-124


                         C      
  E582    2FDE           C      S9.ANFP:    DW      02FDEH              ;Adresse naechster Befehl
  E584    0001           C                  DW      1                   ;BASIC-Zeilennummer 1
  E586    99             C                  DB      99H                 ;CLEAR
  E587    20 35 30 30    C                  DB      ' 500:'
  E58B    3A             C      
  E58C    D4             C                  DB      0D4H                ;SVC
  E58D    30 2C 37 2C    C                  DB      '0,7,1,22,1,80:'
  E591    31 2C 32 32    C      
  E595    2C 31 2C 38    C      
  E599    30 3A          C      
  E59B    D4             C                  DB      0D4H                ;SVC
  E59C    30 2C 32 3A    C                  DB      '0,2:'
  E5A0    D4             C                  DB      0D4H                ;SVC
  E5A1    30 2C 35 2C    C                  DB      '0,5,1,1'
  E5A5    31 2C 31       C      
  E5A8    00             C                  DB      0
                         C      
  E5A9    3048           C                  DW      03048H              ;Adresse naechster Befehl
  E5AB    0002           C                  DW      2                   ;BASIC-Zeilennummer 2
  E5AD    53 59 24       C                  DB      'SY$'
  E5B0    AD             C                  DB      0ADH                ;=
  E5B1    22 6E 61 6D    C                  DB      '"name__tacomm__date__sig":ER$'
  E5B5    65 5F 5F 74    C      
  E5B9    61 63 6F 6D    C      
  E5BD    6D 5F 5F 64    C      
  E5C1    61 74 65 5F    C      
  E5C5    5F 73 69 67    C      
  E5C9    22 3A 45 52    C      
  E5CD    24             C      
  E5CE    AD             C                  DB      0ADH                ;=
  E5CF    22 31 31 2E    C                  DB      '"11...G lpoispoi":'
  E5D3    2E 2E 47 20    C      
  E5D7    6C 70 6F 69    C      
  E5DB    73 70 6F 69    C      
  E5DF    22 3A          C      
  E5E1    D4             C                  DB      0D4H                ;SVC
  E5E2    30 2C 31 39    C                  DB      '0,19:'
  E5E6    3A             C      
  E5E7    8A             C                  DB      08AH                ;IF
  E5E8    C6             C                  DB      0C6H                ;MID$
  E5E9    28 45 52 24    C                  DB      '(ER$,7,1)'
  E5ED    2C 37 2C 31    C      
  E5F1    29             C      
  E5F2    AD             C                  DB      0ADH                ;=
  E5F3    22 31 22       C                  DB      '"1"'
  E5F6    A2             C                  DB      0A2H                ;THEN
  E5F7    97             C                  DB      097H                ;?
  E5F8    22 45 20 6E    C                  DB      '"E n t l a d e n":'
  E5FC    20 74 20 6C    C      
  E600    20 61 20 64    C      
  E604    20 65 20 6E    C      
  E608    22 3A          C      
  E60A    D4             C                  DB      0D4H                ;SVC
  E60B    30 2C 32 39    C                  DB      '0,29,73'
  E60F    2C 37 33       C      
  E612    00             C                  DB      0
                         C      
  E613    0000           C                  DW      0                   ;Endekennzeichen BASIC-Programm
                         C      
                         C      
  E615    21 E582        C      S9.ANFG:    LD      HL,S9.ANFP
  E618    11 2FB7        C                  LD      DE,02FB7H
  E61B    01 0093        C                  LD      BC,S9.ANFG-S9.ANFP
  E61E    ED B0          C                  LDIR
  E620    21 3049        C                  LD      HL,03049H
  E623    22 0150        C                  LD      (BC.D017),HL
  E626    23             C                  INC     HL
  E627    22 015E        C                  LD      (BC.D024),HL
  E62A    22 0160        C                  LD      (BC.D025),HL
  E62D    22 0162        C                  LD      (BC.D026),HL
  E630    C9             C                  RET
                         C      
  E631    CD E615        C      S9.ANFPG:   CALL    S9.ANFG
  E634    C3 04A0        C                  JP      004A0H
                         C      
                         C                  TITLE   'Tastenroutinenadressen'
                         C                  PAGE
'Tastenroutinenadressen'	MACRO-80 3.44	09-Dec-81	PAGE	1-125


                         C      
                         C      ;****************************************************************
                         C      ;*               Tastenroutinenadressen                         *
                         C      ;****************************************************************
  E637    E74E           C      S9.BCTB1:   DW      S9.CST4             ;CNTRL-S --- P1
  E639    E683           C                  DW      S9.TAS              ;        --- P2
  E63B    E752           C                  DW      S9.CST5             ;CNTRL-Q --- P3
  E63D    0000           C                  DW      0
  E63F    E756           C                  DW      S9.CST6             ;CNTRL-R --- P5
  E641    0000           C                  DW      0
  E643    E75A           C                  DW      S9.CST7             ;CNTRL-C --- P7
  E645    E75E           C                  DW      S9.CST8             ;CNTRL-O --- P8
  E647    E762           C                  DW      S9.CST9             ;CNTRL-T --- P9
  E649    E799           C                  DW      S9.FBE1             ;        --- P10
  E64B    E7D3           C                  DW      S9.FBE2             ;        --- P11
  E64D    E7EB           C                  DW      S9.FBE3             ;        --- P12
                         C      
  E64F    0000           C      S9.BCTB2:   DW      0
  E651    0000           C                  DW      0
  E653    0000           C                  DW      0
  E655    E74A           C                  DW      S9.CST3             ;CNTRL-U --- DEL LINE
  E657    0000           C                  DW      0
  E659    0000           C                  DW      0
  E65B    0000           C                  DW      0
  E65D    E742           C                  DW      S9.CST1             ;rubout  --- <==
  E65F    E782           C                  DW      S9.HOME
  E661    0000           C                  DW      0
  E663    E76A           C                  DW      S9.CST11            ;escape  --- CNZA
  E665    0000           C                  DW      0
  E667    C334           C                  DW      S1.NN
  E669    C345           C                  DW      S1.NNN
  E66B    0000           C                  DW      0
  E66D    E746           C                  DW      S9.CST2             ;CNTRL-X --- SYS
  E66F    C354           C                  DW      S1.HCOPY
  E671    0000           C                  DW      0
  E673    E766           C                  DW      S9.CST10            ;        --- POS QUIT
  E675    0000           C                  DW      0
  E677    0000           C                  DW      0
  E679    0000           C                  DW      0
  E67B    0000           C                  DW      0
  E67D    E778           C                  DW      S9.CSTS3            ;        --- EINA
  E67F    0000           C                  DW      0
  E681    E766           C                  DW      S9.CST10            ;        --- ET1
                         C      
                         C      
  E683    3A B241        C      S9.TAS:     LD      A,(TS.KGMER)
  E686    B7             C                  OR      A
  E687    28 03          C                  JR      Z,S9.TAS1
  E689    AF             C                  XOR     A
  E68A    18 01          C                  JR      S9.TAS2
  E68C    3C             C      S9.TAS1:    INC     A
  E68D    32 B241        C      S9.TAS2:    LD      (TS.KGMER),A
  E690    CD C67C        C                  CALL    S1.STAT
  E693    C9             C                  RET
                         C      
                         C                  TITLE   'Konsoleninput'
                         C                  PAGE
'Konsoleninput'	MACRO-80 3.44	09-Dec-81	PAGE	1-126


                         C      
                         C      ;****************************************************************
                         C      ;*               Eingabe eines Zeichens von Konsole             *
                         C      ;****************************************************************
  E694    CD EE95        C      S9.CIN:     CALL    S9.SAVE
  E697    3A 01AB        C                  LD      A,(BC.D058)          ;AUTO aktiv ?
  E69A    B7             C                  OR      A
  E69B    28 0C          C                  JR      Z,S9.CIN2
  E69D    3A B24A        C                  LD      A,(TS.BFOL1+1)      ;FBE  aktiv ?
  E6A0    B7             C                  OR      A
  E6A1    28 06          C                  JR      Z,S9.CIN2
  E6A3    E5             C                  PUSH    HL
  E6A4    E5             C                  PUSH    HL
  E6A5    E5             C                  PUSH    HL
  E6A6    C3 E799        C                  JP      S9.FBE1
                         C      
  E6A9    3A B263        C      S9.CIN2:    LD      A,(S2.CST)
  E6AC    B7             C                  OR      A
  E6AD    20 05          C                  JR      NZ,S9.CIN1
  E6AF    CD E6BF        C                  CALL    S9.CSTS1
  E6B2    18 FB          C                  JR      $-3
                         C      
  E6B4    AF             C      S9.CIN1:    XOR     A
  E6B5    32 B263        C                  LD      (S2.CST),A
  E6B8    CD EEB5        C                  CALL    S9.LOAD
  E6BB    3A B199        C                  LD      A,(MS.TK)
  E6BE    C9             C                  RET
                         C      
  E6BF    CD D23D        C      S9.CSTS1:   CALL    TA.ABFR
  E6C2    3E FF          C                  LD      A,-1
  E6C4    32 B263        C                  LD      (S2.CST),A
  E6C7    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*               Konsolstatus                                   *
                         C      ;****************************************************************
  E6C8    CD EE95        C      S9.CSTSX:   CALL    S9.SAVE
  E6CB    CD D143        C                  CALL    TA.TA1
  E6CE    20 07          C                  JR      NZ,S9.CSTS4
  E6D0    CD E6BF        C                  CALL    S9.CSTS1
  E6D3    18 02          C                  JR      S9.CSTS4
  E6D5    18 04          C                  JR      S9.CSTS5
                         C      
                         C      
  E6D7    AF             C      S9.CSTS4:   XOR     A
  E6D8    32 B263        C                  LD      (S2.CST),A
                         C      
  E6DB    CD EEB5        C      S9.CSTS5:   CALL    S9.LOAD
  E6DE    3A B263        C                  LD      A,(S2.CST)
  E6E1    B7             C                  OR      A
  E6E2    C9             C                  RET
                         C      
                         C                  TITLE   'Konsolenoutput'
                         C                  PAGE
'Konsolenoutput'	MACRO-80 3.44	09-Dec-81	PAGE	1-127


                         C      
                         C      ;****************************************************************
                         C      ;*               Ausgabe eines Zeichens auf Konsole             *
                         C      ;****************************************************************
  E6E3    CD EE95        C      S9.CON:     CALL    S9.SAVE
  E6E6    3E 07          C                  LD      A,7                 ;Cursor loeschen
  E6E8    32 B198        C                  LD      (MS.CMD),A
  E6EB    CD CB16        C                  CALL    MO.MONI
  E6EE    3E 14          C                  LD      A,20                ;Zeichen auf BWS
  E6F0    32 B198        C                  LD      (MS.CMD),A
  E6F3    79             C                  LD      A,C
  E6F4    FE 0D          C                  CP      00DH
  E6F6    28 14          C                  JR      Z,S9.CON9
  E6F8    FE 0A          C                  CP      00AH
  E6FA    28 08          C                  JR      Z,S9.CON1
  E6FC    32 B199        C                  LD      (MS.TK),A
  E6FF    CD CB16        C                  CALL    MO.MONI
  E702    18 08          C                  JR      S9.CON9
  E704    3E 17          C      S9.CON1:    LD      A,23                ;naechste Bildschirmzeile Anfang
  E706    32 B198        C                  LD      (MS.CMD),A
  E709    CD CB16        C                  CALL    MO.MONI
  E70C    3E 06          C      S9.CON9:    LD      A,6                 ;Cursor setzen
  E70E    32 B198        C                  LD      (MS.CMD),A
  E711    CD CB16        C                  CALL    MO.MONI
  E714    18 29          C                  JR      S9.CON09
                         C      
                         C      
                         C      
  E716    CD EE95        C      S9.CONOC:   CALL    S9.SAVE             ;Konsolenausgabe ohne Cursorberuecks.
  E719    3E 14          C                  LD      A,20                ;Zeichen auf BWS
  E71B    32 B198        C                  LD      (MS.CMD),A
  E71E    79             C                  LD      A,C
  E71F    FE 0D          C                  CP      00DH
  E721    28 1C          C                  JR      Z,S9.CON09
  E723    FE 0A          C                  CP      00AH
  E725    28 08          C                  JR      Z,S9.CON01
  E727    32 B199        C                  LD      (MS.TK),A
  E72A    CD CB16        C                  CALL    MO.MONI
  E72D    18 10          C                  JR      S9.CON09
  E72F    3E 07          C      S9.CON01:   LD      A,7
  E731    32 B198        C                  LD      (MS.CMD),A
  E734    CD CB16        C                  CALL    MO.MONI
  E737    3E 17          C                  LD      A,23                ;naechste Bildschirmzeile Anfang
  E739    32 B198        C                  LD      (MS.CMD),A
  E73C    CD CB16        C                  CALL    MO.MONI
  E73F    C3 ECF6        C      S9.CON09:   JP      S9.IOXE
                         C      
                         C                  TITLE   'Tastenroutinen'
                         C                  PAGE
'Tastenroutinen'	MACRO-80 3.44	09-Dec-81	PAGE	1-128


                         C      
                         C      ;****************************************************************
                         C      ;*            Kodeersetzungsroutinen                            *
                         C      ;****************************************************************
  E742    3E 7F          C      S9.CST1:    LD      A,07FH              ; <==
  E744    18 26          C                  JR      S9.CSTS2
                         C      
  E746    3E 18          C      S9.CST2:    LD      A,018H              ; SYS
  E748    18 22          C                  JR      S9.CSTS2
                         C      
  E74A    3E 15          C      S9.CST3:    LD      A,015H              ; DEL LINE
  E74C    18 1E          C                  JR      S9.CSTS2
                         C      
  E74E    3E 13          C      S9.CST4:    LD      A,013H              ; P01
  E750    18 1A          C                  JR      S9.CSTS2
                         C      
  E752    3E 11          C      S9.CST5:    LD      A,011H              ; P03
  E754    18 16          C                  JR      S9.CSTS2
                         C      
  E756    3E 12          C      S9.CST6:    LD      A,012H              ; P05
  E758    18 12          C                  JR      S9.CSTS2
                         C      
  E75A    3E 03          C      S9.CST7:    LD      A,003H              ; P07
  E75C    18 0E          C                  JR      S9.CSTS2
                         C      
  E75E    3E 0F          C      S9.CST8:    LD      A,00FH              ; P08
  E760    18 0A          C                  JR      S9.CSTS2
                         C      
  E762    3E 14          C      S9.CST9:    LD      A,014H              ; P09
  E764    18 06          C                  JR      S9.CSTS2
                         C      
  E766    3E 0D          C      S9.CST10:   LD      A,00DH              ; new line
  E768    18 02          C                  JR      S9.CSTS2
                         C      
  E76A    3E 1B          C      S9.CST11:   LD      A,01BH              ; naechste Zeile Anfang
                         C      
  E76C    32 B199        C      S9.CSTS2:   LD      (MS.TK),A
  E76F    D1             C                  POP     DE
  E770    C1             C                  POP     BC
  E771    E1             C                  POP     HL
  E772    23             C                  INC     HL
  E773    23             C                  INC     HL
  E774    E5             C                  PUSH    HL
  E775    C5             C                  PUSH    BC
  E776    D5             C                  PUSH    DE
  E777    C9             C                  RET
                         C      
  E778    32 B199        C      S9.CSTS3:   LD      (MS.TK),A           ;Routine  E I N A  mit Schnellschreiben
  E77B    3E 01          C                  LD      A,1
  E77D    32 B242        C                  LD      (TS.ZSMER),A
  E780    18 ED          C                  JR      S9.CSTS2+3
                         C      
  E782    3E 02          C      S9.HOME:    LD      A,2                 ;Bildfenster def. ZANZ-2 , SPANZ
  E784    32 B198        C                  LD      (MS.CMD),A
  E787    CD CB16        C                  CALL    MO.MONI
  E78A    3E 05          C                  LD      A,5                 ;Bildfenster loeschen
  E78C    32 B198        C                  LD      (MS.CMD),A
  E78F    CD CB16        C                  CALL    MO.MONI
  E792    21 0000        C                  LD      HL,0                ;ZPOS= 1 , SPOS= 1
  E795    22 B18C        C                  LD      (MS.ZPOS),HL
  E798    C9             C                  RET
                         C                  TITLE   'Freie Bildschirmeingabe'
                         C                  PAGE
'Freie Bildschirmeingabe'	MACRO-80 3.44	09-Dec-81	PAGE	1-129


                         C      
                         C      ;****************************************************************
                         C      ;*               freie Bildschirmeingabe                        *
                         C      ;****************************************************************
  E799    3A 01AB        C      S9.FBE1:    LD      A,(BC.D058)         ;P-Taste   P10
  E79C    B7             C                  OR      A                   ;AUTO aktiv ?
  E79D    28 24          C                  JR      Z,S9.FB1
                         C      
  E79F    3E 07          C                  LD      A,7                 ;ja ... Cursor loeschen
  E7A1    32 B198        C                  LD      (MS.CMD),A
  E7A4    CD C024        C                  CALL    S1.MO
  E7A7    21 B24A        C                  LD      HL,TS.BFOL1+1
  E7AA    3E 01          C                  LD      A,1
  E7AC    BE             C                  CP      (HL)                ;FBE schon aktiv ?
  E7AD    28 14          C                  JR      Z,S9.FB1
                         C      
  E7AF    77             C                  LD      (HL),A              ;nein, aktivieren
  E7B0    21 0105        C                  LD      HL,00105H           ;ZMIN = 5 , SMIN = 1
  E7B3    22 B18E        C                  LD      (MS.ZMIN),HL
  E7B6    25             C                  DEC     H                   ;ZPOS = 5 , SPOS = 1
  E7B7    2D             C                  DEC     L
  E7B8    22 B18C        C                  LD      (MS.ZPOS),HL
  E7BB    3E 05          C                  LD      A,5                 ;Bildfenster loeschen
  E7BD    32 B198        C                  LD      (MS.CMD),A
  E7C0    CD C024        C                  CALL    S1.MO
                         C      
                         C      
  E7C3    CD E7F9        C      S9.FB1:     CALL    S9.FBE
  E7C6    CD E8A6        C                  CALL    S9.DEL              ;Eingabebereich auf blank loeschen
  E7C9    3E 06          C                  LD      A,6                 ;Cursor setzen
  E7CB    32 B198        C                  LD      (MS.CMD),A
  E7CE    CD C024        C                  CALL    S1.MO
  E7D1    18 1B          C                  JR      S9.FBE13
                         C      
  E7D3    CD E7F9        C      S9.FBE2:    CALL    S9.FBE              ;P-Taste   P11
  E7D6    11 E840        C                  LD      DE,S9.POSQ1         ;Bereitstellen anderer BWS-Zeilen
  E7D9    21 0115        C                  LD      HL,00115H
  E7DC    22 B190        C      S9.FBE12:   LD      (MS.ZMAX),HL
  E7DF    EB             C                  EX      DE,HL               ;POS_QUIT
  E7E0    22 B223        C                  LD      (TS.TAB4),HL
                         C      
  E7E3    CD C021        C                  CALL    S1.TA+15            ;TA.TFE
  E7E6    CD C01E        C                  CALL    S1.TA+12            ;Tastatur - Abfrageschleife
  E7E9    18 FB          C                  JR      $-3
                         C      
  E7EB    CD E7F9        C      S9.FBE3:    CALL    S9.FBE              ;P-Taste   P12
  E7EE    CD E855        C      S9.FBE13:   CALL    S9.PQ2TL
  E7F1    11 EABD        C                  LD      DE,S9.POSQ2
  E7F4    21 5004        C                  LD      HL,05004H
  E7F7    18 E3          C                  JR      S9.FBE12
                         C      
                         C                  PAGE
'Freie Bildschirmeingabe'	MACRO-80 3.44	09-Dec-81	PAGE	1-130


                         C      
  E7F9    CD F638        C      S9.FBE:     CALL    S0.BWSZU            ;BWS zuschalten
  E7FC    21 0000        C                  LD      HL,0                ;Routine BWSAB := Routine BWSZU
  E7FF    22 B2D4        C                  LD      (S2.STACK),HL
  E802    21 B18A        C                  LD      HL,MS.ZPOL          ;Monitorsteuervektor retten
  E805    11 3780        C                  LD      DE,S0.BWS+1920
  E808    01 0015        C                  LD      BC,TS.TAB1-MS.ZPOL
  E80B    ED B0          C                  LDIR
  E80D    21 0000        C      S9.FBE0:    LD      HL,0                ;Monitorsteuervektor neu belegen
  E810    22 B18C        C                  LD      (MS.ZPOS),HL
  E813    24             C                  INC     H
  E814    2C             C                  INC     L
  E815    22 B18E        C                  LD      (MS.ZMIN),HL
  E818    3E C8          C                  LD      A,11001000B
  E81A    32 B197        C                  LD      (MS.DIRES),A
  E81D    21 3000        C                  LD      HL,S0.BWS
  E820    22 B194        C                  LD      (MS.BWSA),HL
  E823    CD C01B        C                  CALL    S1.TA+9             ;Tastaturaktivierung
  E826    21 0000        C                  LD      HL,0                ;SYS-Taste loeschen
  E829    22 B21D        C                  LD      (TS.TAB3+6),HL
  E82C    21 EB20        C                  LD      HL,S9.NEGQ          ;NEG_QUIT
  E82F    22 B21B        C                  LD      (TS.TAB3+4),HL
  E832    3E FF          C                  LD      A,-1
  E834    32 B23F        C                  LD      (TS.SPMER),A
  E837    3E 06          C                  LD      A,6                 ;Cursor setzen
  E839    32 B198        C                  LD      (MS.CMD),A
  E83C    CD C024        C                  CALL    S1.MO
  E83F    C9             C                  RET
                         C      
                         C                  PAGE
'Freie Bildschirmeingabe'	MACRO-80 3.44	09-Dec-81	PAGE	1-131


                         C      
  E840    CD E9DD        C      S9.POSQ1:   CALL    S9.UP1              ;zu korrigierende Zeilen im
  E843    EB             C                  EX      DE,HL               ;Eingabebereich bereitstellen
  E844    11 3000        C                  LD      DE,S0.BWS
  E847    01 0140        C                  LD      BC,320
  E84A    ED B0          C                  LDIR
  E84C    21 5004        C                  LD      HL,05004H
  E84F    22 B190        C                  LD      (MS.ZMAX),HL
  E852    CD E80D        C                  CALL    S9.FBE0
                         C      
  E855    21 E9E7        C      S9.PQ2TL:   LD      HL,S9.TPF1
  E858    11 B19F        C                  LD      DE,TS.TAB1
  E85B    01 0018        C                  LD      BC,S9.TX1-S9.TPF1
  E85E    ED B0          C                  LDIR
  E860    21 EABD        C                  LD      HL,S9.POSQ2
  E863    22 B223        C                  LD      (TS.TAB4),HL
  E866    21 E884        C                  LD      HL,S9.INSM
  E869    22 B1FF        C                  LD      (TS.TAB2),HL
  E86C    21 E8A6        C                  LD      HL,S9.DEL
  E86F    22 B201        C                  LD      (TS.TAB2+2),HL
  E872    21 E8C2        C                  LD      HL,S9.SCHL
  E875    22 B207        C                  LD      (TS.TAB2+8),HL
  E878    21 E8DD        C                  LD      HL,S9.SCHR
  E87B    22 B20B        C                  LD      (TS.TAB2+12),HL
  E87E    21 C328        C                  LD      HL,S1.AEIN
  E881    22 B231        C                  LD      (TS.NEWL),HL
  E884    3A B240        C      S9.INSM:    LD      A,(TS.UMERK)
  E887    B7             C                  OR      A
  E888    20 05          C                  JR      NZ,S9.TL1
  E88A    21 E896        C                  LD      HL,S9.EIN1
  E88D    18 03          C                  JR      S9.TL2
  E88F    21 E89F        C      S9.TL1:     LD      HL,S9.EIN2
  E892    22 B22D        C      S9.TL2:     LD      (TS.EINA),HL
  E895    C9             C                  RET
                         C      
  E896    CD C328        C      S9.EIN1:    CALL    S1.AEIN
  E899    3E 01          C      S9.ZS:      LD      A,1
  E89B    32 B242        C                  LD      (TS.ZSMER),A
  E89E    C9             C                  RET
                         C      
  E89F    F5             C      S9.EIN2:    PUSH    AF
  E8A0    CD E8DD        C                  CALL    S9.SCHR
  E8A3    F1             C                  POP     AF
  E8A4    18 F0          C                  JR      S9.EIN1
                         C      
                         C                  PAGE
'Freie Bildschirmeingabe'	MACRO-80 3.44	09-Dec-81	PAGE	1-132


                         C      
  E8A6    21 3000        C      S9.DEL:     LD      HL,S0.BWS
  E8A9    11 3001        C                  LD      DE,S0.BWS+1
  E8AC    01 00FE        C                  LD      BC,254
  E8AF    36 20          C                  LD      (HL),' '
  E8B1    ED B0          C                  LDIR
  E8B3    EB             C                  EX      DE,HL
  E8B4    36 7C          C                  LD      (HL),'|'
  E8B6    23             C                  INC     HL
  E8B7    36 3D          C                  LD      (HL),'='
  E8B9    E5             C                  PUSH    HL
  E8BA    D1             C                  POP     DE
  E8BB    13             C                  INC     DE
  E8BC    01 003F        C                  LD      BC,63
  E8BF    ED B0          C                  LDIR
  E8C1    C9             C                  RET
                         C      
  E8C2    CD E9DD        C      S9.SCHL:    CALL    S9.UP1
  E8C5    21 30FD        C                  LD      HL,S0.BWS+253
  E8C8    B7             C                  OR      A
  E8C9    ED 52          C                  SBC     HL,DE
  E8CB    C8             C                  RET     Z
  E8CC    E5             C                  PUSH    HL
  E8CD    C1             C                  POP     BC
  E8CE    CD E9DD        C                  CALL    S9.UP1
  E8D1    D5             C                  PUSH    DE
  E8D2    E1             C                  POP     HL
  E8D3    23             C                  INC     HL
  E8D4    ED B0          C                  LDIR
  E8D6    3E 20          C                  LD      A,' '
  E8D8    32 30FE        C                  LD      (S0.BWS+254),A
  E8DB    18 BC          C      S9.ZS1:     JR      S9.ZS
                         C      
  E8DD    CD E9DD        C      S9.SCHR:    CALL    S9.UP1
  E8E0    21 30FE        C                  LD      HL,S0.BWS+254
  E8E3    B7             C                  OR      A
  E8E4    ED 52          C                  SBC     HL,DE
  E8E6    C8             C                  RET     Z
  E8E7    E5             C                  PUSH    HL
  E8E8    C1             C                  POP     BC
  E8E9    21 30FD        C                  LD      HL,S0.BWS+253
  E8EC    11 30FE        C                  LD      DE,S0.BWS+254
  E8EF    ED B8          C                  LDDR
  E8F1    CD E9DD        C                  CALL    S9.UP1
  E8F4    EB             C                  EX      DE,HL
  E8F5    36 20          C                  LD      (HL),' '
  E8F7    18 E2          C                  JR      S9.ZS1
                         C      
                         C                  PAGE
'Freie Bildschirmeingabe'	MACRO-80 3.44	09-Dec-81	PAGE	1-133


                         C      
  E8F9    CD E9DD        C      S9.PF1:     CALL    S9.UP1              ;SY$="...":ER$="..."
  E8FC    21 E9FF        C                  LD      HL,S9.TX1
  E8FF    01 0034        C                  LD      BC,S9.TX2-S9.TX1
  E902    ED B0          C                  LDIR
  E904    EB             C      S9.PF101:   EX      DE,HL
  E905    3E 0A          C                  LD      A,10
  E907    32 B198        C                  LD      (MS.CMD),A
  E90A    CD C024        C                  CALL    S1.MO
  E90D    C9             C                  RET
                         C      
  E90E    CD E9DD        C      S9.PF2:     CALL    S9.UP1              ;NEW.1_
  E911    21 EA8F        C                  LD      HL,S9.TXT16
  E914    01 0006        C                  LD      BC,S9.TXT17-S9.TXT16
  E917    ED B0          C                  LDIR
  E919    18 E9          C      S9.PF102:   JR      S9.PF101
                         C      
  E91B    CD E9DD        C      S9.PF3:     CALL    S9.UP1              ;RUN
  E91E    21 EA8B        C                  LD      HL,S9.TXT15
  E921    01 0004        C                  LD      BC,S9.TXT16-S9.TXT15
  E924    ED B0          C                  LDIR
  E926    18 F1          C      S9.PF103:   JR      S9.PF102
                         C      
  E928    CD E9DD        C      S9.PF4:     CALL    S9.UP1              ;OPEN MRES INPUT
  E92B    21 EA33        C                  LD      HL,S9.TX2
  E92E    01 0010        C                  LD      BC,S9.TXT3-S9.TX2
  E931    ED B0          C                  LDIR
  E933    21 EA53        C                  LD      HL,S9.TXT4
  E936    01 0005        C                  LD      BC,S9.TXT5-S9.TXT4
  E939    ED B0          C                  LDIR
  E93B    21 EA58        C                  LD      HL,S9.TXT5
  E93E    01 0005        C                  LD      BC,S9.TXT6-S9.TXT5
  E941    ED B0          C                  LDIR
  E943    18 E1          C      S9.PF104:   JR      S9.PF103
                         C      
  E945    CD E9DD        C      S9.PF5:     CALL    S9.UP1              ;OPEN MRES OUTPUT
  E948    21 EA33        C                  LD      HL,S9.TX2
  E94B    01 0010        C                  LD      BC,S9.TXT3-S9.TX2
  E94E    ED B0          C                  LDIR
  E950    21 EA53        C                  LD      HL,S9.TXT4
  E953    01 0005        C                  LD      BC,S9.TXT5-S9.TXT4
  E956    ED B0          C                  LDIR
  E958    21 EA5D        C                  LD      HL,S9.TXT6
  E95B    01 0005        C                  LD      BC,S9.TXT7-S9.TXT6
  E95E    ED B0          C                  LDIR
  E960    18 E1          C      S9.PF105:   JR      S9.PF104
                         C      
  E962    CD E9DD        C      S9.PF6:     CALL    S9.UP1              ;CLOSE MRES OUTPUT
  E965    21 EA53        C                  LD      HL,S9.TXT4
  E968    01 0005        C                  LD      BC,S9.TXT5-S9.TXT4
  E96B    ED B0          C                  LDIR
  E96D    21 EA62        C                  LD      HL,S9.TXT7
  E970    01 0003        C                  LD      BC,S9.TXT8-S9.TXT7
  E973    ED B0          C                  LDIR
  E975    18 E9          C      S9.PF106:   JR      S9.PF105
                         C      
  E977    CD E9DD        C      S9.PF7:     CALL    S9.UP1              ;OPEN INPUT
  E97A    21 EA33        C                  LD      HL,S9.TX2
  E97D    01 0025        C                  LD      BC,S9.TXT5-S9.TX2
  E980    ED B0          C                  LDIR
  E982    21 EA65        C                  LD      HL,S9.TXT8
  E985    01 000A        C                  LD      BC,S9.TXT10-S9.TXT8
  E988    ED B0          C                  LDIR
  E98A    18 E9          C      S9.PF107:   JR      S9.PF106
                         C      
  E98C    CD E9DD        C      S9.PF8:     CALL    S9.UP1              ;OPEN OUTPUT
  E98F    21 EA33        C                  LD      HL,S9.TX2
  E992    01 0025        C                  LD      BC,S9.TXT5-S9.TX2
  E995    ED B0          C                  LDIR
  E997    21 EA65        C                  LD      HL,S9.TXT8
  E99A    01 0006        C                  LD      BC,S9.TXT9-S9.TXT8
  E99D    ED B0          C                  LDIR
  E99F    21 EA6F        C                  LD      HL,S9.TXT10
  E9A2    01 0004        C                  LD      BC,S9.TXT11-S9.TXT10
  E9A5    ED B0          C                  LDIR
  E9A7    18 E1          C      S9.PF108:   JR      S9.PF107
                         C      
  E9A9    CD E9DD        C      S9.PF9:     CALL    S9.UP1              ;.SVC0,2:SVC0,5,1,1:LIST
  E9AC    21 EA95        C                  LD      HL,S9.TXT17
  E9AF    01 0028        C                  LD      BC,S9.TXT18-S9.TXT17
  E9B2    ED B0          C                  LDIR
  E9B4    18 F1          C      S9.PF109:   JR      S9.PF108
'Freie Bildschirmeingabe'	MACRO-80 3.44	09-Dec-81	PAGE	1-134


                         C      
  E9B6    CD E9DD        C      S9.PF10:    CALL    S9.UP1              ;LOADA
  E9B9    21 EA77        C                  LD      HL,S9.TXT12
  E9BC    01 0006        C                  LD      BC,S9.TXT13-S9.TXT12
  E9BF    ED B0          C                  LDIR
  E9C1    18 F1          C      S9.PF110:   JR      S9.PF109
                         C      
  E9C3    CD E9DD        C      S9.PF11:    CALL    S9.UP1              ;LOADGOA
  E9C6    21 EA7D        C                  LD      HL,S9.TXT13
  E9C9    01 0008        C                  LD      BC,S9.TXT14-S9.TXT13
  E9CC    ED B0          C                  LDIR
  E9CE    18 F1          C      S9.PF111:   JR      S9.PF110
                         C      
  E9D0    CD E9DD        C      S9.PF12:    CALL    S9.UP1              ;SAVEA
  E9D3    21 EA85        C                  LD      HL,S9.TXT14
  E9D6    01 0006        C                  LD      BC,S9.TXT15-S9.TXT14
  E9D9    ED B0          C                  LDIR
  E9DB    18 F1          C      S9.PF112:   JR      S9.PF111
                         C      
                         C                  PAGE
'Freie Bildschirmeingabe'	MACRO-80 3.44	09-Dec-81	PAGE	1-135


                         C      
  E9DD    3E 0B          C      S9.UP1:     LD      A,11
  E9DF    32 B198        C                  LD      (MS.CMD),A
  E9E2    CD C024        C                  CALL    S1.MO
  E9E5    EB             C                  EX      DE,HL
  E9E6    C9             C                  RET
                         C      
  E9E7    E8F9           C      S9.TPF1:    DW      S9.PF1
  E9E9    E90E           C                  DW      S9.PF2
  E9EB    E91B           C                  DW      S9.PF3
  E9ED    E928           C                  DW      S9.PF4
  E9EF    E945           C                  DW      S9.PF5
  E9F1    E962           C                  DW      S9.PF6
  E9F3    E977           C                  DW      S9.PF7
  E9F5    E98C           C                  DW      S9.PF8
  E9F7    E9A9           C                  DW      S9.PF9
  E9F9    E9B6           C                  DW      S9.PF10
  E9FB    E9C3           C                  DW      S9.PF11
  E9FD    E9D0           C                  DW      S9.PF12
                         C      
  E9FF    53 59 24 3D    C      S9.TX1:     DB      'SY$="INHALTBL               ":ER$="11   G C010C010":'
  EA03    22 49 4E 48    C      
  EA07    41 4C 54 42    C      
  EA0B    4C 20 20 20    C      
  EA0F    20 20 20 20    C      
  EA13    20 20 20 20    C      
  EA17    20 20 20 20    C      
  EA1B    22 3A 45 52    C      
  EA1F    24 3D 22 31    C      
  EA23    31 20 20 20    C      
  EA27    47 20 43 30    C      
  EA2B    31 30 43 30    C      
  EA2F    31 30 22 3A    C      
  EA33    49 4E 50 55    C      S9.TX2:     DB      'INPUT"Geraet";G:'
  EA37    54 22 47 65    C      
  EA3B    72 61 65 74    C      
  EA3F    22 3B 47 3A    C      
  EA43    49 4E 50 55    C      S9.TXT3:    DB      'INPUT"Label ";L:'
  EA47    54 22 4C 61    C      
  EA4B    62 65 6C 20    C      
  EA4F    22 3B 4C 3A    C      
  EA53    53 56 43 30    C      S9.TXT4:    DB      'SVC0,'
  EA57    2C             C      
  EA58    32 32 2C 47    C      S9.TXT5:    DB      '22,G:'
  EA5C    3A             C      
  EA5D    32 33 2C 47    C      S9.TXT6:    DB      '23,G:'
  EA61    3A             C      
  EA62    33 31 3A       C      S9.TXT7:    DB      '31:'
  EA65    32 30 2C 47    C      S9.TXT8:    DB      '20,G,7'
  EA69    2C 37          C      
  EA6B    33 2C 4C 3A    C      S9.TXT9:    DB      '3,L:'
  EA6F    39 2C 4C 3A    C      S9.TXT10:   DB      '9,L:'
  EA73    32 39 2C 37    C      S9.TXT11:   DB      '29,7'
  EA77    4C 4F 41 44    C      S9.TXT12:   DB      'LOADA:'
  EA7B    41 3A          C      
  EA7D    4C 4F 41 44    C      S9.TXT13:   DB      'LOADGOA:'
  EA81    47 4F 41 3A    C      
  EA85    53 41 56 45    C      S9.TXT14:   DB      'SAVEA:'
  EA89    41 3A          C      
  EA8B    1E             C      S9.TXT15:   DB      01EH
  EA8C    52 55 4E       C                  DB      'RUN'
  EA8F    4E 45 57       C      S9.TXT16:   DB      'NEW'
  EA92    1E             C                  DB      01EH
  EA93    31 20          C                  DB      '1 '
  EA95    1E             C      S9.TXT17:   DB      01EH
  EA96    53 56 43 30    C                  DB      'SVC0,7,1,22,1,80:SVC0,2:SVC0,5,1,1:LIST'
  EA9A    2C 37 2C 31    C      
  EA9E    2C 32 32 2C    C      
  EAA2    31 2C 38 30    C      
  EAA6    3A 53 56 43    C      
  EAAA    30 2C 32 3A    C      
  EAAE    53 56 43 30    C      
  EAB2    2C 35 2C 31    C      
  EAB6    2C 31 3A 4C    C      
  EABA    49 53 54       C      
  EABD                   C      S9.TXT18    EQU     $
                         C      
                         C                  PAGE
'Freie Bildschirmeingabe'	MACRO-80 3.44	09-Dec-81	PAGE	1-136


                         C      
                         C      ;****************************************************************
                         C      ;*               Tastenroutine      P O S _ Q U I T             *
                         C      ;****************************************************************
  EABD    21 A000        C      S9.POSQ2:   LD      HL,S0.BWSA          ;BWSA  <===>  BWS   4 Zeilen
  EAC0    11 3000        C                  LD      DE,S0.BWS
  EAC3    01 0140        C                  LD      BC,320
  EAC6    C5             C      S9.POS1:    PUSH    BC
  EAC7    46             C                  LD      B,(HL)
  EAC8    EB             C                  EX      DE,HL
  EAC9    4E             C                  LD      C,(HL)
  EACA    70             C                  LD      (HL),B
  EACB    EB             C                  EX      DE,HL
  EACC    71             C                  LD      (HL),C
  EACD    23             C                  INC     HL
  EACE    13             C                  INC     DE
  EACF    C1             C                  POP     BC
  EAD0    0B             C                  DEC     BC
  EAD1    78             C                  LD      A,B
  EAD2    B1             C                  OR      C
  EAD3    20 F1          C                  JR      NZ,S9.POS1
                         C      
  EAD5    CD F63C        C                  CALL    S0.BWSAB
  EAD8    AF             C                  XOR     A                   ;CSTSX - Routine ausschalten
  EAD9    21 C9AF        C                  LD      HL,0C9AFH           ;???
  EADC    32 0318        C                  LD      (BC.CSTSX),A
  EADF    22 0319        C                  LD      (BC.CSTSX+1),HL
  EAE2    3D             C                  DEC     A
  EAE3    32 B247        C                  LD      (TS.MIO),A
  EAE6    21 EB4C        C                  LD      HL,S9.CCIN          ;CIN   - Routine umschalten
  EAE9    22 030A        C                  LD      (BC.CIN+1),HL
  EAEC    3A 01AB        C                  LD      A,(BC.D058)         ;AUTO aktiv ?
  EAEF    B7             C                  OR      A
  EAF0    28 06          C                  JR      Z,S9.POS4
  EAF2    3A B24A        C                  LD      A,(TS.BFOL1+1)      ;FBE bei AUTO aktiv ?
  EAF5    B7             C                  OR      A
  EAF6    20 06          C                  JR      NZ,S9.POS5
  EAF8    21 ECF9        C      S9.POS4:    LD      HL,S9.IOX           ;CON   - Routine ausschalten
  EAFB    22 0310        C                  LD      (BC.CON+1),HL
  EAFE    21 A000        C      S9.POS5:    LD      HL,S0.BWSA          ;MIO             einschalten
  EB01    22 B24B        C                  LD      (TS.BFOL2),HL
  EB04    01 00FE        C                  LD      BC,254
  EB07    09             C                  ADD     HL,BC
  EB08    3E 20          C                  LD      A,' '
  EB0A    0C             C                  INC     C
  EB0B    BE             C      S9.POS2:    CP      (HL)
  EB0C    20 08          C                  JR      NZ,S9.POS3
  EB0E    2B             C                  DEC     HL
  EB0F    0D             C                  DEC     C
  EB10    20 F9          C                  JR      NZ,S9.POS2
  EB12    AF             C                  XOR     A                   ;FBE bei AUTO entaktivieren
  EB13    32 B24A        C                  LD      (TS.BFOL1+1),A
  EB16    79             C      S9.POS3:    LD      A,C
  EB17    3C             C                  INC     A
  EB18    32 B249        C                  LD      (TS.BFOL1),A
  EB1B    CD F638        C                  CALL    S0.BWSZU
  EB1E    18 0B          C                  JR      S9.NEG1
                         C      
                         C                  PAGE
'Freie Bildschirmeingabe'	MACRO-80 3.44	09-Dec-81	PAGE	1-137


                         C      
                         C      ;****************************************************************
                         C      ;*               Tastenroutine      N E G _ Q U I T             *
                         C      ;****************************************************************
  EB20    21 A000        C      S9.NEGQ:    LD      HL,S0.BWSA          ;BWS  wiederherstellen
  EB23    11 3000        C                  LD      DE,S0.BWS
  EB26    01 0140        C                  LD      BC,320
  EB29    ED B0          C                  LDIR
  EB2B    21 3780        C      S9.NEG1:    LD      HL,S0.BWS+1920      ;Monitorsteuervektor wiederherstellen
  EB2E    11 B18A        C                  LD      DE,MS.ZPOL
  EB31    01 0015        C                  LD      BC,TS.TAB1-MS.ZPOL
  EB34    ED B0          C                  LDIR
  EB36    2A F636        C                  LD      HL,(S0.BWSB)        ;Routine BWSAB aktivieren
  EB39    22 B2D4        C                  LD      (S2.STACK),HL
  EB3C    CD B2D4        C                  CALL    S2.STACK
  EB3F    CD E510        C                  CALL    S9.TALOE
  EB42    E1             C                  POP     HL
  EB43    E1             C                  POP     HL
                         C      
  EB44    E1             C                  POP     HL
  EB45    E1             C                  POP     HL
  EB46    E1             C                  POP     HL
  EB47    3E FF          C                  LD      A,-1
  EB49    C3 E6D7        C                  JP      S9.CSTS4
                         C      ;****************************************************************
                         C      ;*               C I N       - Routine                          *
                         C      ;****************************************************************
  EB4C    CD EE95        C      S9.CCIN:    CALL    S9.SAVE
                         C      
  EB4F    CD E6BF        C                  CALL    S9.CSTS1
  EB52    18 FB          C                  JR      $-3
                         C      
  EB54    21 B249        C      S9.CCIN1:   LD      HL,TS.BFOL1
  EB57    35             C                  DEC     (HL)
  EB58    20 23          C                  JR      NZ,S9.CCIN2
                         C      
  EB5A    CD F626        C                  CALL    S0.BWSU1
  EB5D    3E C3          C                  LD      A,0C3H              ;CSTSX - Routine einschalten
  EB5F    21 E6C8        C                  LD      HL,S9.CSTSX
  EB62    32 0318        C                  LD      (BC.CSTSX),A
  EB65    22 0319        C                  LD      (BC.CSTSX+1),HL
  EB68    21 E694        C                  LD      HL,S9.CIN           ;CIN   - Routine umschalten
  EB6B    22 030A        C                  LD      (BC.CIN+1),HL
  EB6E    21 E6E3        C                  LD      HL,S9.CON           ;CON   - Routine einschalten
  EB71    22 0310        C                  LD      (BC.CON+1),HL
  EB74    AF             C                  XOR     A                   ;MIO             ausschalten
  EB75    32 B247        C                  LD      (TS.MIO),A
  EB78    3E 0D          C                  LD      A,00DH
  EB7A    32 B199        C                  LD      (MS.TK),A
                         C      
  EB7D    C3 E6B4        C      S9.CCIN2:   JP      S9.CIN1
                         C      
                         C                  TITLE   'Eingabe eines Zeichens'
                         C                  PAGE
'Eingabe eines Zeichens'	MACRO-80 3.44	09-Dec-81	PAGE	1-138


                         C      
                         C      ;****************************************************************
                         C      ;*               Eingabe eines Zeichens                         *
                         C      ;****************************************************************
  EB80    CD EE95        C      S9.RIV:     CALL    S9.SAVE
  EB83    3A B25F        C                  LD      A,(S2.IM)
  EB86    B7             C                  OR      A
  EB87    20 09          C                  JR      NZ,S9.RIV2
  EB89    21 EBF5        C      S9.RIVF:    LD      HL,S9.TXT1          ;Fehleranzeige
  EB8C    11 E43F        C      S9.RIV1:    LD      DE,S9.BSCR
  EB8F    C3 C4F4        C                  JP      S1.FEHR
                         C      
  EB92    CD F05E        C      S9.RIV2:    CALL    S9.RGLI
  EB95    CD EBBE        C      S9.RIV4:    CALL    S9.LESV
  EB98    CD B422        C                  CALL    0B422H              ;Eingabe-Kodetransformation
  EB9B    4F             C                  LD      C,A
  EB9C    21 B41E        C                  LD      HL,0B41EH
  EB9F    7E             C                  LD      A,(HL)
  EBA0    B7             C                  OR      A
  EBA1    79             C                  LD      A,C
  EBA2    28 10          C                  JR      Z,S9.RIV6
  EBA4    23             C                  INC     HL
  EBA5    BE             C                  CP      (HL)
  EBA6    20 04          C                  JR      NZ,S9.RIV5
  EBA8    3E 0D          C                  LD      A,00DH
  EBAA    18 08          C                  JR      S9.RIV6
  EBAC    FE 20          C      S9.RIV5:    CP      ' '
  EBAE    38 E5          C                  JR      C,S9.RIV4
  EBB0    FE 7F          C                  CP      07FH
  EBB2    30 E1          C                  JR      NC,S9.RIV4
  EBB4    32 B23C        C      S9.RIV6:    LD      (TS.TK),A
  EBB7    CD EEB5        C      S9.RIV9:    CALL    S9.LOAD
  EBBA    3A B23C        C                  LD      A,(TS.TK)
  EBBD    C9             C                  RET
                         C      
                         C                  PAGE
'Eingabe eines Zeichens'	MACRO-80 3.44	09-Dec-81	PAGE	1-139


                         C      
  EBBE    CD D60B        C      S9.LESV:    CALL    K1.BM
  EBC1    28 04          C                  JR      Z,S9.BM2
  EBC3    CD DB8E        C      S9.BM1:     CALL    K1.LESV
  EBC6    C9             C                  RET
                         C      
  EBC7    21 BBDF        C      S9.BM2:     LD      HL,S0.PFFI+400H-1
  EBCA    ED 5B B259     C                  LD      DE,(S2.POIE)
  EBCE    B7             C                  OR      A
  EBCF    ED 52          C                  SBC     HL,DE
  EBD1    28 06          C                  JR      Z,S9.BM3
  EBD3    F2 EBC3        C                  JP      P,S9.BM1
  EBD6    3E 0D          C                  LD      A,00DH              ;Pufferende ueberschritten
  EBD8    C9             C                  RET
                         C      
  EBD9    CD D7BD        C      S9.BM3:     CALL    K1.GNRM             ;letztes Byte der Datei erreicht
  EBDC    CD D6EE        C                  CALL    K1.GNSTS
  EBDF    3E 32          C                  LD      A,'2'               ;Byte 7 der Variablen ER$  =  2
  EBE1    CD EE86        C                  CALL    S9.ERS
  EBE4    21 BBE1        C      S9.BM4:     LD      HL,S0.PFFI+401H     ;Pointer hinter Puffer setzen
  EBE7    22 B259        C                  LD      (S2.POIE),HL
  EBEA    AF             C                  XOR     A                   ;Satzlaenge in E/A-Tabelle := 0
  EBEB    DD 77 09       C                  LD      (IX+9),A
  EBEE    DD 77 0A       C                  LD      (IX+10),A
  EBF1    3A BBDF        C                  LD      A,(S0.PFFI+3FFH)    ;letztes Byte aus der Datei
  EBF4    C9             C                  RET
                         C      
  EBF5    45 73 20 77    C      S9.TXT1:    DB      'Es wurde keine Eingabedatei eroeffnet '
  EBF9    75 72 64 65    C      
  EBFD    20 6B 65 69    C      
  EC01    6E 65 20 45    C      
  EC05    69 6E 67 61    C      
  EC09    62 65 64 61    C      
  EC0D    74 65 69 20    C      
  EC11    65 72 6F 65    C      
  EC15    66 66 6E 65    C      
  EC19    74 20          C      
                         C      
                         C                  TITLE   'Ausgabe eines Zeichens'
                         C                  PAGE
'Ausgabe eines Zeichens'	MACRO-80 3.44	09-Dec-81	PAGE	1-140


                         C      
                         C      ;*               Ausgabe eines Zeichens                         *
                         C      ;****************************************************************
  EC1B    CD EE95        C      S9.WRTV:    CALL    S9.SAVE
  EC1E    3A B260        C                  LD      A,(S2.OM)
  EC21    B7             C                  OR      A
  EC22    20 06          C                  JR      NZ,S9.WRTV2
  EC24    21 EC47        C      S9.WRTVF:   LD      HL,S9.TXT2          ;Fehleranzeige
  EC27    C3 EB8C        C                  JP      S9.RIV1
                         C      
  EC2A    CD F06E        C      S9.WRTV2:   CALL    S9.RGLO
  EC2D    21 B420        C                  LD      HL,0B420H
  EC30    7E             C                  LD      A,(HL)
  EC31    B7             C                  OR      A
  EC32    79             C                  LD      A,C
  EC33    28 0A          C                  JR      Z,S9.WRTV6
  EC35    23             C                  INC     HL
  EC36    FE 0A          C                  CP      00AH
  EC38    28 0B          C                  JR      Z,S9.WRTV9
  EC3A    FE 0D          C                  CP      00DH
  EC3C    20 01          C                  JR      NZ,S9.WRTV6
  EC3E    7E             C      S9.WRTV5:   LD      A,(HL)
  EC3F    CD B425        C      S9.WRTV6:   CALL    0B425H              ;Ausgabe-Kodetransformation
  EC42    CD DBAB        C                  CALL    K1.SCHR
                         C      
  EC45    18 37          C      S9.WRTV9:   JR      S9.STX9
                         C      
  EC47    45 73 20 77    C      S9.TXT2:    DB      'Es wurde keine Ausgabedatei eroeffnet '
  EC4B    75 72 64 65    C      
  EC4F    20 6B 65 69    C      
  EC53    6E 65 20 41    C      
  EC57    75 73 67 61    C      
  EC5B    62 65 64 61    C      
  EC5F    74 65 69 20    C      
  EC63    65 72 6F 65    C      
  EC67    66 66 6E 65    C      
  EC6B    74 20          C      
                         C      
                         C      ;****************************************************************
                         C      ;*                Druckroutine                                  *
                         C      ;****************************************************************
  EC6D    CD EE95        C      S9.LISTX:   CALL    S9.SAVE
  EC70    79             C                  LD      A,C
  EC71    FE 0D          C                  CP      00DH
  EC73    28 09          C                  JR      Z,S9.STX9
  EC75    FE 0A          C                  CP      00AH
  EC77    20 02          C                  JR      NZ,S9.STX2
  EC79    0E 1E          C                  LD      C,01EH              ;Ausgabe Zeilenendezeichen
  EC7B    CD F59C        C      S9.STX2:    CALL    SM.PRIO             ;Zeichen auf Drucker ausgeben
  EC7E    18 76          C      S9.STX9:    JR      S9.IOXE
                         C      
  EC80    CD EE95        C      S9.LISTY:   CALL    S9.SAVE
  EC83    79             C                  LD      A,C
  EC84    FE 0D          C                  CP      00DH
  EC86    28 F6          C                  JR      Z,S9.STX9
  EC88    FE 0A          C                  CP      00AH
  EC8A    28 F2          C                  JR      Z,S9.STX9
  EC8C    18 ED          C                  JR      S9.STX2
                         C      
                         C                  TITLE   'SWITCH - Routine'
                         C                  PAGE
'SWITCH - Routine'	MACRO-80 3.44	09-Dec-81	PAGE	1-141


                         C      
                         C      ;****************************************************************
                         C      ;*               S W I T C H   -   Routine                      *
                         C      ;****************************************************************
  EC8E    CD EE95        C      S9.IOSTX:   CALL    S9.SAVE
  EC91    F5             C                  PUSH    AF
  EC92    3A B264        C                  LD      A,(S2.IOC)
  EC95    FE 01          C                  CP      1
  EC97    28 33          C                  JR      Z,S9.IOX10
  EC99    F1             C                  POP     AF
  EC9A    FE 01          C                  CP      1                   ;Eingabe von Kassette
  EC9C    28 10          C                  JR      Z,S9.IOX1
  EC9E    FE 02          C                  CP      2                   ;Ausgabe auf Kassette
  ECA0    28 14          C                  JR      Z,S9.IOX2
  ECA2    FE 03          C                  CP      3                   ;Ausgabe auf Drucker
  ECA4    28 18          C                  JR      Z,S9.IOX3
  ECA6    21 E694        C      S9.IOX0:    LD      HL,S9.CIN           ;Eingabe Tastatur / Ausgabe Bildschirm
  ECA9    01 E6E3        C                  LD      BC,S9.CON
  ECAC    18 15          C                  JR      S9.IOX8
  ECAE    21 EB80        C      S9.IOX1:    LD      HL,S9.RIV
  ECB1    01 ECF9        C                  LD      BC,S9.IOX
  ECB4    18 0D          C                  JR      S9.IOX8
  ECB6    21 ECF9        C      S9.IOX2:    LD      HL,S9.IOX
  ECB9    01 EC1B        C                  LD      BC,S9.WRTV
  ECBC    18 05          C                  JR      S9.IOX8
  ECBE    01 EC6D        C      S9.IOX3:    LD      BC,S9.LISTX
  ECC1    18 03          C                  JR      S9.IOX9
  ECC3    22 030A        C      S9.IOX8:    LD      (BC.CIN+1),HL
  ECC6    ED 43 0310     C      S9.IOX9:    LD      (BC.CON+1),BC
  ECCA    18 2A          C      S9.IOX90:   JR      S9.IOXE
                         C      
  ECCC    F1             C      S9.IOX10:   POP     AF
  ECCD    FE 01          C                  CP      1                   ;Eingabe/Ausgabe ueber IOCS
  ECCF    28 10          C                  JR      Z,S9.IOX11
  ECD1    FE 02          C                  CP      2                   ;Eingabe/Ausgabe auf   HS-Erweiterung
  ECD3    28 14          C                  JR      Z,S9.IOX12
  ECD5    FE 03          C                  CP      3                   ;Ausgabe auf Drucker
  ECD7    28 18          C                  JR      Z,S9.IOX13
  ECD9    21 E694        C                  LD      HL,S9.CIN           ;Eingabe Tastatur / Ausgabe Bildschirm
  ECDC    01 E6E3        C                  LD      BC,S9.CON
  ECDF    18 E2          C                  JR      S9.IOX8
  ECE1    21 ECF9        C      S9.IOX11:   LD      HL,S9.IOX
  ECE4    01 ECF9        C                  LD      BC,S9.IOX
  ECE7    18 DA          C                  JR      S9.IOX8
  ECE9    21 ECF9        C      S9.IOX12:   LD      HL,S9.IOX
  ECEC    01 ECF9        C                  LD      BC,S9.IOX
  ECEF    18 D2          C                  JR      S9.IOX8
  ECF1    01 EC80        C      S9.IOX13:   LD      BC,S9.LISTY
  ECF4    18 D0          C                  JR      S9.IOX9
                         C      
  ECF6    CD EEB5        C      S9.IOXE:    CALL    S9.LOAD
  ECF9    C9             C      S9.IOX:     RET
                         C      
                         C                  TITLE   'U S R - Routine  ONKEY'
                         C                  PAGE
'U S R - Routine  ONKEY'	MACRO-80 3.44	09-Dec-81	PAGE	1-142


                         C      
                         C      ;****************************************************************
                         C      ;*               U S R  -  Routine als   ONKEY - Funktion       *
                         C      ;****************************************************************
  ECFA    CD EE95        C      S9.USER:    CALL    S9.SAVE
  ECFD    CD D40E        C                  CALL    TA.LOE
  ED00    CD 0327        C                  CALL    BC.PAR              ;Parameter uebernehmen
  ED03    1C             C                  INC     E
  ED04    DD 21 B1B7     C                  LD      IX,TS.TAB1+24       ;Tasten PF13 bis PF48 aktivieren
  ED08    21 ED31        C                  LD      HL,S9.USR3
  ED0B    06 24          C                  LD      B,36
  ED0D    DD 75 00       C      S9.USR1:    LD      (IX+0),L
  ED10    DD 74 01       C                  LD      (IX+1),H
  ED13    DD 23          C                  INC     IX
  ED15    DD 23          C                  INC     IX
  ED17    10 F4          C                  DJNZ    S9.USR1
  ED19    3E 80          C                  LD      A,10000000B
  ED1B    32 B23F        C                  LD      (TS.SPMER),A
  ED1E    3E 07          C                  LD      A,7                 ;Cursor loeschen
  ED20    32 B198        C                  LD      (MS.CMD),A
  ED23    CD CB16        C                  CALL    MO.MONI
                         C      
  ED26    D5             C      S9.USR2:    PUSH    DE                  ;warten bis eine P-Taste gedrueckt
  ED27    3E 01          C                  LD      A,1
  ED29    32 B242        C                  LD      (TS.ZSMER),A
  ED2C    CD D23D        C                  CALL    TA.ABFR
  ED2F    18 FB          C                  JR      $-3
                         C      
  ED31    3A B23D        C      S9.USR3:    LD      A,(TS.PTK)          ;P-Tastennummer an BASIC uebergeben
  ED34    D6 0C          C                  SUB     12
  ED36    D1             C                  POP     DE
  ED37    D1             C                  POP     DE
  ED38    D1             C                  POP     DE
  ED39    BB             C                  CP      E
  ED3A    30 EA          C                  JR      NC,S9.USR2
                         C      
  ED3C    CD EE01        C                  CALL    S9.USR7             ;Warteschleife
                         C      
  ED3F    47             C                  LD      B,A                 ;Tastennummer zurueckgeben
  ED40    AF             C                  XOR     A
  ED41    CD 032A        C                  CALL    BC.RUCK
  ED44    18 B0          C      S9.USR4:    JR      S9.IOXE
                         C      
                         C                  TITLE   'U S R - Routine  INKEY 1'
                         C                  PAGE
'U S R - Routine  INKEY 1'	MACRO-80 3.44	09-Dec-81	PAGE	1-143


                         C      
                         C      ;****************************************************************
                         C      ;*               U S R  -  Routine als   INKEY  1 - Funktion    *
                         C      ;****************************************************************
  ED46    CD EE95        C      S9.USER2:   CALL    S9.SAVE
  ED49    CD D40E        C                  CALL    TA.LOE
  ED4C    CD 0327        C                  CALL    BC.PAR              ;Parameter uebernehmen
  ED4F    1C             C                  INC     E
  ED50    DD 21 B1B7     C                  LD      IX,TS.TAB1+24       ;Tasten PF13 bis PF48 aktivieren
  ED54    21 ED7C        C                  LD      HL,S9.USR23
  ED57    06 24          C                  LD      B,36
  ED59    CD EE0C        C                  CALL    S9.USR8
  ED5C    3E 80          C                  LD      A,10000000B
  ED5E    32 B23F        C                  LD      (TS.SPMER),A
  ED61    3E 07          C                  LD      A,7                 ;Cursor loeschen
  ED63    32 B198        C                  LD      (MS.CMD),A
  ED66    CD CB16        C                  CALL    MO.MONI
                         C      
  ED69    D5             C      S9.USR22:   PUSH    DE                  ;eine P-Taste gedrueckt ?
  ED6A    3E 01          C                  LD      A,1
  ED6C    32 B242        C                  LD      (TS.ZSMER),A
  ED6F    CD D143        C                  CALL    TA.TA1
  ED72    20 1F          C                  JR      NZ,S9.USR24
  ED74    CD D15B        C                  CALL    TA.TA2
  ED77    CD D250        C                  CALL    TA.ABFR2
  ED7A    18 17          C                  JR      S9.USR24
                         C      
  ED7C    3A B23D        C      S9.USR23:   LD      A,(TS.PTK)          ;P-Tastennummer an BASIC uebergeben
  ED7F    D6 0C          C                  SUB     12
  ED81    D1             C                  POP     DE
  ED82    D1             C                  POP     DE
  ED83    D1             C                  POP     DE
  ED84    BB             C                  CP      E
  ED85    F5             C                  PUSH    AF
                         C      
  ED86    CD EE01        C                  CALL    S9.USR7                ;Warteschleife
                         C      
  ED89    F1             C                  POP     AF
  ED8A    30 07          C                  JR      NC,S9.USR24
  ED8C    47             C      S9.USR40:   LD      B,A                 ;Tastennummer zurueckgeben
  ED8D    AF             C      S9.USR25:   XOR     A
  ED8E    CD 032A        C                  CALL    BC.RUCK
  ED91    18 B1          C                  JR      S9.USR4
  ED93    06 00          C      S9.USR24:   LD      B,0
  ED95    18 F6          C                  JR      S9.USR25
                         C      
                         C                  TITLE   'U S R - Routine  INKEY 2'
                         C                  PAGE
'U S R - Routine  INKEY 2'	MACRO-80 3.44	09-Dec-81	PAGE	1-144


                         C      
                         C      ;****************************************************************
                         C      ;*               U S R  -  Routine als   INKEY 2 - Funktion     *
                         C      ;****************************************************************
  ED97    CD EE95        C      S9.USER3:   CALL    S9.SAVE
  ED9A    CD D40E        C                  CALL    TA.LOE
  ED9D    CD 0327        C                  CALL    BC.PAR              ;Parameter uebernehmen
  EDA0    7B             C                  LD      A,E                 ;TS.SPMER
  EDA1    32 B23F        C                  LD      (TS.SPMER),A
  EDA4    21 EDF5        C                  LD      HL,S9.USR33
  EDA7    7A             C                  LD      A,D                 ;Erweiterung TS.SPMER
  EDA8    FE 01          C                  CP      1
  EDAA    28 13          C                  JR      Z,S9.USR36
  EDAC    FE 02          C                  CP      2
  EDAE    28 17          C                  JR      Z,S9.USR37
  EDB0    FE 03          C                  CP      3
  EDB2    28 1E          C                  JR      Z,S9.USR41
  EDB4    DD 21 B1FF     C                  LD      IX,TS.TAB2          ;D=0  ...  TS.TAB2
  EDB8    06 0C          C                  LD      B,12
  EDBA    CD EE0E        C                  CALL    S9.USR9
  EDBD    18 1C          C                  JR      S9.USR39
  EDBF    22 B21B        C      S9.USR36:   LD      (TS.TAB3+4),HL      ;D=1  ...  POS_QUIT/NEG_QUIT
  EDC2    22 B223        C                  LD      (TS.TAB4),HL
  EDC5    18 14          C                  JR      S9.USR39
  EDC7    DD 21 B1FF     C      S9.USR37:   LD      IX,TS.TAB2          ;D=2  ...  TS.TAB2,TS.TAB3,TS.TAB4
  EDCB    06 17          C                  LD      B,23
  EDCD    CD EE0E        C                  CALL    S9.USR9
  EDD0    18 09          C                  JR      S9.USR39
  EDD2    DD 21 B1FF     C      S9.USR41:   LD      IX,TS.TAB2          ;D=3  ...  TS.TAB2 --- TS.NEWL
  EDD6    06 1A          C                  LD      B,26
  EDD8    CD EE0E        C                  CALL    S9.USR9
  EDDB    3E 07          C      S9.USR39:   LD      A,7                 ;Cursor loeschen
  EDDD    32 B198        C                  LD      (MS.CMD),A
  EDE0    CD CB16        C                  CALL    MO.MONI
                         C      
  EDE3    3E 01          C      S9.USR32:   LD      A,1                 ;eine P-Taste gedrueckt ?
  EDE5    32 B242        C                  LD      (TS.ZSMER),A
  EDE8    CD D143        C                  CALL    TA.TA1
  EDEB    20 A6          C                  JR      NZ,S9.USR24
  EDED    CD D15B        C                  CALL    TA.TA2
  EDF0    CD D250        C                  CALL    TA.ABFR2
  EDF3    18 9E          C                  JR      S9.USR24
                         C      
  EDF5    3A B23C        C      S9.USR33:   LD      A,(TS.TK)           ;Tastennummer an BASIC uebergeben
  EDF8    D1             C                  POP     DE
  EDF9    D1             C                  POP     DE
  EDFA    F5             C                  PUSH    AF
                         C      
  EDFB    CD EE01        C                  CALL    S9.USR7
                         C      
  EDFE    F1             C                  POP     AF
  EDFF    18 8B          C                  JR      S9.USR40
                         C      
  EE01    06 80          C      S9.USR7:    LD      B,80H               ;Warteschleife
  EE03    C5             C                  PUSH    BC
  EE04    06 FF          C                  LD      B,-1
  EE06    10 FE          C                  DJNZ    $-0
  EE08    C1             C                  POP     BC
  EE09    10 F8          C                  DJNZ    $-6
  EE0B    C9             C                  RET
                         C      
  EE0C    06 24          C      S9.USR8:    LD      B,36
  EE0E    DD 75 00       C      S9.USR9:    LD      (IX+0),L
  EE11    DD 74 01       C                  LD      (IX+1),H
  EE14    DD 23          C                  INC     IX
  EE16    DD 23          C                  INC     IX
  EE18    10 F4          C                  DJNZ    S9.USR9
  EE1A    C9             C                  RET
                         C      
                         C                  TITLE   'weitere Anschlussroutinen'
                         C                  PAGE
'weitere Anschlussroutinen'	MACRO-80 3.44	09-Dec-81	PAGE	1-145


                         C      
                         C      ;****************************************************************
                         C      ;*               Speicherende uebergeben                        *
                         C      ;****************************************************************
  EE1B    06 9F          C      S9.MEMCK:   LD      B,HIGH(S0.MEMCK)
  EE1D    3E FF          C                  LD      A,LOW(S0.MEMCK)
  EE1F    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*               Veraenderte Routine fuer   O U T               *
                         C      ;****************************************************************
  EE20    CD 171B        C      S9.OUT:     CALL    BC.C091
  EE23    3E 2C          C                  LD      A,02CH
  EE25    CD 0451        C                  CALL    BC.C006
  EE28    D5             C                  PUSH    DE
  EE29    CD 171B        C                  CALL    BC.C091
  EE2C    4B             C                  LD      C,E
  EE2D    D1             C                  POP     DE
  EE2E    43             C                  LD      B,E
  EE2F    D1             C                  POP     DE
  EE30    7B             C                  LD      A,E
  EE31    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*               Routine fuer das  BASIC - Token   S V C        *
                         C      ;****************************************************************
  EE32    ED 73 019A     C      S9.SVC:     LD      (BC.D047),SP
  EE36    E5             C                  PUSH    HL
  EE37    11 1F57        C                  LD      DE,BC.D101
  EE3A    D5             C                  PUSH    DE
  EE3B    11 F0DD        C                  LD      DE,S9.ABAUP         ;Standardzieladresse fuer  SVC
  EE3E    01 0000        C                  LD      BC,0                ;Par.zaehler gleich 0
  EE41    D5             C                  PUSH    DE
  EE42    CD 0948        C                  CALL    BC.C032
  EE45    CA 1F4B        C                  JP      Z,BC.CALL2
  EE48    C3 1F40        C                  JP      BC.CALL1
                         C      ;****************************************************************
                         C      ;*               Routine fuer das  BASIC - Token   G R F        *
                         C      ;****************************************************************
                         C      ; S9.GRF:     LD      (BC.D047),SP
                         C      ;             PUSH    HL
                         C      ;             LD      DE,BC.D101
                         C      ;             PUSH    DE
                         C      ;             LD      DE,ABGUP            ;Standardzieladresse fuer  GRF
                         C      ;             LD      BC,0                ;Par.zaehler gleich 0
                         C      ;             PUSH    DE
                         C      ;             CALL    BC.C032
                         C      ;             JPZ     BC.CALL2
                         C      ;             JP      BC.CALL1
                         C      
  EE4B                   C      S9.OUTLG    EQU     $
                         C      
                         C                  PAGE
'weitere Anschlussroutinen'	MACRO-80 3.44	09-Dec-81	PAGE	1-146


                         C      
                         C      ;****************************************************************
                         C      ;*               suchen der  BASIC - Variable   n a $           *
                         C      ;*               -----------------------------------------------*
                         C      ;*               Eingang:   S2.RBBR+1      1. Namenszeichen     *
                         C      ;*                          S2.RBBR        2. Namenszeichen     *
                         C      ;*               Ausgang:   (HL)           Adresse der Variable *
                         C      ;*                          (DE)           Laenge  der Variable *
                         C      ;*                          (HL)=(DE)=0    na$ existiert nicht  *
                         C      ;****************************************************************
  EE4B    AF             C      S9.SUSY:    XOR     A                   ;CY=0
  EE4C    2A 015E        C                  LD      HL,(BC.D024)        ;1.Byte des Ber. f. einf. Var.
  EE4F    ED 4B 0160     C                  LD      BC,(BC.D025)        ;1.Byte des Ber. f. Dim.  Var.
  EE53    11 0007        C                  LD      DE,7                ;D = 0 , E = 7
  EE56    ED 42          C      S9.SUCHE:   SBC     HL,BC
  EE58    30 1C          C                  JR      NC,S9.ENDEV         ;wenn Ber. einf. Var. zu Ende
  EE5A    09             C                  ADD     HL,BC               ;HL wieder herstellen
  EE5B    3A B26C        C                  LD      A,(S2.RBBR)         ;"Y" + 80H  fuer Y$
  EE5E    BE             C                  CP      (HL)
  EE5F    23             C                  INC     HL
  EE60    20 10          C                  JR      NZ,S9.NISY          ;wenn nicht  SY$
  EE62    3A B26D        C                  LD      A,(S2.RBBR+1)
  EE65    BE             C                  CP      (HL)
  EE66    20 0A          C                  JR      NZ,S9.NISY          ;wenn nicht  SY$
  EE68    23             C                  INC     HL
  EE69    5E             C                  LD      E,(HL)              ;DE enthaelt Laenge der Zeichenkette
  EE6A    23             C                  INC     HL
  EE6B    23             C                  INC     HL
  EE6C    46             C                  LD      B,(HL)              ;L(Zeichenkettenadresse)
  EE6D    23             C                  INC     HL
  EE6E    66             C                  LD      H,(HL)              ;H(Zeichenkettenadresse)
  EE6F    68             C                  LD      L,B
  EE70    18 06          C                  JR      S9.UEBGA
                         C      
  EE72    AF             C      S9.NISY:    XOR     A                   ;CY=0
  EE73    19             C                  ADD     HL,DE               ;zeigt auf naechste Variable
  EE74    18 E0          C                  JR      S9.SUCHE
  EE76    1E 00          C      S9.ENDEV:   LD      E,0                 ;Laenge=0 wenn SY$ nicht gefunden
                         C      
  EE78    C9             C      S9.UEBGA:   RET
                         C      
  EE79    26 45          C      S9.ERSTR:   LD      H,'E'               ;ER$ suchen
  EE7B    2E D2          C                  LD      L,52H+80H
  EE7D    22 B26C        C      S9.NSTR:    LD      (S2.RBBR),HL
  EE80    CD EE4B        C                  CALL    S9.SUSY
  EE83    7A             C                  LD      A,D
  EE84    B3             C                  OR      E
  EE85    C9             C                  RET
                         C      
  EE86    F5             C      S9.ERS:     PUSH    AF
  EE87    CD EE79        C                  CALL    S9.ERSTR
  EE8A    28 07          C                  JR      Z,S9.ERS1
  EE8C    11 0006        C                  LD      DE,6
  EE8F    19             C                  ADD     HL,DE
  EE90    F1             C                  POP     AF
  EE91    77             C                  LD      (HL),A
  EE92    C9             C                  RET
  EE93    F1             C      S9.ERS1:    POP     AF
  EE94    C9             C                  RET
                         C      
                         C                  TITLE   'retten und laden der Register'
                         C                  PAGE
'retten und laden der Register'	MACRO-80 3.44	09-Dec-81	PAGE	1-147


                         C      
                         C      ;****************************************************************
                         C      ;*  S A V E  ---   retten der Register                          *
                         C      ;****************************************************************
  EE95    ED 73 AFFC     C      S9.SAVE:    LD      (S0.STACK-2),SP
  EE99    31 AFFC        C                  LD      SP,S0.STACK-2
  EE9C    F5             C                  PUSH    AF
  EE9D    C5             C                  PUSH    BC
  EE9E    D5             C                  PUSH    DE
  EE9F    DD E5          C                  PUSH    IX
  EEA1    FD E5          C                  PUSH    IY
  EEA3    E5             C                  PUSH    HL
  EEA4    ED 7B AFFC     C                  LD      SP,(S0.STACK-2)
  EEA8    E1             C                  POP     HL                  ;Ruecksprungadresse
  EEA9    31 AFF0        C                  LD      SP,S0.STACK-14
  EEAC    E5             C                  PUSH    HL
  EEAD    ED 73 B24D     C                  LD      (TS.STACK),SP
  EEB1    2A AFF0        C                  LD      HL,(S0.STACK-14)
  EEB4    C9             C                  RET
                         C      
                         C      ;****************************************************************
                         C      ;*  L O A D  ---   laden der Register                           *
                         C      ;****************************************************************
  EEB5    CD E510        C      S9.LOAD:    CALL    S9.TALOE
  EEB8    21 AFFE        C                  LD      HL,S0.STACK
  EEBB    22 B24D        C                  LD      (TS.STACK),HL
  EEBE    E1             C                  POP     HL
  EEBF    ED 7B AFFC     C                  LD      SP,(S0.STACK-2)
  EEC3    33             C                  INC     SP
  EEC4    33             C                  INC     SP
  EEC5    E5             C                  PUSH    HL
  EEC6    31 AFF0        C                  LD      SP,S0.STACK-14
  EEC9    E1             C                  POP     HL
  EECA    FD E1          C                  POP     IY
  EECC    DD E1          C                  POP     IX
  EECE    D1             C                  POP     DE
  EECF    C1             C                  POP     BC
  EED0    F1             C                  POP     AF
  EED1    ED 7B AFFC     C                  LD      SP,(S0.STACK-2)
  EED5    C9             C                  RET
                         C      
                         C                  TITLE   'OPEN- / CLOSE- Routine'
                         C                  PAGE
'OPEN- / CLOSE- Routine'	MACRO-80 3.44	09-Dec-81	PAGE	1-148


                         C      
                         C      ;****************************************************************
                         C      ;*                OPEN - Routine                                *
                         C      ;*                CALL &B406,geraet,{"I"|"O"|"M"},label         *
                         C      ;****************************************************************
  EED6    3E FF          C      S9.ROP1:    LD      A,-1                ;Merker relatives OPEN
  EED8    B7             C                  OR      A
  EED9    18 38          C                  JR      S9.ROP2
  EEDB    3A B26B        C      S9.ROP3:    LD      A,(S2.DNR)          ;Output
  EEDE    CB 7F          C                  BIT     7,A
  EEE0    28 06          C                  JR      Z,S9.ROP4
  EEE2    CB BF          C                  RES     7,A
  EEE4    3C             C                  INC     A
  EEE5    C3 EF4C        C                  JP      S9.OP4+3
  EEE8    CB FF          C      S9.ROP4:    SET     7,A
  EEEA    ED 44          C                  NEG
  EEEC    57             C                  LD      D,A
  EEED    CD D828        C                  CALL    K1.GNLMN
  EEF0    18 5F          C                  JR      S9.OP5
  EEF2    3A B26B        C      S9.ROP7:    LD      A,(S2.DNR)          ;Input
  EEF5    CB 7F          C                  BIT     7,A
  EEF7    28 06          C                  JR      Z,S9.ROP8
  EEF9    CB BF          C                  RES     7,A
  EEFB    3C             C                  INC     A
  EEFC    C3 EF9D        C                  JP      S9.OP21+3
  EEFF    CB FF          C      S9.ROP8:    SET     7,A
  EF01    ED 44          C                  NEG
  EF03    57             C                  LD      D,A
  EF04    CD D828        C                  CALL    K1.GNLMN
  EF07    C3 EFA2        C                  JP      S9.OP22
                         C      
  EF0A    33             C      S9.OPEN:    INC     SP
  EF0B    33             C                  INC     SP
  EF0C    CD EE95        C                  CALL    S9.SAVE
  EF0F    CD F113        C      S9.OPEN1:   CALL    S9.AUP
  EF12    AF             C                  XOR     A                   ;Merker absolutes OPEN
  EF13    F5             C      S9.ROP2:    PUSH    AF
  EF14    21 B25F        C                  LD      HL,S2.IM
  EF17    06 00          C                  LD      B,0
  EF19    DD 7E 04       C      S9.OP1:     LD      A,(IX+4)            ;Geraeteadresse
  EF1C    FE 01          C                  CP      1
  EF1E    28 04          C                  JR      Z,S9.OP2
  EF20    CB C8          C                  SET     1,B                 ;Geraet 2
  EF22    18 02          C                  JR      S9.OP7
  EF24    CB C0          C      S9.OP2:     SET     0,B                 ;Geraet 1
  EF26    DD 7E 00       C      S9.OP7:     LD      A,(IX+0)            ;label
  EF29    32 B26B        C                  LD      (S2.DNR),A
  EF2C    DD 7E 02       C                  LD      A,(IX+2)            ;(I)nput oder (O)utput ?
  EF2F    FE 49          C                  CP      'I'
  EF31    28 58          C                  JR      Z,S9.OP20
  EF33    FE 4D          C                  CP      'M'
  EF35    20 02          C                  JR      NZ,S9.OP3
  EF37    CB E0          C                  SET     4,B                 ;MOD Verarbeitung
  EF39    23             C      S9.OP3:     INC     HL                  ;Output
  EF3A    78             C                  LD      A,B
  EF3B    77             C                  LD      (HL),A
  EF3C    CD F06E        C                  CALL    S9.RGLO
  EF3F    CD D745        C                  CALL    K1.GNRE
  EF42    F1             C                  POP     AF
  EF43    C2 EEDB        C                  JP      NZ,S9.ROP3
  EF46    CD D77D        C                  CALL    K1.GNRW
  EF49    3A B26B        C      S9.OP4:     LD      A,(S2.DNR)          ;Datei positionieren
  EF4C    3D             C                  DEC     A
  EF4D    57             C                  LD      D,A
  EF4E    CD D7F0        C                  CALL    K1.GNLPN
  EF51    3A B260        C      S9.OP5:     LD      A,(S2.OM)           ;MOD - Verarbeitung
  EF54    CB 67          C                  BIT     4,A
  EF56    28 28          C                  JR      Z,S9.OP13
  EF58    CD D7EE        C                  CALL    K1.GNLP
  EF5B    CD D7BD        C                  CALL    K1.GNRM
  EF5E    CD D7BD        C                  CALL    K1.GNRM
  EF61    DD 36 04 02    C                  LD      (IX+4),2
  EF65    CD D551        C                  CALL    K1.ARMB
  EF68    CD D612        C                  CALL    K1.F17
  EF6B    CD D5B3        C                  CALL    K1.ARBT
  EF6E    CD D5FE        C                  CALL    K1.LHLBC
  EF71    11 BBF0        C                  LD      DE,S0.PFFA
  EF74    ED B0          C                  LDIR
  EF76    CD D5DA        C                  CALL    K1.RCZP
  EF79    D5             C                  PUSH    DE
  EF7A    CD D7BD        C                  CALL    K1.GNRM
  EF7D    E1             C                  POP     HL
'OPEN- / CLOSE- Routine'	MACRO-80 3.44	09-Dec-81	PAGE	1-149


  EF7E    18 03          C                  JR      S9.OP14
  EF80    21 BBF0        C      S9.OP13:    LD      HL,S0.PFFA
  EF83    22 B25B        C      S9.OP14:    LD      (S2.POIA),HL
  EF86    CD D6EE        C                  CALL    K1.GNSTS
  EF89    18 1D          C                  JR      S9.OPR
                         C      
  EF8B    78             C      S9.OP20:    LD      A,B                 ;Input
  EF8C    77             C                  LD      (HL),A
  EF8D    CD F05E        C                  CALL    S9.RGLI
  EF90    CD D745        C                  CALL    K1.GNRE
  EF93    F1             C                  POP     AF
  EF94    C2 EEF2        C                  JP      NZ,S9.ROP7
  EF97    CD D77D        C                  CALL    K1.GNRW
  EF9A    3A B26B        C      S9.OP21:    LD      A,(S2.DNR)          ;Datei positionieren
  EF9D    3D             C                  DEC     A
  EF9E    57             C                  LD      D,A
  EF9F    CD D7F0        C                  CALL    K1.GNLPN
  EFA2    01 0400        C      S9.OP22:    LD      BC,00400H           ;Eingabepuffer fuellen
  EFA5    CD DB2D        C                  CALL    K1.EIN
                         C      
  EFA8    C3 F11C        C      S9.OPR:     JP      S9.RBAUP
                         C      ;****************************************************************
                         C      ;*                 CLOSE - Routine                              *
                         C      ;*                 CALL &B409,{"I"|"O"}                         *
                         C      ;****************************************************************
  EFAB    33             C      S9.CLOSE:   INC     SP
  EFAC    33             C                  INC     SP
  EFAD    CD EE95        C                  CALL    S9.SAVE
  EFB0    CD F113        C      S9.CLOS1:   CALL    S9.AUP
  EFB3    AF             C                  XOR     A
  EFB4    F5             C      S9.RCL2:    PUSH    AF
  EFB5    DD 7E 00       C                  LD      A,(IX+0)
  EFB8    FE 4F          C                  CP      'O'
  EFBA    28 1A          C                  JR      Z,S9.CLO1
                         C      
  EFBC    F1             C                  POP     AF                  ;CLOSE Input
  EFBD    08             C                  EX      AF,AF'              ;'
  EFBE    3A B25F        C                  LD      A,(S2.IM)
  EFC1    B7             C                  OR      A
  EFC2    CA EB89        C      S9.CLO2:    JP      Z,S9.RIVF
  EFC5    CD F05E        C                  CALL    S9.RGLI
  EFC8    08             C                  EX      AF,AF'              ;'
  EFC9    20 37          C                  JR      NZ,S9.RCL3
  EFCB    CD D77D        C                  CALL    K1.GNRW
  EFCE    CD D762        C                  CALL    K1.GNRA
  EFD1    CD F007        C      S9.RCL4:    CALL    S9.MIR
  EFD4    18 D2          C      S9.CLR:     JR      S9.OPR
                         C      
  EFD6    F1             C      S9.CLO1:    POP     AF                  ;CLOSE Output
  EFD7    08             C                  EX      AF,AF'              ;'
  EFD8    3A B260        C                  LD      A,(S2.OM)
  EFDB    B7             C                  OR      A
  EFDC    CA EC24        C      S9.CLO3:    JP      Z,S9.WRTVF
  EFDF    CB 7F          C                  BIT     7,A
  EFE1    28 03          C                  JR      Z,S9.CLO4
  EFE3    AF             C                  XOR     A
  EFE4    18 F6          C                  JR      S9.CLO3
  EFE6    CD F06E        C      S9.CLO4:    CALL    S9.RGLO
  EFE9    CD DB66        C                  CALL    K1.AUS
  EFEC    CD D86B        C                  CALL    K1.GNCLS
  EFEF    08             C                  EX      AF,AF'              ;'
  EFF0    20 06          C                  JR      NZ,S9.RCL5
  EFF2    CD D77D        C                  CALL    K1.GNRW
  EFF5    CD D762        C                  CALL    K1.GNRA
  EFF8    CD F014        C      S9.RCL5:    CALL    S9.MOR
  EFFB    18 D7          C                  JR      S9.CLR
                         C      
  EFFD    3E FF          C      S9.RCL1:    LD      A,-1
  EFFF    B7             C                  OR      A
  F000    18 B2          C                  JR      S9.RCL2
  F002    CD D7EE        C      S9.RCL3:    CALL    K1.GNLP
  F005    18 CA          C                  JR      S9.RCL4
                         C      
  F007    AF             C      S9.MIR:     XOR     A
  F008    32 B25F        C                  LD      (S2.IM),A
  F00B    32 B41E        C                  LD      (0B41EH),A
  F00E    3E C9          C                  LD      A,0C9H
  F010    32 B422        C                  LD      (0B422H),A
  F013    C9             C                  RET
                         C      
  F014    AF             C      S9.MOR:     XOR     A
  F015    32 B260        C                  LD      (S2.OM),A
  F018    32 B420        C                  LD      (0B420H),A
'OPEN- / CLOSE- Routine'	MACRO-80 3.44	09-Dec-81	PAGE	1-150


  F01B    3E C9          C                  LD      A,0C9H
  F01D    32 B425        C                  LD      (0B425H),A
  F020    C9             C                  RET
                         C      
                         C                  TITLE   'READ / WRITE - Routinen'
                         C                  PAGE
'READ / WRITE - Routinen'	MACRO-80 3.44	09-Dec-81	PAGE	1-151


                         C      
                         C      ;****************************************************************
                         C      ;*                 READ - Routine                               *
                         C      ;*                 CALL &B40C                                   *
                         C      ;****************************************************************
  F021    33             C      S9.READ:    INC     SP
  F022    33             C                  INC     SP
  F023    CD EE95        C                  CALL    S9.SAVE
  F026    3A B25F        C      S9.READ1:   LD      A,(S2.IM)
  F029    B7             C                  OR      A
  F02A    28 96          C                  JR      Z,S9.CLO2
  F02C    CD F05E        C                  CALL    S9.RGLI
  F02F    01 0400        C                  LD      BC,400H             ;Eingabepuffer fuellen
  F032    CD DB2D        C                  CALL    K1.EIN
  F035    18 9D          C      S9.RE9:     JR      S9.CLR
  F037    3A B25F        C      S9.READ2:   LD      A,(S2.IM)
  F03A    B7             C                  OR      A
  F03B    28 85          C                  JR      Z,S9.CLO2
  F03D    CD F05E        C                  CALL    S9.RGLI
  F040    CD DB48        C                  CALL    K1.EINP
  F043    CD D60B        C                  CALL    K1.BM
  F046    CC EBD9        C                  CALL    Z,S9.BM3
  F049    18 EA          C                  JR      S9.RE9
                         C      ;****************************************************************
                         C      ;*                 WRITE - Routine                              *
                         C      ;*                 CALL &B40F                                   *
                         C      ;****************************************************************
  F04B    33             C      S9.WRITE:   INC     SP
  F04C    33             C                  INC     SP
  F04D    CD EE95        C                  CALL    S9.SAVE
  F050    3A B260        C      S9.WRIT1:   LD      A,(S2.OM)
  F053    B7             C                  OR      A
  F054    28 86          C                  JR      Z,S9.CLO3
  F056    CD F06E        C                  CALL    S9.RGLO
  F059    CD DB66        C                  CALL    K1.AUS              ;Ausgabepuffer leeren
  F05C    18 D7          C      S9.WR9:     JR      S9.RE9
                         C      ;****************************************************************
                         C      ;*               IX und IY  fuer Eingabekassette laden          *
                         C      ;****************************************************************
  F05E    3A B25F        C      S9.RGLI:    LD      A,(S2.IM)
  F061    CB 4F          C                  BIT     1,A
  F063    20 05          C                  JR      NZ,S9.RGLI1
  F065    CD D62A        C                  CALL    K1.RGL1
  F068    18 03          C                  JR      S9.RGLI2
  F06A    CD D63B        C      S9.RGLI1:   CALL    K1.RGL2
  F06D    C9             C      S9.RGLI2:   RET
                         C      ;****************************************************************
                         C      ;*               IX und IY  fuer Ausgabekassette laden          *
                         C      ;****************************************************************
  F06E    3A B260        C      S9.RGLO:    LD      A,(S2.OM)
  F071    CB 4F          C                  BIT     1,A
  F073    20 05          C                  JR      NZ,S9.RGLO1
  F075    CD D62A        C                  CALL    K1.RGL1
  F078    18 03          C                  JR      S9.RGLO2
  F07A    CD D63B        C      S9.RGLO1:   CALL    K1.RGL2
  F07D    C9             C      S9.RGLO2:   RET
                         C      
                         C                  TITLE   'Eingabedatei ==> Ausgabedatei'
                         C                  PAGE
'Eingabedatei ==> Ausgabedatei'	MACRO-80 3.44	09-Dec-81	PAGE	1-152


                         C      
                         C      ;****************************************************************
                         C      ;*               Kopieren der Eingabedatei in die Ausgabedatei  *
                         C      ;****************************************************************
  F07E    3A B25F        C      S9.COPY:    LD      A,(S2.IM)           ;Eingabe eroeffnet
  F081    B7             C                  OR      A
  F082    CA EB89        C                  JP      Z,S9.RIVF
  F085    3A B260        C                  LD      A,(S2.OM)           ;Ausgabe eroeffnet
  F088    B7             C                  OR      A
  F089    CA EC24        C                  JP      Z,S9.WRTVF
                         C      
  F08C    2A B128        C      S9.COP1:    LD      HL,(K2.TXEND)       ;BC <== Laenge des belegten Puffers
  F08F    01 B7E0        C                  LD      BC,S0.PFFI
  F092    B7             C                  OR      A
  F093    ED 42          C                  SBC     HL,BC
  F095    E5             C                  PUSH    HL
  F096    C1             C                  POP     BC
  F097    21 B7E0        C                  LD      HL,S0.PFFI          ;HL <== Eingabepufferadresse
  F09A    78             C                  LD      A,B
  F09B    B1             C                  OR      C
  F09C    28 26          C                  JR      Z,S9.COP3
                         C      
  F09E    E5             C      S9.COP5:    PUSH    HL                  ;Ausgabepuffer voll ?
  F09F    C5             C                  PUSH    BC
  F0A0    2A B25B        C                  LD      HL,(S2.POIA)
  F0A3    01 BFF0        C                  LD      BC,S0.PFFA+400H
  F0A6    B7             C                  OR      A
  F0A7    ED 42          C                  SBC     HL,BC
  F0A9    20 06          C                  JR      NZ,S9.COP8
  F0AB    CD F06E        C                  CALL    S9.RGLO             ;Ja / Ausgabe des Pufferinhaltes
  F0AE    CD DB66        C      S9.COP7:    CALL    K1.AUS
  F0B1    C1             C      S9.COP8:    POP     BC
  F0B2    E1             C                  POP     HL
  F0B3    7E             C                  LD      A,(HL)              ;A  <== naechstes Zeichen
  F0B4    E5             C                  PUSH    HL
  F0B5    2A B25B        C                  LD      HL,(S2.POIA)        ;A  ==> Ausgabepuffer
  F0B8    77             C                  LD      (HL),A
  F0B9    23             C                  INC     HL
  F0BA    22 B25B        C                  LD      (S2.POIA),HL
  F0BD    E1             C                  POP     HL
  F0BE    23             C                  INC     HL
  F0BF    0B             C                  DEC     BC
  F0C0    78             C                  LD      A,B
  F0C1    B1             C                  OR      C
  F0C2    20 DA          C                  JR      NZ,S9.COP5          ;weiter mit naechstem Eingabezeichen
                         C      
  F0C4    CD F05E        C      S9.COP3:    CALL    S9.RGLI             ;IX , IY  entspr. Eingabegeraet
  F0C7    CD D60B        C                  CALL    K1.BM               ;Bandmarke erreicht ?
  F0CA    28 08          C                  JR      Z,S9.COP2           ;Ja
                         C      
  F0CC    01 0400        C                  LD      BC,400H             ;naechste Datenbloecke einlesen
  F0CF    CD DB2D        C                  CALL    K1.EIN
  F0D2    18 B8          C                  JR      S9.COP1
                         C      
  F0D4    CD D7BD        C      S9.COP2:    CALL    K1.GNRM
  F0D7    CD D6EE        C                  CALL    K1.GNSTS
  F0DA    C3 B403        C      S9.COP9:    JP      0B403H
                         C      
                         C                  TITLE   'Anfang von Grafikerw.'
                         C                  PAGE
'Anfang von Grafikerw.'	MACRO-80 3.44	09-Dec-81	PAGE	1-153


                         C      
                         C      ;****************************************************************
                         C      ;*               Anfang von Grafikerweiterungs-UPs              *
                         C      ;****************************************************************
                         C      ;ABGUP: INC  SP
                         C      ;      INC  SP
                         C      ;      CALL SAVE
                         C      ;      CALL AUP
                         C      ;      PUSH IX
                         C      ;      POP  IY
                         C      ;GB1:   LD   A,B
                         C      ;      OR   C
                         C      ;      JRZ  GB2-#
                         C      ;      INC  IY
                         C      ;      INC  IY
                         C      ;      DEC  BC
                         C      ;      JR   GB1-#
                         C      ;GB2:   LD   A,(IY-2)
                         C      ;      CMP  0
                         C      ;      JRZ  RBAUP-#
                         C      ;      JMP  RBAUP              ;Adresse im ersten 100H-Bereich
                         C      
                         C                  TITLE   'Anfang und Ende von Assemblererw.'
                         C                  PAGE
'Anfang und Ende von Assemblererw.'	MACRO-80 3.44	09-Dec-81	PAGE	1-154


                         C      
                         C      ;****************************************************************
                         C      ;*               Anfang von Assemblererweiterungs-UPs           *
                         C      ;****************************************************************
  F0DD    33             C      S9.ABAUP:   INC     SP
  F0DE    33             C                  INC     SP
  F0DF    CD EE95        C                  CALL    S9.SAVE
  F0E2    CD F113        C                  CALL    S9.AUP
  F0E5    DD E5          C                  PUSH    IX
  F0E7    FD E1          C                  POP     IY
  F0E9    78             C      S9.AB1:     LD      A,B
  F0EA    B1             C                  OR      C
  F0EB    28 07          C                  JR      Z,S9.AB2
  F0ED    FD 23          C                  INC     IY
  F0EF    FD 23          C                  INC     IY
  F0F1    0B             C                  DEC     BC
  F0F2    18 F5          C                  JR      S9.AB1
  F0F4    FD 7E FE       C      S9.AB2:     LD      A,(IY-2)
  F0F7    FE 00          C                  CP      0
  F0F9    C2 F577        C                  JP      NZ,S4.UM16          ;SVC &1i,...
  F0FC    21 F13A        C                  LD      HL,S9.ADRTB
  F0FF    7E             C      S9.AB3:     LD      A,(HL)
  F100    47             C                  LD      B,A
  F101    23             C                  INC     HL
  F102    FD 7E FC       C                  LD      A,(IY-4)
  F105    BE             C      S9.AB0:     CP      (HL)
  F106    23             C                  INC     HL
  F107    5E             C                  LD      E,(HL)
  F108    23             C                  INC     HL
  F109    56             C                  LD      D,(HL)
  F10A    23             C                  INC     HL
  F10B    28 04          C                  JR      Z,S9.AB01
  F10D    10 F6          C                  DJNZ    S9.AB0
  F10F    18 0B          C                  JR      S9.RBAUP
  F111    D5             C      S9.AB01:    PUSH    DE
  F112    C9             C                  RET
                         C      
  F113    DD 2A AFFC     C      S9.AUP:     LD      IX,(S0.STACK-2)
  F117    DD 23          C                  INC     IX
  F119    DD 23          C                  INC     IX
  F11B    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*               Ende der Assemblererweiterungs-UPs             *
                         C      ;****************************************************************
  F11C    CD F576        C      S9.RBAUP:   CALL    S4.UM6+6
  F11F    CD F126        C                  CALL    S9.RUP
  F122    CD EEB5        C                  CALL    S9.LOAD
  F125    C9             C                  RET
                         C      
  F126    2A AFFC        C      S9.RUP:     LD      HL,(S0.STACK-2)
  F129    ED 4B AFF8     C                  LD      BC,(S0.STACK-6)
  F12D    78             C      S9.RBP1:    LD      A,B
  F12E    B1             C                  OR      C
  F12F    28 05          C                  JR      Z,S9.RBP2
  F131    23             C                  INC     HL
  F132    23             C                  INC     HL
  F133    0B             C                  DEC     BC
  F134    18 F7          C                  JR      S9.RBP1
  F136    22 AFFC        C      S9.RBP2:    LD      (S0.STACK-2),HL
  F139    C9             C                  RET
                         C      
                         C                  TITLE   'Adresstabelle der Systemanschlussroutinen'
                         C                  PAGE
'Adresstabelle der Systemanschlussroutinen'	MACRO-80 3.44	09-Dec-81	PAGE	1-155


                         C      
                         C      ;****************************************************************
                         C      ;*               Adresstabelle der B A S I C -Anschlussroutinen *
                         C      ;****************************************************************
  F13A    3C             C      S9.ADRTB:   DB      60                  ;Anzahl der Routinen
                         C      
  F13B    00             C                  DB      0
  F13C    F272           C                  DW      S9.ALLUP
                         C      
  F13E    01             C                  DB      1
  F13F    F286           C                  DW      S9.MEMO
                         C      
  F141    02             C                  DB      2
  F142    F2A6           C                  DW      S9.BLD
                         C      
  F144    03             C                  DB      3
  F145    F2AB           C                  DW      S9.BC1
                         C      
  F147    04             C                  DB      4
  F148    F2B0           C                  DW      S9.AP
                         C      
  F14A    05             C                  DB      5
  F14B    F3BA           C                  DW      S9.NPOS
                         C      
  F14D    06             C                  DB      6
  F14E    F3AA           C                  DW      S9.APOS
                         C      
  F150    07             C                  DB      7
  F151    F3DF           C                  DW      S9.NFENS
                         C      
  F153    08             C                  DB      8
  F154    F3F3           C                  DW      S9.SFENS
                         C      
  F156    09             C                  DB      9
  F157    F3D5           C                  DW      S9.CPOS
                         C      
  F159    0A             C                  DB      10
  F15A    F577           C                  DW      S4.SVC10
                         C      
  F15C    0B             C                  DB      11
  F15D    F11C           C                  DW      S9.RBAUP
                         C      
  F15F    0C             C                  DB      12
  F160    F3A1           C                  DW      S9.CONO
                         C      
  F162    0D             C                  DB      13
  F163    F40B           C                  DW      S9.SVC13
                         C      
  F165    0E             C                  DB      14
  F166    F4C3           C                  DW      S9.SVC14
                         C      
  F168    0F             C                  DB      15
  F169    F390           C                  DW      S9.ICON
                         C      
  F16B    10             C                  DB      16
  F16C    F395           C                  DW      S9.OCON
                         C      
  F16E    11             C                  DB      17
  F16F    F413           C                  DW      S9.SVC17
                         C      
  F171    12             C                  DB      18
  F172    F41B           C                  DW      S9.SVC18
                         C      
  F174    13             C                  DB      19
  F175    F4D4           C                  DW      S9.SVC19
                         C      
  F177    14             C                  DB      20
  F178    EF0F           C                  DW      S9.OPEN1
                         C      
  F17A    15             C                  DB      21
  F17B    EED6           C                  DW      S9.ROP1
                         C      
  F17D    16             C                  DB      22
  F17E    F308           C                  DW      S9.MRIO
                         C      
  F180    17             C                  DB      23
  F181    F319           C                  DW      S9.MRAO
                         C      
  F183    18             C                  DB      24
  F184    F026           C                  DW      S9.READ1
                         C      
  F186    19             C                  DB      25
'Adresstabelle der Systemanschlussroutinen'	MACRO-80 3.44	09-Dec-81	PAGE	1-156


  F187    F037           C                  DW      S9.READ2
                         C      
  F189    1A             C                  DB      26
  F18A    F050           C                  DW      S9.WRIT1
                         C      
  F18C    1B             C                  DB      27
  F18D    F501           C                  DW      S9.SVC27
                         C      
  F18F    1C             C                  DB      28
  F190    F07E           C                  DW      S9.COPY
                         C      
  F192    1D             C                  DB      29
  F193    EFB0           C                  DW      S9.CLOS1
                         C      
  F195    1E             C                  DB      30
  F196    EFFD           C                  DW      S9.RCL1
                         C      
  F198    1F             C                  DB      31
  F199    F32A           C                  DW      S9.MRAC
                         C      
  F19B    20             C                  DB      32
  F19C    F4E5           C                  DW      S9.SVC32
                         C      
  F19E    21             C                  DB      33
  F19F    F4EB           C                  DW      S9.SVC33
                         C      
  F1A1    27             C                  DB      39
  F1A2    F55D           C                  DW      S9.SVC39
                         C      
  F1A4    28             C                  DB      40
  F1A5    F34C           C                  DW      S9.SPAUS
                         C      
  F1A7    29             C                  DB      41
  F1A8    F35E           C                  DW      S9.SPI
                         C      
  F1AA    2A             C                  DB      42
  F1AB    F36C           C                  DW      S9.SPO
                         C      
  F1AD    2B             C                  DB      43
  F1AE    F47E           C                  DW      S9.SVC43
                         C      
  F1B0    2C             C                  DB      44
  F1B1    F495           C                  DW      S9.SVC44
                         C      
  F1B3    2D             C                  DB      45
  F1B4    F3F8           C                  DW      S9.IOC
                         C      
  F1B6    2E             C                  DB      46
  F1B7    F403           C                  DW      S9.TAS0
                         C      
  F1B9    2F             C                  DB      47
  F1BA    F1EF           C                  DW      S9.HCP
                         C      
  F1BC    32             C                  DB      50
  F1BD    F2B5           C                  DW      S9.AL
                         C      
  F1BF    33             C                  DB      51
  F1C0    F2E2           C                  DW      S9.RL
                         C      
  F1C2    34             C                  DB      52
  F1C3    F577           C                  DW      S4.SVC52
                         C      
  F1C5    3C             C                  DB      60
  F1C6    F577           C                  DW      S4.SVC60
                         C      
  F1C8    3D             C                  DB      61
  F1C9    F577           C                  DW      S4.SVC61
                         C      
  F1CB    3E             C                  DB      62
  F1CC    F577           C                  DW      S4.SVC62
                         C      
  F1CE    3F             C                  DB      63
  F1CF    F577           C                  DW      S4.SVC63
                         C      
  F1D1    40             C                  DB      64
  F1D2    F577           C                  DW      S4.SVC64
                         C      
  F1D4    41             C                  DB      65
  F1D5    F577           C                  DW      S4.SVC65
                         C      
  F1D7    42             C                  DB      66
  F1D8    F577           C                  DW      S4.SVC66
                         C      
'Adresstabelle der Systemanschlussroutinen'	MACRO-80 3.44	09-Dec-81	PAGE	1-157


  F1DA    46             C                  DB      70
  F1DB    F577           C                  DW      S4.SC700
                         C      
  F1DD    47             C                  DB      71
  F1DE    F577           C                  DW      S4.SC710
                         C      
  F1E0    48             C                  DB      72
  F1E1    F577           C                  DW      S4.SC720
                         C      
  F1E3    49             C                  DB      73
  F1E4    F577           C                  DW      S4.SC730
                         C      
  F1E6    4A             C                  DB      74
  F1E7    F577           C                  DW      S4.SC740
                         C      
  F1E9    4B             C                  DB      75
  F1EA    F577           C                  DW      S4.SC750
                         C      
  F1EC    4C             C                  DB      76
  F1ED    F577           C                  DW      S4.SC760
                         C      
                         C      
                         C                  TITLE   'Anschlussroutinen'
                         C                  PAGE
'Anschlussroutinen'	MACRO-80 3.44	09-Dec-81	PAGE	1-158


                         C      
  F1EF    DD 7E 00       C      S9.HCP:     LD      A,(IX+0)            ;Ausgabe eines HARDCOPY auf LIST-Device
  F1F2    32 B199        C                  LD      (MS.TK),A           ;Parameterwert zwischenspeichern
  F1F5    CD F576        C                  CALL    S4.UM6+6            ;entspr.  "RBAUP"
  F1F8    CD F126        C                  CALL    S9.RUP              ;  "         "
  F1FB    CD EEB5        C                  CALL    S9.LOAD             ;  "         "
  F1FE    F5             C                  PUSH    AF
  F1FF    C5             C                  PUSH    BC
  F200    D5             C                  PUSH    DE
  F201    E5             C                  PUSH    HL
  F202    3A B199        C                  LD      A,(MS.TK)
  F205    FE 02          C                  CP      2                   ;aktuelles Bildfenster
  F207    28 24          C                  JR      Z,S9.HCP2
  F209    FE 01          C                  CP      1                   ;Zeile 1 bis 24
  F20B    28 08          C                  JR      Z,S9.HCP1
  F20D    FE 00          C                  CP      0                   ;Zeile 1 bis 22
  F20F    20 51          C                  JR      NZ,S9.HCPE
  F211    06 16          C                  LD      B,22
  F213    18 02          C                  JR      S9.HCP11
                         C      
  F215    06 18          C      S9.HCP1:    LD      B,24
  F217    2A B194        C      S9.HCP11:   LD      HL,(MS.BWSA)
  F21A    C5             C      S9.HCP12:   PUSH    BC
  F21B    06 50          C                  LD      B,80
  F21D    7E             C      S9.HCP13:   LD      A,(HL)
  F21E    4F             C                  LD      C,A
  F21F    23             C                  INC     HL
  F220    CD 0315        C                  CALL    BC.LISTX
  F223    10 F8          C                  DJNZ    S9.HCP13
  F225    CD F267        C                  CALL    S9.CR
  F228    C1             C                  POP     BC
  F229    10 EF          C                  DJNZ    S9.HCP12
  F22B    18 2F          C                  JR      S9.HCP3
                         C      
  F22D    2A B190        C      S9.HCP2:    LD      HL,(MS.ZMAX)
  F230    ED 4B B18E     C                  LD      BC,(MS.ZMIN)
  F234    B7             C                  OR      A
  F235    ED 42          C                  SBC     HL,BC
  F237    45             C                  LD      B,L
  F238    04             C                  INC     B
  F239    C5             C                  PUSH    BC                  ;Anzahl Fensterzeilen
  F23A    7C             C                  LD      A,H
  F23B    3C             C                  INC     A
  F23C    32 B199        C                  LD      (MS.TK),A           ;Anzahl Fensterspalten
  F23F    CD CF46        C                  CALL    MO.BWSAF
  F242    C1             C                  POP     BC
  F243    C5             C      S9.HCP21:   PUSH    BC
  F244    E5             C                  PUSH    HL
  F245    3A B199        C                  LD      A,(MS.TK)
  F248    47             C                  LD      B,A
  F249    7E             C      S9.HCP22:   LD      A,(HL)
  F24A    4F             C                  LD      C,A
  F24B    23             C                  INC     HL
  F24C    CD 0315        C                  CALL    BC.LISTX
  F24F    10 F8          C                  DJNZ    S9.HCP22
  F251    E1             C                  POP     HL
  F252    01 0050        C                  LD      BC,80
  F255    09             C                  ADD     HL,BC
  F256    CD F267        C                  CALL    S9.CR
  F259    C1             C                  POP     BC
  F25A    10 E7          C                  DJNZ    S9.HCP21
  F25C    CD F267        C      S9.HCP3:    CALL    S9.CR
  F25F    CD F267        C                  CALL    S9.CR
  F262    E1             C      S9.HCPE:    POP     HL
  F263    D1             C                  POP     DE
  F264    C1             C                  POP     BC
  F265    F1             C                  POP     AF
  F266    C9             C                  RET
                         C      
  F267    0E 0D          C      S9.CR:      LD      C,00DH
  F269    CD 0315        C                  CALL    BC.LISTX
  F26C    0E 0A          C                  LD      C,00AH
  F26E    CD 0315        C                  CALL    BC.LISTX
  F271    C9             C                  RET
                         C      
                         C                  PAGE
'Anschlussroutinen'	MACRO-80 3.44	09-Dec-81	PAGE	1-159


                         C      
  F272    DD 7E 02       C      S9.ALLUP:   LD      A,(IX+2)            ;Aufruf eines allg. Assembler-UP
  F275    DD 66 01       C                  LD      H,(IX+1)
  F278    DD 6E 00       C                  LD      L,(IX+0)
  F27B    FE 00          C                  CP      0
  F27D    C4 F576        C                  CALL    NZ,S4.UM15          ;SVC 0,0, [... ,] &1i,adresse
  F280    CD D2D0        C                  CALL    TA.MM               ;SVC 0,0, [... ,] 0  ,adresse
  F283    C3 B403        C      S9.ALUP1:   JP      0B403H
                         C      
  F286    DD 66 01       C      S9.MEMO:    LD      H,(IX+1)            ;Speicheranzeige  16*16  Byte
  F289    DD 6E 00       C                  LD      L,(IX+0)
  F28C    DD 7E 02       C                  LD      A,(IX+2)
  F28F    22 B292        C                  LD      (S2.DMANF),HL
  F292    FE 00          C                  CP      0
  F294    C4 F576        C                  CALL    NZ,S4.UM15
  F297    CD C92F        C                  CALL    S1.MEA
  F29A    18 E7          C                  JR      S9.ALUP1
                         C      
  F29C    33             C      S9.BLD1:    INC     SP                  ;gesamtes Bild loeschen
  F29D    33             C                  INC     SP
  F29E    CD EE95        C                  CALL    S9.SAVE
  F2A1    CD CC04        C                  CALL    MO.BILO
  F2A4    18 DD          C                  JR      S9.ALUP1
                         C      
  F2A6    CD CC1A        C      S9.BLD:     CALL    MO.FSLO             ;Bildfenster loeschen
  F2A9    18 D8          C                  JR      S9.ALUP1
                         C      
  F2AB    CD F60C        C      S9.BC1:     CALL    S0.BWSUS            ;Copy  BWSA ==> BWS
  F2AE    18 D3          C                  JR      S9.ALUP1
                         C      
  F2B0    CD E615        C      S9.AP:      CALL    S9.ANFG             ;BASIC-Anfangsprogramm laden
  F2B3                   C      S9.SC52E    EQU     $
  F2B3    18 CE          C      S9.AP1:     JR      S9.ALUP1
                         C      
                         C                  PAGE
'Anschlussroutinen'	MACRO-80 3.44	09-Dec-81	PAGE	1-160


                         C      
  F2B5    DD 7E 02       C      S9.AL:      LD      A,(IX+2)            ;Segment            absoluter Loader
  F2B8    F5             C                  PUSH    AF
  F2B9    DD 7E 00       C                  LD      A,(IX+0)            ;Geraet
  F2BC    CD F061        C                  CALL    S9.RGLI+3
  F2BF    CD F332        C                  CALL    S9.MRPAR
  F2C2    F1             C                  POP     AF
  F2C3    FE 00          C                  CP      0
  F2C5    28 06          C                  JR      Z,S9.AL3
  F2C7    CD F576        C                  CALL    S4.UM15
  F2CA    CD F576        C                  CALL    S4.BWS
  F2CD    CD E106        C      S9.AL3:     CALL    LO.AL
  F2D0    F5             C      S9.AL2:     PUSH    AF
  F2D1    21 F636        C                  LD      HL,S0.BWSB
  F2D4    11 B2D4        C                  LD      DE,S2.STACK
  F2D7    01 000A        C                  LD      BC,S0.BASCL-S0.BWSB
  F2DA    ED B0          C                  LDIR
  F2DC    F1             C                  POP     AF
  F2DD    C2 DF4C        C                  JP      NZ,LO.LO13
  F2E0    18 D1          C      S9.AL1:     JR      S9.SC52E
                         C      
  F2E2    DD 6E 00       C      S9.RL:      LD      L,(IX+0)            ;Ladeanfangsadresse relativer Loader
  F2E5    DD 66 01       C                  LD      H,(IX+1)
  F2E8    22 B265        C                  LD      (S2.PRGN),HL
  F2EB    DD 7E 04       C                  LD      A,(IX+4)            ;Segment
  F2EE    F5             C                  PUSH    AF
  F2EF    DD 7E 02       C                  LD      A,(IX+2)            ;Geraet
  F2F2    CD F061        C                  CALL    S9.RGLI+3
  F2F5    CD F332        C                  CALL    S9.MRPAR
  F2F8    F1             C                  POP     AF
  F2F9    FE 00          C                  CP      0
  F2FB    28 06          C                  JR      Z,S9.RL1
  F2FD    CD F576        C                  CALL    S4.UM15
  F300    CD F576        C                  CALL    S4.BWS
  F303    CD E137        C      S9.RL1:     CALL    LO.RL
  F306    18 C8          C                  JR      S9.AL2
                         C      
  F308    DD 7E 00       C      S9.MRIO:    LD      A,(IX+0)            ;MRES Eingabe-Eroeffnung
  F30B    32 B25F        C                  LD      (S2.IM),A
  F30E    CD F061        C                  CALL    S9.RGLI+3
  F311    CD F332        C                  CALL    S9.MRPAR
  F314    CD DC21        C                  CALL    K1.MREPO
  F317    18 B7          C                  JR      S9.AL2
                         C      
  F319    DD 7E 00       C      S9.MRAO:    LD      A,(IX+0)            ;MRES Ausgabe-Eroeffnung
  F31C    32 B260        C                  LD      (S2.OM),A
  F31F    CD F071        C                  CALL    S9.RGLO+3
  F322    CD F332        C                  CALL    S9.MRPAR
  F325    CD DC63        C                  CALL    K1.MRAPO
  F328    18 A6          C                  JR      S9.AL2
                         C      
  F32A    CD F06E        C      S9.MRAC:    CALL    S9.RGLO             ;MRES Ausgabe-Abschluss
  F32D    CD DCC0        C                  CALL    K1.MRCLS
  F330    18 AE          C                  JR      S9.AL1
                         C      
                         C      
  F332    DD E5          C      S9.MRPAR:   PUSH    IX                  ;MRES-Parameter uebernehmen
  F334    FD E5          C                  PUSH    IY
  F336    FD E5          C                  PUSH    IY
  F338    26 53          C                  LD      H,'S'
  F33A    2E D9          C                  LD      L,59H+80H
  F33C    CD EE7D        C                  CALL    S9.NSTR
  F33F    28 00          C                  JR      Z,S9.MR1
  F341    D1             C      S9.MR1:     POP     DE
  F342    01 000E        C                  LD      BC,14
  F345    ED B0          C                  LDIR
  F347    FD E1          C                  POP     IY
  F349    DD E1          C                  POP     IX
  F34B    C9             C                  RET
                         C      
                         C                  PAGE
'Anschlussroutinen'	MACRO-80 3.44	09-Dec-81	PAGE	1-161


                         C      
  F34C    CD F626        C      S9.SPAUS:   CALL    S0.BWSU1            ;B W S  ===>  B W S A
  F34F    21 E694        C                  LD      HL,S9.CIN
  F352    01 E6E3        C                  LD      BC,S9.CON
  F355    22 030A        C      S9.SPA:     LD      (BC.CIN+1),HL
  F358    ED 43 0310     C                  LD      (BC.CON+1),BC
  F35C    18 49          C                  JR      S9.CONOO
                         C      
  F35E    2A B194        C      S9.SPI:     LD      HL,(MS.BWSA)
  F361    22 B292        C                  LD      (S2.DMANF),HL
  F364    21 F37A        C                  LD      HL,S9.SPIN
  F367    01 ECF9        C                  LD      BC,S9.IOX
  F36A    18 E9          C                  JR      S9.SPA
                         C      
  F36C    2A B194        C      S9.SPO:     LD      HL,(MS.BWSA)
  F36F    22 B292        C                  LD      (S2.DMANF),HL
  F372    21 ECF9        C                  LD      HL,S9.IOX
  F375    01 F385        C                  LD      BC,S9.SPOUT
  F378    18 DB          C                  JR      S9.SPA
                         C      
  F37A    E5             C      S9.SPIN:    PUSH    HL
  F37B    2A B292        C                  LD      HL,(S2.DMANF)
  F37E    7E             C                  LD      A,(HL)
  F37F    23             C                  INC     HL
  F380    22 B292        C                  LD      (S2.DMANF),HL
  F383    E1             C                  POP     HL
  F384    C9             C                  RET
                         C      
  F385    E5             C      S9.SPOUT:   PUSH    HL
  F386    2A B292        C                  LD      HL,(S2.DMANF)
  F389    71             C                  LD      (HL),C
  F38A    23             C                  INC     HL
  F38B    22 B292        C                  LD      (S2.DMANF),HL
  F38E    E1             C                  POP     HL
  F38F    C9             C                  RET
                         C      
  F390    21 B41E        C      S9.ICON:    LD      HL,0B41EH
  F393    18 03          C                  JR      $+5
  F395    21 B420        C      S9.OCON:    LD      HL,0B420H
  F398    36 FF          C                  LD      (HL),-1
  F39A    DD 7E 00       C                  LD      A,(IX+0)
  F39D    23             C                  INC     HL
  F39E    77             C                  LD      (HL),A
  F39F    18 06          C                  JR      S9.CONOO
                         C      
                         C                  PAGE
'Anschlussroutinen'	MACRO-80 3.44	09-Dec-81	PAGE	1-162


                         C      
  F3A1    21 E716        C      S9.CONO:    LD      HL,S9.CONOC
  F3A4    22 0310        C                  LD      (BC.CON+1),HL
  F3A7    C3 B403        C      S9.CONOO:   JP      0B403H
                         C      
  F3AA    2A B19C        C      S9.APOS:    LD      HL,(MS.MCZ)         ;alte Position rueckspeichern
  F3AD    22 B18C        C      S9.APOS1:   LD      (MS.ZPOS),HL
  F3B0    3E 06          C                  LD      A,6                 ;Cursor setzen
  F3B2    32 B198        C                  LD      (MS.CMD),A
  F3B5    CD CB16        C                  CALL    MO.MONI
  F3B8    18 ED          C                  JR      S9.CONOO
                         C      
  F3BA    3E 07          C      S9.NPOS:    LD      A,7                 ;Cursor loeschen
  F3BC    32 B198        C                  LD      (MS.CMD),A
  F3BF    CD CB16        C                  CALL    MO.MONI
  F3C2    2A B18C        C                  LD      HL,(MS.ZPOS)        ;alte Position retten
  F3C5    22 B19C        C                  LD      (MS.MCZ),HL
  F3C8    DD 66 00       C                  LD      H,(IX+0)            ;neue Position uebernehmen
  F3CB    DD 6E 02       C                  LD      L,(IX+2)
  F3CE    25             C                  DEC     H
  F3CF    2D             C                  DEC     L
  F3D0    22 B18C        C                  LD      (MS.ZPOS),HL
  F3D3    18 D2          C                  JR      S9.CONOO
                         C      
  F3D5    DD 66 00       C      S9.CPOS:    LD      H,(IX+0)            ;neue Position uebernehmen
  F3D8    DD 6E 02       C                  LD      L,(IX+2)
  F3DB    25             C                  DEC     H
  F3DC    2D             C                  DEC     L
  F3DD    18 CE          C                  JR      S9.APOS1
                         C      
  F3DF    DD 66 02       C      S9.NFENS:   LD      H,(IX+2)            ;zmin , zmax , smin , smax
  F3E2    DD 6E 06       C                  LD      L,(IX+6)            ;7 6    5 4    3 2    1 0
  F3E5    22 B18E        C                  LD      (MS.ZMIN),HL
  F3E8    DD 66 00       C                  LD      H,(IX+0)
  F3EB    DD 6E 04       C                  LD      L,(IX+4)
  F3EE    22 B190        C                  LD      (MS.ZMAX),HL
  F3F1    18 B4          C                  JR      S9.CONOO
                         C      
  F3F3    CD CBE4        C      S9.SFENS:   CALL    MO.VB2
  F3F6    18 AF          C                  JR      S9.CONOO
                         C      
  F3F8    DD 7E 00       C      S9.IOC:     LD      A,(IX+0)            ;Umschalter  I O C
  F3FB    32 B264        C                  LD      (S2.IOC),A
  F3FE    CD C67C        C      S9.IOC1:    CALL    S1.STAT
  F401    18 A4          C      S9.TAS01:   JR      S9.CONOO
                         C      
  F403    DD 7E 00       C      S9.TAS0:    LD      A,(IX+0)            ;Umschalter  P/S - T A S
  F406    32 B241        C                  LD      (TS.KGMER),A
  F409    18 F3          C                  JR      S9.IOC1
                         C      
  F40B    DD 7E 00       C      S9.SVC13:   LD      A,(IX+0)            ;setzen von  MS.DIRES
  F40E    32 B197        C                  LD      (MS.DIRES),A
  F411    18 EE          C                  JR      S9.TAS01
                         C      
                         C                  PAGE
'Anschlussroutinen'	MACRO-80 3.44	09-Dec-81	PAGE	1-163


                         C      
  F413    21 EC1B        C      S9.SVC17:   LD      HL,S9.WRTV          ;L-Device als Kassettenausgabe
  F416    22 0316        C                  LD      (00316H),HL
  F419    18 E6          C                  JR      S9.TAS01
                         C      
  F41B    DD 7E 00       C      S9.SVC18:   LD      A,(IX+0)            ;MRES-Verzeichniseintr. uebermitteln
  F41E    F5             C                  PUSH    AF
  F41F    DD 7E 02       C                  LD      A,(IX+2)
  F422    32 B25F        C                  LD      (S2.IM),A
  F425    CD F061        C                  CALL    S9.RGLI+3
  F428    F1             C                  POP     AF
  F429    FE 02          C                  CP      2
  F42B    28 1C          C                  JR      Z,S9.SC181
  F42D    FE 01          C                  CP      1
  F42F    20 D0          C                  JR      NZ,S9.TAS01
  F431    CD D745        C                  CALL    K1.GNRE             ;Par=1  OPEN
  F434    CD D77D        C                  CALL    K1.GNRW
  F437    16 02          C                  LD      D,2
  F439    CD D7F0        C                  CALL    K1.GNLPN
  F43C    CD D898        C                  CALL    K1.GNRD
  F43F    CD D898        C                  CALL    K1.GNRD
  F442    3A B017        C                  LD      A,(KS.PUFFS+4)
  F445    3D             C                  DEC     A
  F446    32 B261        C                  LD      (S2.VZM),A
  F449    3A B261        C      S9.SC181:   LD      A,(S2.VZM)          ;Par=2  READ
  F44C    3D             C                  DEC     A
  F44D    32 B261        C                  LD      (S2.VZM),A
  F450    FE FF          C                  CP      0FFH
  F452    28 17          C                  JR      Z,S9.SC183
  F454    CD D898        C                  CALL    K1.GNRD
  F457    26 53          C      S9.SC184:   LD      H,'S'
  F459    2E D9          C                  LD      L,59H+80H
  F45B    CD EE7D        C                  CALL    S9.NSTR
  F45E    28 A1          C                  JR      Z,S9.TAS01
  F460    EB             C                  EX      DE,HL
  F461    21 B014        C                  LD      HL,KS.PUFFS+1
  F464    01 0017        C                  LD      BC,23
  F467    ED B0          C                  LDIR
  F469    18 96          C      S9.SC182:   JR      S9.TAS01
  F46B    3C             C      S9.SC183:   INC     A
  F46C    32 B261        C                  LD      (S2.VZM),A
  F46F    21 B014        C                  LD      HL,KS.PUFFS+1
  F472    11 B015        C                  LD      DE,KS.PUFFS+2
  F475    01 000D        C                  LD      BC,13
  F478    36 20          C                  LD      (HL),' '
  F47A    ED B0          C                  LDIR
  F47C    18 D9          C                  JR      S9.SC184
                         C      
                         C                  PAGE
'Anschlussroutinen'	MACRO-80 3.44	09-Dec-81	PAGE	1-164


                         C      
  F47E    3A B25F        C      S9.SVC43:   LD      A,(S2.IM)           ;Eingabedatei an Anfang pos.
  F481    B7             C                  OR      A
  F482    CA EB89        C                  JP      Z,S9.RIVF
  F485    CD F061        C                  CALL    S9.RGLI+3
  F488    16 00          C                  LD      D,0
  F48A    CD D60B        C                  CALL    K1.BM
  F48D    20 01          C                  JR      NZ,$+3
  F48F    14             C                  INC     D
  F490    CD D828        C                  CALL    K1.GNLMN
  F493    18 D4          C                  JR      S9.SC182
                         C      
  F495    DD 7E 00       C      S9.SVC44:   LD      A,(IX+0)            ;Umschalter ON-/IN- KEY
  F498    FE 01          C                  CP      1
  F49A    28 0E          C                  JR      Z,S9.SC441
  F49C    FE 02          C                  CP      2
  F49E    28 0F          C                  JR      Z,S9.SC442
  F4A0    21 ECFA        C                  LD      HL,S9.USER
  F4A3    3E C3          C                  LD      A,0C3H
  F4A5    11 E6C8        C                  LD      DE,S9.CSTSX
  F4A8    18 0D          C                  JR      S9.SC444
  F4AA    21 ED46        C      S9.SC441:   LD      HL,S9.USER2
  F4AD    18 03          C                  JR      S9.SC443
  F4AF    21 ED97        C      S9.SC442:   LD      HL,S9.USER3
  F4B2    3E AF          C      S9.SC443:   LD      A,0AFH
  F4B4    11 00C9        C                  LD      DE,000C9H
  F4B7    22 0307        C      S9.SC444:   LD      (BC.USR+1),HL
  F4BA    32 0318        C                  LD      (BC.CSTSX),A
  F4BD    ED 53 0319     C                  LD      (BC.CSTSX+1),DE
  F4C1    18 A6          C      S9.SC449:   JR      S9.SC182
                         C      
  F4C3    DD 7E 00       C      S9.SVC14:   LD      A,(IX+0)            ;HOME-Taste ein-/aus- schalten
  F4C6    B7             C                  OR      A
  F4C7    20 04          C                  JR      NZ,$+6
  F4C9    3E C9          C                  LD      A,0C9H
  F4CB    18 02          C                  JR      $+4
  F4CD    3E C3          C                  LD      A,0C3H
  F4CF    32 B415        C                  LD      (0B415H),A
  F4D2    18 ED          C                  JR      S9.SC449
                         C      
                         C                  PAGE
'Anschlussroutinen'	MACRO-80 3.44	09-Dec-81	PAGE	1-165


                         C      
  F4D4    3A B25F        C      S9.SVC19:   LD      A,(S2.IM)           ;Eingabegeraet aktiv JA/NEIN ?
  F4D7    B7             C                  OR      A
  F4D8    20 04          C                  JR      NZ,$+6
  F4DA    3E 30          C                  LD      A,'0'
  F4DC    18 02          C                  JR      $+4
  F4DE    3E 31          C                  LD      A,'1'
  F4E0    CD EE86        C                  CALL    S9.ERS
  F4E3    18 DC          C      S9.SC191:   JR      S9.SC449
                         C      
  F4E5    FD 21 B422     C      S9.SVC32:   LD      IY,0B422H           ;Eingabe-Kodetransformation ein
  F4E9    18 04          C                  JR      S9.SC331
                         C      
  F4EB    FD 21 B425     C      S9.SVC33:   LD      IY,0B425H           ;Ausgabe-Kodetransformation ein
  F4EF    DD 66 01       C      S9.SC331:   LD      H,(IX+1)
  F4F2    DD 6E 00       C                  LD      L,(IX+0)
  F4F5    FD 36 00 C3    C                  LD      (IY+0),0C3H
  F4F9    FD 75 01       C                  LD      (IY+1),L
  F4FC    FD 74 02       C                  LD      (IY+2),H
  F4FF    18 E2          C      S9.SC333:   JR      S9.SC191
                         C      
  F501    DD 7E 00       C      S9.SVC27:   LD      A,(IX+0)
  F504    FE 02          C                  CP      2
  F506    F5             C                  PUSH    AF
  F507    26 4B          C                  LD      H,'K'
  F509    2E D3          C                  LD      L,53H+80H
  F50B    CD EE7D        C                  CALL    S9.NSTR
  F50E    28 4A          C                  JR      Z,S9.SC271
  F510    F1             C                  POP     AF
  F511    E5             C                  PUSH    HL
  F512    D5             C                  PUSH    DE
  F513    28 29          C                  JR      Z,S9.SC272
  F515    3A B25F        C                  LD      A,(S2.IM)           ;wert = 1  ...   Eingabe
  F518    B7             C                  OR      A
  F519    CA EFC2        C                  JP      Z,S9.CLO2
  F51C    C1             C                  POP     BC                  ;KS$="   "
  F51D    0B             C                  DEC     BC
  F51E    D1             C                  POP     DE
  F51F    D5             C                  PUSH    DE
  F520    13             C                  INC     DE
  F521    36 20          C                  LD      (HL),' '
  F523    ED B0          C                  LDIR
  F525    CD F05E        C                  CALL    S9.RGLI             ;Datenblock einlesen
  F528    CD DB48        C                  CALL    K1.EINP
  F52B    CD D60B        C                  CALL    K1.BM
  F52E    20 06          C                  JR      NZ,S9.SC273
  F530    CD EBD9        C                  CALL    S9.BM3
  F533    E1             C                  POP     HL
  F534    18 C9          C                  JR      S9.SC333
  F536    CD D5FE        C      S9.SC273:   CALL    K1.LHLBC            ;KS$= Datenblock
  F539    D1             C                  POP     DE
  F53A    ED B0          C                  LDIR
  F53C    18 17          C                  JR      S9.SC279
  F53E    3A B25F        C      S9.SC272:   LD      A,(S2.IM)           ;wert = 2  ...   Ausgabe
  F541    B7             C                  OR      A
  F542    CA EFC2        C                  JP      Z,S9.CLO2
  F545    CD F05E        C                  CALL    S9.RGLI
  F548    D1             C                  POP     DE
  F549    CD D5FE        C                  CALL    K1.LHLBC
  F54C    C5             C                  PUSH    BC
  F54D    CD D7BD        C                  CALL    K1.GNRM
  F550    C1             C                  POP     BC
  F551    E1             C                  POP     HL
  F552    CD D92C        C                  CALL    K1.GNRWR
  F555    CD D6EE        C      S9.SC279:   CALL    K1.GNSTS
  F558    18 A5          C                  JR      S9.SC333
  F55A    F1             C      S9.SC271:   POP     AF
  F55B    18 A2          C      S9.SC278:   JR      S9.SC333
                         C      
  F55D    DD 7E 02       C      S9.SVC39:   LD      A,(IX+2)            ;Richtung
  F560    06 34          C                  LD      B,52
  F562    80             C                  ADD     A,B
  F563    32 B198        C                  LD      (MS.CMD),A
  F566    DD 46 00       C                  LD      B,(IX+0)            ;Anzahl Verschiebungen
  F569    CD CB16        C      S9.SC391:   CALL    MO.MONI
  F56C    10 FB          C                  DJNZ    S9.SC391
  F56E    18 EB          C      S9.SC399:   JR      S9.SC278
                         C      
                         C      
                         C      
                         C      ;           END
                         C      ;           PN      S424
'BASIC- SVC - Routinen fuer Speichererweiterung'	MACRO-80 3.44	09-Dec-81	PAGE	1-166


                         C                  TITLE   'BASIC- SVC - Routinen fuer Speichererweiterung'
                         C                  PAGE
'BASIC- SVC - Routinen fuer Speichererweiterung'	MACRO-80 3.44	09-Dec-81	PAGE	1-167


                         C      
                         C      ;****************************************************************
                         C      ;*               BASIC- SVC - Routinen fuer Speichererweiterung *
                         C      ;*  Version      -----------------------------------------------*
                         C      ;*               Programmierer: M. Herbote --- K EAW  ZFT (WFT) *
                         C      ;*  V 2 . 1      -----------------------------------------------*
                         C      ;*               Stand        : 14.Maerz 1985                   *
                         C      ;****************************************************************
                         C      
  0031                   C      S4.V1       EQU     '1'                 ;  1 ... ohne   Erweiterung
                         C                                              ;  8 ... mit    Erweiterung
                         C      
  0031                   C      S4.V2       EQU     '1'                 ;  1 ... DEG 2.i von Kassette
                         C                                              ;  2 ... DEG 2.i von EPROM
                         C      
  00C0                   C      S4.SBST     EQU     0C0H                ;Adresse der Speicherblockst.
                         C      
  00C0                   C      S4.U1       EQU     000C0H              ;Adresse der Umschalt-UP
  0040                   C      S4.U2       EQU     00040H              ;Adresse der Einzel  -UP
                         C      
                         C      
                         C                  IF      S4.V1 AND 1
  F570    0000           C      S4.UM6:     DW      0
  F572    0000           C                  DW      0
  F574    0000           C                  DW      0
  F576                   C      S4.BWS      EQU     $
  F576                   C      S4.BWS1     EQU     $
  F576                   C      S4.UM15     EQU     $
  F576    C9             C      S4.BSCN:    RET
                         C      
  F577                   C      S4.SVC10    EQU     $
  F577                   C      S4.SVC52    EQU     $
  F577                   C      S4.SVC60    EQU     $
  F577                   C      S4.SVC61    EQU     $
  F577                   C      S4.SVC62    EQU     $
  F577                   C      S4.SVC63    EQU     $
  F577                   C      S4.SVC64    EQU     $
  F577                   C      S4.SVC65    EQU     $
  F577                   C      S4.SVC66    EQU     $
  F577                   C      S4.SVC67    EQU     $
  F577                   C      S4.SVC68    EQU     $
  F577                   C      S4.SVC69    EQU     $
  F577                   C      S4.SC700    EQU     $
  F577                   C      S4.SC710    EQU     $
  F577                   C      S4.SC720    EQU     $
  F577                   C      S4.SC730    EQU     $
  F577                   C      S4.SC740    EQU     $
  F577                   C      S4.SC750    EQU     $
  F577                   C      S4.SC760    EQU     $
  F577    C3 B403        C      S4.UM16:    JP      0B403H
                         C      
  F57A    21 F636        C      S4.RES:     LD      HL,S0.BWSB
  F57D    11 B2D4        C                  LD      DE,S2.STACK
  F580    01 000A        C                  LD      BC,S0.BASCL-S0.BWSB
  F583    ED B0          C                  LDIR
  F585    C3 C084        C                  JP      S1.RES1
                         C                  ENDIF
                         C      
                         C                  PAGE
'BASIC- SVC - Routinen fuer Speichererweiterung'	MACRO-80 3.44	09-Dec-81	PAGE	1-168


                         C      
                         C                  IF      S4.V1 AND 8
                         C      ;****************************************************************
                         C      ;*               T I M E R  -  Routine                          *
                         C      ;****************************************************************
                         C      S4.SVC10:   CALL    S4.TIM01
                         C                  JP      0B403H
                         C      
                         C      S4.TIM01:   PUSH    HL
                         C                  PUSH    BC
                         C                  PUSH    AF
                         C                  LD      A,S0.CTC0
                         C                  OUT     (C),080H
                         C                  LD      A,0A7H
                         C                  OUT     (C),080H
                         C                  LD      A,060H
                         C                  OUT     (C),080H
                         C                  LD      HL,S4.TIM1
                         C                  LD      B,4
                         C                  LD      (HL),0
                         C                  INC     HL
                         C                  DJNZ    $-3
                         C                  POP     AF
                         C                  POP     BC
                         C                  POP     HL
                         C                  RET
                         C      
                         C      S4.IRTIM:   PUSH    HL
                         C                  PUSH    AF
                         C                  LD      HL,S4.TIM4
                         C                  INC     (HL)
                         C                  LD      A,(HL)
                         C                  CP      064H
                         C                  JR      NZ,S4.TIM02
                         C                  LD      (HL),0
                         C                  DEC     HL
                         C                  INC     (HL)
                         C                  LD      A,(HL)
                         C                  CP      03CH
                         C      S4.TIM02:   JR      NZ,S4.TIM03
                         C                  LD      (HL),0
                         C                  DEC     HL
                         C                  INC     (HL)
                         C                  LD      A,(HL)
                         C                  CP      03CH
                         C      S4.TIM03:   JR      NZ,S4.TIM04
                         C                  LD      (HL),0
                         C                  DEC     HL
                         C                  INC     (HL)
                         C      S4.TIM04:   POP     AF
                         C                  POP     HL
                         C                  EI
                         C                  RETI
                         C      
                         C      S4.TIM1     EQU     0B2FCH
                         C      S4.TIM4     EQU     S4.TIM1+3
                         C      
                         C                  PAGE
                         C      ;****************************************************************
                         C      ;*               S V C 5 2   Ausgabe von Speicherbereichen      *
                         C      ;*                           als  MRES-P-Dateien                *
                         C      ;****************************************************************
                         C      S4.SVC52:   LD      A,(S2.OM)
                         C                  OR      A
                         C                  JP      Z,S9.WRTVF
                         C                  LD      L,(IX+4)            ;Anfangs- bzw. Start- Adresse
                         C                  LD      H,(IX+5)
                         C                  LD      C,(IX+2)            ;Anzahl Byte  bzw.  0
                         C                  LD      B,(IX+3)
                         C                  LD      (S2.PRGN),HL        ;Anfangsadresse
                         C                  ADD     HL,BC
                         C                  DEC     HL
                         C                  LD      (S2.PRGN+2),HL      ;Endadresse
                         C                  LD      A,(IX+0)            ;operation 1 bzw. 2
                         C                  CP      2
                         C                  JR      Z,S4.SC523
                         C                  CP      1
                         C                  JR      Z,S4.SC521
                         C      S4.SC52E:   JP      0B403H              ;Rueckkehr zu  BASIC
                         C      
                         C      S4.SC521:   LD      A,(IX+6)            ;Segment
                         C                  OR      A
'BASIC- SVC - Routinen fuer Speichererweiterung'	MACRO-80 3.44	09-Dec-81	PAGE	1-169


                         C                  JR      Z,S4.SC522
                         C                  CALL    S4.UM15
                         C                  CALL    S4.BWS
                         C      S4.SC522:   CALL    S9.RGLO
                         C                  CALL    LO.SAVE
                         C                  JR      S4.SC52E
                         C      
                         C      S4.SC523:   CALL    S9.RGLO
                         C                  LD      DE,(S2.PRGN)
                         C                  XOR     A
                         C                  CALL    K1.SCHR
                         C                  LD      A,D
                         C                  CALL    K1.SCHR
                         C                  LD      A,E
                         C                  CALL    K1.SCHR
                         C                  CALL    K1.MRCLS
                         C                  JR      S4.SC52E
                         C      
                         C                  PAGE
                         C      ;****************************************************************
                         C      ;*               Zusaetze zur Systeminitialisierung             *
                         C      ;****************************************************************
                         C      S4.BSCN:    LD      HL,S4.UUM4          ;Umschalt - Unterprogramme laden
                         C                  LD      DE,S4.U1
                         C                  LD      BC,S4.UM7-S4.UUM4
                         C                  LDIR
                         C                  RET
                         C      
                         C      
                         C      S4.RES:     LD      SP,S0.STACK
                         C                  CALL    S4.BSCN
                         C                  LD      HL,S0.BWSB          ;BWS-Umschalt-UP's umladen
                         C                  LD      DE,S2.STACK
                         C                  LD      BC,S0.BASCL-S0.BWSB
                         C                  LDIR
                         C                  OUT     (C),S4.SBST+4       ;RESET-Sperre aus
                         C      
                         C                  IF      S4.V2 AND 1         ;OPS (0000H,4000H) wegschalten
                         C                  LD      A,00000000B
                         C                  ENDIF
                         C                  IF      S4.V2 AND 2
                         C                  LD      A,00000001B
                         C                  ENDIF
                         C                  OUT     (C),S4.SBST+1
                         C      
                         C                  IF      S4.V2 AND 1         ;OFS (1000H) zuschalten
                         C                  LD      A,10100101B
                         C                  ENDIF
                         C                  IF      S4.V2 AND 2
                         C                  LD      A,10110101B
                         C                  ENDIF
                         C                  OUT     (C),S4.SBST+0
                         C      
                         C                  LD      SP,02900H
                         C                  LD      HL,02B00H           ;16K Byte-Merker (ZSM) loeschen
                         C                  LD      DE,02B01H
                         C                  LD      BC,8
                         C                  LD      (HL),0
                         C                  LDIR
                         C      
                         C                  IF      S4.V2 AND 1
                         C                  XOR     A
                         C                  ENDIF
                         C                  IF      S4.V2 AND 2
                         C                  LD      A,00010011B         ;16K Byte-RAM Platte aus SYS0
                         C                  ENDIF
                         C                  LD      (S2.S1),A
                         C      
                         C                  LD      HL,S4.UP            ;nachf. Progr.teil laden
                         C                  LD      DE,02A00H
                         C                  LD      BC,S4.UP1E-S4.UP
                         C                  LDIR
                         C                  JP      02A00H              ;entspricht  "UP"
                         C      
                         C                  PAGE
                         C      ;****************************************************************
                         C      ;*               Start eines Programms von einer Platte  1iH    *
                         C      ;****************************************************************
                         C                  DW      $                   ;STRT 1i,prog .... ....
                         C                  DB      'STRT'
                         C                  LD      H,7                 ;ZPOL=SYSZ , SPOL= 8
                         C                  LD      L,S0.SYSZ-1
                         C                  LD      (MS.ZPOL),HL
'BASIC- SVC - Routinen fuer Speichererweiterung'	MACRO-80 3.44	09-Dec-81	PAGE	1-170


                         C                  LD      A,31
                         C                  LD      (MS.CMD),A
                         C                  CALL    MO.MONI
                         C                  CALL    S1.HBKON
                         C                  INC     HL
                         C                  EXX
                         C                  LD      E,10H
                         C                  CALL    S4.SC64
                         C                  OR      A
                         C                  JP      NZ,S1.SYSTB
                         C                  LD      (S2.SMHL),HL
                         C                  CALL    S4.UU4
                         C                  EXX
                         C                  PUSH    HL
                         C                  LD      DE,8
                         C                  OR      A
                         C                  SBC     HL,DE
                         C                  POP     DE
                         C                  EX      DE,HL
                         C                  LD      BC,22
                         C                  LDIR
                         C                  CALL    S4.BWS
                         C                  CALL    S0.BWSUS
                         C                  JP      S1.START
                         C      
                         C                  PAGE
                         C      ;****************************************************************
                         C      ;*               Routinen  S0.BWSZU und S0.BWSAB  modifizieren  *
                         C      ;****************************************************************
                         C      S4.BWS:     EXX
                         C      S4.BWS1     EQU     $
                         C      
                         C                  IF      S4.V2 AND 1         ;SYS 1 - BWSZU
                         C                  LD      A,00000000B
                         C                  ENDIF
                         C                  IF      S4.V2 AND 2
                         C                  LD      A,00000001B
                         C                  ENDIF
                         C                  LD      (S2.STACK+5),A
                         C      
                         C                  IF      S4.V2 AND 1         ;SYS 1 - BWSAB
                         C                  LD      A,10000000B
                         C                  ENDIF
                         C                  IF      S4.V2 AND 2
                         C                  LD      A,10000001B
                         C                  ENDIF
                         C                  LD      (S2.STACK+26),A
                         C      
                         C                  LD      A,(HL)              ;SYS 2
                         C                  AND     00011100B
                         C                  RRCA
                         C                  RRCA
                         C                  INC     A
                         C                  LD      B,A
                         C                  LD      A,10000000B
                         C                  RLCA
                         C                  DJNZ    $-1
                         C                  LD      (S2.STACK+13),A     ;SYS 2 - BWSZU
                         C                  LD      (S2.STACK+30),A     ;SYS 2 - BWSAB
                         C                  RET
                         C      
                         C                  PAGE
                         C      ;****************************************************************
                         C      ;*               Eingabe vom Zusatzspeicher aktivieren          *
                         C      ;****************************************************************
                         C      S4.SVC61:   CALL    S4.SC63
                         C                  CALL    S4.SC600
                         C                  LD      HL,S4.EIN-2
                         C                  CALL    S4.LDIR
                         C                  LD      HL,S4.U2            ;"EIN"
                         C                  LD      BC,S9.IOX
                         C      S4.SC611:   JP      S9.SPA
                         C      ;****************************************************************
                         C      ;*               Ausgabe auf Zusatzspeicher aktivieren          *
                         C      ;****************************************************************
                         C      S4.SVC62:   CALL    S4.SC63
                         C                  CALL    S4.SC600
                         C                  LD      HL,S4.AUS-2
                         C                  CALL    S4.LDIR
                         C                  LD      HL,S9.IOX
                         C                  LD      BC,S4.U2            ;"AUS"
                         C                  JR      S4.SC611
                         C      ;****************************************************************
'BASIC- SVC - Routinen fuer Speichererweiterung'	MACRO-80 3.44	09-Dec-81	PAGE	1-171


                         C      ;*               Leserkanal   auf Erweiterung schalten          *
                         C      ;****************************************************************
                         C      S4.SVC63:   CALL    S4.SC63
                         C                  CALL    S4.SC600
                         C                  LD      HL,S4.EIN-2
                         C                  CALL    S4.LDIR
                         C                  LD      HL,S4.U2            ;"EIN"
                         C                  LD      (BC.RIV+1),HL
                         C                  JP      0B403H
                         C      ;****************************************************************
                         C      ;*               Stanzerkanal auf Erweiterung schalten          *
                         C      ;****************************************************************
                         C      S4.SVC64:   CALL    S4.SC63
                         C                  CALL    S4.SC600
                         C                  LD      HL,S4.AUS-2
                         C                  CALL    S4.LDIR
                         C                  LD      HL,S4.U2            ;"AUS"
                         C                  LD      (BC.WRTV+1),HL
                         C                  JP      0B403H
                         C      ;****************************************************************
                         C      ;*               Leser- und Stanzerkanal zuruecksetzen          *
                         C      ;****************************************************************
                         C      S4.SVC65:   LD      HL,S9.RIV
                         C                  LD      (BC.RIV+1),HL
                         C                  LD      HL,S9.WRTV
                         C                  LD      (BC.WRTV+1),HL
                         C                  JP      0B403H
                         C      ;****************************************************************
                         C      ;*               Lese- und Schreib- pointer setzen              *
                         C      ;****************************************************************
                         C      S4.SVC66:   INC     IX
                         C                  INC     IX
                         C                  CALL    S4.SC60
                         C                  CALL    S4.SC600
                         C                  LD      H,(IX+1)
                         C                  LD      L,(IX+0)
                         C                  PUSH    HL
                         C                  LD      H,(IX-1)
                         C                  LD      L,(IX-2)
                         C                  PUSH    HL
                         C                  LD      HL,S4.UM14-2
                         C                  JR      S4.SC699
                         C      
                         C      
                         C      ;****************************************************************
                         C      ;*               allgemeine Organisation des Zusatzspeichers    *
                         C      ;****************************************************************
                         C      S4.SC600:   OR      A
                         C                  JR      NZ,S4.SC698
                         C                  LD      (S2.SMHL),HL
                         C                  RET
                         C      S4.SC698:   POP     HL
                         C                  JP      0B403H
                         C      
                         C      S4.SVC60:   LD      HL,S4.UUM4
                         C                  LD      DE,S4.U1
                         C                  LD      BC,S4.UM7-S4.UUM4
                         C                  LDIR
                         C                  LD      A,(IX+0)            ;Parameter
                         C                  CP      1
                         C                  JR      Z,S4.SC601
                         C                  CP      2
                         C                  JR      Z,S4.SC602
                         C                  CP      3
                         C                  JR      Z,S4.SC603
                         C                  CP      4
                         C                  JR      Z,S4.SC604
                         C                  CP      5
                         C                  JR      Z,S4.SC605
                         C                  CP      6
                         C                  JR      Z,S4.SC606
                         C                  CP      7
                         C                  JR      Z,S4.SC607
                         C                  LD      A,3
                         C                  JR      S4.SC600
                         C      
                         C      S4.SC601:   CALL    S4.SC60             ;par=1   16K initialisieren
                         C                  CALL    S4.SC600
                         C                  LD      HL,S4.UM1-2
                         C      S4.SC699:   CALL    S4.LDIR
                         C                  JP      S4.U2
                         C      
                         C      S4.SC602:   CALL    S4.SC60             ;par=2   Schreib- = Lese- Pointer
'BASIC- SVC - Routinen fuer Speichererweiterung'	MACRO-80 3.44	09-Dec-81	PAGE	1-172


                         C                  CALL    S4.SC600
                         C                  LD      HL,S4.UM8-2
                         C                  JR      S4.SC699
                         C      
                         C      S4.SC603:   CALL    S4.SC60             ;par=3   setzen ersten freien Platz
                         C                  CALL    S4.SC600
                         C                  LD      HL,S4.UM9-2
                         C                  JR      S4.SC699
                         C      
                         C      S4.SC604:   CALL    S4.SC60             ;par=4   Schreib- pointer = 1. fr. Platz
                         C                  CALL    S4.SC600
                         C                  LD      HL,S4.UM10-2
                         C                  JR      S4.SC699
                         C      
                         C      S4.SC605:   CALL    S4.SC60             ;par=5   Lese-    pointer = Anfang
                         C                  CALL    S4.SC600
                         C                  LD      HL,S4.UM11-2
                         C                  JR      S4.SC699
                         C      
                         C      S4.SC606:   CALL    S4.SC60             ;par=6   Schreib- pointer = Anfang
                         C                  CALL    S4.SC600
                         C                  LD      HL,S4.UM12-2
                         C                  JR      S4.SC699
                         C      S4.SC607:   CALL    S4.SC60             ;par=7   Lese-/Schreib- pointer lesen
                         C                  CALL    S4.SC600
                         C                  LD      HL,S4.UM13-2
                         C                  JR      S4.SC699
                         C      
                         C      S4.SC617:   CALL    S9.ERSTR
                         C                  JP      Z,0B403H
                         C                  LD      DE,7
                         C                  ADD     HL,DE
                         C                  POP     DE
                         C                  LD      A,D
                         C                  CALL    S1.BHKON
                         C                  LD      A,E
                         C                  CALL    S1.BHKON
                         C                  POP     DE
                         C                  LD      A,D
                         C                  CALL    S1.BHKON
                         C                  LD      A,E
                         C                  CALL    S1.BHKON
                         C                  JP      0B403H
                         C      
                         C                  PAGE
                         C      ;****************************************************************
                         C      ;*               Ueberpruefen der Angaben   blknr  und stufe    *
                         C      ;****************************************************************
                         C      S4.SC63:    DEC     IX
                         C                  DEC     IX
                         C      S4.SC60:    LD      A,(IX+2)            ;blknr
                         C                  LD      E,30H
                         C      S4.SC64:    PUSH    AF
                         C                  EX      AF,AF'              ;'
                         C                  POP     AF
                         C                  AND     0F0H
                         C                  XOR     E
                         C                  JR      NZ,S4.SC61
                         C                  RRC     E
                         C                  RRC     E
                         C                  RRC     E
                         C                  RRC     E
                         C                  EX      AF,AF'              ;'stufe
                         C                  AND     00FH
                         C      S4.UP3:     LD      HL,S2.S1-1
                         C                  INC     A
                         C                  LD      C,A
                         C                  LD      B,9
                         C      S4.UP4:     INC     HL
                         C                  LD      A,(HL)
                         C                  AND     03H
                         C                  XOR     E
                         C                  JR      Z,S4.UP5
                         C                  DJNZ    S4.UP4
                         C                  SCF
                         C                  JR      S4.UP6
                         C      S4.UP5:     DEC     C
                         C                  JR      NZ,S4.UP4
                         C                  SCF
                         C                  CCF
                         C      S4.UP6:     JR      C,S4.SC62
                         C                  XOR     A
                         C      S4.SC6:     RET
'BASIC- SVC - Routinen fuer Speichererweiterung'	MACRO-80 3.44	09-Dec-81	PAGE	1-173


                         C      
                         C      S4.SC61:    LD      A,1
                         C                  RET
                         C      
                         C      S4.SC62:    LD      A,2
                         C                  RET
                         C      
                         C      S4.LDIR:    LD      C,(HL)
                         C                  INC     HL
                         C                  LD      B,(HL)
                         C                  INC     HL
                         C                  LD      DE,S4.U2
                         C                  LDIR
                         C                  RET
                         C      
                         C                  PAGE
                         C      ;****************************************************************
                         C      ;*               Unterprogramme, die umgespeichert werden       *
                         C      ;****************************************************************
                         C      S4.UP:      XOR     A                   ;nur gemischte aktiv lassen
                         C                  OUT     (C),S4.SBST+1
                         C                  LD      A,10111101B
                         C                  OUT     (C),S4.SBST+0
                         C      
                         C                  LD      HL,04000H           ;Zusatzspeicher initialisieren
                         C                  LD      B,3
                         C                  LD      D,01000001B
                         C      S4.M2:      PUSH    BC
                         C                  LD      IX,02B00H
                         C                  LD      B,8
                         C      S4.UP1:     LD      A,D
                         C                  AND     00011100B
                         C                  RRCA
                         C                  RRCA
                         C                  INC     A
                         C                  PUSH    BC
                         C                  LD      B,A
                         C                  LD      A,10000000B
                         C                  RLCA
                         C                  DJNZ    $-1
                         C                  POP     BC
                         C                  OUT     (C),S4.SBST+2       ;Erweiterungsplatte zuschalten
                         C                  LD      A,D
                         C                  LD      (HL),A
                         C                  CP      (HL)
                         C                  JR      NZ,S4.UP2
                         C                  LD      (IX+0),A
                         C      S4.UP2:     ADD     A,4
                         C                  LD      D,A
                         C                  XOR     A
                         C                  OUT     (C),S4.SBST+2       ;Erweiterungsplatte wegschalten
                         C                  INC     IX
                         C                  DJNZ    S4.UP1
                         C                  LD      BC,04000H
                         C                  ADD     HL,BC
                         C                  LD      A,D
                         C                  AND     01000011B
                         C                  INC     A
                         C                  LD      D,A
                         C                  POP     BC
                         C                  DJNZ    S4.M2
                         C      
                         C                  PAGE
                         C                  IF      S4.V2 AND 1
                         C                  LD      A,10100101B
                         C                  ENDIF
                         C                  IF      S4.V2 AND 2
                         C                  LD      A,10110101B
                         C                  ENDIF
                         C                  OUT     (C),S4.SBST
                         C      
                         C                  IF      S4.V2 AND 1
                         C                  LD      A,00000000B
                         C                  ENDIF
                         C                  IF      S4.V2 AND 2
                         C                  LD      A,00000001B
                         C                  ENDIF
                         C                  OUT     (C),S4.SBST+1
                         C                  JP      S4.UP1E
                         C      
                         C      S4.UP1E:    LD      HL,02B00H
                         C                  LD      DE,S2.S2
                         C                  LD      BC,8
'BASIC- SVC - Routinen fuer Speichererweiterung'	MACRO-80 3.44	09-Dec-81	PAGE	1-174


                         C                  LDIR
                         C      
                         C                  IF      S4.V2 AND 1
                         C                  LD      A,10100111B
                         C                  ENDIF
                         C                  IF      S4.V2 AND 2
                         C                  LD      A,10110111B
                         C                  ENDIF
                         C                  OUT     (C),S4.SBST
                         C      
                         C                  IF      S4.V2 AND 1
                         C                  LD      A,10000100B
                         C                  ENDIF
                         C                  IF      S4.V2 AND 2
                         C                  LD      A,10000101B
                         C                  ENDIF
                         C                  OUT     (C),S4.SBST+1
                         C                  OUT     (C),S4.SBST+3       ;RESET-Sperre ein
                         C      
                         C                  JP      S1.RES1
                         C      
                         C                  PAGE
                         C      ;****************************************************************
                         C      ;*               Routine fuer  SVC 0,0, [... ,] &1i ,adresse    *
                         C      ;****************************************************************
                         C      S4.UM15:    EXX
                         C                  LD      E,10H
                         C                  CALL    S4.SC64
                         C                  CALL    S4.SC600
                         C                  CALL    S4.UU4
                         C                  EXX
                         C                  RET
                         C      ;****************************************************************
                         C      ;*               Routine fuer  SVC &1i , ...                    *
                         C      ;****************************************************************
                         C      S4.UM16:    LD      E,10H
                         C                  CALL    S4.SC64
                         C                  CALL    S4.SC600
                         C                  CALL    S4.UU4
                         C                  LD      HL,04007H
                         C                  LD      A,(HL)
                         C                  INC     HL
                         C                  LD      H,(HL)
                         C                  LD      L,A
                         C                  JP      S9.AB3
                         C      ;****************************************************************
                         C      ;*               Zuschalten einer "4000"-Erweiterungsplatte     *
                         C      ;****************************************************************
                         C      S4.UU4:     LD      HL,(S2.SMHL)
                         C                  OUT     (C),S4.SBST+4       ;RESET-Sperre aus
                         C      
                         C                  IF      S4.V2 AND 1
                         C                  LD      A,10000000B
                         C                  ENDIF
                         C                  IF      S4.V2 AND 2
                         C                  LD      A,10000001B
                         C                  ENDIF
                         C                  OUT     (C),S4.SBST+1
                         C      
                         C                  LD      A,(HL)
                         C                  AND     00011100B
                         C                  RRCA
                         C                  RRCA
                         C                  INC     A
                         C                  LD      B,A
                         C                  LD      A,10000000B
                         C                  RLCA
                         C                  DJNZ    $-1
                         C                  OUT     (C),S4.SBST+2
                         C                  RET
                         C      
                         C                  PAGE
                         C                  DW      S4.UM8-S4.UM1-2
                         C      S4.UM1:     CALL    S4.UM4              ;16K initialisieren
                         C                  LD      HL,0C010H
                         C                  LD      (0C001H),HL         ;erster freier Platz
                         C                  LD      (0C003H),HL         ;LP ... Lesepointer
                         C                  LD      (0C005H),HL         ;SP ... Schreibpointer
                         C                  LD      DE,0C011H
                         C                  LD      BC,04000H-11H
                         C                  LD      (HL),00DH
                         C                  LDIR
                         C                  JP      S4.UM6
'BASIC- SVC - Routinen fuer Speichererweiterung'	MACRO-80 3.44	09-Dec-81	PAGE	1-175


                         C      
                         C                  DW      S4.UM9-S4.UM8-2
                         C      S4.UM8:     CALL    S4.UM4              ;Schreib- = Lese- Pointer
                         C                  LD      HL,(0C003H)
                         C                  LD      (0C005H),HL
                         C                  JP      S4.UM6
                         C      
                         C                  DW      S4.UM10-S4.UM9-2
                         C      S4.UM9:     CALL    S4.UM4              ;setzen ersten freien Platz
                         C                  LD      HL,(0C005H)
                         C                  LD      (0C001H),HL
                         C                  JP      S4.UM6
                         C      
                         C                  DW      S4.UM11-S4.UM10-2
                         C      S4.UM10:    CALL    S4.UM4              ;Schreib- pointer = 1. fr. Platz
                         C                  LD      HL,(0C001H)
                         C                  LD      (0C005H),HL
                         C                  JP      S4.UM6
                         C      
                         C                  DW      S4.UM12-S4.UM11-2
                         C      S4.UM11:    CALL    S4.UM4              ;Lese-    pointer = Anfang
                         C                  LD      HL,0C010H
                         C                  LD      (0C003H),HL
                         C                  JP      S4.UM6
                         C      
                         C                  DW      S4.UM13-S4.UM12-2
                         C      S4.UM12:    CALL    S4.UM4              ;Schreib- pointer = Anfang
                         C                  LD      HL,0C010H
                         C                  LD      (0C005H),HL
                         C                  JP      S4.UM6
                         C      
                         C                  DW      S4.UM14-S4.UM13-2
                         C      S4.UM13:    CALL    S4.UM4              ;Lese-/Schreib- pointer lesen
                         C                  LD      HL,(0C005H)
                         C                  PUSH    HL
                         C                  LD      HL,(0C003H)
                         C                  PUSH    HL
                         C                  CALL    S4.UM6+6
                         C                  JP      S4.SC617
                         C      
                         C                  DW      S4.EIN-S4.UM14-2
                         C      S4.UM14:    CALL    S4.UM4              ;Lese-/Schreib- pointer setzen
                         C                  POP     HL
                         C                  LD      (0C005H),HL
                         C                  POP     HL
                         C                  LD      (0C003H),HL
                         C                  JP      S4.UM6
                         C      
                         C                  PAGE
                         C                  DW      S4.AUS-S4.EIN-2
                         C      S4.EIN:     CALL    S9.SAVE             ;Eingabe vom Zusatzspeicher
                         C                  CALL    S4.UM4
                         C                  LD      HL,(0C003H)
                         C                  LD      A,(HL)
                         C                  LD      (TS.TK),A
                         C                  INC     HL
                         C                  LD      A,H
                         C                  OR      L
                         C                  JR      NZ,S4.EIN1
                         C                  DEC     HL
                         C                                              ;Fehlermeldung
                         C      S4.EIN1:    LD      (0C003H),HL
                         C                  CALL    S4.UM6+6
                         C                  JP      S9.RIV9
                         C      
                         C                  DW      S4.AUS2-S4.AUS
                         C      S4.AUS:     CALL    S9.SAVE             ;Ausgabe auf Zusatzspeicher
                         C                  LD      A,C
                         C                  LD      (MS.TK),A
                         C                  CALL    S4.UM4
                         C                  LD      HL,(0C005H)
                         C                  LD      A,(MS.TK)
                         C                  LD      (HL),A
                         C                  INC     HL
                         C                  LD      A,H
                         C                  OR      L
                         C                  JR      NZ,S4.AUS1
                         C                  DEC     HL
                         C                                              ;Fehlermeldung
                         C      S4.AUS1:    LD      (0C005H),HL
                         C                  CALL    S4.UM6+6
                         C                  JP      S9.IOXE
                         C      S4.AUS2     EQU     $
'BASIC- SVC - Routinen fuer Speichererweiterung'	MACRO-80 3.44	09-Dec-81	PAGE	1-176


                         C      
                         C                  PAGE
                         C      S4.UUM4:    LD      HL,(S2.SMHL)
                         C                  OUT     (C),S4.SBST+4       ;RESET-Sperre aus
                         C      
                         C                  IF      S4.V2 AND 1         ;RAM C000 wegschalten
                         C                  LD      A,10110111B
                         C                  OUT     (C),S4.SBST
                         C                  ENDIF
                         C      
                         C                  LD      A,10000000B      ;RAM 4000 (ROM C000) wegschalten
                         C                  OUT     (C),S4.SBST+1
                         C      
                         C                  IF      S4.V2 AND 2
                         C                  LD      A,(HL)
                         C                  XOR     00010011B
                         C                  JR      NZ,S4.UM5
                         C                  LD      A,10100111B         ;RAM C000 aus V1 aktivieren
                         C                  OUT     (C),S4.SBST
                         C                  RET
                         C                  ENDIF
                         C      
                         C      S4.UM5:     LD      A,(HL)
                         C                  AND     00011100B
                         C                  RRCA
                         C                  RRCA
                         C                  INC     A
                         C                  LD      B,A
                         C                  LD      A,10000000B
                         C      S4.UM2:     RLCA
                         C                  DJNZ    S4.UM2
                         C                  OUT     (C),S4.SBST+2
                         C                  RET
                         C      
                         C      S4.UUM6:    CALL    S4.UM6+6
                         C                  JP      0B403H
                         C      
                         C                  XOR     A
                         C                  OUT     (C),S4.SBST+2
                         C      
                         C                  IF      S4.V2 AND 1
                         C                  LD      A,10100111B
                         C                  ENDIF
                         C                  IF      S4.V2 AND 2
                         C                  LD      A,10110111B
                         C                  ENDIF
                         C                  OUT     (C),S4.SBST
                         C      
                         C                  IF      S4.V2 AND 1
                         C                  LD      A,10000100B
                         C                  ENDIF
                         C                  IF      S4.V2 AND 2
                         C                  LD      A,10000101B
                         C                  ENDIF
                         C                  OUT     (C),S4.SBST+1
                         C      
                         C                  OUT     (C),S4.SBST+3       ;RESET-Sperre ein
                         C                  RET
                         C      S4.UM7      EQU     $
                         C      
                         C      S4.UM4      EQU     S4.U1+S4.UUM4-S4.UUM4
                         C      S4.UM6      EQU     S4.U1+S4.UUM6-S4.UUM4
                         C      
                         C                  PAGE
                         C      ;****************************************************************
                         C      ;*               Arbeit mit der Ein- / Ausgabetabelle  L B      *
                         C      ;****************************************************************
                         C      S4.SC700:   LD      A,(IX+2)            ;richtung
                         C                  CP      'I'
                         C                  JR      Z,S4.SC702
                         C                  CP      'O'
                         C                  JR      NZ,S4.SC701
                         C                  CALL    S4.LIYO
                         C                  JR      S4.SC703
                         C      
                         C      S4.SC702:   CALL    S4.LIYI
                         C                  LD      C,7FH
                         C      S4.SC703:   LD      A,(IX)              ;operation
                         C                  CP      4
                         C                  JP      Z,S4.SC704
                         C                  CP      3
                         C                  JR      Z,S4.SC705
                         C                  CP      2
'BASIC- SVC - Routinen fuer Speichererweiterung'	MACRO-80 3.44	09-Dec-81	PAGE	1-177


                         C                  JR      Z,S4.SC706
                         C                  CP      1
                         C                  JR      Z,S4.SC707
                         C                  CP      0
                         C                  JR      Z,S4.SC708
                         C      S4.SC701:   JP      0B403H
                         C                                              ;op = 1
                         C      S4.SC707:   LD      A,(IX+4)            ;wert
                         C                  LD      B,0
                         C                  LD      C,(IX+6)            ;rel. tabellenadresse
                         C                  ADD     IY,BC
                         C                  LD      (IY+0),A
                         C                  JR      S4.SC701
                         C                                              ;op = 3  ...  ASCII
                         C      S4.SC705:   LD      A,(IX+2)            ;richtung
                         C                  CP      'O'
                         C                  JR      Z,$+6
                         C                  LD      B,11100110B
                         C                  JR      SC716
                         C                  LD      B,11000100B
                         C                  JR      S4.SC716
                         C                                              ;op = 2  ...  binaer
                         C      S4.SC706:   LD      A,(IX+2)            ;richtung
                         C                  CP      'O'
                         C                  JR      Z,$+6
                         C                  LD      B,2
                         C                  JR      SC716
                         C                  LD      B,0
                         C      S4.SC716:   LD      DE,01E0DH           ;EOR - Zeichen
                         C                  LD      A,019H              ;EOF - Zeichen
                         C                  LD      HL,0
                         C                  PUSH    HL
                         C                  JR      S4.SC709
                         C                                              ;op = 0
                         C      S4.SC708:   LD      D,(IX+16)
                         C                  LD      E,(IX+14)
                         C                  LD      B,(IX+12)
                         C                  LD      C,(IX+8)
                         C                  LD      A,(IX+6)
                         C                  LD      H,(IX+5)
                         C                  LD      L,(IX+4)
                         C                  PUSH    HL
                         C                  LD      H,(IX+11)
                         C                  LD      L,(IX+10)
                         C      
                         C      S4.SC709:   LD      (IY+0),D
                         C                  LD      (IY+1),E
                         C                  LD      (IY+4),B
                         C                  LD      (IY+11),C
                         C                  LD      (IY+12),A
                         C                  LD      (IY+5),L
                         C                  LD      (IY+6),H
                         C                  POP     HL
                         C                  LD      (IY+19),L
                         C                  LD      (IY+20),H
                         C                  JR      SC701
                         C                                              ;op = 4  ...  Standard-Anwender-Kode
                         C      S4.SC704:   LD      HL,LR.KONV
                         C                  PUSH    HL
                         C                  LD      A,(IX+2)
                         C                  CP      'O'
                         C                  JR      Z,$+9               ;---!
                         C                  LD      C,0EFH              ;   !
                         C                  LD      HL,LR.SKTBI         ;   !
                         C                  JR      $+7                 ;------!
                         C                  LD      C,010H              ;<--!  !
                         C                  LD      HL,LR.SKTBO         ;      !
                         C                  LD      D,080H              ;<-----!
                         C                  LD      E,00DH
                         C                  LD      B,10101110B
                         C                  LD      A,019H
                         C                  JR      S4.SC709
                         C      
                         C                  PAGE
                         C      ;****************************************************************
                         C      ;*                  Modifizierung der Workspace-Adressen        *
                         C      ;****************************************************************
                         C      S4.SC710:   LD      HL,S4.SC712
                         C                  LD      BC,S9.IOX
                         C      S4.SC711:   LD      (BC.CIN+1),HL
                         C                  LD      (BC.CON+1),BC
                         C      S4.SC713:   JP      0B403H
                         C      
'BASIC- SVC - Routinen fuer Speichererweiterung'	MACRO-80 3.44	09-Dec-81	PAGE	1-178


                         C      S4.SC720:   LD      HL,S9.IOX
                         C                  LD      BC,S4.SC722
                         C                  JR      S4.SC711
                         C      
                         C      S4.SC730:   LD      HL,S4.SC712
                         C                  LD      (BC.RIV+1),HL
                         C                  JR      S4.SC713
                         C      
                         C      S4.SC740:   LD      HL,S4.SC742
                         C                  LD      (BC.WRTV+1),HL
                         C                  JR      S4.SC713
                         C      
                         C      S4.SC750:   LD      HL,S4.SC752
                         C      S4.SC751:   LD      (BC.USR+1),HL
                         C                  JR      S4.SC713
                         C      
                         C      S4.SC760:   LD      HL,S4.SC762
                         C                  JR      S4.SC751
                         C      
                         C      
                         C      S4.LBL:     PUSH    AF
                         C                  CALL    S0.KRZU
                         C                  POP     AF
                         C                  CALL    LR.LBL
                         C                  PUSH    AF
                         C                  PUSH    BC
                         C                  PUSH    DE
                         C                  CALL    S2.STACK
                         C                  POP     DE
                         C                  POP     BC
                         C                  POP     AF
                         C                  RET
                         C      
                         C      S4.LBS:     PUSH    AF
                         C                  CALL    S0.KRZU
                         C                  POP     AF
                         C                  CALL    LR.LBS
                         C                  PUSH    AF
                         C                  PUSH    BC
                         C                  PUSH    DE
                         C                  CALL    S2.STACK
                         C                  POP     DE
                         C                  POP     BC
                         C                  POP     AF
                         C                  RET
                         C      
                         C                  PAGE
                         C      S4.LIYI:    LD      IY,S3.LBL-S3.SEAT
                         C                  LD      DE,S0.DEAT+3
                         C                  ADD     IY,DE
                         C                  RET
                         C      
                         C      S4.LIXI:    PUSH    IY
                         C                  CALL    S4.LIYI
                         C                  PUSH    IY
                         C                  POP     IX
                         C                  POP     IY
                         C                  RET
                         C      
                         C      
                         C      S4.LIYO:    LD      IY,S3.LBS-S3.SEAT
                         C                  LD      DE,S0.DEAT+3
                         C                  ADD     IY,DE
                         C                  RET
                         C      
                         C      S4.LIXO:    PUSH    IY
                         C                  CALL    S4.LIYO
                         C                  PUSH    IY
                         C                  POP     IX
                         C                  POP     IY
                         C                  RET
                         C      
                         C                  PAGE
                         C      ;****************************************************************
                         C      ;*               Lochband- Ein-/Ausgaberoutinen                 *
                         C      ;****************************************************************
                         C      S4.SC712:   CALL    S9.SAVE             ;Lochbandeingaberoutine
                         C                  CALL    S4.LIXI
                         C                  CALL    S4.LBL
                         C                  LD      (TS.TK),A
                         C                  LD      A,(IX+3)
                         C                  ADD     A,30H
                         C                  CALL    S9.ERS
'BASIC- SVC - Routinen fuer Speichererweiterung'	MACRO-80 3.44	09-Dec-81	PAGE	1-179


                         C                  CALL    S9.LOAD
                         C                  LD      A,(TS.TK)
                         C                  RET
                         C      
                         C      S4.SC722:   PUSH    AF                  ;Lochbandausgaberoutine  PRINT
                         C                  LD      A,C                 ;bei PRINT keine Ausgabe von 00AH
                         C                  CP      0AH
                         C                  JR      NZ,S4.SC723
                         C                  POP     AF
                         C                  RET
                         C      S4.SC723:   POP     AF
                         C      S4.SC742:   CALL    S9.SAVE             ;Lochbandausgaberoutine  PGM
                         C                  CALL    S4.LIXO
                         C                  CALL    S4.LBS
                         C                  JR      S4.SC763
                         C      
                         C      S4.SC752:   CALL    S9.SAVE             ;Lochandeingaberoutine  USR
                         C                  CALL    S4.LIXI
                         C                  CALL    S4.LBL
                         C                  LD      B,A
                         C                  XOR     A
                         C                  CALL    BC.RUCK
                         C                  JR      S4.SC763
                         C      
                         C      S4.SC762:   CALL    S9.SAVE             ;Lochbandausgaberoutine  USR
                         C                  CALL    BC.PAR
                         C                  LD      C,E
                         C                  CALL    S4.LIXO
                         C                  CALL    S4.LBS
                         C      
                         C      S4.SC763:   LD      A,(IX+3)
                         C                  ADD     A,30H
                         C                  CALL    S9.ERS
                         C                  CALL    S9.LOAD
                         C                  RET
                         C      
                         C                  PAGE
                         C      ;****************************************************************
                         C      ;*     PROGRAMMM F. CROSS-REFERENZLISTE (SPRUNGBEFEHLE)         *
                         C      ;****************************************************************
                         C      S4.CALL:    DB      'CALL   '
                         C      S4.GOSUB:   DB      'GOSUB  '
                         C      S4.GOTO:    DB      'GOTO   '
                         C      S4.OGOS:    DB      'ONGOSUB'
                         C      S4.OGOTO:   DB      'ONGOTO '
                         C                  DW      $
                         C                  DB      'BANA'
                         C                  LD      A,5                 ;BILD LOESCHEN
                         C                  LD      (MS.CMD),A
                         C                  CALL    MO.MONI
                         C                  LD      A,22
                         C                  LD      (MS.CMD),A
                         C                  CALL    MO.MONI
                         C      
                         C                  XOR     A                   ;ZAEHLER DER ANZAHL DER ZEILEN AUF BS AUF 0 SETZEN
                         C                  LD      (S2.DM2),A
                         C                  LD      HL,(02FB7H)         ;INI FUER HL MIT ANFANGSADRESSE DES BASIC-PGMS
                         C                  DEC     HL                  ;DAMIT ERSTES ZEICHEN NICHT VERLOREN GEHT
                         C      S4.PREN:    INC     HL                  ;SCHLEIFE PROGRAMMENDE / NAECHSTES ZEICHEN
                         C                  XOR     A                   ;INI FUER MERKER (0=KEIN ON,KEIN CALL,1.SPRUNG IN ZEILE)
                         C                  LD      (S2.DMH),A
                         C                  LD      A,(HL)              ;AKTUELLES ZEICHEN HOLEN
                         C                  CP      00H                 ;1. MAL 00
                         C                  JR      NZ,S4.END1B         ;NICHT 00, SO WEITER IN ZEILE
                         C                  INC     HL                  ;NAECHSTES ZEICHEN
                         C                  LD      A,(HL)
                         C                  CP      00H                 ;2. MAL 00
                         C                  JP      Z,S4.ENDE           ;WENN JA, SO PGM-ENDE
                         C                  DEC     HL                  ;ANSONSTEN WAR ZUFAELLIG L(NEX-STMT) = 00
                         C      S4.END1B:   CALL    S4.LEER             ;LOESCHEN AUSGABEZEILE
                         C                  INC     HL                  ;UEBERGEHEN ADRESSE DER FOLGEZEILE
                         C                  INC     HL
                         C                  PUSH    HL                  ;RETTEN BEI ZEIGEN AUF ZEILENNUMMER
                         C                  LD      E,(HL)              ;L(ZEILENNUMMER)
                         C                  INC     HL
                         C                  LD      D,(HL)              ;H(ZEILENNUMMER)
                         C                  EX      DE,HL               ;HL ENTHAELT HEXAZAHL
                         C                  LD      DE,S0.PFFI          ;ZIEL FUER ASCII-KETTE
                         C                  CALL    S4.DUDEZ            ;HEXADEZ. Z-->ASCII ZEICHEN
                         C                  INC     DE                  ;ZEIGT AUF BYTE HINTER LETZTER ZIFFER
                         C                  LD      A,':'
                         C                  LD      (DE),A              ;OHNE BLANK HINTER ANWEISUNGSNUMMER
                         C                  POP     HL                  ;HL ZEIGT WIEDER AUF UNTERSUCHTE ZEILE
'BASIC- SVC - Routinen fuer Speichererweiterung'	MACRO-80 3.44	09-Dec-81	PAGE	1-180


                         C                  INC     HL                  ;UEBERGEHEN DER ANWEISUNGSNUMMER
                         C      S4.SONST:   INC     HL                  ;      "   , BZW. NAECHSTES ZEICHEN
                         C                  LD      A,(HL)
                         C      S4.SES:     CP      00H                 ;SCHLEIFE SATZENDE
                         C                  JP      Z,S4.SATZE          ;AUFTRETENDES 00 MUSS JETZT ZEILENENDE SEIN
                         C                  EXX                         ;INI FUER HINTERGRUND HL
                         C                  LD      HL,S2.DMH           ;MIT ADRESSE DES MERKERS
                         C                  EXX
                         C                  CP      91H                 ;ABFRAGE NACH TOKEN: ON
                         C                  JR      NZ,S4.NMEHR         ;SPRUNG, WENN KEINE DOPPELANWEISUNG
                         C                  EXX                         ;HINTERGRUND HL
                         C                                              ;
                         C                  SET     7,(HL)              ;TOKEN: ON GEFUNDEN
                         C                  EXX
                         C      S4.NMEHR:   CP      8CH                 ;ABFRAGE NACH TOKEN: GOSUB
                         C                  JR      NZ,S4.GOT           ;WENN NICHT, SO WEITER SUCHE
                         C                  EXX                         ;HINTERGRUND
                         C                  BIT     7,(HL)              ;TEST, OB TOKEN: ON VORANGEGANGEN WAR
                         C                  EXX
                         C                  JR      NZ,S4.OVGOS         ;SPRUNG, WENN JA
                         C                  LD      BC,S4.GOSUB         ;SONST NUR TOKEN: GOSUB
                         C                  JR      S4.KOB              ;DANN ZUR SPRUNGZIELUEBERNAHME
                         C      S4.OVGOS:   LD      BC,S4.OGOS          ;ON GOSUB
                         C                  JR      S4.KOB              ;SPRUNG ZUR SPRUNGZIELUEBERNAHME
                         C      S4.GOT:     CP      88H                 ;ABFRAGE NACH TOKEN: GOTO
                         C                  JR      NZ,S4.CAL           ;WENN NICHT, SO WEITER SUCHE
                         C                  EXX                         ;HINTERGRUND
                         C                  BIT     7,(HL)              ;TEST, OB TOKEN: ON VORANGEGANGEN
                         C                  EXX
                         C                  JR      NZ,S4.OVGOT         ;SPRUNG, WENN JA
                         C      S4.AUSGO:   LD      BC,S4.GOTO          ;SONST NUR TOKEN: GOTO
                         C                  JR      S4.KOB              ;DANN ZUR SPRUNGZIELUEBERNAHME
                         C      S4.OVGOT:   LD      BC,S4.OGOTO         ;ON GOTO
                         C                  JR      S4.KOB              ;AUCH ZUR SPRUNGZIELUEBERNAHME
                         C      S4.CAL:     CP      0D7H                ;ABFRAGE NACH TOKEN: CALL
                         C                  JR      NZ,S4.TEOGT         ;NOCH TESTEN, OB EVTL. THEN ODER ELSE OHNE GOTO
                         C                  LD      BC,S4.CALL
                         C                  EXX                         ;HINTERGRUND
                         C                  SET     6,(HL)              ;TOKEN: CALL GEFUNDEN
                         C                  EXX
                         C                  JR      S4.KOB
                         C      S4.TEOGT:   CP      0A2H                ;TOKEN: THEN
                         C                  JR      NZ,S4.ELS           ;SPRUNG, WENN NICHT
                         C      S4.TEST:    PUSH    DE                  ;TEST AUF AUSGELASSENES GOTO
                         C                  INC     HL                  ;1. ZEICHEN HINTER THEN ODER ELSE
                         C                  LD      D,0FFH              ;MAX. ANZAHL BLANKS UEBERGEHEN
                         C                  CALL    S4.SUNBL
                         C                  POP     DE                  ;DE ZEIGT WIEDER AUF AUSGABEZEILE
                         C                  LD      A,(HL)              ;1. ZEICHEN VERSCHIEDEN VON BLANK
                         C                  DEC     HL                  ;FALLS GEFUNDENES ZEICHEN TOKEN
                         C                                              ;IST BZW.DAMIT NUMMER NICHT VERLOREN GEHT
                         C                  CP      30H                 ;TEST, OB SPRUNGADRESSE BEGINNT
                         C                  JR      C,S4.SONST          ;SPRUNG, WENN KEINE ZIFFER
                         C                  CP      3AH
                         C                  JR      NC,S4.SONST         ;SPRUNG, WENN KEINE ZIFFER
                         C                  JR      S4.AUSGO            ;SPRUNGADRESSE WIE GOTO BEHANDELN
                         C      S4.ELS:     CP      0C9H                ;TOKEN: ELSE
                         C                  JR      Z,S4.TEST           ;SPRUNG, WENN JA UND TEST AUF AUSG. GOTO
                         C                  JR      S4.SONST            ;WEITER IM QUELLTEXT
                         C      S4.KOB:     EXX                         ;HINTERGRUND
                         C                  BIT     0,(HL)              ;TEST, WIEVIELTE SPRUNGANWEISUNG IN ZEILE
                         C                  EXX
                         C                  JR      Z,S4.LEZ            ;SPRUNG, WENN 1. SPRUNGANWEISUNG
                         C                  LD      A,2FH               ;SCHRAEGSTRICH
                         C                  JR      S4.AUSG
                         C      S4.LEZ:     LD      A,' '
                         C      S4.AUSG:    INC     DE
                         C                  LD      (DE),A              ;BLANK ODER / IN AUSGABEZEILE
                         C                  INC     DE
                         C                  PUSH    HL                  ;ZEIGT NOCH AUF TOKEN,EVTL. IMAGINAER
                         C                  LD      H,B                 ;AUSGABE DER SPRUNGNAMEN
                         C                  LD      L,C
                         C                  LD      BC,7H
                         C                  LDIR
                         C                  LD      A,'-'
                         C                  LD      (DE),A
                         C                  POP     HL                  ;HOLEN BEI ZEIGEN AUF TOKEN
                         C                  INC     HL                  ;SUCHEN SPRUNGZIEL(E)
                         C                  PUSH    DE                  ;RETTEN DER AKTUELLEN ABLAGEADRESSE
                         C                  LD      D,0FFH              ;UNTERTEILENDE BLANKS ERLAUBT
                         C                  CALL    S4.SUNBL            ;ABFRAGE NACH BLANK
                         C                  POP     DE                  ;ZEIGT WIEDER AUF ABLAGEZEILE
                         C      S4.SPADR:   LD      A,(HL)
'BASIC- SVC - Routinen fuer Speichererweiterung'	MACRO-80 3.44	09-Dec-81	PAGE	1-181


                         C                  BIT     7,A                 ;LIEGT TOKEN VOR ?
                         C                  JR      NZ,S4.ENDSP         ;WENN JA, IST SPRUNGADRESSE ZU ENDE
                         C                  CP      ':'                 ;ANWEISUNGSENDE
                         C                  JR      Z,S4.ENDSP          ;WENN JA, IST SPRUNGADRESSE ZU ENDE
                         C                  CP      0                   ;ZEILENENDE ?
                         C                  JR      Z,S4.ENDSP          ;WENN JA, IST SPRUNGADRESSE ZU ENDE
                         C                  EXX                         ;HINTERGRUND
                         C                  BIT     6,(HL)              ;TEST, OB BEHANDELTER TOKEN CALL IST
                         C                  EXX
                         C                  JR      Z,S4.UEBER          ;WENN NICHT, SPRUNGZIEL-ZIFFER UEBERNEHMEN
                         C                  CP      2CH                 ;SPRUNGZIEL VON CALL KANN BEREITS BEI KOMMA ENDEN
                         C                  JR      Z,S4.ENDSP          ;SPRUNG, WENN KOMMA
                         C      S4.UEBER:   INC     DE                  ;NAECHSTER PLATZ IN AUSGABEZEILE
                         C                  LD      (DE),A              ;ZEICHEN DES SPRUNGZIELS ABLEGEN
                         C                  INC     HL                  ;NAECHSTES ZEICHEN IN ZEILE
                         C                  JR      S4.SPADR            ;SPRUNG ZUR UNTERSUCHUNG DES NAECHSTEN ZEICHENS
                         C      S4.ENDSP:   EXX                         ;HINTERGRUND
                         C                  SET     0,(HL)              ;EINE SPRUNGANWEISUNG IST SCHON AUFGETRETEN
                         C                  EXX
                         C                  JP      S4.SES              ;WEITER ODER SATZENDE
                         C      S4.SATZE:   LD      (S2.TE),HL          ;AKTUELLEN ZEIGER AUF BASIC-PGM RETTEN
                         C                  LD      HL,S0.PFFI+9        ;ADRESSE DES ZWEITEN BYTES DES EVTL. 1. SPRUNGBF
                         C                  LD      A,20H               ;TEST, OB SPRUNG VORHANDEN
                         C                  CP      (HL)
                         C                  LD      HL,(S2.TE)          ;HL ZEIGT WIEDER AUF AKTUELLE ZEILE
                         C                  JP      Z,S4.PREN           ;SPRUNG, WENN IN UNTERSUCHTER ZEILE KEIN SPRUNG
                         C                  LD      HL,S0.PFFI          ;ADRESSE DER AUSGABEZEILE
                         C      S4.WEGFN:   LD      A,'0'               ;FUEHRENDE NULLEN ?
                         C                  CP      (HL)
                         C                  JR      NZ,S4.LACHT         ;SPRUNG BEI FUENFSTELLIGER ZEILENNUMMER
                         C                  LD      A,' '
                         C                  LD      (HL),A              ;FUEHRENDE NULL UEBERSCHREIBEN
                         C                  INC     HL                  ;NAECHSTE ZIFFER
                         C                  JR      S4.WEGFN
                         C      S4.LACHT:   LD      HL,S0.PFFI+80       ;81. BYTE
                         C                  LD      D,5                 ;DANN FOLGT UNBEDINGT NICHTS MEHR
                         C                  CALL    S4.SUNBL
                         C                  CP      ' '                 ;NUR BLANKS, SO REICHT EINE 80-BYTE-ZEILE
                         C                  JR      Z,S4.EINZE          ;FOLGENDES FUER DIESEN FALL UEBERFLUESSIG
                         C                  LD      HL,S0.PFFI+79       ;LETZTES BYTE DER 1. AUSGABEZEILE
                         C                  LD      A,2FH               ;SCHRAEGSTRICH
                         C                  LD      BC,0                ;DAMIT IN C DIE KOMPLEMENTAERE ANZAHL IST
                         C                  CPDR                        ;SUCHEN LETZTEN / DER 1. AUSGABEZEILE
                         C                  INC     HL                  ;ZEIGT AUF 1. ZEICHEN HINTER /
                         C                  LD      (S0.PFFI+253),HL    ;ADRESSE DIESES ZEICHENS RETTEN
                         C                  OR      A                   ;CY=0
                         C                  LD      DE,S0.PFFI+89       ;1. FREIES BYTE DER 2. AUSGABEZEILE
                         C                  EX      DE,HL               ;TAUSCH WEGEN SUBTRAKTION
                         C                  SBC     HL,DE               ;WIEVIEL IST ZU VERSCHIEBEN
                         C                  LD      B,H                 ;DIFFERENZ NACH BC
                         C                  LD      C,L
                         C                  LD      (S0.PFFI+251),BC    ;DIFFERENZ RETTEN
                         C                  EX      DE,HL               ;HL ZEIGT WIEDER AUF 1. ZEICHEN HINTER /
                         C                  LD      DE,(S0.PFFI+89)     ;DE WIEDER AUF 1. BYTE 2. ZEILE
                         C                  LDIR                        ;VERSCHIEBUNG NACH HINTEN
                         C                  LD      HL,(S0.PFFI+253)    ;ZEIGT AUF BYTE HINTER /
                         C                  LD      A,' '
                         C                  LD      (HL),A              ;LOESCHEN DES URBILDES DES VERSCHOBENEN BEREICHS
                         C                  LD      BC,(S0.PFFI+251)    ;WIEVIELE BYTES UEBERSCHREIBEN
                         C                  DEC     BC                  ;EINS IST JA SCHON
                         C                  LD      D,H                 ;HL NACH DE UEBERNEHMEN
                         C                  LD      E,L
                         C                  INC     DE                  ;ZEIGT EIN BYTE WEITER
                         C                  LDIR
                         C      ;****************************************************************
                         C      ;*               erste Ausgabezeile ausgeben                    *
                         C      ;****************************************************************
                         C      S4.EINZE:   LD      A,24                ;VEKTORSCHREIBEN
                         C                  LD      (MS.CMD),A
                         C                  LD      HL,S0.PFFI          ;ADRESSE DES 1.BYTE
                         C                  LD      B,80                ;WIEVIEL BYTE
                         C                  CALL    MO.MONI
                         C      S4.TEVOL:   LD      A,(S2.DM2)          ;WIEVIELE ZEILEN SCHON AUF BS ?
                         C                  CP      21                  ;BS VOLL MIT 22 ZEILEN
                         C                  JR      NZ,S4.NIVOL         ;SPRUNG, WENN NOCH NICHT SO VIEL
                         C                  LD      HL,S4.WEIT          ;WEITERARBEITSADRESSE NACH TASTENBETAETIGUNG
                         C                  LD      (TS.TAB4),HL        ;FUNKTIONSTASTE: ABS
                         C                  RET                         ;WARTEN AUF BETAETIGUNG DIESER TASTE
                         C      S4.WEIT:    LD      A,5                 ;BILD LOESCHEN
                         C                  LD      (MS.CMD),A
                         C                  CALL    MO.MONI
                         C                  LD      A,22                ;CURSOR HOME
                         C                  LD      (MS.CMD),A
'BASIC- SVC - Routinen fuer Speichererweiterung'	MACRO-80 3.44	09-Dec-81	PAGE	1-182


                         C                  CALL    MO.MONI
                         C                  LD      A,0FFH              ;INI FUER ZEILENZAEHLER
                         C      S4.NIVOL:   INC     A                   ;EINE ZEILE MEHR
                         C                  LD      (S2.DM2),A          ;ABLEGEN DES ZEILENZAEHLERS
                         C                  LD      HL,S0.PFFI+89       ;1. BYTE DER 2. AUSGABEZEILE
                         C                  LD      A,' '
                         C                  CP      (HL)                ;NOCH SPRUNGBEFEHL IN 2. AUSGABEZEILE ?
                         C                  JR      Z,S4.WIREE          ;SPRUNG, WENN WIRKLICH EINE ZEILE REICHT
                         C                  LD      A,24                ;VEKTOR SCHREIBEN
                         C                  LD      (MS.CMD),A
                         C                  LD      HL,S0.PFFI+80       ;1. BYTE DER ZWEITEN AUSGABEZEILE
                         C                  LD      B,80                ;LAENGE 80 BYTES
                         C                  CALL    MO.MONI
                         C                  LD      A,' '
                         C                  LD      (S0.PFFI+89),A      ;DAMIT BEI OBIGEM TEST DURCHRUTSCHEN MOEGLICH
                         C                  JR      S4.TEVOL            ;SPRUNG ZUM TEST OB BS VOLL
                         C      S4.WIREE:   LD      HL,(S2.TE)
                         C                  JP      S4.PREN
                         C      S4.ENDE:    RET
                         C      ;****************************************************************
                         C      ;*         UMWANDLUNG EINER ZAHL KLEINER 65535 IN ASCII-ZEICHEN *
                         C      ;****************************************************************
                         C      S4.DUDEZ:   XOR     A
                         C                  LD      BC,10000
                         C      S4.SCL10:   SBC     HL,BC
                         C                  JR      C,S4.NEGZT
                         C                  INC     A
                         C                  JR      S4.SCL10
                         C      S4.NEGZT:   ADD     HL,BC
                         C                  ADD     A,30H
                         C                  LD      (DE),A
                         C                  INC     DE
                         C                  XOR     A
                         C                  LD      BC,1000
                         C      S4.SCL11:   SBC     HL,BC
                         C                  JR      C,S4.NEGT
                         C                  INC     A
                         C                  JR      S4.SCL11
                         C      S4.NEGT:    ADD     HL,BC
                         C                  ADD     A,30H
                         C                  LD      (DE),A
                         C                  INC     DE
                         C                  XOR     A
                         C                  LD      BC,100
                         C      S4.SCL12:   SBC     HL,BC
                         C                  JR      C,S4.NEGH
                         C                  INC     A
                         C                  JR      S4.SCL12
                         C      S4.NEGH:    ADD     HL,BC
                         C                  ADD     A,30H
                         C                  LD      (DE),A
                         C                  INC     DE
                         C                  XOR     A
                         C                  LD      BC,10
                         C      S4.SCL13:   SBC     HL,BC
                         C                  JR      C,S4.NEGZ
                         C                  INC     A
                         C                  JR      S4.SCL13
                         C      S4.NEGZ:    ADD     HL,BC
                         C                  ADD     A,30H
                         C                  LD      (DE),A
                         C                  INC     DE
                         C                  LD      A,L
                         C                  ADD     A,30H
                         C                  LD      (DE),A
                         C                  RET
                         C      ;INPUTS:  HL- 2BYTE HEXADEZIMAL
                         C      ;         DE- ADRESSE ZUR ABLAGE DER 5 ASCII-ELEMENTE
                         C      ;OUTPUTS: (DE)...(DE+4) 5 ASCII-ZEICHEN
                         C      ;***************************************************************
                         C      ;AUSGABEZEILE LOESCHEN
                         C      ;***************************************************************
                         C      S4.LEER:    EXX
                         C                  LD      HL,S0.PFFI
                         C                  LD      DE,S0.PFFI+1
                         C                  LD      BC,09FH
                         C                  LD      (HL),' '
                         C                  LDIR
                         C                  EXX
                         C                  RET
                         C      ;***************************************************************
                         C      ;SUCHEN UNGLEICH BLANK
                         C      ;***************************************************************
'BASIC- SVC - Routinen fuer Speichererweiterung'	MACRO-80 3.44	09-Dec-81	PAGE	1-183


                         C      S4.SUNBL:   LD      A,' '
                         C      S4.SUCH:    CP      (HL)
                         C                  JR      NZ,S4.ZUNBL
                         C                  INC     HL
                         C                  DEC     D
                         C                  JR      NZ,S4.SUCH
                         C                  JR      S4.SUEND
                         C      S4.ZUNBL:   LD      A,(HL)
                         C      ;
                         C      ;INPUTS:   HL-ANFANGSADRESSE
                         C      ;          D -WIE OFT SUCHEN
                         C      ;OUTPUTS:  HL-ADRESSE DER Z. UNGLEICH BLANK
                         C      ;          ODER ZEIGT AUF Z. HINTER D. UNTERSUCHTEM Z.
                         C      ;          A -WAS GEFUNDEN WURDE
                         C      ;
                         C      S4.SUEND:   RET
                         C      
                         C      
                         C                  ENDIF
                         C      
                         C      ;           END
                         C      ;           PN      SM01
                         C                  TITLE   'Drucker-Verbindungsmodul fuer Version 2.1'
                         C                  PAGE
'Drucker-Verbindungsmodul fuer Version 2.1'	MACRO-80 3.44	09-Dec-81	PAGE	1-184


                         C      
                         C      ;****************************************************************
                         C      ;*                  Drucker-Verbindungsmodul fuer Version 2.1   *
                         C      ;*  Version         --------------------------------------------*
                         C      ;*                  Programmierer: M. Herbote  K EAW  ZFT (WFT) *
                         C      ;*  V 2 . 1         --------------------------------------------*
                         C      ;*                  Stand        : 17.August 1984               *
                         C      ;****************************************************************
                         C      
                         C      SM.DRU      MACRO   UP
                         C                  PUSH    IX
                         C                  PUSH    DE
                         C                  LD      IX,S3.PRIN-S3.SEAT
                         C                  LD      DE,S0.DEAT+3
                         C                  ADD     IX,DE
                         C                  CALL    S0.KRZU
                         C                  CALL    UP
                         C                  ENDM
                         C      
  F588                   C      SM.MRES:    SM.DRU  S0.MRES
  F588    DD E5          C+                 PUSH    IX
  F58A    D5             C+                 PUSH    DE
  F58B    DD 21 0096     C+                 LD      IX,S3.PRIN-S3.SEAT
  F58F    11 A803        C+                 LD      DE,S0.DEAT+3
  F592    DD 19          C+                 ADD     IX,DE
  F594    CD F659        C+                 CALL    S0.KRZU
  F597    CD 4046        C+                 CALL    S0.MRES
  F59A    18 12          C                  JR      SM.M1
                         C      
  F59C                   C      SM.PRIO:    SM.DRU  S0.PRIO
  F59C    DD E5          C+                 PUSH    IX
  F59E    D5             C+                 PUSH    DE
  F59F    DD 21 0096     C+                 LD      IX,S3.PRIN-S3.SEAT
  F5A3    11 A803        C+                 LD      DE,S0.DEAT+3
  F5A6    DD 19          C+                 ADD     IX,DE
  F5A8    CD F659        C+                 CALL    S0.KRZU
  F5AB    CD 4049        C+                 CALL    S0.PRIO
  F5AE    CD B2D4        C      SM.M1:      CALL    S2.STACK
  F5B1    D1             C                  POP     DE
  F5B2    DD E1          C                  POP     IX
  F5B4    C9             C                  RET
                         C      
                         C      ;           END
                         C      ;           PN      S052
                         C                  TITLE   'Adresskonstanten fuer das System 2.1'
                         C                  PAGE    87
'Adresskonstanten fuer das System 2.1'	MACRO-80 3.44	09-Dec-81	PAGE	1-185


                         C      
                         C      ;****************************************************************
                         C      ;*              Peripherie- und Speicher-adresskonstanten fuer  *
                         C      ;*              das Betriebssystem         D  E  G  2  0  0  0  *
                         C      ;****************************************************************
  0032                   C      S0.V1       EQU     '2'                 ;Version des Systems
  0031                   C      S0.V2       EQU     '1'
  0033                   C      S0.V3       EQU     '3'                 ;Release
  0031                   C      S0.V5       EQU     '1'                 ; "1" ---  DEG2.i von Kassette
                         C                                              ; "2" ---  DEG2.i auf E PROM
  0031                   C      S0.V6       EQU     '1'                 ; "1" ---  BASIC  von Kassette
                         C                                              ; "2" ---  BASIC  auf E PROM
  0045                   C      S0.V7       EQU     'E'
                         C      
  3232                   C      S0.D1       EQU     03232H              ;Ausgabedatum des Systems
  3330                   C      S0.D2       EQU     03330H
  3538                   C      S0.D3       EQU     03538H
  0018                   C      S0.ZANZ     EQU     24                  ;Zeilenanzahl  ABS
  0050                   C      S0.SPANZ    EQU     80                  ;Spaltenanzahl ABS
  000B                   C      S0.SYSZ     EQU     11                  ;Systemeingabezeile
  0002                   C      S0.ZEIT1    EQU     2                   ;Zeitkonstante 1 Tastatur
  0010                   C      S0.ZEIT2    EQU     16                  ;Zeitkonstante 2 Tastatur
  0100                   C      S0.LRECL    EQU     256                 ;Standardblocklaenge Kassette
                         C      
  2917                   C      S0.FKADR    EQU     02917H              ;Zeile 23 , Spalte 41
  2918                   C      S0.SKADR    EQU     02918H              ;Zeile 24 , Spalte 41
                         C      
  0000                   C      S0.ADA      EQU     000H                ;Peripherieadresse A D A
  00C0                   C      S0.TRAM     EQU     0C0H                ;Peripherieadresse T R A M
  0030                   C      S0.AKB      EQU     030H                ;Peripherieadresse A K B
  0040                   C      S0.DRU      EQU     040H                ;Peripherieadresse Drucker
  0050                   C      S0.V24      EQU     050H                ;Peripherieadresse V 2 4
  00A0                   C      S0.PTAST    EQU     0A0H                ;Peripherieadresse Tastatur
  00E0                   C      S0.PROM     EQU     0E0H                ;Peripherieadresse P P E
  00C0                   C      S0.SBST     EQU     0C0H                ;Peripherieadresse S B S T
                         C      
  0000                   C      S0.RAM      EQU     00000H              ;Anfangsadresse    Arbeits-RAM
  AFFE                   C      S0.STACK    EQU     0B000H-2            ;Stackanfang
  3000                   C      S0.BWS      EQU     03000H
  A000                   C      S0.BWSA     EQU     0A000H              ;Anfangsadresse    Bildwiederholspeicher
  A800                   C      S0.DEAT     EQU     0A800H              ;Dynamische     E/A-Tabelle
  B7D0                   C      S0.VPI      EQU     0BFFFH-00830H+1     ;Vorbereich     Eingabepuffer
  B7E0                   C      S0.PFFI     EQU     S0.VPI+00010H       ;               Eingabepuffer
  BBE0                   C      S0.NPI      EQU     S0.VPI+00410H       ;Nachbereich    Eingabepuffer
  BBF0                   C      S0.PFFA     EQU     S0.VPI+00420H       ;               Ausgabepuffer
  BFF0                   C      S0.NPA      EQU     S0.VPI+00820H       ;Nachbereich    Ausgabepuffer
  0100                   C      S0.TPA      EQU     S0.RAM+00100H       ;Anfangsadresse Textpuffer (EDITOR-Raum)
  80FF                   C      S0.TPE      EQU     080FFH
  9FFF                   C      S0.MEMCK    EQU     09FFFH
                         C      
  F5B5    C4EB           C      S0.IV:      DW      S1.IO               ;Interruptroutine: EI,RETI
  0058                   C      S0.IVSYS    EQU     0058H               ;LOW(IV)
                         C      
                         C                  TITLE   'Systemkommando  S Y S 1'
                         C                  PAGE
'Systemkommando  S Y S 1'	MACRO-80 3.44	09-Dec-81	PAGE	1-186


                         C      
                         C      ;****************************************************************
                         C      ;*                 Systemkommando :  S Y S 1                    *
                         C      ;****************************************************************
  F5B7    F5B7           C                  DW      $
  F5B9    53 31 20 20    C                  DB      'S1  '
                         C      
  F5BD    CD F5DD        C      S0.DEG1:    CALL    S0.EM12
  F5C0    C3 0000        C                  JP      0                   ;Sprung zum ZRE-EPROM
                         C      
                         C                  TITLE   'Systemkommando  S Y S 2'
                         C                  PAGE
'Systemkommando  S Y S 2'	MACRO-80 3.44	09-Dec-81	PAGE	1-187


                         C      
                         C      ;****************************************************************
                         C      ;*                 Systemkommando :  S Y S 2                    *
                         C      ;****************************************************************
  F5C3    31 B000        C      S0.DEG2:    LD      SP,S0.STACK+2
  F5C6    CD F5CC        C                  CALL    S0.EM11
  F5C9    C3 C084        C                  JP      S1.RES1
                         C      
                         C                  TITLE   'Umschalten  fuer Emulator'
                         C                  PAGE
'Umschalten  fuer Emulator'	MACRO-80 3.44	09-Dec-81	PAGE	1-188


                         C      
                         C      ;****************************************************************
                         C      ;*            Umschalten Speicherbereiche Emulator              *
                         C      ;****************************************************************
  F5CC    C5             C      S0.EM11:    PUSH    BC                  ;komplett Speicherbereich 2
  F5CD    E5             C                  PUSH    HL
  F5CE    01 04C0        C                  LD      BC,004C0H
  F5D1    21 F5D9        C                  LD      HL,S0.EM111
  F5D4    ED B3          C                  OTIR
  F5D6    E1             C                  POP     HL
  F5D7    C1             C                  POP     BC
  F5D8    C9             C                  RET
  F5D9    F0             C      S0.EM111:   DB      0F0H                ;Startbyte
  F5DA    03             C                  DB      003H                ;wahl
  F5DB    0B             C                  DB      00BH                ;Sys_21
  F5DC    FF             C                  DB      0FFH                ;Endbyte
                         C      
  F5DD    C5             C      S0.EM12:    PUSH    BC                  ;0000-7FFF Speicherbereich 1
                         C                                              ;8000-FFFF Speicherbereich 2
  F5DE    E5             C                  PUSH    HL
  F5DF    01 04C0        C                  LD      BC,004C0H
  F5E2    21 F5EA        C                  LD      HL,S0.EM121
  F5E5    ED B3          C                  OTIR
  F5E7    E1             C                  POP     HL
  F5E8    C1             C                  POP     BC
  F5E9    C9             C                  RET
  F5EA    F0             C      S0.EM121:   DB      0F0H                ;Startbyte
  F5EB    03             C                  DB      003H                ;wahl
  F5EC    0C             C                  DB      00CH                ;Sys_22
  F5ED    FF             C                  DB      0FFH                ;Endbyte
                         C      
                         C                  TITLE   'Umschalten  B W S A <==> B W S'
                         C                  PAGE
'Umschalten  B W S A <==> B W S'	MACRO-80 3.44	09-Dec-81	PAGE	1-189


                         C      
                         C      ;****************************************************************
                         C      ;*            Umschalten Einzelzeichen                          *
                         C      ;****************************************************************
  F5EE    7E             C      S0.BWSUZ:   LD      A,(HL)              ;B W S A  ===>  B W S
  F5EF    C5             C                  PUSH    BC
  F5F0    D5             C                  PUSH    DE
  F5F1    E5             C                  PUSH    HL
  F5F2    F5             C                  PUSH    AF
  F5F3    CD B2D6        C                  CALL    S2.STACK+2
  F5F6    F1             C      S0.UZ90:    POP     AF
  F5F7    E1             C                  POP     HL
  F5F8    E5             C                  PUSH    HL
  F5F9    F5             C                  PUSH    AF
  F5FA    B7             C                  OR      A
  F5FB    ED 5B B194     C                  LD      DE,(MS.BWSA)
  F5FF    ED 52          C                  SBC     HL,DE
  F601    11 3000        C                  LD      DE,S0.BWS
  F604    19             C                  ADD     HL,DE
  F605    F1             C                  POP     AF
  F606    77             C                  LD      (HL),A
  F607    CD B2D4        C                  CALL    S2.STACK
  F60A    18 16          C                  JR      S0.US98
                         C      
                         C      ;****************************************************************
                         C      ;*             Umschalten des gesamten BWS                      *
                         C      ;****************************************************************
  F60C    C5             C      S0.BWSUS:   PUSH    BC                  ;B W S A  ===>  B W S
  F60D    D5             C                  PUSH    DE
  F60E    E5             C                  PUSH    HL
  F60F    F5             C                  PUSH    AF
  F610    CD B2D6        C      S0.US90:    CALL    S2.STACK+2
  F613    2A B194        C                  LD      HL,(MS.BWSA)
  F616    11 3000        C                  LD      DE,S0.BWS
  F619    01 0780        C      S0.US99:    LD      BC,00780H           ;00800H nur 24*80
  F61C    ED B0          C                  LDIR
  F61E    CD B2D4        C                  CALL    S2.STACK
  F621    F1             C                  POP     AF
  F622    E1             C      S0.US98:    POP     HL
  F623    D1             C                  POP     DE
  F624    C1             C                  POP     BC
  F625    C9             C                  RET
                         C      
  F626    C5             C      S0.BWSU1:   PUSH    BC                  ;B W S  ===>  B W S A
  F627    D5             C                  PUSH    DE
  F628    E5             C                  PUSH    HL
  F629    F5             C                  PUSH    AF
  F62A    CD B2D6        C                  CALL    S2.STACK+2
  F62D    21 3000        C                  LD      HL,S0.BWS
  F630    ED 5B B194     C                  LD      DE,(MS.BWSA)
  F634    18 E3          C                  JR      S0.US99
                         C      
                         C                  TITLE   'B W S   zu-/ab-schalten'
                         C                  PAGE
'B W S   zu-/ab-schalten'	MACRO-80 3.44	09-Dec-81	PAGE	1-190


                         C      
  F636    18 04          C      S0.BWSB:    JR      S0.BWSAB
                         C      
  F638                   C      S0.BWSZU    EQU     $                   ;B W S  zuschalten
  F638    CD F5DD        C                  CALL    S0.EM12
  F63B    C9             C                  RET
                         C      
                         C                  PAGE
'B W S   zu-/ab-schalten'	MACRO-80 3.44	09-Dec-81	PAGE	1-191


                         C      
  F63C                   C      S0.BWSAB    EQU     $                   ;B W S  abschalten
  F63C    CD F5CC        C                  CALL    S0.EM11
  F63F    C9             C                  RET
                         C      
                         C                  TITLE   'BASIC-Laden'
                         C                  PAGE
'BASIC-Laden'	MACRO-80 3.44	09-Dec-81	PAGE	1-192


                         C      
                         C      ;****************************************************************
                         C      ;*                 Laden des BASIC - Interpreters               *
                         C      ;****************************************************************
  F640                   C      S0.BASCL    EQU     $
                         C      
                         C                  IF      S0.V6 AND 1
  F640    21 0A44        C                  LD      HL,00A44H
  F643    22 0307        C                  LD      (BC.USR+1),HL
                         C                  ENDIF
                         C      
  F646    21 0000        C                  LD      HL,0                ;ersten 100H-Byte loeschen
  F649    11 0001        C                  LD      DE,1
  F64C    01 00FF        C                  LD      BC,255
  F64F    71             C                  LD      (HL),C
  F650    ED B0          C                  LDIR
  F652    C3 F576        C                  JP      S4.BSCN
                         C      
                         C      ;****************************************************************
                         C      ;*                 Tastatur- bzw. BAMOS-Kassettenroutinen aus   *
                         C      ;*                 DEG 2000 Version 1.2 aktivieren              *
                         C      ;****************************************************************
  F655    CD F5DD        C      S0.TAZU:    CALL    S0.EM12
  F658    C9             C                  RET
                         C      
  F659    CD F5DD        C      S0.KRZU:    CALL    S0.EM12
  F65C    C9             C                  RET
                         C      
                         C      ;           END
                         C      ;           PN      S099
                         C      ;****************************************************************
                         C      ;*               C T C - Interruptadresse fuer Echtzeituhr      *
                         C      ;*  Version      -----------------------------------------------*
                         C      ;*               Programmierer: M. Herbote --- K EAW  ZFT (WFT) *
                         C      ;*  V 2 . 1      -----------------------------------------------*
                         C      ;*               Stand        : 14.August 1984                  *
                         C      ;****************************************************************
                         C      
                         C                  IF      S4.V1 AND 00001000B
                         C      S0.CTC0:    DW      S4.IRTIM
                         C                  ENDIF
                         C      
                         C      ;           END
                                
  F65D                          XXXX        EQU     $
                                            .DEPHASE
                                
                                            TITLE   'Symbolliste SYS 2.13'
                                            END
'Symbolliste SYS 2.13'	MACRO-80 3.44	09-Dec-81	PAGE	S


Macros:
S3.RMOS         SM.DRU          TA.TAST         

Symbols:
30B2 	BC.ANF          0451 	BC.C006         0948 	BC.C032         
171B 	BC.C091         1F40 	BC.CALL1        1F4B 	BC.CALL2        
0309 	BC.CIN          030F 	BC.CON          0318 	BC.CSTSX        
0150 	BC.D017         015E 	BC.D024         0160 	BC.D025         
0162 	BC.D026         019A 	BC.D047         01AB 	BC.D058         
1F57 	BC.D101         2FB7 	BC.D131         03A6 	BC.GRF1         
2CC0 	BC.GRF2         0300 	BC.INIT         0315 	BC.LISTX        
0327 	BC.PAR          0303 	BC.RECOV        3010 	BC.RECOV1       
030C 	BC.RIV          032A 	BC.RUCK         03C6 	BC.SVC1         
2D98 	BC.SVC2         0306 	BC.USR          0312 	BC.WRTV         
D4B9 	K1.ADRK1        D4DF 	K1.ADRK2        D505 	K1.ADRK3        
D52B 	K1.ADRK4        D5B3 	K1.ARBT         D551 	K1.ARMB         
D564 	K1.ARMBM        DB66 	K1.AUS          D79B 	K1.BERT         
D5CC 	K1.BLKM         D5BE 	K1.BLKP         D60B 	K1.BM           
DA40 	K1.CLS          DB2D 	K1.EIN          DB48 	K1.EINP         
DB4B 	K1.EINP1        DB62 	K1.EINP2        D6A1 	K1.ERRT         
D612 	K1.F17          D65D 	K1.FL           DB85 	K1.FU           
D86B 	K1.GNCLS        D826 	K1.GNLM         D828 	K1.GNLMN        
D7EE 	K1.GNLP         D7F0 	K1.GNLPN        D762 	K1.GNRA         
D898 	K1.GNRD         D8C2 	K1.GNRDR        D745 	K1.GNRE         
D736 	K1.GNRE1        D7BD 	K1.GNRM         D7A2 	K1.GNRP         
D77D 	K1.GNRW         D968 	K1.GNRW1        D957 	K1.GNRW2        
D974 	K1.GNRW3        D92C 	K1.GNRWR        D8C8 	K1.GNRZ         
D901 	K1.GNRZE        D6EE 	K1.GNSTS        D9D5 	K1.GNTS1        
D9CB 	K1.GNTS2        D908 	K1.GNWR         D977 	K1.GNWRT        
D994 	K1.GNZKL        D57C 	K1.IX2V1        DB8E 	K1.LESV         
D5FE 	K1.LHLBC        DABE 	K1.LM           D83C 	K1.LM1          
D846 	K1.LM2          D856 	K1.LM3          DAA5 	K1.LP           
D80B 	K1.LP1          D812 	K1.LP2          D822 	K1.LP3          
DDC0 	K1.M0           DDFA 	K1.M2           DE20 	K1.M3           
DE5A 	K1.M5           DE66 	K1.M6           DE7D 	K1.ME1          
DE80 	K1.ME2          DE96 	K1.ME3          DEAF 	K1.ME4          
D64C 	K1.MONI         DC8C 	K1.MRAP1        DC9A 	K1.MRAP2        
DCAE 	K1.MRAP3        DC68 	K1.MRAP4        DCB6 	K1.MRAP5        
DC63 	K1.MRAPO        DBDD 	K1.MRC1         DBFD 	K1.MRC2         
DC07 	K1.MRC3         DC12 	K1.MRC4         DC0C 	K1.MRC5         
DBC1 	K1.MRCAT        DCD0 	K1.MRCL1        DCE4 	K1.MRCL2        
DD2C 	K1.MRCL3        DD3F 	K1.MRCL4        DCC0 	K1.MRCLS        
DC21 	K1.MREPO        DC49 	K1.MRPO3        DC33 	K1.MRPO4        
DC53 	K1.MRPO5        D684 	K1.MVL          D66D 	K1.MVS          
D8AD 	K1.PUFT         D5E8 	K1.RCZM         D5F6 	K1.RCZN         
D5DA 	K1.RCZP         D5F7 	K1.RCZS         D893 	K1.RD1          
D62A 	K1.RGL1         D63B 	K1.RGL2         DA8C 	K1.RM           
DA73 	K1.RP           DA27 	K1.RV1          D795 	K1.RW1          
D78E 	K1.RW3          D858 	K1.RW4          DBAB 	K1.SCHR         
D9EF 	K1.SRV          DA59 	K1.STS          DAC1 	K1.STS1         
DA08 	K1.UNL          D596 	K1.V12IX        DAD7 	K1.WR1          
D9DA 	K1.WRTEN        DAFC 	K1.XA           DAFF 	K1.XA1          
DB27 	K1.XE           DEC9 	K1.ZMIN         D690 	K1.ZPR2         
D69E 	K1.ZPR3         B12E 	K2.ADREA        B13A 	K2.ADRK         
B11E 	K2.BLK          B120 	K2.BLZ          B132 	K2.FKADR        
B136 	K2.FRADR        B130 	K2.GADR         B12A 	K2.GNW1         
B138 	K2.LRECL        B12C 	K2.PTADR        B162 	K2.RBER         
B11C 	K2.RCZ          B122 	K2.RCZB         B134 	K2.SKADR        
B126 	K2.TXANF        B128 	K2.TXEND        B124 	K2.TXOP         
4069 	KR.BRKMB        B119 	KS.ADR          B000 	KS.AEATB        
B11B 	KS.CONTR        B00C 	KS.CRCZ         B00E 	KS.FEHLZ        
B012 	KS.IDAT         B117 	KS.KOMDO        B00F 	KS.POS          
B013 	KS.PUFFS        B002 	KS.PZAUS        B004 	KS.PZEIN        
B011 	KS.SDAT         B00A 	KS.Z1           B00B 	KS.Z2           
B006 	KS.ZAUS         B008 	KS.ZEIN         B118 	KS.ZEITK        
E106 	LO.AL           E1B2 	LO.DF           DF09 	LO.EIN          
E276 	LO.EIN1         DFB1 	LO.EIN2         DFB8 	LO.EIN3         
DEFB 	LO.LO1          DFF6 	LO.LO10         DEF0 	LO.LO11         
DF89 	LO.LO12         DF4C 	LO.LO13         DF65 	LO.LO14         
DFBB 	LO.LO15         DFC9 	LO.LO18         DFCC 	LO.LO19         
DF26 	LO.LO2          DF2B 	LO.LO4          DF55 	LO.LO5          
DF58 	LO.LO6          DF5F 	LO.LO7          DF9E 	LO.LO8          
DFE1 	LO.LO9          DF19 	LO.LOAUS        DF0F 	LO.LOEIN        
E2A7 	LO.RGL          E2B2 	LO.RGL1         E137 	LO.RL           
E13B 	LO.RL1          E1C4 	LO.RL10         E143 	LO.RL2          
E150 	LO.RL3          E16A 	LO.RL4          E18A 	LO.RL5          
E193 	LO.RL6          E195 	LO.RL7          E19E 	LO.RL8          
E1AD 	LO.RL9          E1B8 	LO.RLUP         E1E8 	LO.SAV1         
E0C8 	LO.SAV12        E0E0 	LO.SAV13        E0EC 	LO.SAV14        
E1F0 	LO.SAV2         E06D 	LO.SAV3         E073 	LO.SAV4         
E088 	LO.SAV7         E094 	LO.SAV8         E0A9 	LO.SAV9         
E1D3 	LO.SAVE         E1F1 	LO.SV1          E1F3 	LO.SV2          
E204 	LO.SV3          E210 	LO.SV4          E285 	LO.TR1          
'Symbolliste SYS 2.13'	MACRO-80 3.44	09-Dec-81	PAGE	S-1


E21B 	LO.TXT          E2B6 	LO.TXT1         E3A2 	LO.TXT10        
E3C8 	LO.TXT11        E301 	LO.TXT12        E30C 	LO.TXT13        
E33B 	LO.TXT14        E353 	LO.TXT15        E2CB 	LO.TXT2         
E2E0 	LO.TXT3         E2EB 	LO.TXT4         E2F6 	LO.TXT5         
E317 	LO.TXT6         E326 	LO.TXT7         E356 	LO.TXT8         
E37C 	LO.TXT9         E10A 	LO.UW           E119 	LO.UW1          
E122 	LO.UWEND        CF4F 	MO.ADDBL        CBCB 	MO.ANZ          
CC04 	MO.BILO         CF46 	MO.BWSAF        CF4B 	MO.BWSE         
CF65 	MO.BWSL         CB45 	MO.BWSUS        CB4F 	MO.BWSUZ        
CFD6 	MO.CNZAL        CFCB 	MO.CNZAS        CF01 	MO.CPOL         
CEFC 	MO.CPOS         CD90 	MO.DEC2         CDA9 	MO.DEC3         
CE25 	MO.DEC4         CDF7 	MO.DEC5         CE2C 	MO.DEC6         
CE1D 	MO.DEC7         CD88 	MO.DECS         CD76 	MO.DECZ         
CF5E 	MO.DESZ         CD67 	MO.DIL          CD98 	MO.DIS          
CD61 	MO.DSPOL        CD80 	MO.DSPOS        CD59 	MO.DZPOL        
CD6E 	MO.DZPOS        CB3A 	MO.ENMO         CB44 	MO.ENMOT        
CC1A 	MO.FSLO         CC38 	MO.FSLO1        CC53 	MO.FSLO2        
CFBE 	MO.HOMEL        CFB1 	MO.HOMES        CEF9 	MO.INC1         
CE67 	MO.INC2         CEF7 	MO.INC3         CEFA 	MO.INC4         
CEF3 	MO.INC5         CEC1 	MO.INC6         CEEE 	MO.INC7         
CEE7 	MO.INC8         CE5F 	MO.INCS         CE4C 	MO.INCZ         
CE3A 	MO.ISPOL        CE56 	MO.ISPOS        CE31 	MO.IZPOL        
CE43 	MO.IZPOS        CF82 	MO.LCP1         CFA0 	MO.LCP2         
CF93 	MO.LCPOL        CF75 	MO.LCPOS        CF13 	MO.LSA          
CF25 	MO.LSAF         CF33 	MO.LZA          CF36 	MO.LZA1         
CF41 	MO.LZAF         CB16 	MO.MONI         CB42 	MO.MORT         
CB59 	MO.MOTAB        CFFA 	MO.MPL          CFEB 	MO.MPS          
D000 	MO.MSL          D125 	MO.MVL          D130 	MO.MVL1         
D107 	MO.MVS          D112 	MO.MVS1         CFF3 	MO.MZL          
D0E6 	MO.MZLN         D106 	MO.MZLNO        D106 	MO.MZLNW        
D0C6 	MO.MZLO         D0F6 	MO.MZLS         D106 	MO.MZLSO        
D106 	MO.MZLSW        D0D6 	MO.MZLW         CFE1 	MO.MZS          
D0C3 	MO.MZSL         D0A3 	MO.MZSN         D0C5 	MO.MZSNO        
D0C5 	MO.MZSNW        D02F 	MO.MZSO         D048 	MO.MZSO1        
D04B 	MO.MZSO2        D05B 	MO.MZSO3        D0B3 	MO.MZSS         
D0C5 	MO.MZSSO        D0C5 	MO.MZSSW        D069 	MO.MZSW         
D082 	MO.MZSW1        D085 	MO.MZSW2        D095 	MO.MZSW3        
CF52 	MO.PNSP         CF58 	MO.PNSP1        CF6F 	MO.POSA         
CD49 	MO.RESC         CD56 	MO.RESC1        CDA3 	MO.ROL1         
CCBA 	MO.ROLI         CCC2 	MO.ROLI1        CCCE 	MO.ROLI2        
CCD5 	MO.ROLI3        CD9F 	MO.ROLL         CC58 	MO.ROOB         
CC62 	MO.ROOB1        CC77 	MO.ROOB2        CC80 	MO.ROOB3        
CC8D 	MO.ROOB4        CCD7 	MO.RORE         CCE3 	MO.RORE1        
CCF1 	MO.RORE2        CCFA 	MO.RORL1        CD05 	MO.RORL2        
CD0A 	MO.RORL3        CD11 	MO.RORL4        CD1C 	MO.RORL5        
CD20 	MO.RORL6        CCFE 	MO.RORL7        CC8F 	MO.ROUN         
CC9C 	MO.ROUN1        CCB5 	MO.ROUN2        CD26 	MO.SETC         
CD41 	MO.SETC1        CF06 	MO.SSA          CF09 	MO.SSA1         
CF18 	MO.SSAF         CF1B 	MO.SSAF1        CF20 	MO.SSAF2        
CBF5 	MO.SYSB         CF2A 	MO.SZA          CF2D 	MO.SZA1         
CF3C 	MO.SZAF         CBE4 	MO.VB2          CBD5 	MO.VOLLB        
D01F 	MO.ZLTAB        D00F 	MO.ZSTAB        B194 	MS.BWSA         
B198 	MS.CMD          B19E 	MS.CZEIT        B196 	MS.DIREL        
B197 	MS.DIRES        B19D 	MS.MCUR         B19C 	MS.MCZ          
B19A 	MS.RADR         B191 	MS.SMAX         B18F 	MS.SMIN         
B193 	MS.SPANZ        B18B 	MS.SPOL         B18D 	MS.SPOS         
B199 	MS.TK           B192 	MS.ZANZ         B190 	MS.ZMAX         
B18E 	MS.ZMIN         B18A 	MS.ZPOL         B18C 	MS.ZPOS         
0000 	S0.ADA          0030 	S0.AKB          F640 	S0.BASCL        
3000 	S0.BWS          A000 	S0.BWSA         F63C 	S0.BWSAB        
F636 	S0.BWSB         F626 	S0.BWSU1        F60C 	S0.BWSUS        
F5EE 	S0.BWSUZ        F638 	S0.BWSZU        3232 	S0.D1           
3330 	S0.D2           3538 	S0.D3           A800 	S0.DEAT         
F5BD 	S0.DEG1         F5C3 	S0.DEG2         0040 	S0.DRU          
F5CC 	S0.EM11         F5D9 	S0.EM111        F5DD 	S0.EM12         
F5EA 	S0.EM121        C000 	S0.ENTRY        2917 	S0.FKADR        
F5B5 	S0.IV           0058 	S0.IVSYS        F659 	S0.KRZU         
0100 	S0.LRECL        9FFF 	S0.MEMCK        4046 	S0.MRES         
BFF0 	S0.NPA          BBE0 	S0.NPI          BBF0 	S0.PFFA         
B7E0 	S0.PFFI         4049 	S0.PRIO         00E0 	S0.PROM         
00A0 	S0.PTAST        0000 	S0.RAM          00C0 	S0.SBST         
2918 	S0.SKADR        0050 	S0.SPANZ        AFFE 	S0.STACK        
000B 	S0.SYSZ         4003 	S0.TA1          4006 	S0.TA2          
F655 	S0.TAZU         4015 	S0.TBEL         4012 	S0.TEM          
400C 	S0.TFE          400F 	S0.TIM          4000 	S0.TINIT        
0100 	S0.TPA          80FF 	S0.TPE          00C0 	S0.TRAM         
F610 	S0.US90         F622 	S0.US98         F619 	S0.US99         
F5F6 	S0.UZ90         0032 	S0.V1           0031 	S0.V2           
0050 	S0.V24          0033 	S0.V3           0031 	S0.V5           
0031 	S0.V6           0045 	S0.V7           B7D0 	S0.VPI          
0018 	S0.ZANZ         0002 	S0.ZEIT1        0010 	S0.ZEIT2        
C2AB 	S1.ABFR         C328 	S1.AEIN         C42D 	S1.ANZ1         
C492 	S1.ANZ2         C3FE 	S1.ANZ3         C418 	S1.ANZ4         
'Symbolliste SYS 2.13'	MACRO-80 3.44	09-Dec-81	PAGE	S-2


C41D 	S1.ANZ5         C3F1 	S1.ANZ6         C49D 	S1.ANZ7         
C4AC 	S1.ANZ8         C4A4 	S1.ANZ9         C3BF 	S1.ANZEI        
C8B0 	S1.ANZU1        C8C0 	S1.ANZU2        C825 	S1.ANZUM        
C5FF 	S1.BHKON        C652 	S1.CHK          C655 	S1.CHK1         
CA65 	S1.CLOS         C2D3 	S1.CNLS         C2EB 	S1.CNOS         
C2B4 	S1.CNRS         C2DF 	S1.CNUS         C300 	S1.CNZA         
C7B1 	S1.CPI          C7AD 	S1.CPI10        C2BE 	S1.CURS1        
C2F9 	S1.CURS2        C191 	S1.DAT          C750 	S1.DATE         
C7FE 	S1.DB0          C828 	S1.DB1          C837 	S1.DB10         
C83A 	S1.DB11         C82E 	S1.DB111        C844 	S1.DB12         
C850 	S1.DB13         C85B 	S1.DB14         C867 	S1.DB15         
C86A 	S1.DB16         C88E 	S1.DB2          C871 	S1.DB9          
C322 	S1.DEL1         C317 	S1.DEL2         C304 	S1.DELZL        
C589 	S1.DIV          C58A 	S1.DIV1         C86E 	S1.EINDB        
C4EE 	S1.FEH          C511 	S1.FEH1         C4F4 	S1.FEHR         
C4F7 	S1.FEHRR        C616 	S1.HB10         C5E6 	S1.HBK1         
C5CC 	S1.HBKON        C359 	S1.HC1          C35E 	S1.HC2          
CA08 	S1.HCDB         CA02 	S1.HCDB0        CA19 	S1.HCDB1        
CA25 	S1.HCDB2        CA28 	S1.HCDB3        CA35 	S1.HCDB4        
CA42 	S1.HCDB5        CA44 	S1.HCDB6        CA51 	S1.HCDB7        
C354 	S1.HCOPY        C54E 	S1.HDI          C56C 	S1.HDI1         
C585 	S1.HDI2         C582 	S1.HDI3         C2F7 	S1.HOME         
C995 	S1.HXN1         C592 	S1.IDH          C5B4 	S1.IDH1         
C59A 	S1.IDH2         C59E 	S1.IDH3         C5B0 	S1.IDHE         
C5AE 	S1.IDHF         C9FB 	S1.INC1         C9FE 	S1.INC2         
C298 	S1.INIT5        C2A0 	S1.INIT6        C270 	S1.INITE        
C532 	S1.INPTR        C4EB 	S1.IO           C771 	S1.IOCC         
C5E8 	S1.KON1         C60E 	S1.KON2         C5FA 	S1.KON3         
C033 	S1.LA           CA65 	S1.LESR         CA65 	S1.LESV         
C7C5 	S1.LPI          C7C1 	S1.LPI6         C62E 	S1.LT1Z         
C92F 	S1.MEA          C94A 	S1.MEA11        C94F 	S1.MEA12        
C952 	S1.MEA13        C990 	S1.MEA14        C9C1 	S1.MEA2         
C981 	S1.MEA21        C9C4 	S1.MEA3         C989 	S1.MEA31        
C9D5 	S1.MEA32        C9D8 	S1.MEA33        C9DC 	S1.MEA4         
C978 	S1.MEA5         C986 	S1.MEA6         C9ED 	S1.MEA7         
C9F9 	S1.MEA8         C9EF 	S1.MEA9         C935 	S1.MEAA         
C9BF 	S1.MEAU1        C9E4 	S1.MEAU2        C024 	S1.MO           
C5C3 	S1.MUL10        C640 	S1.MX           C8A2 	S1.NEG1         
C8AC 	S1.NEG2         C896 	S1.NEGDB        C042 	S1.NMI          
C334 	S1.NN           C33E 	S1.NN1          C345 	S1.NNN          
C7D4 	S1.NULL         C7D3 	S1.ONULL        CA65 	S1.OPEN         
C883 	S1.POS1         C88D 	S1.POS2         C877 	S1.POSDB        
C9B0 	S1.PULOE        C0B0 	S1.RES          C084 	S1.RES1         
C64A 	S1.RNL          C642 	S1.RNR          C07A 	S1.RST          
C042 	S1.RST38        CA65 	S1.SCHR         C8DB 	S1.SDB1         
C926 	S1.SDB10        C8E5 	S1.SDB2         C8E8 	S1.SDB3         
C8F8 	S1.SDB4         C904 	S1.SDB5         C913 	S1.SDB6         
C915 	S1.SDB7         C91B 	S1.SDB8         C925 	S1.SDB9         
C5BC 	S1.SIEBD        C02D 	S1.SM           C36F 	S1.START        
C75B 	S1.STAS1        C67C 	S1.STAT         C6DF 	S1.STT1         
C6FA 	S1.STT2         C701 	S1.STT3         C708 	S1.STT4         
C70F 	S1.STT5         C6A3 	S1.STTT1        C6A6 	S1.STTT2        
C6B6 	S1.STTT3        C6B9 	S1.STTT4        C6C9 	S1.STTT5        
C6CC 	S1.STTT6        C39B 	S1.SUCH1        C398 	S1.SUCH2        
C393 	S1.SUCHE        C620 	S1.SUZA         C624 	S1.SUZA1        
C629 	S1.SUZA3        C61A 	S1.SUZEI        C929 	S1.SYDB1        
C8CD 	S1.SYDB2        C8CA 	S1.SYSDB        C114 	S1.SYSTB        
C20A 	S1.SYSTC        C249 	S1.SYSTD        C4DB 	S1.SZA1         
C4D7 	S1.SZAHL        C4C1 	S1.SZEI         C4C4 	S1.SZEI1        
C4CB 	S1.SZEI2        C012 	S1.TA           C2A8 	S1.TFE          
C4B7 	S1.VERG1        C4BF 	S1.VERG2        C4B6 	S1.VERGL        
C4E7 	S1.ZAHL         C4E4 	S1.ZZA1         C4E0 	S1.ZZAHL        
B26E 	S2.AADR         B28A 	S2.AFOR         B28B 	S2.BZ           
B263 	S2.CST          B2D3 	S2.DDA          B2D2 	S2.DDAF         
B2CA 	S2.DDAFS        B2CB 	S2.DDAS         B2CD 	S2.DDB          
B2CC 	S2.DDBC         B2C4 	S2.DDBCS        B2C5 	S2.DDBS         
B2CC 	S2.DDC          B2C4 	S2.DDCS         B2CF 	S2.DDD          
B2CE 	S2.DDDE         B2C6 	S2.DDDES        B2C7 	S2.DDDS         
B2CE 	S2.DDE          B2B8 	S2.DDEI         B2C6 	S2.DDES         
B2D2 	S2.DDF          B2CA 	S2.DDFS         B2D1 	S2.DDH          
B2D0 	S2.DDHL         B2C8 	S2.DDHLS        B2C9 	S2.DDHS         
B2BA 	S2.DDI          B2B9 	S2.DDIM         B2C0 	S2.DDIX         
B2C2 	S2.DDIY         B2D0 	S2.DDL          B2C8 	S2.DDLS         
B2BC 	S2.DDPC         B2BB 	S2.DDR          B2BE 	S2.DDSP         
B28F 	S2.DH           B28E 	S2.DL           B29A 	S2.DM1          
B2AA 	S2.DM2          B292 	S2.DMANF        B296 	S2.DMBA         
B298 	S2.DMBE         B294 	S2.DMCUR        B2AB 	S2.DMH          
B2AC 	S2.DML          B26B 	S2.DNR          B257 	S2.END          
B25F 	S2.IM           B264 	S2.IOC          B270 	S2.KADR         
B260 	S2.OM           B290 	S2.PAR1         B25B 	S2.POIA         
B259 	S2.POIE         B265 	S2.PRGN         B25D 	S2.RADR         
B26C 	S2.RBBR         B2AF 	S2.S1           B2B0 	S2.S2           
B2AD 	S2.SMHL         B273 	S2.SP1          B274 	S2.SP2          
'Symbolliste SYS 2.13'	MACRO-80 3.44	09-Dec-81	PAGE	S-3


B275 	S2.SP3          B2D4 	S2.STACK        B28C 	S2.TE           
B24F 	S2.TPA          B251 	S2.TPE          B276 	S2.TRB          
B261 	S2.VZM          B253 	S2.WINA         B255 	S2.WINE         
B272 	S2.ZP           B262 	S2.ZZ           CB18 	S3.BLK1         
CB3C 	S3.BLK2         CA6A 	S3.DATUM        CAAF 	S3.DFU          
CB15 	S3.ENDEA        CA79 	S3.KS1          CA94 	S3.KS2          
CB16 	S3.KSK1         CB3A 	S3.KSK2         CA74 	S3.LANG         
CACA 	S3.LBL          CAE3 	S3.LBS          CA66 	S3.MASK1        
CA67 	S3.MASK2        CA68 	S3.MASK3        CA69 	S3.MASK4        
CB1A 	S3.MRP1         CB3E 	S3.MRP2         CAFC 	S3.PRIN         
CA70 	S3.PUFA         CA72 	S3.PUFI         CB16 	S3.RCZ1         
CB3A 	S3.RCZ2         CA66 	S3.SEAT         CA78 	S3.STI          
F576 	S4.BSCN         F576 	S4.BWS          F576 	S4.BWS1         
F57A 	S4.RES          00C0 	S4.SBST         F577 	S4.SC700        
F577 	S4.SC710        F577 	S4.SC720        F577 	S4.SC730        
F577 	S4.SC740        F577 	S4.SC750        F577 	S4.SC760        
F577 	S4.SVC10        F577 	S4.SVC52        F577 	S4.SVC60        
F577 	S4.SVC61        F577 	S4.SVC62        F577 	S4.SVC63        
F577 	S4.SVC64        F577 	S4.SVC65        F577 	S4.SVC66        
F577 	S4.SVC67        F577 	S4.SVC68        F577 	S4.SVC69        
00C0 	S4.U1           0040 	S4.U2           F576 	S4.UM15         
F577 	S4.UM16         F570 	S4.UM6          0031 	S4.V1           
0031 	S4.V2           F105 	S9.AB0          F111 	S9.AB01         
F0E9 	S9.AB1          F0F4 	S9.AB2          F0FF 	S9.AB3          
F0DD 	S9.ABAUP        F13A 	S9.ADRTB        F2B5 	S9.AL           
F2E0 	S9.AL1          F2D0 	S9.AL2          F2CD 	S9.AL3          
F272 	S9.ALLUP        F283 	S9.ALUP1        E615 	S9.ANFG         
E582 	S9.ANFP         E631 	S9.ANFPG        F2B0 	S9.AP           
F2B3 	S9.AP1          F3AA 	S9.APOS         F3AD 	S9.APOS1        
E532 	S9.ATAB1        E553 	S9.ATAB2        F113 	S9.AUP          
E3FF 	S9.BASC         E41C 	S9.BASC1        E459 	S9.BASC2        
F2AB 	S9.BC1          E637 	S9.BCTB1        E64F 	S9.BCTB2        
F2A6 	S9.BLD          F29C 	S9.BLD1         EBC3 	S9.BM1          
EBC7 	S9.BM2          EBD9 	S9.BM3          EBE4 	S9.BM4          
E4AB 	S9.BSC          E43F 	S9.BSCR         EB4C 	S9.CCIN         
EB54 	S9.CCIN1        EB7D 	S9.CCIN2        E694 	S9.CIN          
E6B4 	S9.CIN1         E6A9 	S9.CIN2         EFD6 	S9.CLO1         
EFC2 	S9.CLO2         EFDC 	S9.CLO3         EFE6 	S9.CLO4         
EFB0 	S9.CLOS1        EFAB 	S9.CLOSE        EFD4 	S9.CLR          
E6E3 	S9.CON          E72F 	S9.CON01        E73F 	S9.CON09        
E704 	S9.CON1         E70C 	S9.CON9         F3A1 	S9.CONO         
E716 	S9.CONOC        F3A7 	S9.CONOO        F08C 	S9.COP1         
F0D4 	S9.COP2         F0C4 	S9.COP3         F09E 	S9.COP5         
F0AE 	S9.COP7         F0B1 	S9.COP8         F0DA 	S9.COP9         
F07E 	S9.COPY         F3D5 	S9.CPOS         F267 	S9.CR           
E742 	S9.CST1         E766 	S9.CST10        E76A 	S9.CST11        
E746 	S9.CST2         E74A 	S9.CST3         E74E 	S9.CST4         
E752 	S9.CST5         E756 	S9.CST6         E75A 	S9.CST7         
E75E 	S9.CST8         E762 	S9.CST9         E6BF 	S9.CSTS1        
E76C 	S9.CSTS2        E778 	S9.CSTS3        E6D7 	S9.CSTS4        
E6DB 	S9.CSTS5        E6C8 	S9.CSTSX        E8A6 	S9.DEL          
E896 	S9.EIN1         E89F 	S9.EIN2         EE76 	S9.ENDEV        
EE86 	S9.ERS          EE93 	S9.ERS1         EE79 	S9.ERSTR        
E7C3 	S9.FB1          E7F9 	S9.FBE          E80D 	S9.FBE0         
E799 	S9.FBE1         E7DC 	S9.FBE12        E7EE 	S9.FBE13        
E7D3 	S9.FBE2         E7EB 	S9.FBE3         E45F 	S9.FT1          
E485 	S9.FT2          F1EF 	S9.HCP          F215 	S9.HCP1         
F217 	S9.HCP11        F21A 	S9.HCP12        F21D 	S9.HCP13        
F22D 	S9.HCP2         F243 	S9.HCP21        F249 	S9.HCP22        
F25C 	S9.HCP3         F262 	S9.HCPE         E782 	S9.HOME         
E57B 	S9.HOME1        F390 	S9.ICON         E884 	S9.INSM         
F3F8 	S9.IOC          F3FE 	S9.IOC1         EC8E 	S9.IOSTX        
ECF9 	S9.IOX          ECA6 	S9.IOX0         ECAE 	S9.IOX1         
ECCC 	S9.IOX10        ECE1 	S9.IOX11        ECE9 	S9.IOX12        
ECF1 	S9.IOX13        ECB6 	S9.IOX2         ECBE 	S9.IOX3         
ECC3 	S9.IOX8         ECC6 	S9.IOX9         ECCA 	S9.IOX90        
ECF6 	S9.IOXE         EBBE 	S9.LESV         EC6D 	S9.LISTX        
EC80 	S9.LISTY        EEB5 	S9.LOAD         EE1B 	S9.MEMCK        
F286 	S9.MEMO         F007 	S9.MIR          F014 	S9.MOR          
F341 	S9.MR1          F32A 	S9.MRAC         F319 	S9.MRAO         
F308 	S9.MRIO         F332 	S9.MRPAR        EB2B 	S9.NEG1         
EB20 	S9.NEGQ         F3DF 	S9.NFENS        EE72 	S9.NISY         
F3BA 	S9.NPOS         EE7D 	S9.NSTR         F395 	S9.OCON         
EF19 	S9.OP1          EF80 	S9.OP13         EF83 	S9.OP14         
EF24 	S9.OP2          EF8B 	S9.OP20         EF9A 	S9.OP21         
EFA2 	S9.OP22         EF39 	S9.OP3          EF49 	S9.OP4          
EF51 	S9.OP5          EF26 	S9.OP7          EF0A 	S9.OPEN         
EF0F 	S9.OPEN1        EFA8 	S9.OPR          EE20 	S9.OUT          
EE4B 	S9.OUTLG        E8F9 	S9.PF1          E9B6 	S9.PF10         
E904 	S9.PF101        E919 	S9.PF102        E926 	S9.PF103        
E943 	S9.PF104        E960 	S9.PF105        E975 	S9.PF106        
E98A 	S9.PF107        E9A7 	S9.PF108        E9B4 	S9.PF109        
E9C3 	S9.PF11         E9C1 	S9.PF110        E9CE 	S9.PF111        
'Symbolliste SYS 2.13'	MACRO-80 3.44	09-Dec-81	PAGE	S-4


E9DB 	S9.PF112        E9D0 	S9.PF12         E90E 	S9.PF2          
E91B 	S9.PF3          E928 	S9.PF4          E945 	S9.PF5          
E962 	S9.PF6          E977 	S9.PF7          E98C 	S9.PF8          
E9A9 	S9.PF9          EAC6 	S9.POS1         EB0B 	S9.POS2         
EB16 	S9.POS3         EAF8 	S9.POS4         EAFE 	S9.POS5         
E840 	S9.POSQ1        EABD 	S9.POSQ2        E855 	S9.PQ2TL        
F11C 	S9.RBAUP        F12D 	S9.RBP1         F136 	S9.RBP2         
EFFD 	S9.RCL1         EFB4 	S9.RCL2         F002 	S9.RCL3         
EFD1 	S9.RCL4         EFF8 	S9.RCL5         F035 	S9.RE9          
F021 	S9.READ         F026 	S9.READ1        F037 	S9.READ2        
F05E 	S9.RGLI         F06A 	S9.RGLI1        F06D 	S9.RGLI2        
F06E 	S9.RGLO         F07A 	S9.RGLO1        F07D 	S9.RGLO2        
EB80 	S9.RIV          EB8C 	S9.RIV1         EB92 	S9.RIV2         
EB95 	S9.RIV4         EBAC 	S9.RIV5         EBB4 	S9.RIV6         
EBB7 	S9.RIV9         EB89 	S9.RIVF         F2E2 	S9.RL           
F303 	S9.RL1          EED6 	S9.ROP1         EF13 	S9.ROP2         
EEDB 	S9.ROP3         EEE8 	S9.ROP4         EEF2 	S9.ROP7         
EEFF 	S9.ROP8         F126 	S9.RUP          EE95 	S9.SAVE         
F449 	S9.SC181        F469 	S9.SC182        F46B 	S9.SC183        
F457 	S9.SC184        F4E3 	S9.SC191        F55A 	S9.SC271        
F53E 	S9.SC272        F536 	S9.SC273        F55B 	S9.SC278        
F555 	S9.SC279        F4EF 	S9.SC331        F4FF 	S9.SC333        
F569 	S9.SC391        F56E 	S9.SC399        F4AA 	S9.SC441        
F4AF 	S9.SC442        F4B2 	S9.SC443        F4B7 	S9.SC444        
F4C1 	S9.SC449        F2B3 	S9.SC52E        E8C2 	S9.SCHL         
E8DD 	S9.SCHR         F3F3 	S9.SFENS        F355 	S9.SPA          
F34C 	S9.SPAUS        F35E 	S9.SPI          F37A 	S9.SPIN         
F36C 	S9.SPO          F385 	S9.SPOUT        EC7B 	S9.STX2         
EC7E 	S9.STX9         EE56 	S9.SUCHE        EE4B 	S9.SUSY         
EE32 	S9.SVC          F40B 	S9.SVC13        F4C3 	S9.SVC14        
F413 	S9.SVC17        F41B 	S9.SVC18        F4D4 	S9.SVC19        
F501 	S9.SVC27        F4E5 	S9.SVC32        F4EB 	S9.SVC33        
F55D 	S9.SVC39        F47E 	S9.SVC43        F495 	S9.SVC44        
E510 	S9.TALOE        E683 	S9.TAS          F403 	S9.TAS0         
F401 	S9.TAS01        E68C 	S9.TAS1         E68D 	S9.TAS2         
E88F 	S9.TL1          E892 	S9.TL2          E9E7 	S9.TPF1         
E9FF 	S9.TX1          EA33 	S9.TX2          EBF5 	S9.TXT1         
EA6F 	S9.TXT10        EA73 	S9.TXT11        EA77 	S9.TXT12        
EA7D 	S9.TXT13        EA85 	S9.TXT14        EA8B 	S9.TXT15        
EA8F 	S9.TXT16        EA95 	S9.TXT17        EABD 	S9.TXT18        
EC47 	S9.TXT2         EA43 	S9.TXT3         EA53 	S9.TXT4         
EA58 	S9.TXT5         EA5D 	S9.TXT6         EA62 	S9.TXT7         
EA65 	S9.TXT8         EA6B 	S9.TXT9         EE78 	S9.UEBGA        
E9DD 	S9.UP1          ECFA 	S9.USER         ED46 	S9.USER2        
ED97 	S9.USER3        ED0D 	S9.USR1         ED26 	S9.USR2         
ED69 	S9.USR22        ED7C 	S9.USR23        ED93 	S9.USR24        
ED8D 	S9.USR25        ED31 	S9.USR3         EDE3 	S9.USR32        
EDF5 	S9.USR33        EDBF 	S9.USR36        EDC7 	S9.USR37        
EDDB 	S9.USR39        ED44 	S9.USR4         ED8C 	S9.USR40        
EDD2 	S9.USR41        EE01 	S9.USR7         EE0C 	S9.USR8         
EE0E 	S9.USR9         F05C 	S9.WR9          F050 	S9.WRIT1        
F04B 	S9.WRITE        EC1B 	S9.WRTV         EC2A 	S9.WRTV2        
EC3E 	S9.WRTV5        EC3F 	S9.WRTV6        EC45 	S9.WRTV9        
EC24 	S9.WRTVF        E899 	S9.ZS           E8DB 	S9.ZS1          
F5AE 	SM.M1           F588 	SM.MRES         F59C 	SM.PRIO         
D29D 	TA.ABF1         D2FB 	TA.ABF10        D315 	TA.ABF11        
D31B 	TA.ABF12        D321 	TA.ABF13        D28E 	TA.ABF14        
D288 	TA.ABF15        D28C 	TA.ABF16        D2AC 	TA.ABF2         
D337 	TA.ABF20        D2AF 	TA.ABF3         D2D1 	TA.ABF6         
D2E9 	TA.ABF7         D2EF 	TA.ABF8         D2F5 	TA.ABF9         
D23D 	TA.ABFR         D24D 	TA.ABFR1        D250 	TA.ABFR2        
D26D 	TA.ABFR3        D37D 	TA.ABFR9        D22A 	TA.BBB          
D215 	TA.E0IN         D36C 	TA.EAW2         D370 	TA.EAW3         
D384 	TA.EAW4         D408 	TA.ET1          D402 	TA.ET2          
D38B 	TA.EW1          D3F5 	TA.FKT1         D3E0 	TA.FKT2         
D3ED 	TA.FKT3         D3FD 	TA.HZE          D3C2 	TA.INSMD        
D3CB 	TA.INSME        D3CC 	TA.INSML        D40E 	TA.LOE          
D426 	TA.LOES         D2D0 	TA.MM           D1A3 	TA.PIOPR        
D3B8 	TA.STEU1        D3A9 	TA.STEUT        D3DB 	TA.STZ          
D143 	TA.TA1          D15B 	TA.TA2          D1A1 	TA.TA21         
D184 	TA.TA22         D18B 	TA.TA23         D196 	TA.TA24         
D1B8 	TA.TA3          D200 	TA.TBEL         D1EB 	TA.TEM          
D327 	TA.TFE          D1D6 	TA.TIM          D435 	TA.TRTAB        
D1C1 	TA.TRTFE        D469 	TA.WART         D46F 	TA.WART0        
D47A 	TA.WART1        D4A7 	TA.WART2        D4A1 	TA.WART3        
D4AC 	TA.WART4        B249 	TS.BFOL1        B24B 	TS.BFOL2        
B22D 	TS.EINA         B23E 	TS.EMERK        B241 	TS.KGMER        
B248 	TS.MBF          B247 	TS.MIO          B231 	TS.NEWL         
B23B 	TS.PTAST        B23D 	TS.PTK          B23F 	TS.SPMER        
B24D 	TS.STACK        B19F 	TS.TAB1         B1FF 	TS.TAB2         
B217 	TS.TAB3         B223 	TS.TAB4         B233 	TS.TAB5         
B22F 	TS.TABU         B23C 	TS.TK           B240 	TS.UMERK        
B245 	TS.ZEI21        B243 	TS.ZEIT1        B244 	TS.ZEIT2        
'Symbolliste SYS 2.13'	MACRO-80 3.44	09-Dec-81	PAGE	S-5


B242 	TS.ZSMER        B246 	TS.ZSTC         2B03 	UB.KTAB         
F65D 	XXXX            



No Fatal error(s)


