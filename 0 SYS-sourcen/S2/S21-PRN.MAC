'S Y S   2 . 1 3'	MACRO-80 3.44	09-Dec-81	PAGE	1


                                            TITLE   'S Y S   2 . 1 3'
                                            PAGE    87
'S Y S   2 . 1 3'	MACRO-80 3.44	09-Dec-81	PAGE	1-1


                                
                                
  0150                          BC.D017     EQU     00150H
  015E                          BC.D024     EQU     0015EH
  0160                          BC.D025     EQU     00160H
  0162                          BC.D026     EQU     00162H
  019A                          BC.D047     EQU     0019AH
  01AB                          BC.D058     EQU     001ABH
  0300                          BC.INIT     EQU     00300H
  0303                          BC.RECOV    EQU     00303H
  0306                          BC.USR      EQU     00306H
  0309                          BC.CIN      EQU     00309H
  030C                          BC.RIV      EQU     0030CH
  030F                          BC.CON      EQU     0030FH
  0312                          BC.WRTV     EQU     00312H
  0315                          BC.LISTX    EQU     00315H
  0318                          BC.CSTSX    EQU     00318H
  0327                          BC.PAR      EQU     00327H
  032A                          BC.RUCK     EQU     0032AH
  03A6                          BC.GRF1     EQU     003A6H
  03C6                          BC.SVC1     EQU     003C6H
  0451                          BC.C006     EQU     00451H
  0948                          BC.C032     EQU     00948H
  171B                          BC.C091     EQU     0171BH
  1F40                          BC.CALL1    EQU     01F40H
  1F4B                          BC.CALL2    EQU     01F4BH
  1F57                          BC.D101     EQU     01F57H
  2CC0                          BC.GRF2     EQU     02CC0H
  2D98                          BC.SVC2     EQU     02D98H
  2FB7                          BC.D131     EQU     02FB7H
  3010                          BC.RECOV1   EQU     03010H
  30B2                          BC.ANF      EQU     030B2H
                                
  4000                          S0.TINIT    EQU     04000H              ; Initialisierung der Tastatur
  4003                          S0.TA1      EQU     04003H              ; U_Int - Abfrage
  4006                          S0.TA2      EQU     04006H              ; Tastencode-Eingabe
  400C                          S0.TFE      EQU     0400CH              ; Warten auf Tastenende
  400F                          S0.TIM      EQU     0400FH              ; Ansteuerung der INS_MOD - Diode
  4012                          S0.TEM      EQU     04012H              ; Ansteuerung der Ebenen  - Dioden
  4015                          S0.TBEL     EQU     04015H              ; Ansteuerung der Fehleranzeigen
                                
  4046                          S0.MRES     EQU     04046H              ; Drucker - Initialisierung
  4049                          S0.PRIO     EQU     04049H              ; Ausgabe eines Zeichens an den Drucker
                                
                                            .PHASE  0B000H-20H
                                ;--------------------------\            ; Vorspann fuer BIN-Datei
  AFE0    F0                                DB      0F0H                ; Startbyte ---> weitere BIN-Datei
  AFE1    53 31 32                          DB      'S12'               ;                Name der BIN-Datei
  AFE4                                      DS      25,0
  AFFD    02                                DB      002H                ; HS-Bereich : 2
  AFFE    B000                              DW      0B000H              ; Ladeadresse: B000H
                                ;--------------------------/
                                
                                        ;     INCLUDE KS01.MAC
                                        ;     INCLUDE K209.MAC
                                        ;     INCLUDE MS05.MAC
                                        ;     INCLUDE TS06.MAC
                                        ;     INCLUDE S213.MAC
                         C                  INCLUDE Speicher.MAC
                         C      ;           PN      KS
                         C                  TITLE   'Arbeitsbereich zur Geraetebedienroutine KMBG'
                         C                  PAGE
'Arbeitsbereich zur Geraetebedienroutine KMBG'	MACRO-80 3.44	09-Dec-81	PAGE	1-2


                         C      
                         C      ;****************************************************************
                         C      ;*               Arbeitsbereich zur Geraetebedienroutine KMBG   *
                         C      ;****************************************************************
  B000    0000           C      KS.AEATB:   DW      0                   ;Adresse E/A-Tabelle
  B002    0000           C      KS.PZAUS:   DW      0                   ;Pufferzeiger Ausgabe
  B004    0000           C      KS.PZEIN:   DW      0                   ;Pufferzeiger Eingabe
  B006    0000           C      KS.ZAUS:    DW      0                   ;Zaehler Ausgabe
  B008    0000           C      KS.ZEIN:    DW      0                   ;Zaehler Eingabe
  B00A    00             C      KS.Z1:      DB      0                   ;Zaehler Schreib-/Lese wdhg.
  B00B    00             C      KS.Z2:      DB      0                   ;Zaehler Blocklueckenverl.
  B00C    0000           C      KS.CRCZ:    DW      0                   ;CRC-Zeichen
  B00E    00             C      KS.FEHLZ:   DB      0                   ;Interner Fehleranzeiger
                         C      ;****************************************************************
                         C      ;*               Bedeutung des internen Fehleranzeigers         *
                         C      ;*               Bit     Fehler                                 *
                         C      ;*               -----------------------------------------------*
                         C      ;*               0     kein Echosignal vom Eingabekanal bei RAW *
                         C      ;*               1     letzter Interrupt nicht gekommen bei RAW *
                         C      ;*               2     Status waehrend der Datenuebertragung    *
                         C      ;*               3     CRC-Zeichen fehlerhaft beim Lesen        *
                         C      ;*               4     RAW-Fehler                               *
                         C      ;****************************************************************
  B00F    0000           C      KS.POS:     DW      0                   ;Position des Fehlers im Datensatz
  B011    00             C      KS.SDAT:    DB      0                   ;Solldaten
  B012    00             C      KS.IDAT:    DB      0                   ;Istdaten
  B013                   C      KS.PUFFS:   DS      260,0               ;Pufferspeicher
                         C      ;****************************************************************
                         C      ;*               Arbeitszellen fuer CRC-Routine                 *
                         C      ;****************************************************************
  B117    00             C      KS.KOMDO:   DB      0                   ;Kommando
  B118    00             C      KS.ZEITK:   DB      0                   ;Zeitkonstante
  B119    0000           C      KS.ADR:     DW      0                   ;Adresse
  B11B    00             C      KS.CONTR:   DB      0                   ;Ereigniskontrolle
                         C      ;
                         C      ;           END
                         C      ;           PN      K209
                         C                  TITLE   'Steuervektor zum Programm K1'
                         C                  PAGE
'Steuervektor zum Programm K1'	MACRO-80 3.44	09-Dec-81	PAGE	1-3


                         C      
                         C      ;****************************************************************
                         C      ;*               Steuervektor zum Programm K1                   *
                         C      ;*  Version      -----------------------------------------------*
                         C      ;*               Programmierer: M. Herbote --- K EAW  ZFT (WFT) *
                         C      ;*  V 2 . 1      -----------------------------------------------*
                         C      ;*               Stand        : 24.November 1983                *
                         C      ;****************************************************************
                         C      
  B11C    0000           C      K2.RCZ:     DW      0                   ;record - counter
  B11E    0000           C      K2.BLK:     DW      0                   ;block  - counter
  B120    0000           C      K2.BLZ:     DW      0                   ;aktuelle Blocklaenge Text
  B122    0000           C      K2.RCZB:    DW      0                   ;bearbeitete Satzanzahl
  B124    0000           C      K2.TXOP:    DW      0                   ;aktuelle Adresse Textanfang
  B126    0000           C      K2.TXANF:   DW      0                   ;Adresse  Textanfang
  B128    0000           C      K2.TXEND:   DW      0                   ;Adresse  Textende
  B12A    0000           C      K2.GNW1:    DW      0                   ;Adresse  Geraetesatzzaehler
  B12C    0000           C      K2.PTADR:   DW      0                   ;Anzahl zu suchender BM
  B12E    0000           C      K2.ADREA:   DW      0                   ;Adresse  E/A-Tabelle
  B130    0000           C      K2.GADR:    DW      0                   ;Geraeteadresse
  B132    0000           C      K2.FKADR:   DW      0                   ;Fehlerausschriftadresse
  B134    0000           C      K2.SKADR:   DW      0                   ;Statusausschriftadresse
  B136    0000           C      K2.FRADR:   DW      0                   ;Rueckkehradresse bei Fehler
  B138    0000           C      K2.LRECL:   DW      0                   ;physische Satzlaenge
                         C      
  B13A                   C      K2.ADRK:    DS      40,0
  B162                   C      K2.RBER:    DS      40,0                ;Rettebereich Monitorsteuervekor
                         C      
                         C      ;           END
                         C      ;           PN      MS05
                         C                  TITLE   'Steuervektor Monitorroutine'
                         C                  PAGE
'Steuervektor Monitorroutine'	MACRO-80 3.44	09-Dec-81	PAGE	1-4


                         C      
                         C      ;****************************************************************
                         C      ;*               Steuervektor Monitorroutine                    *
                         C      ;****************************************************************
  B18A    00             C      MS.ZPOL:    DB      0                   ;Zeilennr.  Leseposition
  B18B    00             C      MS.SPOL:    DB      0                   ;Spaltennr. Leseposition
  B18C    00             C      MS.ZPOS:    DB      0                   ;Zeilennr.  Schreibposition
  B18D    00             C      MS.SPOS:    DB      0                   ;Spaltennr. Schreibposition
  B18E    00             C      MS.ZMIN:    DB      0                   ;Merker Anfangszeile
  B18F    00             C      MS.SMIN:    DB      0                   ;Merker Anfangsspalte
  B190    00             C      MS.ZMAX:    DB      0                   ;Merker Endzeile
  B191    00             C      MS.SMAX:    DB      0                   ;Merker Endspalte
  B192    00             C      MS.ZANZ:    DB      0                   ;Merker Zeilenanzahl  BWS
  B193    00             C      MS.SPANZ:   DB      0                   ;Merker Spaltenanzahl BWS
  B194    0000           C      MS.BWSA:    DW      0                   ;Anf.adr. Bildwiederholspeicher
  B196    00             C      MS.DIREL:   DB      0                   ;Kommando forts. Lesepos.
  B197    00             C      MS.DIRES:   DB      0                   ;Kommando forts. Schreibpos.
  B198    00             C      MS.CMD:     DB      0                   ;Routinenkommando
  B199    00             C      MS.TK:      DB      0                   ;zu schreibendes bzw. zu lesendes Zeichen
  B19A    0000           C      MS.RADR:    DW      0                   ;Benutzeradresse Rollfunktion
                         C      ;
  B19C    00             C      MS.MCZ:     DB      0                   ;Zeichenmerker Cursorposition
  B19D    00             C      MS.MCUR:    DB      0                   ;Merker zum Cursor
                         C                                              ;MCUR = 0   Cursor aus
                         C                                              ;MCUR = 1   Cursor ein und gesetzt
                         C                                              ;MCUR = 2   Cursor ein und Zeichen
  B19E    00             C      MS.CZEIT:   DB      0                   ;Zeitvariable Cursorblinken
                         C      
                         C      
                         C      ;           END
                         C      ;           PN      TS06
                         C                  TITLE   'Funktionsadresstabellen'
                         C                  PAGE
'Funktionsadresstabellen'	MACRO-80 3.44	09-Dec-81	PAGE	1-5


                         C      
                         C      ;****************************************************************
                         C      ;*               Tabellen der Funktionsadressen                 *
                         C      ;****************************************************************
  B19F    0000           C      TS.TAB1:    DW      0                   ;P1
  B1A1    0000           C                  DW      0                   ;P2
  B1A3    0000           C                  DW      0                   ;P3
  B1A5    0000           C                  DW      0                   ;P4
  B1A7    0000           C                  DW      0                   ;P5
  B1A9    0000           C                  DW      0                   ;P6
  B1AB    0000           C                  DW      0                   ;P7
  B1AD    0000           C                  DW      0                   ;P8
  B1AF    0000           C                  DW      0                   ;P9
  B1B1    0000           C                  DW      0                   ;P10
  B1B3    0000           C                  DW      0                   ;P11
  B1B5    0000           C                  DW      0                   ;P12
  B1B7    0000           C                  DW      0                   ;P13
  B1B9    0000           C                  DW      0                   ;P14
  B1BB    0000           C                  DW      0                   ;P15
  B1BD    0000           C                  DW      0                   ;P16
  B1BF    0000           C                  DW      0                   ;P17
  B1C1    0000           C                  DW      0                   ;P18
  B1C3    0000           C                  DW      0                   ;P19
  B1C5    0000           C                  DW      0                   ;P20
  B1C7    0000           C                  DW      0                   ;P21
  B1C9    0000           C                  DW      0                   ;P22
  B1CB    0000           C                  DW      0                   ;P23
  B1CD    0000           C                  DW      0                   ;P24
  B1CF    0000           C                  DW      0                   ;P25
  B1D1    0000           C                  DW      0                   ;P26
  B1D3    0000           C                  DW      0                   ;P27
  B1D5    0000           C                  DW      0                   ;P28
  B1D7    0000           C                  DW      0                   ;P29
  B1D9    0000           C                  DW      0                   ;P30
  B1DB    0000           C                  DW      0                   ;P31
  B1DD    0000           C                  DW      0                   ;P32
  B1DF    0000           C                  DW      0                   ;P33
  B1E1    0000           C                  DW      0                   ;P34
  B1E3    0000           C                  DW      0                   ;P35
  B1E5    0000           C                  DW      0                   ;P36
  B1E7    0000           C                  DW      0                   ;P37
  B1E9    0000           C                  DW      0                   ;P38
  B1EB    0000           C                  DW      0                   ;P39
  B1ED    0000           C                  DW      0                   ;P40
  B1EF    0000           C                  DW      0                   ;P41
  B1F1    0000           C                  DW      0                   ;P42
  B1F3    0000           C                  DW      0                   ;P43
  B1F5    0000           C                  DW      0                   ;P44
  B1F7    0000           C                  DW      0                   ;P45
  B1F9    0000           C                  DW      0                   ;P46
  B1FB    0000           C                  DW      0                   ;P47
  B1FD    0000           C                  DW      0                   ;P48
                         C                  PAGE
'Funktionsadresstabellen'	MACRO-80 3.44	09-Dec-81	PAGE	1-6


                         C      
  B1FF    0000           C      TS.TAB2:    DW      0                   ;INS MOD
  B201    0000           C                  DW      0                   ;DEL
  B203    0000           C                  DW      0                   ;INS LINE
  B205    0000           C                  DW      0                   ;DEL LINE
  B207    0000           C                  DW      0                   ;SCH LINKS
  B209    0000           C                  DW      0                   ;C HOCH
  B20B    0000           C                  DW      0                   ;SCH RECHTS
  B20D    0000           C                  DW      0                   ;C LINKS
  B20F    0000           C                  DW      0                   ;HOME Fkt.
  B211    0000           C                  DW      0                   ;C RECHTS
  B213    0000           C                  DW      0                   ;C naechste Zeile Anfang
  B215    0000           C                  DW      0                   ;C RUNTER
  B217    0000           C      TS.TAB3:    DW      0                   ;00
  B219    0000           C                  DW      0                   ;000
  B21B    0000           C                  DW      0                   ;NEG QUIT
  B21D    0000           C                  DW      0                   ;SYS
  B21F    0000           C                  DW      0                   ;END
  B221    0000           C                  DW      0                   ;ABS
  B223    0000           C      TS.TAB4:    DW      0                   ;POS QUIT
  B225    0000           C                  DW      0                   ;TABS
  B227    0000           C                  DW      0                   ;TABL
  B229    0000           C                  DW      0                   ;CI
  B22B    0000           C                  DW      0                   ;M
  B22D    0000           C      TS.EINA:    DW      0                   ;Auswerten Alphataste
  B22F    0000           C      TS.TABU:    DW      0                   ;Auswerten ET2 :=: Tabulator
  B231    0000           C      TS.NEWL:    DW      0                   ;Auswerten ET1 :=: new line
  B233    0000           C      TS.TAB5:    DW      0                   ;Ebene 0
  B235    0000           C                  DW      0                   ;Ebene 1
  B237    0000           C                  DW      0                   ;Ebene 2
  B239    0000           C                  DW      0                   ;Ebene 3
                         C      ;****************************************************************
                         C      ;*               Tastaturmerker                                 *
                         C      ;****************************************************************
  B23B    00             C      TS.PTAST:   DB      0                   ;I/O-Adresse der Tastatur
  B23C    00             C      TS.TK:      DB      0                   ;Speicher Tastencode
  B23D    00             C      TS.PTK:     DB      0                   ;Speicher P-Tastennummer
  B23E    00             C      TS.EMERK:   DB      0                   ;Funktionstasten-Ebenen-Merker
  B23F    00             C      TS.SPMER:   DB      0                   ;Tastaturgruppenmerker
  B240    00             C      TS.UMERK:   DB      0                   ;Merker  INS MOD ein/aus
  B241    00             C      TS.KGMER:   DB      0                   ;Merker  Programmier-/Schreibmasch.Tast.
  B242    00             C      TS.ZSMER:   DB      0                   ;Merker  Z-Schnellschreiben
  B243    00             C      TS.ZEIT1:   DB      0                   ;Zeitkonstante 1
  B244    00             C      TS.ZEIT2:   DB      0                   ;Zeitkonstante 2
  B245    00             C      TS.ZEI21:   DB      0                   ;Zwsp. ZEIT2-ZEIT1
  B246    00             C      TS.ZSTC:    DB      0                   ;Zaehler Z-Schnell 0,5 s
  B247    00             C      TS.MIO:     DB      0                   ;memory - I/O - Schalter
  B248    00             C      TS.MBF:     DB      0                   ;Merker Bedienfolge ein/aus
  B249    0000           C      TS.BFOL1:   DW      0                   ;Pointer Bedienfolgesp. bei Erzeugung
  B24B    0000           C      TS.BFOL2:   DW      0                   ;Pointer Bedienfolgesp. bei Abarbeitung
  B24D    0000           C      TS.STACK:   DW      0                   ;Zeiger zum aktuellen Keller
                         C      ;
                         C      ;           END
                         C      ;           PN      S213
                         C                  TITLE   'Variablen'
                         C                  PAGE
'Variablen'	MACRO-80 3.44	09-Dec-81	PAGE	1-7


                         C      
                         C      ;****************************************************************
                         C      ;*               Systemvariable                                 *
                         C      ;****************************************************************
  B24F    0000           C      S2.TPA:     DW      0                   ;Textpufferanfang
  B251    0000           C      S2.TPE:     DW      0                   ;Textpufferende
  B253    0000           C      S2.WINA:    DW      0                   ;Windowanfang
  B255    0000           C      S2.WINE:    DW      0                   ;Windowende
  B257    0000           C      S2.END:     DW      0                   ;Ende des belegten Textpuffers
  B259    0000           C      S2.POIE:    DW      0                   ;Pointer Eingabepuffer
  B25B    0000           C      S2.POIA:    DW      0                   ;Pointer Ausgabepuffer
  B25D    0000           C      S2.RADR:    DW      0                   ;Rueckkehradresse bei UP - Routinen
                         C      ;****************************************************************
                         C      ;*             Variablen fuer S9                                *
                         C      ;****************************************************************
  B25F    00             C      S2.IM:      DB      0                   ;Merker fuer Input -Eroeffnung
  B260    00             C      S2.OM:      DB      0                   ;Merker fuer Output-Eroeffnung
  B261    00             C      S2.VZM:     DB      0                   ;Merker Anzahl Verzeichniseintr.
  B262    00             C      S2.ZZ:      DB      0                   ;Zeilenzaehler SL 6001
  B263    00             C      S2.CST:     DB      0                   ;Merker , ob eine Taste gedrueckt wurde
  B264    00             C      S2.IOC:     DB      0                   ;Erweiterung fuer SWITCH
                         C      ;****************************************************************
                         C      ;*             Variablen fuer LO                                *
                         C      ;****************************************************************
  B265    20 20 20 20    C      S2.PRGN:    DB      '      '
  B269    20 20          C      
  B26B    00             C      S2.DNR:     DB      0                   ;Dateinummer
  B26C    0000           C      S2.RBBR:    DW      0
                         C      ;****************************************************************
                         C      ;*             Variablen fuer   D E B U G                       *
                         C      ;****************************************************************
  B26E    0000           C      S2.AADR:    DW      0                   ;Anzeigeadresse     D2 (REAS)
  B270    0000           C      S2.KADR:    DW      0                   ;Korrekturadresse   D2 (REAS)
  B272    00             C      S2.ZP:      DB      0                   ;Zeilenposition     D2 (REAS)
  B273    00             C      S2.SP1:     DB      0                   ;Spaltenposition 1  D2 (REAS)
  B274    00             C      S2.SP2:     DB      0                   ;Spaltenposition 2  D2 (REAS)
  B275    00             C      S2.SP3:     DB      0                   ;Spaltenposition 3  D2 (REAS)
  B276                   C      S2.TRB:     DS      20,0                ;Merker fuer die letzten 20 Befehle
  B28A    00             C      S2.AFOR:    DB      0                   ;Anzeigeformat im Eingabebereich
  B28B    00             C      S2.BZ:      DB      0                   ;Bytezahl der Anzeige : 1 bzw. 2
  B28C    0000           C      S2.TE:      DW      0                   ;Hilfsvariable
  B28E    00             C      S2.DL:      DB      0
  B28F    00             C      S2.DH:      DB      0
  B290    0000           C      S2.PAR1:    DW      0                   ;Zwischenspeicher fuer 1.Parameter
  B292    0000           C      S2.DMANF:   DW      0                   ;erstes angezeigtes Byte bei MeDC
  B294    0000           C      S2.DMCUR:   DW      0                   ;Cursorposition              MeDC
  B296    0000           C      S2.DMBA:    DW      0                   ;Bereichdefinition Anfang    MeDC
  B298    0000           C      S2.DMBE:    DW      0                   ;Bereichdefinition Ende      MeDC
  B29A                   C      S2.DM1:     DS      16,0                ;Zwischenspeicher
  B2AA    00             C      S2.DM2:     DB      0
  B2AB    00             C      S2.DMH:     DB      0
  B2AC    00             C      S2.DML:     DB      0
  B2AD    0000           C      S2.SMHL:    DW      0
  B2AF    00             C      S2.S1:      DB      0                   ;Zusatzspeichermerker SYS0/bit 4
  B2B0                   C      S2.S2:      DS      8,0                 ;Zusatzspeichermerker SYS2
                         C      
                         C                  TITLE   'Variablen fuer die  USER - CPU '
                         C                  PAGE
'Variablen fuer die  USER - CPU '	MACRO-80 3.44	09-Dec-81	PAGE	1-8


                         C      
                         C      ;****************************************************************
                         C      ;*             Interruptmerker                       USER - CPU *
                         C      ;****************************************************************
  B2B8    00             C      S2.DDEI:    DB      0                   ;Merker  = 0 DI  /  = FFH EI
  B2B9    00             C      S2.DDIM:    DB      0                   ;Merker  IM0 , IM1 , IM2
  B2BA    00             C      S2.DDI:     DB      0                   ;I-Register
  B2BB    00             C      S2.DDR:     DB      0                   ;R-Register
                         C      ;****************************************************************
                         C      ;*             Befehlszaehler                        USER - CPU *
                         C      ;****************************************************************
  B2BC    0000           C      S2.DDPC:    DW      0
                         C      ;****************************************************************
                         C      ;*             Stackpointer                          USER - CPU *
                         C      ;****************************************************************
  B2BE    0000           C      S2.DDSP:    DW      0
                         C      ;****************************************************************
                         C      ;*             Indexregister                         USER - CPU *
                         C      ;****************************************************************
  B2C0    0000           C      S2.DDIX:    DW      0
  B2C2    0000           C      S2.DDIY:    DW      0
                         C      ;****************************************************************
                         C      ;*             Zweitregistersatz                     USER - CPU *
                         C      ;****************************************************************
  B2C4                   C      S2.DDBCS    EQU     $                   ;BC'
  B2C4    00             C      S2.DDCS:    DB      0
  B2C5    00             C      S2.DDBS:    DB      0
                         C      ;
  B2C6                   C      S2.DDDES    EQU     $                   ;DE'
  B2C6    00             C      S2.DDES:    DB      0
  B2C7    00             C      S2.DDDS:    DB      0
                         C      ;
  B2C8                   C      S2.DDHLS    EQU     $                   ;HL'
  B2C8    00             C      S2.DDLS:    DB      0
  B2C9    00             C      S2.DDHS:    DB      0
                         C      ;
  B2CA                   C      S2.DDAFS    EQU     $                   ;AF'
  B2CA    00             C      S2.DDFS:    DB      0
  B2CB    00             C      S2.DDAS:    DB      0
                         C      ;****************************************************************
                         C      ;*             Erstregistersatz                      USER - CPU *
                         C      ;****************************************************************
  B2CC                   C      S2.DDBC     EQU     $                   ;BC
  B2CC    00             C      S2.DDC:     DB      0
  B2CD    00             C      S2.DDB:     DB      0
                         C      ;
  B2CE                   C      S2.DDDE     EQU     $                   ;DE
  B2CE    00             C      S2.DDE:     DB      0
  B2CF    00             C      S2.DDD:     DB      0
                         C      ;
  B2D0                   C      S2.DDHL     EQU     $                   ;HL
  B2D0    00             C      S2.DDL:     DB      0
  B2D1    00             C      S2.DDH:     DB      0
                         C      ;
  B2D2                   C      S2.DDAF     EQU     $                   ;AF
  B2D2    00             C      S2.DDF:     DB      0
  B2D3    00             C      S2.DDA:     DB      0
                         C      
  B2D4                   C      S2.STACK    EQU     $
                         C      
  B2D4                   C                  DS      0C000H-S2.STACK,0
                         C      
                         C      ;           END
                                            .DEPHASE
                                
                                            .PHASE  0C000H
                                        ;     INCLUDE S165.MAC
                                        ;     INCLUDE S310.MAC
                                        ;     INCLUDE MO26.MAC
                                        ;     INCLUDE TA35.MAC   ;???   TA36
                                        ;     INCLUDE K158.MAC
                                        ;     INCLUDE LO28.MAC
                                        ;     INCLUDE S975.MAC   ;???   S967
                                        ;     INCLUDE S424.MAC   ;???   S425
                                        ;     INCLUDE SM01.MAC
                                        ;     INCLUDE S052.MAC   ;???   S053
                         C                  INCLUDE System.MAC
                         C      ;           PN      S165
                         C                  TITLE   '*** Betriebssystem  DEG2000 ***'
                         C                  PAGE
'*** Betriebssystem  DEG2000 ***'	MACRO-80 3.44	09-Dec-81	PAGE	1-9


                         C      
                         C      ;****************************************************************
                         C      ;*               S  Y  S  T  E  M   ----   D  E  G  2  0  0  0  *
                         C      ;*  Version      -----------------------------------------------*
                         C      ;*               Programmierer: M. Herbote --- K EAW  ZFT (WFT) *
                         C      ;*  V 2 . 1      -----------------------------------------------*
                         C      ;*               Stand        : 15.Maerz 1985                   *
                         C      ;****************************************************************
                         C      
  C000    F586           C      S0.ENTRY:   DW      S0.DEG2
  C002    56 32 2E 31    C                  DB      'V2.1/150385     '
  C006    2F 31 35 30    C      
  C00A    33 38 35 20    C      
  C00E    20 20 20 20    C      
                         C      
                         C      ;****************************************************************
                         C      ;*               System - Verstaendigungsbereich                *
                         C      ;****************************************************************
  C012                   C      S1.TA       EQU     $                   ;1. Tastaturroutine
  C012    C3 D13D        C                  JP      TA.TA1              ;   Einlesen U/INT
  C015    C3 D155        C                  JP      TA.TA2              ;   Einlesen Tastaturcode
  C018    C3 D408        C                  JP      TA.LOE              ;   loeschen aller Tast.rout.adr.
  C01B    C3 D420        C                  JP      TA.LOES             ;   wie TA.LOE und Standardbel.
  C01E    C3 D237        C                  JP      TA.ABFR             ;   Bereitstellen Tastaturcode
                         C                                              ;   und Abarbeitung Tastaturroutine
  C021    C3 D321        C                  JP      TA.TFE              ;   Warteschleife bis Tastenende
                         C      
  C024                   C      S1.MO       EQU     $                   ;2. Monitorroutine
  C024    C3 CB10        C                  JP      MO.MONI             ;   Eintrittspunkt Monitorroutine
  C027    C3 F5B1        C                  JP      S0.BWSUZ            ;   einzelnes Zeichen auf BWS
  C02A    C3 F5CF        C                  JP      S0.BWSUS            ;   gesamten  BWSA    auf BWS
                         C      
  C02D                   C      S1.SM       EQU     $                   ;3. Druckerroutine
  C02D    C3 F54B        C                  JP      SM.MRES             ;   Initialisierung Drucker
  C030    C3 F55F        C                  JP      SM.PRIO             ;   Zeichenausgabe  Drucker
                         C      
  C033                   C      S1.LA       EQU     $                   ;4. allgemeine Adressen
  C033    C3 CA65        C                  JP      S1.OPEN
  C036    C3 CA65        C                  JP      S1.CLOS
  C039    C3 CA65        C                  JP      S1.LESV
  C03C    C3 CA65        C                  JP      S1.LESR
  C03F    C3 CA65        C                  JP      S1.SCHR
                         C      
                         C                  PAGE
'*** Betriebssystem  DEG2000 ***'	MACRO-80 3.44	09-Dec-81	PAGE	1-10


                         C      
                         C      ;****************************************************************
                         C      ;*               R S T 3 8 -  /  N M I -  Eintrittsadresse      *
                         C      ;****************************************************************
  C042                   C      S1.RST38    EQU     $
  C042    ED 73 B2BE     C      S1.NMI:     LD      (S2.DDSP),SP        ;CPU - Zustand retten
  C046    ED 73 B24D     C                  LD      (TS.STACK),SP
  C04A    31 B2D4        C                  LD      SP,S2.STACK
  C04D    F5             C                  PUSH    AF
  C04E    E5             C                  PUSH    HL
  C04F    D5             C                  PUSH    DE
  C050    C5             C                  PUSH    BC
  C051    08             C                  EX      AF,AF'              ;'
  C052    D9             C                  EXX
  C053    F5             C                  PUSH    AF
  C054    E5             C                  PUSH    HL
  C055    D5             C                  PUSH    DE
  C056    C5             C                  PUSH    BC
  C057    FD E5          C                  PUSH    IY
  C059    DD E5          C                  PUSH    IX
  C05B    ED 57          C                  LD      A,I
  C05D    32 B2BA        C                  LD      (S2.DDI),A
  C060    ED 7B B2BE     C                  LD      SP,(S2.DDSP)
  C064    E1             C                  POP     HL
  C065    E5             C                  PUSH    HL
  C066    22 B2BC        C                  LD      (S2.DDPC),HL
  C069    3E A0          C                  LD      A,S0.PTAST          ;Tastaturinitialisierung
  C06B    32 B23B        C                  LD      (TS.PTAST),A
  C06E    CD D19D        C                  CALL    TA.PIOPR
  C071    CD D20F        C                  CALL    TA.E0IN
  C074    21 B2B8        C                  LD      HL,S2.DDEI
  C077    22 B292        C                  LD      (S2.DMANF),HL
  C07A    21 C2A0        C      S1.RST:     LD      HL,S1.INIT6
  C07D    E5             C                  PUSH    HL
  C07E    21 C7FE        C                  LD      HL,S1.DB0
  C081    E5             C                  PUSH    HL
  C082    ED 45          C                  RETN
                         C      ;****************************************************************
                         C      ;*               Eintrittsadresse   D E G 2                     *
                         C      ;****************************************************************
  C084    3E C3          C      S1.RES1:    LD      A,0C3H
  C086    32 0000        C                  LD      (00000H),A
  C089    32 0038        C                  LD      (00038H),A
  C08C    32 0066        C                  LD      (00066H),A
  C08F    21 C0B0        C                  LD      HL,S1.RES
  C092    22 0001        C                  LD      (00001H),HL
  C095    21 C042        C                  LD      HL,S1.RST38
  C098    22 0039        C                  LD      (00039H),HL
  C09B    21 C042        C                  LD      HL,S1.NMI
  C09E    22 0067        C                  LD      (00067H),HL
  C0A1    AF             C                  XOR     A
  C0A2    32 A800        C                  LD      (S0.DEAT),A
                         C      
  C0A5    21 F5F9        C                  LD      HL,S0.BWSB
  C0A8    11 B2D4        C                  LD      DE,S2.STACK
  C0AB    01 000A        C                  LD      BC,S0.BASCL-S0.BWSB
  C0AE    ED B0          C                  LDIR
                         C      
                         C                  PAGE
'*** Betriebssystem  DEG2000 ***'	MACRO-80 3.44	09-Dec-81	PAGE	1-11


                         C      
                         C      ;****************************************************************
                         C      ;*              R E S E T -  Eintrittsadresse                   *
                         C      ;****************************************************************
  C0B0    F3             C      S1.RES:     DI
  C0B1    ED 5E          C                  IM      2
                         C      ;****************************************************************
                         C      ;*                Anfangswertzuweisung von System - Variablen   *
                         C      ;****************************************************************
  C0B3    31 B000        C                  LD      SP,S0.STACK+2
  C0B6    21 C114        C                  LD      HL,S1.SYSTB
  C0B9    E5             C                  PUSH    HL
  C0BA    ED 73 B24D     C                  LD      (TS.STACK),SP
  C0BE    21 A000        C                  LD      HL,S0.BWSA
  C0C1    22 B194        C                  LD      (MS.BWSA),HL
  C0C4    21 0100        C                  LD      HL,S0.TPA
  C0C7    22 B24F        C                  LD      (S2.TPA),HL
  C0CA    21 80FF        C                  LD      HL,S0.TPE
  C0CD    22 B251        C                  LD      (S2.TPE),HL
  C0D0    AF             C                  XOR     A
  C0D1    32 B264        C                  LD      (S2.IOC),A
  C0D4    3D             C                  DEC     A
  C0D5    32 B197        C                  LD      (MS.DIRES),A
                         C      ;****************************************************************
                         C      ;*            Initialisierung der PIO-s auf der AKB             *
                         C      ;*            und Initialisierung der Tastatur                  *
                         C      ;****************************************************************
  C0D8    3E A0          C                  LD      A,S0.PTAST
  C0DA    32 B23B        C                  LD      (TS.PTAST),A
  C0DD    CD D19D        C                  CALL    TA.PIOPR
  C0E0    CD D20F        C                  CALL    TA.E0IN
                         C      
  C0E3    DD 21 0013     C                  LD      IX,S3.KS1-S3.SEAT   ;Initialisierung KMBG
  C0E7    11 A803        C                  LD      DE,S0.DEAT+3
  C0EA    DD 19          C                  ADD     IX,DE
  C0EC    DD 36 02 30    C                  LD      (IX+2),S0.AKB
  C0F0    CD F61C        C                  CALL    S0.KRZU
                         C      ;            CALL    0    ;???        KR.INIT
  C0F3    CD F5FF        C                  CALL    S0.BWSAB
  C0F6    21 BBF0        C                  LD      HL,S0.PFFA
  C0F9    E5             C                  PUSH    HL
  C0FA    D1             C                  POP     DE
  C0FB    CD DB48        C                  CALL    K1.FU
                         C      ;****************************************************************
                         C      ;*              Bild loeschen                                   *
                         C      ;****************************************************************
  C0FE    AF             C                  XOR     A                   ;ZANZ=  , SPANZ=   laut Modul S0.
  C0FF    32 B198        C                  LD      (MS.CMD),A
  C102    CD CB10        C                  CALL    MO.MONI
  C105    21 B198        C                  LD      HL,MS.CMD           ;ZMIN=SMIN=1 , ZMAX=ZANZ , SMAX=SPANZ
  C108    34             C                  INC     (HL)
  C109    CD CB10        C                  CALL    MO.MONI
  C10C    3E 04          C                  LD      A,4                 ;gesamtes Bild loeschen
  C10E    32 B198        C                  LD      (MS.CMD),A
  C111    CD CB10        C                  CALL    MO.MONI
                         C      
                         C                  PAGE
'*** Betriebssystem  DEG2000 ***'	MACRO-80 3.44	09-Dec-81	PAGE	1-12


                         C      
                         C      ;****************************************************************
                         C      ;*               Aufbau des Systemgrundbildes                   *
                         C      ;****************************************************************
  C114    3E F5          C      S1.SYSTB:   LD      A,HIGH(S0.IV)
  C116    ED 47          C                  LD      I,A
  C118    31 AFFE        C                  LD      SP,S0.STACK
  C11B    ED 73 B24D     C                  LD      (TS.STACK),SP
  C11F    21 A000        C                  LD      HL,S0.BWSA
  C122    22 B194        C                  LD      (MS.BWSA),HL
  C125    3E C0          C                  LD      A,11000000B
  C127    32 B196        C                  LD      (MS.DIREL),A
  C12A    32 B197        C                  LD      (MS.DIRES),A
  C12D    21 F5F9        C                  LD      HL,S0.BWSB
  C130    11 B2D4        C                  LD      DE,S2.STACK
  C133    01 000A        C                  LD      BC,S0.BASCL-S0.BWSB
  C136    ED B0          C                  LDIR
                         C      
  C138    AF             C                  XOR     A                   ;ZANZ,SPANZ belegen
  C139    32 B198        C                  LD      (MS.CMD),A
  C13C    CD CB10        C                  CALL    MO.MONI
                         C      
  C13F    3E 02          C                  LD      A,2                 ;ZMIN=SMIN=1 , ZMAX=ZANZ , SMAX=SPANZ
  C141    32 B198        C                  LD      (MS.CMD),A
  C144    CD CB10        C                  CALL    MO.MONI
                         C      
  C147    3E 05          C                  LD      A,5                 ;Bildfenster loeschen
  C149    32 B198        C                  LD      (MS.CMD),A
  C14C    CD CB10        C                  CALL    MO.MONI
                         C      
  C14F    CD C3BF        C                  CALL    S1.ANZEI            ;Anzeige: DEG 2000
  C152    0F00           C                  DW      00F00H              ;ZPOS=0  , SPOS=15
  C154    08             C                  DB      8                   ;Textlaenge
  C155    44 45 47 20    C                  DB      'DEG 2000'
  C159    32 30 30 30    C      
  C15D    00             C                  DB      0
                         C      
  C15E    CD C3BF        C                  CALL    S1.ANZEI            ;Anzeige: Betriebssystem
  C161    1F00           C                  DW      01F00H              ;ZPOS=0  , SPOS=31
  C163    0E             C                  DB      14                  ;Textlaenge
  C164    42 65 74 72    C                  DB      'Betriebssystem'
  C168    69 65 62 73    C      
  C16C    73 79 73 74    C      
  C170    65 6D          C      
  C172    00             C                  DB      0
                         C      
  C173    CD C3BF        C                  CALL    S1.ANZEI            ;Anzeige: Version i.ii/i
  C176    0F01           C                  DW      00F01H              ;ZPOS=1  , SPOS=15
  C178    0E             C                  DB      14
  C179    56 65 72 73    C                  DB      'Version '
  C17D    69 6F 6E 20    C      
  C181    32             C                  DB      S0.V1
  C182    2E             C                  DB      '.'
  C183    31             C                  DB      S0.V2
  C184    33             C                  DB      S0.V3
  C185    2F             C                  DB      '/'
  C186    45             C                  DB      S0.V7
  C187    00             C                  DB      0
                         C      
  C188    CD C67C        C                  CALL    S1.STAT
  C18B    CD C191        C                  CALL    S1.DAT              ;Datum anzeigen
                         C      
  C18E    C3 C20A        C                  JP      S1.SYSTC            ;ueberspringen des UPs  DAT
                         C      
                         C                  PAGE
'*** Betriebssystem  DEG2000 ***'	MACRO-80 3.44	09-Dec-81	PAGE	1-13


                         C      
                         C      ;****************************************************************
                         C      ;*                              Anzeige: Datum:                 *
                         C      ;****************************************************************
  C191    CD C3BF        C      S1.DAT:     CALL    S1.ANZEI            ;Anzeige: Datum:
  C194    0F02           C                  DW      00F02H              ;ZPOS=2  , SPOS=15
  C196    08             C                  DB      8
  C197    44 61 74 75    C                  DB      'Datum:  '
  C19B    6D 3A 20 20    C      
  C19F    00             C                  DB      0
                         C      
  C1A0    3E 18          C                  LD      A,24                ;Anzeige des Datums
  C1A2    32 B198        C                  LD      (MS.CMD),A
  C1A5    06 02          C                  LD      B,2
  C1A7    21 0004        C                  LD      HL,S3.DATUM-S3.SEAT
  C1AA    11 A800        C                  LD      DE,S0.DEAT
  C1AD    19             C                  ADD     HL,DE
  C1AE    CD CB10        C                  CALL    MO.MONI
  C1B1    3E 14          C                  LD      A,20
  C1B3    32 B198        C                  LD      (MS.CMD),A
  C1B6    3E 2E          C                  LD      A,'.'
  C1B8    32 B199        C                  LD      (MS.TK),A
  C1BB    CD CB10        C                  CALL    MO.MONI
  C1BE    3E 18          C                  LD      A,24
  C1C0    32 B198        C                  LD      (MS.CMD),A
  C1C3    06 02          C                  LD      B,2
  C1C5    21 0004        C                  LD      HL,S3.DATUM-S3.SEAT
  C1C8    11 A802        C                  LD      DE,S0.DEAT+2
  C1CB    19             C                  ADD     HL,DE
  C1CC    CD CB10        C                  CALL    MO.MONI
  C1CF    3E 14          C                  LD      A,20
  C1D1    32 B198        C                  LD      (MS.CMD),A
  C1D4    3E 2E          C                  LD      A,'.'
  C1D6    32 B199        C                  LD      (MS.TK),A
  C1D9    CD CB10        C                  CALL    MO.MONI
  C1DC    3E 18          C                  LD      A,24
  C1DE    32 B198        C                  LD      (MS.CMD),A
  C1E1    06 02          C                  LD      B,2
  C1E3    21 0004        C                  LD      HL,S3.DATUM-S3.SEAT
  C1E6    11 A804        C                  LD      DE,S0.DEAT+4
  C1E9    19             C                  ADD     HL,DE
  C1EA    CD CB10        C                  CALL    MO.MONI
                         C      
                         C      ;                               Anzeige: :
  C1ED    2E 0A          C                  LD      L,S0.SYSZ-1         ;ZPOS=SYSZ , SPOS=0
  C1EF    26 00          C                  LD      H,0
  C1F1    22 B18C        C                  LD      (MS.ZPOS),HL
  C1F4    3E 14          C                  LD      A,20
  C1F6    32 B198        C                  LD      (MS.CMD),A
  C1F9    3E 3A          C                  LD      A,':'
  C1FB    32 B199        C                  LD      (MS.TK),A
  C1FE    CD CB10        C                  CALL    MO.MONI
                         C      
  C201    3E 15          C                  LD      A,21                ;SPOS=SPOS+1
  C203    32 B198        C                  LD      (MS.CMD),A
  C206    CD CB10        C                  CALL    MO.MONI
  C209    C9             C                  RET
                         C      
                         C                  PAGE
'*** Betriebssystem  DEG2000 ***'	MACRO-80 3.44	09-Dec-81	PAGE	1-14


                         C      
                         C      ;****************************************************************
                         C      ;*                Anfangswertzuweisung von System - Variablen   *
                         C      ;****************************************************************
  C20A    21 2918        C      S1.SYSTC:   LD      HL,S0.SKADR
  C20D    22 B134        C                  LD      (K2.SKADR),HL
                         C      
  C210    21 2917        C                  LD      HL,S0.FKADR
  C213    22 B132        C                  LD      (K2.FKADR),HL
                         C      
  C216    21 C114        C                  LD      HL,S1.SYSTB
  C219    22 B136        C                  LD      (K2.FRADR),HL
                         C      
  C21C    21 0100        C                  LD      HL,S0.LRECL         ;physische Blocklaenge Kassette
  C21F    22 B138        C                  LD      (K2.LRECL),HL
                         C      
  C222    3E 02          C                  LD      A,S0.ZEIT1
  C224    32 B243        C                  LD      (TS.ZEIT1),A
                         C      
  C227    3E 10          C                  LD      A,S0.ZEIT2
  C229    32 B244        C                  LD      (TS.ZEIT2),A
                         C      
                         C      ;****************************************************************
                         C      ;*               Tastaturaktivierung                            *
                         C      ;****************************************************************
  C22C    CD D420        C                  CALL    TA.LOES             ;loeschen aller Tast.r.adr.
                         C      
  C22F    21 0000        C                  LD      HL,0                ;D0.DD            ;Routine  Debug ;!!!
  C232    22 B201        C                  LD      (TS.TAB2+2),HL
  C235    21 F580        C                  LD      HL,S0.DEG1          ;Routine  ABS
  C238    22 B221        C                  LD      (TS.TAB3+10),HL
  C23B    21 C36F        C                  LD      HL,S1.START         ;Routine  POS_QUIT  und  ET1
  C23E    22 B223        C                  LD      (TS.TAB4),HL
  C241    22 B231        C                  LD      (TS.NEWL),HL
  C244    3E AE          C                  LD      A,10101110B         ;Sperrinitialisierung
  C246    32 B23F        C                  LD      (TS.SPMER),A
                         C      
                         C                  PAGE
'*** Betriebssystem  DEG2000 ***'	MACRO-80 3.44	09-Dec-81	PAGE	1-15


                         C      
                         C      ;****************************************************************
                         C      ;*               Abfrage nach Ausgangszustand des Geraetes      *
                         C      ;****************************************************************
  C249    DD 21 0000     C      S1.SYSTD:   LD      IX,S3.MASK1-S3.SEAT
  C24D    11 A800        C                  LD      DE,S0.DEAT
  C250    DD 19          C                  ADD     IX,DE
  C252    DD 7E 00       C                  LD      A,(IX+0)
  C255    EE AA          C                  XOR     0AAH                ;M1='10101010' ?
  C257    20 17          C                  JR      NZ,S1.INITE
  C259    DD 7E 01       C                  LD      A,(IX+1)
  C25C    EE 55          C                  XOR     055H                ;M2='01010101' ?
  C25E    20 10          C                  JR      NZ,S1.INITE
  C260    DD 7E 02       C                  LD      A,(IX+2)
  C263    EE FF          C                  XOR     0FFH                ;M3='11111111' ?
  C265    20 09          C                  JR      NZ,S1.INITE
  C267    DD 7E 03       C                  LD      A,(IX+3)
  C26A    EE 00          C                  XOR     000H                ;M4='00000000' ?
  C26C    20 02          C                  JR      NZ,S1.INITE
  C26E    18 28          C                  JR      S1.INIT5
                         C      ;****************************************************************
                         C      ;*               Ausgangszustand des Geraetes                   *
                         C      ;****************************************************************
  C270    21 CA66        C      S1.INITE:   LD      HL,S3.SEAT          ;EA dyn := EA eprom
  C273    11 A800        C                  LD      DE,S0.DEAT
  C276    01 0400        C                  LD      BC,1024
  C279    ED B0          C                  LDIR
  C27B    CD C191        C                  CALL    S1.DAT
                         C      
  C27E    CD C3BF        C                  CALL    S1.ANZEI            ;Aufforderung zur Datumseingabe
  C281    0A             C                  DB      S0.SYSZ-1           ;ZPOS=SYSZ
  C282    02             C                  DB      2                   ;SPOS=3
  C283    05             C                  DB      5
  C284    44 41 54 45    C                  DB      'DATE '
  C288    20             C      
  C289    00             C                  DB      0                   ;Eingabelaenge
                         C      
  C28A    2E 0B          C                  LD      L,S0.SYSZ           ;ZMIN=SYSZ , SMIN=8
  C28C    26 08          C                  LD      H,8
  C28E    22 B18E        C                  LD      (MS.ZMIN),HL
  C291    26 0D          C                  LD      H,13                ;ZMAX=SYSZ , SMAX=13
  C293    22 B190        C                  LD      (MS.ZMAX),HL
  C296    18 08          C                  JR      S1.INIT6
                         C      ;****************************************************************
                         C      ;*               Cursor setzen und Eintritt in die              *
                         C      ;*               Tastatur - Abfrageschleife                     *
                         C      ;****************************************************************
  C298    3E 03          C      S1.INIT5:   LD      A,3                 ;ZMIN=ZMAX=SYSZ , SMIN=3 , SMAX=16
  C29A    32 B198        C                  LD      (MS.CMD),A
  C29D    CD CB10        C                  CALL    MO.MONI
  C2A0    3E 06          C      S1.INIT6:   LD      A,6                 ;Cursor setzen
  C2A2    32 B198        C                  LD      (MS.CMD),A
  C2A5    CD CB10        C                  CALL    MO.MONI
                         C      ;****************************************************************
                         C      ;*            Tastaturabfrageschleife                           *
                         C      ;****************************************************************
  C2A8    CD D321        C      S1.TFE:     CALL    TA.TFE              ;Warten auf Tastenende
  C2AB    ED 7B B24D     C      S1.ABFR:    LD      SP,(TS.STACK)       ;Kellerzeiger zuruecksetzen
  C2AF    CD D237        C                  CALL    TA.ABFR             ;Tastaturabfrage
  C2B2    18 F7          C                  JR      S1.ABFR
                         C      
                         C                  TITLE   'Tastenroutinen'
                         C                  PAGE
'Tastenroutinen'	MACRO-80 3.44	09-Dec-81	PAGE	1-16


                         C      
                         C      ;****************************************************************
                         C      ;*               Tastenroutine -   ==>                          *
                         C      ;****************************************************************
  C2B4    3A B197        C      S1.CNRS:    LD      A,(MS.DIRES)
  C2B7    F5             C                  PUSH    AF
  C2B8    CB 87          C                  RES     0,A
  C2BA    CB 8F          C                  RES     1,A
  C2BC    CB 97          C                  RES     2,A
  C2BE    32 B197        C      S1.CURS1:   LD      (MS.DIRES),A
  C2C1    3E 15          C                  LD      A,21
  C2C3    32 B198        C                  LD      (MS.CMD),A
  C2C6    CD CB10        C                  CALL    MO.MONI
  C2C9    F1             C                  POP     AF
  C2CA    32 B197        C                  LD      (MS.DIRES),A
  C2CD    3E 01          C                  LD      A,1
  C2CF    32 B242        C                  LD      (TS.ZSMER),A
  C2D2    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*               Tastenroutine -  <==                           *
                         C      ;****************************************************************
  C2D3    3A B197        C      S1.CNLS:    LD      A,(MS.DIRES)
  C2D6    F5             C                  PUSH    AF
  C2D7    CB 87          C                  RES     0,A
  C2D9    CB 8F          C                  RES     1,A
  C2DB    CB D7          C                  SET     2,A
  C2DD    18 DF          C                  JR      S1.CURS1
                         C      ;****************************************************************
                         C      ;*               Tastenroutine -  runter                        *
                         C      ;****************************************************************
  C2DF    3A B197        C      S1.CNUS:    LD      A,(MS.DIRES)
  C2E2    F5             C                  PUSH    AF
  C2E3    CB 87          C                  RES     0,A
  C2E5    CB CF          C                  SET     1,A
  C2E7    CB D7          C                  SET     2,A
  C2E9    18 D3          C                  JR      S1.CURS1
                         C      ;****************************************************************
                         C      ;*               Tastenroutine -  hoch                          *
                         C      ;****************************************************************
  C2EB    3A B197        C      S1.CNOS:    LD      A,(MS.DIRES)
  C2EE    F5             C                  PUSH    AF
  C2EF    CB 87          C                  RES     0,A
  C2F1    CB CF          C                  SET     1,A
  C2F3    CB 97          C                  RES     2,A
  C2F5    18 C7          C                  JR      S1.CURS1
                         C      ;****************************************************************
                         C      ;*               Tastenroutine -  HOME-Funktion                 *
                         C      ;****************************************************************
  C2F7    3E 16          C      S1.HOME:    LD      A,22
  C2F9    32 B198        C      S1.CURS2:   LD      (MS.CMD),A
  C2FC    CD CB10        C                  CALL    MO.MONI
  C2FF    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*               Tastenroutine -  naechste Zeile Anfang         *
                         C      ;****************************************************************
  C300    3E 17          C      S1.CNZA:    LD      A,23
  C302    18 F5          C                  JR      S1.CURS2
                         C      
                         C                  PAGE
'Tastenroutinen'	MACRO-80 3.44	09-Dec-81	PAGE	1-17


                         C      
                         C      ;****************************************************************
                         C      ;*               Tastenroutine - DEL LINE                       *
                         C      ;****************************************************************
  C304    3E 0D          C      S1.DELZL:   LD      A,13
  C306    32 B198        C                  LD      (MS.CMD),A
  C309    CD CB10        C                  CALL    MO.MONI
  C30C    3E 0A          C                  LD      A,10
  C30E    32 B198        C                  LD      (MS.CMD),A
  C311    CD CB10        C                  CALL    MO.MONI
  C314    CD C4D7        C                  CALL    S1.SZAHL
  C317    47             C      S1.DEL2:    LD      B,A
  C318    3E 20          C                  LD      A,' '
  C31A    32 B199        C                  LD      (MS.TK),A
  C31D    3E 14          C                  LD      A,20
  C31F    32 B198        C                  LD      (MS.CMD),A
  C322    CD CB10        C      S1.DEL1:    CALL    MO.MONI
  C325    10 FB          C                  DJNZ    S1.DEL1
  C327    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*               Tastenroutine - Alphazeichen                   *
                         C      ;****************************************************************
  C328    32 B199        C      S1.AEIN:    LD      (MS.TK),A
  C32B    3E 14          C                  LD      A,20
  C32D    32 B198        C                  LD      (MS.CMD),A
  C330    CD CB10        C                  CALL    MO.MONI
  C333    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*               Tastenroutine - Taste 00  ,  Taste 000         *
                         C      ;****************************************************************
  C334    3E 30          C      S1.NN:      LD      A,'0'
  C336    32 B199        C                  LD      (MS.TK),A
  C339    3E 14          C                  LD      A,20
  C33B    32 B198        C                  LD      (MS.CMD),A
  C33E    CD CB10        C      S1.NN1:     CALL    MO.MONI
  C341    CD CB10        C                  CALL    MO.MONI
  C344    C9             C                  RET
                         C      
  C345    3E 30          C      S1.NNN:     LD      A,'0'
  C347    32 B199        C                  LD      (MS.TK),A
  C34A    3E 14          C                  LD      A,20
  C34C    32 B198        C                  LD      (MS.CMD),A
  C34F    CD CB10        C                  CALL    MO.MONI
  C352    18 EA          C                  JR      S1.NN1
                         C      ;****************************************************************
                         C      ;*               Tastenroutine - Hart COPY                      *
                         C      ;****************************************************************
  C354    06 16          C      S1.HCOPY:   LD      B,S0.ZANZ-2         ;ZANZ-2  auszugebende Zeilen
  C356    2A B194        C                  LD      HL,(MS.BWSA)
  C359    C5             C      S1.HC1:     PUSH    BC                  ;Zyklus ueber ZANZ-2  Zeilen
  C35A    3A B193        C                  LD      A,(MS.SPANZ)        ;Spaltenanzahl laden
  C35D    47             C                  LD      B,A
  C35E    7E             C      S1.HC2:     LD      A,(HL)              ;Zyklus ueber eine Zeile
  C35F    4F             C                  LD      C,A                 ;auszugebendes Zeichen laden
  C360    23             C                  INC     HL
  C361    CD F55F        C                  CALL    SM.PRIO             ;ein Zeichen ausgeben
  C364    10 F8          C                  DJNZ    S1.HC2              ;naechstes Zeichen
  C366    0E 1E          C                  LD      C,1EH               ;Zeilenende ausgeben
  C368    CD F55F        C                  CALL    SM.PRIO
  C36B    C1             C                  POP     BC
  C36C    10 EB          C                  DJNZ    S1.HC1              ;naechste  Zeile
  C36E    C9             C                  RET
                         C      
                         C                  PAGE
'Tastenroutinen'	MACRO-80 3.44	09-Dec-81	PAGE	1-18


                         C      
                         C      ;****************************************************************
                         C      ;*               Tastenroutine - Starttaste (POS QUIT)          *
                         C      ;****************************************************************
  C36F    3E 0C          C      S1.START:   LD      A,12                ;HL:=SZA
  C371    32 B198        C                  LD      (MS.CMD),A
  C374    CD CB10        C                  CALL    MO.MONI
  C377    3E 1E          C                  LD      A,30                ;ZPOL,SPOL:=HL
  C379    32 B198        C                  LD      (MS.CMD),A
  C37C    CD CB10        C                  CALL    MO.MONI
  C37F    3E 28          C                  LD      A,40                ;Zeichen vom BWS lesen
  C381    32 B198        C                  LD      (MS.CMD),A
  C384    CD CB10        C                  CALL    MO.MONI
  C387    3A B199        C                  LD      A,(MS.TK)
  C38A    FE 3A          C                  CP      ':'
  C38C    C0             C                  RET     NZ
  C38D    CD C4C1        C                  CALL    S1.SZEI
  C390    C8             C                  RET     Z
  C391    2B             C                  DEC     HL
  C392    EB             C                  EX      DE,HL
  C393    21 0000        C      S1.SUCHE:   LD      HL,0
  C396    E5             C                  PUSH    HL
  C397    E5             C                  PUSH    HL
  C398    C1             C      S1.SUCH2:   POP     BC
  C399    E1             C                  POP     HL
  C39A    D5             C                  PUSH    DE
  C39B    7D             C      S1.SUCH1:   LD      A,L
  C39C    5C             C                  LD      E,H
  C39D    ED A1          C                  CPI
  C39F    E2 C114        C                  JP      PO,S1.SYSTB
  C3A2    20 F7          C                  JR      NZ,S1.SUCH1
  C3A4    7B             C                  LD      A,E
  C3A5    BE             C                  CP      (HL)
  C3A6    20 F3          C                  JR      NZ,S1.SUCH1
  C3A8    D1             C                  POP     DE
  C3A9    E5             C                  PUSH    HL
  C3AA    C5             C                  PUSH    BC
  C3AB    06 04          C                  LD      B,4                 ;Programmanfang suchen
  C3AD    23             C                  INC     HL
  C3AE    CD C4B6        C                  CALL    S1.VERGL
  C3B1    20 E5          C                  JR      NZ,S1.SUCH2
  C3B3    C1             C                  POP     BC
  C3B4    D1             C                  POP     DE
  C3B5    3E 02          C                  LD      A,2                 ;ZMIN=SMIN=1 , ZMAX=ZANZ-2 , SMAX=SPANZ
  C3B7    32 B198        C                  LD      (MS.CMD),A
  C3BA    CD CB10        C                  CALL    MO.MONI
  C3BD    FB             C                  EI
  C3BE    E9             C                  JP      (HL)
                         C      
                         C                  TITLE   'Unterprogramme'
                         C                  PAGE
'Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-19


                         C      
                         C      ;****************************************************************
                         C      ;*               Unterprogramm zur Bedienerkommunikation        *
                         C      ;*               -----------------------------------------------*
                         C      ;*  CALL ANZEI   Aufruf des Unterprogrammes                     *
                         C      ;*  DB   zpos    zpos    ...   Zeilenpos. -1 fuer Kommunikation *
                         C      ;*  DB   spos    spos    ...   Spaltenpos.-1 fuer Kommunikation *
                         C      ;*  DB   alae    alae    ...   Laenge des Anzeigetextes         *
                         C      ;*                             bit 7=0   es folgt atext         *
                         C      ;*                                 7=1   es folgt adr(atext)    *
                         C      ;*                             bit 6=0   bit 5...0 Textlaenge   *
                         C      ;*                                 alae=0 keine Textanzeige, es *
                         C      ;*                                 entfaellt der Parameter atext*
                         C      ;*                                 6=1   Text mit Endekenng. -1 *
                         C      ;*                                                              *
                         C      ;*  DB   atext   atext   ...   Anzeigetext  bzw.                *
                         C      ;*  DA   adr(atext)      ...   Adresse des Anzeigetextes        *
                         C      ;*                                                              *
                         C      ;*  DB   elae    elae    ...   Eingabebereichslaenge            *
                         C      ;*                             bei elae=0 keine Eingabe,        *
                         C      ;*                             es entfallen die nachf. Param.   *
                         C      ;*  DB   spmer   spmer   ...   Wert fuer  TS.SPMER              *
                         C      ;*  DA   nquit   nquit   ...   Routinenadr. fuer  NEG QUIT      *
                         C      ;*  DA   pquit   pquit   ...   Routinenadr. fuer  POS QUIT      *
                         C      ;*  DA   aein    aein    ...   Routinenadr. fuer  Alphnum-Tasten*
                         C      ;*               -----------------------------------------------*
                         C      ;*               wenn elae=0 , dann Programmfortsetzung beim    *
                         C      ;*                             naechsten Befehl nach  elae      *
                         C      ;*               wenn elae>0 , dann Programmfortsetzung bei der *
                         C      ;*                             Tastaturabfrageschleife          *
                         C      ;*               -----------------------------------------------*
                         C      ;*               in  HL  wird die Adresse des Eingabebereiches  *
                         C      ;*               und in  BC  die Bereichslaenge uebergeben      *
                         C      ;****************************************************************
  C3BF    FD E3          C      S1.ANZEI:   EX      (SP),IY             ;IY ==> Keller , Paradr ==> IY
  C3C1    DD E5          C                  PUSH    IX                  ;Register retten
  C3C3    F5             C                  PUSH    AF
  C3C4    D5             C                  PUSH    DE
  C3C5    3E 01          C                  LD      A,1                 ;def. gesamtes Bild als Fenster
  C3C7    32 B198        C                  LD      (MS.CMD),A
  C3CA    CD CB10        C                  CALL    MO.MONI
  C3CD    FD 23          C                  INC     IY                  ;IY auf  atext  positionieren
  C3CF    FD 23          C                  INC     IY
  C3D1    FD 23          C                  INC     IY
  C3D3    FD E5          C                  PUSH    IY
  C3D5    FD 6E FD       C                  LD      L,(IY-3)            ;ZPOS
  C3D8    FD 66 FE       C                  LD      H,(IY-2)            ;SPOS
  C3DB    22 B18C        C                  LD      (MS.ZPOS),HL
  C3DE    FD CB FF 76    C                  BIT     6,(IY-1)            ;Test, ob Laengenangabe
  C3E2    20 0D          C                  JR      NZ,S1.ANZ6
  C3E4    FD 7E FF       C                  LD      A,(IY-1)            ;Laengenbyte
  C3E7    E6 3F          C                  AND     3FH
  C3E9    28 42          C                  JR      Z,S1.ANZ1           ;Anzeige ueberspringen
  C3EB    47             C                  LD      B,A
  C3EC    3E 18          C                  LD      A,24
  C3EE    32 B198        C                  LD      (MS.CMD),A
  C3F1    E1             C      S1.ANZ6:    POP     HL                  ;Textadresse
  C3F2    FD CB FF 7E    C                  BIT     7,(IY-1)
  C3F6    28 06          C                  JR      Z,S1.ANZ3
  C3F8    FD 6E 00       C                  LD      L,(IY)
  C3FB    FD 66 01       C                  LD      H,(IY+1)
  C3FE    FD 23          C      S1.ANZ3:    INC     IY
  C400    FD 23          C                  INC     IY
  C402    FD E5          C                  PUSH    IY
  C404    FD CB FD 76    C                  BIT     6,(IY-3)
  C408    20 0E          C                  JR      NZ,S1.ANZ4
  C40A    CD CB10        C                  CALL    MO.MONI
  C40D    FD CB FD 7E    C                  BIT     7,(IY-3)
  C411    20 1A          C                  JR      NZ,S1.ANZ1
  C413    FD E1          C                  POP     IY
  C415    E5             C                  PUSH    HL
  C416    18 15          C                  JR      S1.ANZ1
                         C      
  C418    3E 14          C      S1.ANZ4:    LD      A,20
  C41A    32 B198        C                  LD      (MS.CMD),A
  C41D    7E             C      S1.ANZ5:    LD      A,(HL)
  C41E    23             C                  INC     HL
  C41F    FE FF          C                  CP      -1
  C421    28 0A          C                  JR      Z,S1.ANZ1
  C423    32 B199        C                  LD      (MS.TK),A
  C426    E5             C                  PUSH    HL
  C427    CD CB10        C                  CALL    MO.MONI
'Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-20


  C42A    E1             C                  POP     HL
  C42B    18 F0          C                  JR      S1.ANZ5
                         C      
  C42D    FD E1          C      S1.ANZ1:    POP     IY
  C42F    3E 0B          C                  LD      A,11
  C431    32 B198        C                  LD      (MS.CMD),A
  C434    CD CB10        C                  CALL    MO.MONI
  C437    E5             C                  PUSH    HL
  C438    FD 7E 00       C                  LD      A,(IY)              ;Eingabelaenge
  C43B    06 00          C                  LD      B,0
  C43D    4F             C                  LD      C,A
  C43E    C5             C                  PUSH    BC
  C43F    B7             C                  OR      A
  C440    28 50          C                  JR      Z,S1.ANZ2           ;keine Eingabe gefordert
                         C      
                         C                  PAGE
'Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-21


                         C      
  C442    2A B18C        C                  LD      HL,(MS.ZPOS)        ;ZMIN und SMIN ermitteln
  C445    24             C                  INC     H
  C446    2C             C                  INC     L
  C447    22 B18E        C                  LD      (MS.ZMIN),HL
  C44A    7C             C                  LD      A,H                 ;ZMAX und SMAX ermitteln
  C44B    0D             C                  DEC     C
  C44C    81             C                  ADD     A,C
  C44D    67             C                  LD      H,A
  C44E    22 B190        C                  LD      (MS.ZMAX),HL
  C451    CD D420        C                  CALL    TA.LOES
  C454    2A B24D        C                  LD      HL,(TS.STACK)
  C457    E5             C                  PUSH    HL
  C458    FD 6E 02       C                  LD      L,(IY+2)            ;Routine  NEG QUIT
  C45B    FD 66 03       C                  LD      H,(IY+3)
  C45E    E5             C                  PUSH    HL
  C45F    FD 6E 04       C                  LD      L,(IY+4)            ;Routine  POS QUIT
  C462    FD 66 05       C                  LD      H,(IY+5)
  C465    E5             C                  PUSH    HL
  C466    ED 73 B24D     C                  LD      (TS.STACK),SP
  C46A    21 C49D        C                  LD      HL,S1.ANZ7
  C46D    22 B223        C                  LD      (TS.TAB4),HL
  C470    21 C4AC        C                  LD      HL,S1.ANZ8
  C473    22 B21B        C                  LD      (TS.TAB3+4),HL
  C476    FD 6E 06       C                  LD      L,(IY+6)            ;Routine  alphanum. Tasten
  C479    FD 66 07       C                  LD      H,(IY+7)
  C47C    22 B22D        C                  LD      (TS.EINA),HL
  C47F    FD 7E 01       C                  LD      A,(IY+1)
  C482    32 B23F        C                  LD      (TS.SPMER),A
  C485    3E 06          C                  LD      A,6                 ;Cursor setzen
  C487    32 B198        C                  LD      (MS.CMD),A
  C48A    CD CB10        C                  CALL    MO.MONI
  C48D    21 C2A8        C                  LD      HL,S1.TFE
  C490    E5             C                  PUSH    HL
  C491    C9             C                  RET                         ;zur Tastaturabfrageschleife
                         C      
                         C      
  C492    C1             C      S1.ANZ2:    POP     BC                  ;Register herstellen
  C493    E1             C                  POP     HL
  C494    D1             C                  POP     DE
  C495    F1             C                  POP     AF
  C496    DD E1          C                  POP     IX
  C498    FD 23          C                  INC     IY
  C49A    FD E3          C                  EX      (SP),IY
  C49C    C9             C                  RET                         ;Ruecksprung zum naechsten Befehl
                         C      
  C49D    FD E1          C      S1.ANZ7:    POP     IY                  ;RET TA.MM   Rueckkehr POS_QUIT
  C49F    FD E1          C                  POP     IY                  ;RET ABFR
  C4A1    FD E1          C                  POP     IY                  ;POS QUIT
  C4A3    E1             C                  POP     HL                  ;NEG QUIT
  C4A4    FD 2B          C      S1.ANZ9:    DEC     IY
  C4A6    E1             C                  POP     HL                  ;TS.STACK
  C4A7    22 B24D        C                  LD      (TS.STACK),HL
  C4AA    18 E6          C                  JR      S1.ANZ2
                         C      
  C4AC    FD E1          C      S1.ANZ8:    POP     IY                  ;RET TA.MM   Rueckkehr NEG_QUIT
  C4AE    FD E1          C                  POP     IY                  ;RET ABFR
  C4B0    FD E1          C                  POP     IY                  ;POS QUIT
  C4B2    FD E1          C                  POP     IY                  ;NEG QUIT
  C4B4    18 EE          C                  JR      S1.ANZ9
                         C      
                         C                  PAGE
'Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-22


                         C      
                         C      ;****************************************************************
                         C      ;*               Vergleich der Zeichenketten                    *
                         C      ;****************************************************************
  C4B6    D5             C      S1.VERGL:   PUSH    DE                  ;DE = gegebene  ZK
  C4B7    1A             C      S1.VERG1:   LD      A,(DE)              ;B  = Laenge
  C4B8    BE             C                  CP      (HL)                ;HL = vermutete ZK
  C4B9    20 04          C                  JR      NZ,S1.VERG2
  C4BB    13             C                  INC     DE
  C4BC    23             C                  INC     HL
  C4BD    10 F8          C                  DJNZ    S1.VERG1
  C4BF    D1             C      S1.VERG2:   POP     DE                  ;Z  = 1 : Kette gefunden B = 0
  C4C0    C9             C                  RET                         ;HL = Kette + 1    DE := DE
                         C      ;****************************************************************
                         C      ;*               Zeichen suchen                                 *
                         C      ;****************************************************************
  C4C1    3A B193        C      S1.SZEI:    LD      A,(MS.SPANZ)
  C4C4    47             C      S1.SZEI1:   LD      B,A
  C4C5    05             C                  DEC     B
  C4C6    3E 28          C                  LD      A,40
  C4C8    32 B198        C                  LD      (MS.CMD),A
  C4CB    CD CB10        C      S1.SZEI2:   CALL    MO.MONI
  C4CE    3A B199        C                  LD      A,(MS.TK)
  C4D1    FE 20          C                  CP      ' '
  C4D3    C0             C                  RET     NZ
  C4D4    10 F5          C                  DJNZ    S1.SZEI2
  C4D6    C9             C                  RET                         ;Z = 0 falls kein Zeichen
                         C      ;****************************************************************
                         C      ;*               Spalten- bzw. Zeilenanzahl berechnen           *
                         C      ;****************************************************************
  C4D7    E5             C      S1.SZAHL:   PUSH    HL
  C4D8    2A B18F        C                  LD      HL,(MS.SMIN)
  C4DB    3A B191        C      S1.SZA1:    LD      A,(MS.SMAX)
  C4DE    18 07          C                  JR      S1.ZAHL
  C4E0    E5             C      S1.ZZAHL:   PUSH    HL
  C4E1    2A B18E        C                  LD      HL,(MS.ZMIN)
  C4E4    3A B190        C      S1.ZZA1:    LD      A,(MS.ZMAX)
  C4E7    95             C      S1.ZAHL:    SUB     L
  C4E8    3C             C                  INC     A
  C4E9    E1             C                  POP     HL
  C4EA    C9             C                  RET                         ;A = Zeilen- bzw. Spaltenanzahl
                         C      ;
  C4EB    FB             C      S1.IO:      EI
  C4EC    ED 4D          C                  RETI
                         C      
                         C      ;****************************************************************
                         C      ;*              Anzeige eines Fehlertextes bei S0.FKADR und     *
                         C      ;*              Sprung zur Systemgrundanzeige                   *
                         C      ;*              HL  Adresse des Fehlertextes (38 Byte)          *
                         C      ;****************************************************************
  C4EE    CD C511        C      S1.FEH:     CALL    S1.FEH1
  C4F1    C3 C114        C                  JP      S1.SYSTB
                         C      
                         C                  PAGE
'Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-23


                         C      
                         C      ;****************************************************************
                         C      ;*               Anzeige eines Fehlertextes bei S0.FKADR und    *
                         C      ;*          bei  FEHRR und POS/NEG QUIT       Ruecksprung       *
                         C      ;*          bei  FEHR  und NEG QUIT           Sprung zum System *
                         C      ;*          bei  FEHR  und POS QUIT           Ruecksprung       *
                         C      ;*               HL  Adresse des Fehlertextes (38 Byte)         *
                         C      ;*               DE  Tastenroutinenadresse  POS QUIT            *
                         C      ;*               BC  Tastenroutinenadresse  NEG QUIT  nur FEHRR *
                         C      ;****************************************************************
  C4F4    01 C114        C      S1.FEHR:    LD      BC,S1.SYSTB
  C4F7    C5             C      S1.FEHRR:   PUSH    BC
  C4F8    D5             C                  PUSH    DE
  C4F9    CD C511        C                  CALL    S1.FEH1
  C4FC    CD D408        C                  CALL    TA.LOE
  C4FF    E1             C                  POP     HL
  C500    22 B223        C                  LD      (TS.TAB4),HL
  C503    E1             C                  POP     HL
  C504    22 B21B        C                  LD      (TS.TAB3+4),HL
  C507    3E 80          C                  LD      A,10000000B
  C509    32 B23F        C                  LD      (TS.SPMER),A
  C50C    21 C2A8        C                  LD      HL,S1.TFE
  C50F    E5             C                  PUSH    HL
  C510    C9             C                  RET
                         C      
  C511    E5             C      S1.FEH1:    PUSH    HL
  C512    AF             C                  XOR     A
  C513    32 B247        C                  LD      (TS.MIO),A
  C516    CD D630        C                  CALL    K1.MVS
  C519    E1             C                  POP     HL
  C51A    ED 5B B132     C                  LD      DE,(K2.FKADR)
  C51E    15             C                  DEC     D
  C51F    1D             C                  DEC     E
  C520    ED 53 B18C     C                  LD      (MS.ZPOS),DE
  C524    3E 18          C                  LD      A,24
  C526    32 B198        C                  LD      (MS.CMD),A
  C529    06 26          C                  LD      B,38
  C52B    CD CB10        C                  CALL    MO.MONI
  C52E    CD D647        C                  CALL    K1.MVL
  C531    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*               Unterprogramm bestimmt Parameter nach          *
                         C      ;*               Befehlsname                                    *
                         C      ;*               D             = Parameter binaer               *
                         C      ;*               DM1 ... DM1+8 = Parameter hexadezimal          *
                         C      ;****************************************************************
  C532    26 07          C      S1.INPTR:   LD      H,7
  C534    2E 0A          C                  LD      L,S0.SYSZ-1
  C536    22 B18A        C                  LD      (MS.ZPOL),HL
  C539    06 09          C                  LD      B,9
  C53B    21 B29A        C                  LD      HL,S2.DM1
  C53E    3E 2C          C                  LD      A,44
  C540    32 B198        C                  LD      (MS.CMD),A
  C543    CD CB10        C                  CALL    MO.MONI
  C546    21 B29A        C                  LD      HL,S2.DM1
  C549    CD C5CC        C                  CALL    S1.HBKON
  C54C    57             C                  LD      D,A
  C54D    C9             C                  RET
                         C      
                         C                  PAGE
'Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-24


                         C      
                         C      ;****************************************************************
                         C      ;*               Konvertierung Binaerwert in  HL                *
                         C      ;*               ==> ISO - Dezimalwert ab  (DE)                 *
                         C      ;****************************************************************
  C54E    01 2710        C      S1.HDI:     LD      BC,10000
  C551    CD C56C        C                  CALL    S1.HDI1
  C554    01 03E8        C                  LD      BC,1000
  C557    CD C56C        C                  CALL    S1.HDI1
  C55A    01 0064        C                  LD      BC,100
  C55D    CD C56C        C                  CALL    S1.HDI1
  C560    01 000A        C                  LD      BC,10
  C563    CD C56C        C                  CALL    S1.HDI1
  C566    7D             C                  LD      A,L
  C567    F6 30          C                  OR      30H
  C569    12             C                  LD      (DE),A
  C56A    13             C                  INC     DE
  C56B    C9             C                  RET
  C56C    CD C589        C      S1.HDI1:    CALL    S1.DIV
  C56F    F6 30          C                  OR      30H
  C571    FE 30          C                  CP      30H
  C573    20 0D          C                  JR      NZ,S1.HDI3
  C575    47             C                  LD      B,A
  C576    1B             C                  DEC     DE
  C577    1A             C                  LD      A,(DE)
  C578    13             C                  INC     DE
  C579    FE 3A          C                  CP      ':'
  C57B    30 08          C                  JR      NC,S1.HDI2
  C57D    FE 30          C                  CP      '0'
  C57F    38 04          C                  JR      C,S1.HDI2
  C581    78             C                  LD      A,B
  C582    12             C      S1.HDI3:    LD      (DE),A
  C583    13             C                  INC     DE
  C584    C9             C                  RET
  C585    3E 20          C      S1.HDI2:    LD      A,' '
  C587    18 F9          C                  JR      S1.HDI3
                         C      ;****************************************************************
                         C      ;*               Division HL/BC                                 *
                         C      ;****************************************************************
  C589    AF             C      S1.DIV:     XOR     A
  C58A    ED 42          C      S1.DIV1:    SBC     HL,BC
  C58C    3C             C                  INC     A
  C58D    30 FB          C                  JR      NC,S1.DIV1
  C58F    09             C                  ADD     HL,BC
  C590    3D             C                  DEC     A                   ;A:=HL/BC  HL:=Rest
  C591    C9             C                  RET
                         C      
                         C                  PAGE
'Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-25


                         C      
                         C      ;****************************************************************
                         C      ;*               Konvertierung ISO - Dezimalwert ab  (DE)       *
                         C      ;*               ==>  Binaerwert in  HL                         *
                         C      ;*               Zahl < 10000                                   *
                         C      ;****************************************************************
  C592    0E 06          C      S1.IDH:     LD      C,6
  C594    CD C5B4        C                  CALL    S1.IDH1
  C597    D8             C                  RET     C                   ;CY = 1 Fehler: keine Zahl ab (DE)
  C598    26 00          C                  LD      H,0
  C59A    6F             C      S1.IDH2:    LD      L,A
  C59B    13             C                  INC     DE
  C59C    0D             C                  DEC     C
  C59D    C8             C                  RET     Z                   ;Z  = 1 Fehler: Stellenzahl > 5
  C59E    CD C5B4        C      S1.IDH3:    CALL    S1.IDH1
  C5A1    38 0D          C                  JR      C,S1.IDHE           ;CY = 1 wenn Zahl zu Ende
  C5A3    CD C5C3        C                  CALL    S1.MUL10
  C5A6    38 06          C                  JR      C,S1.IDHF           ;CY = 1 wenn Zahl > FFFFH
  C5A8    85             C                  ADD     A,L
  C5A9    30 EF          C                  JR      NC,S1.IDH2
  C5AB    24             C                  INC     H
  C5AC    18 EC          C                  JR      S1.IDH2
  C5AE    AF             C      S1.IDHF:    XOR     A
  C5AF    C9             C                  RET                         ;Z  = 1 Fehler: Zahl > FFFFH
  C5B0    3E 01          C      S1.IDHE:    LD      A,1
  C5B2    B7             C                  OR      A
  C5B3    C9             C                  RET                         ;Z  = CY = 0  kein Fehler
  C5B4    1A             C      S1.IDH1:    LD      A,(DE)
  C5B5    CD C5BC        C                  CALL    S1.SIEBD
  C5B8    D8             C                  RET     C
  C5B9    E6 0F          C                  AND     0FH
  C5BB    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*               Test: ISO - Zeichen = Ziffer ?                 *
                         C      ;****************************************************************
  C5BC    FE 30          C      S1.SIEBD:   CP      '0'
  C5BE    D8             C                  RET     C
  C5BF    FE 3A          C                  CP      ':'
  C5C1    3F             C                  CCF
  C5C2    C9             C                  RET                         ;CY = 1 wenn A keine Dez.Ziffer
                         C      ;****************************************************************
                         C      ;*               Multiplikation  HL * 10                        *
                         C      ;****************************************************************
  C5C3    D5             C      S1.MUL10:   PUSH    DE
  C5C4    E5             C                  PUSH    HL
  C5C5    D1             C                  POP     DE
  C5C6    29             C                  ADD     HL,HL
  C5C7    29             C                  ADD     HL,HL
  C5C8    19             C                  ADD     HL,DE
  C5C9    29             C                  ADD     HL,HL
  C5CA    D1             C                  POP     DE
  C5CB    C9             C                  RET                         ;HL := HL * 10
                         C      
                         C                  PAGE
'Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-26


                         C      
                         C      ;****************************************************************
                         C      ;*               Hexadezimal - Binaer - Konvertierung           *
                         C      ;*               HL = Anfangsadresse des Hexazeichens           *
                         C      ;*               A  = Binaerzeichen                             *
                         C      ;****************************************************************
  C5CC    C5             C      S1.HBKON:   PUSH    BC
  C5CD    06 00          C                  LD      B,0
  C5CF    7E             C                  LD      A,(HL)              ;1.Zeichen
  C5D0    23             C                  INC     HL
  C5D1    CD C5E8        C                  CALL    S1.KON1
  C5D4    38 10          C                  JR      C,S1.HBK1
  C5D6    CB 10          C                  RL      B
  C5D8    CB 10          C                  RL      B
  C5DA    CB 10          C                  RL      B
  C5DC    CB 10          C                  RL      B
  C5DE    7E             C                  LD      A,(HL)              ;2.Zeichen
  C5DF    23             C                  INC     HL
  C5E0    CD C5E8        C                  CALL    S1.KON1
  C5E3    38 01          C                  JR      C,S1.HBK1
  C5E5    78             C                  LD      A,B
  C5E6    C1             C      S1.HBK1:    POP     BC
  C5E7    C9             C                  RET
  C5E8    D6 30          C      S1.KON1:    SUB     30H                 ;Test , ob Hexazeichen
  C5EA    D8             C                  RET     C                   ;kein Hexzeichen
  C5EB    FE 0A          C                  CP      10
  C5ED    38 0B          C                  JR      C,S1.KON3           ;Hexzeichen  0 ... 9
  C5EF    FE 17          C                  CP      17H
  C5F1    3F             C                  CCF
  C5F2    D8             C                  RET     C                   ;kein Hexzeichen
  C5F3    FE 11          C                  CP      11H
  C5F5    D8             C                  RET     C                   ;kein Hexzeichen
  C5F6    E6 0F          C                  AND     0FH                 ;Hexzeichen  A ... F
  C5F8    C6 09          C                  ADD     A,9
  C5FA    B0             C      S1.KON3:    OR      B
  C5FB    47             C                  LD      B,A
  C5FC    37             C                  SCF                         ;CY = 0  Zeichen ist ein Hexazeichen
  C5FD    3F             C                  CCF
  C5FE    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*               Konvertiere 8 Bit von Register A in ASCII      *
                         C      ;*               Hexadezimal auf  (HL)                          *
                         C      ;****************************************************************
  C5FF    F5             C      S1.BHKON:   PUSH    AF                  ;rette A
  C600    1F             C                  RRA
  C601    1F             C                  RRA
  C602    1F             C                  RRA
  C603    1F             C                  RRA
  C604    CD C60E        C                  CALL    S1.KON2             ;konvertiere high order 4 Bits
  C607    23             C                  INC     HL
  C608    F1             C                  POP     AF
  C609    CD C60E        C                  CALL    S1.KON2             ;konvertiere  low order 4 Bits
  C60C    23             C                  INC     HL
  C60D    C9             C                  RET
  C60E    E6 0F          C      S1.KON2:    AND     0FH                 ;Maske fuer   low order 4 Bits
  C610    FE 0A          C                  CP      10
  C612    38 02          C                  JR      C,S1.HB10
  C614    C6 07          C                  ADD     A,7
  C616    C6 30          C      S1.HB10:    ADD     A,30H
  C618    77             C                  LD      (HL),A
  C619    C9             C                  RET
                         C      
                         C                  PAGE
'Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-27


                         C      
                         C      ;****************************************************************
                         C      ;*               Zeichen suchen                                 *
                         C      ;*               (DE),(D+1),... = Suchbereich                   *
                         C      ;*               B              = Laenge                        *
                         C      ;****************************************************************
  C61A    EB             C      S1.SUZEI:   EX      DE,HL
  C61B    CD C4CB        C                  CALL    S1.SZEI2
  C61E    EB             C                  EX      DE,HL               ;A  = Zeichen , DE = Adresse
  C61F    C9             C                  RET                         ;Z  = 1 wenn kein Zeichen
                         C      ;****************************************************************
                         C      ;*               Zahl suchen                                    *
                         C      ;*               (DE),(DE+1),... = Suchbereich                  *
                         C      ;*               B               = Laenge                       *
                         C      ;****************************************************************
  C620    CD C61A        C      S1.SUZA:    CALL    S1.SUZEI
  C623    C8             C                  RET     Z                   ;Z  = 1 : kein Zeichen
  C624    CD C592        C      S1.SUZA1:   CALL    S1.IDH
  C627    D8             C                  RET     C                   ;Z  = 0 CY = 1 : falsche Zahl
  C628    C0             C                  RET     NZ                  ;Z  = 0 CY = 0 : HL = Zahl
  C629    3E 01          C      S1.SUZA3:   LD      A,1
  C62B    B7             C                  OR      A
  C62C    37             C                  SCF
  C62D    C9             C                  RET                         ;Z  = 0 CY = 1 : falsche Zahl
                         C      ;****************************************************************
                         C      ;*               Zahl lesen und pruefen: A' < Zahl =< (IX+0)    *
                         C      ;*               falls Bedingung erfuellt: L  = Zahl Z = CY = 0 *
                         C      ;*               falls keine Zeichen     : Z  = 1               *
                         C      ;*               falls falsche Zahl      : CY = 1               *
                         C      ;****************************************************************
  C62E    CD C620        C      S1.LT1Z:    CALL    S1.SUZA
  C631    D8             C                  RET     C
  C632    C8             C                  RET     Z
  C633    7C             C                  LD      A,H
  C634    B7             C                  OR      A
  C635    20 F2          C                  JR      NZ,S1.SUZA3
  C637    DD 7E 00       C                  LD      A,(IX+0)
  C63A    BD             C                  CP      L
  C63B    D8             C                  RET     C
  C63C    08             C                  EX      AF,AF'              ;'
  C63D    BD             C                  CP      L
  C63E    3F             C                  CCF
  C63F    C9             C                  RET
  C640    DD E9          C      S1.MX:      JP      (IX)
  C642    E5             C      S1.RNR:     PUSH    HL                  ;Rechtsrotieren vor   (HL)
  C643    D1             C                  POP     DE                  ;BC = Anzahl
  C644    1A             C                  LD      A,(DE)
  C645    2B             C                  DEC     HL
  C646    ED B8          C                  LDDR
  C648    12             C                  LD      (DE),A
  C649    C9             C                  RET
  C64A    E5             C      S1.RNL:     PUSH    HL                  ;Linksrotieren hinter (HL)
  C64B    D1             C                  POP     DE                  ;BC = Anzahl
  C64C    1A             C                  LD      A,(DE)
  C64D    23             C                  INC     HL
  C64E    ED B0          C                  LDIR
  C650    12             C                  LD      (DE),A
  C651    C9             C                  RET
                         C      
                         C                  PAGE
'Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-28


                         C      
                         C      ;****************************************************************
                         C      ;*               C R C - Kontrollsumme   berechnen              *
                         C      ;*               -----------------------------------------------*
                         C      ;*               Eingabe:  HL  ... Anfang des Bereiches         *
                         C      ;*                         BC  ... Laenge des Bereiches         *
                         C      ;*               Ausgabe:  DE  ... CRC-Summe ueber den Bereich  *
                         C      ;****************************************************************
  C652    11 FFFF        C      S1.CHK:     LD      DE,0FFFFH
  C655    7E             C      S1.CHK1:    LD      A,(HL)
  C656    AA             C                  XOR     D
  C657    57             C                  LD      D,A
  C658    0F             C                  RRCA
  C659    0F             C                  RRCA
  C65A    0F             C                  RRCA
  C65B    0F             C                  RRCA
  C65C    E6 0F          C                  AND     00FH
  C65E    AA             C                  XOR     D
  C65F    57             C                  LD      D,A
  C660    0F             C                  RRCA
  C661    0F             C                  RRCA
  C662    0F             C                  RRCA
  C663    F5             C                  PUSH    AF
  C664    E6 1F          C                  AND     01FH
  C666    AB             C                  XOR     E
  C667    5F             C                  LD      E,A
  C668    F1             C                  POP     AF
  C669    F5             C                  PUSH    AF
  C66A    0F             C                  RRCA
  C66B    E6 F0          C                  AND     0F0H
  C66D    AB             C                  XOR     E
  C66E    5F             C                  LD      E,A
  C66F    F1             C                  POP     AF
  C670    E6 E0          C                  AND     0E0H
  C672    AA             C                  XOR     D
  C673    53             C                  LD      D,E
  C674    5F             C                  LD      E,A
  C675    23             C                  INC     HL
  C676    0B             C                  DEC     BC
  C677    78             C                  LD      A,B
  C678    B1             C                  OR      C
  C679    20 DA          C                  JR      NZ,S1.CHK1
  C67B    C9             C                  RET
                         C      
                         C                  PAGE
'Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-29


                         C      
                         C      ;****************************************************************
                         C      ;*               Systemzustaende anzeigen                       *
                         C      ;****************************************************************
  C67C    CD CF45        C      S1.STAT:    CALL    MO.BWSE
  C67F    23             C                  INC     HL
  C680    CD CF58        C                  CALL    MO.DESZ
  C683    B7             C                  OR      A
  C684    ED 52          C                  SBC     HL,DE
  C686    ED 52          C                  SBC     HL,DE
  C688    E5             C                  PUSH    HL
  C689    EB             C                  EX      DE,HL
  C68A    21 C6DF        C                  LD      HL,S1.STT1
  C68D    01 001B        C                  LD      BC,27
  C690    ED B0          C                  LDIR
  C692    E1             C                  POP     HL
  C693    CD CF58        C                  CALL    MO.DESZ
  C696    19             C                  ADD     HL,DE
  C697    EB             C                  EX      DE,HL
  C698    3A B264        C                  LD      A,(S2.IOC)
  C69B    B7             C                  OR      A
  C69C    28 05          C                  JR      Z,S1.STTT1
  C69E    21 C6FA        C                  LD      HL,S1.STT2
  C6A1    18 03          C                  JR      S1.STTT2
  C6A3    21 C701        C      S1.STTT1:   LD      HL,S1.STT3
  C6A6    01 0007        C      S1.STTT2:   LD      BC,7
  C6A9    ED B0          C                  LDIR
  C6AB    3A B241        C                  LD      A,(TS.KGMER)
  C6AE    B7             C                  OR      A
  C6AF    28 05          C                  JR      Z,S1.STTT3
  C6B1    21 C708        C                  LD      HL,S1.STT4
  C6B4    18 03          C                  JR      S1.STTT4
  C6B6    21 C70F        C      S1.STTT3:   LD      HL,S1.STT5
  C6B9    01 0007        C      S1.STTT4:   LD      BC,7
  C6BC    ED B0          C                  LDIR
  C6BE    3A B240        C                  LD      A,(TS.UMERK)
  C6C1    B7             C                  OR      A
  C6C2    28 05          C                  JR      Z,S1.STTT5
  C6C4    21 C6FA        C                  LD      HL,S1.STT2
  C6C7    18 03          C                  JR      S1.STTT6
  C6C9    21 C701        C      S1.STTT5:   LD      HL,S1.STT3
  C6CC    01 0007        C      S1.STTT6:   LD      BC,7
  C6CF    ED B0          C                  LDIR
  C6D1    21 0003        C                  LD      HL,3
  C6D4    19             C                  ADD     HL,DE
  C6D5    3A B23E        C                  LD      A,(TS.EMERK)
  C6D8    C6 30          C                  ADD     A,30H
  C6DA    77             C                  LD      (HL),A
  C6DB    CD CB3F        C                  CALL    MO.BWSUS
  C6DE    C9             C                  RET
                         C      
  C6DF    49 4F 43 5F    C      S1.STT1:    DB      'IOC___TAS___INS MOD___EBENE'
  C6E3    5F 5F 54 41    C      
  C6E7    53 5F 5F 5F    C      
  C6EB    49 4E 53 20    C      
  C6EF    4D 4F 44 5F    C      
  C6F3    5F 5F 45 42    C      
  C6F7    45 4E 45       C      
  C6FA    45 49 4E 20    C      S1.STT2:    DB      'EIN    '
  C6FE    20 20 20       C      
  C701    41 55 53 20    C      S1.STT3:    DB      'AUS    '
  C705    20 20 20       C      
  C708    53 20 20 20    C      S1.STT4:    DB      'S      '
  C70C    20 20 20       C      
  C70F    50 20 20 20    C      S1.STT5:    DB      'P      '
  C713    20 20 20       C      
                         C      
                         C                  TITLE   'System-Kommandos'
                         C                  PAGE
'System-Kommandos'	MACRO-80 3.44	09-Dec-81	PAGE	1-30


                         C      
                         C      ;****************************************************************
                         C      ;*               Kommandos  D A T E  ,  S T A S  ,  P T A S  ,  *
                         C      ;*                          D I N I  ,  I O C E  ,  I O C A     *
                         C      ;****************************************************************
  C716    C716           C                  DW      $
  C718    44 41 54 45    C                  DB      'DATE'
  C71C    26 07          C                  LD      H,7                 ;ZPOL=SYSZ , SPOL=7
  C71E    2E 0A          C                  LD      L,S0.SYSZ-1
  C720    22 B18A        C                  LD      (MS.ZPOL),HL
  C723    21 0004        C                  LD      HL,S3.DATUM-S3.SEAT
  C726    11 A800        C                  LD      DE,S0.DEAT
  C729    19             C                  ADD     HL,DE
  C72A    06 06          C                  LD      B,6
  C72C    3E 2C          C                  LD      A,44
  C72E    32 B198        C                  LD      (MS.CMD),A
  C731    CD CB10        C                  CALL    MO.MONI
  C734    2A B194        C                  LD      HL,(MS.BWSA)        ;Testen, ob Datum vorhanden
  C737    11 0327        C                  LD      DE,10*80 + 7
  C73A    19             C                  ADD     HL,DE
  C73B    7E             C                  LD      A,(HL)        
  C73C    FE 20          C                  CP      ' '
  C73E    20 10          C                  JR      NZ,S1.DATE
                         C                                              ;Kein Datum, dann akt. Datum holen
  C740    C5             C                  PUSH    BC
  C741    D5             C                  PUSH    DE
  C742    21 0004        C                  LD      HL,S3.DATUM-S3.SEAT
  C745    11 A800        C                  LD      DE,S0.DEAT
  C748    19             C                  ADD     HL,DE
  C749    01 06FD        C                  LD      BC,006FDH           ;actual Date ermitteln
  C74C    ED B2          C                  INIR
  C74E    D1             C                  POP     DE
  C74F    C1             C                  POP     BC
                         C      ;
  C750    E1             C      S1.DATE:    POP     HL
  C751    E1             C                  POP     HL
  C752    C9             C                  RET
                         C      ;
                         C      ;
  C753    C753           C                  DW      $
  C755    53 54 41 53    C                  DB      'STAS'
  C759    3E 01          C                  LD      A,1
  C75B    32 B241        C      S1.STAS1:   LD      (TS.KGMER),A
  C75E    18 F0          C                  JR      S1.DATE
                         C      
  C760    C760           C                  DW      $
  C762    50 54 41 53    C                  DB      'PTAS'
  C766    AF             C                  XOR     A
  C767    18 F2          C                  JR      S1.STAS1
                         C      
                         C      
  C769    C769           C                  DW      $
  C76B    49 4F 43 45    C                  DB      'IOCE'
  C76F    3E 01          C                  LD      A,1
  C771    32 B264        C      S1.IOCC:    LD      (S2.IOC),A
  C774    18 DA          C                  JR      S1.DATE
                         C      
  C776    C776           C                  DW      $
  C778    49 4F 43 41    C                  DB      'IOCA'
  C77C    AF             C                  XOR     A
  C77D    18 F2          C                  JR      S1.IOCC
                         C      
                         C                  PAGE
'System-Kommandos'	MACRO-80 3.44	09-Dec-81	PAGE	1-31


                         C      
  C77F    C77F           C                  DW      $
  C781    44 49 4E 49    C                  DB      'DINI'
  C785    DD 21 0091     C                  LD      IX,S3.PRIN-S3.SEAT
  C789    11 A803        C                  LD      DE,S0.DEAT+3
  C78C    DD 19          C                  ADD     IX,DE
  C78E    26 07          C                  LD      H,7                 ;ZPOL=SYSZ , SPOL=8
  C790    2E 0A          C                  LD      L,S0.SYSZ-1
  C792    22 B18A        C                  LD      (MS.ZPOL),HL
  C795    3E 1F          C                  LD      A,31                ;HL:=ZPOS,SPOS
  C797    32 B198        C                  LD      (MS.CMD),A
  C79A    CD CB10        C                  CALL    MO.MONI
  C79D    7E             C                  LD      A,(HL)              ;char per inch
  C79E    23             C                  INC     HL
  C79F    FE 30          C                  CP      '0'
  C7A1    28 0A          C                  JR      Z,S1.CPI10
  C7A3    FE 32          C                  CP      '2'
  C7A5    20 0A          C                  JR      NZ,S1.CPI
  C7A7    DD CB 04 C6    C                  SET     0,(IX+4)
  C7AB    18 04          C                  JR      S1.CPI
  C7AD    DD CB 04 86    C      S1.CPI10:   RES     0,(IX+4)
  C7B1    7E             C      S1.CPI:     LD      A,(HL)              ;line per inch
  C7B2    23             C                  INC     HL
  C7B3    FE 36          C                  CP      '6'
  C7B5    28 0A          C                  JR      Z,S1.LPI6
  C7B7    FE 38          C                  CP      '8'
  C7B9    20 0A          C                  JR      NZ,S1.LPI
  C7BB    DD CB 04 CE    C                  SET     1,(IX+4)
  C7BF    18 04          C                  JR      S1.LPI
  C7C1    DD CB 04 8E    C      S1.LPI6:    RES     1,(IX+4)
  C7C5    7E             C      S1.LPI:     LD      A,(HL)              ;ohne/mit Nulldurchstreichung
  C7C6    23             C                  INC     HL
  C7C7    FE 4F          C                  CP      'O'
  C7C9    28 08          C                  JR      Z,S1.ONULL
  C7CB    FE 4D          C                  CP      'M'
  C7CD    20 04          C                  JR      NZ,S1.ONULL
  C7CF    3E FF          C                  LD      A,-1
  C7D1    18 01          C                  JR      S1.NULL
  C7D3    AF             C      S1.ONULL:   XOR     A
  C7D4    DD 77 0C       C      S1.NULL:    LD      (IX+12),A
  C7D7    CD C02D        C                  CALL    S1.SM
  C7DA    C3 C750        C                  JP      S1.DATE
                         C      
                         C      
  C7DD    C7DD           C                  DW      $
  C7DF    45 58 45 43    C                  DB      'EXEC'
  C7E3    CD C532        C                  CALL    S1.INPTR
  C7E6    CD C5CC        C                  CALL    S1.HBKON
  C7E9    5F             C                  LD      E,A
  C7EA    D5             C                  PUSH    DE
  C7EB    E1             C                  POP     HL
  C7EC    E9             C                  JP      (HL)
                         C      
                         C                  PAGE
'System-Kommandos'	MACRO-80 3.44	09-Dec-81	PAGE	1-32


                         C      
                         C      ;****************************************************************
                         C      ;*              M E M O --- Anzeige von 16 x 16 Byte = 256 Byte *
                         C      ;****************************************************************
  C7ED    C7ED           C                  DW      $
  C7EF    4D 45 4D 4F    C                  DB      'MEMO'
  C7F3    CD C532        C                  CALL    S1.INPTR            ;Anfangsanzeigeadresse uebernehmen
  C7F6    CD C5CC        C                  CALL    S1.HBKON
  C7F9    5F             C                  LD      E,A
  C7FA    ED 53 B292     C                  LD      (S2.DMANF),DE
  C7FE    CD D420        C      S1.DB0:     CALL    TA.LOES
  C801    21 C825        C                  LD      HL,S1.ANZUM         ;Routine  ASCII- / Hex- Mode
  C804    22 B1FF        C                  LD      (TS.TAB2),HL
  C807    21 C896        C                  LD      HL,S1.NEGDB         ;Routine  blaettern zurueck
  C80A    22 B21B        C                  LD      (TS.TAB3+4),HL
  C80D    21 C877        C                  LD      HL,S1.POSDB         ;Routine  blaettern vor
  C810    22 B223        C                  LD      (TS.TAB4),HL
  C813    21 CA02        C                  LD      HL,S1.HCDB0         ;Hardcopyroutine
  C816    22 B21F        C                  LD      (TS.TAB3+8),HL
  C819    21 C929        C                  LD      HL,S1.SYDB1         ;Routine  aktivieren Korrektur
  C81C    22 B221        C                  LD      (TS.TAB3+10),HL
  C81F    21 C86E        C                  LD      HL,S1.EINDB         ;Routine  alphanum. Tasten
  C822    22 B22D        C                  LD      (TS.EINA),HL
  C825    CD C8B0        C      S1.ANZUM:   CALL    S1.ANZU1
  C828    01 0100        C      S1.DB1:     LD      BC,100H             ;Anzeigebild aufbauen
  C82B    11 0200        C                  LD      DE,200H
  C82E    CD C935        C      S1.DB111:   CALL    S1.MEAA
  C831    3A B240        C                  LD      A,(TS.UMERK)        ;Bildfenster fuer Eingabe definieren
  C834    B7             C                  OR      A
  C835    20 0D          C                  JR      NZ,S1.DB12
  C837    21 0700        C      S1.DB10:    LD      HL,00700H           ;ZPOS= 1 , SPOS= 8
  C83A    22 B18C        C      S1.DB11:    LD      (MS.ZPOS),HL
  C83D    24             C                  INC     H                   ;ZMIN= 1 , SPOS=..
  C83E    2C             C                  INC     L
  C83F    22 B18E        C                  LD      (MS.ZMIN),HL
  C842    18 0C          C                  JR      S1.DB13
  C844    3A B193        C      S1.DB12:    LD      A,(MS.SPANZ)        ;A S C II
  C847    FE 50          C                  CP      80
  C849    20 EC          C                  JR      NZ,S1.DB10
  C84B    21 3B00        C                  LD      HL,03B00H           ;ZPOS= 1 , SPOS=60
  C84E    18 EA          C                  JR      S1.DB11
  C850    3A B240        C      S1.DB13:    LD      A,(TS.UMERK)
  C853    B7             C                  OR      A
  C854    20 05          C                  JR      NZ,S1.DB14
  C856    21 3910        C                  LD      HL,03910H           ;ZMAX=16 , SMAX=57
  C859    18 0F          C                  JR      S1.DB16
  C85B    3A B193        C      S1.DB14:    LD      A,(MS.SPANZ)
  C85E    FE 50          C                  CP      80
  C860    20 05          C                  JR      NZ,S1.DB15
  C862    21 4B10        C                  LD      HL,04B10H           ;ZMAX=16 , SMAX=75
  C865    18 03          C                  JR      S1.DB16
  C867    21 2710        C      S1.DB15:    LD      HL,02710H           ;ZMAX=16 , SMAX=39
  C86A    22 B190        C      S1.DB16:    LD      (MS.ZMAX),HL
  C86D    C9             C                  RET
                         C      
                         C                  PAGE
'System-Kommandos'	MACRO-80 3.44	09-Dec-81	PAGE	1-33


                         C      
  C86E    CD C328        C      S1.EINDB:   CALL    S1.AEIN
  C871    21 B242        C      S1.DB9:     LD      HL,TS.ZSMER
  C874    36 01          C                  LD      (HL),1
  C876    C9             C                  RET
                         C      
  C877    2A B292        C      S1.POSDB:   LD      HL,(S2.DMANF)       ;eine Anzeigeseite weiter
  C87A    3A B240        C                  LD      A,(TS.UMERK)
  C87D    B7             C                  OR      A
  C87E    11 0100        C                  LD      DE,100H
  C881    28 0A          C                  JR      Z,S1.POS2
  C883    3A B193        C      S1.POS1:    LD      A,(MS.SPANZ)
  C886    FE 50          C                  CP      80
  C888    28 03          C                  JR      Z,S1.POS2
  C88A    11 0200        C                  LD      DE,200H
  C88D    19             C      S1.POS2:    ADD     HL,DE
  C88E    22 B292        C      S1.DB2:     LD      (S2.DMANF),HL
  C891    CD C871        C                  CALL    S1.DB9
  C894    18 92          C                  JR      S1.DB1
                         C      
  C896    2A B292        C      S1.NEGDB:   LD      HL,(S2.DMANF)
  C899    3A B240        C                  LD      A,(TS.UMERK)
  C89C    B7             C                  OR      A
  C89D    11 0100        C                  LD      DE,100H
  C8A0    28 0A          C                  JR      Z,S1.NEG2
  C8A2    3A B193        C      S1.NEG1:    LD      A,(MS.SPANZ)
  C8A5    FE 50          C                  CP      80
  C8A7    28 03          C                  JR      Z,S1.NEG2
  C8A9    11 0200        C                  LD      DE,200H
  C8AC    ED 52          C      S1.NEG2:    SBC     HL,DE
  C8AE    18 DE          C                  JR      S1.DB2
                         C      
  C8B0    3A B240        C      S1.ANZU1:   LD      A,(TS.UMERK)
  C8B3    B7             C                  OR      A
  C8B4    20 04          C                  JR      NZ,$+6
  C8B6    3E AA          C                  LD      A,10101010B
  C8B8    18 02          C                  JR      $+4
  C8BA    3E FF          C                  LD      A,11111111B
  C8BC    32 B23F        C                  LD      (TS.SPMER),A
  C8BF    C9             C                  RET
                         C      
  C8C0    C5             C      S1.ANZU2:   PUSH    BC
  C8C1    C5             C                  PUSH    BC
  C8C2    CD C8B0        C                  CALL    S1.ANZU1
  C8C5    C1             C                  POP     BC
  C8C6    D1             C                  POP     DE
  C8C7    C3 C82E        C                  JP      S1.DB111
                         C      
                         C                  PAGE
'System-Kommandos'	MACRO-80 3.44	09-Dec-81	PAGE	1-34


                         C      
                         C      ;****************************************************************
                         C      ;*               Abspeichern der Korrekturen                    *
                         C      ;****************************************************************
  C8CA    01 0100        C      S1.SYSDB:   LD      BC,100H             ;Anzahl anzuzeigender Byte
  C8CD    D9             C      S1.SYDB2:   EXX
  C8CE    06 10          C                  LD      B,16                ;max. Anzahl Zeilen
  C8D0    2A B194        C                  LD      HL,(MS.BWSA)        ;BWS      - Anfangsadresse
  C8D3    11 0007        C                  LD      DE,7
  C8D6    19             C                  ADD     HL,DE
  C8D7    ED 5B B292     C                  LD      DE,(S2.DMANF)       ;Speicher - Anfangsadresse
  C8DB    C5             C      S1.SDB1:    PUSH    BC
  C8DC    E5             C                  PUSH    HL
  C8DD    3A B240        C                  LD      A,(TS.UMERK)        ;INS_MOD ein/aus ?
  C8E0    B7             C                  OR      A
  C8E1    20 21          C                  JR      NZ,S1.SDB5
                         C      
  C8E3    06 04          C                  LD      B,4                 ;INS_MOD aus
  C8E5    C5             C      S1.SDB2:    PUSH    BC
  C8E6    06 04          C                  LD      B,4
  C8E8    CD C5CC        C      S1.SDB3:    CALL    S1.HBKON
  C8EB    12             C                  LD      (DE),A
  C8EC    CD C9FB        C                  CALL    S1.INC1
  C8EF    28 34          C                  JR      Z,S1.SDB9           ;alle Byte uebernommen
  C8F1    D9             C                  EXX
  C8F2    10 F4          C                  DJNZ    S1.SDB3             ;naechstes Byte
  C8F4    23             C                  INC     HL
  C8F5    C1             C                  POP     BC
  C8F6    10 ED          C                  DJNZ    S1.SDB2             ;naechste  Vierergruppe
  C8F8    06 00          C      S1.SDB4:    LD      B,0                 ;BWS-Adresse erhoehen
  C8FA    3A B193        C                  LD      A,(MS.SPANZ)
  C8FD    4F             C                  LD      C,A
  C8FE    E1             C                  POP     HL
  C8FF    09             C                  ADD     HL,BC
  C900    C1             C                  POP     BC
  C901    10 D8          C                  DJNZ    S1.SDB1                ;naechste  BWS-Zeile
  C903    C9             C                  RET
                         C      
  C904    3A B193        C      S1.SDB5:    LD      A,(MS.SPANZ)        ;INS_MOD ein
  C907    FE 50          C                  CP      80
  C909    20 08          C                  JR      NZ,S1.SDB6
  C90B    01 0034        C                  LD      BC,52
  C90E    09             C                  ADD     HL,BC
  C90F    06 10          C                  LD      B,16
  C911    18 02          C                  JR      S1.SDB7
  C913    06 20          C      S1.SDB6:    LD      B,32
  C915    7E             C      S1.SDB7:    LD      A,(HL)
  C916    FE 2E          C                  CP      '.'
  C918    28 01          C                  JR      Z,S1.SDB8
  C91A    12             C                  LD      (DE),A
  C91B    CD C9FB        C      S1.SDB8:    CALL    S1.INC1
  C91E    28 06          C                  JR      Z,S1.SDB10          ;alle Byte uebernommen
  C920    D9             C                  EXX
  C921    10 F2          C                  DJNZ    S1.SDB7             ;naechstes Byte
  C923    18 D3          C                  JR      S1.SDB4             ;naechste  Zeile
                         C      
  C925    C1             C      S1.SDB9:    POP     BC
  C926    E1             C      S1.SDB10:   POP     HL
  C927    C1             C                  POP     BC
  C928    C9             C                  RET
                         C      
  C929    CD C8CA        C      S1.SYDB1:   CALL    S1.SYSDB
  C92C    C3 C828        C                  JP      S1.DB1
                         C      
                         C      
                         C      ;****************************************************************
                         C      ;*            Aufbau des Speicheranzeigebildes                  *
                         C      ;****************************************************************
  C92F    01 0100        C      S1.MEA:     LD      BC,100H
  C932    11 0200        C                  LD      DE,200H
  C935    2A B194        C      S1.MEAA:    LD      HL,(MS.BWSA)
  C938    23             C                  INC     HL
  C939    E5             C                  PUSH    HL
  C93A    D9             C                  EXX
  C93B    ED 5B B292     C                  LD      DE,(S2.DMANF)
  C93F    D9             C                  EXX
  C940    3A B193        C                  LD      A,(MS.SPANZ)
  C943    FE 50          C                  CP      80
  C945    20 31          C                  JR      NZ,S1.MEA5
  C947    C5             C                  PUSH    BC                  ;BWS = 80 Spalten
  C948    D1             C                  POP     DE
  C949    D9             C                  EXX
'System-Kommandos'	MACRO-80 3.44	09-Dec-81	PAGE	1-35


  C94A    CD C995        C      S1.MEA11:   CALL    S1.HXN1             ;Puffer fuellen
  C94D    06 10          C                  LD      B,16
  C94F    CD C9E4        C      S1.MEA12:   CALL    S1.MEAU2
  C952    E1             C      S1.MEA13:   POP     HL
  C953    D5             C                  PUSH    DE
  C954    EB             C                  EX      DE,HL               ;Puffer ===> BWSA
  C955    CD CF45        C                  CALL    MO.BWSE
  C958    23             C                  INC     HL
  C959    01 0050        C                  LD      BC,80
  C95C    ED B0          C                  LDIR
  C95E    EB             C                  EX      DE,HL
  C95F    D1             C                  POP     DE
  C960    E5             C                  PUSH    HL
  C961    D9             C                  EXX
  C962    C5             C                  PUSH    BC                  ;Anzahl noch anzuzeigender Byte
  C963    D1             C                  POP     DE
  C964    78             C                  LD      A,B
  C965    B1             C                  OR      C
  C966    28 28          C                  JR      Z,S1.MEA14          ;alle Byte angezeigt
  C968    D9             C                  EXX
  C969    3A B193        C                  LD      A,(MS.SPANZ)        ;naechste Zeile aufbereiten
  C96C    FE 50          C                  CP      80
  C96E    28 DA          C                  JR      Z,S1.MEA11
  C970    3A B240        C                  LD      A,(TS.UMERK)
  C973    B7             C                  OR      A
  C974    28 0B          C                  JR      Z,S1.MEA21
  C976    18 11          C                  JR      S1.MEA31
                         C      
  C978    3A B240        C      S1.MEA5:    LD      A,(TS.UMERK)        ;BWS < 80 Spalten
  C97B    B7             C                  OR      A
  C97C    20 08          C                  JR      NZ,S1.MEA6
  C97E    C5             C                  PUSH    BC                  ;BWS < 80 Spalten, INS_MOD aus
  C97F    D1             C                  POP     DE
  C980    D9             C                  EXX
  C981    CD C995        C      S1.MEA21:   CALL    S1.HXN1
  C984    18 CC          C                  JR      S1.MEA13
                         C      
  C986    D5             C      S1.MEA6:    PUSH    DE                  ;BWS < 80 Spalten, INS_MOD ein
  C987    C1             C                  POP     BC
  C988    D9             C                  EXX
  C989    CD C9B0        C      S1.MEA31:   CALL    S1.PULOE
  C98C    06 20          C                  LD      B,32
  C98E    18 BF          C                  JR      S1.MEA12
                         C      
  C990    E1             C      S1.MEA14:   POP     HL
  C991    CD F5CF        C                  CALL    S0.BWSUS            ;BWSA ===> BWS
  C994    C9             C                  RET
                         C      
  C995    CD CF45        C      S1.HXN1:    CALL    MO.BWSE
  C998    23             C                  INC     HL
  C999    D5             C                  PUSH    DE                  ;(S2.DMANF)
  C99A    CD C9B0        C                  CALL    S1.PULOE
  C99D    7A             C                  LD      A,D                 ;Zeilenadresse aufbereiten
  C99E    CD C5FF        C                  CALL    S1.BHKON
  C9A1    7B             C                  LD      A,E
  C9A2    CD C5FF        C                  CALL    S1.BHKON
  C9A5    23             C                  INC     HL
  C9A6    23             C                  INC     HL
  C9A7    CD C9BF        C                  CALL    S1.MEAU1
  C9AA    D1             C                  POP     DE                  ;(S2.DMANF)
  C9AB    D9             C                  EXX
  C9AC    D5             C                  PUSH    DE                  ;Anzahl Byte erneut bereitstellen
  C9AD    C1             C                  POP     BC
  C9AE    D9             C                  EXX
  C9AF    C9             C                  RET
                         C      
  C9B0    E5             C      S1.PULOE:   PUSH    HL
  C9B1    D5             C                  PUSH    DE
  C9B2    E5             C                  PUSH    HL                  ;Puffer loeschen
  C9B3    D1             C                  POP     DE
  C9B4    13             C                  INC     DE
  C9B5    01 004F        C                  LD      BC,79
  C9B8    36 20          C                  LD      (HL),' '
  C9BA    ED B0          C                  LDIR
  C9BC    D1             C                  POP     DE                  ;(S2.DMANF)
  C9BD    E1             C                  POP     HL                  ;Pufferanfangsadresse
  C9BE    C9             C                  RET
                         C      
                         C                  PAGE
'System-Kommandos'	MACRO-80 3.44	09-Dec-81	PAGE	1-36


                         C      
                         C      ;****************************************************************
                         C      ;*               Hexadezimale Darstellung                       *
                         C      ;****************************************************************
  C9BF    06 04          C      S1.MEAU1:   LD      B,4                 ;vier Vierergruppen aufbereiten
  C9C1    C5             C      S1.MEA2:    PUSH    BC
  C9C2    06 04          C                  LD      B,4
  C9C4    1A             C      S1.MEA3:    LD      A,(DE)              ;Vierergruppe
  C9C5    CD C5FF        C                  CALL    S1.BHKON
  C9C8    CD C9FB        C                  CALL    S1.INC1
  C9CB    28 0F          C                  JR      Z,S1.MEA4
  C9CD    D9             C                  EXX
  C9CE    10 F4          C                  DJNZ    S1.MEA3             ;naechstes Byte
  C9D0    23             C                  INC     HL
  C9D1    C1             C                  POP     BC
  C9D2    10 ED          C                  DJNZ    S1.MEA2             ;naechste  Vierergruppe
  C9D4    C9             C                  RET
                         C      
  C9D5    C5             C      S1.MEA32:   PUSH    BC
  C9D6    06 04          C                  LD      B,4
  C9D8    23             C      S1.MEA33:   INC     HL
  C9D9    23             C                  INC     HL
  C9DA    23             C                  INC     HL
  C9DB    D9             C                  EXX
  C9DC    D9             C      S1.MEA4:    EXX
  C9DD    10 F9          C                  DJNZ    S1.MEA33
  C9DF    23             C                  INC     HL
  C9E0    C1             C                  POP     BC                  ;Vierergruppenzaehler
  C9E1    10 F2          C                  DJNZ    S1.MEA32
  C9E3    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*               A S C II - Darstellung                         *
                         C      ;****************************************************************
  C9E4    1A             C      S1.MEAU2:   LD      A,(DE)
  C9E5    FE 20          C                  CP      ' '
  C9E7    38 04          C                  JR      C,S1.MEA7
  C9E9    FE 7E          C                  CP      '~'
  C9EB    38 02          C                  JR      C,S1.MEA9
  C9ED    3E 2E          C      S1.MEA7:    LD      A,'.'
  C9EF    77             C      S1.MEA9:    LD      (HL),A
  C9F0    CD C9FB        C                  CALL    S1.INC1
  C9F3    28 04          C                  JR      Z,S1.MEA8
  C9F5    D9             C                  EXX
  C9F6    10 EC          C                  DJNZ    S1.MEAU2            ;naechstes Byte
  C9F8    C9             C                  RET
                         C      
  C9F9    D9             C      S1.MEA8:    EXX
  C9FA    C9             C                  RET
                         C      
                         C      
  C9FB    23             C      S1.INC1:    INC     HL
  C9FC    13             C                  INC     DE
  C9FD    D9             C                  EXX
  C9FE    0B             C      S1.INC2:    DEC     BC
  C9FF    78             C                  LD      A,B
  CA00    B1             C                  OR      C
  CA01    C9             C                  RET
                         C      
                         C                  PAGE
'System-Kommandos'	MACRO-80 3.44	09-Dec-81	PAGE	1-37


                         C      
                         C      ;****************************************************************
                         C      ;*               Hard-COPY - Routine fuer  M E M O              *
                         C      ;****************************************************************
  CA02    CD CA08        C      S1.HCDB0:   CALL    S1.HCDB
  CA05    C3 C877        C                  JP      S1.POSDB            ;naechste Seite anzeigen
                         C      
  CA08    DD E5          C      S1.HCDB:    PUSH    IX
  CA0A    FD E5          C                  PUSH    IY
  CA0C    3A B240        C                  LD      A,(TS.UMERK)
  CA0F    B7             C                  OR      A
  CA10    28 07          C                  JR      Z,S1.HCDB1
  CA12    AF             C                  XOR     A
  CA13    32 B240        C                  LD      (TS.UMERK),A
  CA16    CD C825        C                  CALL    S1.ANZUM
  CA19    DD 2A B292     C      S1.HCDB1:   LD      IX,(S2.DMANF)       ;Anzeigeanfangsadresse
  CA1D    FD 2A B194     C                  LD      IY,(MS.BWSA)
  CA21    FD 23          C                  INC     IY
  CA23    06 10          C                  LD      B,16                ;Anzahl Zeilen
  CA25    C5             C      S1.HCDB2:   PUSH    BC                  ;Zyklus ueber 16 Zeilen
  CA26    06 3A          C                  LD      B,58                ;Zeilenanfadr und Hex-Darstellung
  CA28    FD 7E 00       C      S1.HCDB3:   LD      A,(IY)              ;uebernehmen
  CA2B    FD 23          C                  INC     IY
  CA2D    4F             C                  LD      C,A
  CA2E    CD F55F        C                  CALL    SM.PRIO             ;ein Zeichen drucken
  CA31    10 F5          C                  DJNZ    S1.HCDB3               ;naechstes Zeichen
  CA33    06 10          C                  LD      B,16                ;ASCII-Darstellung uebernehmen
  CA35    DD 7E 00       C      S1.HCDB4:   LD      A,(IX)
  CA38    DD 23          C                  INC     IX
  CA3A    FE 7F          C                  CP      7FH
  CA3C    30 04          C                  JR      NC,S1.HCDB5
  CA3E    FE 20          C                  CP      ' '
  CA40    30 02          C                  JR      NC,S1.HCDB6
  CA42    3E 2E          C      S1.HCDB5:   LD      A,'.'
  CA44    4F             C      S1.HCDB6:   LD      C,A
  CA45    CD F55F        C                  CALL    SM.PRIO             ;ASCII-Zeichen drucken
  CA48    10 EB          C                  DJNZ    S1.HCDB4            ;naechstes Zeichen
  CA4A    0E 1E          C                  LD      C,1EH               ;Zeilenende ausgeben
  CA4C    CD F55F        C                  CALL    SM.PRIO
  CA4F    06 16          C                  LD      B,22                ;IY korrigieren
  CA51    FD 23          C      S1.HCDB7:   INC     IY
  CA53    10 FC          C                  DJNZ    S1.HCDB7
  CA55    C1             C                  POP     BC
  CA56    10 CD          C                  DJNZ    S1.HCDB2               ;naechste Zeile
  CA58    0E 1E          C                  LD      C,1EH               ;zwei Leerzeilen ausgeben
  CA5A    CD F55F        C                  CALL    SM.PRIO
  CA5D    CD F55F        C                  CALL    SM.PRIO
  CA60    FD E1          C                  POP     IY
  CA62    DD E1          C                  POP     IX
  CA64    C9             C                  RET
                         C      
  CA65                   C      S1.OPEN     EQU     $
  CA65                   C      S1.CLOS     EQU     $
  CA65                   C      S1.LESV     EQU     $
  CA65                   C      S1.LESR     EQU     $
  CA65                   C      S1.SCHR     EQU     $
  CA65    C9             C                  RET
                         C      
                         C      ;           END
                         C      ;           PN      S310
                         C                  TITLE   'Generierprogramm fuer die E-/A-Tabelle'
                         C                  PAGE
'Generierprogramm fuer die E-/A-Tabelle'	MACRO-80 3.44	09-Dec-81	PAGE	1-38


                         C      
                         C      ;****************************************************************
                         C      ;*               Generierprogramm fuer die E-/A-Tabelle         *
                         C      ;*  Version      -----------------------------------------------*
                         C      ;*               Programmierer: M. Herbote --- K EAW  ZFT (WFT) *
                         C      ;*  V 2 . 1      -----------------------------------------------*
                         C      ;*               Stand        : 27.Januar 1984                  *
                         C      ;****************************************************************
                         C      
                         C      
                         C      ;****************************************************************
                         C      ;*               Macro zu Erzeugung des Steuervektors nach      *
                         C      ;*               ROBOTRON - MOS                                 *
                         C      ;****************************************************************
                         C      S3.RMOS     MACRO   SB,FB,BA,SA,CMD,ENTRY,PUADR,PULAE,INF1,INF2
                         C                  DB      SB                  ;Statusbyte
                         C                  DB      FB                  ;Fehlerbyte
                         C                  DB      BA                  ;Basisadresse
                         C                  DB      SA                  ;Subadresse
                         C                  DB      CMD                 ;Kommando
                         C                  DW      ENTRY               ;Rueckehradresse
                         C                  DW      PUADR               ;Pufferadresse
                         C                  DB      HIGH(PULAE)         ;Pufferlaenge
                         C                  DB      LOW(PULAE)
                         C                  DB      INF1                ;Informationsbyte 1
                         C                  DB      INF2                ;Informationsbyte 2
                         C                  ENDM
                         C      
                         C      ;****************************************************************
                         C      ;*               allgemeine Speicherplaetze der statischen      *
                         C      ;*               E-/A-Tabelle                                   *
                         C      ;****************************************************************
  CA66                   C      S3.SEAT     EQU     $
  CA66    AA             C      S3.MASK1:   DB      0AAH                ;Systemmaske 1
  CA67    55             C      S3.MASK2:   DB      055H                ;Systemmaske 2
  CA68    FF             C      S3.MASK3:   DB      0FFH                ;Systemmaske 3
  CA69    00             C      S3.MASK4:   DB      000H                ;Systemmaske 4
                         C      
  CA6A    3232           C      S3.DATUM:   DW      S0.D1               ;Stand des Systems
  CA6C    3330           C                  DW      S0.D2
  CA6E    3538           C                  DW      S0.D3
                         C      
  CA70    BBF0           C      S3.PUFA:    DW      S0.PFFA             ;Adresse des Ausgabepuffers
  CA72    B7E0           C      S3.PUFI:    DW      S0.PFFI             ;Adresse des Eingabepuffers
  CA74    0400           C      S3.LANG:    DW      1024                ;Pufferlaenge
                         C      
  CA76    00             C                  DB      0
  CA77    00             C                  DB      0
  CA78    00             C      S3.STI:     DB      0
                         C      
                         C                  TITLE   'Kanal - Tabellen'
                         C                  PAGE
'Kanal - Tabellen'	MACRO-80 3.44	09-Dec-81	PAGE	1-39


                         C      
                         C      ;****************************************************************
                         C      ;*               K a s s e t t e 1                              *
                         C      ;****************************************************************
  CA79    1A             C      S3.KS1:     DB      S3.KS2-S3.KS1       ;Laengenbyte
  CA7A    C0             C                  DB      11000000B           ;Typ - Kennsatz ja , SYS-Geraet
  CA7B    C1             C                  DB      11000001B           ;Geraetebyte
                         C                  S3.RMOS 0,0,S0.AKB,1,0,0,S0.PFFI,100H,0,0
  CA7C    00             C+                 DB      0                  ;Statusbyte
  CA7D    00             C+                 DB      0                  ;Fehlerbyte
  CA7E    30             C+                 DB      S0.AKB                  ;Basisadresse
  CA7F    01             C+                 DB      1                  ;Subadresse
  CA80    00             C+                 DB      0                 ;Kommando
  CA81    0000           C+                 DW      0               ;Rueckehradresse
  CA83    B7E0           C+                 DW      S0.PFFI               ;Pufferadresse
  CA85    01             C+                 DB      HIGH(100H)         ;Pufferlaenge
  CA86    00             C+                 DB      LOW(100H)
  CA87    00             C+                 DB      0                ;Informationsbyte 1
  CA88    00             C+                 DB      0                ;Informationsbyte 2
  CA89    0000           C                  DW      0                   ;OPEN
  CA8B    0000           C                  DW      0                   ;CLOSE
  CA8D    0000           C                  DW      0                   ;READ
  CA8F    0000           C                  DW      0                   ;WRITE
  CA91    0000           C                  DW      0                   ;KONV
                         C      ;****************************************************************
                         C      ;*               K a s s e t t e 2                              *
                         C      ;****************************************************************
  CA93    1A             C      S3.KS2:     DB      S3.DFU-S3.KS2       ;Laengenbyte
  CA94    80             C                  DB      10000000B           ;Typ - Kennsatz ja
  CA95    C1             C                  DB      11000001B           ;Geraetebyte
                         C                  S3.RMOS 0,0,S0.AKB,2,0,0,S0.PFFI,100H,0,0
  CA96    00             C+                 DB      0                  ;Statusbyte
  CA97    00             C+                 DB      0                  ;Fehlerbyte
  CA98    30             C+                 DB      S0.AKB                  ;Basisadresse
  CA99    02             C+                 DB      2                  ;Subadresse
  CA9A    00             C+                 DB      0                 ;Kommando
  CA9B    0000           C+                 DW      0               ;Rueckehradresse
  CA9D    B7E0           C+                 DW      S0.PFFI               ;Pufferadresse
  CA9F    01             C+                 DB      HIGH(100H)         ;Pufferlaenge
  CAA0    00             C+                 DB      LOW(100H)
  CAA1    00             C+                 DB      0                ;Informationsbyte 1
  CAA2    00             C+                 DB      0                ;Informationsbyte 2
  CAA3    0000           C                  DW      0                   ;OPEN
  CAA5    0000           C                  DW      0                   ;CLOSE
  CAA7    0000           C                  DW      0                   ;READ
  CAA9    0000           C                  DW      0                   ;WRITE
  CAAB    0000           C                  DW      0                   ;KONV
                         C      
                         C                  PAGE
'Kanal - Tabellen'	MACRO-80 3.44	09-Dec-81	PAGE	1-40


                         C      
                         C      ;****************************************************************
                         C      ;*               D F U - Fernuebertragung                       *
                         C      ;****************************************************************
  CAAD    1A             C      S3.DFU:     DB      S3.LBL-S3.DFU       ;Laengenbyte
  CAAE    80             C                  DB      10000000B           ;Typ - Kennsatz ja
  CAAF    C0             C                  DB      11000000B           ;Geraetebyte
                         C                  S3.RMOS 0,0,S0.V24,0,0,0,S0.PFFI,400H,0,0
  CAB0    00             C+                 DB      0                  ;Statusbyte
  CAB1    00             C+                 DB      0                  ;Fehlerbyte
  CAB2    50             C+                 DB      S0.V24                  ;Basisadresse
  CAB3    00             C+                 DB      0                  ;Subadresse
  CAB4    00             C+                 DB      0                 ;Kommando
  CAB5    0000           C+                 DW      0               ;Rueckehradresse
  CAB7    B7E0           C+                 DW      S0.PFFI               ;Pufferadresse
  CAB9    04             C+                 DB      HIGH(400H)         ;Pufferlaenge
  CABA    00             C+                 DB      LOW(400H)
  CABB    00             C+                 DB      0                ;Informationsbyte 1
  CABC    00             C+                 DB      0                ;Informationsbyte 2
  CABD    0000           C                  DW      0                   ;OPEN
  CABF    0000           C                  DW      0                   ;CLOSE
  CAC1    0000           C                  DW      0                   ;READ
  CAC3    0000           C                  DW      0                   ;WRITE
  CAC5    0000           C                  DW      0                   ;KONV
                         C      ;****************************************************************
                         C      ;*               L B - L e s e r                                *
                         C      ;****************************************************************
  CAC7    18             C      S3.LBL:     DB      S3.LBS-S3.LBL       ;Laengenbyte
  CAC8    00             C                  DB      00000000B           ;Typ - Kennsatz nein
  CAC9    40             C                  DB      01000000B           ;Geraetebyte
                         C                  S3.RMOS 0,0,S0.ADA,0,02H,0,S0.PFFI,400H,7FH,19H
  CACA    00             C+                 DB      0                  ;Statusbyte
  CACB    00             C+                 DB      0                  ;Fehlerbyte
  CACC    00             C+                 DB      S0.ADA                  ;Basisadresse
  CACD    00             C+                 DB      0                  ;Subadresse
  CACE    02             C+                 DB      02H                 ;Kommando
  CACF    0000           C+                 DW      0               ;Rueckehradresse
  CAD1    B7E0           C+                 DW      S0.PFFI               ;Pufferadresse
  CAD3    04             C+                 DB      HIGH(400H)         ;Pufferlaenge
  CAD4    00             C+                 DB      LOW(400H)
  CAD5    7F             C+                 DB      7FH                ;Informationsbyte 1
  CAD6    19             C+                 DB      19H                ;Informationsbyte 2
  CAD7    0000           C                  DW      0                   ;OPEN
  CAD9    0000           C                  DW      0                   ;CLOSE
  CADB    0000           C                  DW      0                   ;READ
  CADD    0000           C                  DW      0                   ;KONV
                         C      ;****************************************************************
                         C      ;*               L B - S t a n z e r                            *
                         C      ;****************************************************************
  CADF    18             C      S3.LBS:     DB      S3.PRIN-S3.LBS      ;Laengenbyte
  CAE0    00             C                  DB      00000000B           ;Typ - Kennsatz nein
  CAE1    80             C                  DB      10000000B           ;Geraetebyte
                         C                  S3.RMOS 0,0,S0.ADA,0,0,0,S0.PFFA,400H,80H,19H
  CAE2    00             C+                 DB      0                  ;Statusbyte
  CAE3    00             C+                 DB      0                  ;Fehlerbyte
  CAE4    00             C+                 DB      S0.ADA                  ;Basisadresse
  CAE5    00             C+                 DB      0                  ;Subadresse
  CAE6    00             C+                 DB      0                 ;Kommando
  CAE7    0000           C+                 DW      0               ;Rueckehradresse
  CAE9    BBF0           C+                 DW      S0.PFFA               ;Pufferadresse
  CAEB    04             C+                 DB      HIGH(400H)         ;Pufferlaenge
  CAEC    00             C+                 DB      LOW(400H)
  CAED    80             C+                 DB      80H                ;Informationsbyte 1
  CAEE    19             C+                 DB      19H                ;Informationsbyte 2
  CAEF    0000           C                  DW      0                   ;OPEN
  CAF1    0000           C                  DW      0                   ;CLOSE
  CAF3    0000           C                  DW      0                   ;WRITE
  CAF5    0000           C                  DW      0                   ;KONV
                         C      ;****************************************************************
                         C      ;*               P R I N - Drucker                              *
                         C      ;****************************************************************
  CAF7    18             C      S3.PRIN:    DB      S3.ENDEA-S3.PRIN    ;Laengenbyte
  CAF8    00             C                  DB      00000000B           ;Typ - Kennsatz nein
  CAF9    81             C                  DB      10000001B           ;Geraetebyte
                         C                  S3.RMOS 0,0,S0.DRU,S0.IVSYS,0,0,S0.PFFA,400H,0,0
  CAFA    00             C+                 DB      0                  ;Statusbyte
  CAFB    00             C+                 DB      0                  ;Fehlerbyte
  CAFC    40             C+                 DB      S0.DRU                  ;Basisadresse
  CAFD    58             C+                 DB      S0.IVSYS                  ;Subadresse
  CAFE    00             C+                 DB      0                 ;Kommando
  CAFF    0000           C+                 DW      0               ;Rueckehradresse
  CB01    BBF0           C+                 DW      S0.PFFA               ;Pufferadresse
'Kanal - Tabellen'	MACRO-80 3.44	09-Dec-81	PAGE	1-41


  CB03    04             C+                 DB      HIGH(400H)         ;Pufferlaenge
  CB04    00             C+                 DB      LOW(400H)
  CB05    00             C+                 DB      0                ;Informationsbyte 1
  CB06    00             C+                 DB      0                ;Informationsbyte 2
  CB07    F54B           C                  DW      SM.MRES             ;OPEN
  CB09    0000           C                  DW      0                   ;CLOSE
  CB0B    F55F           C                  DW      SM.PRIO             ;WRITE
  CB0D    0000           C                  DW      0                   ;KONV
                         C      
  CB0F    00             C      S3.ENDEA:   DB      0                   ;Ende - Kanaltabellen
                         C      
                         C                  PAGE
'Kanal - Tabellen'	MACRO-80 3.44	09-Dec-81	PAGE	1-42


                         C      
                         C      ;****************************************************************
                         C      ;*               K S K         Kennsatz-Section Kassette        *
                         C      ;****************************************************************
  CB10                   C      S3.KSK1     EQU     $                   ;Kassettengeraet 1
                         C      
  CB10                   C      S3.RCZ1     EQU     S3.KSK1             ;record counter
  CB12                   C      S3.BLK1     EQU     S3.RCZ1+2           ;block  counter
  CB14                   C      S3.MRP1     EQU     S3.BLK1+2           ;MRES - Parameterbereich
                         C      
                         C      
                         C      
  CB34                   C      S3.KSK2     EQU     S3.MRP1+32          ;Kassettengeraet 2
                         C      
  CB34                   C      S3.RCZ2     EQU     S3.KSK2             ;record counter
  CB36                   C      S3.BLK2     EQU     S3.RCZ2+2           ;block  counter
  CB38                   C      S3.MRP2     EQU     S3.BLK2+2           ;MRES - Parameterbereich
                         C      
                         C      
                         C      ;           END
                         C      ;           PN      MO26
                         C                  TITLE   'Monitorroutine'
                         C                  PAGE
'Monitorroutine'	MACRO-80 3.44	09-Dec-81	PAGE	1-43


                         C      
                         C      ;****************************************************************
                         C      ;*               Monitorroutine                                 *
                         C      ;*  Version      -----------------------------------------------*
                         C      ;*               Programmierer: M. Herbote --- K EAW  ZFT (WFT) *
                         C      ;*  V 2 . 1      -----------------------------------------------*
                         C      ;*               Stand        : 05.April 1984                   *
                         C      ;****************************************************************
                         C      
                         C      
                         C      ;****************************************************************
                         C      ;*                1.Aufteilung des Monitorbildes                *
                         C      ;*                ------------------------------                *
                         C      ;*   1         a       i   k         b                   m      *
                         C      ;*   -----------------------------------------------------      *
                         C      ;* 1 !A       !       SSA LSA         !                  !      *
                         C      ;*   !                                                   !      *
                         C      ;*   !- - - - ! - - - - - - - - - - - ! - - - - - - - - -!      *
                         C      ;* c !         AF    SSAF LSAF                           !      *
                         C      ;*   !        !                       !                  !      *
                         C      ;*   !                                                   !      *
                         C      ;* j !SZA     !SZAF    S              !                  !      *
                         C      ;*   !                                                   !      *
                         C      ;* l !LZA     !LZAF        L          !                  !      *
                         C      ;*   !                                                   !      *
                         C      ;*   !        !                       !                  !      *
                         C      ;* d !                                                   !      *
                         C      ;*   !- - - - ! - - - - - - - - - - - ! - - - - - - - - -!      *
                         C      ;*   !                                                   !      *
                         C      ;* n !        !                       !                  !      *
                         C      ;*   -----------------------------------------------------      *
                         C      ;*                                                              *
                         C      ;*                2.Kommandos und ihre Bedeutung                *
                         C      ;*                ------------------------------                *
                         C      ;*    Schreibposition          !   Leseposition                 *
                         C      ;*  ---------------------------!------------------------------  *
                         C      ;*  = 10 ZPOS,SPOS:=HL         ! = 30 ZPOL,SPOL:=HL             *
                         C      ;*  = 11 HL:=ZPOS,SPOS         ! = 31 HL:=ZPOL,SPOL             *
                         C      ;*  = 12 HL:=SZA               ! = 32 HL:=LZA                   *
                         C      ;*  = 13 HL:=SZAF              ! = 33 HL:=LZAF                  *
                         C      ;*  = 14 HL:=SSA               ! = 34 HL:=LSA                   *
                         C      ;*  = 15 HL:=SSAF              ! = 35 HL:=LSAF                  *
                         C      ;*  = 20 Zeichen schreiben     ! = 40 Zeichen lesen             *
                         C      ;*  = 21 akt. Position + 1     ! = 41 akt. Position + 1         *
                         C      ;*  = 22 HOME-Fkt. Schreibpos. ! = 42 HOME-Fkt. Lesepos.        *
                         C      ;*  = 23 n. Zeile Anf. "       ! = 43 n. Zeile Anf. "           *
                         C      ;*  = 24 Vektor schreiben      ! = 44 Vektor lesen              *
                         C      ;*                                                              *
                         C      ;*                                                              *
                         C      ;*                                                              *
                         C      ;*                                                              *
                         C      ;****************************************************************
                         C      
                         C                  PAGE
'Monitorroutine'	MACRO-80 3.44	09-Dec-81	PAGE	1-44


                         C      
                         C      ;****************************************************************
                         C      ;*  =  0 ZANZ:=24,SPANZ:=80                                     *
                         C      ;*  =  1 ZMIN,SMIN:=1,ZMAX,SMAX:=ZANZ,SPANZ                     *
                         C      ;*  =  2 ZMIN,SMIN:=1,ZMAX:=ZANZ-2,SMAX:=SPANZ                  *
                         C      ;*  =  3 ZMIN,ZMAX:=SYSZ,SMIN:=3,SMAX:=16                       *
                         C      ;*  =  4 gesamtes Bild loeschen                                 *
                         C      ;*  =  5 Bildfenster   loeschen                                 *
                         C      ;*  =  6 Cursor setzen                                          *
                         C      ;*  =  7 Cursor loeschen                                        *
                         C      ;*                                                              *
                         C      ;*  = 50 HL:=AF                                                 *
                         C      ;*  = 51 BC:=Laenge Bildspeicher                                *
                         C      ;*  = 52 HL:=Ende   Bildspeicher                                *
                         C      ;*  = 53 Bildfensterinhalt eine Zeile  nach oben                *
                         C      ;*  = 54 Bildfensterinhalt eine Zeile  nach unten               *
                         C      ;*  = 55 Bildfensterinhalt eine Spalte nach links               *
                         C      ;*  = 56 Bildfensterinhalt eine Spalte nach unten               *
                         C      ;*                                                              *
                         C      ;*                3.Bedeutung von  DIRES  und  DIREL            *
                         C      ;*                ----------------------------------            *
                         C      ;*  Bit 7 = 0   Schreib-/Lese-position nicht weiter setzen      *
                         C      ;*        = 1   Schreib-/Lese-position       weiter setzen      *
                         C      ;*      6 = 0   Schreib-/Lese-position umlaufend auf Zeile      *
                         C      ;*        = 1   Schreib-/Lese-position umlaufend im Bild        *
                         C      ;*      5 = 0   Rollfunktion ausgeschaltet  (nur DIRES)         *
                         C      ;*        = 1   Rollfunktion eingeschaltet  (nur DIRES)         *
                         C      ;*      4 = 0   Bildfensterinhalt rollen    (nur DIRES)         *
                         C      ;*        = 1   gesamte Zeile     rollen    (nur DIRES)         *
                         C      ;*      3 = 0   mit  Umladen  BWSA ===> BWS                     *
                         C      ;*        = 1   ohne Umladen  BWSA ===> BWS                     *
                         C      ;*                                                              *
                         C      ;*      2,1,0   geben die Richtung an , in welcher die          *
                         C      ;*              Schreib-/Lese-position weitergesetzt werden     *
                         C      ;*              soll                                            *
                         C      ;*                            010                               *
                         C      ;*                        (011) (001)                           *
                         C      ;*                      100         000                         *
                         C      ;*                        (101) (111)                           *
                         C      ;*                            110                               *
                         C      ;*                                                              *
                         C      ;*                                                              *
                         C      ;*                                                              *
                         C      ;****************************************************************
                         C      
                         C                  TITLE   'Eintritt in die Routine'
                         C                  PAGE
'Eintritt in die Routine'	MACRO-80 3.44	09-Dec-81	PAGE	1-45


                         C      
                         C      ;****************************************************************
                         C      ;*               Eintritt in die Monitorroutine und             *
                         C      ;*               Verzweigen zu den einzelnen Kommandos          *
                         C      ;****************************************************************
  CB10    DD E5          C      MO.MONI:    PUSH    IX
  CB12    FD E5          C                  PUSH    IY
  CB14    F5             C                  PUSH    AF
  CB15    D5             C                  PUSH    DE
  CB16    C5             C                  PUSH    BC
  CB17    3A B198        C                  LD      A,(MS.CMD)
  CB1A    FE 39          C                  CP      57
  CB1C    30 16          C                  JR      NC,MO.ENMO
  CB1E    E5             C                  PUSH    HL
  CB1F    87             C                  ADD     A,A
  CB20    06 00          C                  LD      B,0
  CB22    4F             C                  LD      C,A
  CB23    21 CB53        C                  LD      HL,MO.MOTAB
  CB26    09             C                  ADD     HL,BC
  CB27    7E             C                  LD      A,(HL)
  CB28    23             C                  INC     HL
  CB29    66             C                  LD      H,(HL)
  CB2A    6F             C                  LD      L,A
  CB2B    E5             C                  PUSH    HL
  CB2C    DD E1          C                  POP     IX
  CB2E    E1             C                  POP     HL
  CB2F    C1             C                  POP     BC
  CB30    C5             C                  PUSH    BC
  CB31    CD CB3C        C                  CALL    MO.MORT
  CB34    C1             C      MO.ENMO:    POP     BC
  CB35    D1             C                  POP     DE
  CB36    F1             C                  POP     AF
  CB37    FD E1          C                  POP     IY
  CB39    DD E1          C                  POP     IX
  CB3B    C9             C                  RET
  CB3C    DD E9          C      MO.MORT:    JP      (IX)
  CB3E    C9             C      MO.ENMOT:   RET
                         C      
                         C      
  CB3F    3A B197        C      MO.BWSUS:   LD      A,(MS.DIRES)
  CB42    CB 5F          C                  BIT     3,A
  CB44    C0             C                  RET     NZ
  CB45    CD F5CF        C                  CALL    S0.BWSUS
  CB48    C9             C                  RET
                         C      
  CB49    3A B197        C      MO.BWSUZ:   LD      A,(MS.DIRES)
  CB4C    CB 5F          C                  BIT     3,A
  CB4E    C0             C                  RET     NZ
  CB4F    CD F5B1        C                  CALL    S0.BWSUZ
  CB52    C9             C                  RET
                         C      
                         C                  TITLE   'Tabelle der Routinenadressen'
                         C                  PAGE
'Tabelle der Routinenadressen'	MACRO-80 3.44	09-Dec-81	PAGE	1-46


                         C      
                         C      ;****************************************************************
                         C      ;*               Tabelle mit den Adressen der Monitorroutinen   *
                         C      ;****************************************************************
  CB53    CBC5           C      MO.MOTAB:   DW      MO.ANZ              ;CMD = 00
  CB55    CBCF           C                  DW      MO.VOLLB            ;    = 01
  CB57    CBDE           C                  DW      MO.VB2              ;    = 02
  CB59    CBEF           C                  DW      MO.SYSB             ;    = 03
  CB5B    CBFE           C                  DW      MO.BILO             ;    = 04
  CB5D    CC14           C                  DW      MO.FSLO             ;    = 05
  CB5F    CD20           C                  DW      MO.SETC             ;    = 06
  CB61    CD43           C                  DW      MO.RESC             ;    = 07
  CB63    CB3E           C                  DW      MO.ENMOT            ;    = 08
  CB65    CB3E           C                  DW      MO.ENMOT            ;    = 09
  CB67    CF6F           C                  DW      MO.LCPOS            ;    = 10
  CB69    CEF6           C                  DW      MO.CPOS             ;    = 11
  CB6B    CF24           C                  DW      MO.SZA              ;    = 12
  CB6D    CF36           C                  DW      MO.SZAF             ;    = 13
  CB6F    CF00           C                  DW      MO.SSA              ;    = 14
  CB71    CF12           C                  DW      MO.SSAF             ;    = 15
  CB73    CB3E           C                  DW      MO.ENMOT            ;    = 16
  CB75    CB3E           C                  DW      MO.ENMOT            ;    = 17
  CB77    CB3E           C                  DW      MO.ENMOT            ;    = 18
  CB79    CB3E           C                  DW      MO.ENMOT            ;    = 19
  CB7B    CFDB           C                  DW      MO.MZS              ;    = 20
  CB7D    CFE5           C                  DW      MO.MPS              ;    = 21
  CB7F    CFAB           C                  DW      MO.HOMES            ;    = 22
  CB81    CFC5           C                  DW      MO.CNZAS            ;    = 23
  CB83    D101           C                  DW      MO.MVS              ;    = 24
  CB85    CB3E           C                  DW      MO.ENMOT            ;    = 25
  CB87    CB3E           C                  DW      MO.ENMOT            ;    = 26
  CB89    CB3E           C                  DW      MO.ENMOT            ;    = 27
  CB8B    CB3E           C                  DW      MO.ENMOT            ;    = 28
  CB8D    CB3E           C                  DW      MO.ENMOT            ;    = 29
  CB8F    CF8D           C                  DW      MO.LCPOL            ;    = 30
  CB91    CEFB           C                  DW      MO.CPOL             ;    = 31
  CB93    CF2D           C                  DW      MO.LZA              ;    = 32
  CB95    CF3B           C                  DW      MO.LZAF             ;    = 33
  CB97    CF0D           C                  DW      MO.LSA              ;    = 34
  CB99    CF1F           C                  DW      MO.LSAF             ;    = 35
  CB9B    CB3E           C                  DW      MO.ENMOT            ;    = 36
  CB9D    CB3E           C                  DW      MO.ENMOT            ;    = 37
  CB9F    CB3E           C                  DW      MO.ENMOT            ;    = 38
  CBA1    CB3E           C                  DW      MO.ENMOT            ;    = 39
  CBA3    CFED           C                  DW      MO.MZL              ;    = 40
  CBA5    CFF4           C                  DW      MO.MPL              ;    = 41
  CBA7    CFB8           C                  DW      MO.HOMEL            ;    = 42
  CBA9    CFD0           C                  DW      MO.CNZAL            ;    = 43
  CBAB    D11F           C                  DW      MO.MVL              ;    = 44
  CBAD    CB3E           C                  DW      MO.ENMOT            ;    = 45
  CBAF    CB3E           C                  DW      MO.ENMOT            ;    = 46
  CBB1    CB3E           C                  DW      MO.ENMOT            ;    = 47
  CBB3    CB3E           C                  DW      MO.ENMOT            ;    = 48
  CBB5    CB3E           C                  DW      MO.ENMOT            ;    = 49
  CBB7    CF40           C                  DW      MO.BWSAF            ;    = 50
  CBB9    CF5F           C                  DW      MO.BWSL             ;    = 51
  CBBB    CF45           C                  DW      MO.BWSE             ;    = 52
  CBBD    CC52           C                  DW      MO.ROOB             ;    = 53
  CBBF    CC89           C                  DW      MO.ROUN             ;    = 54
  CBC1    CCB4           C                  DW      MO.ROLI             ;    = 55
  CBC3    CCD1           C                  DW      MO.RORE             ;    = 56
                         C      
                         C                  TITLE   'Anfangswert UPs'
                         C                  PAGE
'Anfangswert UPs'	MACRO-80 3.44	09-Dec-81	PAGE	1-47


                         C      
                         C      ;****************************************************************
                         C      ;*               belegen der Steuerwerte  SPANZ  und  ZANZ      *
                         C      ;****************************************************************
  CBC5    E5             C      MO.ANZ:     PUSH    HL
  CBC6    26 50          C                  LD      H,S0.SPANZ
  CBC8    2E 18          C                  LD      L,S0.ZANZ
  CBCA    22 B192        C                  LD      (MS.ZANZ),HL
  CBCD    E1             C                  POP     HL
  CBCE    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*               volles Bild  ===> BWS - Format                 *
                         C      ;****************************************************************
  CBCF    E5             C      MO.VOLLB:   PUSH    HL
  CBD0    21 0101        C                  LD      HL,0101H            ;SMIN=1        ZMIN=1
  CBD3    22 B18E        C                  LD      (MS.ZMIN),HL
  CBD6    2A B192        C                  LD      HL,(MS.ZANZ)        ;SMAX=SPANZ    ZMAX=ZANZ
  CBD9    22 B190        C                  LD      (MS.ZMAX),HL
  CBDC    E1             C                  POP     HL
  CBDD    C9             C                  RET
                         C      
                         C      ;****************************************************************
                         C      ;*               volles Bild minus 2 Zeilen ===> BWS - Format   *
                         C      ;****************************************************************
  CBDE    E5             C      MO.VB2:     PUSH    HL
  CBDF    21 0101        C                  LD      HL,0101H            ;SMIN=1        ZMIN=1
  CBE2    22 B18E        C                  LD      (MS.ZMIN),HL
  CBE5    2A B192        C                  LD      HL,(MS.ZANZ)        ;SMAX=SPANZ    ZMAX=ZANZ-2
  CBE8    2D             C                  DEC     L
  CBE9    2D             C                  DEC     L
  CBEA    22 B190        C                  LD      (MS.ZMAX),HL
  CBED    E1             C                  POP     HL
  CBEE    C9             C                  RET
                         C      
                         C      ;****************************************************************
                         C      ;*               Systemzeile   ===>  BWS - Format               *
                         C      ;****************************************************************
  CBEF    E5             C      MO.SYSB:    PUSH    HL
  CBF0    26 03          C                  LD      H,3                 ;SMIN=3
  CBF2    2E 0B          C                  LD      L,S0.SYSZ           ;ZMIN=SYSZ
  CBF4    22 B18E        C                  LD      (MS.ZMIN),HL
  CBF7    26 18          C                  LD      H,24                ;SMAX=24
  CBF9    22 B190        C                  LD      (MS.ZMAX),HL
  CBFC    E1             C                  POP     HL
  CBFD    C9             C                  RET
                         C      
                         C                  PAGE
'Anfangswert UPs'	MACRO-80 3.44	09-Dec-81	PAGE	1-48


                         C      
                         C      ;****************************************************************
                         C      ;*               gesamtes Bild loeschen                         *
                         C      ;****************************************************************
  CBFE    E5             C      MO.BILO:    PUSH    HL
  CBFF    2A B194        C                  LD      HL,(MS.BWSA)
  CC02    23             C                  INC     HL
  CC03    EB             C                  EX      DE,HL
  CC04    2A B194        C                  LD      HL,(MS.BWSA)
  CC07    CD CF5F        C                  CALL    MO.BWSL
  CC0A    0B             C                  DEC     BC
  CC0B    36 20          C                  LD      (HL),' '
  CC0D    ED B0          C                  LDIR
  CC0F    CD CB3F        C                  CALL    MO.BWSUS
  CC12    E1             C                  POP     HL
  CC13    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*               Bildfenster loeschen                           *
                         C      ;****************************************************************
  CC14    E5             C      MO.FSLO:    PUSH    HL
  CC15    2A B190        C                  LD      HL,(MS.ZMAX)
  CC18    ED 5B B18E     C                  LD      DE,(MS.ZMIN)
  CC1C    AF             C                  XOR     A
  CC1D    ED 52          C                  SBC     HL,DE
  CC1F    45             C                  LD      B,L
  CC20    04             C                  INC     B
  CC21    C5             C                  PUSH    BC                  ;Anzahl Fensterzeilen
  CC22    4C             C                  LD      C,H
  CC23    C5             C                  PUSH    BC                  ;Anzahl Fensterspalten-1
  CC24    CD CF40        C                  CALL    MO.BWSAF
  CC27    E5             C                  PUSH    HL
  CC28    36 20          C                  LD      (HL),' '            ;erste Zeile loeschen
  CC2A    23             C                  INC     HL
  CC2B    EB             C                  EX      DE,HL
  CC2C    E1             C                  POP     HL
  CC2D    E5             C                  PUSH    HL
  CC2E    06 00          C                  LD      B,0
  CC30    ED B0          C                  LDIR
  CC32    E1             C      MO.FSLO1:   POP     HL                  ;weitere Zeilen loeschen
  CC33    D1             C                  POP     DE
  CC34    C1             C                  POP     BC
  CC35    05             C                  DEC     B
  CC36    28 15          C                  JR      Z,MO.FSLO2
  CC38    C5             C                  PUSH    BC
  CC39    D5             C                  PUSH    DE
  CC3A    06 00          C                  LD      B,0
  CC3C    4B             C                  LD      C,E
  CC3D    0C             C                  INC     C
  CC3E    E5             C                  PUSH    HL
  CC3F    3A B193        C                  LD      A,(MS.SPANZ)
  CC42    16 00          C                  LD      D,0
  CC44    5F             C                  LD      E,A
  CC45    19             C                  ADD     HL,DE
  CC46    EB             C                  EX      DE,HL
  CC47    E1             C                  POP     HL
  CC48    D5             C                  PUSH    DE
  CC49    ED B0          C                  LDIR
  CC4B    18 E5          C                  JR      MO.FSLO1
  CC4D    CD CB3F        C      MO.FSLO2:   CALL    MO.BWSUS
  CC50    E1             C                  POP     HL
  CC51    C9             C                  RET
                         C                  TITLE   'Bildfensterinhalt rollen'
                         C                  PAGE
'Bildfensterinhalt rollen'	MACRO-80 3.44	09-Dec-81	PAGE	1-49


                         C      
                         C      ;****************************************************************
                         C      ;*               Bildfensterinhalt um eine Zeile nach oben      *
                         C      ;****************************************************************
  CC52    E5             C      MO.ROOB:    PUSH    HL
  CC53    CD CCF4        C                  CALL    MO.RORL1
  CC56    28 19          C                  JR      Z,MO.ROOB2
  CC58    F5             C                  PUSH    AF
  CC59    CD CF40        C                  CALL    MO.BWSAF            ;DE ermitteln
  CC5C    E5             C      MO.ROOB1:   PUSH    HL
  CC5D    CD CF58        C                  CALL    MO.DESZ             ;HL ermitteln
  CC60    19             C                  ADD     HL,DE
  CC61    D1             C                  POP     DE
  CC62    D5             C                  PUSH    DE
  CC63    CD CD16        C                  CALL    MO.RORL5
  CC66    CD CF58        C                  CALL    MO.DESZ
  CC69    E1             C                  POP     HL
  CC6A    19             C                  ADD     HL,DE
  CC6B    F1             C                  POP     AF
  CC6C    3D             C                  DEC     A
  CC6D    F5             C                  PUSH    AF
  CC6E    20 EC          C                  JR      NZ,MO.ROOB1
  CC70    F1             C                  POP     AF
  CC71    CD CCF8        C      MO.ROOB2:   CALL    MO.RORL7
  CC74    CD CF40        C                  CALL    MO.BWSAF
  CC77    CD CF4C        C                  CALL    MO.PNSP
  CC7A    36 20          C      MO.ROOB3:   LD      (HL),' '
  CC7C    E5             C                  PUSH    HL
  CC7D    D1             C                  POP     DE
  CC7E    13             C                  INC     DE
  CC7F    CD CD04        C                  CALL    MO.RORL3
  CC82    28 03          C                  JR      Z,MO.ROOB4
  CC84    CD CD1A        C                  CALL    MO.RORL6
  CC87    18 C4          C      MO.ROOB4:   JR      MO.FSLO2
                         C      ;****************************************************************
                         C      ;*               Bildfensterinhalt um eine Zeile nach unten     *
                         C      ;****************************************************************
  CC89    E5             C      MO.ROUN:    PUSH    HL
  CC8A    CD CCF4        C                  CALL    MO.RORL1
  CC8D    28 20          C                  JR      Z,MO.ROUN2
  CC8F    F5             C                  PUSH    AF                  ;DE ermitteln
  CC90    CD CF40        C                  CALL    MO.BWSAF
  CC93    CD CF4C        C                  CALL    MO.PNSP
  CC96    E5             C      MO.ROUN1:   PUSH    HL
  CC97    CD CF58        C                  CALL    MO.DESZ             ;HL ermitteln
  CC9A    B7             C                  OR      A
  CC9B    ED 52          C                  SBC     HL,DE
  CC9D    D1             C                  POP     DE
  CC9E    D5             C                  PUSH    DE
  CC9F    CD CD16        C                  CALL    MO.RORL5
  CCA2    CD CF58        C                  CALL    MO.DESZ
  CCA5    E1             C                  POP     HL
  CCA6    B7             C                  OR      A
  CCA7    ED 52          C                  SBC     HL,DE
  CCA9    F1             C                  POP     AF
  CCAA    3D             C                  DEC     A
  CCAB    F5             C                  PUSH    AF
  CCAC    20 E8          C                  JR      NZ,MO.ROUN1
  CCAE    F1             C                  POP     AF
  CCAF    CD CF40        C      MO.ROUN2:   CALL    MO.BWSAF
  CCB2    18 C6          C                  JR      MO.ROOB3
                         C      
                         C                  PAGE
'Bildfensterinhalt rollen'	MACRO-80 3.44	09-Dec-81	PAGE	1-50


                         C      
                         C      ;****************************************************************
                         C      ;*               Bildfensterinhalt um eine Spalte nach links    *
                         C      ;****************************************************************
  CCB4    E5             C      MO.ROLI:    PUSH    HL
  CCB5    CD CCFF        C                  CALL    MO.RORL2
  CCB8    08             C                  EX      AF,AF'              ;'
  CCB9    CD CF40        C                  CALL    MO.BWSAF
  CCBC    C5             C      MO.ROLI1:   PUSH    BC
  CCBD    E5             C                  PUSH    HL
  CCBE    E5             C                  PUSH    HL
  CCBF    D1             C                  POP     DE
  CCC0    23             C                  INC     HL
  CCC1    08             C                  EX      AF,AF'              ;'
  CCC2    B7             C                  OR      A
  CCC3    28 03          C                  JR      Z,MO.ROLI2
  CCC5    CD CD1A        C                  CALL    MO.RORL6
  CCC8    E1             C      MO.ROLI2:   POP     HL
  CCC9    C1             C                  POP     BC
  CCCA    CD CD0B        C                  CALL    MO.RORL4
  CCCD    10 ED          C                  DJNZ    MO.ROLI1
  CCCF    18 B6          C      MO.ROLI3:   JR      MO.ROOB4
                         C      ;****************************************************************
                         C      ;*               Bildfensterinhalt um eine Spalte nach rechts   *
                         C      ;****************************************************************
  CCD1    E5             C      MO.RORE:    PUSH    HL
  CCD2    CD CCFF        C                  CALL    MO.RORL2
  CCD5    CD CF40        C                  CALL    MO.BWSAF
  CCD8    16 00          C                  LD      D,0
  CCDA    5F             C                  LD      E,A
  CCDB    08             C                  EX      AF,AF'              ;'
  CCDC    19             C                  ADD     HL,DE
  CCDD    C5             C      MO.RORE1:   PUSH    BC
  CCDE    E5             C                  PUSH    HL
  CCDF    E5             C                  PUSH    HL
  CCE0    D1             C                  POP     DE
  CCE1    2B             C                  DEC     HL
  CCE2    08             C                  EX      AF,AF'              ;'
  CCE3    B7             C                  OR      A
  CCE4    28 05          C                  JR      Z,MO.RORE2
  CCE6    06 00          C                  LD      B,0
  CCE8    4F             C                  LD      C,A
  CCE9    ED B8          C                  LDDR
  CCEB    E1             C      MO.RORE2:   POP     HL
  CCEC    C1             C                  POP     BC
  CCED    CD CD0B        C                  CALL    MO.RORL4
  CCF0    10 EB          C                  DJNZ    MO.RORE1
  CCF2    18 DB          C                  JR      MO.ROLI3
                         C      
                         C                  PAGE
'Bildfensterinhalt rollen'	MACRO-80 3.44	09-Dec-81	PAGE	1-51


                         C      
  CCF4    DD 21 B18E     C      MO.RORL1:   LD      IX,MS.ZMIN
  CCF8    DD 7E 02       C      MO.RORL7:   LD      A,(IX+2)
  CCFB    DD 96 00       C                  SUB     (IX+0)
  CCFE    C9             C                  RET
                         C      
  CCFF    CD CCF4        C      MO.RORL2:   CALL    MO.RORL1
  CD02    47             C                  LD      B,A
  CD03    04             C                  INC     B
  CD04    DD 7E 03       C      MO.RORL3:   LD      A,(IX+3)
  CD07    DD 96 01       C                  SUB     (IX+1)
  CD0A    C9             C                  RET
                         C      
  CD0B    08             C      MO.RORL4:   EX      AF,AF'              ;'
  CD0C    EB             C                  EX      DE,HL
  CD0D    36 20          C                  LD      (HL),' '
  CD0F    26 00          C                  LD      H,0
  CD11    DD 6E 05       C                  LD      L,(IX+5)
  CD14    19             C                  ADD     HL,DE
  CD15    C9             C                  RET
                         C      
  CD16    CD CD04        C      MO.RORL5:   CALL    MO.RORL3
  CD19    3C             C                  INC     A
  CD1A    06 00          C      MO.RORL6:   LD      B,0
  CD1C    4F             C                  LD      C,A
  CD1D    ED B0          C                  LDIR
  CD1F    C9             C                  RET
                         C      
                         C                  TITLE   'Cursor Operationen'
                         C                  PAGE
'Cursor Operationen'	MACRO-80 3.44	09-Dec-81	PAGE	1-52


                         C      
                         C      ;****************************************************************
                         C      ;*               Cursor setzen bzw. loeschen an der             *
                         C      ;*               aktuellen Schreibposition                      *
                         C      ;****************************************************************
  CD20    E5             C      MO.SETC:    PUSH    HL
  CD21    C5             C                  PUSH    BC
  CD22    F5             C                  PUSH    AF
  CD23    3A B18D        C                  LD      A,(MS.SPOS)         ;X-Koordinate
  CD26    32 CD3D        C                  LD      (MO.SETC1+2),A
  CD29    3A B18C        C                  LD      A,(MS.ZPOS)         ;Y-Koordinate
  CD2C    32 CD3E        C                  LD      (MO.SETC1+3),A
  CD2F    21 CD3B        C                  LD      HL,MO.SETC1         ;Emulator-Routine ansprechen
  CD32    01 0540        C                  LD      BC,00540H
  CD35    ED B3          C                  OTIR
  CD37    F1             C                  POP     AF
  CD38    C1             C                  POP     BC
  CD39    E1             C                  POP     HL
  CD3A    C9             C                  RET
  CD3B    F0             C      MO.SETC1:   DB      0F0H
  CD3C    01             C                  DB      001H                ;Cursor Ein
  CD3D    00             C                  DB      0                   ;X
  CD3E    00             C                  DB      0                   ;Y
  CD3F    FF             C                  DB      0FFH
                         C      
  CD40    CD CEF6        C                  CALL    MO.CPOS
                         C      
                         C      
                         C      
                         C      ;
  CD43    E5             C      MO.RESC:    PUSH    HL
  CD44    C5             C                  PUSH    BC
  CD45    21 CD50        C                  LD      HL,MO.RESC1         ;Emulator-Routine ansprechen
  CD48    01 0340        C                  LD      BC,00340H
  CD4B    ED B3          C                  OTIR
  CD4D    C1             C                  POP     BC
  CD4E    E1             C                  POP     HL
  CD4F    C9             C                  RET
  CD50    F0             C      MO.RESC1:   DB      0F0H
  CD51    02             C                  DB      002H                ;Cursor Aus
  CD52    FF             C                  DB      0FFH            
                         C      ;****************************************************************
                         C      ;*               DZPOS , DSPOS , DZPOL , DSPOL                  *
                         C      ;****************************************************************
  CD53    21 B18A        C      MO.DZPOL:   LD      HL,MS.ZPOL          ;Lesezeilennr.     decr.
  CD56    CD CD70        C                  CALL    MO.DECZ
  CD59    18 06          C                  JR      MO.DIL
  CD5B    21 B18B        C      MO.DSPOL:   LD      HL,MS.SPOL          ;Lesespaltennr.    decr.
  CD5E    CD CD82        C                  CALL    MO.DECS
  CD61    C5             C      MO.DIL:     PUSH    BC
  CD62    CD CEFB        C                  CALL    MO.CPOL
  CD65    C1             C                  POP     BC
  CD66    3F             C                  CCF                         ;Z = CY = 1  falls Uebertrag
  CD67    C9             C                  RET
  CD68    21 B18C        C      MO.DZPOS:   LD      HL,MS.ZPOS          ;Schreibzeilennr.  decr.
  CD6B    CD CD70        C                  CALL    MO.DECZ
  CD6E    18 22          C                  JR      MO.DIS
  CD70    C5             C      MO.DECZ:    PUSH    BC
  CD71    3A B190        C                  LD      A,(MS.ZMAX)
  CD74    47             C                  LD      B,A
  CD75    3A B18E        C                  LD      A,(MS.ZMIN)
  CD78    18 10          C                  JR      MO.DEC2
  CD7A    21 B18D        C      MO.DSPOS:   LD      HL,MS.SPOS          ;Schreibspaltennr. decr.
  CD7D    CD CD82        C                  CALL    MO.DECS
  CD80    18 10          C                  JR      MO.DIS
  CD82    C5             C      MO.DECS:    PUSH    BC
  CD83    3A B191        C                  LD      A,(MS.SMAX)
  CD86    47             C                  LD      B,A
  CD87    3A B18F        C                  LD      A,(MS.SMIN)
  CD8A    3D             C      MO.DEC2:    DEC     A
  CD8B    BE             C                  CP      (HL)
  CD8C    28 15          C                  JR      Z,MO.DEC3           ;Z=1,CY=0 falls Uebertrag
  CD8E    35             C                  DEC     (HL)
  CD8F    C3 CEF4        C                  JP      MO.INC4
  CD92    C5             C      MO.DIS:     PUSH    BC
  CD93    CD CEF6        C                  CALL    MO.CPOS
  CD96    C1             C                  POP     BC
  CD97    3F             C                  CCF                         ;Z = CY = 1  falls Uebertrag
  CD98    C9             C                  RET
  CD99    ED 4B B192     C      MO.ROLL:    LD      BC,(MS.ZANZ)        ;Standardanschlussroutine Rollfkt.
  CD9D    36 20          C      MO.ROL1:    LD      (HL),' '            ;loeschen der Zeile auf blank
  CD9F    23             C                  INC     HL
'Cursor Operationen'	MACRO-80 3.44	09-Dec-81	PAGE	1-53


  CDA0    10 FB          C                  DJNZ    MO.ROL1
  CDA2    C9             C                  RET
                         C                  PAGE
'Cursor Operationen'	MACRO-80 3.44	09-Dec-81	PAGE	1-54


                         C      
  CDA3    F5             C      MO.DEC3:    PUSH    AF                  ;Rollfunktion
  CDA4    C5             C                  PUSH    BC                  ;rollen nach unten raus
  CDA5    D5             C                  PUSH    DE
  CDA6    E5             C                  PUSH    HL
  CDA7    21 B197        C                  LD      HL,MS.DIRES         ;Abfrage , ob Rollen ein
  CDAA    CB 6E          C                  BIT     5,(HL)
  CDAC    28 71          C                  JR      Z,MO.DEC4
  CDAE    CB 66          C                  BIT     4,(HL)
  CDB0    28 74          C                  JR      Z,MO.DEC6
  CDB2    2A B18C        C                  LD      HL,(MS.ZPOS)        ;ZPOS , SPOS retten
  CDB5    E5             C                  PUSH    HL
  CDB6    2A B190        C                  LD      HL,(MS.ZMAX)
  CDB9    25             C                  DEC     H
  CDBA    2D             C                  DEC     L
  CDBB    22 B18C        C                  LD      (MS.ZPOS),HL
  CDBE    CD CF45        C                  CALL    MO.BWSE             ;DE ermitteln
  CDC1    23             C                  INC     HL
  CDC2    EB             C                  EX      DE,HL
  CDC3    CD CF24        C                  CALL    MO.SZA              ;HL ermitteln
  CDC6    ED 4B B193     C                  LD      BC,(MS.SPANZ)       ;BC ermitteln
  CDCA    06 00          C                  LD      B,0
  CDCC    ED B0          C                  LDIR                        ;letzte Zeile retten
                         C      
                         C      
                         C      
  CDCE    CD CF24        C                  CALL    MO.SZA              ;HL ermitteln
  CDD1    2B             C                  DEC     HL
  CDD2    E5             C                  PUSH    HL
  CDD3    CD CF58        C                  CALL    MO.DESZ             ;DE ermitteln
  CDD6    19             C                  ADD     HL,DE
  CDD7    E5             C                  PUSH    HL
  CDD8    2A B18E        C                  LD      HL,(MS.ZMIN)        ;BC ermitteln
  CDDB    3A B190        C                  LD      A,(MS.ZMAX)
  CDDE    95             C                  SUB     L
  CDDF    F5             C                  PUSH    AF
  CDE0    21 0000        C                  LD      HL,0
  CDE3    CD CF4C        C                  CALL    MO.PNSP
  CDE6    F1             C                  POP     AF
  CDE7    E5             C                  PUSH    HL
  CDE8    C1             C                  POP     BC
  CDE9    D1             C                  POP     DE
  CDEA    E1             C                  POP     HL
  CDEB    FE 00          C                  CP      0
  CDED    28 02          C                  JR      Z,MO.DEC5
  CDEF    ED B8          C                  LDDR                        ;Bildfensterzeilen um 1 Zeile nach unten
                         C      
                         C                  PAGE
'Cursor Operationen'	MACRO-80 3.44	09-Dec-81	PAGE	1-55


                         C      
  CDF1    E1             C      MO.DEC5:    POP     HL                  ;rueckspeichern von ZPOS , SPOS
  CDF2    22 B18C        C                  LD      (MS.ZPOS),HL
  CDF5    2A B19A        C                  LD      HL,(MS.RADR)        ;Verzweigen zur Anschlussroutine
  CDF8    E5             C                  PUSH    HL
  CDF9    DD E1          C                  POP     IX
  CDFB    CD CF45        C                  CALL    MO.BWSE             ;Parameter in HL = Adresse der
  CDFE    23             C                  INC     HL                  ;rausgerollten Zeile
  CDFF    CD CB3C        C                  CALL    MO.MORT
                         C      
                         C      
                         C      
  CE02    CD CF45        C                  CALL    MO.BWSE             ;HL ermitteln
  CE05    23             C                  INC     HL
  CE06    E5             C                  PUSH    HL
  CE07    CD CF24        C                  CALL    MO.SZA              ;DE ermitteln
  CE0A    EB             C                  EX      DE,HL
  CE0B    E1             C                  POP     HL
  CE0C    ED 4B B193     C                  LD      BC,(MS.SPANZ)       ;BC ermitteln
  CE10    06 00          C                  LD      B,0
  CE12    ED B0          C                  LDIR                        ;aktuelle Zeile neu belegen
                         C      
                         C      
                         C      
  CE14    CD CB3F        C                  CALL    MO.BWSUS
  CE17    E1             C      MO.DEC7:    POP     HL
  CE18    D1             C                  POP     DE
  CE19    C1             C                  POP     BC
  CE1A    F1             C                  POP     AF
  CE1B    3F             C                  CCF
  CE1C    C3 CEF4        C                  JP      MO.INC4
                         C      
  CE1F    E1             C      MO.DEC4:    POP     HL
  CE20    D1             C                  POP     DE
  CE21    C1             C                  POP     BC
  CE22    F1             C                  POP     AF
  CE23    C3 CEF1        C                  JP      MO.INC3
                         C      
  CE26    CD CC89        C      MO.DEC6:    CALL    MO.ROUN
  CE29    18 EC          C                  JR      MO.DEC7
                         C      
                         C                  PAGE
'Cursor Operationen'	MACRO-80 3.44	09-Dec-81	PAGE	1-56


                         C      
                         C      ;****************************************************************
                         C      ;*                IZPOS , ISPOS , IZPOL , ISPOL                 *
                         C      ;****************************************************************
  CE2B    21 B18A        C      MO.IZPOL:   LD      HL,MS.ZPOL          ;Lesezeilennr.     incr.
  CE2E    CD CE46        C                  CALL    MO.INCZ
  CE31    C3 CD61        C                  JP      MO.DIL
  CE34    21 B18B        C      MO.ISPOL:   LD      HL,MS.SPOL          ;Lesespaltennr.    incr.
  CE37    CD CE59        C                  CALL    MO.INCS
  CE3A    C3 CD61        C                  JP      MO.DIL
  CE3D    21 B18C        C      MO.IZPOS:   LD      HL,MS.ZPOS          ;Schreibzeilennr.  incr.
  CE40    CD CE46        C                  CALL    MO.INCZ
  CE43    C3 CD92        C                  JP      MO.DIS
  CE46    C5             C      MO.INCZ:    PUSH    BC
  CE47    3A B18E        C                  LD      A,(MS.ZMIN)
  CE4A    47             C                  LD      B,A
  CE4B    3A B190        C                  LD      A,(MS.ZMAX)
  CE4E    18 11          C                  JR      MO.INC2
  CE50    21 B18D        C      MO.ISPOS:   LD      HL,MS.SPOS          ;Schreibspaltennr. incr.
  CE53    CD CE59        C                  CALL    MO.INCS
  CE56    C3 CD92        C                  JP      MO.DIS
  CE59    C5             C      MO.INCS:    PUSH    BC
  CE5A    3A B18F        C                  LD      A,(MS.SMIN)
  CE5D    47             C                  LD      B,A
  CE5E    3A B191        C                  LD      A,(MS.SMAX)
  CE61    4F             C      MO.INC2:    LD      C,A
  CE62    7E             C                  LD      A,(HL)
  CE63    3C             C                  INC     A
  CE64    B9             C                  CP      C
  CE65    DA CEF3        C                  JP      C,MO.INC1
  CE68    F5             C                  PUSH    AF                  ;Rollfunktion
  CE69    C5             C                  PUSH    BC                  ;rollen nach oben raus
  CE6A    D5             C                  PUSH    DE
  CE6B    E5             C                  PUSH    HL
  CE6C    21 B197        C                  LD      HL,MS.DIRES         ;Abfrage , ob Rollen ein
  CE6F    CB 6E          C                  BIT     5,(HL)
  CE71    28 7A          C                  JR      Z,MO.INC5
  CE73    CB 66          C                  BIT     4,(HL)
  CE75    28 71          C                  JR      Z,MO.INC7
  CE77    2A B18C        C                  LD      HL,(MS.ZPOS)        ;retten von ZPOS , SPOS
  CE7A    E5             C                  PUSH    HL
  CE7B    2A B18E        C                  LD      HL,(MS.ZMIN)
  CE7E    25             C                  DEC     H
  CE7F    2D             C                  DEC     L
  CE80    22 B18C        C                  LD      (MS.ZPOS),HL
  CE83    CD CF45        C                  CALL    MO.BWSE             ;DE ermitteln
  CE86    23             C                  INC     HL
  CE87    EB             C                  EX      DE,HL
  CE88    2A B194        C                  LD      HL,(MS.BWSA)        ;HL ermitteln
  CE8B    3A B18E        C                  LD      A,(MS.ZMIN)
  CE8E    3D             C                  DEC     A
  CE8F    CD CF4C        C                  CALL    MO.PNSP
  CE92    E5             C                  PUSH    HL
  CE93    ED 4B B193     C                  LD      BC,(MS.SPANZ)       ;BC ermitteln
  CE97    06 00          C                  LD      B,0
  CE99    ED B0          C                  LDIR                        ;erste Zeile retten
                         C      
                         C                  PAGE
'Cursor Operationen'	MACRO-80 3.44	09-Dec-81	PAGE	1-57


                         C      
  CE9B    E1             C                  POP     HL                  ;DE ermitteln
  CE9C    E5             C                  PUSH    HL
  CE9D    CD CF58        C                  CALL    MO.DESZ             ;HL ermitteln
  CEA0    19             C                  ADD     HL,DE
  CEA1    E5             C                  PUSH    HL
  CEA2    2A B18E        C                  LD      HL,(MS.ZMIN)        ;BC ermitteln
  CEA5    3A B190        C                  LD      A,(MS.ZMAX)
  CEA8    95             C                  SUB     L
  CEA9    F5             C                  PUSH    AF
  CEAA    21 0000        C                  LD      HL,0
  CEAD    CD CF4C        C                  CALL    MO.PNSP
  CEB0    F1             C                  POP     AF
  CEB1    E5             C                  PUSH    HL
  CEB2    C1             C                  POP     BC
  CEB3    E1             C                  POP     HL
  CEB4    D1             C                  POP     DE
  CEB5    FE 00          C                  CP      0
  CEB7    28 02          C                  JR      Z,MO.INC6
  CEB9    ED B0          C                  LDIR                        ;Bildfensterzeilen um 1 Zeile nach oben
                         C      
  CEBB    E1             C      MO.INC6:    POP     HL                  ;rueckspeichern von ZPOS , SPOS
  CEBC    22 B18C        C                  LD      (MS.ZPOS),HL
  CEBF    2A B19A        C                  LD      HL,(MS.RADR)        ;Verzweigung zur Anschlussroutine
  CEC2    E5             C                  PUSH    HL
  CEC3    DD E1          C                  POP     IX
  CEC5    CD CF45        C                  CALL    MO.BWSE             ;Parameter in HL = Adresse der
  CEC8    23             C                  INC     HL                  ;rausgerollten Zeile
  CEC9    CD CB3C        C                  CALL    MO.MORT
  CECC    CD CF45        C                  CALL    MO.BWSE             ;HL ermitteln
  CECF    23             C                  INC     HL
  CED0    E5             C                  PUSH    HL
  CED1    CD CF24        C                  CALL    MO.SZA                 ;DE ermitteln
  CED4    EB             C                  EX      DE,HL
  CED5    E1             C                  POP     HL
  CED6    ED 4B B193     C                  LD      BC,(MS.SPANZ)       ;BC ermitteln
  CEDA    06 00          C                  LD      B,0
  CEDC    ED B0          C                  LDIR                        ;aktuelle Zeile belegen
  CEDE    CD CB3F        C                  CALL    MO.BWSUS
  CEE1    E1             C      MO.INC8:    POP     HL
  CEE2    D1             C                  POP     DE
  CEE3    C1             C                  POP     BC
  CEE4    F1             C                  POP     AF
  CEE5    3F             C                  CCF
  CEE6    18 0C          C                  JR      MO.INC4
                         C      
  CEE8    CD CC52        C      MO.INC7:    CALL    MO.ROOB
  CEEB    18 F4          C                  JR      MO.INC8
                         C      
  CEED    E1             C      MO.INC5:    POP     HL
  CEEE    D1             C                  POP     DE
  CEEF    C1             C                  POP     BC
  CEF0    F1             C                  POP     AF
  CEF1    05             C      MO.INC3:    DEC     B
  CEF2    78             C                  LD      A,B
  CEF3    77             C      MO.INC1:    LD      (HL),A
  CEF4    C1             C      MO.INC4:    POP     BC
  CEF5    C9             C                  RET
                         C      
                         C                  PAGE
'Cursor Operationen'	MACRO-80 3.44	09-Dec-81	PAGE	1-58


                         C      
                         C      ;****************************************************************
                         C      ;*               aktuelle Schreib-/Lese- position ==> HL        *
                         C      ;****************************************************************
  CEF6    CD CF00        C      MO.CPOS:    CALL    MO.SSA              ;Schreib-
  CEF9    18 2C          C                  JR      MO.SZA1
                         C      
  CEFB    CD CF0D        C      MO.CPOL:    CALL    MO.LSA              ;Lese-
  CEFE    18 30          C                  JR      MO.LZA1
                         C      ;****************************************************************
                         C      ;*               Spaltenanfang       Schreib-/Lese- position    *
                         C      ;****************************************************************
  CF00    2A B18D        C      MO.SSA:     LD      HL,(MS.SPOS)        ;Schreib-
  CF03    26 00          C      MO.SSA1:    LD      H,0
  CF05    F5             C                  PUSH    AF
  CF06    ED 5B B194     C                  LD      DE,(MS.BWSA)
  CF0A    19             C                  ADD     HL,DE
  CF0B    F1             C                  POP     AF
  CF0C    C9             C                  RET
                         C      
  CF0D    2A B18B        C      MO.LSA:     LD      HL,(MS.SPOL)        ;Lese-
  CF10    18 F1          C                  JR      MO.SSA1
                         C      ;****************************************************************
                         C      ;*               Formatspaltenanfang Schreib-/Lese- position    *
                         C      ;****************************************************************
  CF12    CD CF00        C      MO.SSAF:    CALL    MO.SSA              ;Schreib-
  CF15    F5             C      MO.SSAF1:   PUSH    AF
  CF16    3A B18E        C                  LD      A,(MS.ZMIN)
  CF19    3D             C                  DEC     A
  CF1A    CD CF4C        C      MO.SSAF2:   CALL    MO.PNSP
  CF1D    F1             C                  POP     AF
  CF1E    C9             C                  RET
                         C      
  CF1F    CD CF0D        C      MO.LSAF:    CALL    MO.LSA              ;Lese-
  CF22    18 F1          C                  JR      MO.SSAF1
                         C      ;****************************************************************
                         C      ;*               Zeilenanfang        Schreib-/Lese- position    *
                         C      ;****************************************************************
  CF24    2A B194        C      MO.SZA:     LD      HL,(MS.BWSA)        ;Schreib-
  CF27    F5             C      MO.SZA1:    PUSH    AF
  CF28    3A B18C        C                  LD      A,(MS.ZPOS)
  CF2B    18 ED          C                  JR      MO.SSAF2
                         C      
  CF2D    2A B194        C      MO.LZA:     LD      HL,(MS.BWSA)        ;Lese-
  CF30    F5             C      MO.LZA1:    PUSH    AF
  CF31    3A B18A        C                  LD      A,(MS.ZPOL)
  CF34    18 E4          C                  JR      MO.SSAF2
                         C      ;****************************************************************
                         C      ;*               Formatzeilenanfang  Schreib-/Lese- position    *
                         C      ;****************************************************************
  CF36    CD CF69        C      MO.SZAF:    CALL    MO.POSA             ;Schreib-
  CF39    18 EC          C                  JR      MO.SZA1
                         C      
  CF3B    CD CF69        C      MO.LZAF:    CALL    MO.POSA             ;Lese-
  CF3E    18 F0          C                  JR      MO.LZA1
                         C      
                         C                  PAGE
'Cursor Operationen'	MACRO-80 3.44	09-Dec-81	PAGE	1-59


                         C      
                         C      ;****************************************************************
                         C      ;*               Formatanfang BWS                               *
                         C      ;****************************************************************
  CF40    CD CF69        C      MO.BWSAF:   CALL    MO.POSA
  CF43    18 D0          C                  JR      MO.SSAF1
                         C      
                         C      ;****************************************************************
                         C      ;*               Ende         BWS                               *
                         C      ;****************************************************************
  CF45    2A B194        C      MO.BWSE:    LD      HL,(MS.BWSA)
  CF48    2B             C                  DEC     HL
  CF49    3A B192        C      MO.ADDBL:   LD      A,(MS.ZANZ)         ;HL=HL+BWSL
  CF4C    B7             C      MO.PNSP:    OR      A                   ;HL:=HL+A*(SPANZ)
  CF4D    C8             C                  RET     Z
  CF4E    D5             C                  PUSH    DE
  CF4F    CD CF58        C                  CALL    MO.DESZ
  CF52    19             C      MO.PNSP1:   ADD     HL,DE
  CF53    3D             C                  DEC     A
  CF54    20 FC          C                  JR      NZ,MO.PNSP1
  CF56    D1             C                  POP     DE
  CF57    C9             C                  RET
                         C      
  CF58    ED 5B B193     C      MO.DESZ:    LD      DE,(MS.SPANZ)       ;DE:=Spaltenanzahl
  CF5C    16 00          C                  LD      D,0
  CF5E    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*               Laenge       BWS                               *
                         C      ;****************************************************************
  CF5F    E5             C      MO.BWSL:    PUSH    HL
  CF60    21 0000        C                  LD      HL,0
  CF63    CD CF49        C                  CALL    MO.ADDBL
  CF66    E3             C                  EX      (SP),HL
  CF67    C1             C                  POP     BC                  ;BC=BWSL  A=0
  CF68    C9             C                  RET                         ;HL,DE unveraendert
                         C      
  CF69    2A B18F        C      MO.POSA:    LD      HL,(MS.SMIN)
  CF6C    2D             C                  DEC     L
  CF6D    18 94          C                  JR      MO.SSA1
                         C      
                         C                  PAGE
'Cursor Operationen'	MACRO-80 3.44	09-Dec-81	PAGE	1-60


                         C      
                         C      ;****************************************************************
                         C      ;*               LCPOS , LCPOL                                  *
                         C      ;****************************************************************
  CF6F    E5             C      MO.LCPOS:   PUSH    HL                  ; HL ==> aktuelle Schreibposition
  CF70    D5             C                  PUSH    DE
  CF71    ED 5B B194     C                  LD      DE,(MS.BWSA)
  CF75    B7             C                  OR      A
  CF76    ED 52          C                  SBC     HL,DE
  CF78    CD CF58        C                  CALL    MO.DESZ
  CF7B    AF             C                  XOR     A
  CF7C    ED 52          C      MO.LCP1:    SBC     HL,DE
  CF7E    3C             C                  INC     A
  CF7F    30 FB          C                  JR      NC,MO.LCP1
  CF81    19             C                  ADD     HL,DE
  CF82    3D             C                  DEC     A
  CF83    32 B18C        C                  LD      (MS.ZPOS),A
  CF86    7D             C                  LD      A,L
  CF87    32 B18D        C                  LD      (MS.SPOS),A
  CF8A    D1             C                  POP     DE
  CF8B    E1             C                  POP     HL
  CF8C    C9             C                  RET
                         C      ;
  CF8D    E5             C      MO.LCPOL:   PUSH    HL
  CF8E    D5             C                  PUSH    DE
  CF8F    ED 5B B194     C                  LD      DE,(MS.BWSA)
  CF93    B7             C                  OR      A
  CF94    ED 52          C                  SBC     HL,DE
  CF96    CD CF58        C                  CALL    MO.DESZ
  CF99    AF             C                  XOR     A
  CF9A    ED 52          C      MO.LCP2:    SBC     HL,DE
  CF9C    3C             C                  INC     A
  CF9D    30 FB          C                  JR      NC,MO.LCP2
  CF9F    19             C                  ADD     HL,DE
  CFA0    3D             C                  DEC     A
  CFA1    32 B18A        C                  LD      (MS.ZPOL),A
  CFA4    7D             C                  LD      A,L
  CFA5    32 B18B        C                  LD      (MS.SPOL),A
  CFA8    D1             C                  POP     DE
  CFA9    E1             C                  POP     HL
  CFAA    C9             C                  RET
                         C      
                         C                  PAGE
'Cursor Operationen'	MACRO-80 3.44	09-Dec-81	PAGE	1-61


                         C      
                         C      ;****************************************************************
                         C      ;*               HOME - Funktion  Schreibposition               *
                         C      ;****************************************************************
  CFAB    2A B18E        C      MO.HOMES:   LD      HL,(MS.ZMIN)
  CFAE    22 B18C        C                  LD      (MS.ZPOS),HL
  CFB1    CD CD68        C                  CALL    MO.DZPOS
  CFB4    CD CD7A        C                  CALL    MO.DSPOS
  CFB7    C9             C                  RET
                         C      
                         C      ;****************************************************************
                         C      ;*               HOME - Funktion  Leseposition                  *
                         C      ;****************************************************************
  CFB8    2A B18E        C      MO.HOMEL:   LD      HL,(MS.ZMIN)
  CFBB    22 B18A        C                  LD      (MS.ZPOL),HL
  CFBE    CD CD53        C                  CALL    MO.DZPOL
  CFC1    CD CD5B        C                  CALL    MO.DSPOL
  CFC4    C9             C                  RET
                         C      
                         C      ;****************************************************************
                         C      ;*               Anfangsposition naechste Zeile Schreiben       *
                         C      ;****************************************************************
  CFC5    3A B18F        C      MO.CNZAS:   LD      A,(MS.SMIN)
  CFC8    3D             C                  DEC     A
  CFC9    32 B18D        C                  LD      (MS.SPOS),A
  CFCC    CD CE3D        C                  CALL    MO.IZPOS
  CFCF    C9             C                  RET
                         C      
                         C      ;****************************************************************
                         C      ;*               Anfangsposition naechste Zeile Lesen           *
                         C      ;****************************************************************
  CFD0    3A B18F        C      MO.CNZAL:   LD      A,(MS.SMIN)
  CFD3    3D             C                  DEC     A
  CFD4    32 B18B        C                  LD      (MS.SPOL),A
  CFD7    CD CE2B        C                  CALL    MO.IZPOL
  CFDA    C9             C                  RET
                         C      
                         C                  TITLE   'Schreiben/Lesen eines Zeichens'
                         C                  PAGE
'Schreiben/Lesen eines Zeichens'	MACRO-80 3.44	09-Dec-81	PAGE	1-62


                         C      
                         C      ;****************************************************************
                         C      ;*               Schreiben eines Zeichens auf Bildschirm        *
                         C      ;****************************************************************
  CFDB    CD CEF6        C      MO.MZS:     CALL    MO.CPOS
  CFDE    3A B199        C                  LD      A,(MS.TK)
  CFE1    77             C                  LD      (HL),A
  CFE2    CD CB49        C                  CALL    MO.BWSUZ
  CFE5    21 D009        C      MO.MPS:     LD      HL,MO.ZSTAB
  CFE8    3A B197        C                  LD      A,(MS.DIRES)
  CFEB    18 0D          C                  JR      MO.MSL
                         C      ;****************************************************************
                         C      ;*               Lesen     eines Zeichens vom Bildschirm        *
                         C      ;****************************************************************
  CFED    CD CEFB        C      MO.MZL:     CALL    MO.CPOL
  CFF0    7E             C                  LD      A,(HL)
  CFF1    32 B199        C                  LD      (MS.TK),A
  CFF4    21 D019        C      MO.MPL:     LD      HL,MO.ZLTAB
  CFF7    3A B196        C                  LD      A,(MS.DIREL)
  CFFA    CB 7F          C      MO.MSL:     BIT     7,A
  CFFC    C8             C                  RET     Z
  CFFD    E6 07          C                  AND     07H
  CFFF    87             C                  ADD     A,A
  D000    06 00          C                  LD      B,0
  D002    4F             C                  LD      C,A
  D003    09             C                  ADD     HL,BC
  D004    7E             C                  LD      A,(HL)
  D005    23             C                  INC     HL
  D006    66             C                  LD      H,(HL)
  D007    6F             C                  LD      L,A
  D008    E9             C                  JP      (HL)
                         C      ;****************************************************************
                         C      ;*               ZSTAB  und  ZLTAB                              *
                         C      ;****************************************************************
  D009    D029           C      MO.ZSTAB:   DW      MO.MZSO
  D00B    D0BF           C                  DW      MO.MZSNO
  D00D    D09D           C                  DW      MO.MZSN
  D00F    D0BF           C                  DW      MO.MZSNW
  D011    D063           C                  DW      MO.MZSW
  D013    D0BF           C                  DW      MO.MZSSW
  D015    D0AD           C                  DW      MO.MZSS
  D017    D0BF           C                  DW      MO.MZSSO
  D019    D0C0           C      MO.ZLTAB:   DW      MO.MZLO
  D01B    D100           C                  DW      MO.MZLNO
  D01D    D0E0           C                  DW      MO.MZLN
  D01F    D100           C                  DW      MO.MZLNW
  D021    D0D0           C                  DW      MO.MZLW
  D023    D100           C                  DW      MO.MZLSW
  D025    D0F0           C                  DW      MO.MZLS
  D027    D100           C                  DW      MO.MZLSO
                         C      
                         C                  PAGE
'Schreiben/Lesen eines Zeichens'	MACRO-80 3.44	09-Dec-81	PAGE	1-63


                         C      
                         C      ;****************************************************************
                         C      ;*               MZSO , MZSW , MZSN , MZSS                      *
                         C      ;****************************************************************
  D029    3A B197        C      MO.MZSO:    LD      A,(MS.DIRES)
  D02C    F5             C                  PUSH    AF
  D02D    CB 6F          C                  BIT     5,A
  D02F    28 11          C                  JR      Z,MO.MZSO1
  D031    21 B190        C                  LD      HL,MS.ZMAX
  D034    3A B18C        C                  LD      A,(MS.ZPOS)
  D037    3C             C                  INC     A
  D038    BE             C                  CP      (HL)
  D039    28 1A          C                  JR      Z,MO.MZSO3
  D03B    F1             C                  POP     AF
  D03C    F5             C                  PUSH    AF
  D03D    CB AF          C                  RES     5,A
  D03F    32 B197        C                  LD      (MS.DIRES),A
  D042    CD CE50        C      MO.MZSO1:   CALL    MO.ISPOS
  D045    F5             C      MO.MZSO2:   PUSH    AF
  D046    D1             C                  POP     DE
  D047    F1             C                  POP     AF
  D048    D5             C                  PUSH    DE
  D049    32 B197        C                  LD      (MS.DIRES),A
  D04C    CB 77          C                  BIT     6,A
  D04E    28 6D          C                  JR      Z,MO.MZSL
  D050    F1             C                  POP     AF
  D051    DC CE3D        C                  CALL    C,MO.IZPOS
  D054    C9             C                  RET
  D055    CD CE50        C      MO.MZSO3:   CALL    MO.ISPOS
  D058    20 EB          C                  JR      NZ,MO.MZSO2
  D05A    3A B18F        C                  LD      A,(MS.SMIN)
  D05D    3D             C                  DEC     A
  D05E    32 B18D        C                  LD      (MS.SPOS),A
  D061    18 E2          C                  JR      MO.MZSO2
                         C      
                         C                  PAGE
'Schreiben/Lesen eines Zeichens'	MACRO-80 3.44	09-Dec-81	PAGE	1-64


                         C      
  D063    3A B197        C      MO.MZSW:    LD      A,(MS.DIRES)
  D066    F5             C                  PUSH    AF
  D067    CB 6F          C                  BIT     5,A
  D069    28 11          C                  JR      Z,MO.MZSW1
  D06B    21 B18E        C                  LD      HL,MS.ZMIN
  D06E    3A B18C        C                  LD      A,(MS.ZPOS)
  D071    3C             C                  INC     A
  D072    BE             C                  CP      (HL)
  D073    28 1A          C                  JR      Z,MO.MZSW3
  D075    F1             C                  POP     AF
  D076    F5             C                  PUSH    AF
  D077    CB AF          C                  RES     5,A
  D079    32 B197        C                  LD      (MS.DIRES),A
  D07C    CD CD7A        C      MO.MZSW1:   CALL    MO.DSPOS
  D07F    F5             C      MO.MZSW2:   PUSH    AF
  D080    D1             C                  POP     DE
  D081    F1             C                  POP     AF
  D082    D5             C                  PUSH    DE
  D083    32 B197        C                  LD      (MS.DIRES),A
  D086    CB 77          C                  BIT     6,A
  D088    28 33          C                  JR      Z,MO.MZSL
  D08A    F1             C                  POP     AF
  D08B    DC CD68        C                  CALL    C,MO.DZPOS
  D08E    C9             C                  RET
  D08F    CD CD7A        C      MO.MZSW3:   CALL    MO.DSPOS
  D092    20 EB          C                  JR      NZ,MO.MZSW2
  D094    3A B191        C                  LD      A,(MS.SMAX)
  D097    3D             C                  DEC     A
  D098    32 B18D        C                  LD      (MS.SPOS),A
  D09B    18 E2          C                  JR      MO.MZSW2
                         C      
  D09D    CD CD68        C      MO.MZSN:    CALL    MO.DZPOS
  D0A0    F5             C                  PUSH    AF
  D0A1    3A B197        C                  LD      A,(MS.DIRES)
  D0A4    CB 77          C                  BIT     6,A
  D0A6    28 15          C                  JR      Z,MO.MZSL
  D0A8    F1             C                  POP     AF
  D0A9    DC CD7A        C                  CALL    C,MO.DSPOS
  D0AC    C9             C                  RET
                         C      
  D0AD    CD CE3D        C      MO.MZSS:    CALL    MO.IZPOS
  D0B0    F5             C                  PUSH    AF
  D0B1    3A B197        C                  LD      A,(MS.DIRES)
  D0B4    CB 77          C                  BIT     6,A
  D0B6    28 05          C                  JR      Z,MO.MZSL
  D0B8    F1             C                  POP     AF
  D0B9    DC CE50        C                  CALL    C,MO.ISPOS
  D0BC    C9             C                  RET
                         C      
  D0BD    F1             C      MO.MZSL:    POP     AF
  D0BE    C9             C                  RET
                         C      
  D0BF                   C      MO.MZSNO    EQU     $
  D0BF                   C      MO.MZSNW    EQU     $
  D0BF                   C      MO.MZSSW    EQU     $
  D0BF    C9             C      MO.MZSSO:   RET
                         C      
                         C                  PAGE
'Schreiben/Lesen eines Zeichens'	MACRO-80 3.44	09-Dec-81	PAGE	1-65


                         C      
                         C      ;****************************************************************
                         C      ;*               MZLO , MZLW , MZLN , MZLS                      *
                         C      ;****************************************************************
  D0C0    CD CE34        C      MO.MZLO:    CALL    MO.ISPOL
  D0C3    F5             C                  PUSH    AF
  D0C4    3A B196        C                  LD      A,(MS.DIREL)
  D0C7    CB 77          C                  BIT     6,A
  D0C9    28 F2          C                  JR      Z,MO.MZSL
  D0CB    F1             C                  POP     AF
  D0CC    DC CE2B        C                  CALL    C,MO.IZPOL
  D0CF    C9             C                  RET
  D0D0    CD CD5B        C      MO.MZLW:    CALL    MO.DSPOL
  D0D3    F5             C                  PUSH    AF
  D0D4    3A B196        C                  LD      A,(MS.DIREL)
  D0D7    CB 77          C                  BIT     6,A
  D0D9    28 E2          C                  JR      Z,MO.MZSL
  D0DB    F1             C                  POP     AF
  D0DC    DC CD53        C                  CALL    C,MO.DZPOL
  D0DF    C9             C                  RET
  D0E0    CD CD53        C      MO.MZLN:    CALL    MO.DZPOL
  D0E3    F5             C                  PUSH    AF
  D0E4    3A B196        C                  LD      A,(MS.DIREL)
  D0E7    CB 77          C                  BIT     6,A
  D0E9    28 D2          C                  JR      Z,MO.MZSL
  D0EB    F1             C                  POP     AF
  D0EC    DC CD5B        C                  CALL    C,MO.DSPOL
  D0EF    C9             C                  RET
  D0F0    CD CE2B        C      MO.MZLS:    CALL    MO.IZPOL
  D0F3    F5             C                  PUSH    AF
  D0F4    3A B196        C                  LD      A,(MS.DIREL)
  D0F7    CB 77          C                  BIT     6,A
  D0F9    28 C2          C                  JR      Z,MO.MZSL
  D0FB    F1             C                  POP     AF
  D0FC    DC CE34        C                  CALL    C,MO.ISPOL
  D0FF    C9             C                  RET
  D100                   C      MO.MZLNO    EQU     $
  D100                   C      MO.MZLNW    EQU     $
  D100                   C      MO.MZLSW    EQU     $
  D100    C9             C      MO.MZLSO:   RET
                         C      
                         C                  TITLE   'Vektor lesen/schreiben'
                         C                  PAGE
'Vektor lesen/schreiben'	MACRO-80 3.44	09-Dec-81	PAGE	1-66


                         C      
                         C      ;****************************************************************
                         C      ;*               Vektor schreiben                               *
                         C      ;*               -----------------------------------------------*
                         C      ;*               HL = auszugebender Vektor                      *
                         C      ;*               B  = Laenge des    Vektors                     *
                         C      ;****************************************************************
  D101    3A B197        C      MO.MVS:     LD      A,(MS.DIRES)
  D104    F5             C                  PUSH    AF
  D105    CB FF          C                  SET     7,A
  D107    CB F7          C                  SET     6,A
  D109    32 B197        C                  LD      (MS.DIRES),A
  D10C    7E             C      MO.MVS1:    LD      A,(HL)
  D10D    23             C                  INC     HL
  D10E    E5             C                  PUSH    HL
  D10F    C5             C                  PUSH    BC
  D110    32 B199        C                  LD      (MS.TK),A
  D113    CD CFDB        C                  CALL    MO.MZS
  D116    C1             C                  POP     BC
  D117    E1             C                  POP     HL
  D118    10 F2          C                  DJNZ    MO.MVS1
  D11A    F1             C                  POP     AF
  D11B    32 B197        C                  LD      (MS.DIRES),A
  D11E    C9             C                  RET
                         C      
                         C      ;****************************************************************
                         C      ;*                Vektor lesen                                  *
                         C      ;*                ----------------------------------------------*
                         C      ;*                HL = Zieladresse des einzulesenden Vektors    *
                         C      ;*                B  = Laenge des Vektors                       *
                         C      ;****************************************************************
  D11F    3A B196        C      MO.MVL:     LD      A,(MS.DIREL)
  D122    F5             C                  PUSH    AF
  D123    CB FF          C                  SET     7,A
  D125    CB F7          C                  SET     6,A
  D127    32 B196        C                  LD      (MS.DIREL),A
  D12A    E5             C      MO.MVL1:    PUSH    HL
  D12B    C5             C                  PUSH    BC
  D12C    CD CFED        C                  CALL    MO.MZL
  D12F    C1             C                  POP     BC
  D130    E1             C                  POP     HL
  D131    3A B199        C                  LD      A,(MS.TK)
  D134    77             C                  LD      (HL),A
  D135    23             C                  INC     HL
  D136    10 F2          C                  DJNZ    MO.MVL1
  D138    F1             C                  POP     AF
  D139    32 B196        C                  LD      (MS.DIREL),A
  D13C    C9             C                  RET
                         C      
                         C      ;           END
                         C      ;           PN      TA35
                         C                  TITLE   'Tastaturroutine'
                         C                  PAGE
'Tastaturroutine'	MACRO-80 3.44	09-Dec-81	PAGE	1-67


                         C      
                         C      ;****************************************************************
                         C      ;*               Tastaturroutine                                *
                         C      ;*  Version      -----------------------------------------------*
                         C      ;*               Programmierer: M. Herbote --- K EAW  ZFT (WFT) *
                         C      ;*  V 2 . 1      -----------------------------------------------*
                         C      ;*               Stand        : 06.Maerz 1985                   *
                         C      ;****************************************************************
                         C      
                         C      ;****************************************************************
                         C      ;*               symbolische Adressen und ihre Bedeutung        *
                         C      ;* symbol.Adr. ! Bedeutung                                      *
                         C      ;*-------------!------------------------------------------------*
                         C      ;* TA.TA1      ! Abfrage nach gedrueckter Taste                 *
                         C      ;* TA.TA2      ! Einlesen des Tastaturcodes                     *
                         C      ;* TA.PIOPR    ! programmieren des Tastatur-PIO                 *
                         C      ;* TA.E0IN     ! Anfangswerte fuer EMERK , UMERK und KGMER      *
                         C      ;* TA.LOE      ! loeschen aller Tastenroutinenadressen          *
                         C      ;* TA.LOES     ! wie TA.LOE mit Belegung Standardroutinen       *
                         C      ;* TA.ABFR     ! Tastaturabfrage und Ausfuehrung Tastenfunktion *
                         C      ;* TA.TFE      ! Warteschleife bis keine Taste mehr gedrueckt   *
                         C      ;*-------------!------------------------------------------------*
                         C      ;* Tabellen mit den Funktionsadressen der einzelnen Tasten      *
                         C      ;* TS.TAB1     ! Funktionstasten  P01 bis P48                   *
                         C      ;* TS.TAB2     ! INS MOD   , DEL      , INS LINE   , DEL LINE , *
                         C      ;*             ! SCH LINKS , C HOCH   , SCH RECHTS ,            *
                         C      ;*             ! C LINKS   , HOME     , C RECHTS   ,            *
                         C      ;*             ! CNZA      , C RUNTER                           *
                         C      ;* TS.TAB3     ! 00 , 000  , NEG QUIT , SYS  , END , ABS        *
                         C      ;* TS.TAB4     ! POS QUIT  , TABS     , TABL , CI  , M          *
                         C      ;* TS.EINA     ! Auswerten der alphanumerischen Tasten          *
                         C      ;* TS.TABU     ! Auswerten der Taste  ET2 == HT                 *
                         C      ;* TS.NEWL     ! Auswerten der Taste  ET1 == RS                 *
                         C      ;* TS.TAB5     ! Ebene 0   , Ebene 1  , Ebene 2    , Ebenen 3   *
                         C      ;*-------------!------------------------------------------------*
                         C      ;* TS.PTAST    ! I/O-Adresse der Tastatur                       *
                         C      ;* TS.TK       ! Zwischenspeicher fuer den Tastaturcode         *
                         C      ;* TS.PTK      ! Zwischenspeicher fuer die P-Tastennummer       *
                         C      ;* TS.EMERK    ! Merker fuer die aktive P-Tastenebene           *
                         C      ;* TS.SPMER    ! Tastaturgruppenmerker                          *
                         C      ;*             ! Bit ! Hexacode    ! Funktion                   *
                         C      ;*             !-----!-------------!----------------------------*
                         C      ;*             ! 0   ! 00-1F       ! Steuer- / Sonder-zeichen   *
                         C      ;*             ! 1   ! 20,2C       !  ,                         *
                         C      ;*             ! 2   ! 2B,2D,2E    ! +-.                        *
                         C      ;*             ! 3   ! 30-39       ! 0123456789                 *
                         C      ;*             ! 4   !             ! !"%&'()*/:;<=>?[\]^_{|}`~  *
                         C      ;*             ! 5   ! 40-5A,23,24 ! A...Z@#$   Grossbuchstaben *
                         C      ;*             ! 6   ! 61-7A       ! a...z      Kleinbuchstaben *
                         C      ;*             ! 7   ! 80-FF       ! Funktionstasten            *
                         C      ;* TS.UMERK    ! =0 INS MOD aus   =1 INS MOD ein                *
                         C      ;* TS.KGMER    ! =0 Programmier-  =1 Schreibmaschinen- Tastatur *
                         C      ;* TS.ZSMER    ! =0 Schnellschreiben nicht erlaubt              *
                         C      ;* TS.ZEIT1    ! Zeitkonstante 1 fuer die Warteschleife         *
                         C      ;* TS.ZEIT2    ! Zeitkonstante 2 fuer die Warteschleife         *
                         C      ;* TS.MIO      ! =0 I/O -         =1 memory - Bereitstellung    *
                         C      ;* TS.MBF      ! =0 kein          =1 Abspeichern als Bedienfolge*
                         C      ;* TS.BFOL1    ! Pointer Bedienfolgespeicher bei Aufbau         *
                         C      ;* TS.BFOL2    ! Pointer Bedienfolgespeicher bei Abarbeitung    *
                         C      ;* TS.STACK    ! Zeiger zum aktuellen Keller                    *
                         C      ;****************************************************************
                         C                  PAGE
'Tastaturroutine'	MACRO-80 3.44	09-Dec-81	PAGE	1-68


                         C      
                         C      ;****************************************************************
                         C      ;*               Verbindungs - Macro zur Version 1.2            *
                         C      ;****************************************************************
                         C      TA.TAST     MACRO   UP
                         C                  PUSH    AF
                         C                  CALL    S0.TAZU
                         C                  POP     AF
                         C                  CALL    UP
                         C                  PUSH    AF
                         C                  PUSH    BC
                         C                  PUSH    DE
                         C                  CALL    S2.STACK
                         C                  POP     DE
                         C                  POP     BC
                         C                  POP     AF
                         C                  ENDM
                         C      ;****************************************************************
                         C      ;*               UP zum Abfragen nach gedrueckter Taste         *
                         C      ;****************************************************************
  D13D    3A B23B        C      TA.TA1:     LD      A,(TS.PTAST)
                         C                  TA.TAST S0.TA1
  D140    F5             C+                 PUSH    AF
  D141    CD F618        C+                 CALL    S0.TAZU
  D144    F1             C+                 POP     AF
  D145    CD 4003        C+                 CALL    S0.TA1
  D148    F5             C+                 PUSH    AF
  D149    C5             C+                 PUSH    BC
  D14A    D5             C+                 PUSH    DE
  D14B    CD B2D4        C+                 CALL    S2.STACK
  D14E    D1             C+                 POP     DE
  D14F    C1             C+                 POP     BC
  D150    F1             C+                 POP     AF
  D151    32 B245        C                  LD      (TS.ZEI21),A
  D154    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*               UP zum einlesen des Tastaturcodes              *
                         C      ;****************************************************************
  D155    3A B23B        C      TA.TA2:     LD      A,(TS.PTAST)
                         C                  TA.TAST S0.TA2
  D158    F5             C+                 PUSH    AF
  D159    CD F618        C+                 CALL    S0.TAZU
  D15C    F1             C+                 POP     AF
  D15D    CD 4006        C+                 CALL    S0.TA2
  D160    F5             C+                 PUSH    AF
  D161    C5             C+                 PUSH    BC
  D162    D5             C+                 PUSH    DE
  D163    CD B2D4        C+                 CALL    S2.STACK
  D166    D1             C+                 POP     DE
  D167    C1             C+                 POP     BC
  D168    F1             C+                 POP     AF
  D169    47             C                  LD      B,A
  D16A    3A B245        C                  LD      A,(TS.ZEI21)
  D16D    CB 57          C                  BIT     2,A
  D16F    20 2A          C                  JR      NZ,TA.TA21
  D171    78             C                  LD      A,B                 ;Auswertung der CTRL-Tasten
  D172    FE 85          C                  CP      85H
  D174    30 25          C                  JR      NC,TA.TA21
  D176    FE 84          C                  CP      84H
  D178    20 04          C                  JR      NZ,TA.TA22
  D17A    06 F4          C                  LD      B,0F4H              ;SCH_LINKS
  D17C    18 1D          C                  JR      TA.TA21
  D17E    FE 80          C      TA.TA22:    CP      80H
  D180    38 03          C                  JR      C,TA.TA23
  D182    C6 31          C                  ADD     A,31H               ;TABS,TABL,CI,M
  D184    47             C                  LD      B,A
  D185    FE 70          C      TA.TA23:    CP      70H
  D187    30 12          C                  JR      NC,TA.TA21
  D189    FE 60          C                  CP      60H
  D18B    38 03          C                  JR      C,TA.TA24
  D18D    C6 80          C                  ADD     A,80H               ;Tastencode  E0H ... EFH
  D18F    47             C                  LD      B,A
  D190    FE 50          C      TA.TA24:    CP      50H
  D192    30 07          C                  JR      NC,TA.TA21
  D194    FE 40          C                  CP      40H
  D196    38 03          C                  JR      C,TA.TA21
  D198    C6 90          C                  ADD     A,90H               ;Tastencode  D0H ... DFH
  D19A    47             C                  LD      B,A
  D19B    78             C      TA.TA21:    LD      A,B
  D19C    C9             C                  RET
                         C      
                         C                  TITLE   'Init. und Zusatzfkt. Tastatur'
'Init. und Zusatzfkt. Tastatur'	MACRO-80 3.44	09-Dec-81	PAGE	1-69


                         C                  PAGE
'Init. und Zusatzfkt. Tastatur'	MACRO-80 3.44	09-Dec-81	PAGE	1-70


                         C      
                         C      ;****************************************************************
                         C      ;*               Init. und Zusatzfunktionen der Tastatur        *
                         C      ;****************************************************************
  D19D    3A B23B        C      TA.PIOPR:   LD      A,(TS.PTAST)
                         C                  TA.TAST S0.TINIT
  D1A0    F5             C+                 PUSH    AF
  D1A1    CD F618        C+                 CALL    S0.TAZU
  D1A4    F1             C+                 POP     AF
  D1A5    CD 4000        C+                 CALL    S0.TINIT
  D1A8    F5             C+                 PUSH    AF
  D1A9    C5             C+                 PUSH    BC
  D1AA    D5             C+                 PUSH    DE
  D1AB    CD B2D4        C+                 CALL    S2.STACK
  D1AE    D1             C+                 POP     DE
  D1AF    C1             C+                 POP     BC
  D1B0    F1             C+                 POP     AF
  D1B1    C9             C                  RET
                         C      
  D1B2    CD D13D        C      TA.TA3:     CALL    TA.TA1
  D1B5    20 FB          C                  JR      NZ,TA.TA3
  D1B7    CD D155        C                  CALL    TA.TA2
  D1BA    C9             C                  RET
                         C      
  D1BB    3A B23B        C      TA.TRTFE:   LD      A,(TS.PTAST)
                         C                  TA.TAST S0.TFE
  D1BE    F5             C+                 PUSH    AF
  D1BF    CD F618        C+                 CALL    S0.TAZU
  D1C2    F1             C+                 POP     AF
  D1C3    CD 400C        C+                 CALL    S0.TFE
  D1C6    F5             C+                 PUSH    AF
  D1C7    C5             C+                 PUSH    BC
  D1C8    D5             C+                 PUSH    DE
  D1C9    CD B2D4        C+                 CALL    S2.STACK
  D1CC    D1             C+                 POP     DE
  D1CD    C1             C+                 POP     BC
  D1CE    F1             C+                 POP     AF
  D1CF    C9             C                  RET
                         C      
  D1D0    3A B23B        C      TA.TIM:     LD      A,(TS.PTAST)        ;Ansteuerung der INS_MOD Diode
                         C                  TA.TAST S0.TIM
  D1D3    F5             C+                 PUSH    AF
  D1D4    CD F618        C+                 CALL    S0.TAZU
  D1D7    F1             C+                 POP     AF
  D1D8    CD 400F        C+                 CALL    S0.TIM
  D1DB    F5             C+                 PUSH    AF
  D1DC    C5             C+                 PUSH    BC
  D1DD    D5             C+                 PUSH    DE
  D1DE    CD B2D4        C+                 CALL    S2.STACK
  D1E1    D1             C+                 POP     DE
  D1E2    C1             C+                 POP     BC
  D1E3    F1             C+                 POP     AF
  D1E4    C9             C                  RET
                         C      
  D1E5    3A B23B        C      TA.TEM:     LD      A,(TS.PTAST)        ;Ansteuerung der Ebenen- Dioden
                         C                  TA.TAST S0.TEM
  D1E8    F5             C+                 PUSH    AF
  D1E9    CD F618        C+                 CALL    S0.TAZU
  D1EC    F1             C+                 POP     AF
  D1ED    CD 4012        C+                 CALL    S0.TEM
  D1F0    F5             C+                 PUSH    AF
  D1F1    C5             C+                 PUSH    BC
  D1F2    D5             C+                 PUSH    DE
  D1F3    CD B2D4        C+                 CALL    S2.STACK
  D1F6    D1             C+                 POP     DE
  D1F7    C1             C+                 POP     BC
  D1F8    F1             C+                 POP     AF
  D1F9    C9             C                  RET
                         C      
  D1FA    3A B23B        C      TA.TBEL:    LD      A,(TS.PTAST)        ;Ansteuerung der Fehleranzeigen
                         C                  TA.TAST S0.TBEL
  D1FD    F5             C+                 PUSH    AF
  D1FE    CD F618        C+                 CALL    S0.TAZU
  D201    F1             C+                 POP     AF
  D202    CD 4015        C+                 CALL    S0.TBEL
  D205    F5             C+                 PUSH    AF
  D206    C5             C+                 PUSH    BC
  D207    D5             C+                 PUSH    DE
  D208    CD B2D4        C+                 CALL    S2.STACK
  D20B    D1             C+                 POP     DE
  D20C    C1             C+                 POP     BC
  D20D    F1             C+                 POP     AF
'Init. und Zusatzfkt. Tastatur'	MACRO-80 3.44	09-Dec-81	PAGE	1-71


  D20E    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*               Ebene 0 , INS MOD auf aus und KGMER auf PTAS   *
                         C      ;****************************************************************
  D20F    AF             C      TA.E0IN:    XOR     A
  D210    32 B241        C                  LD      (TS.KGMER),A
  D213    32 B23E        C                  LD      (TS.EMERK),A
  D216    32 B240        C                  LD      (TS.UMERK),A
  D219    32 B247        C                  LD      (TS.MIO),A
  D21C    32 B248        C                  LD      (TS.MBF),A
                         C      
  D21F    06 01          C                  LD      B,001H              ;INS_MOD aus, Ebene 1 ???  AUS/EIN 7, 17 ???
  D221    C5             C                  PUSH    BC
                         C      ;???            CALL    TA.TIM
  D222    C1             C                  POP     BC
                         C      ;???            CALL    TA.TEM
                         C      
  D223    C9             C                  RET
                         C      
  D224    3A B23E        C      TA.BBB:     LD      A,(TS.EMERK)
  D227    3C             C                  INC     A
  D228    47             C                  LD      B,A
  D229    3E 80          C                  LD      A,080H
  D22B    07             C                  RLCA                        ;<--!
  D22C    10 FD          C                  DJNZ    $-1                 ;---!
  D22E    47             C                  LD      B,A
  D22F    3A B240        C                  LD      A,(TS.UMERK)
  D232    B7             C                  OR      A
  D233    C8             C                  RET     Z
  D234    CB F8          C                  SET     7,B
  D236    C9             C                  RET
                         C      
                         C                  TITLE   'Abfrageschleife'
                         C                  PAGE
'Abfrageschleife'	MACRO-80 3.44	09-Dec-81	PAGE	1-72


                         C      
                         C      ;****************************************************************
                         C      ;*               Tastaturabfrageschleife                        *
                         C      ;****************************************************************
  D237    3A B247        C      TA.ABFR:    LD      A,(TS.MIO)          ;Tastencode von Tastatur bzw. vomSpeicher
  D23A    B7             C                  OR      A
  D23B    28 0A          C                  JR      Z,TA.ABFR1
  D23D    2A B24B        C                  LD      HL,(TS.BFOL2)
  D240    7E             C                  LD      A,(HL)
  D241    23             C                  INC     HL
  D242    22 B24B        C                  LD      (TS.BFOL2),HL
  D245    18 03          C                  JR      TA.ABFR2
  D247    CD D1B2        C      TA.ABFR1:   CALL    TA.TA3              ;Tastencode einlesen
  D24A    B7             C      TA.ABFR2:   OR      A
  D24B    CA D321        C                  JP      Z,TA.TFE            ;Kode=00H ungueltig
  D24E    FE 7F          C                  CP      7FH
  D250    CA D321        C                  JP      Z,TA.TFE            ;Kode=7FH ungueltig
  D253    32 B23C        C                  LD      (TS.TK),A           ;Tastencode abspeichern
  D256    3A B248        C                  LD      A,(TS.MBF)          ;Tastencode nach Bedienfolgespeicher ?
  D259    B7             C                  OR      A
  D25A    3A B23C        C                  LD      A,(TS.TK)
  D25D    28 08          C                  JR      Z,TA.ABFR3
  D25F    2A B249        C                  LD      HL,(TS.BFOL1)
  D262    77             C                  LD      (HL),A
  D263    23             C                  INC     HL
  D264    22 B249        C                  LD      (TS.BFOL1),HL
  D267    3A B241        C      TA.ABFR3:   LD      A,(TS.KGMER)
  D26A    B7             C                  OR      A
  D26B    3A B23C        C                  LD      A,(TS.TK)
  D26E    28 18          C                  JR      Z,TA.ABF14
  D270    FE 7E          C                  CP      7EH
  D272    30 14          C                  JR      NC,TA.ABF14
  D274    FE 61          C                  CP      61H
  D276    30 0A          C                  JR      NC,TA.ABF15
  D278    FE 5E          C                  CP      5EH
  D27A    30 0C          C                  JR      NC,TA.ABF14
  D27C    FE 41          C                  CP      41H
  D27E    30 06          C                  JR      NC,TA.ABF16
  D280    18 06          C                  JR      TA.ABF14
  D282    D6 20          C      TA.ABF15:   SUB     20H
  D284    18 02          C                  JR      TA.ABF14
  D286    C6 20          C      TA.ABF16:   ADD     A,20H
  D288    FE 80          C      TA.ABF14:   CP      80H
  D28A    D2 D331        C                  JP      NC,TA.ABF20         ;Kode > 7FH    Funktionstasten
  D28D    FE 09          C                  CP      09H
  D28F    CA D3FC        C                  JP      Z,TA.ET2            ;Taste ET2 == 09H == HT == Tabulator
  D292    FE 1E          C                  CP      1EH
  D294    CA D402        C                  JP      Z,TA.ET1            ;Taste ET1 == 1EH == RS
  D297    21 B23F        C      TA.ABF1:    LD      HL,TS.SPMER         ;Auswertung Alphatastatur
  D29A    FE 3A          C                  CP      3AH
  D29C    30 57          C                  JR      NC,TA.ABF10
  D29E    FE 20          C                  CP      20H
  D2A0    30 29          C                  JR      NC,TA.ABF6
  D2A2    CB 46          C                  BIT     0,(HL)              ;Kodegruppe 1   00H - 1FH
  D2A4    28 7B          C                  JR      Z,TA.TFE
                         C      
                         C                  PAGE
'Abfrageschleife'	MACRO-80 3.44	09-Dec-81	PAGE	1-73


                         C      
  D2A6    2A B22D        C      TA.ABF2:    LD      HL,(TS.EINA)
  D2A9    4F             C      TA.ABF3:    LD      C,A
  D2AA    7C             C                  LD      A,H
  D2AB    B5             C                  OR      L
  D2AC    28 73          C                  JR      Z,TA.TFE
                         C      
  D2AE    3E 07          C                  LD      A,7                 ;Cursor loeschen
  D2B0    32 B198        C                  LD      (MS.CMD),A
  D2B3    CD CB10        C                  CALL    MO.MONI
                         C      
  D2B6    79             C                  LD      A,C
  D2B7    CD D2CA        C                  CALL    TA.MM
                         C      
  D2BA    3E 06          C                  LD      A,6                 ;Cursor setzen
  D2BC    32 B198        C                  LD      (MS.CMD),A
  D2BF    CD CB10        C                  CALL    MO.MONI
                         C      
  D2C2    3A B247        C                  LD      A,(TS.MIO)
  D2C5    B7             C                  OR      A
  D2C6    CA D463        C                  JP      Z,TA.WART
  D2C9    C9             C                  RET
                         C      
                         C      ;
  D2CA    E9             C      TA.MM:      JP      (HL)
                         C      ;
                         C      
  D2CB    FE 30          C      TA.ABF6:    CP      30H                 ;Kodegruppe 2,3,4,5   20H - 39H
  D2CD    30 20          C                  JR      NC,TA.ABF9
  D2CF    FE 2B          C                  CP      '+'
  D2D1    28 16          C                  JR      Z,TA.ABF8
  D2D3    FE 2D          C                  CP      '-'
  D2D5    28 12          C                  JR      Z,TA.ABF8
  D2D7    FE 2E          C                  CP      '.'
  D2D9    28 0E          C                  JR      Z,TA.ABF8
  D2DB    FE 20          C                  CP      ' '
  D2DD    28 04          C                  JR      Z,TA.ABF7
  D2DF    FE 2C          C                  CP      ','
  D2E1    20 12          C                  JR      NZ,TA.ABF10
                         C      
  D2E3    CB 4E          C      TA.ABF7:    BIT     1,(HL)              ;Kodegruppe 2   20H , 2CH
  D2E5    28 3A          C                  JR      Z,TA.TFE
  D2E7    18 BD          C                  JR      TA.ABF2
                         C      
  D2E9    CB 56          C      TA.ABF8:    BIT     2,(HL)              ;Kodegruppe 3   2BH , 2DH , 2EH
  D2EB    28 34          C                  JR      Z,TA.TFE
  D2ED    18 B7          C                  JR      TA.ABF2
                         C      
  D2EF    CB 5E          C      TA.ABF9:    BIT     3,(HL)              ;Kodegruppe 4   30H - 39H
  D2F1    28 2E          C                  JR      Z,TA.TFE
  D2F3    18 B1          C                  JR      TA.ABF2
                         C      
                         C                  PAGE
'Abfrageschleife'	MACRO-80 3.44	09-Dec-81	PAGE	1-74


                         C      
  D2F5    FE 23          C      TA.ABF10:   CP      '#'                 ;Kodegruppe 5,6,7
  D2F7    28 1C          C                  JR      Z,TA.ABF12
  D2F9    FE 24          C                  CP      '$'
  D2FB    28 18          C                  JR      Z,TA.ABF12
  D2FD    FE 40          C                  CP      40H
  D2FF    38 0E          C                  JR      C,TA.ABF11
  D301    FE 7B          C                  CP      7BH
  D303    30 0A          C                  JR      NC,TA.ABF11
  D305    FE 61          C                  CP      61H
  D307    30 12          C                  JR      NC,TA.ABF13
  D309    FE 5B          C                  CP      5BH
  D30B    30 02          C                  JR      NC,TA.ABF11
  D30D    18 06          C                  JR      TA.ABF12
                         C      
  D30F    CB 66          C      TA.ABF11:   BIT     4,(HL)              ;Kodegruppe 5   !"%&'()*/:;<=>?[\]^_{|}`~
  D311    28 0E          C                  JR      Z,TA.TFE
  D313    18 91          C                  JR      TA.ABF2
                         C      
  D315    CB 6E          C      TA.ABF12:   BIT     5,(HL)              ;Kodegruppe 6   A bis Z , @ # $
  D317    28 08          C                  JR      Z,TA.TFE
  D319    18 8B          C                  JR      TA.ABF2
                         C      
  D31B    CB 76          C      TA.ABF13:   BIT     6,(HL)              ;Kodegruppe 7   a bis z
  D31D    28 02          C                  JR      Z,TA.TFE
  D31F    18 85          C                  JR      TA.ABF2
                         C      
                         C      ;****************************************************************
                         C      ;*             Warten auf Tastenende                            *
                         C      ;****************************************************************
  D321    AF             C      TA.TFE:     XOR     A                   ;warten auf Tastenende
  D322    32 B242        C                  LD      (TS.ZSMER),A
  D325    32 B246        C                  LD      (TS.ZSTC),A
  D328    3A B247        C                  LD      A,(TS.MIO)
  D32B    B7             C                  OR      A
  D32C    C0             C                  RET     NZ
                         C      
  D32D    CD D1BB        C                  CALL    TA.TRTFE
                         C      
  D330    C9             C                  RET
                         C      
                         C                  PAGE
'Abfrageschleife'	MACRO-80 3.44	09-Dec-81	PAGE	1-75


                         C      
  D331    FE FC          C      TA.ABF20:   CP      0FCH                ;Funktionstasten   Code > 7FH
  D333    D2 D385        C                  JP      NC,TA.EW1           ;Ebenenumschalter E=0 - E=3
  D336    FE F0          C                  CP      0F0H
  D338    D2 D3A3        C                  JP      NC,TA.STEUT         ;Kursorsteuertasten
  D33B    FE D0          C                  CP      0D0H
  D33D    D2 D3D5        C                  JP      NC,TA.STZ           ;Hexatasten 00H - 1FH
  D340    FE CA          C                  CP      0CAH
  D342    D2 D3DA        C                  JP      NC,TA.FKT2          ;Fkt.tasten 00,000,NEG QUIT,SYS,END,ABS
  D345    FE C0          C                  CP      0C0H
  D347    D2 D3F7        C                  JP      NC,TA.HZE           ;Hexatasten 0 - 9
  D34A    21 B23F        C                  LD      HL,TS.SPMER
  D34D    CB 7E          C                  BIT     7,(HL)
  D34F    28 D0          C                  JR      Z,TA.TFE
  D351    FE B0          C                  CP      0B0H
  D353    D2 D3EF        C                  JP      NC,TA.FKT1          ;Fkt.tasten POS QUIT,TABS,TABL,USP1,USP2
                         C      ;
  D356    AF             C                  XOR     A                   ;Fkt.tasten P1 - P12
  D357    21 B23E        C                  LD      HL,TS.EMERK
  D35A    BE             C                  CP      (HL)
  D35B    28 21          C                  JR      Z,TA.EAW4
  D35D    21 B23E        C                  LD      HL,TS.EMERK
  D360    46             C                  LD      B,(HL)
  D361    3A B23C        C                  LD      A,(TS.TK)
  D364    D6 80          C                  SUB     80H
  D366    C6 0C          C      TA.EAW2:    ADD     A,12
  D368    10 FC          C                  DJNZ    TA.EAW2
  D36A    3C             C      TA.EAW3:    INC     A
  D36B    32 B23D        C                  LD      (TS.PTK),A
  D36E    3D             C                  DEC     A
  D36F    87             C                  ADD     A,A
  D370    06 00          C                  LD      B,0
  D372    4F             C                  LD      C,A
  D373    21 B19F        C                  LD      HL,TS.TAB1
  D376    09             C                  ADD     HL,BC
  D377    7E             C      TA.ABFR9:   LD      A,(HL)
  D378    23             C                  INC     HL
  D379    66             C                  LD      H,(HL)
  D37A    6F             C                  LD      L,A
  D37B    C3 D2A9        C                  JP      TA.ABF3
  D37E    3A B23C        C      TA.EAW4:    LD      A,(TS.TK)
  D381    D6 80          C                  SUB     80H
  D383    18 E5          C                  JR      TA.EAW3
                         C      
  D385    21 B23F        C      TA.EW1:     LD      HL,TS.SPMER         ;Funktionstasten FCH - FFH
  D388    CB 7E          C                  BIT     7,(HL)
  D38A    CA D321        C                  JP      Z,TA.TFE
  D38D    2F             C                  CPL
  D38E    32 B23E        C                  LD      (TS.EMERK),A
  D391    CD C67C        C                  CALL    S1.STAT
                         C      
  D394    CD D224        C                  CALL    TA.BBB
  D397    CD D1E5        C                  CALL    TA.TEM
                         C      
  D39A    3A B23E        C                  LD      A,(TS.EMERK)
  D39D    21 B233        C                  LD      HL,TS.TAB5
  D3A0    C3 D3E7        C                  JP      TA.FKT3
                         C      
                         C                  PAGE
'Abfrageschleife'	MACRO-80 3.44	09-Dec-81	PAGE	1-76


                         C      
  D3A3    21 B23F        C      TA.STEUT:   LD      HL,TS.SPMER         ;Funktionstasten F0H - FBH
  D3A6    CB 7E          C                  BIT     7,(HL)
  D3A8    CA D321        C                  JP      Z,TA.TFE
  D3AB    FE F0          C                  CP      0F0H
  D3AD    28 0D          C                  JR      Z,TA.INSMD
  D3AF    D6 F0          C                  SUB     0F0H
  D3B1    87             C                  ADD     A,A
  D3B2    06 00          C      TA.STEU1:   LD      B,0
  D3B4    4F             C                  LD      C,A
  D3B5    21 B1FF        C                  LD      HL,TS.TAB2
  D3B8    09             C                  ADD     HL,BC
  D3B9    C3 D377        C                  JP      TA.ABFR9
                         C      
  D3BC    3A B240        C      TA.INSMD:   LD      A,(TS.UMERK)
  D3BF    B7             C                  OR      A
  D3C0    28 03          C                  JR      Z,TA.INSME
  D3C2    3D             C                  DEC     A                   ;INS_MOD ausschalten
  D3C3    18 01          C                  JR      TA.INSML
  D3C5    3C             C      TA.INSME:   INC     A                   ;INS_MOD einschalten
  D3C6    32 B240        C      TA.INSML:   LD      (TS.UMERK),A
                         C      
  D3C9    CD D224        C                  CALL    TA.BBB
  D3CC    CD D1D0        C                  CALL    TA.TIM
                         C      
  D3CF    CD C67C        C                  CALL    S1.STAT
  D3D2    AF             C                  XOR     A
  D3D3    18 DD          C                  JR      TA.STEU1
                         C      
  D3D5    D6 D0          C      TA.STZ:     SUB     0D0H                ;Funktionstasten D0H - EFH
  D3D7    C3 D297        C                  JP      TA.ABF1
                         C      
  D3DA    21 B23F        C      TA.FKT2:    LD      HL,TS.SPMER         ;Fkt.tasten 00,000,NEG QUIT,SYS,END,ABS
  D3DD    CB 7E          C                  BIT     7,(HL)
  D3DF    CA D321        C                  JP      Z,TA.TFE
  D3E2    D6 CA          C                  SUB     0CAH
  D3E4    21 B217        C                  LD      HL,TS.TAB3
  D3E7    87             C      TA.FKT3:    ADD     A,A
  D3E8    06 00          C                  LD      B,0
  D3EA    4F             C                  LD      C,A
  D3EB    09             C                  ADD     HL,BC
  D3EC    C3 D377        C                  JP      TA.ABFR9
                         C      
  D3EF    D6 B0          C      TA.FKT1:    SUB     0B0H                ;Fkt.tasten POS QUIT,TABS,TABL,USP1,USP2
  D3F1    87             C                  ADD     A,A
  D3F2    21 B223        C                  LD      HL,TS.TAB4
  D3F5    18 F0          C                  JR      TA.FKT3
                         C      
  D3F7    D6 90          C      TA.HZE:     SUB     90H                 ;Hexatasten 0 - 9
  D3F9    C3 D297        C                  JP      TA.ABF1
                         C      
  D3FC    2A B22F        C      TA.ET2:     LD      HL,(TS.TABU)
  D3FF    C3 D2A9        C                  JP      TA.ABF3
                         C      
  D402    2A B231        C      TA.ET1:     LD      HL,(TS.NEWL)
  D405    C3 D2A9        C                  JP      TA.ABF3
                         C                  PAGE
'Abfrageschleife'	MACRO-80 3.44	09-Dec-81	PAGE	1-77


                         C      
                         C      ;****************************************************************
                         C      ;*               loeschen aller Tastenroutinenadressen          *
                         C      ;****************************************************************
  D408    AF             C      TA.LOE:     XOR     A
  D409    32 B23F        C                  LD      (TS.SPMER),A
  D40C    21 B19F        C                  LD      HL,TS.TAB1
  D40F    36 00          C                  LD      (HL),0
  D411    11 B1A0        C                  LD      DE,TS.TAB1+1
  D414    01 009B        C                  LD      BC,TS.PTAST-TS.TAB1-1
  D417    ED B0          C                  LDIR
  D419    21 C354        C                  LD      HL,S1.HCOPY
  D41C    22 B21F        C                  LD      (TS.TAB3+8),HL
  D41F    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*               wie LOE  , zusaetzlich werden Standardroutinen *
                         C      ;*               eingetragen: Cursortasten , DEL LINE , SYS ,   *
                         C      ;*                            alphanum. Tasten                  *
                         C      ;****************************************************************
  D420    CD D408        C      TA.LOES:    CALL    TA.LOE
  D423    21 D42F        C                  LD      HL,TA.TRTAB
  D426    11 B1FF        C                  LD      DE,TS.TAB2
  D429    01 0034        C                  LD      BC,TS.TAB5-TS.TAB2
  D42C    ED B0          C                  LDIR
  D42E    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*               Standardbelegung der Tastaturadress-Tabellen   *
                         C      ;****************************************************************
  D42F    0000           C      TA.TRTAB:   DW      0                   ;TS.TAB2   INS MOD
  D431    0000           C                  DW      0                   ;          DEL
  D433    0000           C                  DW      0                   ;          INS LINE
  D435    C304           C                  DW      S1.DELZL            ;          DEL LINE
                         C      
  D437    0000           C                  DW      0                   ;          SCH LINKS
  D439    C2EB           C                  DW      S1.CNOS             ;          C   HOCH
  D43B    0000           C                  DW      0                   ;          SCH RECHTS
  D43D    C2D3           C                  DW      S1.CNLS             ;          C   LINKS
  D43F    C2F7           C                  DW      S1.HOME             ;          HOME
  D441    C2B4           C                  DW      S1.CNRS             ;          C   RECHTS
  D443    C300           C                  DW      S1.CNZA             ;          CNZA
  D445    C2DF           C                  DW      S1.CNUS             ;          C   RUNTER
                         C      
  D447    C334           C                  DW      S1.NN               ;TS.TAB3   00
  D449    C345           C                  DW      S1.NNN              ;          000
  D44B    0000           C                  DW      0                   ;          NEG QUIT
  D44D    C114           C                  DW      S1.SYSTB            ;          SYS
  D44F    C354           C                  DW      S1.HCOPY            ;          HCOPY
  D451    0000           C                  DW      0                   ;          ABS
                         C      
  D453    0000           C                  DW      0                   ;TS.TAB4   POS QUIT
  D455    0000           C                  DW      0                   ;          TABS
  D457    0000           C                  DW      0                   ;          TABL
  D459    0000           C                  DW      0                   ;          CI
  D45B    0000           C                  DW      0                   ;          M
                         C      
  D45D    C328           C                  DW      S1.AEIN             ;TS.EINA
                         C      
  D45F    0000           C                  DW      0                   ;TS.TABU
                         C      
  D461    0000           C                  DW      0                   ;TS.NEWL
                         C      
                         C                  TITLE   'Warteschleife'
                         C                  PAGE
'Warteschleife'	MACRO-80 3.44	09-Dec-81	PAGE	1-78


                         C      
                         C      ;****************************************************************
                         C      ;*               Warteschleife fuer Schnellschreiben            *
                         C      ;****************************************************************
  D463    DD E5          C      TA.WART:    PUSH    IX
  D465    DD 21 B243     C                  LD      IX,TS.ZEIT1
  D469    DD 7E 01       C      TA.WART0:   LD      A,(IX+1)
  D46C    DD 96 00       C                  SUB     (IX+0)
  D46F    DD 77 02       C                  LD      (IX+2),A
  D472    06 82          C                  LD      B,130
  D474    3A B242        C      TA.WART1:   LD      A,(TS.ZSMER)
  D477    B7             C                  OR      A
  D478    28 27          C                  JR      Z,TA.WART2
  D47A    C5             C                  PUSH    BC
  D47B    CD D13D        C                  CALL    TA.TA1
  D47E    C1             C                  POP     BC
  D47F    20 20          C                  JR      NZ,TA.WART2
  D481    C5             C                  PUSH    BC
  D482    CD D155        C                  CALL    TA.TA2
  D485    C1             C                  POP     BC
  D486    21 B23C        C                  LD      HL,TS.TK
  D489    BE             C                  CP      (HL)
  D48A    20 15          C                  JR      NZ,TA.WART2
  D48C    10 E6          C                  DJNZ    TA.WART1
  D48E    3A B246        C                  LD      A,(TS.ZSTC)
  D491    DD BE 02       C                  CP      (IX+2)
  D494    38 05          C                  JR      C,TA.WART3
  D496    DD BE 01       C                  CP      (IX+1)
  D499    28 0B          C                  JR      Z,TA.WART4
  D49B    3C             C      TA.WART3:   INC     A
  D49C    32 B246        C                  LD      (TS.ZSTC),A
  D49F    18 C8          C                  JR      TA.WART0
                         C      
  D4A1    DD E1          C      TA.WART2:   POP     IX
  D4A3    C3 D321        C                  JP      TA.TFE
                         C      
  D4A6    DD 7E 02       C      TA.WART4:   LD      A,(IX+2)
  D4A9    32 B246        C                  LD      (TS.ZSTC),A
  D4AC    AF             C                  XOR     A
  D4AD    32 B23C        C                  LD      (TS.TK),A
  D4B0    DD E1          C                  POP     IX
  D4B2    C9             C                  RET
                         C      
                         C      
                         C      ;           END
                         C      ;           PN      K158
                         C                  TITLE   'Basisroutinen Kassette'
                         C                  PAGE
'Basisroutinen Kassette'	MACRO-80 3.44	09-Dec-81	PAGE	1-79


                         C      
                         C      ;****************************************************************
                         C      ;*               Basisroutinen Kassette                         *
                         C      ;*  Version      -----------------------------------------------*
                         C      ;*               Programmierer: M. Herbote --- K EAW  ZFT (WFT) *
                         C      ;*  V 2 . 1      -----------------------------------------------*
                         C      ;*               Stand        : 10.April 1984                   *
                         C      ;****************************************************************
                         C      
                         C      
                         C      ;****************************************************************
                         C      ;*                                                              *
                         C      ;*   Die unterste Schicht wird von der  ROBOTRON - OEM-Routine  *
                         C      ;*   gebildet. Sie enthaelt die Routinen:                       *
                         C      ;*   INIT  ...   Initialisieren der  AKB - PIO s  und           *
                         C      ;*   BRKMB ...   Ausfuehrung eines Kassettenkommandos           *
                         C      ;*                                                              *
                         C      ;*   Nachfolgende Tabelle zeigt die implementierten Basis-      *
                         C      ;*   routinen und ihre Kommandos.                               *
                         C      ;*                                                              *
                         C      ;*   symb. Adr. OEM-Komm. SYS-Komm.                             *
                         C      ;*   ---------------------------------------------------------  *
                         C      ;*   GNRE       31H       KiRE      reservieren ein             *
                         C      ;*   GNRA       41H                 reservieren aus             *
                         C      ;*                        KiRA      enthaelt GNRE,GNRW,GNRA     *
                         C      ;*   GNRW       21H       KiRW      rewind                      *
                         C      ;*   GNRP                 KiR+      einen  Block vor            *
                         C      ;*   GNRM                 KiR-      einen  Block zurueck        *
                         C      ;*   GNLP       71H       KiL+      eine   Datei vor            *
                         C      ;*   GNLPN                          um (D) Dateien vor          *
                         C      ;*   GNLM       75H       KiL-      eine   Datei zurueck        *
                         C      ;*   GNLMN                          um (D) Dateien zurueck      *
                         C      ;*   GNCLS   51,61,15,11H KiCL      Abschluss einer Ausg.datei  *
                         C      ;*                                                              *
                         C      ;*   GNRD       02H                 einen  Block  ==>  KS.PUFFS *
                         C      ;*   GNRDR                KiXA,-XE  (K2.TXANF-K2.TXEND) fuellen *
                         C      ;*   EIN                            S0.PFFI  fuellen            *
                         C      ;*   EINP                           einen  Block  ==>  S0.PFFI  *
                         C      ;*   LESV                           Eingabe eines Zeichens vw.  *
                         C      ;*   LESR                           Eingabe eines Zeichens rw.  *
                         C      ;*                                                              *
                         C      ;*   GNWR       00H                 einen  Block ausgeben       *
                         C      ;*   GNWRT                KiY       (K2.TXANF-K2.TXEND) ausgeben*
                         C      ;*   AUS                            S0.PFFA  ausgeben           *
                         C      ;*   SCHR                           Ausgabe eines Zeichens      *
                         C      ;*                                                              *
                         C      ;*   GNRWR      08H                 einen  Block zurueckschr.   *
                         C      ;*                                                              *
                         C      ;*   MRCAT                          Zugriff auf MRES-Katalog    *
                         C      ;*   MREPO                KiME      MRES-Eingabedatei eroeffnen *
                         C      ;*   MRAPO                KiMA      MRES-Ausgabedatei eroeffnen *
                         C      ;*   MRCLS                KiMC      MRES-Ausgabedatei abschl.   *
                         C      ;*                                                              *
                         C      ;****************************************************************
                         C      
  D4B3    20 46 65 68    C      K1.ADRK1:   DB      ' Fehler- Status:    .. Nummer:    ..  '
  D4B7    6C 65 72 2D    C      
  D4BB    20 53 74 61    C      
  D4BF    74 75 73 3A    C      
  D4C3    20 20 20 20    C      
  D4C7    2E 2E 20 4E    C      
  D4CB    75 6D 6D 65    C      
  D4CF    72 3A 20 20    C      
  D4D3    20 20 2E 2E    C      
  D4D7    20 20          C      
  D4D9    20 47 65 72    C      K1.ADRK2:   DB      ' Ger: .   Datei:  ....   Satz:  ....  '
  D4DD    3A 20 2E 20    C      
  D4E1    20 20 44 61    C      
  D4E5    74 65 69 3A    C      
  D4E9    20 20 2E 2E    C      
  D4ED    2E 2E 20 20    C      
  D4F1    20 53 61 74    C      
  D4F5    7A 3A 20 20    C      
  D4F9    2E 2E 2E 2E    C      
  D4FD    20 20          C      
  D4FF    20 20 20 4B    C      K1.ADRK3:   DB      '   Kassette fuehrt ein Kommando aus   '
  D503    61 73 73 65    C      
  D507    74 74 65 20    C      
  D50B    66 75 65 68    C      
  D50F    72 74 20 65    C      
  D513    69 6E 20 4B    C      
  D517    6F 6D 6D 61    C      
'Basisroutinen Kassette'	MACRO-80 3.44	09-Dec-81	PAGE	1-80


  D51B    6E 64 6F 20    C      
  D51F    61 75 73 20    C      
  D523    20 20          C      
  D525    20 20 20 20    C      K1.ADRK4:   DB      '                                      '
  D529    20 20 20 20    C      
  D52D    20 20 20 20    C      
  D531    20 20 20 20    C      
  D535    20 20 20 20    C      
  D539    20 20 20 20    C      
  D53D    20 20 20 20    C      
  D541    20 20 20 20    C      
  D545    20 20 20 20    C      
  D549    20 20          C      
                         C      
                         C                  TITLE   'K M B G  allgemeine Unterprogramme'
                         C                  PAGE
'K M B G  allgemeine Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-81


                         C      
                         C      ;****************************************************************
                         C      ;*  K M B G      Aktivierung Geraeteroutine                     *
                         C      ;****************************************************************
  D54B    DD E5          C      K1.ARMB:    PUSH    IX
  D54D    FD E5          C                  PUSH    IY
  D54F    CD D630        C                  CALL    K1.MVS              ;Anzeige Kassettengeraet arbeitet
  D552    2A B132        C                  LD      HL,(K2.FKADR)
  D555    11 D4FF        C                  LD      DE,K1.ADRK3
  D558    CD D60F        C                  CALL    K1.MONI
  D55B    CD D647        C                  CALL    K1.MVL
  D55E    DD 36 05 6C    C                  LD      (IX+5),LOW(K1.ARMB1)
  D562    DD 36 06 D5    C                  LD      (IX+6),HIGH(K1.ARMB1)
  D566    CD F61C        C      K1.ARMBM:   CALL    S0.KRZU             ;BAMOS-Routine zuschalten
                         C      ;            CALL    0   ;??? KR.BRKMB            ;Ausfuehrung Kassettenkommando
  D569    76             C      K1.ARMB0:   HALT                        ;warten auf Routinen-Ende
  D56A    18 FD          C                  JR      K1.ARMB0
  D56C    33             C      K1.ARMB1:   INC     SP                  ;stack-pointer korrigieren
  D56D    33             C                  INC     SP
  D56E    CD B2D4        C                  CALL    S2.STACK            ;BAMOS-Routine wegschalten
  D571    FD E1          C                  POP     IY
  D573    DD E1          C                  POP     IX
  D575    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*  K M B G      Fehlertest nach CALL ARMB                      *
                         C      ;****************************************************************
  D576    DD CB 00 7E    C      K1.ARBT:    BIT     7,(IX+0)
  D57A    C2 D664        C                  JP      NZ,K1.ERRT
  D57D    CD D620        C                  CALL    K1.FL
  D580    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*  K M B G      Unterprogramme fuer RCZx +- 1 und BLKx +-1     *
                         C      ;****************************************************************
  D581    FD 66 FF       C      K1.BLKP:    LD      H,(IY-1)            ;BLK x  +  1
  D584    FD 6E FE       C                  LD      L,(IY-2)
  D587    23             C                  INC     HL
  D588    FD 74 FF       C                  LD      (IY-1),H
  D58B    FD 75 FE       C                  LD      (IY-2),L
  D58E    C9             C                  RET
                         C      
  D58F    FD 66 FF       C      K1.BLKM:    LD      H,(IY-1)            ;BLK x  -  1
  D592    FD 6E FE       C                  LD      L,(IY-2)
  D595    2B             C                  DEC     HL
  D596    FD 74 FF       C                  LD      (IY-1),H
  D599    FD 75 FE       C                  LD      (IY-2),L
  D59C    C9             C                  RET
                         C      
  D59D    FD 66 FD       C      K1.RCZP:    LD      H,(IY-3)            ;RCZ x  +  1
  D5A0    FD 6E FC       C                  LD      L,(IY-4)
  D5A3    23             C                  INC     HL
  D5A4    FD 74 FD       C                  LD      (IY-3),H
  D5A7    FD 75 FC       C                  LD      (IY-4),L
  D5AA    C9             C                  RET
                         C      
  D5AB    FD 66 FD       C      K1.RCZM:    LD      H,(IY-3)            ;RCZ x  -  1
  D5AE    FD 6E FC       C                  LD      L,(IY-4)
  D5B1    2B             C                  DEC     HL
  D5B2    FD 74 FD       C                  LD      (IY-3),H
  D5B5    FD 75 FC       C                  LD      (IY-4),L
  D5B8    C9             C                  RET
                         C      
                         C                  PAGE
'K M B G  allgemeine Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-82


                         C      
                         C      ;****************************************************************
                         C      ;*  K M B G      RCZx loeschen                                  *
                         C      ;****************************************************************
  D5B9    AF             C      K1.RCZN:    XOR     A                   ;RCZ x  :=  0
  D5BA    FD 77 FD       C      K1.RCZS:    LD      (IY-3),A            ;RCZ x  :=  (A)
  D5BD    FD 77 FC       C                  LD      (IY-4),A
  D5C0    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*  K M B G      HL und BC laden aus E/A-Tabelle                *
                         C      ;****************************************************************
  D5C1    DD 66 08       C      K1.LHLBC:   LD      H,(IX+8)
  D5C4    DD 6E 07       C                  LD      L,(IX+7)
  D5C7    DD 46 09       C                  LD      B,(IX+9)
  D5CA    DD 4E 0A       C                  LD      C,(IX+10)
  D5CD    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*  K M B G      Bandmarke gelesen ?                            *
                         C      ;****************************************************************
  D5CE    DD 7E 09       C      K1.BM:      LD      A,(IX+9)
  D5D1    DD B6 0A       C                  OR      (IX+10)
  D5D4    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*  K M B G      zweiter Leseversuch nach Fehler 17             *
                         C      ;****************************************************************
  D5D5    DD 7E 01       C      K1.F17:     LD      A,(IX+1)            ;Fehlerbyte
  D5D8    FE 17          C                  CP      17H
  D5DA    C0             C                  RET     NZ
  D5DB    DD 36 04 15    C                  LD      (IX+4),15H          ;CMD einen Block zurueck
  D5DF    CD D54B        C                  CALL    K1.ARMB
  D5E2    CD D576        C                  CALL    K1.ARBT
  D5E5    DD 36 04 02    C                  LD      (IX+4),02H          ;CMD Wiedergabe
  D5E9    CD D54B        C                  CALL    K1.ARMB
  D5EC    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*  K M B G      IX und IY  mit Anfangswerten laden             *
                         C      ;****************************************************************
  D5ED    DD 21 0013     C      K1.RGL1:    LD      IX,S3.KS1-S3.SEAT
  D5F1    11 A803        C                  LD      DE,S0.DEAT+3
  D5F4    DD 19          C                  ADD     IX,DE
  D5F6    FD 21 00AA     C                  LD      IY,S3.KSK1-S3.SEAT
  D5FA    13             C                  INC     DE
  D5FB    FD 19          C                  ADD     IY,DE
  D5FD    C9             C                  RET
                         C      
  D5FE    DD 21 002D     C      K1.RGL2:    LD      IX,S3.KS2-S3.SEAT
  D602    11 A803        C                  LD      DE,S0.DEAT+3
  D605    DD 19          C                  ADD     IX,DE
  D607    FD 21 00CE     C                  LD      IY,S3.KSK2-S3.SEAT
  D60B    13             C                  INC     DE
  D60C    FD 19          C                  ADD     IY,DE
  D60E    C9             C                  RET
                         C      
                         C                  PAGE
'K M B G  allgemeine Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-83


                         C      
                         C      ;****************************************************************
                         C      ;*  K M B G      Anzeigetext    ===>    K2.S/F-KADR             *
                         C      ;****************************************************************
  D60F    25             C      K1.MONI:    DEC     H                   ;(HL) ...  K2.S/F-KADR
  D610    2D             C                  DEC     L                   ;(DE) ...  ADRKi
  D611    22 B18C        C                  LD      (MS.ZPOS),HL
  D614    EB             C                  EX      DE,HL
  D615    06 26          C                  LD      B,38
  D617    3E 18          C                  LD      A,24
  D619    32 B198        C                  LD      (MS.CMD),A
  D61C    CD CB10        C                  CALL    MO.MONI
  D61F    C9             C                  RET
                         C      
  D620    CD D630        C      K1.FL:      CALL    K1.MVS              ;Fehlerzeile loeschen
  D623    2A B132        C                  LD      HL,(K2.FKADR)
  D626    11 D525        C                  LD      DE,K1.ADRK4
  D629    CD D60F        C                  CALL    K1.MONI
  D62C    CD D647        C                  CALL    K1.MVL
  D62F    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*  K M B G      Monitorvektor retten und wiederherstellen      *
                         C      ;***************************************************************
  D630    21 B18A        C      K1.MVS:     LD      HL,MS.ZPOL
  D633    11 B162        C                  LD      DE,K2.RBER
  D636    01 0015        C                  LD      BC,21
  D639    ED B0          C                  LDIR
  D63B    21 DE8C        C                  LD      HL,K1.ZMIN
  D63E    11 B18E        C                  LD      DE,MS.ZMIN
  D641    01 000A        C                  LD      BC,10
  D644    ED B0          C                  LDIR
  D646    C9             C                  RET
                         C      
  D647    21 B162        C      K1.MVL:     LD      HL,K2.RBER
  D64A    11 B18A        C                  LD      DE,MS.ZPOL
  D64D    01 0015        C                  LD      BC,21
  D650    ED B0          C                  LDIR
  D652    C9             C                  RET
                         C      
  D653    E5             C      K1.ZPR2:    PUSH    HL
  D654    C5             C                  PUSH    BC
  D655    ED 6F          C                  RLD
  D657    E6 0F          C                  AND     0FH
  D659    C6 30          C                  ADD     A,30H
  D65B    FE 3A          C                  CP      3AH
  D65D    38 02          C                  JR      C,K1.ZPR3
  D65F    C6 07          C                  ADD     A,7
  D661    C1             C      K1.ZPR3:    POP     BC
  D662    E1             C                  POP     HL
  D663    C9             C                  RET
                         C      
                         C                  PAGE
'K M B G  allgemeine Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-84


                         C      
                         C      ;****************************************************************
                         C      ;*  K M B G      Anzeige Geraetefehler                          *
                         C      ;****************************************************************
  D664    CD D630        C      K1.ERRT:    CALL    K1.MVS
  D667    21 D4B3        C                  LD      HL,K1.ADRK1
  D66A    11 B13A        C                  LD      DE,K2.ADRK
  D66D    01 0026        C                  LD      BC,38
  D670    ED B0          C                  LDIR
  D672    DD E5          C                  PUSH    IX
  D674    DD E5          C                  PUSH    IX
  D676    DD 21 B13A     C                  LD      IX,K2.ADRK
  D67A    E1             C                  POP     HL                  ;Statusaufbereitung
  D67B    CD D653        C                  CALL    K1.ZPR2
  D67E    DD 77 14       C                  LD      (IX+20),A
  D681    CD D653        C                  CALL    K1.ZPR2
  D684    DD 77 15       C                  LD      (IX+21),A
  D687    36 00          C                  LD      (HL),0              ;reset status
  D689    23             C                  INC     HL                  ;Fehleraufbereitung
  D68A    CD D653        C                  CALL    K1.ZPR2
  D68D    DD 77 22       C                  LD      (IX+34),A
  D690    CD D653        C                  CALL    K1.ZPR2
  D693    DD 77 23       C                  LD      (IX+35),A
  D696    36 00          C                  LD      (HL),0              ;reset fehler
  D698    2A B132        C                  LD      HL,(K2.FKADR)
  D69B    11 B13A        C                  LD      DE,K2.ADRK
  D69E    CD D60F        C                  CALL    K1.MONI
  D6A1    DD E1          C                  POP     IX
  D6A3    CD D647        C                  CALL    K1.MVL
  D6A6    CD D6B1        C                  CALL    K1.GNSTS
  D6A9    AF             C                  XOR     A                   ;Tastaturroutine ruecksetzen auf Tasteneingabe
  D6AA    32 B247        C                  LD      (TS.MIO),A
  D6AD    2A B136        C                  LD      HL,(K2.FRADR)
  D6B0    E9             C                  JP      (HL)
                         C      ;****************************************************************
                         C      ;*  K M B G    Anzeige STATUS                                   *
                         C      ;****************************************************************
  D6B1    CD D630        C      K1.GNSTS:   CALL    K1.MVS
  D6B4    FD 6E FC       C                  LD      L,(IY-4)            ;RCZ:=RCZx
  D6B7    FD 66 FD       C                  LD      H,(IY-3)
  D6BA    22 B11C        C                  LD      (K2.RCZ),HL
  D6BD    FD 6E FE       C                  LD      L,(IY-2)            ;BLK:=BLKx
  D6C0    FD 66 FF       C                  LD      H,(IY-1)
  D6C3    22 B11E        C                  LD      (K2.BLK),HL
  D6C6    21 D4D9        C                  LD      HL,K1.ADRK2
  D6C9    11 B13A        C                  LD      DE,K2.ADRK
  D6CC    01 0026        C                  LD      BC,38
  D6CF    ED B0          C                  LDIR
  D6D1    11 B140        C                  LD      DE,K2.ADRK+6
  D6D4    DD 7E 03       C                  LD      A,(IX+3)            ;Geraeteadressenaufbereitung
  D6D7    C6 30          C                  ADD     A,30H
  D6D9    12             C                  LD      (DE),A
  D6DA    2A B11E        C                  LD      HL,(K2.BLK)         ;Blockzaehleraufbereitung
  D6DD    11 B14B        C                  LD      DE,K2.ADRK+17
  D6E0    CD C54E        C                  CALL    S1.HDI
  D6E3    2A B11C        C                  LD      HL,(K2.RCZ)         ;Satzzaehleraufbereitung
  D6E6    11 B159        C                  LD      DE,K2.ADRK+31
  D6E9    CD C54E        C                  CALL    S1.HDI
  D6EC    2A B134        C                  LD      HL,(K2.SKADR)
  D6EF    11 B13A        C                  LD      DE,K2.ADRK
  D6F2    CD D60F        C                  CALL    K1.MONI
  D6F5    CD D647        C                  CALL    K1.MVL
  D6F8    C9             C                  RET
                         C                  TITLE   'K M B G  reservieren ein/aus und rewind'
                         C      
                         C      ;****************************************************************
                         C      ;*  K M B G    Reservieren Geraet x ein                         *
                         C      ;****************************************************************
  D6F9    DD 36 04 31    C      K1.GNRE1:   LD      (IX+4),31H          ;CMD reservieren ein
  D6FD    CD D54B        C                  CALL    K1.ARMB
  D700    DD CB 00 66    C                  BIT     4,(IX)
  D704    C4 D664        C                  CALL    NZ,K1.ERRT
  D707    C9             C                  RET
  D708    CD D6F9        C      K1.GNRE:    CALL    K1.GNRE1
  D70B    CD D6F9        C                  CALL    K1.GNRE1
  D70E    CD D620        C                  CALL    K1.FL
  D711    DD CB FF 4E    C                  BIT     1,(IX-1)
  D715    C0             C                  RET     NZ
  D716    CD D5B9        C                  CALL    K1.RCZN             ;RCZx:=0
  D719    FD 77 FF       C                  LD      (IY-1),A            ;BLKx:=1
  D71C    3C             C                  INC     A
  D71D    FD 77 FE       C                  LD      (IY-2),A
'K M B G  reservieren ein/aus und rewind'	MACRO-80 3.44	09-Dec-81	PAGE	1-85


  D720    DD CB FF CE    C                  SET     1,(IX-1)
  D724    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*  K M B G    Reservieren Geraet x aus                         *
                         C      ;****************************************************************
  D725    DD 36 04 41    C      K1.GNRA:    LD      (IX+4),41H          ;CMD reservieren aus
  D729    CD D54B        C                  CALL    K1.ARMB
  D72C    CD D576        C                  CALL    K1.ARBT
  D72F    DD CB FF 8E    C                  RES     1,(IX-1)            ;OPEN-bit           zuruecksetzen
  D733    DD CB FF 96    C                  RES     2,(IX-1)            ;Richtungsbit       zuruecksetzen
  D737    DD CB FF 9E    C                  RES     3,(IX-1)            ;Verarbeitungsbit   zuruecksetzen
  D73B    DD CB FF A6    C                  RES     4,(IX-1)            ;Konvertierungsbit  zuruecksetzen
  D73F    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*  K M B G    REWIND - Routine                                 *
                         C      ;****************************************************************
  D740    CD D751        C      K1.GNRW:    CALL    K1.RW3
  D743    CD D5B9        C                  CALL    K1.RCZN             ;RCZx:=0
  D746    FD 77 FF       C                  LD      (IY-1),A            ;BLKx:=1
  D749    3C             C                  INC     A
  D74A    FD 77 FE       C                  LD      (IY-2),A
  D74D    CD D620        C                  CALL    K1.FL
  D750    C9             C                  RET
  D751    DD 36 04 21    C      K1.RW3:     LD      (IX+4),21H          ;CMD  rewind
  D755    CD D54B        C                  CALL    K1.ARMB
  D758    CD D75E        C      K1.RW1:     CALL    K1.BERT
  D75B    D0             C                  RET     NC
  D75C    18 FA          C                  JR      K1.RW1
                         C      
  D75E    CD F61C        C      K1.BERT:    CALL    S0.KRZU
                         C      ;            CALL    0   ;??? KR.BERT
  D761    CD B2D4        C                  CALL    S2.STACK
  D764    C9             C                  RET
                         C      
                         C                  TITLE   'K M B G  set RCD +- 1'
                         C                  PAGE
'K M B G  set RCD +- 1'	MACRO-80 3.44	09-Dec-81	PAGE	1-86


                         C      
                         C      ;****************************************************************
                         C      ;*  K M B G    set record + 1                                   *
                         C      ;****************************************************************
  D765    DD 36 04 02    C      K1.GNRP:    LD      (IX+4),02H          ;CMD wiedergabe
  D769    CD D54B        C                  CALL    K1.ARMB
  D76C    CD D576        C                  CALL    K1.ARBT
  D76F    CD D59D        C                  CALL    K1.RCZP
  D772    CD D5CE        C                  CALL    K1.BM               ;RCD = BM ?
  D775    06 00          C                  LD      B,0
  D777    C0             C                  RET     NZ
  D778    04             C                  INC     B
  D779    CD D581        C                  CALL    K1.BLKP
  D77C    CD D5B9        C                  CALL    K1.RCZN             ;RCZx:=0
  D77F    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*  K M B G    set record - 1                                   *
                         C      ;****************************************************************
  D780    DD 36 04 15    C      K1.GNRM:    LD      (IX+4),15H          ;CMD einen block zurueck
  D784    CD D54B        C                  CALL    K1.ARMB
  D787    CD D576        C                  CALL    K1.ARBT
  D78A    DD 36 04 02    C                  LD      (IX+4),02H          ;CMD wiedergabe
  D78E    CD D54B        C                  CALL    K1.ARMB
  D791    CD D576        C                  CALL    K1.ARBT
  D794    DD 36 04 15    C                  LD      (IX+4),15H          ;CMD einen block zurueck
  D798    CD D54B        C                  CALL    K1.ARMB
  D79B    CD D576        C                  CALL    K1.ARBT
  D79E    CD D5AB        C                  CALL    K1.RCZM
  D7A1    CD D5CE        C                  CALL    K1.BM                  ;RCD = BM ?
  D7A4    06 00          C                  LD      B,0
  D7A6    C0             C                  RET     NZ
  D7A7    04             C                  INC     B
  D7A8    CD D58F        C                  CALL    K1.BLKM
  D7AB    3E FF          C                  LD      A,0FFH              ;RCZx:=FFFFH
  D7AD    CD D5BA        C                  CALL    K1.RCZS
  D7B0    C9             C                  RET
                         C      
                         C                  TITLE   'K M B G  suche BM'
                         C                  PAGE
'K M B G  suche BM'	MACRO-80 3.44	09-Dec-81	PAGE	1-87


                         C      
                         C      ;****************************************************************
                         C      ;*  K M B G    suchen Bandmarke                                 *
                         C      ;****************************************************************
  D7B1    16 01          C      K1.GNLP:    LD      D,1                 ;vorwaerts     ====>
  D7B3    D5             C      K1.GNLPN:   PUSH    DE
  D7B4    FD 7E FD       C                  LD      A,(IY-3)            ;RCZx = 0 ?
  D7B7    FD B6 FC       C                  OR      (IY-4)
  D7BA    28 19          C                  JR      Z,K1.LP2
  D7BC    FD 7E FF       C                  LD      A,(IY-1)            ;RCZx > 0 , BLKx = 1 ?
  D7BF    B7             C                  OR      A
  D7C0    20 0C          C                  JR      NZ,K1.LP1
  D7C2    FD 7E FE       C                  LD      A,(IY-2)
  D7C5    FE 01          C                  CP      1
  D7C7    20 05          C                  JR      NZ,K1.LP1
  D7C9    CD D751        C                  CALL    K1.RW3              ;BLKx = 1
  D7CC    18 07          C                  JR      K1.LP2
  D7CE    3E 01          C      K1.LP1:     LD      A,1                 ;BLKx > 1
  D7D0    06 75          C                  LD      B,75H
  D7D2    CD D81B        C                  CALL    K1.RW4
  D7D5    F1             C      K1.LP2:     POP     AF
  D7D6    B7             C                  OR      A
  D7D7    28 0C          C                  JR      Z,K1.LP3
  D7D9    F5             C                  PUSH    AF
  D7DA    06 71          C                  LD      B,71H
  D7DC    CD D81B        C                  CALL    K1.RW4
  D7DF    C1             C                  POP     BC                  ;BLKx := BLKx + N
  D7E0    CD D581        C                  CALL    K1.BLKP
  D7E3    10 FB          C                  DJNZ    $-3
  D7E5    CD D5B9        C      K1.LP3:     CALL    K1.RCZN             ;RCZx := 0
  D7E8    C9             C                  RET
  D7E9    16 01          C      K1.GNLM:    LD      D,1                 ;rueckwaerts   <====
  D7EB    FD 7E FF       C      K1.GNLMN:   LD      A,(IY-1)
  D7EE    B7             C                  OR      A
  D7EF    20 0E          C                  JR      NZ,K1.LM1
  D7F1    FD 7E FE       C                  LD      A,(IY-2)
  D7F4    3D             C                  DEC     A                   ;A := i-1
  D7F5    92             C                  SUB     D                   ;A := i-1-N
  D7F6    CA D740        C                  JP      Z,K1.GNRW
  D7F9    F2 D7FF        C                  JP      P,K1.LM1
  D7FC    C3 D740        C                  JP      K1.GNRW
  D7FF    FD 7E FD       C      K1.LM1:     LD      A,(IY-3)            ;RCZx = 0 ?
  D802    FD B6 FC       C                  OR      (IY-4)
  D805    D5             C                  PUSH    DE
  D806    28 01          C                  JR      Z,K1.LM2
  D808    14             C                  INC     D
  D809    7A             C      K1.LM2:     LD      A,D
  D80A    06 75          C                  LD      B,75H
  D80C    CD D81B        C                  CALL    K1.RW4
  D80F    C1             C                  POP     BC                  ;BLKx := BLKx - N
  D810    78             C                  LD      A,B
  D811    B7             C                  OR      A
  D812    28 05          C                  JR      Z,K1.LM3
  D814    CD D58F        C                  CALL    K1.BLKM
  D817    10 FB          C                  DJNZ    $-3
  D819    18 CA          C      K1.LM3:     JR      K1.LP3
  D81B    B7             C      K1.RW4:     OR      A                   ;Anzahl Bandmarken = 0 ?
  D81C    C8             C                  RET     Z
  D81D    DD 70 04       C                  LD      (IX+4),B            ;Kommando
  D820    DD 36 09 00    C                  LD      (IX+9),0
  D824    DD 77 0A       C                  LD      (IX+10),A           ;Anzahl Bandmarken
  D827    CD D54B        C                  CALL    K1.ARMB
  D82A    CD D576        C                  CALL    K1.ARBT
  D82D    C9             C                  RET
                         C                  TITLE   'K M B G   CLOSE'
                         C      
                         C      ;****************************************************************
                         C      ;*  K M B G    CLOSE - Routine                                  *
                         C      ;****************************************************************
  D82E    DD 36 04 51    C      K1.GNCLS:   LD      (IX+4),51H          ;CMD write BM
  D832    CD D54B        C                  CALL    K1.ARMB
  D835    CD D576        C                  CALL    K1.ARBT
  D838    DD 36 04 61    C                  LD      (IX+4),61H          ;CMD write end of volume
  D83C    CD D54B        C                  CALL    K1.ARMB
  D83F    CD D576        C                  CALL    K1.ARBT
  D842    DD 36 04 15    C                  LD      (IX+4),15H          ;CMD ein block zurueck
  D846    CD D54B        C                  CALL    K1.ARMB
  D849    CD D576        C                  CALL    K1.ARBT
  D84C    DD 36 04 11    C                  LD      (IX+4),11H          ;CMD ein block vor
  D850    CD D54B        C                  CALL    K1.ARMB
  D853    CD D576        C                  CALL    K1.ARBT
  D856    CD D581        C      K1.RD1:     CALL    K1.BLKP
'K M B G   CLOSE'	MACRO-80 3.44	09-Dec-81	PAGE	1-88


  D859    18 BE          C                  JR      K1.LM3
                         C      
                         C                  TITLE   'K M B G  READ-Routinen'
                         C                  PAGE
'K M B G  READ-Routinen'	MACRO-80 3.44	09-Dec-81	PAGE	1-89


                         C      
                         C      ;****************************************************************
                         C      ;*  K M B G    READ - Routine : einen Block ===> KS.PUFFS       *
                         C      ;****************************************************************
  D85B    DD 36 04 02    C      K1.GNRD:    LD      (IX+4),02H          ;CMD  wiedergabe
  D85F    CD D54B        C                  CALL    K1.ARMB
  D862    CD D5D5        C                  CALL    K1.F17
  D865    CD D576        C                  CALL    K1.ARBT
  D868    CD D5CE        C                  CALL    K1.BM
  D86B    28 E9          C                  JR      Z,K1.RD1
  D86D    CD D59D        C                  CALL    K1.RCZP
  D870    CD F61C        C      K1.PUFT:    CALL    S0.KRZU             ;Kass.puffer V1.1 aktivieren
  D873    CD D5C1        C                  CALL    K1.LHLBC            ;Kass.puffer V1.1 ===> V2.1
  D876    11 B014        C                  LD      DE,KS.PUFFS+1
  D879    DD 72 08       C                  LD      (IX+8),D
  D87C    DD 73 07       C                  LD      (IX+7),E
  D87F    ED B0          C                  LDIR
  D881    CD B2D4        C                  CALL    S2.STACK            ;Kass.puffer V1.1 entaktivieren
  D884    C9             C                  RET
                         C      
                         C      ;****************************************************************
                         C      ;*  K M B G    READ - Routine :  Speicherbereich fuellen        *
                         C      ;****************************************************************
  D885    2A B126        C      K1.GNRDR:   LD      HL,(K2.TXANF)
  D888    22 B124        C                  LD      (K2.TXOP),HL
                         C      
  D88B    2A B128        C      K1.GNRZ:    LD      HL,(K2.TXEND)
  D88E    ED 4B B124     C                  LD      BC,(K2.TXOP)
  D892    B7             C                  OR      A
  D893    ED 42          C                  SBC     HL,BC
  D895    28 2D          C                  JR      Z,K1.GNRZE
  D897    FA D8C4        C                  JP      M,K1.GNRZE
  D89A    DD CB FF 5E    C                  BIT     3,(IX-1)            ;Verarbeitungsbit  NL/SL  ?
  D89E    20 05          C                  JR      NZ,$+7
  D8A0    01 0100        C                  LD      BC,256              ;no       label
  D8A3    18 03          C                  JR      $+5
  D8A5    01 0080        C                  LD      BC,128              ;standard label
  D8A8    ED 42          C                  SBC     HL,BC
  D8AA    FA D8C4        C                  JP      M,K1.GNRZE
                         C      
  D8AD    CD D85B        C                  CALL    K1.GNRD
                         C      
  D8B0    CD D5CE        C                  CALL    K1.BM
  D8B3    28 0F          C                  JR      Z,K1.GNRZE
  D8B5    CD D5C1        C                  CALL    K1.LHLBC
  D8B8    ED 5B B124     C                  LD      DE,(K2.TXOP)
  D8BC    ED B0          C                  LDIR
  D8BE    ED 53 B124     C                  LD      (K2.TXOP),DE
  D8C2    18 C7          C                  JR      K1.GNRZ
                         C      
  D8C4    2A B124        C      K1.GNRZE:   LD      HL,(K2.TXOP)
  D8C7    22 B128        C                  LD      (K2.TXEND),HL
  D8CA    C9             C                  RET
                         C      
                         C                  TITLE   'K M B G  WRITE-Routinen'
                         C                  PAGE
'K M B G  WRITE-Routinen'	MACRO-80 3.44	09-Dec-81	PAGE	1-90


                         C      
                         C      ;****************************************************************
                         C      ;*  K M B G    WRITE - Routine :  einen Block schreiben         *
                         C      ;****************************************************************
  D8CB    CD D5C1        C      K1.GNWR:    CALL    K1.LHLBC            ;Ausgabeblock ==> KS.PUFFS von V2
  D8CE    11 B014        C                  LD      DE,KS.PUFFS+1
  D8D1    DD 72 08       C                  LD      (IX+8),D
  D8D4    DD 73 07       C                  LD      (IX+7),E
  D8D7    ED B0          C                  LDIR
  D8D9    E5             C                  PUSH    HL
  D8DA    DD 36 04 00    C                  LD      (IX+4),00H          ;CMD write record mit RAW
  D8DE    CD D54B        C                  CALL    K1.ARMB
  D8E1    CD D576        C                  CALL    K1.ARBT
  D8E4    CD D59D        C                  CALL    K1.RCZP
  D8E7    E1             C                  POP     HL
  D8E8    DD 74 08       C                  LD      (IX+8),H
  D8EB    DD 75 07       C                  LD      (IX+7),L
  D8EE    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*  K M B G    WRITE - Routine :   einen Block zurueckschreiben *
                         C      ;****************************************************************
  D8EF    E5             C      K1.GNRWR:   PUSH    HL                  ;Pufferadresse
  D8F0    C5             C                  PUSH    BC                  ;Pufferlaenge
  D8F1    DD 36 04 02    C                  LD      (IX+4),2            ;CMD  wiedergabe
  D8F5    CD D54B        C                  CALL    K1.ARMB
  D8F8    CD D5D5        C                  CALL    K1.F17
  D8FB    CD D576        C                  CALL    K1.ARBT
  D8FE    CD D59D        C                  CALL    K1.RCZP
  D901    E1             C                  POP     HL                  ;neue Blocklaenge
  D902    E5             C                  PUSH    HL
  D903    DD 46 09       C                  LD      B,(IX+9)            ;alte Blocklaenge
  D906    DD 4E 0A       C                  LD      C,(IX+10)
  D909    B7             C                  OR      A
  D90A    ED 42          C                  SBC     HL,BC               ;alte = neue Blocklaenge ?
  D90C    20 29          C                  JR      NZ,K1.GNRW3         ;Z-FF=0 ... Block nicht zur.geschr.
  D90E    DD 36 04 15    C                  LD      (IX+4),15H          ;CMD ein block zurueck
  D912    CD D54B        C                  CALL    K1.ARMB
  D915    CD D576        C                  CALL    K1.ARBT
  D918    C1             C                  POP     BC
  D919    E1             C                  POP     HL
  D91A    11 B014        C      K1.GNRW2:   LD      DE,KS.PUFFS+1
  D91D    DD 72 08       C                  LD      (IX+8),D
  D920    DD 73 07       C                  LD      (IX+7),E
  D923    DD 70 09       C                  LD      (IX+9),B
  D926    DD 71 0A       C                  LD      (IX+10),C
  D929    ED B0          C                  LDIR
  D92B    DD 36 04 08    C      K1.GNRW1:   LD      (IX+4),8            ;CMD write record ohne RAW
  D92F    CD D54B        C                  CALL    K1.ARMB
  D932    CD D576        C                  CALL    K1.ARBT
  D935    AF             C                  XOR     A                   ;Z-FF=1 ... Block zurueckgeschr.
  D936    C9             C                  RET
  D937    C1             C      K1.GNRW3:   POP     BC
  D938    E1             C                  POP     HL
  D939    C9             C                  RET
                         C      
                         C                  PAGE
'K M B G  WRITE-Routinen'	MACRO-80 3.44	09-Dec-81	PAGE	1-91


                         C      
                         C      ;****************************************************************
                         C      ;*  K M B G    WRITE - Routine :  aus Speicherbereich ausgeben  *
                         C      ;****************************************************************
  D93A    2A B126        C      K1.GNWRT:   LD      HL,(K2.TXANF)
  D93D    DD 75 07       C                  LD      (IX+7),L            ;Pufferadresse ===> E/A-Tabelle
  D940    DD 74 08       C                  LD      (IX+8),H
  D943    DD CB FF 5E    C                  BIT     3,(IX-1)            ;Verarbeitungsbit  NL/SL  ?
  D947    20 05          C                  JR      NZ,$+7
  D949    21 0100        C                  LD      HL,256              ;no       label
  D94C    18 03          C                  JR      $+5
  D94E    21 0080        C                  LD      HL,128              ;standard label
  D951    DD 74 09       C                  LD      (IX+9),H            ;Pufferlaenge  ===> E/A-Tabelle
  D954    DD 75 0A       C                  LD      (IX+10),L
                         C      
  D957    2A B128        C      K1.GNZKL:   LD      HL,(K2.TXEND)       ;Endeadresse Text
  D95A    DD 56 08       C                  LD      D,(IX+8)            ;operative Anfangsadresse
  D95D    DD 5E 07       C                  LD      E,(IX+7)
  D960    B7             C                  OR      A
  D961    ED 52          C                  SBC     HL,DE               ;noch auszugeb. Textlaenge
  D963    28 38          C                  JR      Z,K1.WRTEN          ;Ende bei Textlaenge gleich Null
  D965    FA D99D        C                  JP      M,K1.WRTEN
  D968    22 B120        C                  LD      (K2.BLZ),HL         ;merken Textlaenge
  D96B    DD CB FF 5E    C                  BIT     3,(IX-1)            ;Verarbeitungsbit  NL/SL  ?
  D96F    20 05          C                  JR      NZ,$+7
  D971    11 0100        C                  LD      DE,256              ;no       label
  D974    18 03          C                  JR      $+5
  D976    11 0080        C                  LD      DE,128              ;standard label
  D979    B7             C                  OR      A
  D97A    ED 52          C                  SBC     HL,DE               ;Textlaenge groesser LRECL
  D97C    F2 D998        C                  JP      P,K1.GNTS1
  D97F    19             C                  ADD     HL,DE               ;reset
  D980    11 0020        C                  LD      DE,32
  D983    B7             C                  OR      A
  D984    ED 52          C                  SBC     HL,DE
  D986    F2 D98E        C                  JP      P,K1.GNTS2          ;Satz groesser 32 Byte
                         C      ; Korrektur fuer Saetze kleiner 32 Byte
  D989    3E 20          C                  LD      A,32                ;L-Teil der Textlaenge
  D98B    32 B120        C                  LD      (K2.BLZ),A
                         C      ; Modifikation Record-Laenge
  D98E    3A B120        C      K1.GNTS2:   LD      A,(K2.BLZ)
  D991    DD 36 09 00    C                  LD      (IX+9),0            ;Ausgabelaenge setzen
  D995    DD 77 0A       C                  LD      (IX+10),A
                         C      ; Ausgabe eines Blockes
  D998    CD D8CB        C      K1.GNTS1:   CALL    K1.GNWR
  D99B    18 BA          C                  JR      K1.GNZKL
                         C      ; Aufrufende
  D99D    C9             C      K1.WRTEN:   RET
                         C      
                         C                  TITLE   'K M B G  Komplex-Routinen Teil I '
                         C                  PAGE
'K M B G  Komplex-Routinen Teil I '	MACRO-80 3.44	09-Dec-81	PAGE	1-92


                         C      
                         C      ;****************************************************************
                         C      ;*  K M B G      K o m p l e x - R o u t i n e n  Teil I        *
                         C      ;*                zum Aufruf der Kassettengrundroutinen         *
                         C      ;****************************************************************
  D99E    D99E           C                  DW      $                   ;K 1 R E   ---   K 2 R E
  D9A0    4B 31 52 45    C                  DB      'K1RE'
  D9A4    CD D5ED        C                  CALL    K1.RGL1
  D9A7    18 09          C                  JR      K1.SRV
                         C      
  D9A9    D9A9           C                  DW      $
  D9AB    4B 32 52 45    C                  DB      'K2RE'
  D9AF    CD D5FE        C                  CALL    K1.RGL2
  D9B2    CD D708        C      K1.SRV:     CALL    K1.GNRE
  D9B5    18 65          C                  JR      K1.STS
                         C      
                         C      
                         C      
  D9B7    D9B7           C                  DW      $                   ;K 1 R A   ---   K 2 R A
  D9B9    4B 31 52 41    C                  DB      'K1RA'
  D9BD    CD D5ED        C                  CALL    K1.RGL1
  D9C0    18 09          C                  JR      K1.UNL
                         C      
  D9C2    D9C2           C                  DW      $
  D9C4    4B 32 52 41    C                  DB      'K2RA'
  D9C8    CD D5FE        C                  CALL    K1.RGL2
  D9CB    CD D708        C      K1.UNL:     CALL    K1.GNRE
  D9CE    CD D740        C                  CALL    K1.GNRW
  D9D1    CD D725        C                  CALL    K1.GNRA
  D9D4    18 46          C                  JR      K1.STS
                         C      
                         C      
                         C      
  D9D6    D9D6           C                  DW      $                   ;K 1 R W   ---   K 2 R W
  D9D8    4B 31 52 57    C                  DB      'K1RW'
  D9DC    CD D5ED        C                  CALL    K1.RGL1
  D9DF    18 09          C                  JR      K1.RV1
                         C      
  D9E1    D9E1           C                  DW      $
  D9E3    4B 32 52 57    C                  DB      'K2RW'
  D9E7    CD D5FE        C                  CALL    K1.RGL2
  D9EA    CD D740        C      K1.RV1:     CALL    K1.GNRW
  D9ED    18 2D          C                  JR      K1.STS
                         C      
                         C                  PAGE
'K M B G  Komplex-Routinen Teil I '	MACRO-80 3.44	09-Dec-81	PAGE	1-93


                         C      
  D9EF    D9EF           C                  DW      $                   ;K 1 C L   ---   K 2 C L
  D9F1    4B 31 43 4C    C                  DB      'K1CL'
  D9F5    CD D5ED        C                  CALL    K1.RGL1
  D9F8    18 09          C                  JR      K1.CLS
                         C      
  D9FA    D9FA           C                  DW      $
  D9FC    4B 32 43 4C    C                  DB      'K2CL'
  DA00    CD D5FE        C                  CALL    K1.RGL2
  DA03    CD D82E        C      K1.CLS:     CALL    K1.GNCLS
  DA06    18 14          C                  JR      K1.STS
                         C      
                         C      
                         C      
  DA08    DA08           C                  DW      $                   ;K 1 S T   ---   K 2 S T
  DA0A    4B 31 53 54    C                  DB      'K1ST'
  DA0E    CD D5ED        C                  CALL    K1.RGL1
  DA11    18 09          C                  JR      K1.STS
                         C      
  DA13    DA13           C                  DW      $
  DA15    4B 32 53 54    C                  DB      'K2ST'
  DA19    CD D5FE        C                  CALL    K1.RGL2
  DA1C    CD D6B1        C      K1.STS:     CALL    K1.GNSTS
  DA1F    E1             C                  POP     HL                  ;Ruecksprung zum System
  DA20    E1             C                  POP     HL
  DA21    C9             C                  RET
                         C      
                         C      
                         C      
  DA22    DA22           C                  DW      $                   ;K 1 R +   ---   K 2 R +
  DA24    4B 31 52 2B    C                  DB      'K1R+'
  DA28    CD D5ED        C                  CALL    K1.RGL1
  DA2B    18 09          C                  JR      K1.RP
                         C      
  DA2D    DA2D           C                  DW      $
  DA2F    4B 32 52 2B    C                  DB      'K2R+'
  DA33    CD D5FE        C                  CALL    K1.RGL2
  DA36    CD D765        C      K1.RP:      CALL    K1.GNRP
  DA39    18 E1          C                  JR      K1.STS
                         C      
                         C      
                         C      
  DA3B    DA3B           C                  DW      $                   ;K 1 R -   ---   K 2 R -
  DA3D    4B 31 52 2D    C                  DB      'K1R-'
  DA41    CD D5ED        C                  CALL    K1.RGL1
  DA44    18 09          C                  JR      K1.RM
                         C      
  DA46    DA46           C                  DW      $
  DA48    4B 32 52 2D    C                  DB      'K2R-'
  DA4C    CD D5FE        C                  CALL    K1.RGL2
  DA4F    CD D780        C      K1.RM:      CALL    K1.GNRM
  DA52    18 C8          C                  JR      K1.STS
                         C      
                         C                  PAGE
'K M B G  Komplex-Routinen Teil I '	MACRO-80 3.44	09-Dec-81	PAGE	1-94


                         C      
  DA54    DA54           C                  DW      $                   ;K 1 L +   ---   K 2 L +
  DA56    4B 31 4C 2B    C                  DB      'K1L+'
  DA5A    CD D5ED        C                  CALL    K1.RGL1
  DA5D    18 09          C                  JR      K1.LP
                         C      
  DA5F    DA5F           C                  DW      $
  DA61    4B 32 4C 2B    C                  DB      'K2L+'
  DA65    CD D5FE        C                  CALL    K1.RGL2
  DA68    CD D7B1        C      K1.LP:      CALL    K1.GNLP
  DA6B    18 AF          C                  JR      K1.STS
                         C      
                         C      
                         C      
  DA6D    DA6D           C                  DW      $                   ;K 1 L -   ---   K 2 L -
  DA6F    4B 31 4C 2D    C                  DB      'K1L-'
  DA73    CD D5ED        C                  CALL    K1.RGL1
  DA76    18 09          C                  JR      K1.LM
                         C      
  DA78    DA78           C                  DW      $
  DA7A    4B 32 4C 2D    C                  DB      'K2L-'
  DA7E    CD D5FE        C                  CALL    K1.RGL2
  DA81    CD D7E9        C      K1.LM:      CALL    K1.GNLM
  DA84    18 96          C      K1.STS1:    JR      K1.STS
                         C      
                         C      
                         C      
  DA86    DA86           C                  DW      $                   ;K 1 Y     ---   K 2 Y
  DA88    4B 31 59 20    C                  DB      'K1Y '
  DA8C    CD D5ED        C                  CALL    K1.RGL1
  DA8F    18 09          C                  JR      K1.WR1
                         C      
  DA91    DA91           C                  DW      $
  DA93    4B 32 59 20    C                  DB      'K2Y '
  DA97    CD D5FE        C                  CALL    K1.RGL2
  DA9A    2A B24F        C      K1.WR1:     LD      HL,(S2.TPA)
  DA9D    22 B126        C                  LD      (K2.TXANF),HL
  DAA0    2A B257        C                  LD      HL,(S2.END)
  DAA3    22 B128        C                  LD      (K2.TXEND),HL
  DAA6    CD D93A        C                  CALL    K1.GNWRT
  DAA9    18 D9          C                  JR      K1.STS1
                         C      
                         C                  PAGE
'K M B G  Komplex-Routinen Teil I '	MACRO-80 3.44	09-Dec-81	PAGE	1-95


                         C      
  DAAB    DAAB           C                  DW      $                   ;K 1 X A   ---   K 2 X A
  DAAD    4B 31 58 41    C                  DB      'K1XA'
  DAB1    CD D5ED        C                  CALL    K1.RGL1
  DAB4    18 09          C                  JR      K1.XA
                         C      
  DAB6    DAB6           C                  DW      $
  DAB8    4B 32 58 41    C                  DB      'K2XA'
  DABC    CD D5FE        C                  CALL    K1.RGL2
  DABF    2A B24F        C      K1.XA:      LD      HL,(S2.TPA)
  DAC2    22 B126        C      K1.XA1:     LD      (K2.TXANF),HL
  DAC5    2A B251        C                  LD      HL,(S2.TPE)
  DAC8    22 B128        C                  LD      (K2.TXEND),HL
  DACB    CD D885        C                  CALL    K1.GNRDR
  DACE    2A B128        C                  LD      HL,(K2.TXEND)
  DAD1    22 B257        C                  LD      (S2.END),HL
  DAD4    18 AE          C                  JR      K1.STS1
                         C      
                         C      
                         C      
  DAD6    DAD6           C                  DW      $                   ;K 1 X E   ---   K 2 X E
  DAD8    4B 31 58 45    C                  DB      'K1XE'
  DADC    CD D5ED        C                  CALL    K1.RGL1
  DADF    18 09          C                  JR      K1.XE
                         C      
  DAE1    DAE1           C                  DW      $
  DAE3    4B 32 58 45    C                  DB      'K2XE'
  DAE7    CD D5FE        C                  CALL    K1.RGL2
  DAEA    2A B257        C      K1.XE:      LD      HL,(S2.END)
  DAED    23             C                  INC     HL
  DAEE    18 D2          C                  JR      K1.XA1
                         C      
                         C                  TITLE   'K M B G  Komplex-Routinen Teil II'
                         C                  PAGE
'K M B G  Komplex-Routinen Teil II'	MACRO-80 3.44	09-Dec-81	PAGE	1-96


                         C      
                         C      ;****************************************************************
                         C      ;*  K M B G      K o m p l e x - R o u t i n e n   Teil II      *
                         C      ;****************************************************************
                         C      
                         C      ;****************************************************************
                         C      ;*               E i n g a b e - P u f f e r    fuellen         *
                         C      ;****************************************************************
  DAF0    21 B7E0        C      K1.EIN:     LD      HL,S0.PFFI          ;Eingabeparameter:
  DAF3    E5             C                  PUSH    HL                  ; BC  ...  zu belegender Puffer
  DAF4    E5             C                  PUSH    HL
  DAF5    22 B126        C                  LD      (K2.TXANF),HL
  DAF8    22 B259        C                  LD      (S2.POIE),HL
  DAFB    09             C                  ADD     HL,BC
  DAFC    22 B128        C                  LD      (K2.TXEND),HL
  DAFF    E1             C                  POP     HL                  ;Puffer loeschen
  DB00    D1             C                  POP     DE
  DB01    CD DB48        C                  CALL    K1.FU
  DB04    CD D885        C                  CALL    K1.GNRDR            ;Puffer fuellen
  DB07    CD D6B1        C                  CALL    K1.GNSTS
  DB0A    C9             C                  RET
                         C      
  DB0B    CD D85B        C      K1.EINP:    CALL    K1.GNRD             ;einen Block einlesen in den Eingabepuffer
  DB0E    21 B7E0        C      K1.EINP1:   LD      HL,S0.PFFI
  DB11    E5             C                  PUSH    HL
  DB12    E5             C                  PUSH    HL
  DB13    D1             C                  POP     DE
  DB14    CD DB48        C                  CALL    K1.FU
  DB17    CD D5C1        C                  CALL    K1.LHLBC
  DB1A    D1             C                  POP     DE
  DB1B    ED 53 B259     C                  LD      (S2.POIE),DE
  DB1F    78             C                  LD      A,B
  DB20    B1             C                  OR      C
  DB21    28 02          C                  JR      Z,K1.EINP2
  DB23    ED B0          C                  LDIR
  DB25    CD D6B1        C      K1.EINP2:   CALL    K1.GNSTS
  DB28    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*               A u s g a b e - P u f f e r   leeren           *
                         C      ;****************************************************************
  DB29    2A B25B        C      K1.AUS:     LD      HL,(S2.POIA)
  DB2C    22 B128        C                  LD      (K2.TXEND),HL
  DB2F    21 BBF0        C                  LD      HL,S0.PFFA
  DB32    C5             C                  PUSH    BC
  DB33    E5             C                  PUSH    HL
  DB34    E5             C                  PUSH    HL
  DB35    22 B126        C                  LD      (K2.TXANF),HL
  DB38    22 B25B        C                  LD      (S2.POIA),HL
  DB3B    CD D93A        C                  CALL    K1.GNWRT
  DB3E    CD D6B1        C                  CALL    K1.GNSTS
  DB41    E1             C                  POP     HL
  DB42    D1             C                  POP     DE
  DB43    CD DB48        C                  CALL    K1.FU
  DB46    C1             C                  POP     BC
  DB47    C9             C                  RET
                         C      
  DB48    13             C      K1.FU:      INC     DE
  DB49    01 0400        C                  LD      BC,400H
  DB4C    36 0D          C                  LD      (HL),00DH
  DB4E    ED B0          C                  LDIR
  DB50    C9             C                  RET
                         C      
                         C                  PAGE
'K M B G  Komplex-Routinen Teil II'	MACRO-80 3.44	09-Dec-81	PAGE	1-97


                         C      
                         C      ;****************************************************************
                         C      ;*               E i n g a b e z e i c h e n  ===>   A          *
                         C      ;****************************************************************
  DB51    D5             C      K1.LESV:    PUSH    DE
  DB52    E5             C                  PUSH    HL
  DB53    2A B259        C                  LD      HL,(S2.POIE)
  DB56    7E             C                  LD      A,(HL)
  DB57    23             C                  INC     HL
  DB58    22 B259        C                  LD      (S2.POIE),HL
  DB5B    11 BBE0        C                  LD      DE,S0.PFFI+400H
  DB5E    B7             C                  OR      A
  DB5F    ED 52          C                  SBC     HL,DE
  DB61    C5             C                  PUSH    BC
  DB62    F5             C                  PUSH    AF
  DB63    01 0400        C                  LD      BC,400H
  DB66    CC DAF0        C                  CALL    Z,K1.EIN
  DB69    F1             C                  POP     AF
  DB6A    C1             C                  POP     BC
  DB6B    E1             C                  POP     HL
  DB6C    D1             C                  POP     DE
  DB6D    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*               Zeichen im Register A ausgeben                 *
                         C      ;****************************************************************
  DB6E    D5             C      K1.SCHR:    PUSH    DE
  DB6F    E5             C                  PUSH    HL
  DB70    2A B25B        C                  LD      HL,(S2.POIA)
  DB73    77             C                  LD      (HL),A
  DB74    23             C                  INC     HL
  DB75    22 B25B        C                  LD      (S2.POIA),HL
  DB78    11 BFF0        C                  LD      DE,S0.PFFA+400H
  DB7B    B7             C                  OR      A
  DB7C    ED 52          C                  SBC     HL,DE
  DB7E    CC DB29        C                  CALL    Z,K1.AUS
  DB81    E1             C                  POP     HL
  DB82    D1             C                  POP     DE
  DB83    C9             C                  RET
                         C      
                         C                  PAGE
'K M B G  Komplex-Routinen Teil II'	MACRO-80 3.44	09-Dec-81	PAGE	1-98


                         C      
                         C      ;****************************************************************
                         C      ;*               Zugriff auf  M R E S - Katalog                 *
                         C      ;****************************************************************
  DB84    CD D708        C      K1.MRCAT:   CALL    K1.GNRE
  DB87    CD D740        C                  CALL    K1.GNRW
  DB8A    16 02          C                  LD      D,2                 ;auf Verzeichnisbloecke pos.
  DB8C    CD D7B3        C                  CALL    K1.GNLPN
  DB8F    CD D85B        C                  CALL    K1.GNRD             ;ersten zwei Verz.eintr. einlesen
  DB92    CD D85B        C                  CALL    K1.GNRD
  DB95    3A B015        C                  LD      A,(KS.PUFFS+2)      ;naechste freie Datei
  DB98    F5             C                  PUSH    AF
  DB99    3A B017        C                  LD      A,(KS.PUFFS+4)      ;Anzahl Dateien
  DB9C    3D             C                  DEC     A
  DB9D    28 30          C                  JR      Z,K1.MRC5
  DB9F    47             C                  LD      B,A
  DBA0    C5             C      K1.MRC1:    PUSH    BC
  DBA1    DD E5          C                  PUSH    IX
  DBA3    CD D85B        C                  CALL    K1.GNRD             ;einen       Verz.eintr. einlesen
  DBA6    21 B014        C                  LD      HL,KS.PUFFS+1
  DBA9    E5             C                  PUSH    HL
  DBAA    DD E1          C                  POP     IX
  DBAC    FD 7E 06       C                  LD      A,(IY+6)            ;Dateityp
  DBAF    DD BE 06       C                  CP      (IX+6)
  DBB2    20 16          C                  JR      NZ,K1.MRC3
  DBB4    FD 7E 07       C                  LD      A,(IY+7)            ;Dateiattribut
  DBB7    FE 20          C                  CP      ' '
  DBB9    28 05          C                  JR      Z,K1.MRC2
  DBBB    DD BE 07       C                  CP      (IX+7)
  DBBE    20 0A          C                  JR      NZ,K1.MRC3
  DBC0    FD E5          C      K1.MRC2:    PUSH    IY                  ;Dateiname
  DBC2    D1             C                  POP     DE
  DBC3    06 06          C                  LD      B,6
  DBC5    CD C4B6        C                  CALL    S1.VERGL
  DBC8    28 0B          C                  JR      Z,K1.MRC4
  DBCA    DD E1          C      K1.MRC3:    POP     IX
  DBCC    C1             C                  POP     BC
  DBCD    10 D1          C                  DJNZ    K1.MRC1
  DBCF    CD D6B1        C      K1.MRC5:    CALL    K1.GNSTS
  DBD2    D1             C                  POP     DE
  DBD3    37             C                  SCF                         ;CY=1  keine Datei vorhanden
  DBD4    C9             C                  RET
  DBD5    DD 56 17       C      K1.MRC4:    LD      D,(IX+17H)
  DBD8    DD E1          C                  POP     IX
  DBDA    D5             C                  PUSH    DE
  DBDB    CD D6B1        C                  CALL    K1.GNSTS
  DBDE    D1             C                  POP     DE
  DBDF    C1             C                  POP     BC
  DBE0    C1             C                  POP     BC
  DBE1    37             C                  SCF                         ;CY=0        Datei vorhanden
  DBE2    3F             C                  CCF
  DBE3    C9             C                  RET
                         C      
                         C                  PAGE
'K M B G  Komplex-Routinen Teil II'	MACRO-80 3.44	09-Dec-81	PAGE	1-99


                         C      
                         C      ;****************************************************************
                         C      ;*          M R E S  Eingabedatei eroeffnen                     *
                         C      ;****************************************************************
  DBE4    CD DB84        C      K1.MREPO:   CALL    K1.MRCAT
  DBE7    30 0D          C                  JR      NC,K1.MRPO4
  DBE9    CD D740        C                  CALL    K1.GNRW             ;Datei nicht im Verzeichnis
  DBEC    CD D725        C                  CALL    K1.GNRA
  DBEF    CD D6B1        C                  CALL    K1.GNSTS
  DBF2    3E 01          C                  LD      A,1
  DBF4    B7             C                  OR      A                   ;Z-FF = 0
  DBF5    C9             C                  RET
                         C      
  DBF6    D5             C      K1.MRPO4:   PUSH    DE                  ;Dateifolgenummer
  DBF7    3E 02          C                  LD      A,2
  DBF9    82             C                  ADD     A,D
  DBFA    F5             C                  PUSH    AF
  DBFB    CD D740        C                  CALL    K1.GNRW
  DBFE    D1             C                  POP     DE
  DBFF    CD D7B3        C                  CALL    K1.GNLPN
  DC02    CD D85B        C                  CALL    K1.GNRD             ;Verzeichnissatz der Datei einlesen
  DC05    21 B014        C                  LD      HL,KS.PUFFS+1
  DC08    F1             C                  POP     AF
  DC09    BE             C                  CP      (HL)
  DC0A    28 0A          C                  JR      Z,K1.MRPO5
                         C      
  DC0C    CD D740        C      K1.MRPO3:   CALL    K1.GNRW             ;Datei nicht richtig pos.
  DC0F    CD D725        C                  CALL    K1.GNRA
  DC12    3E 02          C                  LD      A,2
  DC14    B7             C                  OR      A                   ;Z-FF = 0
  DC15    C9             C                  RET
                         C      
  DC16    DD CB FF CE    C      K1.MRPO5:   SET     1,(IX-1)            ;OPEN bit          setzen
  DC1A    DD CB FF DE    C                  SET     3,(IX-1)            ;Verarbeitungsbit  setzen
  DC1E    01 0400        C                  LD      BC,400H             ;Eingabepuffer fuellen
  DC21    CD DAF0        C                  CALL    K1.EIN
  DC24    AF             C                  XOR     A                   ;Z-FF = 1
  DC25    C9             C                  RET
                         C      
                         C                  PAGE
'K M B G  Komplex-Routinen Teil II'	MACRO-80 3.44	09-Dec-81	PAGE	1-100


                         C      
                         C      ;****************************************************************
                         C      ;*               M R E S  Ausgabedatei eroeffnen                *
                         C      ;****************************************************************
  DC26    CD DB84        C      K1.MRAPO:   CALL    K1.MRCAT
  DC29    30 32          C                  JR      NC,K1.MRAP2
                         C      
  DC2B    D5             C      K1.MRAP4:   PUSH    DE                  ;(D) ... zu positionierende Datei
  DC2C    3E 02          C                  LD      A,2
  DC2E    82             C                  ADD     A,D
  DC2F    F5             C                  PUSH    AF
  DC30    CD D740        C                  CALL    K1.GNRW
  DC33    D1             C                  POP     DE
  DC34    CD D7B3        C                  CALL    K1.GNLPN
  DC37    CD D85B        C                  CALL    K1.GNRD
  DC3A    21 B014        C                  LD      HL,KS.PUFFS+1
  DC3D    F1             C                  POP     AF
  DC3E    BE             C                  CP      (HL)
  DC3F    20 CB          C                  JR      NZ,K1.MRPO3         ;Datei nicht richtig pos.
  DC41    FD 77 17       C                  LD      (IY+17H),A          ;Dateinummer
  DC44    21 BBF0        C                  LD      HL,S0.PFFA          ;Ausgabe - Pointer setzen
  DC47    22 B25B        C                  LD      (S2.POIA),HL
  DC4A    E5             C                  PUSH    HL
  DC4B    D1             C                  POP     DE
  DC4C    CD DB48        C                  CALL    K1.FU
  DC4F    DD CB FF CE    C      K1.MRAP1:   SET     1,(IX-1)            ;OPEN bit          setzen
  DC53    DD CB FF D6    C                  SET     2,(IX-1)            ;Richtungsbit      setzen
  DC57    DD CB FF DE    C                  SET     3,(IX-1)            ;Verarbeitungsbit  setzen
  DC5B    AF             C                  XOR     A                   ;Z-FF = 1
  DC5C    C9             C                  RET
                         C      
  DC5D    ED 53 B26C     C      K1.MRAP2:   LD      (S2.RBBR),DE        ;Dateiname schon vergeben
  DC61    21 E38B        C                  LD      HL,LO.TXT11
  DC64    11 DC71        C                  LD      DE,K1.MRAP3
  DC67    01 DC79        C                  LD      BC,K1.MRAP5
  DC6A    ED 73 B24D     C                  LD      (TS.STACK),SP
  DC6E    C3 C4F7        C                  JP      S1.FEHRR
                         C      
  DC71    3A B26D        C      K1.MRAP3:   LD      A,(S2.RBBR+1)       ;POS QUIT
  DC74    57             C                  LD      D,A
  DC75    E1             C                  POP     HL
  DC76    E1             C                  POP     HL
  DC77    18 B2          C                  JR      K1.MRAP4
                         C      
  DC79    CD D740        C      K1.MRAP5:   CALL    K1.GNRW             ;NEG QUIT
  DC7C    CD D725        C                  CALL    K1.GNRA
  DC7F    3E 03          C                  LD      A,3
  DC81    B7             C                  OR      A                   ;Z-FF = 0
  DC82    C9             C                  RET
                         C      
                         C                  PAGE
'K M B G  Komplex-Routinen Teil II'	MACRO-80 3.44	09-Dec-81	PAGE	1-101


                         C      
                         C      ;****************************************************************
                         C      ;*               M R E S  Ausgabedatei abschliessen und         *
                         C      ;*                        Verzeichniseintrag realisieren        *
                         C      ;****************************************************************
  DC83    DD 36 07 F0    C      K1.MRCLS:   LD      (IX+7),LOW(S0.PFFA)   ;Pufferadresse
  DC87    DD 36 08 BB    C                  LD      (IX+8),HIGH(S0.PFFA)
  DC8B    DD 36 09 00    C                  LD      (IX+9),0            ;Blocklaenge eintragen
  DC8F    DD 36 0A 80    C                  LD      (IX+10),80H
  DC93    CD D8CB        C      K1.MRCL1:   CALL    K1.GNWR
  DC96    2A B25B        C                  LD      HL,(S2.POIA)
  DC99    DD 56 08       C                  LD      D,(IX+8)
  DC9C    DD 5E 07       C                  LD      E,(IX+7)
  DC9F    B7             C                  OR      A
  DCA0    ED 52          C                  SBC     HL,DE
  DCA2    28 03          C                  JR      Z,K1.MRCL2
  DCA4    F2 DC93        C                  JP      P,K1.MRCL1
                         C      
  DCA7    FD 66 FD       C      K1.MRCL2:   LD      H,(IY-3)            ;Satzanzahl im Verzeichnisblock merken
  DCAA    FD 6E FC       C                  LD      L,(IY-4)
  DCAD    2B             C                  DEC     HL
  DCAE    FD 75 19       C                  LD      (IY+25),L
  DCB1    FD 74 1A       C                  LD      (IY+26),H
  DCB4    CD D82E        C                  CALL    K1.GNCLS            ;Bandmarke schreiben
                         C      
  DCB7    21 B014        C                  LD      HL,KS.PUFFS+1       ;1.Satz der naechsten Datei aufb.
  DCBA    DD 74 08       C                  LD      (IX+8),H            ;Ausgabeadresse
  DCBD    DD 75 07       C                  LD      (IX+7),L
  DCC0    DD 36 0A 20    C                  LD      (IX+10),32          ;Ausgabelaenge
  DCC4    11 B015        C                  LD      DE,KS.PUFFS+2
  DCC7    01 001F        C                  LD      BC,31
  DCCA    36 00          C                  LD      (HL),0
  DCCC    ED B0          C                  LDIR
  DCCE    FD 7E 17       C                  LD      A,(IY+17H)          ;Dateinummer
  DCD1    3C             C                  INC     A
  DCD2    32 B014        C                  LD      (KS.PUFFS+1),A
  DCD5    CD D8CB        C                  CALL    K1.GNWR                ;Verz.satz ausgeben
  DCD8    CD D6B1        C                  CALL    K1.GNSTS
                         C      
                         C                  PAGE
'K M B G  Komplex-Routinen Teil II'	MACRO-80 3.44	09-Dec-81	PAGE	1-102


                         C      
  DCDB    CD D740        C                  CALL    K1.GNRW             ;Kassette auf Verzeichnis pos.
  DCDE    16 02          C                  LD      D,2
  DCE0    CD D7B3        C                  CALL    K1.GNLPN
  DCE3    CD D85B        C                  CALL    K1.GNRD             ;Ausgleich-Satz
  DCE6    CD D85B        C                  CALL    K1.GNRD             ;DS       -Satz
  DCE9    3A B017        C                  LD      A,(KS.PUFFS+4)      ;auf Verzeichnissatz pos.
  DCEC    47             C                  LD      B,A
  DCED    3E 01          C                  LD      A,1
  DCEF    3C             C      K1.MRCL3:   INC     A
  DCF0    F5             C                  PUSH    AF
  DCF1    C5             C                  PUSH    BC
  DCF2    CD D85B        C                  CALL    K1.GNRD
  DCF5    3A B02B        C                  LD      A,(KS.PUFFS+18H)
  DCF8    FD BE 17       C                  CP      (IY+17H)
  DCFB    C1             C                  POP     BC
  DCFC    28 04          C                  JR      Z,K1.MRCL4
  DCFE    F1             C                  POP     AF
  DCFF    10 EE          C                  DJNZ    K1.MRCL3
  DD01    F5             C                  PUSH    AF
  DD02    CD D780        C      K1.MRCL4:   CALL    K1.GNRM
  DD05    FD E5          C                  PUSH    IY                  ;aktuelles Datum in  KSK  eintragen
  DD07    E1             C                  POP     HL
  DD08    01 000E        C                  LD      BC,14
  DD0B    09             C                  ADD     HL,BC
  DD0C    EB             C                  EX      DE,HL
  DD0D    21 0004        C                  LD      HL,S3.DATUM-S3.SEAT
  DD10    01 A800        C                  LD      BC,S0.DEAT
  DD13    09             C                  ADD     HL,BC
  DD14    01 0006        C                  LD      BC,6
  DD17    ED B0          C                  LDIR
  DD19    FD 36 14 32    C                  LD      (IY+20),S0.V1       ;System-Signum eintragen
  DD1D    FD 36 15 31    C                  LD      (IY+21),S0.V2
  DD21    FD 36 16 33    C                  LD      (IY+22),S0.V3
  DD25    FD 36 18 00    C                  LD      (IY+24),0
  DD29    FD E5          C                  PUSH    IY
  DD2B    E1             C                  POP     HL
  DD2C    01 0020        C                  LD      BC,32
  DD2F    CD D8EF        C                  CALL    K1.GNRWR
  DD32    CD D6B1        C                  CALL    K1.GNSTS
  DD35    CD D740        C                  CALL    K1.GNRW             ;DS - Satz korrigieren
  DD38    16 02          C                  LD      D,2
  DD3A    CD D7B3        C                  CALL    K1.GNLPN
  DD3D    CD D85B        C                  CALL    K1.GNRD
  DD40    CD D85B        C                  CALL    K1.GNRD
  DD43    FD 7E 17       C                  LD      A,(IY+17H)          ;naechste freie Datei
  DD46    3C             C                  INC     A
  DD47    32 B015        C                  LD      (KS.PUFFS+2),A
  DD4A    F1             C                  POP     AF                  ;Anzahl Verzeichniseintraege
  DD4B    32 B017        C                  LD      (KS.PUFFS+4),A
  DD4E    CD D5C1        C                  CALL    K1.LHLBC
  DD51    11 BBF0        C                  LD      DE,S0.PFFA
  DD54    ED B0          C                  LDIR
  DD56    CD D780        C                  CALL    K1.GNRM
  DD59    CD D780        C                  CALL    K1.GNRM
  DD5C    CD D765        C                  CALL    K1.GNRP
  DD5F    21 BBF0        C                  LD      HL,S0.PFFA
  DD62    01 0020        C                  LD      BC,32
  DD65    CD D91A        C                  CALL    K1.GNRW2
  DD68    CD D740        C                  CALL    K1.GNRW
  DD6B    CD D725        C                  CALL    K1.GNRA
  DD6E    C9             C                  RET
                         C                  TITLE   'K M B G  Komplex-Routinen Teil III'
                         C                  PAGE
'K M B G  Komplex-Routinen Teil III'	MACRO-80 3.44	09-Dec-81	PAGE	1-103


                         C      
                         C      ;****************************************************************
                         C      ;*  K M B G      K o m p l e x - R o u t i n e n   Teil III     *
                         C      ;****************************************************************
  DD6F    DD6F           C                  DW      $                   ;X K A 1  n   ---   X K A 2  n
  DD71    58 4B 41 31    C                  DB      'XKA1'
  DD75    CD D5ED        C                  CALL    K1.RGL1
  DD78    18 09          C                  JR      K1.M0
                         C      
  DD7A    DD7A           C                  DW      $
  DD7C    58 4B 41 32    C                  DB      'XKA2'
  DD80    CD D5FE        C                  CALL    K1.RGL2
  DD83    26 07          C      K1.M0:      LD      H,7                 ;SPOL= 8
  DD85    2E 0A          C                  LD      L,S0.SYSZ-1         ;ZPOL=SYSZ
  DD87    22 B18A        C                  LD      (MS.ZPOL),HL
  DD8A    21 B13A        C                  LD      HL,K2.ADRK
  DD8D    06 06          C                  LD      B,6
  DD8F    3E 2C          C                  LD      A,44
  DD91    32 B198        C                  LD      (MS.CMD),A
  DD94    CD CB10        C                  CALL    MO.MONI
  DD97    11 B13A        C                  LD      DE,K2.ADRK
  DD9A    CD C592        C                  CALL    S1.IDH
  DD9D    7D             C                  LD      A,L
  DD9E    32 B12C        C                  LD      (K2.PTADR),A
  DDA1    2A B24F        C                  LD      HL,(S2.TPA)
  DDA4    22 B126        C                  LD      (K2.TXANF),HL
  DDA7    2A B251        C                  LD      HL,(S2.TPE)
  DDAA    22 B128        C                  LD      (K2.TXEND),HL
  DDAD    CD D708        C                  CALL    K1.GNRE
  DDB0    CD D740        C                  CALL    K1.GNRW
  DDB3    3A B12C        C                  LD      A,(K2.PTADR)
  DDB6    3D             C                  DEC     A
  DDB7    28 04          C                  JR      Z,K1.M2
  DDB9    57             C                  LD      D,A
  DDBA    CD D7B3        C                  CALL    K1.GNLPN
  DDBD    CD D885        C      K1.M2:      CALL    K1.GNRDR
  DDC0    2A B128        C                  LD      HL,(K2.TXEND)
  DDC3    22 B257        C                  LD      (S2.END),HL
  DDC6    CD D740        C                  CALL    K1.GNRW
  DDC9    CD D725        C                  CALL    K1.GNRA
  DDCC    C3 DA1C        C                  JP      K1.STS
                         C      
                         C                  PAGE
'K M B G  Komplex-Routinen Teil III'	MACRO-80 3.44	09-Dec-81	PAGE	1-104


                         C      
  DDCF    DDCF           C                  DW      $                   ;Y K A 1  n   ---   Y K A 2  n
  DDD1    59 4B 41 31    C                  DB      'YKA1'
  DDD5    CD D5ED        C                  CALL    K1.RGL1
  DDD8    18 09          C                  JR      K1.M3
                         C      
  DDDA    DDDA           C                  DW      $
  DDDC    59 4B 41 32    C                  DB      'YKA2'
  DDE0    CD D5FE        C                  CALL    K1.RGL2
  DDE3    26 07          C      K1.M3:      LD      H,7                 ;SPOL= 8
  DDE5    2E 0A          C                  LD      L,S0.SYSZ-1         ;ZPOL=SYSZ
  DDE7    22 B18A        C                  LD      (MS.ZPOL),HL
  DDEA    21 B13A        C                  LD      HL,K2.ADRK
  DDED    06 06          C                  LD      B,6
  DDEF    3E 2C          C                  LD      A,44
  DDF1    32 B198        C                  LD      (MS.CMD),A
  DDF4    CD CB10        C                  CALL    MO.MONI
  DDF7    11 B13A        C                  LD      DE,K2.ADRK
  DDFA    CD C592        C                  CALL    S1.IDH
  DDFD    7D             C                  LD      A,L
  DDFE    32 B12C        C                  LD      (K2.PTADR),A
  DE01    2A B24F        C                  LD      HL,(S2.TPA)
  DE04    22 B126        C                  LD      (K2.TXANF),HL
  DE07    2A B257        C                  LD      HL,(S2.END)
  DE0A    22 B128        C                  LD      (K2.TXEND),HL
  DE0D    CD D708        C                  CALL    K1.GNRE
  DE10    CD D740        C                  CALL    K1.GNRW
  DE13    3A B12C        C                  LD      A,(K2.PTADR)
  DE16    3D             C                  DEC     A
  DE17    28 04          C                  JR      Z,K1.M5
  DE19    57             C                  LD      D,A
  DE1A    CD D7B3        C                  CALL    K1.GNLPN
  DE1D    CD D93A        C      K1.M5:      CALL    K1.GNWRT
  DE20    CD D82E        C                  CALL    K1.GNCLS
  DE23    CD D740        C                  CALL    K1.GNRW
  DE26    CD D725        C                  CALL    K1.GNRA
  DE29    C3 DA1C        C      K1.M6:      JP      K1.STS
                         C      
                         C                  PAGE
'K M B G  Komplex-Routinen Teil III'	MACRO-80 3.44	09-Dec-81	PAGE	1-105


                         C      
                         C      ;****************************************************************
                         C      ;*               Systemkommandos fuer  MRES - OPEN/CLOSE        *
                         C      ;****************************************************************
  DE2C    DE2C           C                  DW      $                   ;K 1 M E   ---   K 2 M E
  DE2E    4B 31 4D 45    C                  DB      'K1ME'
  DE32    CD D5ED        C                  CALL    K1.RGL1
  DE35    18 09          C                  JR      K1.ME1
                         C      
  DE37    DE37           C                  DW      $
  DE39    4B 32 4D 45    C                  DB      'K2ME'
  DE3D    CD D5FE        C                  CALL    K1.RGL2
  DE40    CD DBE4        C      K1.ME1:     CALL    K1.MREPO
  DE43    18 E4          C      K1.ME2:     JR      K1.M6
                         C      
                         C      
                         C      
  DE45    DE45           C                  DW      $                   ;K 1 M A   ---   K 2 M A
  DE47    4B 31 4D 41    C                  DB      'K1MA'
  DE4B    CD D5ED        C                  CALL    K1.RGL1
  DE4E    18 09          C                  JR      K1.ME3
                         C      
  DE50    DE50           C                  DW      $
  DE52    4B 32 4D 41    C                  DB      'K2MA'
  DE56    CD D5FE        C                  CALL    K1.RGL2
  DE59    CD DC26        C      K1.ME3:     CALL    K1.MRAPO
  DE5C    18 E5          C                  JR      K1.ME2
                         C      
                         C      
                         C      
  DE5E    DE5E           C                  DW      $                   ;K 1 M C   ---   K 2 M C
  DE60    4B 31 4D 43    C                  DB      'K1MC'
  DE64    CD D5ED        C                  CALL    K1.RGL1
  DE67    18 09          C                  JR      K1.ME4
                         C      
  DE69    DE69           C                  DW      $
  DE6B    4B 32 4D 43    C                  DB      'K2MC'
  DE6F    CD D5FE        C                  CALL    K1.RGL2
  DE72    CD DC83        C      K1.ME4:     CALL    K1.MRCLS
  DE75    18 CC          C                  JR      K1.ME2
                         C      
                         C                  PAGE
'K M B G  Komplex-Routinen Teil III'	MACRO-80 3.44	09-Dec-81	PAGE	1-106


                         C      
                         C      ;****************************************************************
                         C      ;*  K M B G      T e s t a u f r u f  von   BRKMB               *
                         C      ;****************************************************************
  DE77    DE77           C                  DW      $                   ;K M B G
  DE79    4B 4D 42 47    C                  DB      'KMBG'
  DE7D    DD 21 0013     C                  LD      IX,S3.KS1-S3.SEAT
  DE81    11 A803        C                  LD      DE,S0.DEAT+3
  DE84    DD 19          C                  ADD     IX,DE
  DE86    CD D566        C                  CALL    K1.ARMBM
  DE89    E1             C                  POP     HL
  DE8A    E1             C                  POP     HL
  DE8B    C9             C                  RET
                         C      
                         C      
                         C      
  DE8C    01             C      K1.ZMIN:    DB      1
  DE8D    01             C                  DB      1
  DE8E    18             C                  DB      S0.ZANZ
  DE8F    50             C                  DB      S0.SPANZ
  DE90    18             C                  DB      S0.ZANZ
  DE91    50             C                  DB      S0.SPANZ
  DE92    A000           C                  DW      S0.BWSA
  DE94    C0             C                  DB      0C0H
  DE95    C0             C                  DB      0C0H
                         C      
                         C      
                         C      
                         C      ;           END
                         C      ;           PN      LO28
                         C                  TITLE   'LOADer / SAVE fuer MRES - Dateien'
                         C                  PAGE
'LOADer / SAVE fuer MRES - Dateien'	MACRO-80 3.44	09-Dec-81	PAGE	1-107


                         C      
                         C      ;****************************************************************
                         C      ;*               absoluter LOADer fuer  M R E S - P   - Dateien *
                         C      ;*               relativer LOADer fuer  M R E S - R/O - Dateien *
                         C      ;*                         SAVE   fuer  M R E S - P   - Dateien *
                         C      ;*  Version      -----------------------------------------------*
                         C      ;*               Programmierer: M. Herbote --- K EAW  ZFT (WFT) *
                         C      ;*  V 2 . 1      -----------------------------------------------*
                         C      ;*               Stand        : 09.November 1984                *
                         C      ;****************************************************************
                         C                  TITLE   'abs. / rel. LOADer'
  DE96    56 32 2E 31    C                  DB      'V2.1/091184'
  DE9A    2F 30 39 31    C      
  DE9E    31 38 34       C      
                         C      
  DEA1    DEA1           C                  DW      $
  DEA3    4C 50 31 20    C                  DB      'LP1 '
  DEA7    3E 01          C                  LD      A,1
  DEA9    18 08          C                  JR      LO.LO11
                         C      
  DEAB    DEAB           C                  DW      $
  DEAD    4C 50 32 20    C                  DB      'LP2 '
  DEB1    3E 02          C                  LD      A,2
  DEB3    32 B26C        C      LO.LO11:    LD      (S2.RBBR),A
  DEB6    3E 01          C                  LD      A,1
  DEB8    32 B26D        C                  LD      (S2.RBBR+1),A
  DEBB    CD DED2        C                  CALL    LO.LOEIN
                         C      
  DEBE    CD C3BF        C      LO.LO1:     CALL    S1.ANZEI            ;Eingabe des Dateinamens
  DEC1    0C             C                  DB      S0.SYSZ+1           ;ZPOS=SYSZ+2
  DEC2    15             C                  DB      21                  ;SPOS=22
  DEC3    00             C                  DB      0
  DEC4    06             C                  DB      6                   ;Eingabelaenge
  DEC5    AA             C                  DB      10101010B           ;TS.SPMER
  DEC6    0000           C                  DW      0                   ;NEG QUIT
  DEC8    DEE9           C                  DW      LO.LO2              ;POS QUIT
  DECA    DECC           C                  DW      LO.EIN              ;EINA
                         C      
  DECC    FE 2C          C      LO.EIN:     CP      ','                 ;Tastenroutine alphanum. Tasten
  DECE    C8             C                  RET     Z
  DECF    C3 C328        C                  JP      S1.AEIN
                         C      
  DED2    CD C3BF        C      LO.LOEIN:   CALL    S1.ANZEI            ;Anzeige: MRES - Eingabedatei:
  DED5    0C             C                  DB      S0.SYSZ+1           ;ZPOS=SYSZ+2
  DED6    00             C                  DB      0                   ;SPOS=1
  DED7    95             C                  DB      21+80H              ;Textlaenge
  DED8    E279           C                  DW      LO.TXT1
  DEDA    00             C                  DB      0                   ;Eingabelaenge
  DEDB    C9             C                  RET
                         C      
  DEDC    CD DED2        C      LO.LOAUS:   CALL    LO.LOEIN
  DEDF    CD C3BF        C                  CALL    S1.ANZEI            ;Anzeige: MRES - Ausgabedatei:
  DEE2    0C             C                  DB      S0.SYSZ+1           ;ZPOS=SYSZ+2
  DEE3    07             C                  DB      7                   ;SPOS= 8
  DEE4    83             C                  DB      3+80H               ;Textlaenge
  DEE5    E316           C                  DW      LO.TXT15
  DEE7    00             C                  DB      0                   ;Eingabelaenge
  DEE8    C9             C                  RET
                         C      
                         C                  PAGE
'abs. / rel. LOADer'	MACRO-80 3.44	09-Dec-81	PAGE	1-108


                         C      
  DEE9    C5             C      LO.LO2:     PUSH    BC
  DEEA    E5             C                  PUSH    HL
  DEEB    CD E26A        C                  CALL    LO.RGL
  DEEE    FD E5          C      LO.LO4:     PUSH    IY                  ;Programmname aus BWS uebernehmen
  DEF0    D1             C                  POP     DE
  DEF1    E1             C                  POP     HL
  DEF2    C1             C                  POP     BC
  DEF3    ED B0          C                  LDIR
  DEF5    EB             C                  EX      DE,HL
  DEF6    3A B26D        C                  LD      A,(S2.RBBR+1)       ;Abfrage, ob abs. oder rel. LOAD
  DEF9    FE 02          C                  CP      2
  DEFB    28 64          C                  JR      Z,LO.LO8
  DEFD    36 50          C                  LD      (HL),'P'            ;Dateityp   in PAR-Bereich eintr.
  DEFF    23             C                  INC     HL
  DF00    36 20          C                  LD      (HL),' '            ;Dateiattr. in PAR-Bereich eintr.
  DF02    3A B26D        C                  LD      A,(S2.RBBR+1)       ;Abfrage, ob LOAD oder SAVE
  DF05    FE 03          C                  CP      3
  DF07    CA E036        C                  JP      Z,LO.SAV4
                         C      
  DF0A    CD E0C9        C                  CALL    LO.AL               ;posit. und laden der Datei
                         C      
  DF0D    28 13          C                  JR      Z,LO.LO7
  DF0F    FE 02          C      LO.LO13:    CP      2
  DF11    28 05          C                  JR      Z,LO.LO5
  DF13    21 E33F        C                  LD      HL,LO.TXT9
  DF16    18 03          C                  JR      LO.LO6
                         C      
  DF18    21 E365        C      LO.LO5:     LD      HL,LO.TXT10
  DF1B    ED 5B B136     C      LO.LO6:     LD      DE,(K2.FRADR)
  DF1F    C3 C4F4        C                  JP      S1.FEHR
                         C      
  DF22    D5             C      LO.LO7:     PUSH    DE
  DF23    7A             C                  LD      A,D                 ;Startadresse vorhanden ?
  DF24    B3             C                  OR      E
  DF25    CA C114        C                  JP      Z,S1.SYSTB
                         C      
  DF28    CD C3BF        C      LO.LO14:    CALL    S1.ANZEI            ;Anzeige: Programm starten ?
  DF2B    0D             C                  DB      S0.SYSZ+2           ;ZPOS=SYSZ+3
  DF2C    00             C                  DB      0                   ;SPOS=1
  DF2D    95             C                  DB      21+80H
  DF2E    E28E           C                  DW      LO.TXT2
  DF30    00             C                  DB      0
                         C      
  DF31    CD D408        C                  CALL    TA.LOE              ;Tastaturaktivierung
  DF34    E1             C                  POP     HL                  ;POS QUIT
  DF35    22 B223        C                  LD      (TS.TAB4),HL
  DF38    21 C114        C                  LD      HL,S1.SYSTB         ;NEG QUIT
  DF3B    22 B21B        C                  LD      (TS.TAB3+4),HL
  DF3E    3E 80          C                  LD      A,10000000B
  DF40    32 B23F        C                  LD      (TS.SPMER),A
  DF43    C9             C                  RET
                         C      
                         C                  PAGE
'abs. / rel. LOADer'	MACRO-80 3.44	09-Dec-81	PAGE	1-109


                         C      
                         C      ;****************************************************************
                         C      ;*               Eintrittspunkt Relativloader                   *
                         C      ;****************************************************************
  DF44    DF44           C                  DW      $
  DF46    52 4C 44 31    C                  DB      'RLD1'
  DF4A    3E 01          C                  LD      A,1
  DF4C    32 B26C        C      LO.LO12:    LD      (S2.RBBR),A
  DF4F    3E 02          C                  LD      A,2
  DF51    32 B26D        C                  LD      (S2.RBBR+1),A
  DF54    C3 DEBB        C                  JP      LO.LO1-3
                         C      
  DF57    DF57           C                  DW      $
  DF59    52 4C 44 32    C                  DB      'RLD2'
  DF5D    3E 02          C                  LD      A,2
  DF5F    18 EB          C                  JR      LO.LO12
                         C      
  DF61    23             C      LO.LO8:     INC     HL                  ;Dateiattr. in PAR-Bereich eintragen
  DF62    36 20          C                  LD      (HL),' '
  DF64    CD C3BF        C                  CALL    S1.ANZEI            ;Anzeige: MRES - Dateityp
  DF67    0E             C                  DB      S0.SYSZ+3           ;ZPOS=SYSZ+4
  DF68    00             C                  DB      0                   ;SPOS=1
  DF69    95             C                  DB      21+80H
  DF6A    E2E9           C                  DW      LO.TXT7
  DF6C    01             C                  DB      1
  DF6D    A0             C                  DB      10100000B
  DF6E    0000           C                  DW      0
  DF70    DF7E           C                  DW      LO.LO15
  DF72    DF74           C                  DW      LO.EIN2
                         C      
  DF74    FE 4F          C      LO.EIN2:    CP      'O'
  DF76    28 03          C                  JR      Z,LO.EIN3
  DF78    FE 52          C                  CP      'R'
  DF7A    C0             C                  RET     NZ
  DF7B    C3 C328        C      LO.EIN3:    JP      S1.AEIN
                         C      
                         C                  PAGE
'abs. / rel. LOADer'	MACRO-80 3.44	09-Dec-81	PAGE	1-110


                         C      
  DF7E    C5             C      LO.LO15:    PUSH    BC
  DF7F    E5             C                  PUSH    HL
  DF80    3A B26C        C                  LD      A,(S2.RBBR)         ;Dateityp   in PAR-Bereich eintragen
  DF83    FE 02          C                  CP      2
  DF85    28 05          C                  JR      Z,LO.LO18
  DF87    21 00AA        C                  LD      HL,S3.KSK1-S3.SEAT
  DF8A    18 03          C                  JR      LO.LO19
  DF8C    21 00CE        C      LO.LO18:    LD      HL,S3.KSK2-S3.SEAT
  DF8F    11 A80A        C      LO.LO19:    LD      DE,S0.DEAT+10
  DF92    19             C                  ADD     HL,DE
  DF93    EB             C                  EX      DE,HL
  DF94    E1             C                  POP     HL
  DF95    C1             C                  POP     BC
  DF96    ED B0          C                  LDIR
  DF98    21 E2A3        C                  LD      HL,LO.TXT3          ;Anzeige: Ladeanfangs-Adresse: 0000H
  DF9B    11 DFA4        C                  LD      DE,LO.LO9
  DF9E    06 0F          C                  LD      B,S0.SYSZ+4
  DFA0    CD E1DE        C                  CALL    LO.TXT
  DFA3    C9             C                  RET
  DFA4    06 0F          C      LO.LO9:     LD      B,S0.SYSZ+4         ;Ladeanfangsadresse umwandeln
  DFA6    CD E248        C                  CALL    LO.TR1
  DFA9    ED 53 B265     C                  LD      (S2.PRGN),DE
  DFAD    21 E2B9        C                  LD      HL,LO.TXT5          ;Anzeige: Start      -Adresse: 0000H
  DFB0    11 DFB9        C                  LD      DE,LO.LO10
  DFB3    06 11          C                  LD      B,S0.SYSZ+6
  DFB5    CD E1DE        C                  CALL    LO.TXT
  DFB8    C9             C                  RET
  DFB9    06 11          C      LO.LO10:    LD      B,S0.SYSZ+6         ;Startadresse umwandeln
  DFBB    CD E248        C                  CALL    LO.TR1
  DFBE    ED 53 B267     C                  LD      (S2.PRGN+2),DE
  DFC2    CD E26A        C                  CALL    LO.RGL
  DFC5    CD E0FA        C                  CALL    LO.RL               ;posit. und laden der Datei
  DFC8    C2 DF0F        C                  JP      NZ,LO.LO13          ;Sprung zur Fehlerbehandlung
  DFCB    E5             C                  PUSH    HL
  DFCC    3E 02          C                  LD      A,2
  DFCE    32 B198        C                  LD      (MS.CMD),A
  DFD1    CD CB10        C                  CALL    MO.MONI
  DFD4    26 00          C                  LD      H,0                 ;Anzeige: Ladeende   -Adresse: 0000H
  DFD6    2E 10          C                  LD      L,S0.SYSZ+5
  DFD8    22 B18C        C                  LD      (MS.ZPOS),HL
  DFDB    3E 18          C                  LD      A,24
  DFDD    32 B198        C                  LD      (MS.CMD),A
  DFE0    06 0B          C                  LD      B,11
  DFE2    21 E2AE        C                  LD      HL,LO.TXT4
  DFE5    CD CB10        C                  CALL    MO.MONI
  DFE8    06 0F          C                  LD      B,15
  DFEA    21 E2DA        C                  LD      HL,LO.TXT6
  DFED    CD CB10        C                  CALL    MO.MONI
  DFF0    21 B29A        C                  LD      HL,S2.DM1           ;Ladeendeadresse umwandeln
  DFF3    D1             C                  POP     DE
  DFF4    7A             C                  LD      A,D
  DFF5    CD C5FF        C                  CALL    S1.BHKON
  DFF8    7B             C                  LD      A,E
  DFF9    CD C5FF        C                  CALL    S1.BHKON
  DFFC    3E 15          C                  LD      A,21                ;Ladeendeadresse anzeigen
  DFFE    32 B18D        C                  LD      (MS.SPOS),A
  E001    06 04          C                  LD      B,4
  E003    21 B29A        C                  LD      HL,S2.DM1
  E006    CD CB10        C                  CALL    MO.MONI
  E009    2A B267        C                  LD      HL,(S2.PRGN+2)
  E00C    E5             C                  PUSH    HL
  E00D    C3 DF28        C                  JP      LO.LO14
                         C      
                         C                  TITLE   'S A V E'
                         C      ;****************************************************************
                         C      ;*                  Eintrittspunkt  S A V E                     *
                         C      ;****************************************************************
  E010    E010           C                  DW      $
  E012    53 41 56 45    C                  DB      'SAVE'
  E016    3E 03          C                  LD      A,3                 ;Merker SAVE
  E018    32 B26D        C                  LD      (S2.RBBR+1),A
  E01B    26 07          C                  LD      H,7                 ;ZPOS=SYSZ , SPOS= 8
  E01D    2E 0A          C                  LD      L,S0.SYSZ-1
  E01F    22 B18C        C                  LD      (MS.ZPOS),HL
  E022    3E 0B          C                  LD      A,11                ;HL:=ZPOS,SPOS
  E024    32 B198        C                  LD      (MS.CMD),A
  E027    CD CB10        C                  CALL    MO.MONI
  E02A    7E             C                  LD      A,(HL)              ;Geraetenummer
  E02B    E6 0F          C                  AND     00FH
  E02D    32 B26C        C                  LD      (S2.RBBR),A         ;Geraeteadresse
  E030    CD DEDC        C      LO.SAV3:    CALL    LO.LOAUS
'S A V E'	MACRO-80 3.44	09-Dec-81	PAGE	1-111


  E033    C3 DEBE        C                  JP      LO.LO1
                         C      
  E036    06 06          C      LO.SAV4:    LD      B,6                 ;Kommentar eintragen
  E038    23             C                  INC     HL
  E039    36 20          C                  LD      (HL),' '
  E03B    10 FB          C                  DJNZ    $-3
  E03D    CD E26A        C                  CALL    LO.RGL
  E040    CD DC26        C                  CALL    K1.MRAPO
  E043    28 06          C                  JR      Z,LO.SAV7
  E045    CD D620        C                  CALL    K1.FL
  E048    C3 C114        C                  JP      S1.SYSTB
                         C      
  E04B    21 E2C4        C      LO.SAV7:    LD      HL,LO.TXT12         ;Anzeige: SAVEanfangs-Adresse: 0000H
  E04E    11 E057        C                  LD      DE,LO.SAV8
  E051    06 0F          C                  LD      B,S0.SYSZ+4
  E053    CD E1DE        C                  CALL    LO.TXT
  E056    C9             C                  RET
                         C      
  E057    06 0F          C      LO.SAV8:    LD      B,S0.SYSZ+4         ;SAVEanfangsadresse umwandeln
  E059    CD E248        C                  CALL    LO.TR1
  E05C    ED 53 B265     C                  LD      (S2.PRGN),DE
  E060    21 E2CF        C                  LD      HL,LO.TXT13         ;Anzeige: SAVEende   -Adresse: 0000H
  E063    11 E06C        C                  LD      DE,LO.SAV9
  E066    06 10          C                  LD      B,S0.SYSZ+5
  E068    CD E1DE        C                  CALL    LO.TXT
  E06B    C9             C                  RET
                         C      
  E06C    06 10          C      LO.SAV9:    LD      B,S0.SYSZ+5         ;SAVEendeadresse umwandeln
  E06E    CD E248        C                  CALL    LO.TR1
  E071    ED 53 B267     C                  LD      (S2.PRGN+2),DE
  E075    CD E26A        C                  CALL    LO.RGL
  E078    CD E196        C                  CALL    LO.SAVE
  E07B    CD C3BF        C                  CALL    S1.ANZEI
  E07E    11             C                  DB      S0.SYSZ+6
  E07F    00             C                  DB      0
  E080    98             C                  DB      24+80H
  E081    E2FE           C                  DW      LO.TXT14
  E083    01             C                  DB      1
  E084    80             C                  DB      10000000B
  E085    E0A3           C                  DW      LO.SAV13
  E087    E08B           C                  DW      LO.SAV12
  E089    0000           C                  DW      0
                         C      
  E08B    26 00          C      LO.SAV12:   LD      H,0                 ;weitere Bloecke
  E08D    2E 0C          C                  LD      L,S0.SYSZ+1
  E08F    22 B18E        C                  LD      (MS.ZMIN),HL
  E092    26 50          C                  LD      H,80
  E094    2E 11          C                  LD      L,S0.SYSZ+6
  E096    22 B190        C                  LD      (MS.ZMAX),HL
  E099    3E 05          C                  LD      A,5
  E09B    32 B198        C                  LD      (MS.CMD),A
  E09E    CD CB10        C                  CALL    MO.MONI
  E0A1    18 A8          C                  JR      LO.SAV7
                         C      
  E0A3    21 E2B9        C      LO.SAV13:   LD      HL,LO.TXT5          ;keine weiteren Bloecke
  E0A6    11 E0AF        C                  LD      DE,LO.SAV14
  E0A9    06 12          C                  LD      B,S0.SYSZ+7
  E0AB    CD E1DE        C                  CALL    LO.TXT
  E0AE    C9             C                  RET
                         C      
  E0AF    CD E26A        C      LO.SAV14:   CALL    LO.RGL
  E0B2    06 12          C                  LD      B,S0.SYSZ+7         ;Startadress-Block ausgeben
  E0B4    CD E248        C                  CALL    LO.TR1
  E0B7    AF             C                  XOR     A
  E0B8    CD DB6E        C                  CALL    K1.SCHR
  E0BB    7A             C                  LD      A,D
  E0BC    CD DB6E        C                  CALL    K1.SCHR
  E0BF    7B             C                  LD      A,E
  E0C0    CD DB6E        C                  CALL    K1.SCHR
  E0C3    CD DC83        C                  CALL    K1.MRCLS
  E0C6    C3 C114        C                  JP      S1.SYSTB
                         C      
                         C                  TITLE   'Unterprogramme'
                         C                  PAGE
'Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-112


                         C      
                         C      ;****************************************************************
                         C      ;*               Unterprogramm: absoluter LOAD                  *
                         C      ;*               -----------------------------------------------*
                         C      ;*               Eingabeparameter: K2.MRPAR ... Dateiname       *
                         C      ;*                                          ... Dateityp    P   *
                         C      ;*                                          ... Dateiattribut   *
                         C      ;*               Ausgabeparameter: DE       ... Startadresse    *
                         C      ;*                                 Z-FF = 1 ... normales Ende   *
                         C      ;*                                 Z-FF = 0 ... abnorm.  Ende   *
                         C      ;*                                 A    = 1 ... Datei nicht da  *
                         C      ;*                                 A    = 2 ... Datei nicht pos.*
                         C      ;****************************************************************
  E0C9    CD DBE4        C      LO.AL:      CALL    K1.MREPO
  E0CC    C0             C                  RET     NZ
                         C      
  E0CD    CD DB51        C      LO.UW:      CALL    K1.LESV
  E0D0    47             C                  LD      B,A
  E0D1    B7             C                  OR      A
  E0D2    28 11          C                  JR      Z,LO.UWEND
  E0D4    CD DB51        C                  CALL    K1.LESV
  E0D7    57             C                  LD      D,A
  E0D8    CD DB51        C                  CALL    K1.LESV
  E0DB    5F             C                  LD      E,A
  E0DC    CD DB51        C      LO.UW1:     CALL    K1.LESV
  E0DF    12             C                  LD      (DE),A
  E0E0    13             C                  INC     DE
  E0E1    10 F9          C                  DJNZ    LO.UW1
  E0E3    18 E8          C                  JR      LO.UW
                         C      
  E0E5    CD DB51        C      LO.UWEND:   CALL    K1.LESV
  E0E8    57             C                  LD      D,A
  E0E9    CD DB51        C                  CALL    K1.LESV
  E0EC    5F             C                  LD      E,A
  E0ED    D5             C                  PUSH    DE
  E0EE    CD D740        C                  CALL    K1.GNRW
  E0F1    CD D725        C                  CALL    K1.GNRA
  E0F4    CD D6B1        C                  CALL    K1.GNSTS
  E0F7    D1             C                  POP     DE
  E0F8    AF             C                  XOR     A
  E0F9    C9             C                  RET
                         C      
                         C                  PAGE
'Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-113


                         C      
                         C      ;****************************************************************
                         C      ;*               Unterprogramm: relativer LOAD                  *
                         C      ;*               -----------------------------------------------*
                         C      ;*               Eingabeparameter: K2.MRPAR ... Dateiname       *
                         C      ;*                                          ... Dateityp  R / O *
                         C      ;*                                          ... Dateiattribut   *
                         C      ;*                                 S2.PRGN  ... Ladeanfangsadr. *
                         C      ;*               Ausgabeparameter: HL       ... Ladeendeadresse *
                         C      ;*                                 Z-FF = 1 ... normales Ende   *
                         C      ;*                                 Z-FF = 0 ... abnorm.  Ende   *
                         C      ;*                                 A    = 1 ... Datei nicht da  *
                         C      ;*                                 A    = 2 ... Datei nicht pos.*
                         C      ;****************************************************************
  E0FA    CD DBE4        C      LO.RL:      CALL    K1.MREPO
  E0FD    C0             C                  RET     NZ
                         C      
  E0FE    2A B265        C      LO.RL1:     LD      HL,(S2.PRGN)
  E101    0E 01          C                  LD      C,1
  E103    CD E17B        C                  CALL    LO.RLUP
                         C      
  E106    CB 5F          C      LO.RL2:     BIT     3,A
  E108    20 6B          C                  JR      NZ,LO.DF
  E10A    CB 67          C                  BIT     4,A
  E10C    20 53          C                  JR      NZ,LO.RL8
  E10E    E6 07          C                  AND     7
  E110    28 5E          C                  JR      Z,LO.RL9
  E112    47             C                  LD      B,A
  E113    CD E17B        C      LO.RL3:     CALL    LO.RLUP
  E116    77             C                  LD      (HL),A
  E117    23             C                  INC     HL
  E118    10 F9          C                  DJNZ    LO.RL3
  E11A    CD E17B        C                  CALL    LO.RLUP
  E11D    CB 7F          C                  BIT     7,A
  E11F    20 E5          C                  JR      NZ,LO.RL2
  E121    CB 6F          C                  BIT     5,A
  E123    28 50          C                  JR      Z,LO.DF
  E125    CB 77          C                  BIT     6,A
  E127    20 4C          C                  JR      NZ,LO.DF
  E129    CB 57          C                  BIT     2,A
  E12B    20 48          C                  JR      NZ,LO.DF
  E12D    E6 03          C      LO.RL4:     AND     3
  E12F    F5             C                  PUSH    AF
  E130    E5             C                  PUSH    HL
  E131    CD E17B        C                  CALL    LO.RLUP
  E134    67             C                  LD      H,A
  E135    CD E17B        C                  CALL    LO.RLUP
  E138    6F             C                  LD      L,A
  E139    C5             C                  PUSH    BC
  E13A    3A B265        C                  LD      A,(S2.PRGN)         ;Anfangslade-adresse ==> BC
  E13D    4F             C                  LD      C,A
  E13E    3A B266        C                  LD      A,(S2.PRGN+1)
  E141    47             C                  LD      B,A
  E142    09             C                  ADD     HL,BC
  E143    EB             C                  EX      DE,HL
  E144    C1             C                  POP     BC
  E145    E1             C                  POP     HL
  E146    F1             C                  POP     AF
  E147    28 04          C                  JR      Z,LO.RL5
  E149    CB 47          C                  BIT     0,A
  E14B    28 09          C                  JR      Z,LO.RL6
  E14D    73             C      LO.RL5:     LD      (HL),E
  E14E    23             C                  INC     HL
  E14F    FE 03          C                  CP      3
  E151    28 03          C                  JR      Z,LO.RL6
  E153    B7             C                  OR      A
  E154    20 02          C                  JR      NZ,LO.RL7
  E156    72             C      LO.RL6:     LD      (HL),D
  E157    23             C                  INC     HL
  E158    CD E17B        C      LO.RL7:     CALL    LO.RLUP
  E15B    CB 7F          C                  BIT     7,A
  E15D    20 A7          C                  JR      NZ,LO.RL2
  E15F    18 14          C                  JR      LO.DF
  E161    CD E17B        C      LO.RL8:     CALL    LO.RLUP
  E164    F5             C                  PUSH    AF
  E165    CD E17B        C                  CALL    LO.RLUP
  E168    D1             C                  POP     DE
  E169    5F             C                  LD      E,A
  E16A    19             C                  ADD     HL,DE
  E16B    CD E17B        C                  CALL    LO.RLUP
  E16E    18 96          C                  JR      LO.RL2
  E170    CD E17B        C      LO.RL9:     CALL    LO.RLUP
'Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-114


  E173    18 B8          C                  JR      LO.RL4
                         C      
  E175    21 E319        C      LO.DF:      LD      HL,LO.TXT8
  E178    C3 C4EE        C                  JP      S1.FEH
                         C      
  E17B    CD DB51        C      LO.RLUP:    CALL    K1.LESV
  E17E    0D             C                  DEC     C
  E17F    C0             C                  RET     NZ
  E180    A7             C                  AND     A
  E181    28 04          C                  JR      Z,LO.RL10
  E183    4F             C                  LD      C,A
  E184    0C             C                  INC     C
  E185    18 F4          C                  JR      LO.RLUP
  E187    D1             C      LO.RL10:    POP     DE
  E188    2B             C                  DEC     HL
  E189    E5             C                  PUSH    HL
  E18A    CD D740        C                  CALL    K1.GNRW
  E18D    CD D725        C                  CALL    K1.GNRA
  E190    CD D6B1        C                  CALL    K1.GNSTS
  E193    E1             C                  POP     HL
  E194    AF             C                  XOR     A
  E195    C9             C                  RET
                         C      
                         C                  PAGE
'Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-115


                         C      
                         C      ;****************************************************************
                         C      ;*               Unterprogramm: SAVE                            *
                         C      ;*               -----------------------------------------------*
                         C      ;*               Eingabeparameter: S2.PRGN  ... SAVEanfangsadr. *
                         C      ;*                                 S2.PRGN+2... SAVEendeadresse *
                         C      ;****************************************************************
  E196    CD E1D3        C      LO.SAVE:    CALL    LO.SV4              ;einen Bereich ausgeben
  E199    23             C                  INC     HL
  E19A    7C             C                  LD      A,H
  E19B    B5             C                  OR      L
  E19C    28 15          C                  JR      Z,LO.SAV2
  E19E    01 007D        C                  LD      BC,7DH              ;Blocklaenge
  E1A1    B7             C                  OR      A
  E1A2    ED 42          C                  SBC     HL,BC
  E1A4    38 05          C                  JR      C,LO.SAV1
  E1A6    CD E1B4        C                  CALL    LO.SV1
  E1A9    18 EB          C                  JR      LO.SAVE
  E1AB    CD E1D3        C      LO.SAV1:    CALL    LO.SV4
  E1AE    23             C                  INC     HL
  E1AF    7D             C                  LD      A,L
  E1B0    CD E1B6        C                  CALL    LO.SV2
  E1B3    C9             C      LO.SAV2:    RET
                         C      
  E1B4    3E 7D          C      LO.SV1:     LD      A,7DH               ;einen Block ausgeben
  E1B6    F5             C      LO.SV2:     PUSH    AF
  E1B7    CD DB6E        C                  CALL    K1.SCHR             ;Blocklaenge  ausgeben
  E1BA    ED 5B B265     C                  LD      DE,(S2.PRGN)        ;Blockadresse ausgeben
  E1BE    7A             C                  LD      A,D
  E1BF    CD DB6E        C                  CALL    K1.SCHR
  E1C2    7B             C                  LD      A,E
  E1C3    CD DB6E        C                  CALL    K1.SCHR
  E1C6    C1             C                  POP     BC
  E1C7    1A             C      LO.SV3:     LD      A,(DE)
  E1C8    CD DB6E        C                  CALL    K1.SCHR             ;Datenbytes ausgeben
  E1CB    13             C                  INC     DE
  E1CC    10 F9          C                  DJNZ    LO.SV3
  E1CE    ED 53 B265     C                  LD      (S2.PRGN),DE
  E1D2    C9             C                  RET
                         C      
  E1D3    2A B267        C      LO.SV4:     LD      HL,(S2.PRGN+2)
  E1D6    ED 5B B265     C                  LD      DE,(S2.PRGN)
  E1DA    B7             C                  OR      A
  E1DB    ED 52          C                  SBC     HL,DE
  E1DD    C9             C                  RET
                         C      
                         C                  PAGE
'Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-116


                         C      
  E1DE    D5             C      LO.TXT:     PUSH    DE
  E1DF    E5             C                  PUSH    HL
  E1E0    3E 02          C                  LD      A,2                 ;Bildfenster vergroessern
  E1E2    32 B198        C                  LD      (MS.CMD),A
  E1E5    CD CB10        C                  CALL    MO.MONI
  E1E8    26 00          C                  LD      H,0                 ;ZPOS = SYSZ+  , SPOS = 0
  E1EA    68             C                  LD      L,B
  E1EB    22 B18C        C                  LD      (MS.ZPOS),HL
  E1EE    3E 18          C                  LD      A,24
  E1F0    32 B198        C                  LD      (MS.CMD),A
  E1F3    06 0B          C                  LD      B,11
  E1F5    E1             C                  POP     HL
  E1F6    CD CB10        C                  CALL    MO.MONI
  E1F9    06 0F          C                  LD      B,15                ;Anzeige: -Adresse: 0000H
  E1FB    21 E2DA        C                  LD      HL,LO.TXT6
  E1FE    CD CB10        C                  CALL    MO.MONI
  E201    2A B18C        C                  LD      HL,(MS.ZPOS)        ;ZPOS = SYSZ+  , SPOS = 21
  E204    26 15          C                  LD      H,21
  E206    22 B18C        C                  LD      (MS.ZPOS),HL
  E209    24             C                  INC     H                   ;ZMIN = SYSZ+  , SMIN = 22
  E20A    2C             C                  INC     L
  E20B    22 B18E        C                  LD      (MS.ZMIN),HL
  E20E    24             C                  INC     H                   ;ZMAX = SYSZ+  , SMAX = 25
  E20F    24             C                  INC     H
  E210    24             C                  INC     H
  E211    22 B190        C                  LD      (MS.ZMAX),HL
                         C      
  E214    CD D408        C                  CALL    TA.LOE
  E217    21 C114        C                  LD      HL,S1.SYSTB
  E21A    22 B21D        C                  LD      (TS.TAB3+6),HL
  E21D    21 E239        C                  LD      HL,LO.EIN1
  E220    22 B22D        C                  LD      (TS.EINA),HL
  E223    21 C2D3        C                  LD      HL,S1.CNLS
  E226    22 B20D        C                  LD      (TS.TAB2+14),HL
  E229    21 C2B4        C                  LD      HL,S1.CNRS
  E22C    22 B211        C                  LD      (TS.TAB2+18),HL
  E22F    E1             C                  POP     HL
  E230    22 B223        C                  LD      (TS.TAB4),HL
  E233    3E A8          C                  LD      A,10101000B
  E235    32 B23F        C                  LD      (TS.SPMER),A
  E238    C9             C                  RET
                         C      
  E239    FE 40          C      LO.EIN1:    CP      '@'
  E23B    C8             C                  RET     Z
  E23C    FE 23          C                  CP      '#'
  E23E    C8             C                  RET     Z
  E23F    FE 24          C                  CP      '$'
  E241    C8             C                  RET     Z
  E242    FE 47          C                  CP      'G'
  E244    D0             C                  RET     NC
  E245    C3 C328        C                  JP      S1.AEIN
                         C      
                         C                  PAGE
'Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-117


                         C      
  E248    26 15          C      LO.TR1:     LD      H,21                ;ZPOS=SYSZ+   , SPOS=22
  E24A    68             C                  LD      L,B
  E24B    22 B18C        C                  LD      (MS.ZPOS),HL
  E24E    3E 0B          C                  LD      A,11                ;HL:=ZPOS,SPOS
  E250    32 B198        C                  LD      (MS.CMD),A
  E253    CD CB10        C                  CALL    MO.MONI
  E256    11 B29A        C                  LD      DE,S2.DM1
  E259    01 0004        C                  LD      BC,4
  E25C    ED B0          C                  LDIR
  E25E    21 B29A        C                  LD      HL,S2.DM1
  E261    CD C5CC        C                  CALL    S1.HBKON
  E264    57             C                  LD      D,A
  E265    CD C5CC        C                  CALL    S1.HBKON
  E268    5F             C                  LD      E,A
  E269    C9             C                  RET
                         C      
  E26A    3A B26C        C      LO.RGL:     LD      A,(S2.RBBR)         ;laden IX,IY entspr. Geraet 1/2
  E26D    FE 02          C                  CP      2
  E26F    28 04          C                  JR      Z,LO.RGL1
  E271    CD D5ED        C                  CALL    K1.RGL1
  E274    C9             C                  RET
  E275    CD D5FE        C      LO.RGL1:    CALL    K1.RGL2
  E278    C9             C                  RET
                         C      
                         C                  TITLE   'Zeichenketten-Konstanten'
                         C                  PAGE
'Zeichenketten-Konstanten'	MACRO-80 3.44	09-Dec-81	PAGE	1-118


                         C      
  E279    4D 52 45 53    C      LO.TXT1:    DB      'MRES - Eingabedatei: '
  E27D    20 2D 20 45    C      
  E281    69 6E 67 61    C      
  E285    62 65 64 61    C      
  E289    74 65 69 3A    C      
  E28D    20             C      
  E28E    50 72 6F 67    C      LO.TXT2:    DB      'Programm starten ?   '
  E292    72 61 6D 6D    C      
  E296    20 73 74 61    C      
  E29A    72 74 65 6E    C      
  E29E    20 3F 20 20    C      
  E2A2    20             C      
  E2A3    4C 61 64 65    C      LO.TXT3:    DB      'Ladeanfangs'
  E2A7    61 6E 66 61    C      
  E2AB    6E 67 73       C      
  E2AE    4C 61 64 65    C      LO.TXT4:    DB      'Ladeende   '
  E2B2    65 6E 64 65    C      
  E2B6    20 20 20       C      
  E2B9    53 74 61 72    C      LO.TXT5:    DB      'Start      '
  E2BD    74 20 20 20    C      
  E2C1    20 20 20       C      
  E2C4    53 41 56 45    C      LO.TXT12:   DB      'SAVEanfangs'
  E2C8    61 6E 66 61    C      
  E2CC    6E 67 73       C      
  E2CF    53 41 56 45    C      LO.TXT13:   DB      'SAVEende   '
  E2D3    65 6E 64 65    C      
  E2D7    20 20 20       C      
  E2DA    2D 41 64 72    C      LO.TXT6:    DB      '-Adresse: 0000H'
  E2DE    65 73 73 65    C      
  E2E2    3A 20 30 30    C      
  E2E6    30 30 48       C      
  E2E9    4D 52 45 53    C      LO.TXT7:    DB      'MRES - Dateityp    : '
  E2ED    20 2D 20 44    C      
  E2F1    61 74 65 69    C      
  E2F5    74 79 70 20    C      
  E2F9    20 20 20 3A    C      
  E2FD    20             C      
  E2FE    77 65 69 74    C      LO.TXT14:   DB      'weitere Bloecke ausgeben'
  E302    65 72 65 20    C      
  E306    42 6C 6F 65    C      
  E30A    63 6B 65 20    C      
  E30E    61 75 73 67    C      
  E312    65 62 65 6E    C      
  E316    41 75 73       C      LO.TXT15:   DB      'Aus'
                         C      
  E319    44 61 74 65    C      LO.TXT8:    DB      'Datenfehler in R bzw. O - MRES-Datei  '
  E31D    6E 66 65 68    C      
  E321    6C 65 72 20    C      
  E325    69 6E 20 52    C      
  E329    20 62 7A 77    C      
  E32D    2E 20 4F 20    C      
  E331    2D 20 4D 52    C      
  E335    45 53 2D 44    C      
  E339    61 74 65 69    C      
  E33D    20 20          C      
  E33F    44 61 74 65    C      LO.TXT9:    DB      'Datei ist nicht im Verzeichnis        '
  E343    69 20 69 73    C      
  E347    74 20 6E 69    C      
  E34B    63 68 74 20    C      
  E34F    69 6D 20 56    C      
  E353    65 72 7A 65    C      
  E357    69 63 68 6E    C      
  E35B    69 73 20 20    C      
  E35F    20 20 20 20    C      
  E363    20 20          C      
  E365    44 61 74 65    C      LO.TXT10:   DB      'Datei kann nicht positioniert werden  '
  E369    69 20 6B 61    C      
  E36D    6E 6E 20 6E    C      
  E371    69 63 68 74    C      
  E375    20 70 6F 73    C      
  E379    69 74 69 6F    C      
  E37D    6E 69 65 72    C      
  E381    74 20 77 65    C      
  E385    72 64 65 6E    C      
  E389    20 20          C      
  E38B    6B 61 6E 6E    C      LO.TXT11:   DB      'kann die Datei ueberschrieben werden ?'
  E38F    20 64 69 65    C      
  E393    20 44 61 74    C      
  E397    65 69 20 75    C      
  E39B    65 62 65 72    C      
  E39F    73 63 68 72    C      
'Zeichenketten-Konstanten'	MACRO-80 3.44	09-Dec-81	PAGE	1-119


  E3A3    69 65 62 65    C      
  E3A7    6E 20 77 65    C      
  E3AB    72 64 65 6E    C      
  E3AF    20 3F          C      
                         C      
                         C      
                         C      ;           END
                         C      ;           PN      S975
                         C                  TITLE   'Anschlussroutinen fuer  B A S I C'
                         C                  PAGE
'Anschlussroutinen fuer  B A S I C'	MACRO-80 3.44	09-Dec-81	PAGE	1-120


                         C      
                         C      ;****************************************************************
                         C      ;*               Anschlussroutinen fuer  B A S I C              *
                         C      ;*  Version      -----------------------------------------------*
                         C      ;*               Programmierer: M. Herbote --- K EAW  ZFT (WFT) *
                         C      ;*  V 2 . 1      -----------------------------------------------*
                         C      ;*               Stand        : 14.Maerz 1985                   *
                         C      ;****************************************************************
                         C      
  E3B1    56 32 2E 31    C                  DB      'V2.1/140385'
  E3B5    2F 31 34 30    C      
  E3B9    33 38 35       C      
                         C      
                         C      ;****************************************************************
                         C      ;*            B A S I C   -   N e u s t a r t                   *
                         C      ;****************************************************************
  E3BC    E3BC           C                  DW      $
  E3BE    42 53 43 4E    C                  DB      'BSCN'
  E3C2    CD F603        C      S9.BASC:    CALL    S0.BASCL
  E3C5    21 0100        C                  LD      HL,00100H           ;BASIC - CRC-Summe kontrollieren
  E3C8    01 3000        C                  LD      BC,03000H
  E3CB    CD C652        C                  CALL    S1.CHK
  E3CE    21 B783        C                  LD      HL,0B783H           ;CRC-Summe 100-30FF   (06D97H alt)
  E3D1    B7             C                  OR      A
  E3D2    ED 52          C                  SBC     HL,DE
  E3D4    28 09          C                  JR      Z,S9.BASC1
  E3D6    21 E422        C                  LD      HL,S9.FT1
  E3D9    11 E3DF        C                  LD      DE,S9.BASC1
  E3DC    CD C4F4        C                  CALL    S1.FEHR
  E3DF    21 C0B0        C      S9.BASC1:   LD      HL,S1.RES           ;RESET-Adresse eintragen
  E3E2    22 3011        C                  LD      (BC.RECOV1+1),HL
  E3E5    21 E5F4        C                  LD      HL,S9.ANFPG         ;Anfangsprogramm laden
  E3E8    22 30B3        C                  LD      (BC.ANF+1),HL
  E3EB    21 EDE3        C                  LD      HL,S9.OUT
  E3EE    11 0070        C                  LD      DE,00070H
  E3F1    01 002B        C                  LD      BC,S9.OUTLG-S9.OUT
  E3F4    ED B0          C                  LDIR
  E3F6    CD E46E        C                  CALL    S9.BSC
  E3F9    C3 0300        C                  JP      BC.INIT
                         C      ;****************************************************************
                         C      ;*            B A S I C   -   R e s t a r t                     *
                         C      ;****************************************************************
  E3FC    E3FC           C                  DW      $
  E3FE    42 53 43 52    C                  DB      'BSCR'
  E402    21 0327        C      S9.BSCR:    LD      HL,BC.PAR
  E405    01 2C90        C                  LD      BC,BC.D131-BC.PAR   ;02C90H
  E408    CD C652        C                  CALL    S1.CHK
  E40B    21 B7F8        C                  LD      HL,0B7F8H           ;CRC-Summe 327-2FB7
  E40E    B7             C                  OR      A
  E40F    ED 52          C                  SBC     HL,DE
  E411    28 09          C                  JR      Z,S9.BASC2
  E413    21 E448        C                  LD      HL,S9.FT2
  E416    11 E41C        C                  LD      DE,S9.BASC2
  E419    CD C4F4        C                  CALL    S1.FEHR
  E41C    CD E46E        C      S9.BASC2:   CALL    S9.BSC
  E41F    C3 0303        C                  JP      BC.RECOV
                         C      
  E422    43 52 43 20    C      S9.FT1:     DB      'CRC - Fehler in  B A S I C - P R O M  '
  E426    2D 20 46 65    C      
  E42A    68 6C 65 72    C      
  E42E    20 69 6E 20    C      
  E432    20 42 20 41    C      
  E436    20 53 20 49    C      
  E43A    20 43 20 2D    C      
  E43E    20 50 20 52    C      
  E442    20 4F 20 4D    C      
  E446    20 20          C      
  E448    43 52 43 20    C      S9.FT2:     DB      'CRC - Fehler in  B A S I C, ==> BSCN !'
  E44C    2D 20 46 65    C      
  E450    68 6C 65 72    C      
  E454    20 69 6E 20    C      
  E458    20 42 20 41    C      
  E45C    20 53 20 49    C      
  E460    20 43 2C 20    C      
  E464    3D 3D 3E 20    C      
  E468    42 53 43 4E    C      
  E46C    20 21          C      
                         C      
                         C                  PAGE
'Anschlussroutinen fuer  B A S I C'	MACRO-80 3.44	09-Dec-81	PAGE	1-121


                         C      
  E46E    21 E4F5        C      S9.BSC:     LD      HL,S9.ATAB1         ;Anschl.rout.adr. in BASIC-Workspace eintragen
  E471    11 0306        C                  LD      DE,00306H
  E474    01 0021        C                  LD      BC,S9.ATAB2-S9.ATAB1
  E477    ED B0          C                  LDIR
  E479    21 E516        C                  LD      HL,S9.ATAB2         ;Adressen in zusaetzl. Verst.bereich eintragen
  E47C    11 B400        C                  LD      DE,0B400H
  E47F    01 0028        C                  LD      BC,S9.HOME1-S9.ATAB2
  E482    ED B0          C                  LDIR
  E484    21 0070        C                  LD      HL,00070H           ;Erweiterung OUT-Befehl aktivieren
  E487    22 1714        C                  LD      (01714H),HL
  E48A    21 0082        C                  LD      HL,00082H           ;SVC-Befehl aktivieren
  E48D    22 03C6        C                  LD      (BC.SVC1),HL
  E490    21 5620        C                  LD      HL,05620H           ;" V"
  E493    22 2D99        C                  LD      (BC.SVC2+1),HL
  E496    21 C320        C                  LD      HL,0C320H           ;" C"
  E499    22 2D9B        C                  LD      (BC.SVC2+3),HL
                         C      
                         C                  ; LD      HL,0009BH           ;GRF-Befehl aktivieren
                         C                  ; LD      (BC.GRF1),HL
                         C                  ; LD      HL,02047H           ;"G "
                         C                  ; LD      (BC.GRF2),HL
                         C                  ; LD      HL,05220H           ;" R"
                         C                  ; LD      (BC.GRF2+2),HL
                         C                  ; LD      HL,0C620H           ;" F"
                         C                  ; LD      (BC.GRF2+4),HL
                         C      
  E49C    21 0100        C                  LD      HL,S0.LRECL         ;Satzlaenge fuer Kassette eintr.
  E49F    22 B138        C                  LD      (K2.LRECL),HL
  E4A2    21 0000        C                  LD      HL,0
  E4A5    22 B18C        C                  LD      (MS.ZPOS),HL        ;ZPOS= 1 , SPOS= 1
  E4A8    3E 05          C                  LD      A,5                 ;Bildfenster loeschen
  E4AA    32 B198        C                  LD      (MS.CMD),A
  E4AD    CD CB10        C                  CALL    MO.MONI
  E4B0    21 B197        C                  LD      HL,MS.DIRES         ;Bildrollen einschalten
  E4B3    CB EE          C                  SET     5,(HL)              ;rollen allgemein
  E4B5    CB A6          C                  RES     4,(HL)              ;rollen Fensterinhalt
  E4B7    21 CD99        C                  LD      HL,MO.ROLL
  E4BA    22 B19A        C                  LD      (MS.RADR),HL
  E4BD    21 E402        C                  LD      HL,S9.BSCR
  E4C0    22 B136        C                  LD      (K2.FRADR),HL
  E4C3    CD E4D3        C                  CALL    S9.TALOE            ;Tastatur aktivieren
  E4C6    AF             C                  XOR     A
  E4C7    32 B263        C                  LD      (S2.CST),A          ;Statusanzeige "gedrueckte Taste"
  E4CA    21 B25F        C                  LD      HL,S2.IM
  E4CD    77             C                  LD      (HL),A              ;S2.IM    loeschen
  E4CE    23             C                  INC     HL
  E4CF    77             C                  LD      (HL),A              ;S2.OM    loeschen
  E4D0    23             C                  INC     HL
  E4D1    77             C                  LD      (HL),A              ;S2.VZM   loeschen
  E4D2    C9             C                  RET
  E4D3    CD D408        C      S9.TALOE:   CALL    TA.LOE
  E4D6    21 E5FA        C                  LD      HL,S9.BCTB1
  E4D9    11 B19F        C                  LD      DE,TS.TAB1
  E4DC    01 0018        C                  LD      BC,S9.BCTB2-S9.BCTB1
  E4DF    ED B0          C                  LDIR
  E4E1    21 E612        C                  LD      HL,S9.BCTB2
  E4E4    11 B1FF        C                  LD      DE,TS.TAB2
  E4E7    01 0034        C                  LD      BC,S9.TAS-S9.BCTB2
  E4EA    ED B0          C                  LDIR
  E4EC    3E FE          C                  LD      A,11111110B
  E4EE    32 B23F        C                  LD      (TS.SPMER),A
  E4F1    CD B415        C                  CALL    0B415H              ;HOME-Taste aktivieren JA/NEIN
  E4F4    C9             C                  RET
                         C                  PAGE
'Anschlussroutinen fuer  B A S I C'	MACRO-80 3.44	09-Dec-81	PAGE	1-122


                         C      
                         C      ;****************************************************************
                         C      ;*               Sprungtabelle , die in den Workspace von       *
                         C      ;*               B A S I C  eingetragen wird                    *
                         C      ;****************************************************************
  E4F5    C3 ECBD        C      S9.ATAB1:   JP      S9.USER             ;USR     -Routine
  E4F8    C3 E657        C                  JP      S9.CIN              ;Konsolen-Inputroutine
  E4FB    C3 EB43        C                  JP      S9.RIV              ;Leser   -Inputroutine
  E4FE    C3 E6A6        C                  JP      S9.CON              ;Konsolen-Outputroutine
  E501    C3 EBDE        C                  JP      S9.WRTV             ;Stanzer -Outputroutine
  E504    C3 EC30        C                  JP      S9.LISTX            ;Drucker -Outputroutine
  E507    C3 E68B        C                  JP      S9.CSTSX            ;Konsolen-Statusroutine
  E50A    AF             C                  XOR     A                   ;Konfigurationstest     IOCHK
  E50B    C9             C                  RET
  E50C    00             C                  NOP
  E50D    C3 EC51        C                  JP      S9.IOSTX            ;SWITCH  -Routine
  E510    C3 EDDE        C                  JP      S9.MEMCK            ;uebergibt Standardspeichergroesse
  E513    C3 C114        C                  JP      S1.SYSTB            ;Rueckkehr zum Betriebssystem
                         C      
                         C      
                         C      
                         C      ;****************************************************************
                         C      ;*               zusaetzlicher Verstaendigungsbereich           *
                         C      ;****************************************************************
  E516    C3 F0A0        C      S9.ATAB2:   JP      S9.ABAUP            ;B400
  E519    C3 F0DF        C                  JP      S9.RBAUP            ;B403
  E51C    C3 EECD        C                  JP      S9.OPEN             ;B406
  E51F    C3 EF6E        C                  JP      S9.CLOSE            ;B409
  E522    C3 EFE4        C                  JP      S9.READ             ;B40C
  E525    C3 F00E        C                  JP      S9.WRITE            ;B40F
  E528    C3 ECBC        C                  JP      S9.IOX              ;B412
  E52B    C9             C                  RET                         ;B415
  E52C    E53E           C                  DW      S9.HOME1            ;B416
  E52E    C3 0000        C                  JP      0                   ;B418
  E531    C3 F25F        C                  JP      S9.BLD1             ;B41B
  E534    00             C                  DB      0                   ;B41E ... Eingabekonv.(RS),wenn FFH
  E535    1E             C                  DB      01EH                ;B41F ... Eingabe-Zeilenendezeichen
  E536    00             C                  DB      0                   ;B420 ... Ausgabekonv.(RS),wenn FFH
  E537    1E             C                  DB      01EH                ;B421 ... Ausgabe-Zeilenendezeichen
  E538    C9             C                  RET                         ;B422 ... Eingabe-Kodetransformation
  E539    ECBC           C                  DW      S9.IOX
  E53B    C9             C                  RET                         ;B425 ... Ausgabe-Kodetransformation
  E53C    ECBC           C                  DW      S9.IOX
                         C      
  E53E    21 0000        C      S9.HOME1:   LD      HL,0
  E541    22 B20F        C                  LD      (TS.TAB2+16),HL
  E544    C9             C                  RET
                         C      
                         C                  TITLE   'Anfangsprogramm'
                         C                  PAGE
'Anfangsprogramm'	MACRO-80 3.44	09-Dec-81	PAGE	1-123


                         C      
  E545    2FDE           C      S9.ANFP:    DW      02FDEH              ;Adresse naechster Befehl
  E547    0001           C                  DW      1                   ;BASIC-Zeilennummer 1
  E549    99             C                  DB      99H                 ;CLEAR
  E54A    20 35 30 30    C                  DB      ' 500:'
  E54E    3A             C      
  E54F    D4             C                  DB      0D4H                ;SVC
  E550    30 2C 37 2C    C                  DB      '0,7,1,22,1,80:'
  E554    31 2C 32 32    C      
  E558    2C 31 2C 38    C      
  E55C    30 3A          C      
  E55E    D4             C                  DB      0D4H                ;SVC
  E55F    30 2C 32 3A    C                  DB      '0,2:'
  E563    D4             C                  DB      0D4H                ;SVC
  E564    30 2C 35 2C    C                  DB      '0,5,1,1'
  E568    31 2C 31       C      
  E56B    00             C                  DB      0
                         C      
  E56C    3048           C                  DW      03048H              ;Adresse naechster Befehl
  E56E    0002           C                  DW      2                   ;BASIC-Zeilennummer 2
  E570    53 59 24       C                  DB      'SY$'
  E573    AD             C                  DB      0ADH                ;=
  E574    22 6E 61 6D    C                  DB      '"name__tacomm__date__sig":ER$'
  E578    65 5F 5F 74    C      
  E57C    61 63 6F 6D    C      
  E580    6D 5F 5F 64    C      
  E584    61 74 65 5F    C      
  E588    5F 73 69 67    C      
  E58C    22 3A 45 52    C      
  E590    24             C      
  E591    AD             C                  DB      0ADH                ;=
  E592    22 31 31 2E    C                  DB      '"11...G lpoispoi":'
  E596    2E 2E 47 20    C      
  E59A    6C 70 6F 69    C      
  E59E    73 70 6F 69    C      
  E5A2    22 3A          C      
  E5A4    D4             C                  DB      0D4H                ;SVC
  E5A5    30 2C 31 39    C                  DB      '0,19:'
  E5A9    3A             C      
  E5AA    8A             C                  DB      08AH                ;IF
  E5AB    C6             C                  DB      0C6H                ;MID$
  E5AC    28 45 52 24    C                  DB      '(ER$,7,1)'
  E5B0    2C 37 2C 31    C      
  E5B4    29             C      
  E5B5    AD             C                  DB      0ADH                ;=
  E5B6    22 31 22       C                  DB      '"1"'
  E5B9    A2             C                  DB      0A2H                ;THEN
  E5BA    97             C                  DB      097H                ;?
  E5BB    22 45 20 6E    C                  DB      '"E n t l a d e n":'
  E5BF    20 74 20 6C    C      
  E5C3    20 61 20 64    C      
  E5C7    20 65 20 6E    C      
  E5CB    22 3A          C      
  E5CD    D4             C                  DB      0D4H                ;SVC
  E5CE    30 2C 32 39    C                  DB      '0,29,73'
  E5D2    2C 37 33       C      
  E5D5    00             C                  DB      0
                         C      
  E5D6    0000           C                  DW      0                   ;Endekennzeichen BASIC-Programm
                         C      
                         C      
  E5D8    21 E545        C      S9.ANFG:    LD      HL,S9.ANFP
  E5DB    11 2FB7        C                  LD      DE,02FB7H
  E5DE    01 0093        C                  LD      BC,S9.ANFG-S9.ANFP
  E5E1    ED B0          C                  LDIR
  E5E3    21 3049        C                  LD      HL,03049H
  E5E6    22 0150        C                  LD      (BC.D017),HL
  E5E9    23             C                  INC     HL
  E5EA    22 015E        C                  LD      (BC.D024),HL
  E5ED    22 0160        C                  LD      (BC.D025),HL
  E5F0    22 0162        C                  LD      (BC.D026),HL
  E5F3    C9             C                  RET
                         C      
  E5F4    CD E5D8        C      S9.ANFPG:   CALL    S9.ANFG
  E5F7    C3 04A0        C                  JP      004A0H
                         C      
                         C                  TITLE   'Tastenroutinenadressen'
                         C                  PAGE
'Tastenroutinenadressen'	MACRO-80 3.44	09-Dec-81	PAGE	1-124


                         C      
                         C      ;****************************************************************
                         C      ;*               Tastenroutinenadressen                         *
                         C      ;****************************************************************
  E5FA    E711           C      S9.BCTB1:   DW      S9.CST4             ;CNTRL-S --- P1
  E5FC    E646           C                  DW      S9.TAS              ;        --- P2
  E5FE    E715           C                  DW      S9.CST5             ;CNTRL-Q --- P3
  E600    0000           C                  DW      0
  E602    E719           C                  DW      S9.CST6             ;CNTRL-R --- P5
  E604    0000           C                  DW      0
  E606    E71D           C                  DW      S9.CST7             ;CNTRL-C --- P7
  E608    E721           C                  DW      S9.CST8             ;CNTRL-O --- P8
  E60A    E725           C                  DW      S9.CST9             ;CNTRL-T --- P9
  E60C    E75C           C                  DW      S9.FBE1             ;        --- P10
  E60E    E796           C                  DW      S9.FBE2             ;        --- P11
  E610    E7AE           C                  DW      S9.FBE3             ;        --- P12
                         C      
  E612    0000           C      S9.BCTB2:   DW      0
  E614    0000           C                  DW      0
  E616    0000           C                  DW      0
  E618    E70D           C                  DW      S9.CST3             ;CNTRL-U --- DEL LINE
  E61A    0000           C                  DW      0
  E61C    0000           C                  DW      0
  E61E    0000           C                  DW      0
  E620    E705           C                  DW      S9.CST1             ;rubout  --- <==
  E622    E745           C                  DW      S9.HOME
  E624    0000           C                  DW      0
  E626    E72D           C                  DW      S9.CST11            ;escape  --- CNZA
  E628    0000           C                  DW      0
  E62A    C334           C                  DW      S1.NN
  E62C    C345           C                  DW      S1.NNN
  E62E    0000           C                  DW      0
  E630    E709           C                  DW      S9.CST2             ;CNTRL-X --- SYS
  E632    C354           C                  DW      S1.HCOPY
  E634    0000           C                  DW      0
  E636    E729           C                  DW      S9.CST10            ;        --- POS QUIT
  E638    0000           C                  DW      0
  E63A    0000           C                  DW      0
  E63C    0000           C                  DW      0
  E63E    0000           C                  DW      0
  E640    E73B           C                  DW      S9.CSTS3            ;        --- EINA
  E642    0000           C                  DW      0
  E644    E729           C                  DW      S9.CST10            ;        --- ET1
                         C      
                         C      
  E646    3A B241        C      S9.TAS:     LD      A,(TS.KGMER)
  E649    B7             C                  OR      A
  E64A    28 03          C                  JR      Z,S9.TAS1
  E64C    AF             C                  XOR     A
  E64D    18 01          C                  JR      S9.TAS2
  E64F    3C             C      S9.TAS1:    INC     A
  E650    32 B241        C      S9.TAS2:    LD      (TS.KGMER),A
  E653    CD C67C        C                  CALL    S1.STAT
  E656    C9             C                  RET
                         C      
                         C                  TITLE   'Konsoleninput'
                         C                  PAGE
'Konsoleninput'	MACRO-80 3.44	09-Dec-81	PAGE	1-125


                         C      
                         C      ;****************************************************************
                         C      ;*               Eingabe eines Zeichens von Konsole             *
                         C      ;****************************************************************
  E657    CD EE58        C      S9.CIN:     CALL    S9.SAVE
  E65A    3A 01AB        C                  LD      A,(BC.D058)          ;AUTO aktiv ?
  E65D    B7             C                  OR      A
  E65E    28 0C          C                  JR      Z,S9.CIN2
  E660    3A B24A        C                  LD      A,(TS.BFOL1+1)      ;FBE  aktiv ?
  E663    B7             C                  OR      A
  E664    28 06          C                  JR      Z,S9.CIN2
  E666    E5             C                  PUSH    HL
  E667    E5             C                  PUSH    HL
  E668    E5             C                  PUSH    HL
  E669    C3 E75C        C                  JP      S9.FBE1
                         C      
  E66C    3A B263        C      S9.CIN2:    LD      A,(S2.CST)
  E66F    B7             C                  OR      A
  E670    20 05          C                  JR      NZ,S9.CIN1
  E672    CD E682        C                  CALL    S9.CSTS1
  E675    18 FB          C                  JR      $-3
                         C      
  E677    AF             C      S9.CIN1:    XOR     A
  E678    32 B263        C                  LD      (S2.CST),A
  E67B    CD EE78        C                  CALL    S9.LOAD
  E67E    3A B199        C                  LD      A,(MS.TK)
  E681    C9             C                  RET
                         C      
  E682    CD D237        C      S9.CSTS1:   CALL    TA.ABFR
  E685    3E FF          C                  LD      A,-1
  E687    32 B263        C                  LD      (S2.CST),A
  E68A    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*               Konsolstatus                                   *
                         C      ;****************************************************************
  E68B    CD EE58        C      S9.CSTSX:   CALL    S9.SAVE
  E68E    CD D13D        C                  CALL    TA.TA1
  E691    20 07          C                  JR      NZ,S9.CSTS4
  E693    CD E682        C                  CALL    S9.CSTS1
  E696    18 02          C                  JR      S9.CSTS4
  E698    18 04          C                  JR      S9.CSTS5
                         C      
                         C      
  E69A    AF             C      S9.CSTS4:   XOR     A
  E69B    32 B263        C                  LD      (S2.CST),A
                         C      
  E69E    CD EE78        C      S9.CSTS5:   CALL    S9.LOAD
  E6A1    3A B263        C                  LD      A,(S2.CST)
  E6A4    B7             C                  OR      A
  E6A5    C9             C                  RET
                         C      
                         C                  TITLE   'Konsolenoutput'
                         C                  PAGE
'Konsolenoutput'	MACRO-80 3.44	09-Dec-81	PAGE	1-126


                         C      
                         C      ;****************************************************************
                         C      ;*               Ausgabe eines Zeichens auf Konsole             *
                         C      ;****************************************************************
  E6A6    CD EE58        C      S9.CON:     CALL    S9.SAVE
  E6A9    3E 07          C                  LD      A,7                 ;Cursor loeschen
  E6AB    32 B198        C                  LD      (MS.CMD),A
  E6AE    CD CB10        C                  CALL    MO.MONI
  E6B1    3E 14          C                  LD      A,20                ;Zeichen auf BWS
  E6B3    32 B198        C                  LD      (MS.CMD),A
  E6B6    79             C                  LD      A,C
  E6B7    FE 0D          C                  CP      00DH
  E6B9    28 14          C                  JR      Z,S9.CON9
  E6BB    FE 0A          C                  CP      00AH
  E6BD    28 08          C                  JR      Z,S9.CON1
  E6BF    32 B199        C                  LD      (MS.TK),A
  E6C2    CD CB10        C                  CALL    MO.MONI
  E6C5    18 08          C                  JR      S9.CON9
  E6C7    3E 17          C      S9.CON1:    LD      A,23                ;naechste Bildschirmzeile Anfang
  E6C9    32 B198        C                  LD      (MS.CMD),A
  E6CC    CD CB10        C                  CALL    MO.MONI
  E6CF    3E 06          C      S9.CON9:    LD      A,6                 ;Cursor setzen
  E6D1    32 B198        C                  LD      (MS.CMD),A
  E6D4    CD CB10        C                  CALL    MO.MONI
  E6D7    18 29          C                  JR      S9.CON09
                         C      
                         C      
                         C      
  E6D9    CD EE58        C      S9.CONOC:   CALL    S9.SAVE             ;Konsolenausgabe ohne Cursorberuecks.
  E6DC    3E 14          C                  LD      A,20                ;Zeichen auf BWS
  E6DE    32 B198        C                  LD      (MS.CMD),A
  E6E1    79             C                  LD      A,C
  E6E2    FE 0D          C                  CP      00DH
  E6E4    28 1C          C                  JR      Z,S9.CON09
  E6E6    FE 0A          C                  CP      00AH
  E6E8    28 08          C                  JR      Z,S9.CON01
  E6EA    32 B199        C                  LD      (MS.TK),A
  E6ED    CD CB10        C                  CALL    MO.MONI
  E6F0    18 10          C                  JR      S9.CON09
  E6F2    3E 07          C      S9.CON01:   LD      A,7
  E6F4    32 B198        C                  LD      (MS.CMD),A
  E6F7    CD CB10        C                  CALL    MO.MONI
  E6FA    3E 17          C                  LD      A,23                ;naechste Bildschirmzeile Anfang
  E6FC    32 B198        C                  LD      (MS.CMD),A
  E6FF    CD CB10        C                  CALL    MO.MONI
  E702    C3 ECB9        C      S9.CON09:   JP      S9.IOXE
                         C      
                         C                  TITLE   'Tastenroutinen'
                         C                  PAGE
'Tastenroutinen'	MACRO-80 3.44	09-Dec-81	PAGE	1-127


                         C      
                         C      ;****************************************************************
                         C      ;*            Kodeersetzungsroutinen                            *
                         C      ;****************************************************************
  E705    3E 7F          C      S9.CST1:    LD      A,07FH              ; <==
  E707    18 26          C                  JR      S9.CSTS2
                         C      
  E709    3E 18          C      S9.CST2:    LD      A,018H              ; SYS
  E70B    18 22          C                  JR      S9.CSTS2
                         C      
  E70D    3E 15          C      S9.CST3:    LD      A,015H              ; DEL LINE
  E70F    18 1E          C                  JR      S9.CSTS2
                         C      
  E711    3E 13          C      S9.CST4:    LD      A,013H              ; P01
  E713    18 1A          C                  JR      S9.CSTS2
                         C      
  E715    3E 11          C      S9.CST5:    LD      A,011H              ; P03
  E717    18 16          C                  JR      S9.CSTS2
                         C      
  E719    3E 12          C      S9.CST6:    LD      A,012H              ; P05
  E71B    18 12          C                  JR      S9.CSTS2
                         C      
  E71D    3E 03          C      S9.CST7:    LD      A,003H              ; P07
  E71F    18 0E          C                  JR      S9.CSTS2
                         C      
  E721    3E 0F          C      S9.CST8:    LD      A,00FH              ; P08
  E723    18 0A          C                  JR      S9.CSTS2
                         C      
  E725    3E 14          C      S9.CST9:    LD      A,014H              ; P09
  E727    18 06          C                  JR      S9.CSTS2
                         C      
  E729    3E 0D          C      S9.CST10:   LD      A,00DH              ; new line
  E72B    18 02          C                  JR      S9.CSTS2
                         C      
  E72D    3E 1B          C      S9.CST11:   LD      A,01BH              ; naechste Zeile Anfang
                         C      
  E72F    32 B199        C      S9.CSTS2:   LD      (MS.TK),A
  E732    D1             C                  POP     DE
  E733    C1             C                  POP     BC
  E734    E1             C                  POP     HL
  E735    23             C                  INC     HL
  E736    23             C                  INC     HL
  E737    E5             C                  PUSH    HL
  E738    C5             C                  PUSH    BC
  E739    D5             C                  PUSH    DE
  E73A    C9             C                  RET
                         C      
  E73B    32 B199        C      S9.CSTS3:   LD      (MS.TK),A           ;Routine  E I N A  mit Schnellschreiben
  E73E    3E 01          C                  LD      A,1
  E740    32 B242        C                  LD      (TS.ZSMER),A
  E743    18 ED          C                  JR      S9.CSTS2+3
                         C      
  E745    3E 02          C      S9.HOME:    LD      A,2                 ;Bildfenster def. ZANZ-2 , SPANZ
  E747    32 B198        C                  LD      (MS.CMD),A
  E74A    CD CB10        C                  CALL    MO.MONI
  E74D    3E 05          C                  LD      A,5                 ;Bildfenster loeschen
  E74F    32 B198        C                  LD      (MS.CMD),A
  E752    CD CB10        C                  CALL    MO.MONI
  E755    21 0000        C                  LD      HL,0                ;ZPOS= 1 , SPOS= 1
  E758    22 B18C        C                  LD      (MS.ZPOS),HL
  E75B    C9             C                  RET
                         C                  TITLE   'Freie Bildschirmeingabe'
                         C                  PAGE
'Freie Bildschirmeingabe'	MACRO-80 3.44	09-Dec-81	PAGE	1-128


                         C      
                         C      ;****************************************************************
                         C      ;*               freie Bildschirmeingabe                        *
                         C      ;****************************************************************
  E75C    3A 01AB        C      S9.FBE1:    LD      A,(BC.D058)         ;P-Taste   P10
  E75F    B7             C                  OR      A                   ;AUTO aktiv ?
  E760    28 24          C                  JR      Z,S9.FB1
                         C      
  E762    3E 07          C                  LD      A,7                 ;ja ... Cursor loeschen
  E764    32 B198        C                  LD      (MS.CMD),A
  E767    CD C024        C                  CALL    S1.MO
  E76A    21 B24A        C                  LD      HL,TS.BFOL1+1
  E76D    3E 01          C                  LD      A,1
  E76F    BE             C                  CP      (HL)                ;FBE schon aktiv ?
  E770    28 14          C                  JR      Z,S9.FB1
                         C      
  E772    77             C                  LD      (HL),A              ;nein, aktivieren
  E773    21 0105        C                  LD      HL,00105H           ;ZMIN = 5 , SMIN = 1
  E776    22 B18E        C                  LD      (MS.ZMIN),HL
  E779    25             C                  DEC     H                   ;ZPOS = 5 , SPOS = 1
  E77A    2D             C                  DEC     L
  E77B    22 B18C        C                  LD      (MS.ZPOS),HL
  E77E    3E 05          C                  LD      A,5                 ;Bildfenster loeschen
  E780    32 B198        C                  LD      (MS.CMD),A
  E783    CD C024        C                  CALL    S1.MO
                         C      
                         C      
  E786    CD E7BC        C      S9.FB1:     CALL    S9.FBE
  E789    CD E869        C                  CALL    S9.DEL              ;Eingabebereich auf blank loeschen
  E78C    3E 06          C                  LD      A,6                 ;Cursor setzen
  E78E    32 B198        C                  LD      (MS.CMD),A
  E791    CD C024        C                  CALL    S1.MO
  E794    18 1B          C                  JR      S9.FBE13
                         C      
  E796    CD E7BC        C      S9.FBE2:    CALL    S9.FBE              ;P-Taste   P11
  E799    11 E803        C                  LD      DE,S9.POSQ1         ;Bereitstellen anderer BWS-Zeilen
  E79C    21 0115        C                  LD      HL,00115H
  E79F    22 B190        C      S9.FBE12:   LD      (MS.ZMAX),HL
  E7A2    EB             C                  EX      DE,HL               ;POS_QUIT
  E7A3    22 B223        C                  LD      (TS.TAB4),HL
                         C      
  E7A6    CD C021        C                  CALL    S1.TA+15            ;TA.TFE
  E7A9    CD C01E        C                  CALL    S1.TA+12            ;Tastatur - Abfrageschleife
  E7AC    18 FB          C                  JR      $-3
                         C      
  E7AE    CD E7BC        C      S9.FBE3:    CALL    S9.FBE              ;P-Taste   P12
  E7B1    CD E818        C      S9.FBE13:   CALL    S9.PQ2TL
  E7B4    11 EA80        C                  LD      DE,S9.POSQ2
  E7B7    21 5004        C                  LD      HL,05004H
  E7BA    18 E3          C                  JR      S9.FBE12
                         C      
                         C                  PAGE
'Freie Bildschirmeingabe'	MACRO-80 3.44	09-Dec-81	PAGE	1-129


                         C      
  E7BC    CD F5FB        C      S9.FBE:     CALL    S0.BWSZU            ;BWS zuschalten
  E7BF    21 0000        C                  LD      HL,0                ;Routine BWSAB := Routine BWSZU
  E7C2    22 B2D4        C                  LD      (S2.STACK),HL
  E7C5    21 B18A        C                  LD      HL,MS.ZPOL          ;Monitorsteuervektor retten
  E7C8    11 3780        C                  LD      DE,S0.BWS+1920
  E7CB    01 0015        C                  LD      BC,TS.TAB1-MS.ZPOL
  E7CE    ED B0          C                  LDIR
  E7D0    21 0000        C      S9.FBE0:    LD      HL,0                ;Monitorsteuervektor neu belegen
  E7D3    22 B18C        C                  LD      (MS.ZPOS),HL
  E7D6    24             C                  INC     H
  E7D7    2C             C                  INC     L
  E7D8    22 B18E        C                  LD      (MS.ZMIN),HL
  E7DB    3E C8          C                  LD      A,11001000B
  E7DD    32 B197        C                  LD      (MS.DIRES),A
  E7E0    21 3000        C                  LD      HL,S0.BWS
  E7E3    22 B194        C                  LD      (MS.BWSA),HL
  E7E6    CD C01B        C                  CALL    S1.TA+9             ;Tastaturaktivierung
  E7E9    21 0000        C                  LD      HL,0                ;SYS-Taste loeschen
  E7EC    22 B21D        C                  LD      (TS.TAB3+6),HL
  E7EF    21 EAE3        C                  LD      HL,S9.NEGQ          ;NEG_QUIT
  E7F2    22 B21B        C                  LD      (TS.TAB3+4),HL
  E7F5    3E FF          C                  LD      A,-1
  E7F7    32 B23F        C                  LD      (TS.SPMER),A
  E7FA    3E 06          C                  LD      A,6                 ;Cursor setzen
  E7FC    32 B198        C                  LD      (MS.CMD),A
  E7FF    CD C024        C                  CALL    S1.MO
  E802    C9             C                  RET
                         C      
                         C                  PAGE
'Freie Bildschirmeingabe'	MACRO-80 3.44	09-Dec-81	PAGE	1-130


                         C      
  E803    CD E9A0        C      S9.POSQ1:   CALL    S9.UP1              ;zu korrigierende Zeilen im
  E806    EB             C                  EX      DE,HL               ;Eingabebereich bereitstellen
  E807    11 3000        C                  LD      DE,S0.BWS
  E80A    01 0140        C                  LD      BC,320
  E80D    ED B0          C                  LDIR
  E80F    21 5004        C                  LD      HL,05004H
  E812    22 B190        C                  LD      (MS.ZMAX),HL
  E815    CD E7D0        C                  CALL    S9.FBE0
                         C      
  E818    21 E9AA        C      S9.PQ2TL:   LD      HL,S9.TPF1
  E81B    11 B19F        C                  LD      DE,TS.TAB1
  E81E    01 0018        C                  LD      BC,S9.TX1-S9.TPF1
  E821    ED B0          C                  LDIR
  E823    21 EA80        C                  LD      HL,S9.POSQ2
  E826    22 B223        C                  LD      (TS.TAB4),HL
  E829    21 E847        C                  LD      HL,S9.INSM
  E82C    22 B1FF        C                  LD      (TS.TAB2),HL
  E82F    21 E869        C                  LD      HL,S9.DEL
  E832    22 B201        C                  LD      (TS.TAB2+2),HL
  E835    21 E885        C                  LD      HL,S9.SCHL
  E838    22 B207        C                  LD      (TS.TAB2+8),HL
  E83B    21 E8A0        C                  LD      HL,S9.SCHR
  E83E    22 B20B        C                  LD      (TS.TAB2+12),HL
  E841    21 C328        C                  LD      HL,S1.AEIN
  E844    22 B231        C                  LD      (TS.NEWL),HL
  E847    3A B240        C      S9.INSM:    LD      A,(TS.UMERK)
  E84A    B7             C                  OR      A
  E84B    20 05          C                  JR      NZ,S9.TL1
  E84D    21 E859        C                  LD      HL,S9.EIN1
  E850    18 03          C                  JR      S9.TL2
  E852    21 E862        C      S9.TL1:     LD      HL,S9.EIN2
  E855    22 B22D        C      S9.TL2:     LD      (TS.EINA),HL
  E858    C9             C                  RET
                         C      
  E859    CD C328        C      S9.EIN1:    CALL    S1.AEIN
  E85C    3E 01          C      S9.ZS:      LD      A,1
  E85E    32 B242        C                  LD      (TS.ZSMER),A
  E861    C9             C                  RET
                         C      
  E862    F5             C      S9.EIN2:    PUSH    AF
  E863    CD E8A0        C                  CALL    S9.SCHR
  E866    F1             C                  POP     AF
  E867    18 F0          C                  JR      S9.EIN1
                         C      
                         C                  PAGE
'Freie Bildschirmeingabe'	MACRO-80 3.44	09-Dec-81	PAGE	1-131


                         C      
  E869    21 3000        C      S9.DEL:     LD      HL,S0.BWS
  E86C    11 3001        C                  LD      DE,S0.BWS+1
  E86F    01 00FE        C                  LD      BC,254
  E872    36 20          C                  LD      (HL),' '
  E874    ED B0          C                  LDIR
  E876    EB             C                  EX      DE,HL
  E877    36 7C          C                  LD      (HL),'|'
  E879    23             C                  INC     HL
  E87A    36 3D          C                  LD      (HL),'='
  E87C    E5             C                  PUSH    HL
  E87D    D1             C                  POP     DE
  E87E    13             C                  INC     DE
  E87F    01 003F        C                  LD      BC,63
  E882    ED B0          C                  LDIR
  E884    C9             C                  RET
                         C      
  E885    CD E9A0        C      S9.SCHL:    CALL    S9.UP1
  E888    21 30FD        C                  LD      HL,S0.BWS+253
  E88B    B7             C                  OR      A
  E88C    ED 52          C                  SBC     HL,DE
  E88E    C8             C                  RET     Z
  E88F    E5             C                  PUSH    HL
  E890    C1             C                  POP     BC
  E891    CD E9A0        C                  CALL    S9.UP1
  E894    D5             C                  PUSH    DE
  E895    E1             C                  POP     HL
  E896    23             C                  INC     HL
  E897    ED B0          C                  LDIR
  E899    3E 20          C                  LD      A,' '
  E89B    32 30FE        C                  LD      (S0.BWS+254),A
  E89E    18 BC          C      S9.ZS1:     JR      S9.ZS
                         C      
  E8A0    CD E9A0        C      S9.SCHR:    CALL    S9.UP1
  E8A3    21 30FE        C                  LD      HL,S0.BWS+254
  E8A6    B7             C                  OR      A
  E8A7    ED 52          C                  SBC     HL,DE
  E8A9    C8             C                  RET     Z
  E8AA    E5             C                  PUSH    HL
  E8AB    C1             C                  POP     BC
  E8AC    21 30FD        C                  LD      HL,S0.BWS+253
  E8AF    11 30FE        C                  LD      DE,S0.BWS+254
  E8B2    ED B8          C                  LDDR
  E8B4    CD E9A0        C                  CALL    S9.UP1
  E8B7    EB             C                  EX      DE,HL
  E8B8    36 20          C                  LD      (HL),' '
  E8BA    18 E2          C                  JR      S9.ZS1
                         C      
                         C                  PAGE
'Freie Bildschirmeingabe'	MACRO-80 3.44	09-Dec-81	PAGE	1-132


                         C      
  E8BC    CD E9A0        C      S9.PF1:     CALL    S9.UP1              ;SY$="...":ER$="..."
  E8BF    21 E9C2        C                  LD      HL,S9.TX1
  E8C2    01 0034        C                  LD      BC,S9.TX2-S9.TX1
  E8C5    ED B0          C                  LDIR
  E8C7    EB             C      S9.PF101:   EX      DE,HL
  E8C8    3E 0A          C                  LD      A,10
  E8CA    32 B198        C                  LD      (MS.CMD),A
  E8CD    CD C024        C                  CALL    S1.MO
  E8D0    C9             C                  RET
                         C      
  E8D1    CD E9A0        C      S9.PF2:     CALL    S9.UP1              ;NEW.1_
  E8D4    21 EA52        C                  LD      HL,S9.TXT16
  E8D7    01 0006        C                  LD      BC,S9.TXT17-S9.TXT16
  E8DA    ED B0          C                  LDIR
  E8DC    18 E9          C      S9.PF102:   JR      S9.PF101
                         C      
  E8DE    CD E9A0        C      S9.PF3:     CALL    S9.UP1              ;RUN
  E8E1    21 EA4E        C                  LD      HL,S9.TXT15
  E8E4    01 0004        C                  LD      BC,S9.TXT16-S9.TXT15
  E8E7    ED B0          C                  LDIR
  E8E9    18 F1          C      S9.PF103:   JR      S9.PF102
                         C      
  E8EB    CD E9A0        C      S9.PF4:     CALL    S9.UP1              ;OPEN MRES INPUT
  E8EE    21 E9F6        C                  LD      HL,S9.TX2
  E8F1    01 0010        C                  LD      BC,S9.TXT3-S9.TX2
  E8F4    ED B0          C                  LDIR
  E8F6    21 EA16        C                  LD      HL,S9.TXT4
  E8F9    01 0005        C                  LD      BC,S9.TXT5-S9.TXT4
  E8FC    ED B0          C                  LDIR
  E8FE    21 EA1B        C                  LD      HL,S9.TXT5
  E901    01 0005        C                  LD      BC,S9.TXT6-S9.TXT5
  E904    ED B0          C                  LDIR
  E906    18 E1          C      S9.PF104:   JR      S9.PF103
                         C      
  E908    CD E9A0        C      S9.PF5:     CALL    S9.UP1              ;OPEN MRES OUTPUT
  E90B    21 E9F6        C                  LD      HL,S9.TX2
  E90E    01 0010        C                  LD      BC,S9.TXT3-S9.TX2
  E911    ED B0          C                  LDIR
  E913    21 EA16        C                  LD      HL,S9.TXT4
  E916    01 0005        C                  LD      BC,S9.TXT5-S9.TXT4
  E919    ED B0          C                  LDIR
  E91B    21 EA20        C                  LD      HL,S9.TXT6
  E91E    01 0005        C                  LD      BC,S9.TXT7-S9.TXT6
  E921    ED B0          C                  LDIR
  E923    18 E1          C      S9.PF105:   JR      S9.PF104
                         C      
  E925    CD E9A0        C      S9.PF6:     CALL    S9.UP1              ;CLOSE MRES OUTPUT
  E928    21 EA16        C                  LD      HL,S9.TXT4
  E92B    01 0005        C                  LD      BC,S9.TXT5-S9.TXT4
  E92E    ED B0          C                  LDIR
  E930    21 EA25        C                  LD      HL,S9.TXT7
  E933    01 0003        C                  LD      BC,S9.TXT8-S9.TXT7
  E936    ED B0          C                  LDIR
  E938    18 E9          C      S9.PF106:   JR      S9.PF105
                         C      
  E93A    CD E9A0        C      S9.PF7:     CALL    S9.UP1              ;OPEN INPUT
  E93D    21 E9F6        C                  LD      HL,S9.TX2
  E940    01 0025        C                  LD      BC,S9.TXT5-S9.TX2
  E943    ED B0          C                  LDIR
  E945    21 EA28        C                  LD      HL,S9.TXT8
  E948    01 000A        C                  LD      BC,S9.TXT10-S9.TXT8
  E94B    ED B0          C                  LDIR
  E94D    18 E9          C      S9.PF107:   JR      S9.PF106
                         C      
  E94F    CD E9A0        C      S9.PF8:     CALL    S9.UP1              ;OPEN OUTPUT
  E952    21 E9F6        C                  LD      HL,S9.TX2
  E955    01 0025        C                  LD      BC,S9.TXT5-S9.TX2
  E958    ED B0          C                  LDIR
  E95A    21 EA28        C                  LD      HL,S9.TXT8
  E95D    01 0006        C                  LD      BC,S9.TXT9-S9.TXT8
  E960    ED B0          C                  LDIR
  E962    21 EA32        C                  LD      HL,S9.TXT10
  E965    01 0004        C                  LD      BC,S9.TXT11-S9.TXT10
  E968    ED B0          C                  LDIR
  E96A    18 E1          C      S9.PF108:   JR      S9.PF107
                         C      
  E96C    CD E9A0        C      S9.PF9:     CALL    S9.UP1              ;.SVC0,2:SVC0,5,1,1:LIST
  E96F    21 EA58        C                  LD      HL,S9.TXT17
  E972    01 0028        C                  LD      BC,S9.TXT18-S9.TXT17
  E975    ED B0          C                  LDIR
  E977    18 F1          C      S9.PF109:   JR      S9.PF108
'Freie Bildschirmeingabe'	MACRO-80 3.44	09-Dec-81	PAGE	1-133


                         C      
  E979    CD E9A0        C      S9.PF10:    CALL    S9.UP1              ;LOADA
  E97C    21 EA3A        C                  LD      HL,S9.TXT12
  E97F    01 0006        C                  LD      BC,S9.TXT13-S9.TXT12
  E982    ED B0          C                  LDIR
  E984    18 F1          C      S9.PF110:   JR      S9.PF109
                         C      
  E986    CD E9A0        C      S9.PF11:    CALL    S9.UP1              ;LOADGOA
  E989    21 EA40        C                  LD      HL,S9.TXT13
  E98C    01 0008        C                  LD      BC,S9.TXT14-S9.TXT13
  E98F    ED B0          C                  LDIR
  E991    18 F1          C      S9.PF111:   JR      S9.PF110
                         C      
  E993    CD E9A0        C      S9.PF12:    CALL    S9.UP1              ;SAVEA
  E996    21 EA48        C                  LD      HL,S9.TXT14
  E999    01 0006        C                  LD      BC,S9.TXT15-S9.TXT14
  E99C    ED B0          C                  LDIR
  E99E    18 F1          C      S9.PF112:   JR      S9.PF111
                         C      
                         C                  PAGE
'Freie Bildschirmeingabe'	MACRO-80 3.44	09-Dec-81	PAGE	1-134


                         C      
  E9A0    3E 0B          C      S9.UP1:     LD      A,11
  E9A2    32 B198        C                  LD      (MS.CMD),A
  E9A5    CD C024        C                  CALL    S1.MO
  E9A8    EB             C                  EX      DE,HL
  E9A9    C9             C                  RET
                         C      
  E9AA    E8BC           C      S9.TPF1:    DW      S9.PF1
  E9AC    E8D1           C                  DW      S9.PF2
  E9AE    E8DE           C                  DW      S9.PF3
  E9B0    E8EB           C                  DW      S9.PF4
  E9B2    E908           C                  DW      S9.PF5
  E9B4    E925           C                  DW      S9.PF6
  E9B6    E93A           C                  DW      S9.PF7
  E9B8    E94F           C                  DW      S9.PF8
  E9BA    E96C           C                  DW      S9.PF9
  E9BC    E979           C                  DW      S9.PF10
  E9BE    E986           C                  DW      S9.PF11
  E9C0    E993           C                  DW      S9.PF12
                         C      
  E9C2    53 59 24 3D    C      S9.TX1:     DB      'SY$="INHALTBL               ":ER$="11   G C010C010":'
  E9C6    22 49 4E 48    C      
  E9CA    41 4C 54 42    C      
  E9CE    4C 20 20 20    C      
  E9D2    20 20 20 20    C      
  E9D6    20 20 20 20    C      
  E9DA    20 20 20 20    C      
  E9DE    22 3A 45 52    C      
  E9E2    24 3D 22 31    C      
  E9E6    31 20 20 20    C      
  E9EA    47 20 43 30    C      
  E9EE    31 30 43 30    C      
  E9F2    31 30 22 3A    C      
  E9F6    49 4E 50 55    C      S9.TX2:     DB      'INPUT"Geraet";G:'
  E9FA    54 22 47 65    C      
  E9FE    72 61 65 74    C      
  EA02    22 3B 47 3A    C      
  EA06    49 4E 50 55    C      S9.TXT3:    DB      'INPUT"Label ";L:'
  EA0A    54 22 4C 61    C      
  EA0E    62 65 6C 20    C      
  EA12    22 3B 4C 3A    C      
  EA16    53 56 43 30    C      S9.TXT4:    DB      'SVC0,'
  EA1A    2C             C      
  EA1B    32 32 2C 47    C      S9.TXT5:    DB      '22,G:'
  EA1F    3A             C      
  EA20    32 33 2C 47    C      S9.TXT6:    DB      '23,G:'
  EA24    3A             C      
  EA25    33 31 3A       C      S9.TXT7:    DB      '31:'
  EA28    32 30 2C 47    C      S9.TXT8:    DB      '20,G,7'
  EA2C    2C 37          C      
  EA2E    33 2C 4C 3A    C      S9.TXT9:    DB      '3,L:'
  EA32    39 2C 4C 3A    C      S9.TXT10:   DB      '9,L:'
  EA36    32 39 2C 37    C      S9.TXT11:   DB      '29,7'
  EA3A    4C 4F 41 44    C      S9.TXT12:   DB      'LOADA:'
  EA3E    41 3A          C      
  EA40    4C 4F 41 44    C      S9.TXT13:   DB      'LOADGOA:'
  EA44    47 4F 41 3A    C      
  EA48    53 41 56 45    C      S9.TXT14:   DB      'SAVEA:'
  EA4C    41 3A          C      
  EA4E    1E             C      S9.TXT15:   DB      01EH
  EA4F    52 55 4E       C                  DB      'RUN'
  EA52    4E 45 57       C      S9.TXT16:   DB      'NEW'
  EA55    1E             C                  DB      01EH
  EA56    31 20          C                  DB      '1 '
  EA58    1E             C      S9.TXT17:   DB      01EH
  EA59    53 56 43 30    C                  DB      'SVC0,7,1,22,1,80:SVC0,2:SVC0,5,1,1:LIST'
  EA5D    2C 37 2C 31    C      
  EA61    2C 32 32 2C    C      
  EA65    31 2C 38 30    C      
  EA69    3A 53 56 43    C      
  EA6D    30 2C 32 3A    C      
  EA71    53 56 43 30    C      
  EA75    2C 35 2C 31    C      
  EA79    2C 31 3A 4C    C      
  EA7D    49 53 54       C      
  EA80                   C      S9.TXT18    EQU     $
                         C      
                         C                  PAGE
'Freie Bildschirmeingabe'	MACRO-80 3.44	09-Dec-81	PAGE	1-135


                         C      
                         C      ;****************************************************************
                         C      ;*               Tastenroutine      P O S _ Q U I T             *
                         C      ;****************************************************************
  EA80    21 A000        C      S9.POSQ2:   LD      HL,S0.BWSA          ;BWSA  <===>  BWS   4 Zeilen
  EA83    11 3000        C                  LD      DE,S0.BWS
  EA86    01 0140        C                  LD      BC,320
  EA89    C5             C      S9.POS1:    PUSH    BC
  EA8A    46             C                  LD      B,(HL)
  EA8B    EB             C                  EX      DE,HL
  EA8C    4E             C                  LD      C,(HL)
  EA8D    70             C                  LD      (HL),B
  EA8E    EB             C                  EX      DE,HL
  EA8F    71             C                  LD      (HL),C
  EA90    23             C                  INC     HL
  EA91    13             C                  INC     DE
  EA92    C1             C                  POP     BC
  EA93    0B             C                  DEC     BC
  EA94    78             C                  LD      A,B
  EA95    B1             C                  OR      C
  EA96    20 F1          C                  JR      NZ,S9.POS1
                         C      
  EA98    CD F5FF        C                  CALL    S0.BWSAB
  EA9B    AF             C                  XOR     A                   ;CSTSX - Routine ausschalten
  EA9C    21 C9AF        C                  LD      HL,0C9AFH           ;???
  EA9F    32 0318        C                  LD      (BC.CSTSX),A
  EAA2    22 0319        C                  LD      (BC.CSTSX+1),HL
  EAA5    3D             C                  DEC     A
  EAA6    32 B247        C                  LD      (TS.MIO),A
  EAA9    21 EB0F        C                  LD      HL,S9.CCIN          ;CIN   - Routine umschalten
  EAAC    22 030A        C                  LD      (BC.CIN+1),HL
  EAAF    3A 01AB        C                  LD      A,(BC.D058)         ;AUTO aktiv ?
  EAB2    B7             C                  OR      A
  EAB3    28 06          C                  JR      Z,S9.POS4
  EAB5    3A B24A        C                  LD      A,(TS.BFOL1+1)      ;FBE bei AUTO aktiv ?
  EAB8    B7             C                  OR      A
  EAB9    20 06          C                  JR      NZ,S9.POS5
  EABB    21 ECBC        C      S9.POS4:    LD      HL,S9.IOX           ;CON   - Routine ausschalten
  EABE    22 0310        C                  LD      (BC.CON+1),HL
  EAC1    21 A000        C      S9.POS5:    LD      HL,S0.BWSA          ;MIO             einschalten
  EAC4    22 B24B        C                  LD      (TS.BFOL2),HL
  EAC7    01 00FE        C                  LD      BC,254
  EACA    09             C                  ADD     HL,BC
  EACB    3E 20          C                  LD      A,' '
  EACD    0C             C                  INC     C
  EACE    BE             C      S9.POS2:    CP      (HL)
  EACF    20 08          C                  JR      NZ,S9.POS3
  EAD1    2B             C                  DEC     HL
  EAD2    0D             C                  DEC     C
  EAD3    20 F9          C                  JR      NZ,S9.POS2
  EAD5    AF             C                  XOR     A                   ;FBE bei AUTO entaktivieren
  EAD6    32 B24A        C                  LD      (TS.BFOL1+1),A
  EAD9    79             C      S9.POS3:    LD      A,C
  EADA    3C             C                  INC     A
  EADB    32 B249        C                  LD      (TS.BFOL1),A
  EADE    CD F5FB        C                  CALL    S0.BWSZU
  EAE1    18 0B          C                  JR      S9.NEG1
                         C      
                         C                  PAGE
'Freie Bildschirmeingabe'	MACRO-80 3.44	09-Dec-81	PAGE	1-136


                         C      
                         C      ;****************************************************************
                         C      ;*               Tastenroutine      N E G _ Q U I T             *
                         C      ;****************************************************************
  EAE3    21 A000        C      S9.NEGQ:    LD      HL,S0.BWSA          ;BWS  wiederherstellen
  EAE6    11 3000        C                  LD      DE,S0.BWS
  EAE9    01 0140        C                  LD      BC,320
  EAEC    ED B0          C                  LDIR
  EAEE    21 3780        C      S9.NEG1:    LD      HL,S0.BWS+1920      ;Monitorsteuervektor wiederherstellen
  EAF1    11 B18A        C                  LD      DE,MS.ZPOL
  EAF4    01 0015        C                  LD      BC,TS.TAB1-MS.ZPOL
  EAF7    ED B0          C                  LDIR
  EAF9    2A F5F9        C                  LD      HL,(S0.BWSB)        ;Routine BWSAB aktivieren
  EAFC    22 B2D4        C                  LD      (S2.STACK),HL
  EAFF    CD B2D4        C                  CALL    S2.STACK
  EB02    CD E4D3        C                  CALL    S9.TALOE
  EB05    E1             C                  POP     HL
  EB06    E1             C                  POP     HL
                         C      
  EB07    E1             C                  POP     HL
  EB08    E1             C                  POP     HL
  EB09    E1             C                  POP     HL
  EB0A    3E FF          C                  LD      A,-1
  EB0C    C3 E69A        C                  JP      S9.CSTS4
                         C      ;****************************************************************
                         C      ;*               C I N       - Routine                          *
                         C      ;****************************************************************
  EB0F    CD EE58        C      S9.CCIN:    CALL    S9.SAVE
                         C      
  EB12    CD E682        C                  CALL    S9.CSTS1
  EB15    18 FB          C                  JR      $-3
                         C      
  EB17    21 B249        C      S9.CCIN1:   LD      HL,TS.BFOL1
  EB1A    35             C                  DEC     (HL)
  EB1B    20 23          C                  JR      NZ,S9.CCIN2
                         C      
  EB1D    CD F5E9        C                  CALL    S0.BWSU1
  EB20    3E C3          C                  LD      A,0C3H              ;CSTSX - Routine einschalten
  EB22    21 E68B        C                  LD      HL,S9.CSTSX
  EB25    32 0318        C                  LD      (BC.CSTSX),A
  EB28    22 0319        C                  LD      (BC.CSTSX+1),HL
  EB2B    21 E657        C                  LD      HL,S9.CIN           ;CIN   - Routine umschalten
  EB2E    22 030A        C                  LD      (BC.CIN+1),HL
  EB31    21 E6A6        C                  LD      HL,S9.CON           ;CON   - Routine einschalten
  EB34    22 0310        C                  LD      (BC.CON+1),HL
  EB37    AF             C                  XOR     A                   ;MIO             ausschalten
  EB38    32 B247        C                  LD      (TS.MIO),A
  EB3B    3E 0D          C                  LD      A,00DH
  EB3D    32 B199        C                  LD      (MS.TK),A
                         C      
  EB40    C3 E677        C      S9.CCIN2:   JP      S9.CIN1
                         C      
                         C                  TITLE   'Eingabe eines Zeichens'
                         C                  PAGE
'Eingabe eines Zeichens'	MACRO-80 3.44	09-Dec-81	PAGE	1-137


                         C      
                         C      ;****************************************************************
                         C      ;*               Eingabe eines Zeichens                         *
                         C      ;****************************************************************
  EB43    CD EE58        C      S9.RIV:     CALL    S9.SAVE
  EB46    3A B25F        C                  LD      A,(S2.IM)
  EB49    B7             C                  OR      A
  EB4A    20 09          C                  JR      NZ,S9.RIV2
  EB4C    21 EBB8        C      S9.RIVF:    LD      HL,S9.TXT1          ;Fehleranzeige
  EB4F    11 E402        C      S9.RIV1:    LD      DE,S9.BSCR
  EB52    C3 C4F4        C                  JP      S1.FEHR
                         C      
  EB55    CD F021        C      S9.RIV2:    CALL    S9.RGLI
  EB58    CD EB81        C      S9.RIV4:    CALL    S9.LESV
  EB5B    CD B422        C                  CALL    0B422H              ;Eingabe-Kodetransformation
  EB5E    4F             C                  LD      C,A
  EB5F    21 B41E        C                  LD      HL,0B41EH
  EB62    7E             C                  LD      A,(HL)
  EB63    B7             C                  OR      A
  EB64    79             C                  LD      A,C
  EB65    28 10          C                  JR      Z,S9.RIV6
  EB67    23             C                  INC     HL
  EB68    BE             C                  CP      (HL)
  EB69    20 04          C                  JR      NZ,S9.RIV5
  EB6B    3E 0D          C                  LD      A,00DH
  EB6D    18 08          C                  JR      S9.RIV6
  EB6F    FE 20          C      S9.RIV5:    CP      ' '
  EB71    38 E5          C                  JR      C,S9.RIV4
  EB73    FE 7F          C                  CP      07FH
  EB75    30 E1          C                  JR      NC,S9.RIV4
  EB77    32 B23C        C      S9.RIV6:    LD      (TS.TK),A
  EB7A    CD EE78        C      S9.RIV9:    CALL    S9.LOAD
  EB7D    3A B23C        C                  LD      A,(TS.TK)
  EB80    C9             C                  RET
                         C      
                         C                  PAGE
'Eingabe eines Zeichens'	MACRO-80 3.44	09-Dec-81	PAGE	1-138


                         C      
  EB81    CD D5CE        C      S9.LESV:    CALL    K1.BM
  EB84    28 04          C                  JR      Z,S9.BM2
  EB86    CD DB51        C      S9.BM1:     CALL    K1.LESV
  EB89    C9             C                  RET
                         C      
  EB8A    21 BBDF        C      S9.BM2:     LD      HL,S0.PFFI+400H-1
  EB8D    ED 5B B259     C                  LD      DE,(S2.POIE)
  EB91    B7             C                  OR      A
  EB92    ED 52          C                  SBC     HL,DE
  EB94    28 06          C                  JR      Z,S9.BM3
  EB96    F2 EB86        C                  JP      P,S9.BM1
  EB99    3E 0D          C                  LD      A,00DH              ;Pufferende ueberschritten
  EB9B    C9             C                  RET
                         C      
  EB9C    CD D780        C      S9.BM3:     CALL    K1.GNRM             ;letztes Byte der Datei erreicht
  EB9F    CD D6B1        C                  CALL    K1.GNSTS
  EBA2    3E 32          C                  LD      A,'2'               ;Byte 7 der Variablen ER$  =  2
  EBA4    CD EE49        C                  CALL    S9.ERS
  EBA7    21 BBE1        C      S9.BM4:     LD      HL,S0.PFFI+401H     ;Pointer hinter Puffer setzen
  EBAA    22 B259        C                  LD      (S2.POIE),HL
  EBAD    AF             C                  XOR     A                   ;Satzlaenge in E/A-Tabelle := 0
  EBAE    DD 77 09       C                  LD      (IX+9),A
  EBB1    DD 77 0A       C                  LD      (IX+10),A
  EBB4    3A BBDF        C                  LD      A,(S0.PFFI+3FFH)    ;letztes Byte aus der Datei
  EBB7    C9             C                  RET
                         C      
  EBB8    45 73 20 77    C      S9.TXT1:    DB      'Es wurde keine Eingabedatei eroeffnet '
  EBBC    75 72 64 65    C      
  EBC0    20 6B 65 69    C      
  EBC4    6E 65 20 45    C      
  EBC8    69 6E 67 61    C      
  EBCC    62 65 64 61    C      
  EBD0    74 65 69 20    C      
  EBD4    65 72 6F 65    C      
  EBD8    66 66 6E 65    C      
  EBDC    74 20          C      
                         C      
                         C                  TITLE   'Ausgabe eines Zeichens'
                         C                  PAGE
'Ausgabe eines Zeichens'	MACRO-80 3.44	09-Dec-81	PAGE	1-139


                         C      
                         C      ;*               Ausgabe eines Zeichens                         *
                         C      ;****************************************************************
  EBDE    CD EE58        C      S9.WRTV:    CALL    S9.SAVE
  EBE1    3A B260        C                  LD      A,(S2.OM)
  EBE4    B7             C                  OR      A
  EBE5    20 06          C                  JR      NZ,S9.WRTV2
  EBE7    21 EC0A        C      S9.WRTVF:   LD      HL,S9.TXT2          ;Fehleranzeige
  EBEA    C3 EB4F        C                  JP      S9.RIV1
                         C      
  EBED    CD F031        C      S9.WRTV2:   CALL    S9.RGLO
  EBF0    21 B420        C                  LD      HL,0B420H
  EBF3    7E             C                  LD      A,(HL)
  EBF4    B7             C                  OR      A
  EBF5    79             C                  LD      A,C
  EBF6    28 0A          C                  JR      Z,S9.WRTV6
  EBF8    23             C                  INC     HL
  EBF9    FE 0A          C                  CP      00AH
  EBFB    28 0B          C                  JR      Z,S9.WRTV9
  EBFD    FE 0D          C                  CP      00DH
  EBFF    20 01          C                  JR      NZ,S9.WRTV6
  EC01    7E             C      S9.WRTV5:   LD      A,(HL)
  EC02    CD B425        C      S9.WRTV6:   CALL    0B425H              ;Ausgabe-Kodetransformation
  EC05    CD DB6E        C                  CALL    K1.SCHR
                         C      
  EC08    18 37          C      S9.WRTV9:   JR      S9.STX9
                         C      
  EC0A    45 73 20 77    C      S9.TXT2:    DB      'Es wurde keine Ausgabedatei eroeffnet '
  EC0E    75 72 64 65    C      
  EC12    20 6B 65 69    C      
  EC16    6E 65 20 41    C      
  EC1A    75 73 67 61    C      
  EC1E    62 65 64 61    C      
  EC22    74 65 69 20    C      
  EC26    65 72 6F 65    C      
  EC2A    66 66 6E 65    C      
  EC2E    74 20          C      
                         C      
                         C      ;****************************************************************
                         C      ;*                Druckroutine                                  *
                         C      ;****************************************************************
  EC30    CD EE58        C      S9.LISTX:   CALL    S9.SAVE
  EC33    79             C                  LD      A,C
  EC34    FE 0D          C                  CP      00DH
  EC36    28 09          C                  JR      Z,S9.STX9
  EC38    FE 0A          C                  CP      00AH
  EC3A    20 02          C                  JR      NZ,S9.STX2
  EC3C    0E 1E          C                  LD      C,01EH              ;Ausgabe Zeilenendezeichen
  EC3E    CD F55F        C      S9.STX2:    CALL    SM.PRIO             ;Zeichen auf Drucker ausgeben
  EC41    18 76          C      S9.STX9:    JR      S9.IOXE
                         C      
  EC43    CD EE58        C      S9.LISTY:   CALL    S9.SAVE
  EC46    79             C                  LD      A,C
  EC47    FE 0D          C                  CP      00DH
  EC49    28 F6          C                  JR      Z,S9.STX9
  EC4B    FE 0A          C                  CP      00AH
  EC4D    28 F2          C                  JR      Z,S9.STX9
  EC4F    18 ED          C                  JR      S9.STX2
                         C      
                         C                  TITLE   'SWITCH - Routine'
                         C                  PAGE
'SWITCH - Routine'	MACRO-80 3.44	09-Dec-81	PAGE	1-140


                         C      
                         C      ;****************************************************************
                         C      ;*               S W I T C H   -   Routine                      *
                         C      ;****************************************************************
  EC51    CD EE58        C      S9.IOSTX:   CALL    S9.SAVE
  EC54    F5             C                  PUSH    AF
  EC55    3A B264        C                  LD      A,(S2.IOC)
  EC58    FE 01          C                  CP      1
  EC5A    28 33          C                  JR      Z,S9.IOX10
  EC5C    F1             C                  POP     AF
  EC5D    FE 01          C                  CP      1                   ;Eingabe von Kassette
  EC5F    28 10          C                  JR      Z,S9.IOX1
  EC61    FE 02          C                  CP      2                   ;Ausgabe auf Kassette
  EC63    28 14          C                  JR      Z,S9.IOX2
  EC65    FE 03          C                  CP      3                   ;Ausgabe auf Drucker
  EC67    28 18          C                  JR      Z,S9.IOX3
  EC69    21 E657        C      S9.IOX0:    LD      HL,S9.CIN           ;Eingabe Tastatur / Ausgabe Bildschirm
  EC6C    01 E6A6        C                  LD      BC,S9.CON
  EC6F    18 15          C                  JR      S9.IOX8
  EC71    21 EB43        C      S9.IOX1:    LD      HL,S9.RIV
  EC74    01 ECBC        C                  LD      BC,S9.IOX
  EC77    18 0D          C                  JR      S9.IOX8
  EC79    21 ECBC        C      S9.IOX2:    LD      HL,S9.IOX
  EC7C    01 EBDE        C                  LD      BC,S9.WRTV
  EC7F    18 05          C                  JR      S9.IOX8
  EC81    01 EC30        C      S9.IOX3:    LD      BC,S9.LISTX
  EC84    18 03          C                  JR      S9.IOX9
  EC86    22 030A        C      S9.IOX8:    LD      (BC.CIN+1),HL
  EC89    ED 43 0310     C      S9.IOX9:    LD      (BC.CON+1),BC
  EC8D    18 2A          C      S9.IOX90:   JR      S9.IOXE
                         C      
  EC8F    F1             C      S9.IOX10:   POP     AF
  EC90    FE 01          C                  CP      1                   ;Eingabe/Ausgabe ueber IOCS
  EC92    28 10          C                  JR      Z,S9.IOX11
  EC94    FE 02          C                  CP      2                   ;Eingabe/Ausgabe auf   HS-Erweiterung
  EC96    28 14          C                  JR      Z,S9.IOX12
  EC98    FE 03          C                  CP      3                   ;Ausgabe auf Drucker
  EC9A    28 18          C                  JR      Z,S9.IOX13
  EC9C    21 E657        C                  LD      HL,S9.CIN           ;Eingabe Tastatur / Ausgabe Bildschirm
  EC9F    01 E6A6        C                  LD      BC,S9.CON
  ECA2    18 E2          C                  JR      S9.IOX8
  ECA4    21 ECBC        C      S9.IOX11:   LD      HL,S9.IOX
  ECA7    01 ECBC        C                  LD      BC,S9.IOX
  ECAA    18 DA          C                  JR      S9.IOX8
  ECAC    21 ECBC        C      S9.IOX12:   LD      HL,S9.IOX
  ECAF    01 ECBC        C                  LD      BC,S9.IOX
  ECB2    18 D2          C                  JR      S9.IOX8
  ECB4    01 EC43        C      S9.IOX13:   LD      BC,S9.LISTY
  ECB7    18 D0          C                  JR      S9.IOX9
                         C      
  ECB9    CD EE78        C      S9.IOXE:    CALL    S9.LOAD
  ECBC    C9             C      S9.IOX:     RET
                         C      
                         C                  TITLE   'U S R - Routine  ONKEY'
                         C                  PAGE
'U S R - Routine  ONKEY'	MACRO-80 3.44	09-Dec-81	PAGE	1-141


                         C      
                         C      ;****************************************************************
                         C      ;*               U S R  -  Routine als   ONKEY - Funktion       *
                         C      ;****************************************************************
  ECBD    CD EE58        C      S9.USER:    CALL    S9.SAVE
  ECC0    CD D408        C                  CALL    TA.LOE
  ECC3    CD 0327        C                  CALL    BC.PAR              ;Parameter uebernehmen
  ECC6    1C             C                  INC     E
  ECC7    DD 21 B1B7     C                  LD      IX,TS.TAB1+24       ;Tasten PF13 bis PF48 aktivieren
  ECCB    21 ECF4        C                  LD      HL,S9.USR3
  ECCE    06 24          C                  LD      B,36
  ECD0    DD 75 00       C      S9.USR1:    LD      (IX+0),L
  ECD3    DD 74 01       C                  LD      (IX+1),H
  ECD6    DD 23          C                  INC     IX
  ECD8    DD 23          C                  INC     IX
  ECDA    10 F4          C                  DJNZ    S9.USR1
  ECDC    3E 80          C                  LD      A,10000000B
  ECDE    32 B23F        C                  LD      (TS.SPMER),A
  ECE1    3E 07          C                  LD      A,7                 ;Cursor loeschen
  ECE3    32 B198        C                  LD      (MS.CMD),A
  ECE6    CD CB10        C                  CALL    MO.MONI
                         C      
  ECE9    D5             C      S9.USR2:    PUSH    DE                  ;warten bis eine P-Taste gedrueckt
  ECEA    3E 01          C                  LD      A,1
  ECEC    32 B242        C                  LD      (TS.ZSMER),A
  ECEF    CD D237        C                  CALL    TA.ABFR
  ECF2    18 FB          C                  JR      $-3
                         C      
  ECF4    3A B23D        C      S9.USR3:    LD      A,(TS.PTK)          ;P-Tastennummer an BASIC uebergeben
  ECF7    D6 0C          C                  SUB     12
  ECF9    D1             C                  POP     DE
  ECFA    D1             C                  POP     DE
  ECFB    D1             C                  POP     DE
  ECFC    BB             C                  CP      E
  ECFD    30 EA          C                  JR      NC,S9.USR2
                         C      
  ECFF    CD EDC4        C                  CALL    S9.USR7             ;Warteschleife
                         C      
  ED02    47             C                  LD      B,A                 ;Tastennummer zurueckgeben
  ED03    AF             C                  XOR     A
  ED04    CD 032A        C                  CALL    BC.RUCK
  ED07    18 B0          C      S9.USR4:    JR      S9.IOXE
                         C      
                         C                  TITLE   'U S R - Routine  INKEY 1'
                         C                  PAGE
'U S R - Routine  INKEY 1'	MACRO-80 3.44	09-Dec-81	PAGE	1-142


                         C      
                         C      ;****************************************************************
                         C      ;*               U S R  -  Routine als   INKEY  1 - Funktion    *
                         C      ;****************************************************************
  ED09    CD EE58        C      S9.USER2:   CALL    S9.SAVE
  ED0C    CD D408        C                  CALL    TA.LOE
  ED0F    CD 0327        C                  CALL    BC.PAR              ;Parameter uebernehmen
  ED12    1C             C                  INC     E
  ED13    DD 21 B1B7     C                  LD      IX,TS.TAB1+24       ;Tasten PF13 bis PF48 aktivieren
  ED17    21 ED3F        C                  LD      HL,S9.USR23
  ED1A    06 24          C                  LD      B,36
  ED1C    CD EDCF        C                  CALL    S9.USR8
  ED1F    3E 80          C                  LD      A,10000000B
  ED21    32 B23F        C                  LD      (TS.SPMER),A
  ED24    3E 07          C                  LD      A,7                 ;Cursor loeschen
  ED26    32 B198        C                  LD      (MS.CMD),A
  ED29    CD CB10        C                  CALL    MO.MONI
                         C      
  ED2C    D5             C      S9.USR22:   PUSH    DE                  ;eine P-Taste gedrueckt ?
  ED2D    3E 01          C                  LD      A,1
  ED2F    32 B242        C                  LD      (TS.ZSMER),A
  ED32    CD D13D        C                  CALL    TA.TA1
  ED35    20 1F          C                  JR      NZ,S9.USR24
  ED37    CD D155        C                  CALL    TA.TA2
  ED3A    CD D24A        C                  CALL    TA.ABFR2
  ED3D    18 17          C                  JR      S9.USR24
                         C      
  ED3F    3A B23D        C      S9.USR23:   LD      A,(TS.PTK)          ;P-Tastennummer an BASIC uebergeben
  ED42    D6 0C          C                  SUB     12
  ED44    D1             C                  POP     DE
  ED45    D1             C                  POP     DE
  ED46    D1             C                  POP     DE
  ED47    BB             C                  CP      E
  ED48    F5             C                  PUSH    AF
                         C      
  ED49    CD EDC4        C                  CALL    S9.USR7                ;Warteschleife
                         C      
  ED4C    F1             C                  POP     AF
  ED4D    30 07          C                  JR      NC,S9.USR24
  ED4F    47             C      S9.USR40:   LD      B,A                 ;Tastennummer zurueckgeben
  ED50    AF             C      S9.USR25:   XOR     A
  ED51    CD 032A        C                  CALL    BC.RUCK
  ED54    18 B1          C                  JR      S9.USR4
  ED56    06 00          C      S9.USR24:   LD      B,0
  ED58    18 F6          C                  JR      S9.USR25
                         C      
                         C                  TITLE   'U S R - Routine  INKEY 2'
                         C                  PAGE
'U S R - Routine  INKEY 2'	MACRO-80 3.44	09-Dec-81	PAGE	1-143


                         C      
                         C      ;****************************************************************
                         C      ;*               U S R  -  Routine als   INKEY 2 - Funktion     *
                         C      ;****************************************************************
  ED5A    CD EE58        C      S9.USER3:   CALL    S9.SAVE
  ED5D    CD D408        C                  CALL    TA.LOE
  ED60    CD 0327        C                  CALL    BC.PAR              ;Parameter uebernehmen
  ED63    7B             C                  LD      A,E                 ;TS.SPMER
  ED64    32 B23F        C                  LD      (TS.SPMER),A
  ED67    21 EDB8        C                  LD      HL,S9.USR33
  ED6A    7A             C                  LD      A,D                 ;Erweiterung TS.SPMER
  ED6B    FE 01          C                  CP      1
  ED6D    28 13          C                  JR      Z,S9.USR36
  ED6F    FE 02          C                  CP      2
  ED71    28 17          C                  JR      Z,S9.USR37
  ED73    FE 03          C                  CP      3
  ED75    28 1E          C                  JR      Z,S9.USR41
  ED77    DD 21 B1FF     C                  LD      IX,TS.TAB2          ;D=0  ...  TS.TAB2
  ED7B    06 0C          C                  LD      B,12
  ED7D    CD EDD1        C                  CALL    S9.USR9
  ED80    18 1C          C                  JR      S9.USR39
  ED82    22 B21B        C      S9.USR36:   LD      (TS.TAB3+4),HL      ;D=1  ...  POS_QUIT/NEG_QUIT
  ED85    22 B223        C                  LD      (TS.TAB4),HL
  ED88    18 14          C                  JR      S9.USR39
  ED8A    DD 21 B1FF     C      S9.USR37:   LD      IX,TS.TAB2          ;D=2  ...  TS.TAB2,TS.TAB3,TS.TAB4
  ED8E    06 17          C                  LD      B,23
  ED90    CD EDD1        C                  CALL    S9.USR9
  ED93    18 09          C                  JR      S9.USR39
  ED95    DD 21 B1FF     C      S9.USR41:   LD      IX,TS.TAB2          ;D=3  ...  TS.TAB2 --- TS.NEWL
  ED99    06 1A          C                  LD      B,26
  ED9B    CD EDD1        C                  CALL    S9.USR9
  ED9E    3E 07          C      S9.USR39:   LD      A,7                 ;Cursor loeschen
  EDA0    32 B198        C                  LD      (MS.CMD),A
  EDA3    CD CB10        C                  CALL    MO.MONI
                         C      
  EDA6    3E 01          C      S9.USR32:   LD      A,1                 ;eine P-Taste gedrueckt ?
  EDA8    32 B242        C                  LD      (TS.ZSMER),A
  EDAB    CD D13D        C                  CALL    TA.TA1
  EDAE    20 A6          C                  JR      NZ,S9.USR24
  EDB0    CD D155        C                  CALL    TA.TA2
  EDB3    CD D24A        C                  CALL    TA.ABFR2
  EDB6    18 9E          C                  JR      S9.USR24
                         C      
  EDB8    3A B23C        C      S9.USR33:   LD      A,(TS.TK)           ;Tastennummer an BASIC uebergeben
  EDBB    D1             C                  POP     DE
  EDBC    D1             C                  POP     DE
  EDBD    F5             C                  PUSH    AF
                         C      
  EDBE    CD EDC4        C                  CALL    S9.USR7
                         C      
  EDC1    F1             C                  POP     AF
  EDC2    18 8B          C                  JR      S9.USR40
                         C      
  EDC4    06 80          C      S9.USR7:    LD      B,80H               ;Warteschleife
  EDC6    C5             C                  PUSH    BC
  EDC7    06 FF          C                  LD      B,-1
  EDC9    10 FE          C                  DJNZ    $-0
  EDCB    C1             C                  POP     BC
  EDCC    10 F8          C                  DJNZ    $-6
  EDCE    C9             C                  RET
                         C      
  EDCF    06 24          C      S9.USR8:    LD      B,36
  EDD1    DD 75 00       C      S9.USR9:    LD      (IX+0),L
  EDD4    DD 74 01       C                  LD      (IX+1),H
  EDD7    DD 23          C                  INC     IX
  EDD9    DD 23          C                  INC     IX
  EDDB    10 F4          C                  DJNZ    S9.USR9
  EDDD    C9             C                  RET
                         C      
                         C                  TITLE   'weitere Anschlussroutinen'
                         C                  PAGE
'weitere Anschlussroutinen'	MACRO-80 3.44	09-Dec-81	PAGE	1-144


                         C      
                         C      ;****************************************************************
                         C      ;*               Speicherende uebergeben                        *
                         C      ;****************************************************************
  EDDE    06 9F          C      S9.MEMCK:   LD      B,HIGH(S0.MEMCK)
  EDE0    3E FF          C                  LD      A,LOW(S0.MEMCK)
  EDE2    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*               Veraenderte Routine fuer   O U T               *
                         C      ;****************************************************************
  EDE3    CD 171B        C      S9.OUT:     CALL    BC.C091
  EDE6    3E 2C          C                  LD      A,02CH
  EDE8    CD 0451        C                  CALL    BC.C006
  EDEB    D5             C                  PUSH    DE
  EDEC    CD 171B        C                  CALL    BC.C091
  EDEF    4B             C                  LD      C,E
  EDF0    D1             C                  POP     DE
  EDF1    43             C                  LD      B,E
  EDF2    D1             C                  POP     DE
  EDF3    7B             C                  LD      A,E
  EDF4    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*               Routine fuer das  BASIC - Token   S V C        *
                         C      ;****************************************************************
  EDF5    ED 73 019A     C      S9.SVC:     LD      (BC.D047),SP
  EDF9    E5             C                  PUSH    HL
  EDFA    11 1F57        C                  LD      DE,BC.D101
  EDFD    D5             C                  PUSH    DE
  EDFE    11 F0A0        C                  LD      DE,S9.ABAUP         ;Standardzieladresse fuer  SVC
  EE01    01 0000        C                  LD      BC,0                ;Par.zaehler gleich 0
  EE04    D5             C                  PUSH    DE
  EE05    CD 0948        C                  CALL    BC.C032
  EE08    CA 1F4B        C                  JP      Z,BC.CALL2
  EE0B    C3 1F40        C                  JP      BC.CALL1
                         C      ;****************************************************************
                         C      ;*               Routine fuer das  BASIC - Token   G R F        *
                         C      ;****************************************************************
                         C      ; S9.GRF:     LD      (BC.D047),SP
                         C      ;             PUSH    HL
                         C      ;             LD      DE,BC.D101
                         C      ;             PUSH    DE
                         C      ;             LD      DE,ABGUP            ;Standardzieladresse fuer  GRF
                         C      ;             LD      BC,0                ;Par.zaehler gleich 0
                         C      ;             PUSH    DE
                         C      ;             CALL    BC.C032
                         C      ;             JPZ     BC.CALL2
                         C      ;             JP      BC.CALL1
                         C      
  EE0E                   C      S9.OUTLG    EQU     $
                         C      
                         C                  PAGE
'weitere Anschlussroutinen'	MACRO-80 3.44	09-Dec-81	PAGE	1-145


                         C      
                         C      ;****************************************************************
                         C      ;*               suchen der  BASIC - Variable   n a $           *
                         C      ;*               -----------------------------------------------*
                         C      ;*               Eingang:   S2.RBBR+1      1. Namenszeichen     *
                         C      ;*                          S2.RBBR        2. Namenszeichen     *
                         C      ;*               Ausgang:   (HL)           Adresse der Variable *
                         C      ;*                          (DE)           Laenge  der Variable *
                         C      ;*                          (HL)=(DE)=0    na$ existiert nicht  *
                         C      ;****************************************************************
  EE0E    AF             C      S9.SUSY:    XOR     A                   ;CY=0
  EE0F    2A 015E        C                  LD      HL,(BC.D024)        ;1.Byte des Ber. f. einf. Var.
  EE12    ED 4B 0160     C                  LD      BC,(BC.D025)        ;1.Byte des Ber. f. Dim.  Var.
  EE16    11 0007        C                  LD      DE,7                ;D = 0 , E = 7
  EE19    ED 42          C      S9.SUCHE:   SBC     HL,BC
  EE1B    30 1C          C                  JR      NC,S9.ENDEV         ;wenn Ber. einf. Var. zu Ende
  EE1D    09             C                  ADD     HL,BC               ;HL wieder herstellen
  EE1E    3A B26C        C                  LD      A,(S2.RBBR)         ;"Y" + 80H  fuer Y$
  EE21    BE             C                  CP      (HL)
  EE22    23             C                  INC     HL
  EE23    20 10          C                  JR      NZ,S9.NISY          ;wenn nicht  SY$
  EE25    3A B26D        C                  LD      A,(S2.RBBR+1)
  EE28    BE             C                  CP      (HL)
  EE29    20 0A          C                  JR      NZ,S9.NISY          ;wenn nicht  SY$
  EE2B    23             C                  INC     HL
  EE2C    5E             C                  LD      E,(HL)              ;DE enthaelt Laenge der Zeichenkette
  EE2D    23             C                  INC     HL
  EE2E    23             C                  INC     HL
  EE2F    46             C                  LD      B,(HL)              ;L(Zeichenkettenadresse)
  EE30    23             C                  INC     HL
  EE31    66             C                  LD      H,(HL)              ;H(Zeichenkettenadresse)
  EE32    68             C                  LD      L,B
  EE33    18 06          C                  JR      S9.UEBGA
                         C      
  EE35    AF             C      S9.NISY:    XOR     A                   ;CY=0
  EE36    19             C                  ADD     HL,DE               ;zeigt auf naechste Variable
  EE37    18 E0          C                  JR      S9.SUCHE
  EE39    1E 00          C      S9.ENDEV:   LD      E,0                 ;Laenge=0 wenn SY$ nicht gefunden
                         C      
  EE3B    C9             C      S9.UEBGA:   RET
                         C      
  EE3C    26 45          C      S9.ERSTR:   LD      H,'E'               ;ER$ suchen
  EE3E    2E D2          C                  LD      L,52H+80H
  EE40    22 B26C        C      S9.NSTR:    LD      (S2.RBBR),HL
  EE43    CD EE0E        C                  CALL    S9.SUSY
  EE46    7A             C                  LD      A,D
  EE47    B3             C                  OR      E
  EE48    C9             C                  RET
                         C      
  EE49    F5             C      S9.ERS:     PUSH    AF
  EE4A    CD EE3C        C                  CALL    S9.ERSTR
  EE4D    28 07          C                  JR      Z,S9.ERS1
  EE4F    11 0006        C                  LD      DE,6
  EE52    19             C                  ADD     HL,DE
  EE53    F1             C                  POP     AF
  EE54    77             C                  LD      (HL),A
  EE55    C9             C                  RET
  EE56    F1             C      S9.ERS1:    POP     AF
  EE57    C9             C                  RET
                         C      
                         C                  TITLE   'retten und laden der Register'
                         C                  PAGE
'retten und laden der Register'	MACRO-80 3.44	09-Dec-81	PAGE	1-146


                         C      
                         C      ;****************************************************************
                         C      ;*  S A V E  ---   retten der Register                          *
                         C      ;****************************************************************
  EE58    ED 73 AFFC     C      S9.SAVE:    LD      (S0.STACK-2),SP
  EE5C    31 AFFC        C                  LD      SP,S0.STACK-2
  EE5F    F5             C                  PUSH    AF
  EE60    C5             C                  PUSH    BC
  EE61    D5             C                  PUSH    DE
  EE62    DD E5          C                  PUSH    IX
  EE64    FD E5          C                  PUSH    IY
  EE66    E5             C                  PUSH    HL
  EE67    ED 7B AFFC     C                  LD      SP,(S0.STACK-2)
  EE6B    E1             C                  POP     HL                  ;Ruecksprungadresse
  EE6C    31 AFF0        C                  LD      SP,S0.STACK-14
  EE6F    E5             C                  PUSH    HL
  EE70    ED 73 B24D     C                  LD      (TS.STACK),SP
  EE74    2A AFF0        C                  LD      HL,(S0.STACK-14)
  EE77    C9             C                  RET
                         C      
                         C      ;****************************************************************
                         C      ;*  L O A D  ---   laden der Register                           *
                         C      ;****************************************************************
  EE78    CD E4D3        C      S9.LOAD:    CALL    S9.TALOE
  EE7B    21 AFFE        C                  LD      HL,S0.STACK
  EE7E    22 B24D        C                  LD      (TS.STACK),HL
  EE81    E1             C                  POP     HL
  EE82    ED 7B AFFC     C                  LD      SP,(S0.STACK-2)
  EE86    33             C                  INC     SP
  EE87    33             C                  INC     SP
  EE88    E5             C                  PUSH    HL
  EE89    31 AFF0        C                  LD      SP,S0.STACK-14
  EE8C    E1             C                  POP     HL
  EE8D    FD E1          C                  POP     IY
  EE8F    DD E1          C                  POP     IX
  EE91    D1             C                  POP     DE
  EE92    C1             C                  POP     BC
  EE93    F1             C                  POP     AF
  EE94    ED 7B AFFC     C                  LD      SP,(S0.STACK-2)
  EE98    C9             C                  RET
                         C      
                         C                  TITLE   'OPEN- / CLOSE- Routine'
                         C                  PAGE
'OPEN- / CLOSE- Routine'	MACRO-80 3.44	09-Dec-81	PAGE	1-147


                         C      
                         C      ;****************************************************************
                         C      ;*                OPEN - Routine                                *
                         C      ;*                CALL &B406,geraet,{"I"|"O"|"M"},label         *
                         C      ;****************************************************************
  EE99    3E FF          C      S9.ROP1:    LD      A,-1                ;Merker relatives OPEN
  EE9B    B7             C                  OR      A
  EE9C    18 38          C                  JR      S9.ROP2
  EE9E    3A B26B        C      S9.ROP3:    LD      A,(S2.DNR)          ;Output
  EEA1    CB 7F          C                  BIT     7,A
  EEA3    28 06          C                  JR      Z,S9.ROP4
  EEA5    CB BF          C                  RES     7,A
  EEA7    3C             C                  INC     A
  EEA8    C3 EF0F        C                  JP      S9.OP4+3
  EEAB    CB FF          C      S9.ROP4:    SET     7,A
  EEAD    ED 44          C                  NEG
  EEAF    57             C                  LD      D,A
  EEB0    CD D7EB        C                  CALL    K1.GNLMN
  EEB3    18 5F          C                  JR      S9.OP5
  EEB5    3A B26B        C      S9.ROP7:    LD      A,(S2.DNR)          ;Input
  EEB8    CB 7F          C                  BIT     7,A
  EEBA    28 06          C                  JR      Z,S9.ROP8
  EEBC    CB BF          C                  RES     7,A
  EEBE    3C             C                  INC     A
  EEBF    C3 EF60        C                  JP      S9.OP21+3
  EEC2    CB FF          C      S9.ROP8:    SET     7,A
  EEC4    ED 44          C                  NEG
  EEC6    57             C                  LD      D,A
  EEC7    CD D7EB        C                  CALL    K1.GNLMN
  EECA    C3 EF65        C                  JP      S9.OP22
                         C      
  EECD    33             C      S9.OPEN:    INC     SP
  EECE    33             C                  INC     SP
  EECF    CD EE58        C                  CALL    S9.SAVE
  EED2    CD F0D6        C      S9.OPEN1:   CALL    S9.AUP
  EED5    AF             C                  XOR     A                   ;Merker absolutes OPEN
  EED6    F5             C      S9.ROP2:    PUSH    AF
  EED7    21 B25F        C                  LD      HL,S2.IM
  EEDA    06 00          C                  LD      B,0
  EEDC    DD 7E 04       C      S9.OP1:     LD      A,(IX+4)            ;Geraeteadresse
  EEDF    FE 01          C                  CP      1
  EEE1    28 04          C                  JR      Z,S9.OP2
  EEE3    CB C8          C                  SET     1,B                 ;Geraet 2
  EEE5    18 02          C                  JR      S9.OP7
  EEE7    CB C0          C      S9.OP2:     SET     0,B                 ;Geraet 1
  EEE9    DD 7E 00       C      S9.OP7:     LD      A,(IX+0)            ;label
  EEEC    32 B26B        C                  LD      (S2.DNR),A
  EEEF    DD 7E 02       C                  LD      A,(IX+2)            ;(I)nput oder (O)utput ?
  EEF2    FE 49          C                  CP      'I'
  EEF4    28 58          C                  JR      Z,S9.OP20
  EEF6    FE 4D          C                  CP      'M'
  EEF8    20 02          C                  JR      NZ,S9.OP3
  EEFA    CB E0          C                  SET     4,B                 ;MOD Verarbeitung
  EEFC    23             C      S9.OP3:     INC     HL                  ;Output
  EEFD    78             C                  LD      A,B
  EEFE    77             C                  LD      (HL),A
  EEFF    CD F031        C                  CALL    S9.RGLO
  EF02    CD D708        C                  CALL    K1.GNRE
  EF05    F1             C                  POP     AF
  EF06    C2 EE9E        C                  JP      NZ,S9.ROP3
  EF09    CD D740        C                  CALL    K1.GNRW
  EF0C    3A B26B        C      S9.OP4:     LD      A,(S2.DNR)          ;Datei positionieren
  EF0F    3D             C                  DEC     A
  EF10    57             C                  LD      D,A
  EF11    CD D7B3        C                  CALL    K1.GNLPN
  EF14    3A B260        C      S9.OP5:     LD      A,(S2.OM)           ;MOD - Verarbeitung
  EF17    CB 67          C                  BIT     4,A
  EF19    28 28          C                  JR      Z,S9.OP13
  EF1B    CD D7B1        C                  CALL    K1.GNLP
  EF1E    CD D780        C                  CALL    K1.GNRM
  EF21    CD D780        C                  CALL    K1.GNRM
  EF24    DD 36 04 02    C                  LD      (IX+4),2
  EF28    CD D54B        C                  CALL    K1.ARMB
  EF2B    CD D5D5        C                  CALL    K1.F17
  EF2E    CD D576        C                  CALL    K1.ARBT
  EF31    CD D5C1        C                  CALL    K1.LHLBC
  EF34    11 BBF0        C                  LD      DE,S0.PFFA
  EF37    ED B0          C                  LDIR
  EF39    CD D59D        C                  CALL    K1.RCZP
  EF3C    D5             C                  PUSH    DE
  EF3D    CD D780        C                  CALL    K1.GNRM
  EF40    E1             C                  POP     HL
'OPEN- / CLOSE- Routine'	MACRO-80 3.44	09-Dec-81	PAGE	1-148


  EF41    18 03          C                  JR      S9.OP14
  EF43    21 BBF0        C      S9.OP13:    LD      HL,S0.PFFA
  EF46    22 B25B        C      S9.OP14:    LD      (S2.POIA),HL
  EF49    CD D6B1        C                  CALL    K1.GNSTS
  EF4C    18 1D          C                  JR      S9.OPR
                         C      
  EF4E    78             C      S9.OP20:    LD      A,B                 ;Input
  EF4F    77             C                  LD      (HL),A
  EF50    CD F021        C                  CALL    S9.RGLI
  EF53    CD D708        C                  CALL    K1.GNRE
  EF56    F1             C                  POP     AF
  EF57    C2 EEB5        C                  JP      NZ,S9.ROP7
  EF5A    CD D740        C                  CALL    K1.GNRW
  EF5D    3A B26B        C      S9.OP21:    LD      A,(S2.DNR)          ;Datei positionieren
  EF60    3D             C                  DEC     A
  EF61    57             C                  LD      D,A
  EF62    CD D7B3        C                  CALL    K1.GNLPN
  EF65    01 0400        C      S9.OP22:    LD      BC,00400H           ;Eingabepuffer fuellen
  EF68    CD DAF0        C                  CALL    K1.EIN
                         C      
  EF6B    C3 F0DF        C      S9.OPR:     JP      S9.RBAUP
                         C      ;****************************************************************
                         C      ;*                 CLOSE - Routine                              *
                         C      ;*                 CALL &B409,{"I"|"O"}                         *
                         C      ;****************************************************************
  EF6E    33             C      S9.CLOSE:   INC     SP
  EF6F    33             C                  INC     SP
  EF70    CD EE58        C                  CALL    S9.SAVE
  EF73    CD F0D6        C      S9.CLOS1:   CALL    S9.AUP
  EF76    AF             C                  XOR     A
  EF77    F5             C      S9.RCL2:    PUSH    AF
  EF78    DD 7E 00       C                  LD      A,(IX+0)
  EF7B    FE 4F          C                  CP      'O'
  EF7D    28 1A          C                  JR      Z,S9.CLO1
                         C      
  EF7F    F1             C                  POP     AF                  ;CLOSE Input
  EF80    08             C                  EX      AF,AF'              ;'
  EF81    3A B25F        C                  LD      A,(S2.IM)
  EF84    B7             C                  OR      A
  EF85    CA EB4C        C      S9.CLO2:    JP      Z,S9.RIVF
  EF88    CD F021        C                  CALL    S9.RGLI
  EF8B    08             C                  EX      AF,AF'              ;'
  EF8C    20 37          C                  JR      NZ,S9.RCL3
  EF8E    CD D740        C                  CALL    K1.GNRW
  EF91    CD D725        C                  CALL    K1.GNRA
  EF94    CD EFCA        C      S9.RCL4:    CALL    S9.MIR
  EF97    18 D2          C      S9.CLR:     JR      S9.OPR
                         C      
  EF99    F1             C      S9.CLO1:    POP     AF                  ;CLOSE Output
  EF9A    08             C                  EX      AF,AF'              ;'
  EF9B    3A B260        C                  LD      A,(S2.OM)
  EF9E    B7             C                  OR      A
  EF9F    CA EBE7        C      S9.CLO3:    JP      Z,S9.WRTVF
  EFA2    CB 7F          C                  BIT     7,A
  EFA4    28 03          C                  JR      Z,S9.CLO4
  EFA6    AF             C                  XOR     A
  EFA7    18 F6          C                  JR      S9.CLO3
  EFA9    CD F031        C      S9.CLO4:    CALL    S9.RGLO
  EFAC    CD DB29        C                  CALL    K1.AUS
  EFAF    CD D82E        C                  CALL    K1.GNCLS
  EFB2    08             C                  EX      AF,AF'              ;'
  EFB3    20 06          C                  JR      NZ,S9.RCL5
  EFB5    CD D740        C                  CALL    K1.GNRW
  EFB8    CD D725        C                  CALL    K1.GNRA
  EFBB    CD EFD7        C      S9.RCL5:    CALL    S9.MOR
  EFBE    18 D7          C                  JR      S9.CLR
                         C      
  EFC0    3E FF          C      S9.RCL1:    LD      A,-1
  EFC2    B7             C                  OR      A
  EFC3    18 B2          C                  JR      S9.RCL2
  EFC5    CD D7B1        C      S9.RCL3:    CALL    K1.GNLP
  EFC8    18 CA          C                  JR      S9.RCL4
                         C      
  EFCA    AF             C      S9.MIR:     XOR     A
  EFCB    32 B25F        C                  LD      (S2.IM),A
  EFCE    32 B41E        C                  LD      (0B41EH),A
  EFD1    3E C9          C                  LD      A,0C9H
  EFD3    32 B422        C                  LD      (0B422H),A
  EFD6    C9             C                  RET
                         C      
  EFD7    AF             C      S9.MOR:     XOR     A
  EFD8    32 B260        C                  LD      (S2.OM),A
  EFDB    32 B420        C                  LD      (0B420H),A
'OPEN- / CLOSE- Routine'	MACRO-80 3.44	09-Dec-81	PAGE	1-149


  EFDE    3E C9          C                  LD      A,0C9H
  EFE0    32 B425        C                  LD      (0B425H),A
  EFE3    C9             C                  RET
                         C      
                         C                  TITLE   'READ / WRITE - Routinen'
                         C                  PAGE
'READ / WRITE - Routinen'	MACRO-80 3.44	09-Dec-81	PAGE	1-150


                         C      
                         C      ;****************************************************************
                         C      ;*                 READ - Routine                               *
                         C      ;*                 CALL &B40C                                   *
                         C      ;****************************************************************
  EFE4    33             C      S9.READ:    INC     SP
  EFE5    33             C                  INC     SP
  EFE6    CD EE58        C                  CALL    S9.SAVE
  EFE9    3A B25F        C      S9.READ1:   LD      A,(S2.IM)
  EFEC    B7             C                  OR      A
  EFED    28 96          C                  JR      Z,S9.CLO2
  EFEF    CD F021        C                  CALL    S9.RGLI
  EFF2    01 0400        C                  LD      BC,400H             ;Eingabepuffer fuellen
  EFF5    CD DAF0        C                  CALL    K1.EIN
  EFF8    18 9D          C      S9.RE9:     JR      S9.CLR
  EFFA    3A B25F        C      S9.READ2:   LD      A,(S2.IM)
  EFFD    B7             C                  OR      A
  EFFE    28 85          C                  JR      Z,S9.CLO2
  F000    CD F021        C                  CALL    S9.RGLI
  F003    CD DB0B        C                  CALL    K1.EINP
  F006    CD D5CE        C                  CALL    K1.BM
  F009    CC EB9C        C                  CALL    Z,S9.BM3
  F00C    18 EA          C                  JR      S9.RE9
                         C      ;****************************************************************
                         C      ;*                 WRITE - Routine                              *
                         C      ;*                 CALL &B40F                                   *
                         C      ;****************************************************************
  F00E    33             C      S9.WRITE:   INC     SP
  F00F    33             C                  INC     SP
  F010    CD EE58        C                  CALL    S9.SAVE
  F013    3A B260        C      S9.WRIT1:   LD      A,(S2.OM)
  F016    B7             C                  OR      A
  F017    28 86          C                  JR      Z,S9.CLO3
  F019    CD F031        C                  CALL    S9.RGLO
  F01C    CD DB29        C                  CALL    K1.AUS              ;Ausgabepuffer leeren
  F01F    18 D7          C      S9.WR9:     JR      S9.RE9
                         C      ;****************************************************************
                         C      ;*               IX und IY  fuer Eingabekassette laden          *
                         C      ;****************************************************************
  F021    3A B25F        C      S9.RGLI:    LD      A,(S2.IM)
  F024    CB 4F          C                  BIT     1,A
  F026    20 05          C                  JR      NZ,S9.RGLI1
  F028    CD D5ED        C                  CALL    K1.RGL1
  F02B    18 03          C                  JR      S9.RGLI2
  F02D    CD D5FE        C      S9.RGLI1:   CALL    K1.RGL2
  F030    C9             C      S9.RGLI2:   RET
                         C      ;****************************************************************
                         C      ;*               IX und IY  fuer Ausgabekassette laden          *
                         C      ;****************************************************************
  F031    3A B260        C      S9.RGLO:    LD      A,(S2.OM)
  F034    CB 4F          C                  BIT     1,A
  F036    20 05          C                  JR      NZ,S9.RGLO1
  F038    CD D5ED        C                  CALL    K1.RGL1
  F03B    18 03          C                  JR      S9.RGLO2
  F03D    CD D5FE        C      S9.RGLO1:   CALL    K1.RGL2
  F040    C9             C      S9.RGLO2:   RET
                         C      
                         C                  TITLE   'Eingabedatei ==> Ausgabedatei'
                         C                  PAGE
'Eingabedatei ==> Ausgabedatei'	MACRO-80 3.44	09-Dec-81	PAGE	1-151


                         C      
                         C      ;****************************************************************
                         C      ;*               Kopieren der Eingabedatei in die Ausgabedatei  *
                         C      ;****************************************************************
  F041    3A B25F        C      S9.COPY:    LD      A,(S2.IM)           ;Eingabe eroeffnet
  F044    B7             C                  OR      A
  F045    CA EB4C        C                  JP      Z,S9.RIVF
  F048    3A B260        C                  LD      A,(S2.OM)           ;Ausgabe eroeffnet
  F04B    B7             C                  OR      A
  F04C    CA EBE7        C                  JP      Z,S9.WRTVF
                         C      
  F04F    2A B128        C      S9.COP1:    LD      HL,(K2.TXEND)       ;BC <== Laenge des belegten Puffers
  F052    01 B7E0        C                  LD      BC,S0.PFFI
  F055    B7             C                  OR      A
  F056    ED 42          C                  SBC     HL,BC
  F058    E5             C                  PUSH    HL
  F059    C1             C                  POP     BC
  F05A    21 B7E0        C                  LD      HL,S0.PFFI          ;HL <== Eingabepufferadresse
  F05D    78             C                  LD      A,B
  F05E    B1             C                  OR      C
  F05F    28 26          C                  JR      Z,S9.COP3
                         C      
  F061    E5             C      S9.COP5:    PUSH    HL                  ;Ausgabepuffer voll ?
  F062    C5             C                  PUSH    BC
  F063    2A B25B        C                  LD      HL,(S2.POIA)
  F066    01 BFF0        C                  LD      BC,S0.PFFA+400H
  F069    B7             C                  OR      A
  F06A    ED 42          C                  SBC     HL,BC
  F06C    20 06          C                  JR      NZ,S9.COP8
  F06E    CD F031        C                  CALL    S9.RGLO             ;Ja / Ausgabe des Pufferinhaltes
  F071    CD DB29        C      S9.COP7:    CALL    K1.AUS
  F074    C1             C      S9.COP8:    POP     BC
  F075    E1             C                  POP     HL
  F076    7E             C                  LD      A,(HL)              ;A  <== naechstes Zeichen
  F077    E5             C                  PUSH    HL
  F078    2A B25B        C                  LD      HL,(S2.POIA)        ;A  ==> Ausgabepuffer
  F07B    77             C                  LD      (HL),A
  F07C    23             C                  INC     HL
  F07D    22 B25B        C                  LD      (S2.POIA),HL
  F080    E1             C                  POP     HL
  F081    23             C                  INC     HL
  F082    0B             C                  DEC     BC
  F083    78             C                  LD      A,B
  F084    B1             C                  OR      C
  F085    20 DA          C                  JR      NZ,S9.COP5          ;weiter mit naechstem Eingabezeichen
                         C      
  F087    CD F021        C      S9.COP3:    CALL    S9.RGLI             ;IX , IY  entspr. Eingabegeraet
  F08A    CD D5CE        C                  CALL    K1.BM               ;Bandmarke erreicht ?
  F08D    28 08          C                  JR      Z,S9.COP2           ;Ja
                         C      
  F08F    01 0400        C                  LD      BC,400H             ;naechste Datenbloecke einlesen
  F092    CD DAF0        C                  CALL    K1.EIN
  F095    18 B8          C                  JR      S9.COP1
                         C      
  F097    CD D780        C      S9.COP2:    CALL    K1.GNRM
  F09A    CD D6B1        C                  CALL    K1.GNSTS
  F09D    C3 B403        C      S9.COP9:    JP      0B403H
                         C      
                         C                  TITLE   'Anfang von Grafikerw.'
                         C                  PAGE
'Anfang von Grafikerw.'	MACRO-80 3.44	09-Dec-81	PAGE	1-152


                         C      
                         C      ;****************************************************************
                         C      ;*               Anfang von Grafikerweiterungs-UPs              *
                         C      ;****************************************************************
                         C      ;ABGUP: INC  SP
                         C      ;      INC  SP
                         C      ;      CALL SAVE
                         C      ;      CALL AUP
                         C      ;      PUSH IX
                         C      ;      POP  IY
                         C      ;GB1:   LD   A,B
                         C      ;      OR   C
                         C      ;      JRZ  GB2-#
                         C      ;      INC  IY
                         C      ;      INC  IY
                         C      ;      DEC  BC
                         C      ;      JR   GB1-#
                         C      ;GB2:   LD   A,(IY-2)
                         C      ;      CMP  0
                         C      ;      JRZ  RBAUP-#
                         C      ;      JMP  RBAUP              ;Adresse im ersten 100H-Bereich
                         C      
                         C                  TITLE   'Anfang und Ende von Assemblererw.'
                         C                  PAGE
'Anfang und Ende von Assemblererw.'	MACRO-80 3.44	09-Dec-81	PAGE	1-153


                         C      
                         C      ;****************************************************************
                         C      ;*               Anfang von Assemblererweiterungs-UPs           *
                         C      ;****************************************************************
  F0A0    33             C      S9.ABAUP:   INC     SP
  F0A1    33             C                  INC     SP
  F0A2    CD EE58        C                  CALL    S9.SAVE
  F0A5    CD F0D6        C                  CALL    S9.AUP
  F0A8    DD E5          C                  PUSH    IX
  F0AA    FD E1          C                  POP     IY
  F0AC    78             C      S9.AB1:     LD      A,B
  F0AD    B1             C                  OR      C
  F0AE    28 07          C                  JR      Z,S9.AB2
  F0B0    FD 23          C                  INC     IY
  F0B2    FD 23          C                  INC     IY
  F0B4    0B             C                  DEC     BC
  F0B5    18 F5          C                  JR      S9.AB1
  F0B7    FD 7E FE       C      S9.AB2:     LD      A,(IY-2)
  F0BA    FE 00          C                  CP      0
  F0BC    C2 F53A        C                  JP      NZ,S4.UM16          ;SVC &1i,...
  F0BF    21 F0FD        C                  LD      HL,S9.ADRTB
  F0C2    7E             C      S9.AB3:     LD      A,(HL)
  F0C3    47             C                  LD      B,A
  F0C4    23             C                  INC     HL
  F0C5    FD 7E FC       C                  LD      A,(IY-4)
  F0C8    BE             C      S9.AB0:     CP      (HL)
  F0C9    23             C                  INC     HL
  F0CA    5E             C                  LD      E,(HL)
  F0CB    23             C                  INC     HL
  F0CC    56             C                  LD      D,(HL)
  F0CD    23             C                  INC     HL
  F0CE    28 04          C                  JR      Z,S9.AB01
  F0D0    10 F6          C                  DJNZ    S9.AB0
  F0D2    18 0B          C                  JR      S9.RBAUP
  F0D4    D5             C      S9.AB01:    PUSH    DE
  F0D5    C9             C                  RET
                         C      
  F0D6    DD 2A AFFC     C      S9.AUP:     LD      IX,(S0.STACK-2)
  F0DA    DD 23          C                  INC     IX
  F0DC    DD 23          C                  INC     IX
  F0DE    C9             C                  RET
                         C      ;****************************************************************
                         C      ;*               Ende der Assemblererweiterungs-UPs             *
                         C      ;****************************************************************
  F0DF    CD F539        C      S9.RBAUP:   CALL    S4.UM6+6
  F0E2    CD F0E9        C                  CALL    S9.RUP
  F0E5    CD EE78        C                  CALL    S9.LOAD
  F0E8    C9             C                  RET
                         C      
  F0E9    2A AFFC        C      S9.RUP:     LD      HL,(S0.STACK-2)
  F0EC    ED 4B AFF8     C                  LD      BC,(S0.STACK-6)
  F0F0    78             C      S9.RBP1:    LD      A,B
  F0F1    B1             C                  OR      C
  F0F2    28 05          C                  JR      Z,S9.RBP2
  F0F4    23             C                  INC     HL
  F0F5    23             C                  INC     HL
  F0F6    0B             C                  DEC     BC
  F0F7    18 F7          C                  JR      S9.RBP1
  F0F9    22 AFFC        C      S9.RBP2:    LD      (S0.STACK-2),HL
  F0FC    C9             C                  RET
                         C      
                         C                  TITLE   'Adresstabelle der Systemanschlussroutinen'
                         C                  PAGE
'Adresstabelle der Systemanschlussroutinen'	MACRO-80 3.44	09-Dec-81	PAGE	1-154


                         C      
                         C      ;****************************************************************
                         C      ;*               Adresstabelle der B A S I C -Anschlussroutinen *
                         C      ;****************************************************************
  F0FD    3C             C      S9.ADRTB:   DB      60                  ;Anzahl der Routinen
                         C      
  F0FE    00             C                  DB      0
  F0FF    F235           C                  DW      S9.ALLUP
                         C      
  F101    01             C                  DB      1
  F102    F249           C                  DW      S9.MEMO
                         C      
  F104    02             C                  DB      2
  F105    F269           C                  DW      S9.BLD
                         C      
  F107    03             C                  DB      3
  F108    F26E           C                  DW      S9.BC1
                         C      
  F10A    04             C                  DB      4
  F10B    F273           C                  DW      S9.AP
                         C      
  F10D    05             C                  DB      5
  F10E    F37D           C                  DW      S9.NPOS
                         C      
  F110    06             C                  DB      6
  F111    F36D           C                  DW      S9.APOS
                         C      
  F113    07             C                  DB      7
  F114    F3A2           C                  DW      S9.NFENS
                         C      
  F116    08             C                  DB      8
  F117    F3B6           C                  DW      S9.SFENS
                         C      
  F119    09             C                  DB      9
  F11A    F398           C                  DW      S9.CPOS
                         C      
  F11C    0A             C                  DB      10
  F11D    F53A           C                  DW      S4.SVC10
                         C      
  F11F    0B             C                  DB      11
  F120    F0DF           C                  DW      S9.RBAUP
                         C      
  F122    0C             C                  DB      12
  F123    F364           C                  DW      S9.CONO
                         C      
  F125    0D             C                  DB      13
  F126    F3CE           C                  DW      S9.SVC13
                         C      
  F128    0E             C                  DB      14
  F129    F486           C                  DW      S9.SVC14
                         C      
  F12B    0F             C                  DB      15
  F12C    F353           C                  DW      S9.ICON
                         C      
  F12E    10             C                  DB      16
  F12F    F358           C                  DW      S9.OCON
                         C      
  F131    11             C                  DB      17
  F132    F3D6           C                  DW      S9.SVC17
                         C      
  F134    12             C                  DB      18
  F135    F3DE           C                  DW      S9.SVC18
                         C      
  F137    13             C                  DB      19
  F138    F497           C                  DW      S9.SVC19
                         C      
  F13A    14             C                  DB      20
  F13B    EED2           C                  DW      S9.OPEN1
                         C      
  F13D    15             C                  DB      21
  F13E    EE99           C                  DW      S9.ROP1
                         C      
  F140    16             C                  DB      22
  F141    F2CB           C                  DW      S9.MRIO
                         C      
  F143    17             C                  DB      23
  F144    F2DC           C                  DW      S9.MRAO
                         C      
  F146    18             C                  DB      24
  F147    EFE9           C                  DW      S9.READ1
                         C      
  F149    19             C                  DB      25
'Adresstabelle der Systemanschlussroutinen'	MACRO-80 3.44	09-Dec-81	PAGE	1-155


  F14A    EFFA           C                  DW      S9.READ2
                         C      
  F14C    1A             C                  DB      26
  F14D    F013           C                  DW      S9.WRIT1
                         C      
  F14F    1B             C                  DB      27
  F150    F4C4           C                  DW      S9.SVC27
                         C      
  F152    1C             C                  DB      28
  F153    F041           C                  DW      S9.COPY
                         C      
  F155    1D             C                  DB      29
  F156    EF73           C                  DW      S9.CLOS1
                         C      
  F158    1E             C                  DB      30
  F159    EFC0           C                  DW      S9.RCL1
                         C      
  F15B    1F             C                  DB      31
  F15C    F2ED           C                  DW      S9.MRAC
                         C      
  F15E    20             C                  DB      32
  F15F    F4A8           C                  DW      S9.SVC32
                         C      
  F161    21             C                  DB      33
  F162    F4AE           C                  DW      S9.SVC33
                         C      
  F164    27             C                  DB      39
  F165    F520           C                  DW      S9.SVC39
                         C      
  F167    28             C                  DB      40
  F168    F30F           C                  DW      S9.SPAUS
                         C      
  F16A    29             C                  DB      41
  F16B    F321           C                  DW      S9.SPI
                         C      
  F16D    2A             C                  DB      42
  F16E    F32F           C                  DW      S9.SPO
                         C      
  F170    2B             C                  DB      43
  F171    F441           C                  DW      S9.SVC43
                         C      
  F173    2C             C                  DB      44
  F174    F458           C                  DW      S9.SVC44
                         C      
  F176    2D             C                  DB      45
  F177    F3BB           C                  DW      S9.IOC
                         C      
  F179    2E             C                  DB      46
  F17A    F3C6           C                  DW      S9.TAS0
                         C      
  F17C    2F             C                  DB      47
  F17D    F1B2           C                  DW      S9.HCP
                         C      
  F17F    32             C                  DB      50
  F180    F278           C                  DW      S9.AL
                         C      
  F182    33             C                  DB      51
  F183    F2A5           C                  DW      S9.RL
                         C      
  F185    34             C                  DB      52
  F186    F53A           C                  DW      S4.SVC52
                         C      
  F188    3C             C                  DB      60
  F189    F53A           C                  DW      S4.SVC60
                         C      
  F18B    3D             C                  DB      61
  F18C    F53A           C                  DW      S4.SVC61
                         C      
  F18E    3E             C                  DB      62
  F18F    F53A           C                  DW      S4.SVC62
                         C      
  F191    3F             C                  DB      63
  F192    F53A           C                  DW      S4.SVC63
                         C      
  F194    40             C                  DB      64
  F195    F53A           C                  DW      S4.SVC64
                         C      
  F197    41             C                  DB      65
  F198    F53A           C                  DW      S4.SVC65
                         C      
  F19A    42             C                  DB      66
  F19B    F53A           C                  DW      S4.SVC66
                         C      
'Adresstabelle der Systemanschlussroutinen'	MACRO-80 3.44	09-Dec-81	PAGE	1-156


  F19D    46             C                  DB      70
  F19E    F53A           C                  DW      S4.SC700
                         C      
  F1A0    47             C                  DB      71
  F1A1    F53A           C                  DW      S4.SC710
                         C      
  F1A3    48             C                  DB      72
  F1A4    F53A           C                  DW      S4.SC720
                         C      
  F1A6    49             C                  DB      73
  F1A7    F53A           C                  DW      S4.SC730
                         C      
  F1A9    4A             C                  DB      74
  F1AA    F53A           C                  DW      S4.SC740
                         C      
  F1AC    4B             C                  DB      75
  F1AD    F53A           C                  DW      S4.SC750
                         C      
  F1AF    4C             C                  DB      76
  F1B0    F53A           C                  DW      S4.SC760
                         C      
                         C      
                         C                  TITLE   'Anschlussroutinen'
                         C                  PAGE
'Anschlussroutinen'	MACRO-80 3.44	09-Dec-81	PAGE	1-157


                         C      
  F1B2    DD 7E 00       C      S9.HCP:     LD      A,(IX+0)            ;Ausgabe eines HARDCOPY auf LIST-Device
  F1B5    32 B199        C                  LD      (MS.TK),A           ;Parameterwert zwischenspeichern
  F1B8    CD F539        C                  CALL    S4.UM6+6            ;entspr.  "RBAUP"
  F1BB    CD F0E9        C                  CALL    S9.RUP              ;  "         "
  F1BE    CD EE78        C                  CALL    S9.LOAD             ;  "         "
  F1C1    F5             C                  PUSH    AF
  F1C2    C5             C                  PUSH    BC
  F1C3    D5             C                  PUSH    DE
  F1C4    E5             C                  PUSH    HL
  F1C5    3A B199        C                  LD      A,(MS.TK)
  F1C8    FE 02          C                  CP      2                   ;aktuelles Bildfenster
  F1CA    28 24          C                  JR      Z,S9.HCP2
  F1CC    FE 01          C                  CP      1                   ;Zeile 1 bis 24
  F1CE    28 08          C                  JR      Z,S9.HCP1
  F1D0    FE 00          C                  CP      0                   ;Zeile 1 bis 22
  F1D2    20 51          C                  JR      NZ,S9.HCPE
  F1D4    06 16          C                  LD      B,22
  F1D6    18 02          C                  JR      S9.HCP11
                         C      
  F1D8    06 18          C      S9.HCP1:    LD      B,24
  F1DA    2A B194        C      S9.HCP11:   LD      HL,(MS.BWSA)
  F1DD    C5             C      S9.HCP12:   PUSH    BC
  F1DE    06 50          C                  LD      B,80
  F1E0    7E             C      S9.HCP13:   LD      A,(HL)
  F1E1    4F             C                  LD      C,A
  F1E2    23             C                  INC     HL
  F1E3    CD 0315        C                  CALL    BC.LISTX
  F1E6    10 F8          C                  DJNZ    S9.HCP13
  F1E8    CD F22A        C                  CALL    S9.CR
  F1EB    C1             C                  POP     BC
  F1EC    10 EF          C                  DJNZ    S9.HCP12
  F1EE    18 2F          C                  JR      S9.HCP3
                         C      
  F1F0    2A B190        C      S9.HCP2:    LD      HL,(MS.ZMAX)
  F1F3    ED 4B B18E     C                  LD      BC,(MS.ZMIN)
  F1F7    B7             C                  OR      A
  F1F8    ED 42          C                  SBC     HL,BC
  F1FA    45             C                  LD      B,L
  F1FB    04             C                  INC     B
  F1FC    C5             C                  PUSH    BC                  ;Anzahl Fensterzeilen
  F1FD    7C             C                  LD      A,H
  F1FE    3C             C                  INC     A
  F1FF    32 B199        C                  LD      (MS.TK),A           ;Anzahl Fensterspalten
  F202    CD CF40        C                  CALL    MO.BWSAF
  F205    C1             C                  POP     BC
  F206    C5             C      S9.HCP21:   PUSH    BC
  F207    E5             C                  PUSH    HL
  F208    3A B199        C                  LD      A,(MS.TK)
  F20B    47             C                  LD      B,A
  F20C    7E             C      S9.HCP22:   LD      A,(HL)
  F20D    4F             C                  LD      C,A
  F20E    23             C                  INC     HL
  F20F    CD 0315        C                  CALL    BC.LISTX
  F212    10 F8          C                  DJNZ    S9.HCP22
  F214    E1             C                  POP     HL
  F215    01 0050        C                  LD      BC,80
  F218    09             C                  ADD     HL,BC
  F219    CD F22A        C                  CALL    S9.CR
  F21C    C1             C                  POP     BC
  F21D    10 E7          C                  DJNZ    S9.HCP21
  F21F    CD F22A        C      S9.HCP3:    CALL    S9.CR
  F222    CD F22A        C                  CALL    S9.CR
  F225    E1             C      S9.HCPE:    POP     HL
  F226    D1             C                  POP     DE
  F227    C1             C                  POP     BC
  F228    F1             C                  POP     AF
  F229    C9             C                  RET
                         C      
  F22A    0E 0D          C      S9.CR:      LD      C,00DH
  F22C    CD 0315        C                  CALL    BC.LISTX
  F22F    0E 0A          C                  LD      C,00AH
  F231    CD 0315        C                  CALL    BC.LISTX
  F234    C9             C                  RET
                         C      
                         C                  PAGE
'Anschlussroutinen'	MACRO-80 3.44	09-Dec-81	PAGE	1-158


                         C      
  F235    DD 7E 02       C      S9.ALLUP:   LD      A,(IX+2)            ;Aufruf eines allg. Assembler-UP
  F238    DD 66 01       C                  LD      H,(IX+1)
  F23B    DD 6E 00       C                  LD      L,(IX+0)
  F23E    FE 00          C                  CP      0
  F240    C4 F539        C                  CALL    NZ,S4.UM15          ;SVC 0,0, [... ,] &1i,adresse
  F243    CD D2CA        C                  CALL    TA.MM               ;SVC 0,0, [... ,] 0  ,adresse
  F246    C3 B403        C      S9.ALUP1:   JP      0B403H
                         C      
  F249    DD 66 01       C      S9.MEMO:    LD      H,(IX+1)            ;Speicheranzeige  16*16  Byte
  F24C    DD 6E 00       C                  LD      L,(IX+0)
  F24F    DD 7E 02       C                  LD      A,(IX+2)
  F252    22 B292        C                  LD      (S2.DMANF),HL
  F255    FE 00          C                  CP      0
  F257    C4 F539        C                  CALL    NZ,S4.UM15
  F25A    CD C92F        C                  CALL    S1.MEA
  F25D    18 E7          C                  JR      S9.ALUP1
                         C      
  F25F    33             C      S9.BLD1:    INC     SP                  ;gesamtes Bild loeschen
  F260    33             C                  INC     SP
  F261    CD EE58        C                  CALL    S9.SAVE
  F264    CD CBFE        C                  CALL    MO.BILO
  F267    18 DD          C                  JR      S9.ALUP1
                         C      
  F269    CD CC14        C      S9.BLD:     CALL    MO.FSLO             ;Bildfenster loeschen
  F26C    18 D8          C                  JR      S9.ALUP1
                         C      
  F26E    CD F5CF        C      S9.BC1:     CALL    S0.BWSUS            ;Copy  BWSA ==> BWS
  F271    18 D3          C                  JR      S9.ALUP1
                         C      
  F273    CD E5D8        C      S9.AP:      CALL    S9.ANFG             ;BASIC-Anfangsprogramm laden
  F276                   C      S9.SC52E    EQU     $
  F276    18 CE          C      S9.AP1:     JR      S9.ALUP1
                         C      
                         C                  PAGE
'Anschlussroutinen'	MACRO-80 3.44	09-Dec-81	PAGE	1-159


                         C      
  F278    DD 7E 02       C      S9.AL:      LD      A,(IX+2)            ;Segment            absoluter Loader
  F27B    F5             C                  PUSH    AF
  F27C    DD 7E 00       C                  LD      A,(IX+0)            ;Geraet
  F27F    CD F024        C                  CALL    S9.RGLI+3
  F282    CD F2F5        C                  CALL    S9.MRPAR
  F285    F1             C                  POP     AF
  F286    FE 00          C                  CP      0
  F288    28 06          C                  JR      Z,S9.AL3
  F28A    CD F539        C                  CALL    S4.UM15
  F28D    CD F539        C                  CALL    S4.BWS
  F290    CD E0C9        C      S9.AL3:     CALL    LO.AL
  F293    F5             C      S9.AL2:     PUSH    AF
  F294    21 F5F9        C                  LD      HL,S0.BWSB
  F297    11 B2D4        C                  LD      DE,S2.STACK
  F29A    01 000A        C                  LD      BC,S0.BASCL-S0.BWSB
  F29D    ED B0          C                  LDIR
  F29F    F1             C                  POP     AF
  F2A0    C2 DF0F        C                  JP      NZ,LO.LO13
  F2A3    18 D1          C      S9.AL1:     JR      S9.SC52E
                         C      
  F2A5    DD 6E 00       C      S9.RL:      LD      L,(IX+0)            ;Ladeanfangsadresse relativer Loader
  F2A8    DD 66 01       C                  LD      H,(IX+1)
  F2AB    22 B265        C                  LD      (S2.PRGN),HL
  F2AE    DD 7E 04       C                  LD      A,(IX+4)            ;Segment
  F2B1    F5             C                  PUSH    AF
  F2B2    DD 7E 02       C                  LD      A,(IX+2)            ;Geraet
  F2B5    CD F024        C                  CALL    S9.RGLI+3
  F2B8    CD F2F5        C                  CALL    S9.MRPAR
  F2BB    F1             C                  POP     AF
  F2BC    FE 00          C                  CP      0
  F2BE    28 06          C                  JR      Z,S9.RL1
  F2C0    CD F539        C                  CALL    S4.UM15
  F2C3    CD F539        C                  CALL    S4.BWS
  F2C6    CD E0FA        C      S9.RL1:     CALL    LO.RL
  F2C9    18 C8          C                  JR      S9.AL2
                         C      
  F2CB    DD 7E 00       C      S9.MRIO:    LD      A,(IX+0)            ;MRES Eingabe-Eroeffnung
  F2CE    32 B25F        C                  LD      (S2.IM),A
  F2D1    CD F024        C                  CALL    S9.RGLI+3
  F2D4    CD F2F5        C                  CALL    S9.MRPAR
  F2D7    CD DBE4        C                  CALL    K1.MREPO
  F2DA    18 B7          C                  JR      S9.AL2
                         C      
  F2DC    DD 7E 00       C      S9.MRAO:    LD      A,(IX+0)            ;MRES Ausgabe-Eroeffnung
  F2DF    32 B260        C                  LD      (S2.OM),A
  F2E2    CD F034        C                  CALL    S9.RGLO+3
  F2E5    CD F2F5        C                  CALL    S9.MRPAR
  F2E8    CD DC26        C                  CALL    K1.MRAPO
  F2EB    18 A6          C                  JR      S9.AL2
                         C      
  F2ED    CD F031        C      S9.MRAC:    CALL    S9.RGLO             ;MRES Ausgabe-Abschluss
  F2F0    CD DC83        C                  CALL    K1.MRCLS
  F2F3    18 AE          C                  JR      S9.AL1
                         C      
                         C      
  F2F5    DD E5          C      S9.MRPAR:   PUSH    IX                  ;MRES-Parameter uebernehmen
  F2F7    FD E5          C                  PUSH    IY
  F2F9    FD E5          C                  PUSH    IY
  F2FB    26 53          C                  LD      H,'S'
  F2FD    2E D9          C                  LD      L,59H+80H
  F2FF    CD EE40        C                  CALL    S9.NSTR
  F302    28 00          C                  JR      Z,S9.MR1
  F304    D1             C      S9.MR1:     POP     DE
  F305    01 000E        C                  LD      BC,14
  F308    ED B0          C                  LDIR
  F30A    FD E1          C                  POP     IY
  F30C    DD E1          C                  POP     IX
  F30E    C9             C                  RET
                         C      
                         C                  PAGE
'Anschlussroutinen'	MACRO-80 3.44	09-Dec-81	PAGE	1-160


                         C      
  F30F    CD F5E9        C      S9.SPAUS:   CALL    S0.BWSU1            ;B W S  ===>  B W S A
  F312    21 E657        C                  LD      HL,S9.CIN
  F315    01 E6A6        C                  LD      BC,S9.CON
  F318    22 030A        C      S9.SPA:     LD      (BC.CIN+1),HL
  F31B    ED 43 0310     C                  LD      (BC.CON+1),BC
  F31F    18 49          C                  JR      S9.CONOO
                         C      
  F321    2A B194        C      S9.SPI:     LD      HL,(MS.BWSA)
  F324    22 B292        C                  LD      (S2.DMANF),HL
  F327    21 F33D        C                  LD      HL,S9.SPIN
  F32A    01 ECBC        C                  LD      BC,S9.IOX
  F32D    18 E9          C                  JR      S9.SPA
                         C      
  F32F    2A B194        C      S9.SPO:     LD      HL,(MS.BWSA)
  F332    22 B292        C                  LD      (S2.DMANF),HL
  F335    21 ECBC        C                  LD      HL,S9.IOX
  F338    01 F348        C                  LD      BC,S9.SPOUT
  F33B    18 DB          C                  JR      S9.SPA
                         C      
  F33D    E5             C      S9.SPIN:    PUSH    HL
  F33E    2A B292        C                  LD      HL,(S2.DMANF)
  F341    7E             C                  LD      A,(HL)
  F342    23             C                  INC     HL
  F343    22 B292        C                  LD      (S2.DMANF),HL
  F346    E1             C                  POP     HL
  F347    C9             C                  RET
                         C      
  F348    E5             C      S9.SPOUT:   PUSH    HL
  F349    2A B292        C                  LD      HL,(S2.DMANF)
  F34C    71             C                  LD      (HL),C
  F34D    23             C                  INC     HL
  F34E    22 B292        C                  LD      (S2.DMANF),HL
  F351    E1             C                  POP     HL
  F352    C9             C                  RET
                         C      
  F353    21 B41E        C      S9.ICON:    LD      HL,0B41EH
  F356    18 03          C                  JR      $+5
  F358    21 B420        C      S9.OCON:    LD      HL,0B420H
  F35B    36 FF          C                  LD      (HL),-1
  F35D    DD 7E 00       C                  LD      A,(IX+0)
  F360    23             C                  INC     HL
  F361    77             C                  LD      (HL),A
  F362    18 06          C                  JR      S9.CONOO
                         C      
                         C                  PAGE
'Anschlussroutinen'	MACRO-80 3.44	09-Dec-81	PAGE	1-161


                         C      
  F364    21 E6D9        C      S9.CONO:    LD      HL,S9.CONOC
  F367    22 0310        C                  LD      (BC.CON+1),HL
  F36A    C3 B403        C      S9.CONOO:   JP      0B403H
                         C      
  F36D    2A B19C        C      S9.APOS:    LD      HL,(MS.MCZ)         ;alte Position rueckspeichern
  F370    22 B18C        C      S9.APOS1:   LD      (MS.ZPOS),HL
  F373    3E 06          C                  LD      A,6                 ;Cursor setzen
  F375    32 B198        C                  LD      (MS.CMD),A
  F378    CD CB10        C                  CALL    MO.MONI
  F37B    18 ED          C                  JR      S9.CONOO
                         C      
  F37D    3E 07          C      S9.NPOS:    LD      A,7                 ;Cursor loeschen
  F37F    32 B198        C                  LD      (MS.CMD),A
  F382    CD CB10        C                  CALL    MO.MONI
  F385    2A B18C        C                  LD      HL,(MS.ZPOS)        ;alte Position retten
  F388    22 B19C        C                  LD      (MS.MCZ),HL
  F38B    DD 66 00       C                  LD      H,(IX+0)            ;neue Position uebernehmen
  F38E    DD 6E 02       C                  LD      L,(IX+2)
  F391    25             C                  DEC     H
  F392    2D             C                  DEC     L
  F393    22 B18C        C                  LD      (MS.ZPOS),HL
  F396    18 D2          C                  JR      S9.CONOO
                         C      
  F398    DD 66 00       C      S9.CPOS:    LD      H,(IX+0)            ;neue Position uebernehmen
  F39B    DD 6E 02       C                  LD      L,(IX+2)
  F39E    25             C                  DEC     H
  F39F    2D             C                  DEC     L
  F3A0    18 CE          C                  JR      S9.APOS1
                         C      
  F3A2    DD 66 02       C      S9.NFENS:   LD      H,(IX+2)            ;zmin , zmax , smin , smax
  F3A5    DD 6E 06       C                  LD      L,(IX+6)            ;7 6    5 4    3 2    1 0
  F3A8    22 B18E        C                  LD      (MS.ZMIN),HL
  F3AB    DD 66 00       C                  LD      H,(IX+0)
  F3AE    DD 6E 04       C                  LD      L,(IX+4)
  F3B1    22 B190        C                  LD      (MS.ZMAX),HL
  F3B4    18 B4          C                  JR      S9.CONOO
                         C      
  F3B6    CD CBDE        C      S9.SFENS:   CALL    MO.VB2
  F3B9    18 AF          C                  JR      S9.CONOO
                         C      
  F3BB    DD 7E 00       C      S9.IOC:     LD      A,(IX+0)            ;Umschalter  I O C
  F3BE    32 B264        C                  LD      (S2.IOC),A
  F3C1    CD C67C        C      S9.IOC1:    CALL    S1.STAT
  F3C4    18 A4          C      S9.TAS01:   JR      S9.CONOO
                         C      
  F3C6    DD 7E 00       C      S9.TAS0:    LD      A,(IX+0)            ;Umschalter  P/S - T A S
  F3C9    32 B241        C                  LD      (TS.KGMER),A
  F3CC    18 F3          C                  JR      S9.IOC1
                         C      
  F3CE    DD 7E 00       C      S9.SVC13:   LD      A,(IX+0)            ;setzen von  MS.DIRES
  F3D1    32 B197        C                  LD      (MS.DIRES),A
  F3D4    18 EE          C                  JR      S9.TAS01
                         C      
                         C                  PAGE
'Anschlussroutinen'	MACRO-80 3.44	09-Dec-81	PAGE	1-162


                         C      
  F3D6    21 EBDE        C      S9.SVC17:   LD      HL,S9.WRTV          ;L-Device als Kassettenausgabe
  F3D9    22 0316        C                  LD      (00316H),HL
  F3DC    18 E6          C                  JR      S9.TAS01
                         C      
  F3DE    DD 7E 00       C      S9.SVC18:   LD      A,(IX+0)            ;MRES-Verzeichniseintr. uebermitteln
  F3E1    F5             C                  PUSH    AF
  F3E2    DD 7E 02       C                  LD      A,(IX+2)
  F3E5    32 B25F        C                  LD      (S2.IM),A
  F3E8    CD F024        C                  CALL    S9.RGLI+3
  F3EB    F1             C                  POP     AF
  F3EC    FE 02          C                  CP      2
  F3EE    28 1C          C                  JR      Z,S9.SC181
  F3F0    FE 01          C                  CP      1
  F3F2    20 D0          C                  JR      NZ,S9.TAS01
  F3F4    CD D708        C                  CALL    K1.GNRE             ;Par=1  OPEN
  F3F7    CD D740        C                  CALL    K1.GNRW
  F3FA    16 02          C                  LD      D,2
  F3FC    CD D7B3        C                  CALL    K1.GNLPN
  F3FF    CD D85B        C                  CALL    K1.GNRD
  F402    CD D85B        C                  CALL    K1.GNRD
  F405    3A B017        C                  LD      A,(KS.PUFFS+4)
  F408    3D             C                  DEC     A
  F409    32 B261        C                  LD      (S2.VZM),A
  F40C    3A B261        C      S9.SC181:   LD      A,(S2.VZM)          ;Par=2  READ
  F40F    3D             C                  DEC     A
  F410    32 B261        C                  LD      (S2.VZM),A
  F413    FE FF          C                  CP      0FFH
  F415    28 17          C                  JR      Z,S9.SC183
  F417    CD D85B        C                  CALL    K1.GNRD
  F41A    26 53          C      S9.SC184:   LD      H,'S'
  F41C    2E D9          C                  LD      L,59H+80H
  F41E    CD EE40        C                  CALL    S9.NSTR
  F421    28 A1          C                  JR      Z,S9.TAS01
  F423    EB             C                  EX      DE,HL
  F424    21 B014        C                  LD      HL,KS.PUFFS+1
  F427    01 0017        C                  LD      BC,23
  F42A    ED B0          C                  LDIR
  F42C    18 96          C      S9.SC182:   JR      S9.TAS01
  F42E    3C             C      S9.SC183:   INC     A
  F42F    32 B261        C                  LD      (S2.VZM),A
  F432    21 B014        C                  LD      HL,KS.PUFFS+1
  F435    11 B015        C                  LD      DE,KS.PUFFS+2
  F438    01 000D        C                  LD      BC,13
  F43B    36 20          C                  LD      (HL),' '
  F43D    ED B0          C                  LDIR
  F43F    18 D9          C                  JR      S9.SC184
                         C      
                         C                  PAGE
'Anschlussroutinen'	MACRO-80 3.44	09-Dec-81	PAGE	1-163


                         C      
  F441    3A B25F        C      S9.SVC43:   LD      A,(S2.IM)           ;Eingabedatei an Anfang pos.
  F444    B7             C                  OR      A
  F445    CA EB4C        C                  JP      Z,S9.RIVF
  F448    CD F024        C                  CALL    S9.RGLI+3
  F44B    16 00          C                  LD      D,0
  F44D    CD D5CE        C                  CALL    K1.BM
  F450    20 01          C                  JR      NZ,$+3
  F452    14             C                  INC     D
  F453    CD D7EB        C                  CALL    K1.GNLMN
  F456    18 D4          C                  JR      S9.SC182
                         C      
  F458    DD 7E 00       C      S9.SVC44:   LD      A,(IX+0)            ;Umschalter ON-/IN- KEY
  F45B    FE 01          C                  CP      1
  F45D    28 0E          C                  JR      Z,S9.SC441
  F45F    FE 02          C                  CP      2
  F461    28 0F          C                  JR      Z,S9.SC442
  F463    21 ECBD        C                  LD      HL,S9.USER
  F466    3E C3          C                  LD      A,0C3H
  F468    11 E68B        C                  LD      DE,S9.CSTSX
  F46B    18 0D          C                  JR      S9.SC444
  F46D    21 ED09        C      S9.SC441:   LD      HL,S9.USER2
  F470    18 03          C                  JR      S9.SC443
  F472    21 ED5A        C      S9.SC442:   LD      HL,S9.USER3
  F475    3E AF          C      S9.SC443:   LD      A,0AFH
  F477    11 00C9        C                  LD      DE,000C9H
  F47A    22 0307        C      S9.SC444:   LD      (BC.USR+1),HL
  F47D    32 0318        C                  LD      (BC.CSTSX),A
  F480    ED 53 0319     C                  LD      (BC.CSTSX+1),DE
  F484    18 A6          C      S9.SC449:   JR      S9.SC182
                         C      
  F486    DD 7E 00       C      S9.SVC14:   LD      A,(IX+0)            ;HOME-Taste ein-/aus- schalten
  F489    B7             C                  OR      A
  F48A    20 04          C                  JR      NZ,$+6
  F48C    3E C9          C                  LD      A,0C9H
  F48E    18 02          C                  JR      $+4
  F490    3E C3          C                  LD      A,0C3H
  F492    32 B415        C                  LD      (0B415H),A
  F495    18 ED          C                  JR      S9.SC449
                         C      
                         C                  PAGE
'Anschlussroutinen'	MACRO-80 3.44	09-Dec-81	PAGE	1-164


                         C      
  F497    3A B25F        C      S9.SVC19:   LD      A,(S2.IM)           ;Eingabegeraet aktiv JA/NEIN ?
  F49A    B7             C                  OR      A
  F49B    20 04          C                  JR      NZ,$+6
  F49D    3E 30          C                  LD      A,'0'
  F49F    18 02          C                  JR      $+4
  F4A1    3E 31          C                  LD      A,'1'
  F4A3    CD EE49        C                  CALL    S9.ERS
  F4A6    18 DC          C      S9.SC191:   JR      S9.SC449
                         C      
  F4A8    FD 21 B422     C      S9.SVC32:   LD      IY,0B422H           ;Eingabe-Kodetransformation ein
  F4AC    18 04          C                  JR      S9.SC331
                         C      
  F4AE    FD 21 B425     C      S9.SVC33:   LD      IY,0B425H           ;Ausgabe-Kodetransformation ein
  F4B2    DD 66 01       C      S9.SC331:   LD      H,(IX+1)
  F4B5    DD 6E 00       C                  LD      L,(IX+0)
  F4B8    FD 36 00 C3    C                  LD      (IY+0),0C3H
  F4BC    FD 75 01       C                  LD      (IY+1),L
  F4BF    FD 74 02       C                  LD      (IY+2),H
  F4C2    18 E2          C      S9.SC333:   JR      S9.SC191
                         C      
  F4C4    DD 7E 00       C      S9.SVC27:   LD      A,(IX+0)
  F4C7    FE 02          C                  CP      2
  F4C9    F5             C                  PUSH    AF
  F4CA    26 4B          C                  LD      H,'K'
  F4CC    2E D3          C                  LD      L,53H+80H
  F4CE    CD EE40        C                  CALL    S9.NSTR
  F4D1    28 4A          C                  JR      Z,S9.SC271
  F4D3    F1             C                  POP     AF
  F4D4    E5             C                  PUSH    HL
  F4D5    D5             C                  PUSH    DE
  F4D6    28 29          C                  JR      Z,S9.SC272
  F4D8    3A B25F        C                  LD      A,(S2.IM)           ;wert = 1  ...   Eingabe
  F4DB    B7             C                  OR      A
  F4DC    CA EF85        C                  JP      Z,S9.CLO2
  F4DF    C1             C                  POP     BC                  ;KS$="   "
  F4E0    0B             C                  DEC     BC
  F4E1    D1             C                  POP     DE
  F4E2    D5             C                  PUSH    DE
  F4E3    13             C                  INC     DE
  F4E4    36 20          C                  LD      (HL),' '
  F4E6    ED B0          C                  LDIR
  F4E8    CD F021        C                  CALL    S9.RGLI             ;Datenblock einlesen
  F4EB    CD DB0B        C                  CALL    K1.EINP
  F4EE    CD D5CE        C                  CALL    K1.BM
  F4F1    20 06          C                  JR      NZ,S9.SC273
  F4F3    CD EB9C        C                  CALL    S9.BM3
  F4F6    E1             C                  POP     HL
  F4F7    18 C9          C                  JR      S9.SC333
  F4F9    CD D5C1        C      S9.SC273:   CALL    K1.LHLBC            ;KS$= Datenblock
  F4FC    D1             C                  POP     DE
  F4FD    ED B0          C                  LDIR
  F4FF    18 17          C                  JR      S9.SC279
  F501    3A B25F        C      S9.SC272:   LD      A,(S2.IM)           ;wert = 2  ...   Ausgabe
  F504    B7             C                  OR      A
  F505    CA EF85        C                  JP      Z,S9.CLO2
  F508    CD F021        C                  CALL    S9.RGLI
  F50B    D1             C                  POP     DE
  F50C    CD D5C1        C                  CALL    K1.LHLBC
  F50F    C5             C                  PUSH    BC
  F510    CD D780        C                  CALL    K1.GNRM
  F513    C1             C                  POP     BC
  F514    E1             C                  POP     HL
  F515    CD D8EF        C                  CALL    K1.GNRWR
  F518    CD D6B1        C      S9.SC279:   CALL    K1.GNSTS
  F51B    18 A5          C                  JR      S9.SC333
  F51D    F1             C      S9.SC271:   POP     AF
  F51E    18 A2          C      S9.SC278:   JR      S9.SC333
                         C      
  F520    DD 7E 02       C      S9.SVC39:   LD      A,(IX+2)            ;Richtung
  F523    06 34          C                  LD      B,52
  F525    80             C                  ADD     A,B
  F526    32 B198        C                  LD      (MS.CMD),A
  F529    DD 46 00       C                  LD      B,(IX+0)            ;Anzahl Verschiebungen
  F52C    CD CB10        C      S9.SC391:   CALL    MO.MONI
  F52F    10 FB          C                  DJNZ    S9.SC391
  F531    18 EB          C      S9.SC399:   JR      S9.SC278
                         C      
                         C      
                         C      
                         C      ;           END
                         C      ;           PN      S424
'BASIC- SVC - Routinen fuer Speichererweiterung'	MACRO-80 3.44	09-Dec-81	PAGE	1-165


                         C                  TITLE   'BASIC- SVC - Routinen fuer Speichererweiterung'
                         C                  PAGE
'BASIC- SVC - Routinen fuer Speichererweiterung'	MACRO-80 3.44	09-Dec-81	PAGE	1-166


                         C      
                         C      ;****************************************************************
                         C      ;*               BASIC- SVC - Routinen fuer Speichererweiterung *
                         C      ;*  Version      -----------------------------------------------*
                         C      ;*               Programmierer: M. Herbote --- K EAW  ZFT (WFT) *
                         C      ;*  V 2 . 1      -----------------------------------------------*
                         C      ;*               Stand        : 14.Maerz 1985                   *
                         C      ;****************************************************************
                         C      
  0031                   C      S4.V1       EQU     '1'                 ;  1 ... ohne   Erweiterung
                         C                                              ;  8 ... mit    Erweiterung
                         C      
  0031                   C      S4.V2       EQU     '1'                 ;  1 ... DEG 2.i von Kassette
                         C                                              ;  2 ... DEG 2.i von EPROM
                         C      
  00C0                   C      S4.SBST     EQU     0C0H                ;Adresse der Speicherblockst.
                         C      
  00C0                   C      S4.U1       EQU     000C0H              ;Adresse der Umschalt-UP
  0040                   C      S4.U2       EQU     00040H              ;Adresse der Einzel  -UP
                         C      
                         C      
                         C                  IF      S4.V1 AND 1
  F533    0000           C      S4.UM6:     DW      0
  F535    0000           C                  DW      0
  F537    0000           C                  DW      0
  F539                   C      S4.BWS      EQU     $
  F539                   C      S4.BWS1     EQU     $
  F539                   C      S4.UM15     EQU     $
  F539    C9             C      S4.BSCN:    RET
                         C      
  F53A                   C      S4.SVC10    EQU     $
  F53A                   C      S4.SVC52    EQU     $
  F53A                   C      S4.SVC60    EQU     $
  F53A                   C      S4.SVC61    EQU     $
  F53A                   C      S4.SVC62    EQU     $
  F53A                   C      S4.SVC63    EQU     $
  F53A                   C      S4.SVC64    EQU     $
  F53A                   C      S4.SVC65    EQU     $
  F53A                   C      S4.SVC66    EQU     $
  F53A                   C      S4.SVC67    EQU     $
  F53A                   C      S4.SVC68    EQU     $
  F53A                   C      S4.SVC69    EQU     $
  F53A                   C      S4.SC700    EQU     $
  F53A                   C      S4.SC710    EQU     $
  F53A                   C      S4.SC720    EQU     $
  F53A                   C      S4.SC730    EQU     $
  F53A                   C      S4.SC740    EQU     $
  F53A                   C      S4.SC750    EQU     $
  F53A                   C      S4.SC760    EQU     $
  F53A    C3 B403        C      S4.UM16:    JP      0B403H
                         C      
  F53D    21 F5F9        C      S4.RES:     LD      HL,S0.BWSB
  F540    11 B2D4        C                  LD      DE,S2.STACK
  F543    01 000A        C                  LD      BC,S0.BASCL-S0.BWSB
  F546    ED B0          C                  LDIR
  F548    C3 C084        C                  JP      S1.RES1
                         C                  ENDIF
                         C      
                         C                  PAGE
'BASIC- SVC - Routinen fuer Speichererweiterung'	MACRO-80 3.44	09-Dec-81	PAGE	1-167


                         C      
                         C                  IF      S4.V1 AND 8
                         C      ;****************************************************************
                         C      ;*               T I M E R  -  Routine                          *
                         C      ;****************************************************************
                         C      S4.SVC10:   CALL    S4.TIM01
                         C                  JP      0B403H
                         C      
                         C      S4.TIM01:   PUSH    HL
                         C                  PUSH    BC
                         C                  PUSH    AF
                         C                  LD      A,S0.CTC0
                         C                  OUT     (C),080H
                         C                  LD      A,0A7H
                         C                  OUT     (C),080H
                         C                  LD      A,060H
                         C                  OUT     (C),080H
                         C                  LD      HL,S4.TIM1
                         C                  LD      B,4
                         C                  LD      (HL),0
                         C                  INC     HL
                         C                  DJNZ    $-3
                         C                  POP     AF
                         C                  POP     BC
                         C                  POP     HL
                         C                  RET
                         C      
                         C      S4.IRTIM:   PUSH    HL
                         C                  PUSH    AF
                         C                  LD      HL,S4.TIM4
                         C                  INC     (HL)
                         C                  LD      A,(HL)
                         C                  CP      064H
                         C                  JR      NZ,S4.TIM02
                         C                  LD      (HL),0
                         C                  DEC     HL
                         C                  INC     (HL)
                         C                  LD      A,(HL)
                         C                  CP      03CH
                         C      S4.TIM02:   JR      NZ,S4.TIM03
                         C                  LD      (HL),0
                         C                  DEC     HL
                         C                  INC     (HL)
                         C                  LD      A,(HL)
                         C                  CP      03CH
                         C      S4.TIM03:   JR      NZ,S4.TIM04
                         C                  LD      (HL),0
                         C                  DEC     HL
                         C                  INC     (HL)
                         C      S4.TIM04:   POP     AF
                         C                  POP     HL
                         C                  EI
                         C                  RETI
                         C      
                         C      S4.TIM1     EQU     0B2FCH
                         C      S4.TIM4     EQU     S4.TIM1+3
                         C      
                         C                  PAGE
                         C      ;****************************************************************
                         C      ;*               S V C 5 2   Ausgabe von Speicherbereichen      *
                         C      ;*                           als  MRES-P-Dateien                *
                         C      ;****************************************************************
                         C      S4.SVC52:   LD      A,(S2.OM)
                         C                  OR      A
                         C                  JP      Z,S9.WRTVF
                         C                  LD      L,(IX+4)            ;Anfangs- bzw. Start- Adresse
                         C                  LD      H,(IX+5)
                         C                  LD      C,(IX+2)            ;Anzahl Byte  bzw.  0
                         C                  LD      B,(IX+3)
                         C                  LD      (S2.PRGN),HL        ;Anfangsadresse
                         C                  ADD     HL,BC
                         C                  DEC     HL
                         C                  LD      (S2.PRGN+2),HL      ;Endadresse
                         C                  LD      A,(IX+0)            ;operation 1 bzw. 2
                         C                  CP      2
                         C                  JR      Z,S4.SC523
                         C                  CP      1
                         C                  JR      Z,S4.SC521
                         C      S4.SC52E:   JP      0B403H              ;Rueckkehr zu  BASIC
                         C      
                         C      S4.SC521:   LD      A,(IX+6)            ;Segment
                         C                  OR      A
'BASIC- SVC - Routinen fuer Speichererweiterung'	MACRO-80 3.44	09-Dec-81	PAGE	1-168


                         C                  JR      Z,S4.SC522
                         C                  CALL    S4.UM15
                         C                  CALL    S4.BWS
                         C      S4.SC522:   CALL    S9.RGLO
                         C                  CALL    LO.SAVE
                         C                  JR      S4.SC52E
                         C      
                         C      S4.SC523:   CALL    S9.RGLO
                         C                  LD      DE,(S2.PRGN)
                         C                  XOR     A
                         C                  CALL    K1.SCHR
                         C                  LD      A,D
                         C                  CALL    K1.SCHR
                         C                  LD      A,E
                         C                  CALL    K1.SCHR
                         C                  CALL    K1.MRCLS
                         C                  JR      S4.SC52E
                         C      
                         C                  PAGE
                         C      ;****************************************************************
                         C      ;*               Zusaetze zur Systeminitialisierung             *
                         C      ;****************************************************************
                         C      S4.BSCN:    LD      HL,S4.UUM4          ;Umschalt - Unterprogramme laden
                         C                  LD      DE,S4.U1
                         C                  LD      BC,S4.UM7-S4.UUM4
                         C                  LDIR
                         C                  RET
                         C      
                         C      
                         C      S4.RES:     LD      SP,S0.STACK
                         C                  CALL    S4.BSCN
                         C                  LD      HL,S0.BWSB          ;BWS-Umschalt-UP's umladen
                         C                  LD      DE,S2.STACK
                         C                  LD      BC,S0.BASCL-S0.BWSB
                         C                  LDIR
                         C                  OUT     (C),S4.SBST+4       ;RESET-Sperre aus
                         C      
                         C                  IF      S4.V2 AND 1         ;OPS (0000H,4000H) wegschalten
                         C                  LD      A,00000000B
                         C                  ENDIF
                         C                  IF      S4.V2 AND 2
                         C                  LD      A,00000001B
                         C                  ENDIF
                         C                  OUT     (C),S4.SBST+1
                         C      
                         C                  IF      S4.V2 AND 1         ;OFS (1000H) zuschalten
                         C                  LD      A,10100101B
                         C                  ENDIF
                         C                  IF      S4.V2 AND 2
                         C                  LD      A,10110101B
                         C                  ENDIF
                         C                  OUT     (C),S4.SBST+0
                         C      
                         C                  LD      SP,02900H
                         C                  LD      HL,02B00H           ;16K Byte-Merker (ZSM) loeschen
                         C                  LD      DE,02B01H
                         C                  LD      BC,8
                         C                  LD      (HL),0
                         C                  LDIR
                         C      
                         C                  IF      S4.V2 AND 1
                         C                  XOR     A
                         C                  ENDIF
                         C                  IF      S4.V2 AND 2
                         C                  LD      A,00010011B         ;16K Byte-RAM Platte aus SYS0
                         C                  ENDIF
                         C                  LD      (S2.S1),A
                         C      
                         C                  LD      HL,S4.UP            ;nachf. Progr.teil laden
                         C                  LD      DE,02A00H
                         C                  LD      BC,S4.UP1E-S4.UP
                         C                  LDIR
                         C                  JP      02A00H              ;entspricht  "UP"
                         C      
                         C                  PAGE
                         C      ;****************************************************************
                         C      ;*               Start eines Programms von einer Platte  1iH    *
                         C      ;****************************************************************
                         C                  DW      $                   ;STRT 1i,prog .... ....
                         C                  DB      'STRT'
                         C                  LD      H,7                 ;ZPOL=SYSZ , SPOL= 8
                         C                  LD      L,S0.SYSZ-1
                         C                  LD      (MS.ZPOL),HL
'BASIC- SVC - Routinen fuer Speichererweiterung'	MACRO-80 3.44	09-Dec-81	PAGE	1-169


                         C                  LD      A,31
                         C                  LD      (MS.CMD),A
                         C                  CALL    MO.MONI
                         C                  CALL    S1.HBKON
                         C                  INC     HL
                         C                  EXX
                         C                  LD      E,10H
                         C                  CALL    S4.SC64
                         C                  OR      A
                         C                  JP      NZ,S1.SYSTB
                         C                  LD      (S2.SMHL),HL
                         C                  CALL    S4.UU4
                         C                  EXX
                         C                  PUSH    HL
                         C                  LD      DE,8
                         C                  OR      A
                         C                  SBC     HL,DE
                         C                  POP     DE
                         C                  EX      DE,HL
                         C                  LD      BC,22
                         C                  LDIR
                         C                  CALL    S4.BWS
                         C                  CALL    S0.BWSUS
                         C                  JP      S1.START
                         C      
                         C                  PAGE
                         C      ;****************************************************************
                         C      ;*               Routinen  S0.BWSZU und S0.BWSAB  modifizieren  *
                         C      ;****************************************************************
                         C      S4.BWS:     EXX
                         C      S4.BWS1     EQU     $
                         C      
                         C                  IF      S4.V2 AND 1         ;SYS 1 - BWSZU
                         C                  LD      A,00000000B
                         C                  ENDIF
                         C                  IF      S4.V2 AND 2
                         C                  LD      A,00000001B
                         C                  ENDIF
                         C                  LD      (S2.STACK+5),A
                         C      
                         C                  IF      S4.V2 AND 1         ;SYS 1 - BWSAB
                         C                  LD      A,10000000B
                         C                  ENDIF
                         C                  IF      S4.V2 AND 2
                         C                  LD      A,10000001B
                         C                  ENDIF
                         C                  LD      (S2.STACK+26),A
                         C      
                         C                  LD      A,(HL)              ;SYS 2
                         C                  AND     00011100B
                         C                  RRCA
                         C                  RRCA
                         C                  INC     A
                         C                  LD      B,A
                         C                  LD      A,10000000B
                         C                  RLCA
                         C                  DJNZ    $-1
                         C                  LD      (S2.STACK+13),A     ;SYS 2 - BWSZU
                         C                  LD      (S2.STACK+30),A     ;SYS 2 - BWSAB
                         C                  RET
                         C      
                         C                  PAGE
                         C      ;****************************************************************
                         C      ;*               Eingabe vom Zusatzspeicher aktivieren          *
                         C      ;****************************************************************
                         C      S4.SVC61:   CALL    S4.SC63
                         C                  CALL    S4.SC600
                         C                  LD      HL,S4.EIN-2
                         C                  CALL    S4.LDIR
                         C                  LD      HL,S4.U2            ;"EIN"
                         C                  LD      BC,S9.IOX
                         C      S4.SC611:   JP      S9.SPA
                         C      ;****************************************************************
                         C      ;*               Ausgabe auf Zusatzspeicher aktivieren          *
                         C      ;****************************************************************
                         C      S4.SVC62:   CALL    S4.SC63
                         C                  CALL    S4.SC600
                         C                  LD      HL,S4.AUS-2
                         C                  CALL    S4.LDIR
                         C                  LD      HL,S9.IOX
                         C                  LD      BC,S4.U2            ;"AUS"
                         C                  JR      S4.SC611
                         C      ;****************************************************************
'BASIC- SVC - Routinen fuer Speichererweiterung'	MACRO-80 3.44	09-Dec-81	PAGE	1-170


                         C      ;*               Leserkanal   auf Erweiterung schalten          *
                         C      ;****************************************************************
                         C      S4.SVC63:   CALL    S4.SC63
                         C                  CALL    S4.SC600
                         C                  LD      HL,S4.EIN-2
                         C                  CALL    S4.LDIR
                         C                  LD      HL,S4.U2            ;"EIN"
                         C                  LD      (BC.RIV+1),HL
                         C                  JP      0B403H
                         C      ;****************************************************************
                         C      ;*               Stanzerkanal auf Erweiterung schalten          *
                         C      ;****************************************************************
                         C      S4.SVC64:   CALL    S4.SC63
                         C                  CALL    S4.SC600
                         C                  LD      HL,S4.AUS-2
                         C                  CALL    S4.LDIR
                         C                  LD      HL,S4.U2            ;"AUS"
                         C                  LD      (BC.WRTV+1),HL
                         C                  JP      0B403H
                         C      ;****************************************************************
                         C      ;*               Leser- und Stanzerkanal zuruecksetzen          *
                         C      ;****************************************************************
                         C      S4.SVC65:   LD      HL,S9.RIV
                         C                  LD      (BC.RIV+1),HL
                         C                  LD      HL,S9.WRTV
                         C                  LD      (BC.WRTV+1),HL
                         C                  JP      0B403H
                         C      ;****************************************************************
                         C      ;*               Lese- und Schreib- pointer setzen              *
                         C      ;****************************************************************
                         C      S4.SVC66:   INC     IX
                         C                  INC     IX
                         C                  CALL    S4.SC60
                         C                  CALL    S4.SC600
                         C                  LD      H,(IX+1)
                         C                  LD      L,(IX+0)
                         C                  PUSH    HL
                         C                  LD      H,(IX-1)
                         C                  LD      L,(IX-2)
                         C                  PUSH    HL
                         C                  LD      HL,S4.UM14-2
                         C                  JR      S4.SC699
                         C      
                         C      
                         C      ;****************************************************************
                         C      ;*               allgemeine Organisation des Zusatzspeichers    *
                         C      ;****************************************************************
                         C      S4.SC600:   OR      A
                         C                  JR      NZ,S4.SC698
                         C                  LD      (S2.SMHL),HL
                         C                  RET
                         C      S4.SC698:   POP     HL
                         C                  JP      0B403H
                         C      
                         C      S4.SVC60:   LD      HL,S4.UUM4
                         C                  LD      DE,S4.U1
                         C                  LD      BC,S4.UM7-S4.UUM4
                         C                  LDIR
                         C                  LD      A,(IX+0)            ;Parameter
                         C                  CP      1
                         C                  JR      Z,S4.SC601
                         C                  CP      2
                         C                  JR      Z,S4.SC602
                         C                  CP      3
                         C                  JR      Z,S4.SC603
                         C                  CP      4
                         C                  JR      Z,S4.SC604
                         C                  CP      5
                         C                  JR      Z,S4.SC605
                         C                  CP      6
                         C                  JR      Z,S4.SC606
                         C                  CP      7
                         C                  JR      Z,S4.SC607
                         C                  LD      A,3
                         C                  JR      S4.SC600
                         C      
                         C      S4.SC601:   CALL    S4.SC60             ;par=1   16K initialisieren
                         C                  CALL    S4.SC600
                         C                  LD      HL,S4.UM1-2
                         C      S4.SC699:   CALL    S4.LDIR
                         C                  JP      S4.U2
                         C      
                         C      S4.SC602:   CALL    S4.SC60             ;par=2   Schreib- = Lese- Pointer
'BASIC- SVC - Routinen fuer Speichererweiterung'	MACRO-80 3.44	09-Dec-81	PAGE	1-171


                         C                  CALL    S4.SC600
                         C                  LD      HL,S4.UM8-2
                         C                  JR      S4.SC699
                         C      
                         C      S4.SC603:   CALL    S4.SC60             ;par=3   setzen ersten freien Platz
                         C                  CALL    S4.SC600
                         C                  LD      HL,S4.UM9-2
                         C                  JR      S4.SC699
                         C      
                         C      S4.SC604:   CALL    S4.SC60             ;par=4   Schreib- pointer = 1. fr. Platz
                         C                  CALL    S4.SC600
                         C                  LD      HL,S4.UM10-2
                         C                  JR      S4.SC699
                         C      
                         C      S4.SC605:   CALL    S4.SC60             ;par=5   Lese-    pointer = Anfang
                         C                  CALL    S4.SC600
                         C                  LD      HL,S4.UM11-2
                         C                  JR      S4.SC699
                         C      
                         C      S4.SC606:   CALL    S4.SC60             ;par=6   Schreib- pointer = Anfang
                         C                  CALL    S4.SC600
                         C                  LD      HL,S4.UM12-2
                         C                  JR      S4.SC699
                         C      S4.SC607:   CALL    S4.SC60             ;par=7   Lese-/Schreib- pointer lesen
                         C                  CALL    S4.SC600
                         C                  LD      HL,S4.UM13-2
                         C                  JR      S4.SC699
                         C      
                         C      S4.SC617:   CALL    S9.ERSTR
                         C                  JP      Z,0B403H
                         C                  LD      DE,7
                         C                  ADD     HL,DE
                         C                  POP     DE
                         C                  LD      A,D
                         C                  CALL    S1.BHKON
                         C                  LD      A,E
                         C                  CALL    S1.BHKON
                         C                  POP     DE
                         C                  LD      A,D
                         C                  CALL    S1.BHKON
                         C                  LD      A,E
                         C                  CALL    S1.BHKON
                         C                  JP      0B403H
                         C      
                         C                  PAGE
                         C      ;****************************************************************
                         C      ;*               Ueberpruefen der Angaben   blknr  und stufe    *
                         C      ;****************************************************************
                         C      S4.SC63:    DEC     IX
                         C                  DEC     IX
                         C      S4.SC60:    LD      A,(IX+2)            ;blknr
                         C                  LD      E,30H
                         C      S4.SC64:    PUSH    AF
                         C                  EX      AF,AF'              ;'
                         C                  POP     AF
                         C                  AND     0F0H
                         C                  XOR     E
                         C                  JR      NZ,S4.SC61
                         C                  RRC     E
                         C                  RRC     E
                         C                  RRC     E
                         C                  RRC     E
                         C                  EX      AF,AF'              ;'stufe
                         C                  AND     00FH
                         C      S4.UP3:     LD      HL,S2.S1-1
                         C                  INC     A
                         C                  LD      C,A
                         C                  LD      B,9
                         C      S4.UP4:     INC     HL
                         C                  LD      A,(HL)
                         C                  AND     03H
                         C                  XOR     E
                         C                  JR      Z,S4.UP5
                         C                  DJNZ    S4.UP4
                         C                  SCF
                         C                  JR      S4.UP6
                         C      S4.UP5:     DEC     C
                         C                  JR      NZ,S4.UP4
                         C                  SCF
                         C                  CCF
                         C      S4.UP6:     JR      C,S4.SC62
                         C                  XOR     A
                         C      S4.SC6:     RET
'BASIC- SVC - Routinen fuer Speichererweiterung'	MACRO-80 3.44	09-Dec-81	PAGE	1-172


                         C      
                         C      S4.SC61:    LD      A,1
                         C                  RET
                         C      
                         C      S4.SC62:    LD      A,2
                         C                  RET
                         C      
                         C      S4.LDIR:    LD      C,(HL)
                         C                  INC     HL
                         C                  LD      B,(HL)
                         C                  INC     HL
                         C                  LD      DE,S4.U2
                         C                  LDIR
                         C                  RET
                         C      
                         C                  PAGE
                         C      ;****************************************************************
                         C      ;*               Unterprogramme, die umgespeichert werden       *
                         C      ;****************************************************************
                         C      S4.UP:      XOR     A                   ;nur gemischte aktiv lassen
                         C                  OUT     (C),S4.SBST+1
                         C                  LD      A,10111101B
                         C                  OUT     (C),S4.SBST+0
                         C      
                         C                  LD      HL,04000H           ;Zusatzspeicher initialisieren
                         C                  LD      B,3
                         C                  LD      D,01000001B
                         C      S4.M2:      PUSH    BC
                         C                  LD      IX,02B00H
                         C                  LD      B,8
                         C      S4.UP1:     LD      A,D
                         C                  AND     00011100B
                         C                  RRCA
                         C                  RRCA
                         C                  INC     A
                         C                  PUSH    BC
                         C                  LD      B,A
                         C                  LD      A,10000000B
                         C                  RLCA
                         C                  DJNZ    $-1
                         C                  POP     BC
                         C                  OUT     (C),S4.SBST+2       ;Erweiterungsplatte zuschalten
                         C                  LD      A,D
                         C                  LD      (HL),A
                         C                  CP      (HL)
                         C                  JR      NZ,S4.UP2
                         C                  LD      (IX+0),A
                         C      S4.UP2:     ADD     A,4
                         C                  LD      D,A
                         C                  XOR     A
                         C                  OUT     (C),S4.SBST+2       ;Erweiterungsplatte wegschalten
                         C                  INC     IX
                         C                  DJNZ    S4.UP1
                         C                  LD      BC,04000H
                         C                  ADD     HL,BC
                         C                  LD      A,D
                         C                  AND     01000011B
                         C                  INC     A
                         C                  LD      D,A
                         C                  POP     BC
                         C                  DJNZ    S4.M2
                         C      
                         C                  PAGE
                         C                  IF      S4.V2 AND 1
                         C                  LD      A,10100101B
                         C                  ENDIF
                         C                  IF      S4.V2 AND 2
                         C                  LD      A,10110101B
                         C                  ENDIF
                         C                  OUT     (C),S4.SBST
                         C      
                         C                  IF      S4.V2 AND 1
                         C                  LD      A,00000000B
                         C                  ENDIF
                         C                  IF      S4.V2 AND 2
                         C                  LD      A,00000001B
                         C                  ENDIF
                         C                  OUT     (C),S4.SBST+1
                         C                  JP      S4.UP1E
                         C      
                         C      S4.UP1E:    LD      HL,02B00H
                         C                  LD      DE,S2.S2
                         C                  LD      BC,8
'BASIC- SVC - Routinen fuer Speichererweiterung'	MACRO-80 3.44	09-Dec-81	PAGE	1-173


                         C                  LDIR
                         C      
                         C                  IF      S4.V2 AND 1
                         C                  LD      A,10100111B
                         C                  ENDIF
                         C                  IF      S4.V2 AND 2
                         C                  LD      A,10110111B
                         C                  ENDIF
                         C                  OUT     (C),S4.SBST
                         C      
                         C                  IF      S4.V2 AND 1
                         C                  LD      A,10000100B
                         C                  ENDIF
                         C                  IF      S4.V2 AND 2
                         C                  LD      A,10000101B
                         C                  ENDIF
                         C                  OUT     (C),S4.SBST+1
                         C                  OUT     (C),S4.SBST+3       ;RESET-Sperre ein
                         C      
                         C                  JP      S1.RES1
                         C      
                         C                  PAGE
                         C      ;****************************************************************
                         C      ;*               Routine fuer  SVC 0,0, [... ,] &1i ,adresse    *
                         C      ;****************************************************************
                         C      S4.UM15:    EXX
                         C                  LD      E,10H
                         C                  CALL    S4.SC64
                         C                  CALL    S4.SC600
                         C                  CALL    S4.UU4
                         C                  EXX
                         C                  RET
                         C      ;****************************************************************
                         C      ;*               Routine fuer  SVC &1i , ...                    *
                         C      ;****************************************************************
                         C      S4.UM16:    LD      E,10H
                         C                  CALL    S4.SC64
                         C                  CALL    S4.SC600
                         C                  CALL    S4.UU4
                         C                  LD      HL,04007H
                         C                  LD      A,(HL)
                         C                  INC     HL
                         C                  LD      H,(HL)
                         C                  LD      L,A
                         C                  JP      S9.AB3
                         C      ;****************************************************************
                         C      ;*               Zuschalten einer "4000"-Erweiterungsplatte     *
                         C      ;****************************************************************
                         C      S4.UU4:     LD      HL,(S2.SMHL)
                         C                  OUT     (C),S4.SBST+4       ;RESET-Sperre aus
                         C      
                         C                  IF      S4.V2 AND 1
                         C                  LD      A,10000000B
                         C                  ENDIF
                         C                  IF      S4.V2 AND 2
                         C                  LD      A,10000001B
                         C                  ENDIF
                         C                  OUT     (C),S4.SBST+1
                         C      
                         C                  LD      A,(HL)
                         C                  AND     00011100B
                         C                  RRCA
                         C                  RRCA
                         C                  INC     A
                         C                  LD      B,A
                         C                  LD      A,10000000B
                         C                  RLCA
                         C                  DJNZ    $-1
                         C                  OUT     (C),S4.SBST+2
                         C                  RET
                         C      
                         C                  PAGE
                         C                  DW      S4.UM8-S4.UM1-2
                         C      S4.UM1:     CALL    S4.UM4              ;16K initialisieren
                         C                  LD      HL,0C010H
                         C                  LD      (0C001H),HL         ;erster freier Platz
                         C                  LD      (0C003H),HL         ;LP ... Lesepointer
                         C                  LD      (0C005H),HL         ;SP ... Schreibpointer
                         C                  LD      DE,0C011H
                         C                  LD      BC,04000H-11H
                         C                  LD      (HL),00DH
                         C                  LDIR
                         C                  JP      S4.UM6
'BASIC- SVC - Routinen fuer Speichererweiterung'	MACRO-80 3.44	09-Dec-81	PAGE	1-174


                         C      
                         C                  DW      S4.UM9-S4.UM8-2
                         C      S4.UM8:     CALL    S4.UM4              ;Schreib- = Lese- Pointer
                         C                  LD      HL,(0C003H)
                         C                  LD      (0C005H),HL
                         C                  JP      S4.UM6
                         C      
                         C                  DW      S4.UM10-S4.UM9-2
                         C      S4.UM9:     CALL    S4.UM4              ;setzen ersten freien Platz
                         C                  LD      HL,(0C005H)
                         C                  LD      (0C001H),HL
                         C                  JP      S4.UM6
                         C      
                         C                  DW      S4.UM11-S4.UM10-2
                         C      S4.UM10:    CALL    S4.UM4              ;Schreib- pointer = 1. fr. Platz
                         C                  LD      HL,(0C001H)
                         C                  LD      (0C005H),HL
                         C                  JP      S4.UM6
                         C      
                         C                  DW      S4.UM12-S4.UM11-2
                         C      S4.UM11:    CALL    S4.UM4              ;Lese-    pointer = Anfang
                         C                  LD      HL,0C010H
                         C                  LD      (0C003H),HL
                         C                  JP      S4.UM6
                         C      
                         C                  DW      S4.UM13-S4.UM12-2
                         C      S4.UM12:    CALL    S4.UM4              ;Schreib- pointer = Anfang
                         C                  LD      HL,0C010H
                         C                  LD      (0C005H),HL
                         C                  JP      S4.UM6
                         C      
                         C                  DW      S4.UM14-S4.UM13-2
                         C      S4.UM13:    CALL    S4.UM4              ;Lese-/Schreib- pointer lesen
                         C                  LD      HL,(0C005H)
                         C                  PUSH    HL
                         C                  LD      HL,(0C003H)
                         C                  PUSH    HL
                         C                  CALL    S4.UM6+6
                         C                  JP      S4.SC617
                         C      
                         C                  DW      S4.EIN-S4.UM14-2
                         C      S4.UM14:    CALL    S4.UM4              ;Lese-/Schreib- pointer setzen
                         C                  POP     HL
                         C                  LD      (0C005H),HL
                         C                  POP     HL
                         C                  LD      (0C003H),HL
                         C                  JP      S4.UM6
                         C      
                         C                  PAGE
                         C                  DW      S4.AUS-S4.EIN-2
                         C      S4.EIN:     CALL    S9.SAVE             ;Eingabe vom Zusatzspeicher
                         C                  CALL    S4.UM4
                         C                  LD      HL,(0C003H)
                         C                  LD      A,(HL)
                         C                  LD      (TS.TK),A
                         C                  INC     HL
                         C                  LD      A,H
                         C                  OR      L
                         C                  JR      NZ,S4.EIN1
                         C                  DEC     HL
                         C                                              ;Fehlermeldung
                         C      S4.EIN1:    LD      (0C003H),HL
                         C                  CALL    S4.UM6+6
                         C                  JP      S9.RIV9
                         C      
                         C                  DW      S4.AUS2-S4.AUS
                         C      S4.AUS:     CALL    S9.SAVE             ;Ausgabe auf Zusatzspeicher
                         C                  LD      A,C
                         C                  LD      (MS.TK),A
                         C                  CALL    S4.UM4
                         C                  LD      HL,(0C005H)
                         C                  LD      A,(MS.TK)
                         C                  LD      (HL),A
                         C                  INC     HL
                         C                  LD      A,H
                         C                  OR      L
                         C                  JR      NZ,S4.AUS1
                         C                  DEC     HL
                         C                                              ;Fehlermeldung
                         C      S4.AUS1:    LD      (0C005H),HL
                         C                  CALL    S4.UM6+6
                         C                  JP      S9.IOXE
                         C      S4.AUS2     EQU     $
'BASIC- SVC - Routinen fuer Speichererweiterung'	MACRO-80 3.44	09-Dec-81	PAGE	1-175


                         C      
                         C                  PAGE
                         C      S4.UUM4:    LD      HL,(S2.SMHL)
                         C                  OUT     (C),S4.SBST+4       ;RESET-Sperre aus
                         C      
                         C                  IF      S4.V2 AND 1         ;RAM C000 wegschalten
                         C                  LD      A,10110111B
                         C                  OUT     (C),S4.SBST
                         C                  ENDIF
                         C      
                         C                  LD      A,10000000B      ;RAM 4000 (ROM C000) wegschalten
                         C                  OUT     (C),S4.SBST+1
                         C      
                         C                  IF      S4.V2 AND 2
                         C                  LD      A,(HL)
                         C                  XOR     00010011B
                         C                  JR      NZ,S4.UM5
                         C                  LD      A,10100111B         ;RAM C000 aus V1 aktivieren
                         C                  OUT     (C),S4.SBST
                         C                  RET
                         C                  ENDIF
                         C      
                         C      S4.UM5:     LD      A,(HL)
                         C                  AND     00011100B
                         C                  RRCA
                         C                  RRCA
                         C                  INC     A
                         C                  LD      B,A
                         C                  LD      A,10000000B
                         C      S4.UM2:     RLCA
                         C                  DJNZ    S4.UM2
                         C                  OUT     (C),S4.SBST+2
                         C                  RET
                         C      
                         C      S4.UUM6:    CALL    S4.UM6+6
                         C                  JP      0B403H
                         C      
                         C                  XOR     A
                         C                  OUT     (C),S4.SBST+2
                         C      
                         C                  IF      S4.V2 AND 1
                         C                  LD      A,10100111B
                         C                  ENDIF
                         C                  IF      S4.V2 AND 2
                         C                  LD      A,10110111B
                         C                  ENDIF
                         C                  OUT     (C),S4.SBST
                         C      
                         C                  IF      S4.V2 AND 1
                         C                  LD      A,10000100B
                         C                  ENDIF
                         C                  IF      S4.V2 AND 2
                         C                  LD      A,10000101B
                         C                  ENDIF
                         C                  OUT     (C),S4.SBST+1
                         C      
                         C                  OUT     (C),S4.SBST+3       ;RESET-Sperre ein
                         C                  RET
                         C      S4.UM7      EQU     $
                         C      
                         C      S4.UM4      EQU     S4.U1+S4.UUM4-S4.UUM4
                         C      S4.UM6      EQU     S4.U1+S4.UUM6-S4.UUM4
                         C      
                         C                  PAGE
                         C      ;****************************************************************
                         C      ;*               Arbeit mit der Ein- / Ausgabetabelle  L B      *
                         C      ;****************************************************************
                         C      S4.SC700:   LD      A,(IX+2)            ;richtung
                         C                  CP      'I'
                         C                  JR      Z,S4.SC702
                         C                  CP      'O'
                         C                  JR      NZ,S4.SC701
                         C                  CALL    S4.LIYO
                         C                  JR      S4.SC703
                         C      
                         C      S4.SC702:   CALL    S4.LIYI
                         C                  LD      C,7FH
                         C      S4.SC703:   LD      A,(IX)              ;operation
                         C                  CP      4
                         C                  JP      Z,S4.SC704
                         C                  CP      3
                         C                  JR      Z,S4.SC705
                         C                  CP      2
'BASIC- SVC - Routinen fuer Speichererweiterung'	MACRO-80 3.44	09-Dec-81	PAGE	1-176


                         C                  JR      Z,S4.SC706
                         C                  CP      1
                         C                  JR      Z,S4.SC707
                         C                  CP      0
                         C                  JR      Z,S4.SC708
                         C      S4.SC701:   JP      0B403H
                         C                                              ;op = 1
                         C      S4.SC707:   LD      A,(IX+4)            ;wert
                         C                  LD      B,0
                         C                  LD      C,(IX+6)            ;rel. tabellenadresse
                         C                  ADD     IY,BC
                         C                  LD      (IY+0),A
                         C                  JR      S4.SC701
                         C                                              ;op = 3  ...  ASCII
                         C      S4.SC705:   LD      A,(IX+2)            ;richtung
                         C                  CP      'O'
                         C                  JR      Z,$+6
                         C                  LD      B,11100110B
                         C                  JR      SC716
                         C                  LD      B,11000100B
                         C                  JR      S4.SC716
                         C                                              ;op = 2  ...  binaer
                         C      S4.SC706:   LD      A,(IX+2)            ;richtung
                         C                  CP      'O'
                         C                  JR      Z,$+6
                         C                  LD      B,2
                         C                  JR      SC716
                         C                  LD      B,0
                         C      S4.SC716:   LD      DE,01E0DH           ;EOR - Zeichen
                         C                  LD      A,019H              ;EOF - Zeichen
                         C                  LD      HL,0
                         C                  PUSH    HL
                         C                  JR      S4.SC709
                         C                                              ;op = 0
                         C      S4.SC708:   LD      D,(IX+16)
                         C                  LD      E,(IX+14)
                         C                  LD      B,(IX+12)
                         C                  LD      C,(IX+8)
                         C                  LD      A,(IX+6)
                         C                  LD      H,(IX+5)
                         C                  LD      L,(IX+4)
                         C                  PUSH    HL
                         C                  LD      H,(IX+11)
                         C                  LD      L,(IX+10)
                         C      
                         C      S4.SC709:   LD      (IY+0),D
                         C                  LD      (IY+1),E
                         C                  LD      (IY+4),B
                         C                  LD      (IY+11),C
                         C                  LD      (IY+12),A
                         C                  LD      (IY+5),L
                         C                  LD      (IY+6),H
                         C                  POP     HL
                         C                  LD      (IY+19),L
                         C                  LD      (IY+20),H
                         C                  JR      SC701
                         C                                              ;op = 4  ...  Standard-Anwender-Kode
                         C      S4.SC704:   LD      HL,LR.KONV
                         C                  PUSH    HL
                         C                  LD      A,(IX+2)
                         C                  CP      'O'
                         C                  JR      Z,$+9               ;---!
                         C                  LD      C,0EFH              ;   !
                         C                  LD      HL,LR.SKTBI         ;   !
                         C                  JR      $+7                 ;------!
                         C                  LD      C,010H              ;<--!  !
                         C                  LD      HL,LR.SKTBO         ;      !
                         C                  LD      D,080H              ;<-----!
                         C                  LD      E,00DH
                         C                  LD      B,10101110B
                         C                  LD      A,019H
                         C                  JR      S4.SC709
                         C      
                         C                  PAGE
                         C      ;****************************************************************
                         C      ;*                  Modifizierung der Workspace-Adressen        *
                         C      ;****************************************************************
                         C      S4.SC710:   LD      HL,S4.SC712
                         C                  LD      BC,S9.IOX
                         C      S4.SC711:   LD      (BC.CIN+1),HL
                         C                  LD      (BC.CON+1),BC
                         C      S4.SC713:   JP      0B403H
                         C      
'BASIC- SVC - Routinen fuer Speichererweiterung'	MACRO-80 3.44	09-Dec-81	PAGE	1-177


                         C      S4.SC720:   LD      HL,S9.IOX
                         C                  LD      BC,S4.SC722
                         C                  JR      S4.SC711
                         C      
                         C      S4.SC730:   LD      HL,S4.SC712
                         C                  LD      (BC.RIV+1),HL
                         C                  JR      S4.SC713
                         C      
                         C      S4.SC740:   LD      HL,S4.SC742
                         C                  LD      (BC.WRTV+1),HL
                         C                  JR      S4.SC713
                         C      
                         C      S4.SC750:   LD      HL,S4.SC752
                         C      S4.SC751:   LD      (BC.USR+1),HL
                         C                  JR      S4.SC713
                         C      
                         C      S4.SC760:   LD      HL,S4.SC762
                         C                  JR      S4.SC751
                         C      
                         C      
                         C      S4.LBL:     PUSH    AF
                         C                  CALL    S0.KRZU
                         C                  POP     AF
                         C                  CALL    LR.LBL
                         C                  PUSH    AF
                         C                  PUSH    BC
                         C                  PUSH    DE
                         C                  CALL    S2.STACK
                         C                  POP     DE
                         C                  POP     BC
                         C                  POP     AF
                         C                  RET
                         C      
                         C      S4.LBS:     PUSH    AF
                         C                  CALL    S0.KRZU
                         C                  POP     AF
                         C                  CALL    LR.LBS
                         C                  PUSH    AF
                         C                  PUSH    BC
                         C                  PUSH    DE
                         C                  CALL    S2.STACK
                         C                  POP     DE
                         C                  POP     BC
                         C                  POP     AF
                         C                  RET
                         C      
                         C                  PAGE
                         C      S4.LIYI:    LD      IY,S3.LBL-S3.SEAT
                         C                  LD      DE,S0.DEAT+3
                         C                  ADD     IY,DE
                         C                  RET
                         C      
                         C      S4.LIXI:    PUSH    IY
                         C                  CALL    S4.LIYI
                         C                  PUSH    IY
                         C                  POP     IX
                         C                  POP     IY
                         C                  RET
                         C      
                         C      
                         C      S4.LIYO:    LD      IY,S3.LBS-S3.SEAT
                         C                  LD      DE,S0.DEAT+3
                         C                  ADD     IY,DE
                         C                  RET
                         C      
                         C      S4.LIXO:    PUSH    IY
                         C                  CALL    S4.LIYO
                         C                  PUSH    IY
                         C                  POP     IX
                         C                  POP     IY
                         C                  RET
                         C      
                         C                  PAGE
                         C      ;****************************************************************
                         C      ;*               Lochband- Ein-/Ausgaberoutinen                 *
                         C      ;****************************************************************
                         C      S4.SC712:   CALL    S9.SAVE             ;Lochbandeingaberoutine
                         C                  CALL    S4.LIXI
                         C                  CALL    S4.LBL
                         C                  LD      (TS.TK),A
                         C                  LD      A,(IX+3)
                         C                  ADD     A,30H
                         C                  CALL    S9.ERS
'BASIC- SVC - Routinen fuer Speichererweiterung'	MACRO-80 3.44	09-Dec-81	PAGE	1-178


                         C                  CALL    S9.LOAD
                         C                  LD      A,(TS.TK)
                         C                  RET
                         C      
                         C      S4.SC722:   PUSH    AF                  ;Lochbandausgaberoutine  PRINT
                         C                  LD      A,C                 ;bei PRINT keine Ausgabe von 00AH
                         C                  CP      0AH
                         C                  JR      NZ,S4.SC723
                         C                  POP     AF
                         C                  RET
                         C      S4.SC723:   POP     AF
                         C      S4.SC742:   CALL    S9.SAVE             ;Lochbandausgaberoutine  PGM
                         C                  CALL    S4.LIXO
                         C                  CALL    S4.LBS
                         C                  JR      S4.SC763
                         C      
                         C      S4.SC752:   CALL    S9.SAVE             ;Lochandeingaberoutine  USR
                         C                  CALL    S4.LIXI
                         C                  CALL    S4.LBL
                         C                  LD      B,A
                         C                  XOR     A
                         C                  CALL    BC.RUCK
                         C                  JR      S4.SC763
                         C      
                         C      S4.SC762:   CALL    S9.SAVE             ;Lochbandausgaberoutine  USR
                         C                  CALL    BC.PAR
                         C                  LD      C,E
                         C                  CALL    S4.LIXO
                         C                  CALL    S4.LBS
                         C      
                         C      S4.SC763:   LD      A,(IX+3)
                         C                  ADD     A,30H
                         C                  CALL    S9.ERS
                         C                  CALL    S9.LOAD
                         C                  RET
                         C      
                         C                  PAGE
                         C      ;****************************************************************
                         C      ;*     PROGRAMMM F. CROSS-REFERENZLISTE (SPRUNGBEFEHLE)         *
                         C      ;****************************************************************
                         C      S4.CALL:    DB      'CALL   '
                         C      S4.GOSUB:   DB      'GOSUB  '
                         C      S4.GOTO:    DB      'GOTO   '
                         C      S4.OGOS:    DB      'ONGOSUB'
                         C      S4.OGOTO:   DB      'ONGOTO '
                         C                  DW      $
                         C                  DB      'BANA'
                         C                  LD      A,5                 ;BILD LOESCHEN
                         C                  LD      (MS.CMD),A
                         C                  CALL    MO.MONI
                         C                  LD      A,22
                         C                  LD      (MS.CMD),A
                         C                  CALL    MO.MONI
                         C      
                         C                  XOR     A                   ;ZAEHLER DER ANZAHL DER ZEILEN AUF BS AUF 0 SETZEN
                         C                  LD      (S2.DM2),A
                         C                  LD      HL,(02FB7H)         ;INI FUER HL MIT ANFANGSADRESSE DES BASIC-PGMS
                         C                  DEC     HL                  ;DAMIT ERSTES ZEICHEN NICHT VERLOREN GEHT
                         C      S4.PREN:    INC     HL                  ;SCHLEIFE PROGRAMMENDE / NAECHSTES ZEICHEN
                         C                  XOR     A                   ;INI FUER MERKER (0=KEIN ON,KEIN CALL,1.SPRUNG IN ZEILE)
                         C                  LD      (S2.DMH),A
                         C                  LD      A,(HL)              ;AKTUELLES ZEICHEN HOLEN
                         C                  CP      00H                 ;1. MAL 00
                         C                  JR      NZ,S4.END1B         ;NICHT 00, SO WEITER IN ZEILE
                         C                  INC     HL                  ;NAECHSTES ZEICHEN
                         C                  LD      A,(HL)
                         C                  CP      00H                 ;2. MAL 00
                         C                  JP      Z,S4.ENDE           ;WENN JA, SO PGM-ENDE
                         C                  DEC     HL                  ;ANSONSTEN WAR ZUFAELLIG L(NEX-STMT) = 00
                         C      S4.END1B:   CALL    S4.LEER             ;LOESCHEN AUSGABEZEILE
                         C                  INC     HL                  ;UEBERGEHEN ADRESSE DER FOLGEZEILE
                         C                  INC     HL
                         C                  PUSH    HL                  ;RETTEN BEI ZEIGEN AUF ZEILENNUMMER
                         C                  LD      E,(HL)              ;L(ZEILENNUMMER)
                         C                  INC     HL
                         C                  LD      D,(HL)              ;H(ZEILENNUMMER)
                         C                  EX      DE,HL               ;HL ENTHAELT HEXAZAHL
                         C                  LD      DE,S0.PFFI          ;ZIEL FUER ASCII-KETTE
                         C                  CALL    S4.DUDEZ            ;HEXADEZ. Z-->ASCII ZEICHEN
                         C                  INC     DE                  ;ZEIGT AUF BYTE HINTER LETZTER ZIFFER
                         C                  LD      A,':'
                         C                  LD      (DE),A              ;OHNE BLANK HINTER ANWEISUNGSNUMMER
                         C                  POP     HL                  ;HL ZEIGT WIEDER AUF UNTERSUCHTE ZEILE
'BASIC- SVC - Routinen fuer Speichererweiterung'	MACRO-80 3.44	09-Dec-81	PAGE	1-179


                         C                  INC     HL                  ;UEBERGEHEN DER ANWEISUNGSNUMMER
                         C      S4.SONST:   INC     HL                  ;      "   , BZW. NAECHSTES ZEICHEN
                         C                  LD      A,(HL)
                         C      S4.SES:     CP      00H                 ;SCHLEIFE SATZENDE
                         C                  JP      Z,S4.SATZE          ;AUFTRETENDES 00 MUSS JETZT ZEILENENDE SEIN
                         C                  EXX                         ;INI FUER HINTERGRUND HL
                         C                  LD      HL,S2.DMH           ;MIT ADRESSE DES MERKERS
                         C                  EXX
                         C                  CP      91H                 ;ABFRAGE NACH TOKEN: ON
                         C                  JR      NZ,S4.NMEHR         ;SPRUNG, WENN KEINE DOPPELANWEISUNG
                         C                  EXX                         ;HINTERGRUND HL
                         C                                              ;
                         C                  SET     7,(HL)              ;TOKEN: ON GEFUNDEN
                         C                  EXX
                         C      S4.NMEHR:   CP      8CH                 ;ABFRAGE NACH TOKEN: GOSUB
                         C                  JR      NZ,S4.GOT           ;WENN NICHT, SO WEITER SUCHE
                         C                  EXX                         ;HINTERGRUND
                         C                  BIT     7,(HL)              ;TEST, OB TOKEN: ON VORANGEGANGEN WAR
                         C                  EXX
                         C                  JR      NZ,S4.OVGOS         ;SPRUNG, WENN JA
                         C                  LD      BC,S4.GOSUB         ;SONST NUR TOKEN: GOSUB
                         C                  JR      S4.KOB              ;DANN ZUR SPRUNGZIELUEBERNAHME
                         C      S4.OVGOS:   LD      BC,S4.OGOS          ;ON GOSUB
                         C                  JR      S4.KOB              ;SPRUNG ZUR SPRUNGZIELUEBERNAHME
                         C      S4.GOT:     CP      88H                 ;ABFRAGE NACH TOKEN: GOTO
                         C                  JR      NZ,S4.CAL           ;WENN NICHT, SO WEITER SUCHE
                         C                  EXX                         ;HINTERGRUND
                         C                  BIT     7,(HL)              ;TEST, OB TOKEN: ON VORANGEGANGEN
                         C                  EXX
                         C                  JR      NZ,S4.OVGOT         ;SPRUNG, WENN JA
                         C      S4.AUSGO:   LD      BC,S4.GOTO          ;SONST NUR TOKEN: GOTO
                         C                  JR      S4.KOB              ;DANN ZUR SPRUNGZIELUEBERNAHME
                         C      S4.OVGOT:   LD      BC,S4.OGOTO         ;ON GOTO
                         C                  JR      S4.KOB              ;AUCH ZUR SPRUNGZIELUEBERNAHME
                         C      S4.CAL:     CP      0D7H                ;ABFRAGE NACH TOKEN: CALL
                         C                  JR      NZ,S4.TEOGT         ;NOCH TESTEN, OB EVTL. THEN ODER ELSE OHNE GOTO
                         C                  LD      BC,S4.CALL
                         C                  EXX                         ;HINTERGRUND
                         C                  SET     6,(HL)              ;TOKEN: CALL GEFUNDEN
                         C                  EXX
                         C                  JR      S4.KOB
                         C      S4.TEOGT:   CP      0A2H                ;TOKEN: THEN
                         C                  JR      NZ,S4.ELS           ;SPRUNG, WENN NICHT
                         C      S4.TEST:    PUSH    DE                  ;TEST AUF AUSGELASSENES GOTO
                         C                  INC     HL                  ;1. ZEICHEN HINTER THEN ODER ELSE
                         C                  LD      D,0FFH              ;MAX. ANZAHL BLANKS UEBERGEHEN
                         C                  CALL    S4.SUNBL
                         C                  POP     DE                  ;DE ZEIGT WIEDER AUF AUSGABEZEILE
                         C                  LD      A,(HL)              ;1. ZEICHEN VERSCHIEDEN VON BLANK
                         C                  DEC     HL                  ;FALLS GEFUNDENES ZEICHEN TOKEN
                         C                                              ;IST BZW.DAMIT NUMMER NICHT VERLOREN GEHT
                         C                  CP      30H                 ;TEST, OB SPRUNGADRESSE BEGINNT
                         C                  JR      C,S4.SONST          ;SPRUNG, WENN KEINE ZIFFER
                         C                  CP      3AH
                         C                  JR      NC,S4.SONST         ;SPRUNG, WENN KEINE ZIFFER
                         C                  JR      S4.AUSGO            ;SPRUNGADRESSE WIE GOTO BEHANDELN
                         C      S4.ELS:     CP      0C9H                ;TOKEN: ELSE
                         C                  JR      Z,S4.TEST           ;SPRUNG, WENN JA UND TEST AUF AUSG. GOTO
                         C                  JR      S4.SONST            ;WEITER IM QUELLTEXT
                         C      S4.KOB:     EXX                         ;HINTERGRUND
                         C                  BIT     0,(HL)              ;TEST, WIEVIELTE SPRUNGANWEISUNG IN ZEILE
                         C                  EXX
                         C                  JR      Z,S4.LEZ            ;SPRUNG, WENN 1. SPRUNGANWEISUNG
                         C                  LD      A,2FH               ;SCHRAEGSTRICH
                         C                  JR      S4.AUSG
                         C      S4.LEZ:     LD      A,' '
                         C      S4.AUSG:    INC     DE
                         C                  LD      (DE),A              ;BLANK ODER / IN AUSGABEZEILE
                         C                  INC     DE
                         C                  PUSH    HL                  ;ZEIGT NOCH AUF TOKEN,EVTL. IMAGINAER
                         C                  LD      H,B                 ;AUSGABE DER SPRUNGNAMEN
                         C                  LD      L,C
                         C                  LD      BC,7H
                         C                  LDIR
                         C                  LD      A,'-'
                         C                  LD      (DE),A
                         C                  POP     HL                  ;HOLEN BEI ZEIGEN AUF TOKEN
                         C                  INC     HL                  ;SUCHEN SPRUNGZIEL(E)
                         C                  PUSH    DE                  ;RETTEN DER AKTUELLEN ABLAGEADRESSE
                         C                  LD      D,0FFH              ;UNTERTEILENDE BLANKS ERLAUBT
                         C                  CALL    S4.SUNBL            ;ABFRAGE NACH BLANK
                         C                  POP     DE                  ;ZEIGT WIEDER AUF ABLAGEZEILE
                         C      S4.SPADR:   LD      A,(HL)
'BASIC- SVC - Routinen fuer Speichererweiterung'	MACRO-80 3.44	09-Dec-81	PAGE	1-180


                         C                  BIT     7,A                 ;LIEGT TOKEN VOR ?
                         C                  JR      NZ,S4.ENDSP         ;WENN JA, IST SPRUNGADRESSE ZU ENDE
                         C                  CP      ':'                 ;ANWEISUNGSENDE
                         C                  JR      Z,S4.ENDSP          ;WENN JA, IST SPRUNGADRESSE ZU ENDE
                         C                  CP      0                   ;ZEILENENDE ?
                         C                  JR      Z,S4.ENDSP          ;WENN JA, IST SPRUNGADRESSE ZU ENDE
                         C                  EXX                         ;HINTERGRUND
                         C                  BIT     6,(HL)              ;TEST, OB BEHANDELTER TOKEN CALL IST
                         C                  EXX
                         C                  JR      Z,S4.UEBER          ;WENN NICHT, SPRUNGZIEL-ZIFFER UEBERNEHMEN
                         C                  CP      2CH                 ;SPRUNGZIEL VON CALL KANN BEREITS BEI KOMMA ENDEN
                         C                  JR      Z,S4.ENDSP          ;SPRUNG, WENN KOMMA
                         C      S4.UEBER:   INC     DE                  ;NAECHSTER PLATZ IN AUSGABEZEILE
                         C                  LD      (DE),A              ;ZEICHEN DES SPRUNGZIELS ABLEGEN
                         C                  INC     HL                  ;NAECHSTES ZEICHEN IN ZEILE
                         C                  JR      S4.SPADR            ;SPRUNG ZUR UNTERSUCHUNG DES NAECHSTEN ZEICHENS
                         C      S4.ENDSP:   EXX                         ;HINTERGRUND
                         C                  SET     0,(HL)              ;EINE SPRUNGANWEISUNG IST SCHON AUFGETRETEN
                         C                  EXX
                         C                  JP      S4.SES              ;WEITER ODER SATZENDE
                         C      S4.SATZE:   LD      (S2.TE),HL          ;AKTUELLEN ZEIGER AUF BASIC-PGM RETTEN
                         C                  LD      HL,S0.PFFI+9        ;ADRESSE DES ZWEITEN BYTES DES EVTL. 1. SPRUNGBF
                         C                  LD      A,20H               ;TEST, OB SPRUNG VORHANDEN
                         C                  CP      (HL)
                         C                  LD      HL,(S2.TE)          ;HL ZEIGT WIEDER AUF AKTUELLE ZEILE
                         C                  JP      Z,S4.PREN           ;SPRUNG, WENN IN UNTERSUCHTER ZEILE KEIN SPRUNG
                         C                  LD      HL,S0.PFFI          ;ADRESSE DER AUSGABEZEILE
                         C      S4.WEGFN:   LD      A,'0'               ;FUEHRENDE NULLEN ?
                         C                  CP      (HL)
                         C                  JR      NZ,S4.LACHT         ;SPRUNG BEI FUENFSTELLIGER ZEILENNUMMER
                         C                  LD      A,' '
                         C                  LD      (HL),A              ;FUEHRENDE NULL UEBERSCHREIBEN
                         C                  INC     HL                  ;NAECHSTE ZIFFER
                         C                  JR      S4.WEGFN
                         C      S4.LACHT:   LD      HL,S0.PFFI+80       ;81. BYTE
                         C                  LD      D,5                 ;DANN FOLGT UNBEDINGT NICHTS MEHR
                         C                  CALL    S4.SUNBL
                         C                  CP      ' '                 ;NUR BLANKS, SO REICHT EINE 80-BYTE-ZEILE
                         C                  JR      Z,S4.EINZE          ;FOLGENDES FUER DIESEN FALL UEBERFLUESSIG
                         C                  LD      HL,S0.PFFI+79       ;LETZTES BYTE DER 1. AUSGABEZEILE
                         C                  LD      A,2FH               ;SCHRAEGSTRICH
                         C                  LD      BC,0                ;DAMIT IN C DIE KOMPLEMENTAERE ANZAHL IST
                         C                  CPDR                        ;SUCHEN LETZTEN / DER 1. AUSGABEZEILE
                         C                  INC     HL                  ;ZEIGT AUF 1. ZEICHEN HINTER /
                         C                  LD      (S0.PFFI+253),HL    ;ADRESSE DIESES ZEICHENS RETTEN
                         C                  OR      A                   ;CY=0
                         C                  LD      DE,S0.PFFI+89       ;1. FREIES BYTE DER 2. AUSGABEZEILE
                         C                  EX      DE,HL               ;TAUSCH WEGEN SUBTRAKTION
                         C                  SBC     HL,DE               ;WIEVIEL IST ZU VERSCHIEBEN
                         C                  LD      B,H                 ;DIFFERENZ NACH BC
                         C                  LD      C,L
                         C                  LD      (S0.PFFI+251),BC    ;DIFFERENZ RETTEN
                         C                  EX      DE,HL               ;HL ZEIGT WIEDER AUF 1. ZEICHEN HINTER /
                         C                  LD      DE,(S0.PFFI+89)     ;DE WIEDER AUF 1. BYTE 2. ZEILE
                         C                  LDIR                        ;VERSCHIEBUNG NACH HINTEN
                         C                  LD      HL,(S0.PFFI+253)    ;ZEIGT AUF BYTE HINTER /
                         C                  LD      A,' '
                         C                  LD      (HL),A              ;LOESCHEN DES URBILDES DES VERSCHOBENEN BEREICHS
                         C                  LD      BC,(S0.PFFI+251)    ;WIEVIELE BYTES UEBERSCHREIBEN
                         C                  DEC     BC                  ;EINS IST JA SCHON
                         C                  LD      D,H                 ;HL NACH DE UEBERNEHMEN
                         C                  LD      E,L
                         C                  INC     DE                  ;ZEIGT EIN BYTE WEITER
                         C                  LDIR
                         C      ;****************************************************************
                         C      ;*               erste Ausgabezeile ausgeben                    *
                         C      ;****************************************************************
                         C      S4.EINZE:   LD      A,24                ;VEKTORSCHREIBEN
                         C                  LD      (MS.CMD),A
                         C                  LD      HL,S0.PFFI          ;ADRESSE DES 1.BYTE
                         C                  LD      B,80                ;WIEVIEL BYTE
                         C                  CALL    MO.MONI
                         C      S4.TEVOL:   LD      A,(S2.DM2)          ;WIEVIELE ZEILEN SCHON AUF BS ?
                         C                  CP      21                  ;BS VOLL MIT 22 ZEILEN
                         C                  JR      NZ,S4.NIVOL         ;SPRUNG, WENN NOCH NICHT SO VIEL
                         C                  LD      HL,S4.WEIT          ;WEITERARBEITSADRESSE NACH TASTENBETAETIGUNG
                         C                  LD      (TS.TAB4),HL        ;FUNKTIONSTASTE: ABS
                         C                  RET                         ;WARTEN AUF BETAETIGUNG DIESER TASTE
                         C      S4.WEIT:    LD      A,5                 ;BILD LOESCHEN
                         C                  LD      (MS.CMD),A
                         C                  CALL    MO.MONI
                         C                  LD      A,22                ;CURSOR HOME
                         C                  LD      (MS.CMD),A
'BASIC- SVC - Routinen fuer Speichererweiterung'	MACRO-80 3.44	09-Dec-81	PAGE	1-181


                         C                  CALL    MO.MONI
                         C                  LD      A,0FFH              ;INI FUER ZEILENZAEHLER
                         C      S4.NIVOL:   INC     A                   ;EINE ZEILE MEHR
                         C                  LD      (S2.DM2),A          ;ABLEGEN DES ZEILENZAEHLERS
                         C                  LD      HL,S0.PFFI+89       ;1. BYTE DER 2. AUSGABEZEILE
                         C                  LD      A,' '
                         C                  CP      (HL)                ;NOCH SPRUNGBEFEHL IN 2. AUSGABEZEILE ?
                         C                  JR      Z,S4.WIREE          ;SPRUNG, WENN WIRKLICH EINE ZEILE REICHT
                         C                  LD      A,24                ;VEKTOR SCHREIBEN
                         C                  LD      (MS.CMD),A
                         C                  LD      HL,S0.PFFI+80       ;1. BYTE DER ZWEITEN AUSGABEZEILE
                         C                  LD      B,80                ;LAENGE 80 BYTES
                         C                  CALL    MO.MONI
                         C                  LD      A,' '
                         C                  LD      (S0.PFFI+89),A      ;DAMIT BEI OBIGEM TEST DURCHRUTSCHEN MOEGLICH
                         C                  JR      S4.TEVOL            ;SPRUNG ZUM TEST OB BS VOLL
                         C      S4.WIREE:   LD      HL,(S2.TE)
                         C                  JP      S4.PREN
                         C      S4.ENDE:    RET
                         C      ;****************************************************************
                         C      ;*         UMWANDLUNG EINER ZAHL KLEINER 65535 IN ASCII-ZEICHEN *
                         C      ;****************************************************************
                         C      S4.DUDEZ:   XOR     A
                         C                  LD      BC,10000
                         C      S4.SCL10:   SBC     HL,BC
                         C                  JR      C,S4.NEGZT
                         C                  INC     A
                         C                  JR      S4.SCL10
                         C      S4.NEGZT:   ADD     HL,BC
                         C                  ADD     A,30H
                         C                  LD      (DE),A
                         C                  INC     DE
                         C                  XOR     A
                         C                  LD      BC,1000
                         C      S4.SCL11:   SBC     HL,BC
                         C                  JR      C,S4.NEGT
                         C                  INC     A
                         C                  JR      S4.SCL11
                         C      S4.NEGT:    ADD     HL,BC
                         C                  ADD     A,30H
                         C                  LD      (DE),A
                         C                  INC     DE
                         C                  XOR     A
                         C                  LD      BC,100
                         C      S4.SCL12:   SBC     HL,BC
                         C                  JR      C,S4.NEGH
                         C                  INC     A
                         C                  JR      S4.SCL12
                         C      S4.NEGH:    ADD     HL,BC
                         C                  ADD     A,30H
                         C                  LD      (DE),A
                         C                  INC     DE
                         C                  XOR     A
                         C                  LD      BC,10
                         C      S4.SCL13:   SBC     HL,BC
                         C                  JR      C,S4.NEGZ
                         C                  INC     A
                         C                  JR      S4.SCL13
                         C      S4.NEGZ:    ADD     HL,BC
                         C                  ADD     A,30H
                         C                  LD      (DE),A
                         C                  INC     DE
                         C                  LD      A,L
                         C                  ADD     A,30H
                         C                  LD      (DE),A
                         C                  RET
                         C      ;INPUTS:  HL- 2BYTE HEXADEZIMAL
                         C      ;         DE- ADRESSE ZUR ABLAGE DER 5 ASCII-ELEMENTE
                         C      ;OUTPUTS: (DE)...(DE+4) 5 ASCII-ZEICHEN
                         C      ;***************************************************************
                         C      ;AUSGABEZEILE LOESCHEN
                         C      ;***************************************************************
                         C      S4.LEER:    EXX
                         C                  LD      HL,S0.PFFI
                         C                  LD      DE,S0.PFFI+1
                         C                  LD      BC,09FH
                         C                  LD      (HL),' '
                         C                  LDIR
                         C                  EXX
                         C                  RET
                         C      ;***************************************************************
                         C      ;SUCHEN UNGLEICH BLANK
                         C      ;***************************************************************
'BASIC- SVC - Routinen fuer Speichererweiterung'	MACRO-80 3.44	09-Dec-81	PAGE	1-182


                         C      S4.SUNBL:   LD      A,' '
                         C      S4.SUCH:    CP      (HL)
                         C                  JR      NZ,S4.ZUNBL
                         C                  INC     HL
                         C                  DEC     D
                         C                  JR      NZ,S4.SUCH
                         C                  JR      S4.SUEND
                         C      S4.ZUNBL:   LD      A,(HL)
                         C      ;
                         C      ;INPUTS:   HL-ANFANGSADRESSE
                         C      ;          D -WIE OFT SUCHEN
                         C      ;OUTPUTS:  HL-ADRESSE DER Z. UNGLEICH BLANK
                         C      ;          ODER ZEIGT AUF Z. HINTER D. UNTERSUCHTEM Z.
                         C      ;          A -WAS GEFUNDEN WURDE
                         C      ;
                         C      S4.SUEND:   RET
                         C      
                         C      
                         C                  ENDIF
                         C      
                         C      ;           END
                         C      ;           PN      SM01
                         C                  TITLE   'Drucker-Verbindungsmodul fuer Version 2.1'
                         C                  PAGE
'Drucker-Verbindungsmodul fuer Version 2.1'	MACRO-80 3.44	09-Dec-81	PAGE	1-183


                         C      
                         C      ;****************************************************************
                         C      ;*                  Drucker-Verbindungsmodul fuer Version 2.1   *
                         C      ;*  Version         --------------------------------------------*
                         C      ;*                  Programmierer: M. Herbote  K EAW  ZFT (WFT) *
                         C      ;*  V 2 . 1         --------------------------------------------*
                         C      ;*                  Stand        : 17.August 1984               *
                         C      ;****************************************************************
                         C      
                         C      SM.DRU      MACRO   UP
                         C                  PUSH    IX
                         C                  PUSH    DE
                         C                  LD      IX,S3.PRIN-S3.SEAT
                         C                  LD      DE,S0.DEAT+3
                         C                  ADD     IX,DE
                         C                  CALL    S0.KRZU
                         C                  CALL    UP
                         C                  ENDM
                         C      
  F54B                   C      SM.MRES:    SM.DRU  S0.MRES
  F54B    DD E5          C+                 PUSH    IX
  F54D    D5             C+                 PUSH    DE
  F54E    DD 21 0091     C+                 LD      IX,S3.PRIN-S3.SEAT
  F552    11 A803        C+                 LD      DE,S0.DEAT+3
  F555    DD 19          C+                 ADD     IX,DE
  F557    CD F61C        C+                 CALL    S0.KRZU
  F55A    CD 4046        C+                 CALL    S0.MRES
  F55D    18 12          C                  JR      SM.M1
                         C      
  F55F                   C      SM.PRIO:    SM.DRU  S0.PRIO
  F55F    DD E5          C+                 PUSH    IX
  F561    D5             C+                 PUSH    DE
  F562    DD 21 0091     C+                 LD      IX,S3.PRIN-S3.SEAT
  F566    11 A803        C+                 LD      DE,S0.DEAT+3
  F569    DD 19          C+                 ADD     IX,DE
  F56B    CD F61C        C+                 CALL    S0.KRZU
  F56E    CD 4049        C+                 CALL    S0.PRIO
  F571    CD B2D4        C      SM.M1:      CALL    S2.STACK
  F574    D1             C                  POP     DE
  F575    DD E1          C                  POP     IX
  F577    C9             C                  RET
                         C      
                         C      ;           END
                         C      ;           PN      S052
                         C                  TITLE   'Adresskonstanten fuer das System 2.1'
                         C                  PAGE    87
'Adresskonstanten fuer das System 2.1'	MACRO-80 3.44	09-Dec-81	PAGE	1-184


                         C      
                         C      ;****************************************************************
                         C      ;*              Peripherie- und Speicher-adresskonstanten fuer  *
                         C      ;*              das Betriebssystem         D  E  G  2  0  0  0  *
                         C      ;****************************************************************
  0032                   C      S0.V1       EQU     '2'                 ;Version des Systems
  0031                   C      S0.V2       EQU     '1'
  0033                   C      S0.V3       EQU     '3'                 ;Release
  0031                   C      S0.V5       EQU     '1'                 ; "1" ---  DEG2.i von Kassette
                         C                                              ; "2" ---  DEG2.i auf E PROM
  0031                   C      S0.V6       EQU     '1'                 ; "1" ---  BASIC  von Kassette
                         C                                              ; "2" ---  BASIC  auf E PROM
  0045                   C      S0.V7       EQU     'E'
                         C      
  3232                   C      S0.D1       EQU     03232H              ;Ausgabedatum des Systems
  3330                   C      S0.D2       EQU     03330H
  3538                   C      S0.D3       EQU     03538H
  0018                   C      S0.ZANZ     EQU     24                  ;Zeilenanzahl  ABS
  0050                   C      S0.SPANZ    EQU     80                  ;Spaltenanzahl ABS
  000B                   C      S0.SYSZ     EQU     11                  ;Systemeingabezeile
  0002                   C      S0.ZEIT1    EQU     2                   ;Zeitkonstante 1 Tastatur
  0010                   C      S0.ZEIT2    EQU     16                  ;Zeitkonstante 2 Tastatur
  0100                   C      S0.LRECL    EQU     256                 ;Standardblocklaenge Kassette
                         C      
  2917                   C      S0.FKADR    EQU     02917H              ;Zeile 23 , Spalte 41
  2918                   C      S0.SKADR    EQU     02918H              ;Zeile 24 , Spalte 41
                         C      
  0000                   C      S0.ADA      EQU     000H                ;Peripherieadresse A D A
  00C0                   C      S0.TRAM     EQU     0C0H                ;Peripherieadresse T R A M
  0030                   C      S0.AKB      EQU     030H                ;Peripherieadresse A K B
  0040                   C      S0.DRU      EQU     040H                ;Peripherieadresse Drucker
  0050                   C      S0.V24      EQU     050H                ;Peripherieadresse V 2 4
  00A0                   C      S0.PTAST    EQU     0A0H                ;Peripherieadresse Tastatur
  00E0                   C      S0.PROM     EQU     0E0H                ;Peripherieadresse P P E
  00C0                   C      S0.SBST     EQU     0C0H                ;Peripherieadresse S B S T
                         C      
  0000                   C      S0.RAM      EQU     00000H              ;Anfangsadresse    Arbeits-RAM
  AFFE                   C      S0.STACK    EQU     0B000H-2            ;Stackanfang
  3000                   C      S0.BWS      EQU     03000H
  A000                   C      S0.BWSA     EQU     0A000H              ;Anfangsadresse    Bildwiederholspeicher
  A800                   C      S0.DEAT     EQU     0A800H              ;Dynamische     E/A-Tabelle
  B7D0                   C      S0.VPI      EQU     0BFFFH-00830H+1     ;Vorbereich     Eingabepuffer
  B7E0                   C      S0.PFFI     EQU     S0.VPI+00010H       ;               Eingabepuffer
  BBE0                   C      S0.NPI      EQU     S0.VPI+00410H       ;Nachbereich    Eingabepuffer
  BBF0                   C      S0.PFFA     EQU     S0.VPI+00420H       ;               Ausgabepuffer
  BFF0                   C      S0.NPA      EQU     S0.VPI+00820H       ;Nachbereich    Ausgabepuffer
  0100                   C      S0.TPA      EQU     S0.RAM+00100H       ;Anfangsadresse Textpuffer (EDITOR-Raum)
  80FF                   C      S0.TPE      EQU     080FFH
  9FFF                   C      S0.MEMCK    EQU     09FFFH
                         C      
  F578    C4EB           C      S0.IV:      DW      S1.IO               ;Interruptroutine: EI,RETI
  0058                   C      S0.IVSYS    EQU     0058H               ;LOW(IV)
                         C      
                         C                  TITLE   'Systemkommando  S Y S 1'
                         C                  PAGE
'Systemkommando  S Y S 1'	MACRO-80 3.44	09-Dec-81	PAGE	1-185


                         C      
                         C      ;****************************************************************
                         C      ;*                 Systemkommando :  S Y S 1                    *
                         C      ;****************************************************************
  F57A    F57A           C                  DW      $
  F57C    53 31 20 20    C                  DB      'S1  '
                         C      
  F580    CD F5A0        C      S0.DEG1:    CALL    S0.EM12
  F583    C3 0000        C                  JP      0                   ;Sprung zum ZRE-EPROM
                         C      
                         C                  TITLE   'Systemkommando  S Y S 2'
                         C                  PAGE
'Systemkommando  S Y S 2'	MACRO-80 3.44	09-Dec-81	PAGE	1-186


                         C      
                         C      ;****************************************************************
                         C      ;*                 Systemkommando :  S Y S 2                    *
                         C      ;****************************************************************
  F586    31 B000        C      S0.DEG2:    LD      SP,S0.STACK+2
  F589    CD F58F        C                  CALL    S0.EM11
  F58C    C3 C084        C                  JP      S1.RES1
                         C      
                         C                  TITLE   'Umschalten  fuer Emulator'
                         C                  PAGE
'Umschalten  fuer Emulator'	MACRO-80 3.44	09-Dec-81	PAGE	1-187


                         C      
                         C      ;****************************************************************
                         C      ;*            Umschalten Speicherbereiche Emulator              *
                         C      ;****************************************************************
  F58F    C5             C      S0.EM11:    PUSH    BC                  ;komplett Speicherbereich 2
  F590    E5             C                  PUSH    HL
  F591    01 04C0        C                  LD      BC,004C0H
  F594    21 F59C        C                  LD      HL,S0.EM111
  F597    ED B3          C                  OTIR
  F599    E1             C                  POP     HL
  F59A    C1             C                  POP     BC
  F59B    C9             C                  RET
  F59C    F0             C      S0.EM111:   DB      0F0H                ;Startbyte
  F59D    03             C                  DB      003H                ;wahl
  F59E    0B             C                  DB      00BH                ;Sys_21
  F59F    FF             C                  DB      0FFH                ;Endbyte
                         C      
  F5A0    C5             C      S0.EM12:    PUSH    BC                  ;0000-7FFF Speicherbereich 1
                         C                                              ;8000-FFFF Speicherbereich 2
  F5A1    E5             C                  PUSH    HL
  F5A2    01 04C0        C                  LD      BC,004C0H
  F5A5    21 F5AD        C                  LD      HL,S0.EM121
  F5A8    ED B3          C                  OTIR
  F5AA    E1             C                  POP     HL
  F5AB    C1             C                  POP     BC
  F5AC    C9             C                  RET
  F5AD    F0             C      S0.EM121:   DB      0F0H                ;Startbyte
  F5AE    03             C                  DB      003H                ;wahl
  F5AF    0C             C                  DB      00CH                ;Sys_22
  F5B0    FF             C                  DB      0FFH                ;Endbyte
                         C      
                         C                  TITLE   'Umschalten  B W S A <==> B W S'
                         C                  PAGE
'Umschalten  B W S A <==> B W S'	MACRO-80 3.44	09-Dec-81	PAGE	1-188


                         C      
                         C      ;****************************************************************
                         C      ;*            Umschalten Einzelzeichen                          *
                         C      ;****************************************************************
  F5B1    7E             C      S0.BWSUZ:   LD      A,(HL)              ;B W S A  ===>  B W S
  F5B2    C5             C                  PUSH    BC
  F5B3    D5             C                  PUSH    DE
  F5B4    E5             C                  PUSH    HL
  F5B5    F5             C                  PUSH    AF
  F5B6    CD B2D6        C                  CALL    S2.STACK+2
  F5B9    F1             C      S0.UZ90:    POP     AF
  F5BA    E1             C                  POP     HL
  F5BB    E5             C                  PUSH    HL
  F5BC    F5             C                  PUSH    AF
  F5BD    B7             C                  OR      A
  F5BE    ED 5B B194     C                  LD      DE,(MS.BWSA)
  F5C2    ED 52          C                  SBC     HL,DE
  F5C4    11 3000        C                  LD      DE,S0.BWS
  F5C7    19             C                  ADD     HL,DE
  F5C8    F1             C                  POP     AF
  F5C9    77             C                  LD      (HL),A
  F5CA    CD B2D4        C                  CALL    S2.STACK
  F5CD    18 16          C                  JR      S0.US98
                         C      
                         C      ;****************************************************************
                         C      ;*             Umschalten des gesamten BWS                      *
                         C      ;****************************************************************
  F5CF    C5             C      S0.BWSUS:   PUSH    BC                  ;B W S A  ===>  B W S
  F5D0    D5             C                  PUSH    DE
  F5D1    E5             C                  PUSH    HL
  F5D2    F5             C                  PUSH    AF
  F5D3    CD B2D6        C      S0.US90:    CALL    S2.STACK+2
  F5D6    2A B194        C                  LD      HL,(MS.BWSA)
  F5D9    11 3000        C                  LD      DE,S0.BWS
  F5DC    01 0780        C      S0.US99:    LD      BC,00780H           ;00800H nur 24*80
  F5DF    ED B0          C                  LDIR
  F5E1    CD B2D4        C                  CALL    S2.STACK
  F5E4    F1             C                  POP     AF
  F5E5    E1             C      S0.US98:    POP     HL
  F5E6    D1             C                  POP     DE
  F5E7    C1             C                  POP     BC
  F5E8    C9             C                  RET
                         C      
  F5E9    C5             C      S0.BWSU1:   PUSH    BC                  ;B W S  ===>  B W S A
  F5EA    D5             C                  PUSH    DE
  F5EB    E5             C                  PUSH    HL
  F5EC    F5             C                  PUSH    AF
  F5ED    CD B2D6        C                  CALL    S2.STACK+2
  F5F0    21 3000        C                  LD      HL,S0.BWS
  F5F3    ED 5B B194     C                  LD      DE,(MS.BWSA)
  F5F7    18 E3          C                  JR      S0.US99
                         C      
                         C                  TITLE   'B W S   zu-/ab-schalten'
                         C                  PAGE
'B W S   zu-/ab-schalten'	MACRO-80 3.44	09-Dec-81	PAGE	1-189


                         C      
  F5F9    18 04          C      S0.BWSB:    JR      S0.BWSAB
                         C      
  F5FB                   C      S0.BWSZU    EQU     $                   ;B W S  zuschalten
  F5FB    CD F5A0        C                  CALL    S0.EM12
  F5FE    C9             C                  RET
                         C      
                         C                  PAGE
'B W S   zu-/ab-schalten'	MACRO-80 3.44	09-Dec-81	PAGE	1-190


                         C      
  F5FF                   C      S0.BWSAB    EQU     $                   ;B W S  abschalten
  F5FF    CD F58F        C                  CALL    S0.EM11
  F602    C9             C                  RET
                         C      
                         C                  TITLE   'BASIC-Laden'
                         C                  PAGE
'BASIC-Laden'	MACRO-80 3.44	09-Dec-81	PAGE	1-191


                         C      
                         C      ;****************************************************************
                         C      ;*                 Laden des BASIC - Interpreters               *
                         C      ;****************************************************************
  F603                   C      S0.BASCL    EQU     $
                         C      
                         C                  IF      S0.V6 AND 1
  F603    21 0A44        C                  LD      HL,00A44H
  F606    22 0307        C                  LD      (BC.USR+1),HL
                         C                  ENDIF
                         C      
  F609    21 0000        C                  LD      HL,0                ;ersten 100H-Byte loeschen
  F60C    11 0001        C                  LD      DE,1
  F60F    01 00FF        C                  LD      BC,255
  F612    71             C                  LD      (HL),C
  F613    ED B0          C                  LDIR
  F615    C3 F539        C                  JP      S4.BSCN
                         C      
                         C      ;****************************************************************
                         C      ;*                 Tastatur- bzw. BAMOS-Kassettenroutinen aus   *
                         C      ;*                 DEG 2000 Version 1.2 aktivieren              *
                         C      ;****************************************************************
  F618    CD F5A0        C      S0.TAZU:    CALL    S0.EM12
  F61B    C9             C                  RET
                         C      
  F61C    CD F58F        C      S0.KRZU:    CALL    S0.EM11
  F61F    C9             C                  RET
                         C      
                         C      ;           END
                         C      ;           PN      S099
                         C      ;****************************************************************
                         C      ;*               C T C - Interruptadresse fuer Echtzeituhr      *
                         C      ;*  Version      -----------------------------------------------*
                         C      ;*               Programmierer: M. Herbote --- K EAW  ZFT (WFT) *
                         C      ;*  V 2 . 1      -----------------------------------------------*
                         C      ;*               Stand        : 14.August 1984                  *
                         C      ;****************************************************************
                         C      
                         C                  IF      S4.V1 AND 00001000B
                         C      S0.CTC0:    DW      S4.IRTIM
                         C                  ENDIF
                         C      
                         C      ;           END
                                
  F620                          XXXX        EQU     $
                                            .DEPHASE
                                
                                            TITLE   'Symbolliste SYS 2.13'
                                            END
'Symbolliste SYS 2.13'	MACRO-80 3.44	09-Dec-81	PAGE	S


Macros:
S3.RMOS         SM.DRU          TA.TAST         

Symbols:
30B2 	BC.ANF          0451 	BC.C006         0948 	BC.C032         
171B 	BC.C091         1F40 	BC.CALL1        1F4B 	BC.CALL2        
0309 	BC.CIN          030F 	BC.CON          0318 	BC.CSTSX        
0150 	BC.D017         015E 	BC.D024         0160 	BC.D025         
0162 	BC.D026         019A 	BC.D047         01AB 	BC.D058         
1F57 	BC.D101         2FB7 	BC.D131         03A6 	BC.GRF1         
2CC0 	BC.GRF2         0300 	BC.INIT         0315 	BC.LISTX        
0327 	BC.PAR          0303 	BC.RECOV        3010 	BC.RECOV1       
030C 	BC.RIV          032A 	BC.RUCK         03C6 	BC.SVC1         
2D98 	BC.SVC2         0306 	BC.USR          0312 	BC.WRTV         
D4B3 	K1.ADRK1        D4D9 	K1.ADRK2        D4FF 	K1.ADRK3        
D525 	K1.ADRK4        D576 	K1.ARBT         D54B 	K1.ARMB         
D569 	K1.ARMB0        D56C 	K1.ARMB1        D566 	K1.ARMBM        
DB29 	K1.AUS          D75E 	K1.BERT         D58F 	K1.BLKM         
D581 	K1.BLKP         D5CE 	K1.BM           DA03 	K1.CLS          
DAF0 	K1.EIN          DB0B 	K1.EINP         DB0E 	K1.EINP1        
DB25 	K1.EINP2        D664 	K1.ERRT         D5D5 	K1.F17          
D620 	K1.FL           DB48 	K1.FU           D82E 	K1.GNCLS        
D7E9 	K1.GNLM         D7EB 	K1.GNLMN        D7B1 	K1.GNLP         
D7B3 	K1.GNLPN        D725 	K1.GNRA         D85B 	K1.GNRD         
D885 	K1.GNRDR        D708 	K1.GNRE         D6F9 	K1.GNRE1        
D780 	K1.GNRM         D765 	K1.GNRP         D740 	K1.GNRW         
D92B 	K1.GNRW1        D91A 	K1.GNRW2        D937 	K1.GNRW3        
D8EF 	K1.GNRWR        D88B 	K1.GNRZ         D8C4 	K1.GNRZE        
D6B1 	K1.GNSTS        D998 	K1.GNTS1        D98E 	K1.GNTS2        
D8CB 	K1.GNWR         D93A 	K1.GNWRT        D957 	K1.GNZKL        
DB51 	K1.LESV         D5C1 	K1.LHLBC        DA81 	K1.LM           
D7FF 	K1.LM1          D809 	K1.LM2          D819 	K1.LM3          
DA68 	K1.LP           D7CE 	K1.LP1          D7D5 	K1.LP2          
D7E5 	K1.LP3          DD83 	K1.M0           DDBD 	K1.M2           
DDE3 	K1.M3           DE1D 	K1.M5           DE29 	K1.M6           
DE40 	K1.ME1          DE43 	K1.ME2          DE59 	K1.ME3          
DE72 	K1.ME4          D60F 	K1.MONI         DC4F 	K1.MRAP1        
DC5D 	K1.MRAP2        DC71 	K1.MRAP3        DC2B 	K1.MRAP4        
DC79 	K1.MRAP5        DC26 	K1.MRAPO        DBA0 	K1.MRC1         
DBC0 	K1.MRC2         DBCA 	K1.MRC3         DBD5 	K1.MRC4         
DBCF 	K1.MRC5         DB84 	K1.MRCAT        DC93 	K1.MRCL1        
DCA7 	K1.MRCL2        DCEF 	K1.MRCL3        DD02 	K1.MRCL4        
DC83 	K1.MRCLS        DBE4 	K1.MREPO        DC0C 	K1.MRPO3        
DBF6 	K1.MRPO4        DC16 	K1.MRPO5        D647 	K1.MVL          
D630 	K1.MVS          D870 	K1.PUFT         D5AB 	K1.RCZM         
D5B9 	K1.RCZN         D59D 	K1.RCZP         D5BA 	K1.RCZS         
D856 	K1.RD1          D5ED 	K1.RGL1         D5FE 	K1.RGL2         
DA4F 	K1.RM           DA36 	K1.RP           D9EA 	K1.RV1          
D758 	K1.RW1          D751 	K1.RW3          D81B 	K1.RW4          
DB6E 	K1.SCHR         D9B2 	K1.SRV          DA1C 	K1.STS          
DA84 	K1.STS1         D9CB 	K1.UNL          DA9A 	K1.WR1          
D99D 	K1.WRTEN        DABF 	K1.XA           DAC2 	K1.XA1          
DAEA 	K1.XE           DE8C 	K1.ZMIN         D653 	K1.ZPR2         
D661 	K1.ZPR3         B12E 	K2.ADREA        B13A 	K2.ADRK         
B11E 	K2.BLK          B120 	K2.BLZ          B132 	K2.FKADR        
B136 	K2.FRADR        B130 	K2.GADR         B12A 	K2.GNW1         
B138 	K2.LRECL        B12C 	K2.PTADR        B162 	K2.RBER         
B11C 	K2.RCZ          B122 	K2.RCZB         B134 	K2.SKADR        
B126 	K2.TXANF        B128 	K2.TXEND        B124 	K2.TXOP         
B119 	KS.ADR          B000 	KS.AEATB        B11B 	KS.CONTR        
B00C 	KS.CRCZ         B00E 	KS.FEHLZ        B012 	KS.IDAT         
B117 	KS.KOMDO        B00F 	KS.POS          B013 	KS.PUFFS        
B002 	KS.PZAUS        B004 	KS.PZEIN        B011 	KS.SDAT         
B00A 	KS.Z1           B00B 	KS.Z2           B006 	KS.ZAUS         
B008 	KS.ZEIN         B118 	KS.ZEITK        E0C9 	LO.AL           
E175 	LO.DF           DECC 	LO.EIN          E239 	LO.EIN1         
DF74 	LO.EIN2         DF7B 	LO.EIN3         DEBE 	LO.LO1          
DFB9 	LO.LO10         DEB3 	LO.LO11         DF4C 	LO.LO12         
DF0F 	LO.LO13         DF28 	LO.LO14         DF7E 	LO.LO15         
DF8C 	LO.LO18         DF8F 	LO.LO19         DEE9 	LO.LO2          
DEEE 	LO.LO4          DF18 	LO.LO5          DF1B 	LO.LO6          
DF22 	LO.LO7          DF61 	LO.LO8          DFA4 	LO.LO9          
DEDC 	LO.LOAUS        DED2 	LO.LOEIN        E26A 	LO.RGL          
E275 	LO.RGL1         E0FA 	LO.RL           E0FE 	LO.RL1          
E187 	LO.RL10         E106 	LO.RL2          E113 	LO.RL3          
E12D 	LO.RL4          E14D 	LO.RL5          E156 	LO.RL6          
E158 	LO.RL7          E161 	LO.RL8          E170 	LO.RL9          
E17B 	LO.RLUP         E1AB 	LO.SAV1         E08B 	LO.SAV12        
E0A3 	LO.SAV13        E0AF 	LO.SAV14        E1B3 	LO.SAV2         
E030 	LO.SAV3         E036 	LO.SAV4         E04B 	LO.SAV7         
E057 	LO.SAV8         E06C 	LO.SAV9         E196 	LO.SAVE         
E1B4 	LO.SV1          E1B6 	LO.SV2          E1C7 	LO.SV3          
E1D3 	LO.SV4          E248 	LO.TR1          E1DE 	LO.TXT          
'Symbolliste SYS 2.13'	MACRO-80 3.44	09-Dec-81	PAGE	S-1


E279 	LO.TXT1         E365 	LO.TXT10        E38B 	LO.TXT11        
E2C4 	LO.TXT12        E2CF 	LO.TXT13        E2FE 	LO.TXT14        
E316 	LO.TXT15        E28E 	LO.TXT2         E2A3 	LO.TXT3         
E2AE 	LO.TXT4         E2B9 	LO.TXT5         E2DA 	LO.TXT6         
E2E9 	LO.TXT7         E319 	LO.TXT8         E33F 	LO.TXT9         
E0CD 	LO.UW           E0DC 	LO.UW1          E0E5 	LO.UWEND        
CF49 	MO.ADDBL        CBC5 	MO.ANZ          CBFE 	MO.BILO         
CF40 	MO.BWSAF        CF45 	MO.BWSE         CF5F 	MO.BWSL         
CB3F 	MO.BWSUS        CB49 	MO.BWSUZ        CFD0 	MO.CNZAL        
CFC5 	MO.CNZAS        CEFB 	MO.CPOL         CEF6 	MO.CPOS         
CD8A 	MO.DEC2         CDA3 	MO.DEC3         CE1F 	MO.DEC4         
CDF1 	MO.DEC5         CE26 	MO.DEC6         CE17 	MO.DEC7         
CD82 	MO.DECS         CD70 	MO.DECZ         CF58 	MO.DESZ         
CD61 	MO.DIL          CD92 	MO.DIS          CD5B 	MO.DSPOL        
CD7A 	MO.DSPOS        CD53 	MO.DZPOL        CD68 	MO.DZPOS        
CB34 	MO.ENMO         CB3E 	MO.ENMOT        CC14 	MO.FSLO         
CC32 	MO.FSLO1        CC4D 	MO.FSLO2        CFB8 	MO.HOMEL        
CFAB 	MO.HOMES        CEF3 	MO.INC1         CE61 	MO.INC2         
CEF1 	MO.INC3         CEF4 	MO.INC4         CEED 	MO.INC5         
CEBB 	MO.INC6         CEE8 	MO.INC7         CEE1 	MO.INC8         
CE59 	MO.INCS         CE46 	MO.INCZ         CE34 	MO.ISPOL        
CE50 	MO.ISPOS        CE2B 	MO.IZPOL        CE3D 	MO.IZPOS        
CF7C 	MO.LCP1         CF9A 	MO.LCP2         CF8D 	MO.LCPOL        
CF6F 	MO.LCPOS        CF0D 	MO.LSA          CF1F 	MO.LSAF         
CF2D 	MO.LZA          CF30 	MO.LZA1         CF3B 	MO.LZAF         
CB10 	MO.MONI         CB3C 	MO.MORT         CB53 	MO.MOTAB        
CFF4 	MO.MPL          CFE5 	MO.MPS          CFFA 	MO.MSL          
D11F 	MO.MVL          D12A 	MO.MVL1         D101 	MO.MVS          
D10C 	MO.MVS1         CFED 	MO.MZL          D0E0 	MO.MZLN         
D100 	MO.MZLNO        D100 	MO.MZLNW        D0C0 	MO.MZLO         
D0F0 	MO.MZLS         D100 	MO.MZLSO        D100 	MO.MZLSW        
D0D0 	MO.MZLW         CFDB 	MO.MZS          D0BD 	MO.MZSL         
D09D 	MO.MZSN         D0BF 	MO.MZSNO        D0BF 	MO.MZSNW        
D029 	MO.MZSO         D042 	MO.MZSO1        D045 	MO.MZSO2        
D055 	MO.MZSO3        D0AD 	MO.MZSS         D0BF 	MO.MZSSO        
D0BF 	MO.MZSSW        D063 	MO.MZSW         D07C 	MO.MZSW1        
D07F 	MO.MZSW2        D08F 	MO.MZSW3        CF4C 	MO.PNSP         
CF52 	MO.PNSP1        CF69 	MO.POSA         CD43 	MO.RESC         
CD50 	MO.RESC1        CD9D 	MO.ROL1         CCB4 	MO.ROLI         
CCBC 	MO.ROLI1        CCC8 	MO.ROLI2        CCCF 	MO.ROLI3        
CD99 	MO.ROLL         CC52 	MO.ROOB         CC5C 	MO.ROOB1        
CC71 	MO.ROOB2        CC7A 	MO.ROOB3        CC87 	MO.ROOB4        
CCD1 	MO.RORE         CCDD 	MO.RORE1        CCEB 	MO.RORE2        
CCF4 	MO.RORL1        CCFF 	MO.RORL2        CD04 	MO.RORL3        
CD0B 	MO.RORL4        CD16 	MO.RORL5        CD1A 	MO.RORL6        
CCF8 	MO.RORL7        CC89 	MO.ROUN         CC96 	MO.ROUN1        
CCAF 	MO.ROUN2        CD20 	MO.SETC         CD3B 	MO.SETC1        
CF00 	MO.SSA          CF03 	MO.SSA1         CF12 	MO.SSAF         
CF15 	MO.SSAF1        CF1A 	MO.SSAF2        CBEF 	MO.SYSB         
CF24 	MO.SZA          CF27 	MO.SZA1         CF36 	MO.SZAF         
CBDE 	MO.VB2          CBCF 	MO.VOLLB        D019 	MO.ZLTAB        
D009 	MO.ZSTAB        B194 	MS.BWSA         B198 	MS.CMD          
B19E 	MS.CZEIT        B196 	MS.DIREL        B197 	MS.DIRES        
B19D 	MS.MCUR         B19C 	MS.MCZ          B19A 	MS.RADR         
B191 	MS.SMAX         B18F 	MS.SMIN         B193 	MS.SPANZ        
B18B 	MS.SPOL         B18D 	MS.SPOS         B199 	MS.TK           
B192 	MS.ZANZ         B190 	MS.ZMAX         B18E 	MS.ZMIN         
B18A 	MS.ZPOL         B18C 	MS.ZPOS         0000 	S0.ADA          
0030 	S0.AKB          F603 	S0.BASCL        3000 	S0.BWS          
A000 	S0.BWSA         F5FF 	S0.BWSAB        F5F9 	S0.BWSB         
F5E9 	S0.BWSU1        F5CF 	S0.BWSUS        F5B1 	S0.BWSUZ        
F5FB 	S0.BWSZU        3232 	S0.D1           3330 	S0.D2           
3538 	S0.D3           A800 	S0.DEAT         F580 	S0.DEG1         
F586 	S0.DEG2         0040 	S0.DRU          F58F 	S0.EM11         
F59C 	S0.EM111        F5A0 	S0.EM12         F5AD 	S0.EM121        
C000 	S0.ENTRY        2917 	S0.FKADR        F578 	S0.IV           
0058 	S0.IVSYS        F61C 	S0.KRZU         0100 	S0.LRECL        
9FFF 	S0.MEMCK        4046 	S0.MRES         BFF0 	S0.NPA          
BBE0 	S0.NPI          BBF0 	S0.PFFA         B7E0 	S0.PFFI         
4049 	S0.PRIO         00E0 	S0.PROM         00A0 	S0.PTAST        
0000 	S0.RAM          00C0 	S0.SBST         2918 	S0.SKADR        
0050 	S0.SPANZ        AFFE 	S0.STACK        000B 	S0.SYSZ         
4003 	S0.TA1          4006 	S0.TA2          F618 	S0.TAZU         
4015 	S0.TBEL         4012 	S0.TEM          400C 	S0.TFE          
400F 	S0.TIM          4000 	S0.TINIT        0100 	S0.TPA          
80FF 	S0.TPE          00C0 	S0.TRAM         F5D3 	S0.US90         
F5E5 	S0.US98         F5DC 	S0.US99         F5B9 	S0.UZ90         
0032 	S0.V1           0031 	S0.V2           0050 	S0.V24          
0033 	S0.V3           0031 	S0.V5           0031 	S0.V6           
0045 	S0.V7           B7D0 	S0.VPI          0018 	S0.ZANZ         
0002 	S0.ZEIT1        0010 	S0.ZEIT2        C2AB 	S1.ABFR         
C328 	S1.AEIN         C42D 	S1.ANZ1         C492 	S1.ANZ2         
C3FE 	S1.ANZ3         C418 	S1.ANZ4         C41D 	S1.ANZ5         
'Symbolliste SYS 2.13'	MACRO-80 3.44	09-Dec-81	PAGE	S-2


C3F1 	S1.ANZ6         C49D 	S1.ANZ7         C4AC 	S1.ANZ8         
C4A4 	S1.ANZ9         C3BF 	S1.ANZEI        C8B0 	S1.ANZU1        
C8C0 	S1.ANZU2        C825 	S1.ANZUM        C5FF 	S1.BHKON        
C652 	S1.CHK          C655 	S1.CHK1         CA65 	S1.CLOS         
C2D3 	S1.CNLS         C2EB 	S1.CNOS         C2B4 	S1.CNRS         
C2DF 	S1.CNUS         C300 	S1.CNZA         C7B1 	S1.CPI          
C7AD 	S1.CPI10        C2BE 	S1.CURS1        C2F9 	S1.CURS2        
C191 	S1.DAT          C750 	S1.DATE         C7FE 	S1.DB0          
C828 	S1.DB1          C837 	S1.DB10         C83A 	S1.DB11         
C82E 	S1.DB111        C844 	S1.DB12         C850 	S1.DB13         
C85B 	S1.DB14         C867 	S1.DB15         C86A 	S1.DB16         
C88E 	S1.DB2          C871 	S1.DB9          C322 	S1.DEL1         
C317 	S1.DEL2         C304 	S1.DELZL        C589 	S1.DIV          
C58A 	S1.DIV1         C86E 	S1.EINDB        C4EE 	S1.FEH          
C511 	S1.FEH1         C4F4 	S1.FEHR         C4F7 	S1.FEHRR        
C616 	S1.HB10         C5E6 	S1.HBK1         C5CC 	S1.HBKON        
C359 	S1.HC1          C35E 	S1.HC2          CA08 	S1.HCDB         
CA02 	S1.HCDB0        CA19 	S1.HCDB1        CA25 	S1.HCDB2        
CA28 	S1.HCDB3        CA35 	S1.HCDB4        CA42 	S1.HCDB5        
CA44 	S1.HCDB6        CA51 	S1.HCDB7        C354 	S1.HCOPY        
C54E 	S1.HDI          C56C 	S1.HDI1         C585 	S1.HDI2         
C582 	S1.HDI3         C2F7 	S1.HOME         C995 	S1.HXN1         
C592 	S1.IDH          C5B4 	S1.IDH1         C59A 	S1.IDH2         
C59E 	S1.IDH3         C5B0 	S1.IDHE         C5AE 	S1.IDHF         
C9FB 	S1.INC1         C9FE 	S1.INC2         C298 	S1.INIT5        
C2A0 	S1.INIT6        C270 	S1.INITE        C532 	S1.INPTR        
C4EB 	S1.IO           C771 	S1.IOCC         C5E8 	S1.KON1         
C60E 	S1.KON2         C5FA 	S1.KON3         C033 	S1.LA           
CA65 	S1.LESR         CA65 	S1.LESV         C7C5 	S1.LPI          
C7C1 	S1.LPI6         C62E 	S1.LT1Z         C92F 	S1.MEA          
C94A 	S1.MEA11        C94F 	S1.MEA12        C952 	S1.MEA13        
C990 	S1.MEA14        C9C1 	S1.MEA2         C981 	S1.MEA21        
C9C4 	S1.MEA3         C989 	S1.MEA31        C9D5 	S1.MEA32        
C9D8 	S1.MEA33        C9DC 	S1.MEA4         C978 	S1.MEA5         
C986 	S1.MEA6         C9ED 	S1.MEA7         C9F9 	S1.MEA8         
C9EF 	S1.MEA9         C935 	S1.MEAA         C9BF 	S1.MEAU1        
C9E4 	S1.MEAU2        C024 	S1.MO           C5C3 	S1.MUL10        
C640 	S1.MX           C8A2 	S1.NEG1         C8AC 	S1.NEG2         
C896 	S1.NEGDB        C042 	S1.NMI          C334 	S1.NN           
C33E 	S1.NN1          C345 	S1.NNN          C7D4 	S1.NULL         
C7D3 	S1.ONULL        CA65 	S1.OPEN         C883 	S1.POS1         
C88D 	S1.POS2         C877 	S1.POSDB        C9B0 	S1.PULOE        
C0B0 	S1.RES          C084 	S1.RES1         C64A 	S1.RNL          
C642 	S1.RNR          C07A 	S1.RST          C042 	S1.RST38        
CA65 	S1.SCHR         C8DB 	S1.SDB1         C926 	S1.SDB10        
C8E5 	S1.SDB2         C8E8 	S1.SDB3         C8F8 	S1.SDB4         
C904 	S1.SDB5         C913 	S1.SDB6         C915 	S1.SDB7         
C91B 	S1.SDB8         C925 	S1.SDB9         C5BC 	S1.SIEBD        
C02D 	S1.SM           C36F 	S1.START        C75B 	S1.STAS1        
C67C 	S1.STAT         C6DF 	S1.STT1         C6FA 	S1.STT2         
C701 	S1.STT3         C708 	S1.STT4         C70F 	S1.STT5         
C6A3 	S1.STTT1        C6A6 	S1.STTT2        C6B6 	S1.STTT3        
C6B9 	S1.STTT4        C6C9 	S1.STTT5        C6CC 	S1.STTT6        
C39B 	S1.SUCH1        C398 	S1.SUCH2        C393 	S1.SUCHE        
C620 	S1.SUZA         C624 	S1.SUZA1        C629 	S1.SUZA3        
C61A 	S1.SUZEI        C929 	S1.SYDB1        C8CD 	S1.SYDB2        
C8CA 	S1.SYSDB        C114 	S1.SYSTB        C20A 	S1.SYSTC        
C249 	S1.SYSTD        C4DB 	S1.SZA1         C4D7 	S1.SZAHL        
C4C1 	S1.SZEI         C4C4 	S1.SZEI1        C4CB 	S1.SZEI2        
C012 	S1.TA           C2A8 	S1.TFE          C4B7 	S1.VERG1        
C4BF 	S1.VERG2        C4B6 	S1.VERGL        C4E7 	S1.ZAHL         
C4E4 	S1.ZZA1         C4E0 	S1.ZZAHL        B26E 	S2.AADR         
B28A 	S2.AFOR         B28B 	S2.BZ           B263 	S2.CST          
B2D3 	S2.DDA          B2D2 	S2.DDAF         B2CA 	S2.DDAFS        
B2CB 	S2.DDAS         B2CD 	S2.DDB          B2CC 	S2.DDBC         
B2C4 	S2.DDBCS        B2C5 	S2.DDBS         B2CC 	S2.DDC          
B2C4 	S2.DDCS         B2CF 	S2.DDD          B2CE 	S2.DDDE         
B2C6 	S2.DDDES        B2C7 	S2.DDDS         B2CE 	S2.DDE          
B2B8 	S2.DDEI         B2C6 	S2.DDES         B2D2 	S2.DDF          
B2CA 	S2.DDFS         B2D1 	S2.DDH          B2D0 	S2.DDHL         
B2C8 	S2.DDHLS        B2C9 	S2.DDHS         B2BA 	S2.DDI          
B2B9 	S2.DDIM         B2C0 	S2.DDIX         B2C2 	S2.DDIY         
B2D0 	S2.DDL          B2C8 	S2.DDLS         B2BC 	S2.DDPC         
B2BB 	S2.DDR          B2BE 	S2.DDSP         B28F 	S2.DH           
B28E 	S2.DL           B29A 	S2.DM1          B2AA 	S2.DM2          
B292 	S2.DMANF        B296 	S2.DMBA         B298 	S2.DMBE         
B294 	S2.DMCUR        B2AB 	S2.DMH          B2AC 	S2.DML          
B26B 	S2.DNR          B257 	S2.END          B25F 	S2.IM           
B264 	S2.IOC          B270 	S2.KADR         B260 	S2.OM           
B290 	S2.PAR1         B25B 	S2.POIA         B259 	S2.POIE         
B265 	S2.PRGN         B25D 	S2.RADR         B26C 	S2.RBBR         
B2AF 	S2.S1           B2B0 	S2.S2           B2AD 	S2.SMHL         
B273 	S2.SP1          B274 	S2.SP2          B275 	S2.SP3          
'Symbolliste SYS 2.13'	MACRO-80 3.44	09-Dec-81	PAGE	S-3


B2D4 	S2.STACK        B28C 	S2.TE           B24F 	S2.TPA          
B251 	S2.TPE          B276 	S2.TRB          B261 	S2.VZM          
B253 	S2.WINA         B255 	S2.WINE         B272 	S2.ZP           
B262 	S2.ZZ           CB12 	S3.BLK1         CB36 	S3.BLK2         
CA6A 	S3.DATUM        CAAD 	S3.DFU          CB0F 	S3.ENDEA        
CA79 	S3.KS1          CA93 	S3.KS2          CB10 	S3.KSK1         
CB34 	S3.KSK2         CA74 	S3.LANG         CAC7 	S3.LBL          
CADF 	S3.LBS          CA66 	S3.MASK1        CA67 	S3.MASK2        
CA68 	S3.MASK3        CA69 	S3.MASK4        CB14 	S3.MRP1         
CB38 	S3.MRP2         CAF7 	S3.PRIN         CA70 	S3.PUFA         
CA72 	S3.PUFI         CB10 	S3.RCZ1         CB34 	S3.RCZ2         
CA66 	S3.SEAT         CA78 	S3.STI          F539 	S4.BSCN         
F539 	S4.BWS          F539 	S4.BWS1         F53D 	S4.RES          
00C0 	S4.SBST         F53A 	S4.SC700        F53A 	S4.SC710        
F53A 	S4.SC720        F53A 	S4.SC730        F53A 	S4.SC740        
F53A 	S4.SC750        F53A 	S4.SC760        F53A 	S4.SVC10        
F53A 	S4.SVC52        F53A 	S4.SVC60        F53A 	S4.SVC61        
F53A 	S4.SVC62        F53A 	S4.SVC63        F53A 	S4.SVC64        
F53A 	S4.SVC65        F53A 	S4.SVC66        F53A 	S4.SVC67        
F53A 	S4.SVC68        F53A 	S4.SVC69        00C0 	S4.U1           
0040 	S4.U2           F539 	S4.UM15         F53A 	S4.UM16         
F533 	S4.UM6          0031 	S4.V1           0031 	S4.V2           
F0C8 	S9.AB0          F0D4 	S9.AB01         F0AC 	S9.AB1          
F0B7 	S9.AB2          F0C2 	S9.AB3          F0A0 	S9.ABAUP        
F0FD 	S9.ADRTB        F278 	S9.AL           F2A3 	S9.AL1          
F293 	S9.AL2          F290 	S9.AL3          F235 	S9.ALLUP        
F246 	S9.ALUP1        E5D8 	S9.ANFG         E545 	S9.ANFP         
E5F4 	S9.ANFPG        F273 	S9.AP           F276 	S9.AP1          
F36D 	S9.APOS         F370 	S9.APOS1        E4F5 	S9.ATAB1        
E516 	S9.ATAB2        F0D6 	S9.AUP          E3C2 	S9.BASC         
E3DF 	S9.BASC1        E41C 	S9.BASC2        F26E 	S9.BC1          
E5FA 	S9.BCTB1        E612 	S9.BCTB2        F269 	S9.BLD          
F25F 	S9.BLD1         EB86 	S9.BM1          EB8A 	S9.BM2          
EB9C 	S9.BM3          EBA7 	S9.BM4          E46E 	S9.BSC          
E402 	S9.BSCR         EB0F 	S9.CCIN         EB17 	S9.CCIN1        
EB40 	S9.CCIN2        E657 	S9.CIN          E677 	S9.CIN1         
E66C 	S9.CIN2         EF99 	S9.CLO1         EF85 	S9.CLO2         
EF9F 	S9.CLO3         EFA9 	S9.CLO4         EF73 	S9.CLOS1        
EF6E 	S9.CLOSE        EF97 	S9.CLR          E6A6 	S9.CON          
E6F2 	S9.CON01        E702 	S9.CON09        E6C7 	S9.CON1         
E6CF 	S9.CON9         F364 	S9.CONO         E6D9 	S9.CONOC        
F36A 	S9.CONOO        F04F 	S9.COP1         F097 	S9.COP2         
F087 	S9.COP3         F061 	S9.COP5         F071 	S9.COP7         
F074 	S9.COP8         F09D 	S9.COP9         F041 	S9.COPY         
F398 	S9.CPOS         F22A 	S9.CR           E705 	S9.CST1         
E729 	S9.CST10        E72D 	S9.CST11        E709 	S9.CST2         
E70D 	S9.CST3         E711 	S9.CST4         E715 	S9.CST5         
E719 	S9.CST6         E71D 	S9.CST7         E721 	S9.CST8         
E725 	S9.CST9         E682 	S9.CSTS1        E72F 	S9.CSTS2        
E73B 	S9.CSTS3        E69A 	S9.CSTS4        E69E 	S9.CSTS5        
E68B 	S9.CSTSX        E869 	S9.DEL          E859 	S9.EIN1         
E862 	S9.EIN2         EE39 	S9.ENDEV        EE49 	S9.ERS          
EE56 	S9.ERS1         EE3C 	S9.ERSTR        E786 	S9.FB1          
E7BC 	S9.FBE          E7D0 	S9.FBE0         E75C 	S9.FBE1         
E79F 	S9.FBE12        E7B1 	S9.FBE13        E796 	S9.FBE2         
E7AE 	S9.FBE3         E422 	S9.FT1          E448 	S9.FT2          
F1B2 	S9.HCP          F1D8 	S9.HCP1         F1DA 	S9.HCP11        
F1DD 	S9.HCP12        F1E0 	S9.HCP13        F1F0 	S9.HCP2         
F206 	S9.HCP21        F20C 	S9.HCP22        F21F 	S9.HCP3         
F225 	S9.HCPE         E745 	S9.HOME         E53E 	S9.HOME1        
F353 	S9.ICON         E847 	S9.INSM         F3BB 	S9.IOC          
F3C1 	S9.IOC1         EC51 	S9.IOSTX        ECBC 	S9.IOX          
EC69 	S9.IOX0         EC71 	S9.IOX1         EC8F 	S9.IOX10        
ECA4 	S9.IOX11        ECAC 	S9.IOX12        ECB4 	S9.IOX13        
EC79 	S9.IOX2         EC81 	S9.IOX3         EC86 	S9.IOX8         
EC89 	S9.IOX9         EC8D 	S9.IOX90        ECB9 	S9.IOXE         
EB81 	S9.LESV         EC30 	S9.LISTX        EC43 	S9.LISTY        
EE78 	S9.LOAD         EDDE 	S9.MEMCK        F249 	S9.MEMO         
EFCA 	S9.MIR          EFD7 	S9.MOR          F304 	S9.MR1          
F2ED 	S9.MRAC         F2DC 	S9.MRAO         F2CB 	S9.MRIO         
F2F5 	S9.MRPAR        EAEE 	S9.NEG1         EAE3 	S9.NEGQ         
F3A2 	S9.NFENS        EE35 	S9.NISY         F37D 	S9.NPOS         
EE40 	S9.NSTR         F358 	S9.OCON         EEDC 	S9.OP1          
EF43 	S9.OP13         EF46 	S9.OP14         EEE7 	S9.OP2          
EF4E 	S9.OP20         EF5D 	S9.OP21         EF65 	S9.OP22         
EEFC 	S9.OP3          EF0C 	S9.OP4          EF14 	S9.OP5          
EEE9 	S9.OP7          EECD 	S9.OPEN         EED2 	S9.OPEN1        
EF6B 	S9.OPR          EDE3 	S9.OUT          EE0E 	S9.OUTLG        
E8BC 	S9.PF1          E979 	S9.PF10         E8C7 	S9.PF101        
E8DC 	S9.PF102        E8E9 	S9.PF103        E906 	S9.PF104        
E923 	S9.PF105        E938 	S9.PF106        E94D 	S9.PF107        
E96A 	S9.PF108        E977 	S9.PF109        E986 	S9.PF11         
E984 	S9.PF110        E991 	S9.PF111        E99E 	S9.PF112        
'Symbolliste SYS 2.13'	MACRO-80 3.44	09-Dec-81	PAGE	S-4


E993 	S9.PF12         E8D1 	S9.PF2          E8DE 	S9.PF3          
E8EB 	S9.PF4          E908 	S9.PF5          E925 	S9.PF6          
E93A 	S9.PF7          E94F 	S9.PF8          E96C 	S9.PF9          
EA89 	S9.POS1         EACE 	S9.POS2         EAD9 	S9.POS3         
EABB 	S9.POS4         EAC1 	S9.POS5         E803 	S9.POSQ1        
EA80 	S9.POSQ2        E818 	S9.PQ2TL        F0DF 	S9.RBAUP        
F0F0 	S9.RBP1         F0F9 	S9.RBP2         EFC0 	S9.RCL1         
EF77 	S9.RCL2         EFC5 	S9.RCL3         EF94 	S9.RCL4         
EFBB 	S9.RCL5         EFF8 	S9.RE9          EFE4 	S9.READ         
EFE9 	S9.READ1        EFFA 	S9.READ2        F021 	S9.RGLI         
F02D 	S9.RGLI1        F030 	S9.RGLI2        F031 	S9.RGLO         
F03D 	S9.RGLO1        F040 	S9.RGLO2        EB43 	S9.RIV          
EB4F 	S9.RIV1         EB55 	S9.RIV2         EB58 	S9.RIV4         
EB6F 	S9.RIV5         EB77 	S9.RIV6         EB7A 	S9.RIV9         
EB4C 	S9.RIVF         F2A5 	S9.RL           F2C6 	S9.RL1          
EE99 	S9.ROP1         EED6 	S9.ROP2         EE9E 	S9.ROP3         
EEAB 	S9.ROP4         EEB5 	S9.ROP7         EEC2 	S9.ROP8         
F0E9 	S9.RUP          EE58 	S9.SAVE         F40C 	S9.SC181        
F42C 	S9.SC182        F42E 	S9.SC183        F41A 	S9.SC184        
F4A6 	S9.SC191        F51D 	S9.SC271        F501 	S9.SC272        
F4F9 	S9.SC273        F51E 	S9.SC278        F518 	S9.SC279        
F4B2 	S9.SC331        F4C2 	S9.SC333        F52C 	S9.SC391        
F531 	S9.SC399        F46D 	S9.SC441        F472 	S9.SC442        
F475 	S9.SC443        F47A 	S9.SC444        F484 	S9.SC449        
F276 	S9.SC52E        E885 	S9.SCHL         E8A0 	S9.SCHR         
F3B6 	S9.SFENS        F318 	S9.SPA          F30F 	S9.SPAUS        
F321 	S9.SPI          F33D 	S9.SPIN         F32F 	S9.SPO          
F348 	S9.SPOUT        EC3E 	S9.STX2         EC41 	S9.STX9         
EE19 	S9.SUCHE        EE0E 	S9.SUSY         EDF5 	S9.SVC          
F3CE 	S9.SVC13        F486 	S9.SVC14        F3D6 	S9.SVC17        
F3DE 	S9.SVC18        F497 	S9.SVC19        F4C4 	S9.SVC27        
F4A8 	S9.SVC32        F4AE 	S9.SVC33        F520 	S9.SVC39        
F441 	S9.SVC43        F458 	S9.SVC44        E4D3 	S9.TALOE        
E646 	S9.TAS          F3C6 	S9.TAS0         F3C4 	S9.TAS01        
E64F 	S9.TAS1         E650 	S9.TAS2         E852 	S9.TL1          
E855 	S9.TL2          E9AA 	S9.TPF1         E9C2 	S9.TX1          
E9F6 	S9.TX2          EBB8 	S9.TXT1         EA32 	S9.TXT10        
EA36 	S9.TXT11        EA3A 	S9.TXT12        EA40 	S9.TXT13        
EA48 	S9.TXT14        EA4E 	S9.TXT15        EA52 	S9.TXT16        
EA58 	S9.TXT17        EA80 	S9.TXT18        EC0A 	S9.TXT2         
EA06 	S9.TXT3         EA16 	S9.TXT4         EA1B 	S9.TXT5         
EA20 	S9.TXT6         EA25 	S9.TXT7         EA28 	S9.TXT8         
EA2E 	S9.TXT9         EE3B 	S9.UEBGA        E9A0 	S9.UP1          
ECBD 	S9.USER         ED09 	S9.USER2        ED5A 	S9.USER3        
ECD0 	S9.USR1         ECE9 	S9.USR2         ED2C 	S9.USR22        
ED3F 	S9.USR23        ED56 	S9.USR24        ED50 	S9.USR25        
ECF4 	S9.USR3         EDA6 	S9.USR32        EDB8 	S9.USR33        
ED82 	S9.USR36        ED8A 	S9.USR37        ED9E 	S9.USR39        
ED07 	S9.USR4         ED4F 	S9.USR40        ED95 	S9.USR41        
EDC4 	S9.USR7         EDCF 	S9.USR8         EDD1 	S9.USR9         
F01F 	S9.WR9          F013 	S9.WRIT1        F00E 	S9.WRITE        
EBDE 	S9.WRTV         EBED 	S9.WRTV2        EC01 	S9.WRTV5        
EC02 	S9.WRTV6        EC08 	S9.WRTV9        EBE7 	S9.WRTVF        
E85C 	S9.ZS           E89E 	S9.ZS1          F571 	SM.M1           
F54B 	SM.MRES         F55F 	SM.PRIO         D297 	TA.ABF1         
D2F5 	TA.ABF10        D30F 	TA.ABF11        D315 	TA.ABF12        
D31B 	TA.ABF13        D288 	TA.ABF14        D282 	TA.ABF15        
D286 	TA.ABF16        D2A6 	TA.ABF2         D331 	TA.ABF20        
D2A9 	TA.ABF3         D2CB 	TA.ABF6         D2E3 	TA.ABF7         
D2E9 	TA.ABF8         D2EF 	TA.ABF9         D237 	TA.ABFR         
D247 	TA.ABFR1        D24A 	TA.ABFR2        D267 	TA.ABFR3        
D377 	TA.ABFR9        D224 	TA.BBB          D20F 	TA.E0IN         
D366 	TA.EAW2         D36A 	TA.EAW3         D37E 	TA.EAW4         
D402 	TA.ET1          D3FC 	TA.ET2          D385 	TA.EW1          
D3EF 	TA.FKT1         D3DA 	TA.FKT2         D3E7 	TA.FKT3         
D3F7 	TA.HZE          D3BC 	TA.INSMD        D3C5 	TA.INSME        
D3C6 	TA.INSML        D408 	TA.LOE          D420 	TA.LOES         
D2CA 	TA.MM           D19D 	TA.PIOPR        D3B2 	TA.STEU1        
D3A3 	TA.STEUT        D3D5 	TA.STZ          D13D 	TA.TA1          
D155 	TA.TA2          D19B 	TA.TA21         D17E 	TA.TA22         
D185 	TA.TA23         D190 	TA.TA24         D1B2 	TA.TA3          
D1FA 	TA.TBEL         D1E5 	TA.TEM          D321 	TA.TFE          
D1D0 	TA.TIM          D42F 	TA.TRTAB        D1BB 	TA.TRTFE        
D463 	TA.WART         D469 	TA.WART0        D474 	TA.WART1        
D4A1 	TA.WART2        D49B 	TA.WART3        D4A6 	TA.WART4        
B249 	TS.BFOL1        B24B 	TS.BFOL2        B22D 	TS.EINA         
B23E 	TS.EMERK        B241 	TS.KGMER        B248 	TS.MBF          
B247 	TS.MIO          B231 	TS.NEWL         B23B 	TS.PTAST        
B23D 	TS.PTK          B23F 	TS.SPMER        B24D 	TS.STACK        
B19F 	TS.TAB1         B1FF 	TS.TAB2         B217 	TS.TAB3         
B223 	TS.TAB4         B233 	TS.TAB5         B22F 	TS.TABU         
B23C 	TS.TK           B240 	TS.UMERK        B245 	TS.ZEI21        
B243 	TS.ZEIT1        B244 	TS.ZEIT2        B242 	TS.ZSMER        
'Symbolliste SYS 2.13'	MACRO-80 3.44	09-Dec-81	PAGE	S-5


B246 	TS.ZSTC         F620 	XXXX            



No Fatal error(s)


