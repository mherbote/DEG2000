'REcord Display and Change   D E G 2 0 0 0 V2'	MACRO-80 3.44	09-Dec-81	PAGE	1


                                            TITLE   'REcord Display and Change   D E G 2 0 0 0 V2'
                                            PAGE    87
'REcord Display and Change   D E G 2 0 0 0 V2'	MACRO-80 3.44	09-Dec-81	PAGE	1-1


                                
                                ;--------------------------\            ; Vorspann fuer BIN-Datei
  0000*   EF                                DB      0EFH                ; Startbyte ---> 
  0001*                                     DS      12,0
  000D*   02                                DB      002H                ; HS-Bereich : 2
  000E*   8000                              DW      08000H              ; Ladeadresse: 8000H
                                ;--------------------------/
                         C                  INCLUDE S21EQU1.MAC
  00E0                   C      S0.PROM     EQU     0E0H
  0050                   C      S0.SPANZ    EQU     80
  0018                   C      S0.ZANZ     EQU     24
  A000                   C      S0.BWSA     EQU     0A000H
  B7E0                   C      S0.PFFI     EQU     0B7E0H
  BBF0                   C      S0.PFFA     EQU     0BBF0H
                         C      ;
  B134                   C      K2.SKADR    EQU     0B134H
  B136                   C      K2.FRADR    EQU     0B136H
                         C      ;
  B18A                   C      MS.ZPOL     EQU     0B18AH
  B18B                   C      MS.SPOL     EQU     MS.ZPOL+1
  B18C                   C      MS.ZPOS     EQU     MS.SPOL+1
  B18D                   C      MS.SPOS     EQU     MS.ZPOS+1
  B18E                   C      MS.ZMIN     EQU     MS.SPOS+1
  B18F                   C      MS.SMIN     EQU     MS.ZMIN+1
  B190                   C      MS.ZMAX     EQU     MS.SMIN+1
  B191                   C      MS.SMAX     EQU     MS.ZMAX+1
  B192                   C      MS.ZANZ     EQU     MS.SMAX+1
  B193                   C      MS.SPANZ    EQU     MS.ZANZ+1
  B194                   C      MS.BWSA     EQU     MS.SPANZ+1
  B196                   C      MS.DIRDEL   EQU     MS.BWSA+2
  B197                   C      MS.DIRES    EQU     MS.DIRDEL+1
  B198                   C      MS.CMD      EQU     MS.DIRES+1
  B199                   C      MS.TK       EQU     MS.CMD+1
  B19A                   C      MS.RADR     EQU     MS.TK+1
  B19C                   C      MS.MCZ      EQU     MS.RADR+2
  B19D                   C      MS.MCUR     EQU     MS.MCZ+1
  B19E                   C      MS.CZEIT    EQU     MS.MCUR+1
                         C      ;
  B19F                   C      TS.TAB1     EQU     0B19FH
  B1FF                   C      TS.TAB2     EQU     TS.TAB1+60H
  B217                   C      TS.TAB3     EQU     TS.TAB2+18H
  B223                   C      TS.TAB4     EQU     TS.TAB3+0CH
  B22D                   C      TS.EINA     EQU     TS.TAB4+0AH
  B22F                   C      TS.TABU     EQU     TS.EINA+2
  B231                   C      TS.NEWL     EQU     TS.TABU+2
  B233                   C      TS.TAB5     EQU     TS.NEWL+2
  B23B                   C      TS.PTAST    EQU     TS.TAB5+8
  B23C                   C      TS.TK       EQU     TS.PTAST+1
  B23D                   C      TS.PTK      EQU     TS.TK+1
  B23E                   C      TS.EMERK    EQU     TS.PTK+1
  B23F                   C      TS.SPMER    EQU     TS.EMERK+1
  B240                   C      TS.UMERK    EQU     TS.SPMER+1
  B241                   C      TS.KGMER    EQU     TS.UMERK+1
  B242                   C      TS.ZSMER    EQU     TS.KGMER+1
  B243                   C      TS.ZEIT1    EQU     TS.ZSMER+1
  B244                   C      TS.ZEIT2    EQU     TS.ZEIT1+1
  B245                   C      TS.ZEI21    EQU     TS.ZEIT2+1
  B246                   C      TS.ZSTC     EQU     TS.ZEI21+1
  B247                   C      TS.MIO      EQU     TS.ZSTC+1
  B248                   C      TS.MBF      EQU     TS.MIO+1
  B249                   C      TS.BFOL1    EQU     TS.MBF+1
  B24B                   C      TS.BFOL2    EQU     TS.BFOL1+2
  B24D                   C      TS.STACK    EQU     TS.BFOL2+2
                         C      ;
  B262                   C      S2.ZZ       EQU     0B262H
  B263                   C      S2.CST      EQU     S2.ZZ+1
  B264                   C      S2.IOC      EQU     S2.CST+1
  B265                   C      S2.PRGN     EQU     S2.IOC+1
  B26B                   C      S2.DNR      EQU     S2.PRGN+6
  B26C                   C      S2.RBBR     EQU     S2.DNR+1
  B26E                   C      S2.AADR     EQU     S2.RBBR+2
  B270                   C      S2.KADR     EQU     S2.AADR+2
  B272                   C      S2.ZP       EQU     S2.KADR+2
  B273                   C      S2.SP1      EQU     S2.ZP+1
  B274                   C      S2.SP2      EQU     S2.SP1+1
  B275                   C      S2.SP3      EQU     S2.SP2+1
  B276                   C      S2.TRB      EQU     S2.SP3+1
  B28A                   C      S2.AFOR     EQU     S2.TRB+20
  B28B                   C      S2.BZ       EQU     S2.AFOR+1
  B28C                   C      S2.TE       EQU     S2.BZ+1
  B28E                   C      S2.DL       EQU     S2.TE+2
  B28F                   C      S2.DH       EQU     S2.DL+1
'REcord Display and Change   D E G 2 0 0 0 V2'	MACRO-80 3.44	09-Dec-81	PAGE	1-2


  B290                   C      S2.PAR1     EQU     S2.DH+1
  B292                   C      S2.DMANF    EQU     S2.PAR1+2           ;Pufferadresse? S0.PFFI
  B294                   C      S2.DMCUR    EQU     S2.DMANF+2
  B296                   C      S2.DMBA     EQU     S2.DMCUR+2
  B298                   C      S2.DMBE     EQU     S2.DMBA+2
  B29A                   C      S2.DM1      EQU     S2.DMBE+2
  B2AA                   C      S2.DM2      EQU     S2.DM1+16
  B2AB                   C      S2.DMH      EQU     S2.DM2+1
  B2AC                   C      S2.DML      EQU     S2.DMH+1
  B2AD                   C      S2.SMHL     EQU     S2.DML+1
  B2AF                   C      S2.S1       EQU     S2.SMHL+2
  B2B0                   C      S2.S2       EQU     S2.S1+1
  B2B8                   C      S2.DDEI     EQU     S2.S2+8
                         C      ;
                         C                  INCLUDE S21EQU2.MAC
  C02D                   C      S1.SM       EQU     0C02DH
  C82E                   C      S1.DB111    EQU     0C82EH
  C86E                   C      S1.EINDB    EQU     0C86EH
  C8B0                   C      S1.ANZU1    EQU     0C8B0H
  C8C0                   C      S1.ANZU2    EQU     0C8C0H
  C8CD                   C      S1.SYDB2    EQU     0C8CDH
  C114                   C      S1.SYSTB    EQU     0C114H
  C2B4                   C      S1.CNRS     EQU     0C2B4H
  C2D3                   C      S1.CNLS     EQU     0C2D3H
  C328                   C      S1.AEIN     EQU     0C328H
  C334                   C      S1.NN       EQU     0C334H
  C345                   C      S1.NNN      EQU     0C345H
  C3BF                   C      S1.ANZEI    EQU     0C3BFH
  C532                   C      S1.INPTR    EQU     0C532H
  C54E                   C      S1.HDI      EQU     0C54EH
  C592                   C      S1.IDH      EQU     0C592H
  C5CC                   C      S1.HBKON    EQU     0C5CCH
  C5FF                   C      S1.BHKON    EQU     0C5FFH
  C652                   C      S1.CHK      EQU     0C652H
  C935                   C      S1.MEAA     EQU     0C935H
  C995                   C      S1.HXN1     EQU     0C995H
  C9E4                   C      S1.MEAU2    EQU     0C9E4H
                         C      ;
  CB16                   C      MO.MONI     EQU     0CB16H
  CB45                   C      MO.BWSUS    EQU     0CB45H
  CD9F                   C      MO.ROLL     EQU     0CD9FH
  CF4B                   C      MO.BWSE     EQU     0CF4BH
  CF52                   C      MO.PNSP     EQU     0CF52H
                         C      ;
  D40E                   C      TA.LOE      EQU     0D40EH
  D426                   C      TA.LOES     EQU     0D426H
                         C      ;
  D551                   C      K1.ARMB     EQU     0D551H
  D5B7                   C      K1.ARBT     EQU     0D5B7H
  D5C2                   C      K1.BLKP     EQU     0D5C2H
  D5D0                   C      K1.BLKM     EQU     0D5D0H
  D5DE                   C      K1.RCZP     EQU     0D5DEH
  D5EC                   C      K1.RCZM     EQU     0D5ECH
  D5FA                   C      K1.RCZN     EQU     0D5FAH
  D602                   C      K1.LHLBC    EQU     0D602H
  D60F                   C      K1.BM       EQU     0D60FH
  D615                   C      K1.F17      EQU     0D615H
  D62D                   C      K1.RGL1     EQU     0D62DH
  D63E                   C      K1.RGL2     EQU     0D63EH
  D6F1                   C      K1.GNSTS    EQU     0D6F1H
  D748                   C      K1.GNRE     EQU     0D748H
  D765                   C      K1.GNRA     EQU     0D765H
  D780                   C      K1.GNRW     EQU     0D780H
  D7A5                   C      K1.GNRP     EQU     0D7A5H
  D7C0                   C      K1.GNRM     EQU     0D7C0H
  D7F1                   C      K1.GNLP     EQU     0D7F1H
  D7F3                   C      K1.GNLPN    EQU     0D7F3H
  D82B                   C      K1.GNLMN    EQU     0D82BH
  D89B                   C      K1.GNRD     EQU     0D89BH
  D8B0                   C      K1.PUFT     EQU     0D8B0H
  D90B                   C      K1.GNWR     EQU     0D90BH
  D92F                   C      K1.GNRWR    EQU     0D92FH
                         C      ;
  DF0C                   C      LO.EIN      EQU     0DF0CH
  E279                   C      LO.EIN1     EQU     0E279H
                         C      ;
  E697                   C      S9.CIN      EQU     0E697H
  E6CB                   C      S9.CSTSX    EQU     0E6CBH
  E6E6                   C      S9.CON      EQU     0E6E6H
  EE98                   C      S9.SAVE     EQU     0EE98H
  EEB8                   C      S9.LOAD     EQU     0EEB8H
                         C      ;
  F60F                   C      S0.BWSUS    EQU     0F60FH
'REcord Display and Change   D E G 2 0 0 0 V2'	MACRO-80 3.44	09-Dec-81	PAGE	1-3


                                
                                ;           PN      RD31
                                ;****************************************************************
                                ;*               REcord Display and Change                      *
                                ;*  Version      -----------------------------------------------*
                                ;*               Programmierer: M. Herbote --- K EAW  ZFT (WFT) *
                                ;*  V 2 . 1      -----------------------------------------------*
                                ;*               Stand        : 14.Maerz 1985                   *
                                ;****************************************************************
                                            .PHASE  08000H
                                
  8000    56 32 2E 31                       DB      'V2.1/140385'
  8004    2F 31 34 30           
  8008    33 38 35              
                                
  800B    800B                              DW      $
  800D    52 45 44 43                       DB      'REDC'
  8011    21 8011               REDD:       LD      HL,REDD
  8014    22 B136                           LD      (K2.FRADR),HL
  8017    3E 05                             LD      A,5                 ;Bildschirm loeschen
  8019    32 B198                           LD      (MS.CMD),A
  801C    CD CB16                           CALL    MO.MONI
  801F    CD C3BF                           CALL    S1.ANZEI            ;Programmname anzeigen
  8022    0012                              DW      00012H              ;ZPOS=19 , SPOS= 1
  8024    28                                DB      40
  8025    52 65 63 6F                       DB      'Record Display and Change    Version 2.1'
  8029    72 64 20 44           
  802D    69 73 70 6C           
  8031    61 79 20 61           
  8035    6E 64 20 43           
  8039    68 61 6E 67           
  803D    65 20 20 20           
  8041    20 56 65 72           
  8045    73 69 6F 6E           
  8049    20 32 2E 31           
  804D    00                                DB      0
                                
  804E    CD C3BF                           CALL    S1.ANZEI
  8051    0013                              DW      00013H              ;ZPOS=20 , SPOS= 1
  8053    A4                                DB      TXT11-TXT10+80H
  8054    81DB                              DW      TXT10
  8056    00                                DB      0
                                
  8057    CD 8AFC                           CALL    PANZ
  805A    21 0101                           LD      HL,00101H           ;ZMIN= 1 , SMIN= 1
  805D    22 B18E                           LD      (MS.ZMIN),HL
  8060    25                                DEC     H                   ;ZPOS= 1 , SMIN= 1
  8061    2D                                DEC     L
  8062    22 B18C                           LD      (MS.ZPOS),HL
  8065    21 5011                           LD      HL,05011H           ;ZMAX=17 , SMAX=80
  8068    22 B190                           LD      (MS.ZMAX),HL
  806B    CD 8ABE                           CALL    TARE
  806E    C9                                RET
                                
                                            PAGE
'REcord Display and Change   D E G 2 0 0 0 V2'	MACRO-80 3.44	09-Dec-81	PAGE	1-4


                                
  806F    20 20 31 3D           TXT1:       DB      '  1=RE  2=RW  3=RA     4=L-  5=PT  6=L+ '
  8073    52 45 20 20           
  8077    32 3D 52 57           
  807B    20 20 33 3D           
  807F    52 41 20 20           
  8083    20 20 20 34           
  8087    3D 4C 2D 20           
  808B    20 35 3D 50           
  808F    54 20 20 36           
  8093    3D 4C 2B 20           
  8097    20 20 37 3D                       DB      '  7=R-  8=CW  9=R+    10=BM 11=W  12=SL '
  809B    52 2D 20 20           
  809F    38 3D 43 57           
  80A3    20 20 39 3D           
  80A7    52 2B 20 20           
  80AB    20 20 31 30           
  80AF    3D 42 4D 20           
  80B3    31 31 3D 57           
  80B7    20 20 31 32           
  80BB    3D 53 4C 20           
                                
  80BF    31 3D 63 6F           TXT2:       DB      '1=copy Satz_1 2=copy BM__1  3=copy SL_1 '
  80C3    70 79 20 53           
  80C7    61 74 7A 5F           
  80CB    31 20 32 3D           
  80CF    63 6F 70 79           
  80D3    20 42 4D 5F           
  80D7    5F 31 20 20           
  80DB    33 3D 63 6F           
  80DF    70 79 20 53           
  80E3    4C 5F 31 20           
  80E7    34 3D 63 6F                       DB      '4=copy Satz_2 5=copy BM__2  6=copy SL_2 '
  80EB    70 79 20 53           
  80EF    61 74 7A 5F           
  80F3    32 20 35 3D           
  80F7    63 6F 70 79           
  80FB    20 42 4D 5F           
  80FF    5F 32 20 20           
  8103    36 3D 63 6F           
  8107    70 79 20 53           
  810B    4C 5F 32 20           
  810F    37 3D 70 72                       DB      '7=printSatz_1 8=printASC_1  9=R+_1      '
  8113    69 6E 74 53           
  8117    61 74 7A 5F           
  811B    31 20 38 3D           
  811F    70 72 69 6E           
  8123    74 41 53 43           
  8127    5F 31 20 20           
  812B    39 3D 52 2B           
  812F    5F 31 20 20           
  8133    20 20 20 20           
  8137    31 30 3D 70                       DB      '10=printSatz_2 11=printASC_2 12=R+_2 '
  813B    72 69 6E 74           
  813F    53 61 74 7A           
  8143    5F 32 20 31           
  8147    31 3D 70 72           
  814B    69 6E 74 41           
  814F    53 43 5F 32           
  8153    20 31 32 3D           
  8157    52 2B 5F 32           
  815B    20                    
                                
  815C    31 3D 50 6F           TXT14:      DB      '1=Pos1_auf 2=Pos1_+ 3=Pos1_-  '
  8160    73 31 5F 61           
  8164    75 66 20 32           
  8168    3D 50 6F 73           
  816C    31 5F 2B 20           
  8170    33 3D 50 6F           
  8174    73 31 5F 2D           
  8178    20 20                 
  817A    34 3D 50 6F                       DB      '4=Pos2_auf 5=Pos2_+ 6=Pos2_-'
  817E    73 32 5F 61           
  8182    75 66 20 35           
  8186    3D 50 6F 73           
  818A    32 5F 2B 20           
  818E    36 3D 50 6F           
  8192    73 32 5F 2D           
                                
                                
  8196    63 6F 70 69           TXT3:       DB      'copieren '
  819A    65 72 65 6E           
'REcord Display and Change   D E G 2 0 0 0 V2'	MACRO-80 3.44	09-Dec-81	PAGE	1-5


  819E    20                    
  819F    53 61 74 7A           TXT4:       DB      'Satz  '
  81A3    20 20                 
  81A5    62 69 73 20           TXT5:       DB      'bis BM  '
  81A9    42 4D 20 20           
  81AD    62 69 73 20           TXT6:       DB      'bis SL  '
  81B1    53 4C 20 20           
  81B5    76 6F 6E 20           TXT7:       DB      'von Ger. 2 => 1'
  81B9    47 65 72 2E           
  81BD    20 32 20 3D           
  81C1    3E 20 31              
  81C4    76 6F 6E 20           TXT8:       DB      'von Ger. 1 => 2'
  81C8    47 65 72 2E           
  81CC    20 31 20 3D           
  81D0    3E 20 32              
  81D3    47 65 72 61           TXT9:       DB      'Geraet: '
  81D7    65 74 3A 20           
  81DB    53 61 74 7A           TXT10:      DB      'Satzlaenge: ....H   CRC-Summe: ....H'
  81DF    6C 61 65 6E           
  81E3    67 65 3A 20           
  81E7    2E 2E 2E 2E           
  81EB    48 20 20 20           
  81EF    43 52 43 2D           
  81F3    53 75 6D 6D           
  81F7    65 3A 20 2E           
  81FB    2E 2E 2E 48           
  81FF    2A 20 2A 20           TXT11:      DB      '* * *   B A N D M A R K E   * * *'
  8203    2A 20 20 20           
  8207    42 20 41 20           
  820B    4E 20 44 20           
  820F    4D 20 41 20           
  8213    52 20 4B 20           
  8217    45 20 20 20           
  821B    2A 20 2A 20           
  821F    2A                    
  8220    1E1E                  TXT12:      DW      1E1EH
  8222    47 65 72 61           TXT13:      DB      'Geraet . auf Datei: 003 Satz: 001 positionieren'
  8226    65 74 20 2E           
  822A    20 61 75 66           
  822E    20 44 61 74           
  8232    65 69 3A 20           
  8236    30 30 33 20           
  823A    53 61 74 7A           
  823E    3A 20 30 30           
  8242    31 20 70 6F           
  8246    73 69 74 69           
  824A    6F 6E 69 65           
  824E    72 65 6E              
  8251    47 65 72 61           TXT15:      DB      'Geraet . um 000 Dateien und 000 Saetze '
  8255    65 74 20 2E           
  8259    20 75 6D 20           
  825D    30 30 30 20           
  8261    44 61 74 65           
  8265    69 65 6E 20           
  8269    75 6E 64 20           
  826D    30 30 30 20           
  8271    53 61 65 74           
  8275    7A 65 20              
  8278    76 6F 72 73           TXT16:      DB      'vorsetzen'
  827C    65 74 7A 65           
  8280    6E                    
  8281    7A 75 72 75           TXT17:      DB      'zuruecksetzen'
  8285    65 63 6B 73           
  8289    65 74 7A 65           
  828D    6E                    
  828E                          TXT18       EQU     $
                                
                                            PAGE
'REcord Display and Change   D E G 2 0 0 0 V2'	MACRO-80 3.44	09-Dec-81	PAGE	1-6


                                
  828E    82EE                  RE2:        DW      RERE1               ;PF 1/0
  8290    82FE                              DW      RERW1               ;PF 2/0
  8292    830B                              DW      RERA1               ;PF 3/0
  8294    831E                              DW      RELM1               ;PF 4/0
  8296    83C4                              DW      REPT1               ;PF 5/0
  8298    834C                              DW      RELP1               ;PF 6/0
  829A    83E5                              DW      RERM1               ;PF 7/0
  829C    842D                              DW      RECW1               ;PF 8/0
  829E    8419                              DW      RERP1               ;PF 9/0
  82A0    8359                              DW      REBM1               ;PF10/0
  82A2    85FC                              DW      REW1                ;PF11/0
  82A4    8389                              DW      RESL1               ;PF12/0
                                
  82A6    82F3                              DW      RERE2               ;PF 1/1
  82A8    8303                              DW      RERW2               ;PF 2/1
  82AA    8310                              DW      RERA2               ;PF 3/1
  82AC    8323                              DW      RELM2               ;PF 4/1
  82AE    83CC                              DW      REPT2               ;PF 5/1
  82B0    8351                              DW      RELP2               ;PF 6/1
  82B2    83ED                              DW      RERM2               ;PF 7/1
  82B4    8435                              DW      RECW2               ;PF 8/1
  82B6    8421                              DW      RERP2               ;PF 9/1
  82B8    835E                              DW      REBM2               ;PF10/1
  82BA    8604                              DW      REW2                ;PF11/1
  82BC    838E                              DW      RESL2               ;PF12/1
                                
  82BE    84BA                              DW      RECS1               ;PF 1/2
  82C0    852A                              DW      RECB1               ;PF 2/2
  82C2    859E                              DW      RECE1               ;PF 3/2
  82C4    84ED                              DW      RECS2               ;PF 4/2
  82C6    8559                              DW      RECB2               ;PF 5/2
  82C8    85CD                              DW      RECE2               ;PF 6/2
  82CA    86A7                              DW      REHC1               ;PF 7/2
  82CC    8731                              DW      REHC3               ;PF 8/2
  82CE    8419                              DW      RERP1               ;PF 9/2
  82D0    86AF                              DW      REHC2               ;PF10/2
  82D2    8739                              DW      REHC4               ;PF11/2
  82D4    8421                              DW      RERP2               ;PF12/2
                                
  82D6    8756                              DW      P1A                 ;PF 1/3
  82D8    87F4                              DW      P1P                 ;PF 2/3
  82DA    8889                              DW      P1M                 ;PF 3/3
  82DC    8760                              DW      P2A                 ;PF 4/3
  82DE    87FE                              DW      P2P                 ;PF 5/3
  82E0    8893                              DW      P2M                 ;PF 6/3
  82E2    0000                              DW      0                   ;PF 7/3
  82E4    0000                              DW      0                   ;PF 8/3
  82E6    0000                              DW      0                   ;PF 9/3
  82E8    0000                              DW      0                   ;PF10/3
  82EA    0000                              DW      0                   ;PF11/3
  82EC    0000                              DW      0                   ;PF12/3
                                
                                            PAGE
'REcord Display and Change   D E G 2 0 0 0 V2'	MACRO-80 3.44	09-Dec-81	PAGE	1-7


                                
                                ;****************************************************************
                                ;*               Kassettengeraet reservieren ein                *
                                ;****************************************************************
  82EE    CD D62D               RERE1:      CALL    K1.RGL1
  82F1    18 03                             JR      RERE3
  82F3    CD D63E               RERE2:      CALL    K1.RGL2
  82F6    CD D748               RERE3:      CALL    K1.GNRE
  82F9    CD 8A95                           CALL    TADEF
  82FC    18 3B                             JR      RELM5
                                ;****************************************************************
                                ;*               Kassettengeraet rewind                         *
                                ;****************************************************************
  82FE    CD D62D               RERW1:      CALL    K1.RGL1
  8301    18 03                             JR      RERW3
  8303    CD D63E               RERW2:      CALL    K1.RGL2
  8306    CD D780               RERW3:      CALL    K1.GNRW
  8309    18 2E                             JR      RELM5
                                ;****************************************************************
                                ;*               Kassettengeraet reservieren aus                *
                                ;****************************************************************
  830B    CD D62D               RERA1:      CALL    K1.RGL1
  830E    18 03                             JR      RERA3
  8310    CD D63E               RERA2:      CALL    K1.RGL2
  8313    CD D748               RERA3:      CALL    K1.GNRE
  8316    CD D765                           CALL    K1.GNRA
  8319    CD 8ABE                           CALL    TARE
  831C    18 1E                             JR      RELM6
                                ;****************************************************************
                                ;*               Kassettengeraet eine Datei zurueck             *
                                ;****************************************************************
  831E    CD D62D               RELM1:      CALL    K1.RGL1
  8321    18 03                             JR      RELM3
  8323    CD D63E               RELM2:      CALL    K1.RGL2
  8326    16 00                 RELM3:      LD      D,0
  8328    FD 7E FD                          LD      A,(IY-3)            ;RCZx = 0 ?
  832B    FD B6 FC                          OR      (IY-4)
  832E    20 01                             JR      NZ,$+3
  8330    14                                INC     D
  8331    CD D82B                           CALL    K1.GNLMN
  8334    3E 01                 RELM4:      LD      A,1                 ;Schnellschreiben erlaubt
  8336    32 B242                           LD      (TS.ZSMER),A
  8339    CD 8A95               RELM5:      CALL    TADEF
  833C    CD D6F1               RELM6:      CALL    K1.GNSTS
  833F    CD 8927                           CALL    ANZLO
  8342    CD 8AFC                           CALL    PANZ
  8345    21 0000                           LD      HL,0
  8348    22 B18C                           LD      (MS.ZPOS),HL
  834B    C9                                RET
                                ;****************************************************************
                                ;*               Kassettengeraet eine Datei vor                 *
                                ;****************************************************************
  834C    CD D62D               RELP1:      CALL    K1.RGL1
  834F    18 03                             JR      RELP3
  8351    CD D63E               RELP2:      CALL    K1.RGL2
  8354    CD D7F1               RELP3:      CALL    K1.GNLP
  8357    18 DB                             JR      RELM4
                                
                                            PAGE
'REcord Display and Change   D E G 2 0 0 0 V2'	MACRO-80 3.44	09-Dec-81	PAGE	1-8


                                
                                ;****************************************************************
                                ;*               Schreiben einer Bandmarke                      *
                                ;****************************************************************
  8359    CD D62D               REBM1:      CALL    K1.RGL1
  835C    18 03                             JR      REBM3
  835E    CD D63E               REBM2:      CALL    K1.RGL2
  8361    CD C3BF               REBM3:      CALL    S1.ANZEI
  8364    0010                              DW      00010H
  8366    15                                DB      21
  8367    42 61 6E 64                       DB      'Bandmarke schreiben ?'
  836B    6D 61 72 6B           
  836F    65 20 73 63           
  8373    68 72 65 69           
  8377    62 65 6E 20           
  837B    3F                    
  837C    01                                DB      1
  837D    80                                DB      10000000B
  837E    8387                              DW      BMNQ
  8380    8384                              DW      BMPQ
  8382    0000                              DW      0
  8384    CD 8A84               BMPQ:       CALL    WR3
  8387    18 B0                 BMNQ:       JR      RELM5
                                ;****************************************************************
                                ;*               Schreiben einer Schlussluecke                  *
                                ;****************************************************************
  8389    CD D62D               RESL1:      CALL    K1.RGL1
  838C    18 03                             JR      RESL3
  838E    CD D63E               RESL2:      CALL    K1.RGL2
  8391    CD C3BF               RESL3:      CALL    S1.ANZEI
  8394    0010                              DW      00010H
  8396    19                                DB      25
  8397    53 63 68 6C                       DB      'Schlussluecke schreiben ?'
  839B    75 73 73 6C           
  839F    75 65 63 6B           
  83A3    65 20 73 63           
  83A7    68 72 65 69           
  83AB    62 65 6E 20           
  83AF    3F                    
  83B0    01                                DB      1
  83B1    80                                DB      10000000B
  83B2    8387                              DW      BMNQ
  83B4    83B8                              DW      SLPQ
  83B6    0000                              DW      0
  83B8    DD 36 04 61           SLPQ:       LD      (IX+4),61H
  83BC    CD D551                           CALL    K1.ARMB
  83BF    CD D5B7                           CALL    K1.ARBT
  83C2    18 C3                             JR      BMNQ
                                ;****************************************************************
                                ;*               Eingabe- <==> Ausgabe-Puffer  Tausch           *
                                ;****************************************************************
  83C4    21 B7E0               REPT1:      LD      HL,S0.PFFI
  83C7    11 BBF0                           LD      DE,S0.PFFA
  83CA    18 06                             JR      REPT3
  83CC    21 BBF0               REPT2:      LD      HL,S0.PFFA
  83CF    11 B7E0                           LD      DE,S0.PFFI
  83D2    22 B292               REPT3:      LD      (S2.DMANF),HL
  83D5    06 00                             LD      B,0
  83D7    7E                    REPT4:      LD      A,(HL)
  83D8    08                                EX      AF,AF'              ;'
  83D9    1A                                LD      A,(DE)
  83DA    77                                LD      (HL),A
  83DB    08                                EX      AF,AF'              ;'
  83DC    12                                LD      (DE),A
  83DD    23                                INC     HL
  83DE    13                                INC     DE
  83DF    10 F6                             DJNZ    REPT4
  83E1    CD 894C                           CALL    SAN1
  83E4    C9                                RET
                                
                                            PAGE
'REcord Display and Change   D E G 2 0 0 0 V2'	MACRO-80 3.44	09-Dec-81	PAGE	1-9


                                
                                ;****************************************************************
                                ;*               einen Datenblock einlesen und anzeigen         *
                                ;****************************************************************
  83E5    CD D62D               RERM1:      CALL    K1.RGL1             ;rueckwaerts
  83E8    21 B7E0                           LD      HL,S0.PFFI
  83EB    18 06                             JR      RERM3
  83ED    CD D63E               RERM2:      CALL    K1.RGL2
  83F0    21 BBF0                           LD      HL,S0.PFFA
  83F3    22 B292               RERM3:      LD      (S2.DMANF),HL
  83F6    CD D7C0                           CALL    K1.GNRM
  83F9    CD D7C0                           CALL    K1.GNRM
  83FC    CD 8A58               RERM4:      CALL    RD3
  83FF    CD D5B7                           CALL    K1.ARBT
  8402    CD 894C                           CALL    SAN1
  8405    CD D60F                           CALL    K1.BM
  8408    28 06                             JR      Z,RERM5             ;Datenblock = Bandmarke ?
  840A    CD D5DE                           CALL    K1.RCZP
  840D    C3 8334                           JP      RELM4
                                
  8410    CD D5C2               RERM5:      CALL    K1.BLKP
  8413    CD D5FA                           CALL    K1.RCZN
  8416    C3 8334                           JP      RELM4
                                
  8419    CD D62D               RERP1:      CALL    K1.RGL1             ;vorwaerts
  841C    21 B7E0                           LD      HL,S0.PFFI
  841F    18 06                             JR      RERP3
  8421    CD D63E               RERP2:      CALL    K1.RGL2
  8424    21 BBF0                           LD      HL,S0.PFFA
  8427    22 B292               RERP3:      LD      (S2.DMANF),HL
  842A    C3 83FC                           JP      RERM4
                                
                                            PAGE
'REcord Display and Change   D E G 2 0 0 0 V2'	MACRO-80 3.44	09-Dec-81	PAGE	1-10


                                
                                ;****************************************************************
                                ;*               Satz korrigieren und zurueckschreiben          *
                                ;****************************************************************
  842D    CD D62D               RECW1:      CALL    K1.RGL1
  8430    21 B7E0                           LD      HL,S0.PFFI
  8433    18 06                             JR      RECW3
  8435    CD D63E               RECW2:      CALL    K1.RGL2
  8438    21 BBF0                           LD      HL,S0.PFFA
  843B    22 B292               RECW3:      LD      (S2.DMANF),HL
  843E    CD 8927                           CALL    ANZLO
  8441    CD 8ADF                           CALL    PAN
  8444    CD D426                           CALL    TA.LOES
  8447    21 8465                           LD      HL,RECW4            ;POS QUIT
  844A    22 B223                           LD      (TS.TAB4),HL
  844D    21 84A7               RECW9:      LD      HL,ANZUM            ;INS MOD
  8450    22 B1FF                           LD      (TS.TAB2),HL
  8453    21 8339                           LD      HL,RELM5            ;NEQ QUIT
  8456    22 B21B                           LD      (TS.TAB3+4),HL
  8459    21 C86E                           LD      HL,S1.EINDB         ;alphanum. Tasten
  845C    22 B22D                           LD      (TS.EINA),HL
  845F    CD C8B0                           CALL    S1.ANZU1
  8462    C3 C831                           JP      S1.DB111+3
                                
  8465    CD D602               RECW4:      CALL    K1.LHLBC
  8468    CD C8CD                           CALL    S1.SYDB2
  846B    CD 894C                           CALL    SAN1
  846E    CD C3BF                           CALL    S1.ANZEI
  8471    0010                              DW      00010H
  8473    17                                DB      23
  8474    53 61 74 7A                       DB      'Satz zurueckschreiben ?'
  8478    20 7A 75 72           
  847C    75 65 63 6B           
  8480    73 63 68 72           
  8484    65 69 62 65           
  8488    6E 20 3F              
  848B    01                                DB      1
  848C    80                                DB      10000000B
  848D    843E                              DW      RECW3+3
  848F    8493                              DW      RECW5
  8491    0000                              DW      0
                                
  8493    DD 46 09              RECW5:      LD      B,(IX+9)
  8496    DD 4E 0A                          LD      C,(IX+10)
  8499    C5                                PUSH    BC
  849A    CD D7C0                           CALL    K1.GNRM
  849D    2A B292                           LD      HL,(S2.DMANF)
  84A0    C1                                POP     BC
  84A1    CD D92F                           CALL    K1.GNRWR
  84A4    C3 8339                           JP      RELM5
                                
                                
  84A7    CD D602               ANZUM:      CALL    K1.LHLBC
  84AA    C3 C8C0                           JP      S1.ANZU2
                                
                                            PAGE
'REcord Display and Change   D E G 2 0 0 0 V2'	MACRO-80 3.44	09-Dec-81	PAGE	1-11


                                
                                ;****************************************************************
                                ;*               satzweises Copieren                            *
                                ;****************************************************************
  84AD    22 B292               RECS:       LD      (S2.DMANF),HL
  84B0    CD C3BF                           CALL    S1.ANZEI
  84B3    0010                              DW      00010H
  84B5    8F                                DB      15+80H
  84B6    8196                              DW      TXT3
  84B8    00                                DB      0
  84B9    C9                                RET
                                
  84BA    21 B7E0               RECS1:      LD      HL,S0.PFFI
  84BD    CD 84AD                           CALL    RECS
  84C0    CD C3BF                           CALL    S1.ANZEI
  84C3    0F10                              DW      00F10H
  84C5    8F                                DB      15+80H
  84C6    81B5                              DW      TXT7
  84C8    01                                DB      1
  84C9    80                                DB      10000000B
  84CA    8339                              DW      RELM5
  84CC    84D0                              DW      RECS3
  84CE    0000                              DW      0
                                
  84D0    CD D63E               RECS3:      CALL    K1.RGL2
  84D3    CD D89B                           CALL    K1.GNRD
  84D6    CD 894C                           CALL    SAN1
  84D9    CD D602                           CALL    K1.LHLBC
  84DC    CD D62D                           CALL    K1.RGL1
  84DF    78                    RECS5:      LD      A,B
  84E0    B1                                OR      C
  84E1    CA 8384                           JP      Z,BMPQ
  84E4    CD 8A69                           CALL    WR1
  84E7    CD D90B                           CALL    K1.GNWR
  84EA    C3 8339                           JP      RELM5
                                
                                
  84ED    21 BBF0               RECS2:      LD      HL,S0.PFFA
  84F0    CD 84AD                           CALL    RECS
  84F3    CD C3BF                           CALL    S1.ANZEI
  84F6    0F10                              DW      00F10H
  84F8    8F                                DB      15+80H
  84F9    81C4                              DW      TXT8
  84FB    01                                DB      1
  84FC    80                                DB      10000000B
  84FD    8339                              DW      RELM5
  84FF    8503                              DW      RECS4
  8501    0000                              DW      0
                                
  8503    CD D62D               RECS4:      CALL    K1.RGL1
  8506    CD D89B                           CALL    K1.GNRD
  8509    CD 894C                           CALL    SAN1
  850C    CD D602                           CALL    K1.LHLBC
  850F    CD D63E                           CALL    K1.RGL2
  8512    18 CB                             JR      RECS5
                                
                                            PAGE
'REcord Display and Change   D E G 2 0 0 0 V2'	MACRO-80 3.44	09-Dec-81	PAGE	1-12


                                
                                ;****************************************************************
                                ;*               Copieren bis Bandmarke                         *
                                ;****************************************************************
  8514    22 B292               RECB:       LD      (S2.DMANF),HL
  8517    CD C3BF                           CALL    S1.ANZEI
  851A    0010                              DW      00010H
  851C    89                                DB      9+80H
  851D    8196                              DW      TXT3
  851F    00                                DB      0
                                
  8520    CD C3BF                           CALL    S1.ANZEI
  8523    0910                              DW      00910H
  8525    88                                DB      8+80H
  8526    81A5                              DW      TXT5
  8528    00                                DB      0
  8529    C9                                RET
                                
  852A    21 B7E0               RECB1:      LD      HL,S0.PFFI
  852D    CD 8514                           CALL    RECB
  8530    CD C3BF                           CALL    S1.ANZEI
  8533    1110                              DW      01110H
  8535    8F                                DB      15+80H
  8536    81B5                              DW      TXT7
  8538    01                                DB      1
  8539    80                                DB      10000000B
  853A    8339                              DW      RELM5
  853C    8540                              DW      RECB3
  853E    0000                              DW      0
                                
  8540    CD D63E               RECB3:      CALL    K1.RGL2
  8543    CD 8A35                           CALL    RD
  8546    CA 8339                           JP      Z,RELM5
  8549    CD D602                           CALL    K1.LHLBC
  854C    CD D62D                           CALL    K1.RGL1
  854F    78                                LD      A,B
  8550    B1                                OR      C
  8551    CA 8384                           JP      Z,BMPQ
  8554    CD 8A7A                           CALL    WR
  8557    18 E7                             JR      RECB3
                                
                                
  8559    21 BBF0               RECB2:      LD      HL,S0.PFFA
  855C    CD 8514                           CALL    RECB
  855F    CD C3BF                           CALL    S1.ANZEI
  8562    1110                              DW      01110H
  8564    8F                                DB      15+80H
  8565    81C4                              DW      TXT8
  8567    01                                DB      1
  8568    80                                DB      10000000B
  8569    8339                              DW      RELM5
  856B    856F                              DW      RECB4
  856D    0000                              DW      0
                                
  856F    CD D62D               RECB4:      CALL    K1.RGL1
  8572    CD 8A35                           CALL    RD
  8575    CA 8339                           JP      Z,RELM5
  8578    CD D602                           CALL    K1.LHLBC
  857B    CD D63E                           CALL    K1.RGL2
  857E    78                                LD      A,B
  857F    B1                                OR      C
  8580    CA 8384                           JP      Z,BMPQ
  8583    CD 8A7A                           CALL    WR
  8586    18 E7                             JR      RECB4
                                
                                ;****************************************************************
                                ;*               Copieren bis Schlussluecke                     *
                                ;****************************************************************
  8588    22 B292               RECE:       LD      (S2.DMANF),HL
  858B    CD C3BF                           CALL    S1.ANZEI
  858E    0010                              DW      00010H
  8590    89                                DB      9+80H
  8591    8196                              DW      TXT3
  8593    00                                DB      0
                                
  8594    CD C3BF                           CALL    S1.ANZEI
  8597    0910                              DW      00910H
  8599    88                                DB      8+80H
  859A    81AD                              DW      TXT6
  859C    00                                DB      0
  859D    C9                                RET
                                
'REcord Display and Change   D E G 2 0 0 0 V2'	MACRO-80 3.44	09-Dec-81	PAGE	1-13


  859E    21 B7E0               RECE1:      LD      HL,S0.PFFI
  85A1    CD 8588                           CALL    RECE
  85A4    CD C3BF                           CALL    S1.ANZEI
  85A7    1110                              DW      01110H
  85A9    8F                                DB      15+80H
  85AA    81B5                              DW      TXT7
  85AC    01                                DB      1
  85AD    80                                DB      10000000B
  85AE    8339                              DW      RELM5
  85B0    85B4                              DW      RECE3
  85B2    0000                              DW      0
                                
  85B4    CD D63E               RECE3:      CALL    K1.RGL2
  85B7    CD 8A35                           CALL    RD
  85BA    28 0B                             JR      Z,RECE6
  85BC    CD D602                           CALL    K1.LHLBC
  85BF    CD D62D                           CALL    K1.RGL1
  85C2    CD 8A76                           CALL    WR2
  85C5    18 ED                             JR      RECE3
  85C7    CD D62D               RECE6:      CALL    K1.RGL1
  85CA    C3 83B8                           JP      SLPQ
                                
                                
  85CD    21 BBF0               RECE2:      LD      HL,S0.PFFA
  85D0    CD 8588                           CALL    RECE
  85D3    CD C3BF                           CALL    S1.ANZEI
  85D6    1110                              DW      01110H
  85D8    8F                                DB      15+80H
  85D9    81C4                              DW      TXT8
  85DB    01                                DB      1
  85DC    80                                DB      10000000B
  85DD    8339                              DW      RELM5
  85DF    85E3                              DW      RECE4
  85E1    0000                              DW      0
                                
  85E3    CD D62D               RECE4:      CALL    K1.RGL1
  85E6    CD 8A35                           CALL    RD
  85E9    28 0B                             JR      Z,RECE8
  85EB    CD D602                           CALL    K1.LHLBC
  85EE    CD D63E                           CALL    K1.RGL2
  85F1    CD 8A76                           CALL    WR2
  85F4    18 ED                             JR      RECE4
  85F6    CD D63E               RECE8:      CALL    K1.RGL2
  85F9    C3 83B8                           JP      SLPQ
                                
                                            PAGE
'REcord Display and Change   D E G 2 0 0 0 V2'	MACRO-80 3.44	09-Dec-81	PAGE	1-14


                                
                                ;****************************************************************
                                ;*               Erzeugen eines neuen Satzes                    *
                                ;****************************************************************
  85FC    CD D62D               REW1:       CALL    K1.RGL1
  85FF    21 B7E0                           LD      HL,S0.PFFI
  8602    18 06                             JR      REW3
                                
  8604    CD D63E               REW2:       CALL    K1.RGL2
  8607    21 BBF0                           LD      HL,S0.PFFA
                                
  860A    22 B292               REW3:       LD      (S2.DMANF),HL
  860D    DD 74 08                          LD      (IX+8),H
  8610    DD 75 07                          LD      (IX+7),L
  8613    CD 8927                           CALL    ANZLO
  8616    CD 8ADF                           CALL    PAN
  8619    CD 894C               REW4:       CALL    SAN1
  861C    CD C3BF                           CALL    S1.ANZEI
  861F    0C13                              DW      00C13H              ;ZPOS=20 , SPOS=13
  8621    00                                DB      0
  8622    04                                DB      4
  8623    A8                                DB      10101000B
  8624    8387                              DW      BMNQ
  8626    862A                              DW      REW5
  8628    E279                              DW      LO.EIN1
                                
  862A    21 0C13               REW5:       LD      HL,00C13H
  862D    22 B18C                           LD      (MS.ZPOS),HL
  8630    3E 0B                             LD      A,11
  8632    32 B198                           LD      (MS.CMD),A
  8635    CD CB16                           CALL    MO.MONI
  8638    CD C5CC                           CALL    S1.HBKON
  863B    57                                LD      D,A
  863C    CD C5CC                           CALL    S1.HBKON
  863F    5F                                LD      E,A
  8640    B2                                OR      D
  8641    28 D6                             JR      Z,REW4
  8643    DD 72 09                          LD      (IX+9),D
  8646    DD 73 0A                          LD      (IX+10),E
  8649    CD 894C                           CALL    SAN1
  864C    CD D426               REW6:       CALL    TA.LOES
  864F    21 8658                           LD      HL,REW7             ;POS QUIT
  8652    22 B223                           LD      (TS.TAB4),HL
  8655    C3 844D                           JP      RECW9
                                
  8658    CD D602               REW7:       CALL    K1.LHLBC
  865B    CD C8CD                           CALL    S1.SYDB2
  865E    CD 894C                           CALL    SAN1
  8661    CD C3BF                           CALL    S1.ANZEI
  8664    0010                              DW      00010H
  8666    10                                DB      16
  8667    53 61 74 7A                       DB      'Satz schreiben ?'
  866B    20 73 63 68           
  866F    72 65 69 62           
  8673    65 6E 20 3F           
  8677    01                                DB      1
  8678    88                                DB      10001000B
  8679    864C                              DW      REW6
  867B    867F                              DW      REW8
  867D    868E                              DW      REW9
                                
  867F    2A B292               REW8:       LD      HL,(S2.DMANF)
  8682    DD 74 08                          LD      (IX+8),H
  8685    DD 75 07                          LD      (IX+7),L
  8688    CD D90B                           CALL    K1.GNWR
  868B    C3 8339                           JP      RELM5
                                
  868E    3A B23C               REW9:       LD      A,(TS.TK)
  8691    FE 38                             CP      '8'
  8693    C0                                RET     NZ
  8694    2A B292                           LD      HL,(S2.DMANF)
  8697    DD 74 08                          LD      (IX+8),H
  869A    DD 75 07                          LD      (IX+7),L
  869D    DD 36 04 08                       LD      (IX+4),8
  86A1    CD D90F                           CALL    K1.GNWR+4
  86A4    C3 8339                           JP      RELM5
                                
                                            PAGE
'REcord Display and Change   D E G 2 0 0 0 V2'	MACRO-80 3.44	09-Dec-81	PAGE	1-15


                                
                                ;****************************************************************
                                ;*               Druckausgabe des Kassetteninhaltes             *
                                ;****************************************************************
  86A7    CD D62D               REHC1:      CALL    K1.RGL1
  86AA    21 B7E0                           LD      HL,S0.PFFI
  86AD    18 06                             JR      REHC5
                                
  86AF    CD D63E               REHC2:      CALL    K1.RGL2
  86B2    21 BBF0                           LD      HL,S0.PFFA
                                
  86B5    22 B292               REHC5:      LD      (S2.DMANF),HL
  86B8    CD D60F                           CALL    K1.BM
  86BB    20 0C                             JR      NZ,REHC7
                                
  86BD    21 81FF                           LD      HL,TXT11            ;Bandmarke
  86C0    01 0023                           LD      BC,TXT13-TXT11
  86C3    CD 8ACF                           CALL    PRINT
  86C6    C3 83FC               REHC6:      JP      RERM4
                                
  86C9    2A B194               REHC7:      LD      HL,(MS.BWSA)        ;Datei- und Satzzaehler ausdrucken
  86CC    06 00                             LD      B,0
  86CE    3A B135                           LD      A,(K2.SKADR+1)
  86D1    C6 09                             ADD     A,9
  86D3    4F                                LD      C,A
  86D4    09                                ADD     HL,BC
  86D5    3A B134                           LD      A,(K2.SKADR)
  86D8    3D                                DEC     A
  86D9    CD CF52                           CALL    MO.PNSP
  86DC    01 001A                           LD      BC,26
  86DF    CD 8ACF                           CALL    PRINT
  86E2    2A B194                           LD      HL,(MS.BWSA)        ;CRC-Summe ausdrucken
  86E5    3E 13                             LD      A,19
  86E7    CD CF52                           CALL    MO.PNSP
  86EA    11 0011                           LD      DE,17
  86ED    19                                ADD     HL,DE
  86EE    01 0013                           LD      BC,19
  86F1    CD 8ACF                           CALL    PRINT
  86F4    0E 1E                             LD      C,1EH
  86F6    CD C030                           CALL    S1.SM+3
                                
  86F9    CD D602                           CALL    K1.LHLBC
  86FC    C5                                PUSH    BC
  86FD    D1                                POP     DE
  86FE    D9                                EXX
  86FF    ED 5B B292                        LD      DE,(S2.DMANF)
  8703    CD C995               HC1:        CALL    S1.HXN1
  8706    06 10                             LD      B,16
  8708    CD C9E4                           CALL    S1.MEAU2
  870B    D5                                PUSH    DE
  870C    CD CF4B                           CALL    MO.BWSE
  870F    01 0007                           LD      BC,7
  8712    09                                ADD     HL,BC
  8713    01 0045                           LD      BC,69
  8716    CD 8ACF                           CALL    PRINT
  8719    0E 1E                             LD      C,1EH
  871B    CD C030                           CALL    S1.SM+3
  871E    D1                                POP     DE
  871F    D9                                EXX
  8720    C5                                PUSH    BC
  8721    D1                                POP     DE
  8722    78                                LD      A,B
  8723    B1                                OR      C
  8724    28 03                             JR      Z,HC9
  8726    D9                                EXX
  8727    18 DA                             JR      HC1
                                
  8729    0E 1E                 HC9:        LD      C,1EH
  872B    CD C030                           CALL    S1.SM+3
  872E    C3 86C6                           JP      REHC6
                                
                                
                                
  8731    CD D62D               REHC3:      CALL    K1.RGL1
  8734    11 B7E0                           LD      DE,S0.PFFI
  8737    18 06                             JR      RHC5
                                
  8739    CD D63E               REHC4:      CALL    K1.RGL2
  873C    11 BBF0                           LD      DE,S0.PFFA
                                
  873F    ED 53 B292            RHC5:       LD      (S2.DMANF),DE
  8743    CD D602                           CALL    K1.LHLBC
'REcord Display and Change   D E G 2 0 0 0 V2'	MACRO-80 3.44	09-Dec-81	PAGE	1-16


  8746    1A                    RHC6:       LD      A,(DE)
  8747    13                                INC     DE
  8748    C5                                PUSH    BC
  8749    4F                                LD      C,A
  874A    CD C030                           CALL    S1.SM+3
  874D    C1                                POP     BC
  874E    0B                                DEC     BC
  874F    78                                LD      A,B
  8750    B1                                OR      C
  8751    20 F3                             JR      NZ,RHC6
  8753    C3 83FC                           JP      RERM4
                                
                                            PAGE
'REcord Display and Change   D E G 2 0 0 0 V2'	MACRO-80 3.44	09-Dec-81	PAGE	1-17


                                
                                ;****************************************************************
                                ;*               Kassette auf "Datei" , "Satz" positionieren    *
                                ;****************************************************************
  8756    CD D62D               P1A:        CALL    K1.RGL1
  8759    21 B7E0                           LD      HL,S0.PFFI
  875C    3E 31                             LD      A,'1'
  875E    18 08                             JR      PA1
                                
  8760    CD D63E               P2A:        CALL    K1.RGL2
  8763    21 BBF0                           LD      HL,S0.PFFA
  8766    3E 32                             LD      A,'2'
                                
  8768    F5                    PA1:        PUSH    AF
  8769    22 B292                           LD      (S2.DMANF),HL
  876C    CD C3BF                           CALL    S1.ANZEI
  876F    0010                              DW      00010H              ;ZPOS=17 , SPOS= 1
  8771    AF                                DB      TXT15-TXT13+80H
  8772    8222                              DW      TXT13
  8774    00                                DB      0
                                
  8775    21 0710                           LD      HL,00710H           ;ZPOS=17 , SPOS= 8
  8778    22 B18C                           LD      (MS.ZPOS),HL
  877B    3E 0B                             LD      A,11                ;HL:=ZPOS,SPOS
  877D    32 B198                           LD      (MS.CMD),A
  8780    CD CB16                           CALL    MO.MONI
  8783    F1                                POP     AF
  8784    77                                LD      (HL),A
  8785    CD 8B3D                           CALL    BWSUS
  8788    CD C3BF               PAA1:       CALL    S1.ANZEI            ;Eingabe Dateinummer
  878B    1410                              DW      01410H              ;ZPOS=17 , SPOS=21
  878D    00                                DB      0
  878E    03                                DB      3
  878F    88                                DB      10001000B
  8790    8387                              DW      BMNQ
  8792    8796                              DW      PAA2
  8794    C328                              DW      S1.AEIN
                                
  8796    21 1410               PAA2:       LD      HL,01410H           ;ZPOS=17 , SPOS=21
  8799    22 B18C                           LD      (MS.ZPOS),HL
  879C    3E 0B                             LD      A,11
  879E    32 B198                           LD      (MS.CMD),A
  87A1    CD CB16                           CALL    MO.MONI
  87A4    EB                                EX      DE,HL
  87A5    CD C592                           CALL    S1.IDH
  87A8    7D                                LD      A,L
  87A9    32 B265                           LD      (S2.PRGN),A
  87AC    CD C3BF                           CALL    S1.ANZEI            ;Eingabe Satznummer
  87AF    1E10                              DW      01E10H              ;ZPOS=17 , SPOS=31
  87B1    00                                DB      0
  87B2    03                                DB      3
  87B3    88                                DB      10001000B
  87B4    8788                              DW      PAA1
  87B6    87BA                              DW      PAA3
  87B8    C328                              DW      S1.AEIN
                                
  87BA    21 1E10               PAA3:       LD      HL,01E10H           ;ZPOS=17 , SPOS=31
  87BD    22 B18C                           LD      (MS.ZPOS),HL
  87C0    3E 0B                             LD      A,11
  87C2    32 B198                           LD      (MS.CMD),A
  87C5    CD CB16                           CALL    MO.MONI
  87C8    EB                                EX      DE,HL
  87C9    CD C592                           CALL    S1.IDH
  87CC    7D                                LD      A,L
  87CD    32 B266                           LD      (S2.PRGN+1),A
  87D0    CD D780                           CALL    K1.GNRW
                                
  87D3    3A B265                           LD      A,(S2.PRGN)         ;auf entspr. Datei setzen
  87D6    B7                                OR      A
  87D7    28 07                             JR      Z,PAA4
  87D9    3D                                DEC     A
  87DA    28 04                             JR      Z,PAA4
  87DC    57                                LD      D,A
  87DD    CD D7F3                           CALL    K1.GNLPN
                                
  87E0    3A B266               PAA4:       LD      A,(S2.PRGN+1)       ;auf entspr. Satz positionieren
  87E3    B7                                OR      A
  87E4    28 0B                             JR      Z,PAA5
  87E6    3D                                DEC     A
  87E7    28 08                             JR      Z,PAA5
  87E9    47                                LD      B,A
  87EA    C5                                PUSH    BC
'REcord Display and Change   D E G 2 0 0 0 V2'	MACRO-80 3.44	09-Dec-81	PAGE	1-18


  87EB    CD D7A5                           CALL    K1.GNRP
  87EE    C1                                POP     BC
  87EF    10 F9                             DJNZ    $-5
                                
  87F1    C3 83FC               PAA5:       JP      RERM4
                                
                                            PAGE
'REcord Display and Change   D E G 2 0 0 0 V2'	MACRO-80 3.44	09-Dec-81	PAGE	1-19


                                
                                ;****************************************************************
                                ;*               Positionieren um "Dateien","Saetze" vor        *
                                ;****************************************************************
  87F4    CD D62D               P1P:        CALL    K1.RGL1
  87F7    21 B7E0                           LD      HL,S0.PFFI
  87FA    3E 31                             LD      A,'1'
  87FC    18 08                             JR      PP1
                                
  87FE    CD D63E               P2P:        CALL    K1.RGL2
  8801    21 BBF0                           LD      HL,S0.PFFA
  8804    3E 32                             LD      A,'2'
                                
  8806    F5                    PP1:        PUSH    AF
  8807    22 B292                           LD      (S2.DMANF),HL
  880A    CD C3BF                           CALL    S1.ANZEI
  880D    0010                              DW      00010H              ;ZPOS=17 , SPOS= 1
  880F    B0                                DB      TXT17-TXT15+80H
  8810    8251                              DW      TXT15
  8812    00                                DB      0
                                
  8813    21 0710                           LD      HL,00710H           ;ZPOS=17 , SPOS= 8
  8816    22 B18C                           LD      (MS.ZPOS),HL
  8819    3E 0B                             LD      A,11                ;HL:=ZPOS,SPOS
  881B    32 B198                           LD      (MS.CMD),A
  881E    CD CB16                           CALL    MO.MONI
  8821    F1                                POP     AF
  8822    77                                LD      (HL),A
  8823    CD 8B3D                           CALL    BWSUS
  8826    CD C3BF               PPA1:       CALL    S1.ANZEI            ;Eingabe Dateinummer
  8829    0C10                              DW      00C10H              ;ZPOS=17 , SPOS=13
  882B    00                                DB      0
  882C    03                                DB      3
  882D    88                                DB      10001000B
  882E    8387                              DW      BMNQ
  8830    8834                              DW      PPA2
  8832    C328                              DW      S1.AEIN
                                
  8834    21 0C10               PPA2:       LD      HL,00C10H           ;ZPOS=17 , SPOS=13
  8837    22 B18C                           LD      (MS.ZPOS),HL
  883A    3E 0B                             LD      A,11
  883C    32 B198                           LD      (MS.CMD),A
  883F    CD CB16                           CALL    MO.MONI
  8842    EB                                EX      DE,HL
  8843    CD C592                           CALL    S1.IDH
  8846    7D                                LD      A,L
  8847    32 B265                           LD      (S2.PRGN),A
  884A    CD C3BF                           CALL    S1.ANZEI            ;Eingabe Satznummer
  884D    1C10                              DW      01C10H              ;ZPOS=17 , SPOS=29
  884F    00                                DB      0
  8850    03                                DB      3
  8851    88                                DB      10001000B
  8852    8826                              DW      PPA1
  8854    8858                              DW      PPA3
  8856    C328                              DW      S1.AEIN
                                
  8858    21 1C10               PPA3:       LD      HL,01C10H           ;ZPOS=17 , SPOS=29
  885B    22 B18C                           LD      (MS.ZPOS),HL
  885E    3E 0B                             LD      A,11
  8860    32 B198                           LD      (MS.CMD),A
  8863    CD CB16                           CALL    MO.MONI
  8866    EB                                EX      DE,HL
  8867    CD C592                           CALL    S1.IDH
  886A    7D                                LD      A,L
  886B    32 B266                           LD      (S2.PRGN+1),A
                                
  886E    3A B265                           LD      A,(S2.PRGN)         ;auf entspr. Datei setzen
  8871    B7                                OR      A
  8872    28 04                             JR      Z,PPA4
  8874    57                                LD      D,A
  8875    CD D7F3                           CALL    K1.GNLPN
                                
  8878    3A B266               PPA4:       LD      A,(S2.PRGN+1)       ;auf entspr. Satz positionieren
  887B    B7                                OR      A
  887C    28 08                             JR      Z,PPA5
  887E    47                                LD      B,A
  887F    C5                                PUSH    BC
  8880    CD D7A5                           CALL    K1.GNRP
  8883    C1                                POP     BC
  8884    10 F9                             DJNZ    $-5
                                
                                
'REcord Display and Change   D E G 2 0 0 0 V2'	MACRO-80 3.44	09-Dec-81	PAGE	1-20


  8886    C3 87F1               PPA5:       JP      PAA5
                                
                                            PAGE
'REcord Display and Change   D E G 2 0 0 0 V2'	MACRO-80 3.44	09-Dec-81	PAGE	1-21


                                
                                ;****************************************************************
                                ;*               Positionieren um "Dateien","Saetze" zurueck    *
                                ;****************************************************************
  8889    CD D62D               P1M:        CALL    K1.RGL1
  888C    21 B7E0                           LD      HL,S0.PFFI
  888F    3E 31                             LD      A,'1'
  8891    18 08                             JR      PQ1
                                
  8893    CD D63E               P2M:        CALL    K1.RGL2
  8896    21 BBF0                           LD      HL,S0.PFFA
  8899    3E 32                             LD      A,'2'
                                
  889B    F5                    PQ1:        PUSH    AF
  889C    22 B292                           LD      (S2.DMANF),HL
  889F    CD C3BF                           CALL    S1.ANZEI
  88A2    0010                              DW      00010H              ;ZPOS=17 , SPOS= 1
  88A4    A7                                DB      TXT16-TXT15+80H
  88A5    8251                              DW      TXT15
  88A7    00                                DB      0
                                
  88A8    CD C3BF                           CALL    S1.ANZEI
  88AB    2710                              DW      02710H              ;ZPOS=17 , SPOS=40
  88AD    8D                                DB      TXT18-TXT17+80H
  88AE    8281                              DW      TXT17
  88B0    00                                DB      0
                                
  88B1    21 0710                           LD      HL,00710H           ;ZPOS=17 , SPOS= 8
  88B4    22 B18C                           LD      (MS.ZPOS),HL
  88B7    3E 0B                             LD      A,11                ;HL:=ZPOS,SPOS
  88B9    32 B198                           LD      (MS.CMD),A
  88BC    CD CB16                           CALL    MO.MONI
  88BF    F1                                POP     AF
  88C0    77                                LD      (HL),A
  88C1    CD 8B3D                           CALL    BWSUS
  88C4    CD C3BF               PQA1:       CALL    S1.ANZEI            ;Eingabe Dateinummer
  88C7    0C10                              DW      00C10H              ;ZPOS=17 , SPOS=13
  88C9    00                                DB      0
  88CA    03                                DB      3
  88CB    88                                DB      10001000B
  88CC    8387                              DW      BMNQ
  88CE    88D2                              DW      PQA2
  88D0    C328                              DW      S1.AEIN
                                
  88D2    21 0C10               PQA2:       LD      HL,00C10H           ;ZPOS=17 , SPOS=13
  88D5    22 B18C                           LD      (MS.ZPOS),HL
  88D8    3E 0B                             LD      A,11
  88DA    32 B198                           LD      (MS.CMD),A
  88DD    CD CB16                           CALL    MO.MONI
  88E0    EB                                EX      DE,HL
  88E1    CD C592                           CALL    S1.IDH
  88E4    7D                                LD      A,L
  88E5    32 B265                           LD      (S2.PRGN),A
  88E8    CD C3BF                           CALL    S1.ANZEI            ;Eingabe Satznummer
  88EB    1C10                              DW      01C10H              ;ZPOS=17 , SPOS=29
  88ED    00                                DB      0
  88EE    03                                DB      3
  88EF    88                                DB      10001000B
  88F0    88C4                              DW      PQA1
  88F2    88F6                              DW      PQA3
  88F4    C328                              DW      S1.AEIN
                                
  88F6    21 1C10               PQA3:       LD      HL,01C10H           ;ZPOS=17 , SPOS=29
  88F9    22 B18C                           LD      (MS.ZPOS),HL
  88FC    3E 0B                             LD      A,11
  88FE    32 B198                           LD      (MS.CMD),A
  8901    CD CB16                           CALL    MO.MONI
  8904    EB                                EX      DE,HL
  8905    CD C592                           CALL    S1.IDH
  8908    7D                                LD      A,L
  8909    32 B266                           LD      (S2.PRGN+1),A
                                
  890C    3A B265                           LD      A,(S2.PRGN)         ;auf entspr. Datei setzen
  890F    B7                                OR      A
  8910    28 04                             JR      Z,PQA4
  8912    57                                LD      D,A
  8913    CD D82B                           CALL    K1.GNLMN
                                
  8916    3A B266               PQA4:       LD      A,(S2.PRGN+1)       ;auf entspr. Satz positionieren
  8919    B7                                OR      A
  891A    28 08                             JR      Z,PQA5
  891C    47                                LD      B,A
'REcord Display and Change   D E G 2 0 0 0 V2'	MACRO-80 3.44	09-Dec-81	PAGE	1-22


  891D    C5                                PUSH    BC
  891E    CD D7C0                           CALL    K1.GNRM
  8921    C1                                POP     BC
  8922    10 F9                             DJNZ    $-5
                                
  8924    C3 8886               PQA5:       JP      PPA5
                                
                                            PAGE
'REcord Display and Change   D E G 2 0 0 0 V2'	MACRO-80 3.44	09-Dec-81	PAGE	1-23


                                
                                ;****************************************************************
                                ;*               Zeile 17 loeschen                              *
                                ;****************************************************************
  8927    2A B18E               ANZLO:      LD      HL,(MS.ZMIN)
  892A    E5                                PUSH    HL
  892B    2A B190                           LD      HL,(MS.ZMAX)
  892E    E5                                PUSH    HL
  892F    21 0111                           LD      HL,00111H
  8932    22 B18E                           LD      (MS.ZMIN),HL
  8935    21 5011                           LD      HL,05011H
  8938    22 B190                           LD      (MS.ZMAX),HL
  893B    3E 05                             LD      A,5
  893D    32 B198                           LD      (MS.CMD),A
  8940    CD CB16                           CALL    MO.MONI
  8943    E1                                POP     HL
  8944    22 B190                           LD      (MS.ZMAX),HL
  8947    E1                                POP     HL
  8948    22 B18E                           LD      (MS.ZMIN),HL
  894B    C9                                RET
                                ;****************************************************************
                                ;*               Satzlaenge und Satzinhalt anzeigen             *
                                ;****************************************************************
  894C    3A B193               SAN1:       LD      A,(MS.SPANZ)        ;ersten 16 BWSA-Zeilen loeschen
  894F    21 A000                           LD      HL,S0.BWSA
  8952    F5                    SAN3:       PUSH    AF
  8953    06 10                             LD      B,16
  8955    36 20                 SAN4:       LD      (HL),' '
  8957    23                                INC     HL
  8958    10 FB                             DJNZ    SAN4
  895A    F1                                POP     AF
  895B    3D                                DEC     A
  895C    20 F4                             JR      NZ,SAN3
  895E    2A B194                           LD      HL,(MS.BWSA)        ;BWS-Pos. "Satzlaenge"
  8961    3E 13                             LD      A,19
  8963    CD CF52                           CALL    MO.PNSP
  8966    11 000C                           LD      DE,12
  8969    19                                ADD     HL,DE
  896A    DD 7E 09                          LD      A,(IX+9)            ;Satzlaenge anzeigen
  896D    CD C5FF                           CALL    S1.BHKON
  8970    DD 7E 0A                          LD      A,(IX+10)
  8973    CD C5FF                           CALL    S1.BHKON
  8976    CD D60F                           CALL    K1.BM
  8979    28 30                             JR      Z,SAN2
  897B    FE 02                             CP      2
  897D    28 6F                             JR      Z,SAN5
  897F    11 000F                           LD      DE,15               ;CRC-Summe  anzeigen
  8982    19                                ADD     HL,DE
  8983    E5                                PUSH    HL
  8984    CD D602                           CALL    K1.LHLBC
  8987    CD C652                           CALL    S1.CHK
  898A    E1                                POP     HL
  898B    7A                                LD      A,D
  898C    CD C5FF                           CALL    S1.BHKON
  898F    7B                                LD      A,E
  8990    CD C5FF                           CALL    S1.BHKON
  8993    ED 5B B292                        LD      DE,(S2.DMANF)       ;Satzinhalt anzeigen
  8997    CD D602                           CALL    K1.LHLBC
  899A    DD 72 08                          LD      (IX+8),D
  899D    DD 73 07                          LD      (IX+7),E
  89A0    ED B0                             LDIR
  89A2    CD D602                           CALL    K1.LHLBC
  89A5    C5                                PUSH    BC
  89A6    D1                                POP     DE
  89A7    CD C935                           CALL    S1.MEAA
  89AA    C9                                RET
                                
  89AB    21 0101               SAN2:       LD      HL,00101H           ;Bandmarke anzeigen
  89AE    22 B18E                           LD      (MS.ZMIN),HL
  89B1    21 5011                           LD      HL,05011H           ;ZMAX=17 , SMAX=80
  89B4    22 B190                           LD      (MS.ZMAX),HL
  89B7    3E 05                             LD      A,5                 ;Bildfenster loeschen
  89B9    32 B198                           LD      (MS.CMD),A
  89BC    CD CB16                           CALL    MO.MONI
  89BF    CD C3BF                           CALL    S1.ANZEI
  89C2    0000                              DW      0
  89C4    27                                DB      39
  89C5    67 65 6C 65                       DB      'gelesener Datenblock ist eine Bandmarke'
  89C9    73 65 6E 65           
  89CD    72 20 44 61           
  89D1    74 65 6E 62           
  89D5    6C 6F 63 6B           
'REcord Display and Change   D E G 2 0 0 0 V2'	MACRO-80 3.44	09-Dec-81	PAGE	1-24


  89D9    20 69 73 74           
  89DD    20 65 69 6E           
  89E1    65 20 42 61           
  89E5    6E 64 6D 61           
  89E9    72 6B 65              
  89EC    00                                DB      0
  89ED    C9                                RET
                                
  89EE    21 0101               SAN5:       LD      HL,00101H           ;Schlussluecke anzeigen
  89F1    22 B18E                           LD      (MS.ZMIN),HL
  89F4    21 5011                           LD      HL,05011H           ;ZMAX=17 , SMAX=80
  89F7    22 B190                           LD      (MS.ZMAX),HL
  89FA    3E 05                             LD      A,5                 ;Bildfenster loeschen
  89FC    32 B198                           LD      (MS.CMD),A
  89FF    CD CB16                           CALL    MO.MONI
  8A02    CD C3BF                           CALL    S1.ANZEI
  8A05    0000                              DW      0
  8A07    2B                                DB      43
  8A08    67 65 6C 65                       DB      'gelesener Datenblock ist eine Schlussluecke'
  8A0C    73 65 6E 65           
  8A10    72 20 44 61           
  8A14    74 65 6E 62           
  8A18    6C 6F 63 6B           
  8A1C    20 69 73 74           
  8A20    20 65 69 6E           
  8A24    65 20 53 63           
  8A28    68 6C 75 73           
  8A2C    73 6C 75 65           
  8A30    63 6B 65              
  8A33    00                                DB      0
  8A34    C9                                RET
                                
                                
                                            PAGE
'REcord Display and Change   D E G 2 0 0 0 V2'	MACRO-80 3.44	09-Dec-81	PAGE	1-25


                                
                                ;****************************************************************
                                ;*               einen Satz einlesen und anzeigen               *
                                ;****************************************************************
  8A35    CD 8A58               RD:         CALL    RD3
  8A38    DD 7E 01                          LD      A,(IX+1)            ;Schlussluecke erreicht ?
  8A3B    FE 14                             CP      14H
  8A3D    C8                                RET     Z                   ;ja
  8A3E    CD D5B7                           CALL    K1.ARBT             ;nein
  8A41    CD D60F                           CALL    K1.BM
  8A44    28 05                             JR      Z,RD1
  8A46    CD D5DE                           CALL    K1.RCZP
  8A49    18 06                             JR      RD2
  8A4B    CD D5C2               RD1:        CALL    K1.BLKP
  8A4E    CD D5FA                           CALL    K1.RCZN
  8A51    CD 894C               RD2:        CALL    SAN1                ;Satzlaenge und Satzinhalt anzeigen
  8A54    3E 01                             LD      A,1
  8A56    B7                                OR      A
  8A57    C9                                RET
                                
  8A58    DD 36 04 02           RD3:        LD      (IX+4),2
  8A5C    CD D551                           CALL    K1.ARMB
  8A5F    CD D615                           CALL    K1.F17
  8A62    CD D60F                           CALL    K1.BM
  8A65    C8                                RET     Z
  8A66    C3 D8B0                           JP      K1.PUFT
                                ;****************************************************************
                                ;*               Pufferlaenge und -adresse ==> E/A-Tabelle      *
                                ;****************************************************************
  8A69    DD 74 08              WR1:        LD      (IX+8),H
  8A6C    DD 75 07                          LD      (IX+7),L
  8A6F    DD 70 09                          LD      (IX+9),B
  8A72    DD 71 0A                          LD      (IX+10),C
  8A75    C9                                RET
                                ;****************************************************************
                                ;*               Datenblock bzw. Bandmarke schreiben            *
                                ;****************************************************************
  8A76    78                    WR2:        LD      A,B
  8A77    B1                                OR      C
  8A78    28 0A                             JR      Z,WR3
  8A7A    CD 8A69               WR:         CALL    WR1
  8A7D    CD D90B                           CALL    K1.GNWR
  8A80    CD D6F1                           CALL    K1.GNSTS
  8A83    C9                                RET
  8A84    DD 36 04 51           WR3:        LD      (IX+4),51H
  8A88    CD D551                           CALL    K1.ARMB
  8A8B    CD D5B7                           CALL    K1.ARBT
  8A8E    CD D5C2                           CALL    K1.BLKP
  8A91    CD D5FA                           CALL    K1.RCZN
  8A94    C9                                RET
                                
                                            PAGE
'REcord Display and Change   D E G 2 0 0 0 V2'	MACRO-80 3.44	09-Dec-81	PAGE	1-26


                                
                                ;****************************************************************
                                ;*               Tastendefinitionen                             *
                                ;****************************************************************
  8A95    CD D40E               TADEF:      CALL    TA.LOE
  8A98    21 828E                           LD      HL,RE2
  8A9B    11 B19F                           LD      DE,TS.TAB1
  8A9E    01 0060                           LD      BC,RERE1-RE2
  8AA1    ED B0                             LDIR
                                
  8AA3    21 C114               TAD1:       LD      HL,S1.SYSTB
  8AA6    22 B21D                           LD      (TS.TAB3+6),HL
  8AA9    21 8AFC                           LD      HL,PANZ
  8AAC    22 B233                           LD      (TS.TAB5),HL
  8AAF    22 B235                           LD      (TS.TAB5+2),HL
  8AB2    22 B237                           LD      (TS.TAB5+4),HL
  8AB5    22 B239                           LD      (TS.TAB5+6),HL
  8AB8    3E 80                             LD      A,10000000B
  8ABA    32 B23F                           LD      (TS.SPMER),A
  8ABD    C9                                RET
                                
                                
  8ABE    CD D40E               TARE:       CALL    TA.LOE
  8AC1    21 82EE                           LD      HL,RERE1
  8AC4    22 B19F                           LD      (TS.TAB1),HL
  8AC7    21 82F3                           LD      HL,RERE2
  8ACA    22 B1B7                           LD      (TS.TAB1+24),HL
  8ACD    18 D4                             JR      TAD1
                                
                                ;****************************************************************
                                ;*               Druckeranschlussroutine                        *
                                ;****************************************************************
  8ACF    E5                    PRINT:      PUSH    HL
  8AD0    C5                                PUSH    BC
  8AD1    7E                                LD      A,(HL)
  8AD2    4F                                LD      C,A
  8AD3    CD C030                           CALL    S1.SM+3
  8AD6    C1                                POP     BC
  8AD7    E1                                POP     HL
  8AD8    23                                INC     HL
  8AD9    0B                                DEC     BC
  8ADA    78                                LD      A,B
  8ADB    B1                                OR      C
  8ADC    20 F1                             JR      NZ,PRINT
  8ADE    C9                                RET
                                
                                            PAGE
'REcord Display and Change   D E G 2 0 0 0 V2'	MACRO-80 3.44	09-Dec-81	PAGE	1-27


                                
                                ;****************************************************************
                                ;*               aktive P-Tasten anzeigen                       *
                                ;****************************************************************
  8ADF    2A B194               PAN:        LD      HL,(MS.BWSA)
  8AE2    3E 14                             LD      A,20                ;Zeile 21 und 22 loeschen
  8AE4    CD CF52                           CALL    MO.PNSP
  8AE7    E5                                PUSH    HL
  8AE8    E5                                PUSH    HL
  8AE9    D1                                POP     DE
  8AEA    13                                INC     DE
  8AEB    06 00                             LD      B,0
  8AED    3A B193                           LD      A,(MS.SPANZ)
  8AF0    87                                ADD     A,A
  8AF1    3D                                DEC     A
  8AF2    4F                                LD      C,A
  8AF3    36 20                             LD      (HL),' '
  8AF5    ED B0                             LDIR
  8AF7    CD 8B3D                           CALL    BWSUS
  8AFA    E1                                POP     HL
  8AFB    C9                                RET
                                
  8AFC    CD 8ADF               PANZ:       CALL    PAN
  8AFF    E5                                PUSH    HL
  8B00    3A B23E                           LD      A,(TS.EMERK)
  8B03    FE 02                             CP      2
  8B05    38 0A                             JR      C,PANZ1
  8B07    28 27                             JR      Z,PANZ2
  8B09    21 815C                           LD      HL,TXT14            ;Ebene 3
  8B0C    01 003A                           LD      BC,TXT3-TXT14
  8B0F    18 25                             JR      PANZ4
                                
  8B11    06 00                 PANZ1:      LD      B,0                 ;Ebene 0 und 1
  8B13    08                                EX      AF,AF'              ;'
  8B14    3A B193                           LD      A,(MS.SPANZ)
  8B17    4F                                LD      C,A
  8B18    E1                                POP     HL                  ;Anzeige in Zeile 22:  Geraet: i
  8B19    E5                                PUSH    HL
  8B1A    09                                ADD     HL,BC
  8B1B    EB                                EX      DE,HL
  8B1C    21 81D3                           LD      HL,TXT9
  8B1F    01 0008                           LD      BC,TXT10-TXT9
  8B22    ED B0                             LDIR
  8B24    08                                EX      AF,AF'              ;'
  8B25    C6 31                             ADD     A,31H
  8B27    12                                LD      (DE),A
  8B28    21 806F                           LD      HL,TXT1
  8B2B    01 0050                           LD      BC,TXT2-TXT1
  8B2E    18 06                             JR      PANZ4
                                
  8B30    21 80BF               PANZ2:      LD      HL,TXT2             ;Ebene 2
  8B33    01 009D                           LD      BC,TXT14-TXT2
  8B36    D1                    PANZ4:      POP     DE                  ;Anzeige in Zeile 21
  8B37    ED B0                             LDIR
  8B39    CD 8B3D                           CALL    BWSUS
  8B3C    C9                                RET
                                
  8B3D    CD F60F               BWSUS:      CALL    S0.BWSUS
  8B40    21 8B51                           LD      HL,BWSUS1           ;Farbwerte fuer Titel setzen
  8B43    01 08FC                           LD      BC,008FCH
  8B46    ED B3                             OTIR
  8B48    21 8B59                           LD      HL,BWSUS2           ;Farbwerte fuer PF-Tasten setzen
  8B4B    01 08FC                           LD      BC,008FCH
  8B4E    ED B3                             OTIR
  8B50    C9                                RET
  8B51    F2                    BWSUS1:     DB      0F2H
  8B52    00                                DB      0                   ;Spalte Anfang
  8B53    28                                DB      40                  ;Spalte Ende
  8B54    12                                DB      18                  ;Zeile
  8B55    03                                DB      3                   ;BColor = Yellow
  8B56    02                                DB      2                   ;FColor = Blue
  8B57    04                                DB      4                   ;CColor = Red
  8B58    FF                                DB      0FFH
                                
  8B59    F2                    BWSUS2:     DB      0F2H
  8B5A    00                                DB      0                   ;Spalte Anfang
  8B5B    9F                                DB      2*80-1              ;Spalte Ende
  8B5C    14                                DB      20                  ;Zeile
  8B5D    06                                DB      6                   ;BColor = Gray
  8B5E    01                                DB      1                   ;FColor = White
  8B5F    04                                DB      4                   ;CColor = Red
  8B60    FF                                DB      0FFH
'REcord Display and Change   D E G 2 0 0 0 V2'	MACRO-80 3.44	09-Dec-81	PAGE	1-28


                                
                                ;
                                            .DEPHASE
                                ;
                                
                                        END
'REcord Display and Change   D E G 2 0 0 0 V2'	MACRO-80 3.44	09-Dec-81	PAGE	S


Macros:

Symbols:
8927 	ANZLO           84A7 	ANZUM           8387 	BMNQ            
8384 	BMPQ            8B3D 	BWSUS           8B51 	BWSUS1          
8B59 	BWSUS2          8703 	HC1             8729 	HC9             
D5B7 	K1.ARBT         D551 	K1.ARMB         D5D0 	K1.BLKM         
D5C2 	K1.BLKP         D60F 	K1.BM           D615 	K1.F17          
D82B 	K1.GNLMN        D7F1 	K1.GNLP         D7F3 	K1.GNLPN        
D765 	K1.GNRA         D89B 	K1.GNRD         D748 	K1.GNRE         
D7C0 	K1.GNRM         D7A5 	K1.GNRP         D780 	K1.GNRW         
D92F 	K1.GNRWR        D6F1 	K1.GNSTS        D90B 	K1.GNWR         
D602 	K1.LHLBC        D8B0 	K1.PUFT         D5EC 	K1.RCZM         
D5FA 	K1.RCZN         D5DE 	K1.RCZP         D62D 	K1.RGL1         
D63E 	K1.RGL2         B136 	K2.FRADR        B134 	K2.SKADR        
DF0C 	LO.EIN          E279 	LO.EIN1         CF4B 	MO.BWSE         
CB45 	MO.BWSUS        CB16 	MO.MONI         CF52 	MO.PNSP         
CD9F 	MO.ROLL         B194 	MS.BWSA         B198 	MS.CMD          
B19E 	MS.CZEIT        B196 	MS.DIRDEL       B197 	MS.DIRES        
B19D 	MS.MCUR         B19C 	MS.MCZ          B19A 	MS.RADR         
B191 	MS.SMAX         B18F 	MS.SMIN         B193 	MS.SPANZ        
B18B 	MS.SPOL         B18D 	MS.SPOS         B199 	MS.TK           
B192 	MS.ZANZ         B190 	MS.ZMAX         B18E 	MS.ZMIN         
B18A 	MS.ZPOL         B18C 	MS.ZPOS         8756 	P1A             
8889 	P1M             87F4 	P1P             8760 	P2A             
8893 	P2M             87FE 	P2P             8768 	PA1             
8788 	PAA1            8796 	PAA2            87BA 	PAA3            
87E0 	PAA4            87F1 	PAA5            8ADF 	PAN             
8AFC 	PANZ            8B11 	PANZ1           8B30 	PANZ2           
8B36 	PANZ4           8806 	PP1             8826 	PPA1            
8834 	PPA2            8858 	PPA3            8878 	PPA4            
8886 	PPA5            889B 	PQ1             88C4 	PQA1            
88D2 	PQA2            88F6 	PQA3            8916 	PQA4            
8924 	PQA5            8ACF 	PRINT           8A35 	RD              
8A4B 	RD1             8A51 	RD2             8A58 	RD3             
828E 	RE2             8359 	REBM1           835E 	REBM2           
8361 	REBM3           8514 	RECB            852A 	RECB1           
8559 	RECB2           8540 	RECB3           856F 	RECB4           
8588 	RECE            859E 	RECE1           85CD 	RECE2           
85B4 	RECE3           85E3 	RECE4           85C7 	RECE6           
85F6 	RECE8           84AD 	RECS            84BA 	RECS1           
84ED 	RECS2           84D0 	RECS3           8503 	RECS4           
84DF 	RECS5           842D 	RECW1           8435 	RECW2           
843B 	RECW3           8465 	RECW4           8493 	RECW5           
844D 	RECW9           8011 	REDD            86A7 	REHC1           
86AF 	REHC2           8731 	REHC3           8739 	REHC4           
86B5 	REHC5           86C6 	REHC6           86C9 	REHC7           
831E 	RELM1           8323 	RELM2           8326 	RELM3           
8334 	RELM4           8339 	RELM5           833C 	RELM6           
834C 	RELP1           8351 	RELP2           8354 	RELP3           
83C4 	REPT1           83CC 	REPT2           83D2 	REPT3           
83D7 	REPT4           830B 	RERA1           8310 	RERA2           
8313 	RERA3           82EE 	RERE1           82F3 	RERE2           
82F6 	RERE3           83E5 	RERM1           83ED 	RERM2           
83F3 	RERM3           83FC 	RERM4           8410 	RERM5           
8419 	RERP1           8421 	RERP2           8427 	RERP3           
82FE 	RERW1           8303 	RERW2           8306 	RERW3           
8389 	RESL1           838E 	RESL2           8391 	RESL3           
85FC 	REW1            8604 	REW2            860A 	REW3            
8619 	REW4            862A 	REW5            864C 	REW6            
8658 	REW7            867F 	REW8            868E 	REW9            
873F 	RHC5            8746 	RHC6            A000 	S0.BWSA         
F60F 	S0.BWSUS        BBF0 	S0.PFFA         B7E0 	S0.PFFI         
00E0 	S0.PROM         0050 	S0.SPANZ        0018 	S0.ZANZ         
C328 	S1.AEIN         C3BF 	S1.ANZEI        C8B0 	S1.ANZU1        
C8C0 	S1.ANZU2        C5FF 	S1.BHKON        C652 	S1.CHK          
C2D3 	S1.CNLS         C2B4 	S1.CNRS         C82E 	S1.DB111        
C86E 	S1.EINDB        C5CC 	S1.HBKON        C54E 	S1.HDI          
C995 	S1.HXN1         C592 	S1.IDH          C532 	S1.INPTR        
C935 	S1.MEAA         C9E4 	S1.MEAU2        C334 	S1.NN           
C345 	S1.NNN          C02D 	S1.SM           C8CD 	S1.SYDB2        
C114 	S1.SYSTB        B26E 	S2.AADR         B28A 	S2.AFOR         
B28B 	S2.BZ           B263 	S2.CST          B2B8 	S2.DDEI         
B28F 	S2.DH           B28E 	S2.DL           B29A 	S2.DM1          
B2AA 	S2.DM2          B292 	S2.DMANF        B296 	S2.DMBA         
B298 	S2.DMBE         B294 	S2.DMCUR        B2AB 	S2.DMH          
B2AC 	S2.DML          B26B 	S2.DNR          B264 	S2.IOC          
B270 	S2.KADR         B290 	S2.PAR1         B265 	S2.PRGN         
B26C 	S2.RBBR         B2AF 	S2.S1           B2B0 	S2.S2           
B2AD 	S2.SMHL         B273 	S2.SP1          B274 	S2.SP2          
B275 	S2.SP3          B28C 	S2.TE           B276 	S2.TRB          
B272 	S2.ZP           B262 	S2.ZZ           E697 	S9.CIN          
'REcord Display and Change   D E G 2 0 0 0 V2'	MACRO-80 3.44	09-Dec-81	PAGE	S-1


E6E6 	S9.CON          E6CB 	S9.CSTSX        EEB8 	S9.LOAD         
EE98 	S9.SAVE         894C 	SAN1            89AB 	SAN2            
8952 	SAN3            8955 	SAN4            89EE 	SAN5            
83B8 	SLPQ            D40E 	TA.LOE          D426 	TA.LOES         
8AA3 	TAD1            8A95 	TADEF           8ABE 	TARE            
B249 	TS.BFOL1        B24B 	TS.BFOL2        B22D 	TS.EINA         
B23E 	TS.EMERK        B241 	TS.KGMER        B248 	TS.MBF          
B247 	TS.MIO          B231 	TS.NEWL         B23B 	TS.PTAST        
B23D 	TS.PTK          B23F 	TS.SPMER        B24D 	TS.STACK        
B19F 	TS.TAB1         B1FF 	TS.TAB2         B217 	TS.TAB3         
B223 	TS.TAB4         B233 	TS.TAB5         B22F 	TS.TABU         
B23C 	TS.TK           B240 	TS.UMERK        B245 	TS.ZEI21        
B243 	TS.ZEIT1        B244 	TS.ZEIT2        B242 	TS.ZSMER        
B246 	TS.ZSTC         806F 	TXT1            81DB 	TXT10           
81FF 	TXT11           8220 	TXT12           8222 	TXT13           
815C 	TXT14           8251 	TXT15           8278 	TXT16           
8281 	TXT17           828E 	TXT18           80BF 	TXT2            
8196 	TXT3            819F 	TXT4            81A5 	TXT5            
81AD 	TXT6            81B5 	TXT7            81C4 	TXT8            
81D3 	TXT9            8A7A 	WR              8A69 	WR1             
8A76 	WR2             8A84 	WR3             



No Fatal error(s)


