''	MACRO-80 3.44	09-Dec-81	PAGE	1


                                ;	PUBLIC	UC.CVDB,UC.CVBD2
                                ;	EXT	ATACO,DRUZ,RET,SD.BWSA,SM.FKTAB
                                
  24F8                          ATACO     EQU	024F8H
  7C00                          DRUZ      EQU	07C00H
  09E3                          RET       EQU	009E3H
  3000                          SD.BWSA   EQU	03000H
  0D00                          SM.FKTAB  EQU	00D00H
                                
                         C      	INCLUDE K0.ASM
                         C      	PAGE
''	MACRO-80 3.44	09-Dec-81	PAGE	1-1


                         C      
                         C      ;	PN	UE01
                         C      ;****************************************************************
                         C      ;*                  EQUAL - Anweisungen fuer Assembler          *
                         C      ;****************************************************************
  00F7                   C      UE.TACL	EQU	0F7H	;Kursor nach links
  00F9                   C      UE.TACR	EQU	0F9H	; ''    nach rechts
  00CD                   C      UE.TASYS	EQU	0CDH	;SYS-Taste
  001E                   C      UE.TAQUI	EQU	01EH	;ET1
  007D                   C      UE.SVL	EQU	07DH	;Laenge der SAVE-Bloecke
  0060                   C      UE.COTAL	EQU	060H	;Laenge ASC/KOI Codetabelle
  0132                   C      UE.KMPUL	EQU	132H	;max. Laenge E/A-Puffer
                         C      
  000B                   C      UE.SYSTB	EQU	0000BH	;SY.SYSTB
  0CFE                   C      UE.STANF	EQU	00CFEH	;STACK
  0DC4                   C      UE.EDEND	EQU	00DC4H	;Speicherpl. fuer Adr. Editorende
  0E5A                   C      UE.ZEIN	EQU	00E5AH	;Pufferzaehler Eingabe
  0E66                   C      UE.PUF	EQU	00E66H	;System-Puffer
  3000                   C      UE.BWSA	EQU	03000H	;Bildwiederholspeicher
  8010                   C      UE.KPUFF	EQU	08010H	;E/A Puffer
  8830                   C      UE.TEXAN	EQU	08830H	;Begin Editorraum
                         C      
  4000                   C      UE.BRKMB	EQU	04000H	;phys. Kass.Routine
  46AD                   C      UE.BERT	EQU	046ADH	;Warteschleife in Kass.Rout.
  4740                   C      UE.CRC	EQU	04740H	;CRC-Berechnung
  4965                   C      UE.KINI	EQU	04965H	;Initialisierung AKB
                         C      
  6EE6                   C      UE.TARO	EQU	06EE6H	;Tast.Routine
  7C00                   C      UE.PRINT	EQU	07C00H	;Ausgabe (A) auf Drucker
                         C      
                         C      ;	END
                         C      	PAGE
''	MACRO-80 3.44	09-Dec-81	PAGE	1-2


                         C      
                         C      ;	PN	UB
                         C      	ORG	2B00H
  2B00'                  C      UB.ZN:    DS	1
  2B01'                  C      UB.KTAB:  DS	27
  2B1C'                  C      UB.PAR1:  DS 2
  2B1E'                  C      UB.PAR2:  DS	2
  2B20'                  C      UB.PAR3:  DS	2
  2B22'                  C      UB.PAR4:  DS	2
  2B24'                  C      UB.PAR5:  DS	2
  2B26'                  C      UB.PATAB: DS	4
  2B2A'   00             C      UB.SATZ:  DB	0
  2B2B'   37             C                DB	55
  2B2C'   80             C                DB	80H
  2B2D'   20 20 20 20    C                DB	'                                                       '
  2B31'   20 20 20 20    C      
  2B35'   20 20 20 20    C      
  2B39'   20 20 20 20    C      
  2B3D'   20 20 20 20    C      
  2B41'   20 20 20 20    C      
  2B45'   20 20 20 20    C      
  2B49'   20 20 20 20    C      
  2B4D'   20 20 20 20    C      
  2B51'   20 20 20 20    C      
  2B55'   20 20 20 20    C      
  2B59'   20 20 20 20    C      
  2B5D'   20 20 20 20    C      
  2B61'   20 20 20       C      
  2B64'                  C      UB.DTAB:  DS	41
  2B8D'                  C      UB.END    EQU	$
                         C      ;	END
                         C      	PAGE
''	MACRO-80 3.44	09-Dec-81	PAGE	1-3


                         C      
                         C      ;	PN	UR
                         C      	ORG	49A0H
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;   ROUTINEN FUER KASSETTE,MONITOR UND TASTATUR
                         C      ;
                         C      ;----------------------------------------------------------------------
                         C      ;   1.     KASSETTE
                         C      ;----------------------------------------------------------------------
  49A0'   DD 36 04 31    C      UR.KRE:	LD	(IX+4),31H
  49A4'   CD 4CD0'       C      KRE1:	CALL	UF.EXEC
  49A7'   C9             C      	RET
  49A8'   DD 36 04 21    C      UR.KRW:	LD	(IX+4),21H
  49AC'   18 F6          C      	JR	KRE1	;Umspulen
  49AE'   CD 6142'       C      UR.KRWW:	CALL	KRW
  49B1'   CD 4FB4'       C      	CALL	U1.WAIT
  49B4'   C9             C      	RET
  49B5'   DD 36 04 41    C      UR.KRA:	LD	(IX+4),41H
  49B9'   18 E9          C      	JR	KRE1	;Reservieren aus
  49BB'   DD 36 04 71    C      UR.KLV:	LD	(IX+4),71H
  49BF'   18 E3          C      	JR	KRE1	;Label vorsetzen
  49C1'   DD 36 04 75    C      UR.KLR:	LD	(IX+4),75H
  49C5'   18 DD          C      	JR	KRE1	;LABEL RUECKSETZEN
  49C7'   DD 36 04 51    C      UR.KBM:	LD	(IX+4),51H
  49CB'   18 D7          C      	JR	KRE1	;BANDMARKE SCHREIBEN
  49CD'   DD 36 04 61    C      UR.KSL:	LD	(IX+4),61H
  49D1'   18 D1          C      	JR	KRE1	;SCHLUSSLUECKE SCHREIBEN
  49D3'   DD 36 04 11    C      UR.KBV:	LD	(IX+4),11H
  49D7'   18 CB          C      	JR	KRE1	;Block vorsetzen
  49D9'   DD 36 04 15    C      UR.KBR:	LD	(IX+4),15H
  49DD'   18 C5          C      	JR	KRE1
  49DF'   E5             C      RPOS:	PUSH	HL
  49E0'   D5             C      	PUSH	DE
  49E1'   F5             C      	PUSH	AF
  49E2'   C5             C      	PUSH	BC
  49E3'   AF             C      	XOR	A
  49E4'   3D             C      	DEC	A
  49E5'   4F             C      	LD	C,A
  49E6'   18 06          C      	JR	$+8
  49E8'   E5             C      UR.POSIK:	PUSH	HL
  49E9'   D5             C      	PUSH	DE
  49EA'   F5             C      	PUSH	AF
  49EB'   C5             C      	PUSH	BC	;Positionieren
  49EC'   AF             C      	XOR	A
  49ED'   4F             C      	LD	C,A
  49EE'   06 00          C      	LD	B,0
  49F0'   11 0000        C      	LD	DE,0
  49F3'   DD 36 04 02    C      LES:	LD	(IX+4),02H
  49F7'   CD 4CD0'       C      	CALL	UF.EXEC	;BLOCK LESEN
  49FA'   DD 7E 09       C      	LD	A,(IX+9)
  49FD'   DD B6 0A       C      	OR	(IX+10)	;BANDMARKE?
  4A00'   28 19          C      	JR	Z,BM
  4A02'   04             C      	INC	B	;ANZAHL BLOECKE
  4A03'   78             C      	LD	A,B
  4A04'   FE 04          C      	CP	4
  4A06'   28 21          C      	JR	Z,OK
  4A08'   21 0000        C      	LD	HL,0
  4A0B'   CD 51A6'       C      	CALL	XY.LIDX
  4A0E'   09             C      	DB	9	;HL<--BLOCKLAENGE
  4A0F'   19             C      	ADD	HL,DE
''	MACRO-80 3.44	09-Dec-81	PAGE	1-4


  4A10'   EB             C      	EX	DE,HL
  4A11'   21 012C        C      	LD	HL,300
  4A14'   B7             C      	OR	A
  4A15'   ED 52          C      	SBC	HL,DE
  4A17'   38 10          C      	JR	C,OK
  4A19'   18 D8          C      	JR	LES
  4A1B'   AF             C      BM:	XOR	A
  4A1C'   B1             C      	OR	C
  4A1D'   28 04          C      	JR	Z,$+6
  4A1F'   C1             C      	POP	BC
  4A20'   04             C      	INC	B
  4A21'   18 C8          C      	JR	UR.POSIK+3
  4A23'   C1             C      	POP	BC
  4A24'   05             C      	DEC	B
  4A25'   28 21          C      	JR	Z,RSP
  4A27'   18 C2          C      	JR	UR.POSIK+3
  4A29'   AF             C      OK:	XOR	A
  4A2A'   B1             C      	OR	C
  4A2B'   28 08          C      	JR	Z,$+10
  4A2D'   DD 70 0A       C      	LD	(IX+10),B
  4A30'   CD 49C1'       C      	CALL	UR.KLR
  4A33'   18 13          C      	JR	RSP
  4A35'   DD 36 04 15    C      	LD	(IX+4),15H
  4A39'   CD 4CD0'       C      	CALL	UF.EXEC
  4A3C'   10 F7          C      	DJNZ	$-7
  4A3E'   C1             C      	POP	BC
  4A3F'   05             C      	DEC	B
  4A40'   28 06          C      	JR	Z,RSP
  4A42'   DD 70 0A       C      	LD	(IX+10),B
  4A45'   CD 49BB'       C      	CALL	UR.KLV
  4A48'   F1             C      RSP:	POP	AF
  4A49'   D1             C      	POP	DE
  4A4A'   E1             C      	POP	HL
  4A4B'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;     2.     MONITOR
                         C      ;----------------------------------------------------------------------
  4A4C'   D5             C      UR.MIMO:	PUSH	DE	;Register DE, BC retten
  4A4D'   C5             C      	PUSH	BC
  4A4E'   46             C      	LD	B,(HL)	;Anzahl einzugebender Zeichen
  4A4F'   23             C      	INC	HL
  4A50'   4E             C      	LD	C,(HL)	;Laenge der Zeichenkette
  4A51'   23             C      	INC	HL
  4A52'   5E             C      	LD	E,(HL)	;Zeichenschluessel
  4A53'   23             C      	INC	HL
  4A54'   3A 2B00'       C      	LD	A,(UB.ZN)	;Zeilennummer
  4A57'   57             C      	LD	D,A	;D:= Zeilennummer
  4A58'   AF             C      	XOR	A
  4A59'   B9             C      	CP	C
  4A5A'   28 0C          C      	JR	Z,MIMO1	;Anzeige entfaellt
  4A5C'   D5             C      	PUSH	DE
  4A5D'   CD 4A8E'       C      	CALL	DSPZK	;Anzeige
  4A60'   D1             C      MIMO2:	POP	DE
  4A61'   CD 4A9B'       C      	CALL	ZINP	;Zeicheneingabe ueber Tastatur
  4A64'   C1             C      	POP	BC
  4A65'   D1             C      	POP	DE
  4A66'   18 07          C      	JR	MIMO3
  4A68'   D5             C      MIMO1:	PUSH	DE
  4A69'   CD 4A7E'       C      	CALL	BBSAD	;BWS - Adresse berechnen
  4A6C'   EB             C      	EX	DE,HL	;HL:= akt. Bildschirmposition
  4A6D'   18 F1          C      	JR	MIMO2
  4A6F'   F5             C      MIMO3:	PUSH	AF
''	MACRO-80 3.44	09-Dec-81	PAGE	1-5


  4A70'   3A 2B00'       C      	LD	A,(UB.ZN)
  4A73'   3C             C      	INC	A
  4A74'   FE 18          C      	CP	24
  4A76'   CC 4B75'       C      	CALL	Z,BILRO	;Zeile 24 ---> Bild rollen
  4A79'   32 2B00'       C      	LD	(UB.ZN),A
  4A7C'   F1             C      	POP	AF
  4A7D'   C9             C      	RET
  4A7E'   E5             C      BBSAD:	PUSH	HL	;Berechnung der BWS-Adresse
  4A7F'   C5             C      	PUSH	BC	;IN:    D...Zeilennummer
  4A80'   21 2FB0        C      	LD	HL,UE.BWSA-80	;OUT:   DE..BWS-Adresse
  4A83'   01 0050        C      	LD	BC,80	;BC:= Zeichen/Zeile
  4A86'   09             C      BBSA1:	ADD	HL,BC
  4A87'   15             C      	DEC	D
  4A88'   20 FC          C      	JR	NZ,BBSA1
  4A8A'   EB             C      	EX	DE,HL
  4A8B'   C1             C      	POP	BC
  4A8C'   E1             C      	POP	HL
  4A8D'   C9             C      	RET
  4A8E'   D5             C      DSPZK:	PUSH	DE	;Anzeige
  4A8F'   C5             C      	PUSH	BC	;IN   HL...Anfangsadresse ZK
  4A90'   CD 4A7E'       C      	CALL	BBSAD	;      D...Zeilennummer
  4A93'   06 00          C      	LD	B,0	;      C...Zeichenkettenlaenge
  4A95'   ED B0          C      	LDIR		;OUT  HL...akt. BWS-Adresse
  4A97'   EB             C      	EX	DE,HL
  4A98'   C1             C      	POP	BC
  4A99'   D1             C      	POP	DE
  4A9A'   C9             C      	RET
  4A9B'   E5             C      ZINP:	PUSH	HL	;Zeicheneingabe ueber Tastatur
  4A9C'   AF             C      	XOR	A	;IN    B...Zeichenanzahl (max.)
  4A9D'   50             C      	LD	D,B	;     HL...akt. Adresse
  4A9E'   B8             C      	CP	B	;      E...Zeichenschluessel
  4A9F'   28 38          C      	JR	Z,RET0	;keine Zeicheneingabe
  4AA1'   CB FE          C      ZINP1:	SET	7,(HL)	;Kursor setzen
  4AA3'   CD 4B6F'       C      ZINP2:	CALL	UR.TAREP	;Tastaturabfrage
  4AA6'   CD 4AE3'       C      	CALL	TCL	; <---
  4AA9'   CD 4AF6'       C      	CALL	TCR	; --->
  4AAC'   CD 4B07'       C      	CALL	TSYS	; SYS
  4AAF'   CD 4B0F'       C      	CALL	TQUIT	; POS.QUIT
  4AB2'   CD 4B17'       C      	CALL	ZKONT	;Zeichenkontrolle
  4AB5'   CB BE          C      	RES	7,(HL)	;Kursor loeschen
  4AB7'   77             C      	LD	(HL),A	;Zeichen anzeigen
  4AB8'   23             C      	INC	HL	;akt. Adresse erhoehen
  4AB9'   10 E6          C      	DJNZ	ZINP1	;B > 0, naechstes Zeichen
  4ABB'   CB FE          C      	SET	7,(HL)	;Kursor setzen
  4ABD'   CD 4B6F'       C      ZINP5:	CALL	UR.TAREP
  4AC0'   FE F7          C      	CP	UE.TACL
  4AC2'   CC 4ADC'       C      	CALL	Z,ZINP7
  4AC5'   FE 1E          C      	CP	UE.TAQUI
  4AC7'   28 06          C      	JR	Z,ZINP3	;---> POS.QUIT
  4AC9'   FE CD          C      	CP	UE.TASYS
  4ACB'   28 07          C      	JR	Z,ZINP4	;---> SYS
  4ACD'   18 EE          C      	JR	ZINP5
  4ACF'   CB BE          C      ZINP3:	RES	7,(HL)	;Kursor loeschen
  4AD1'   E1             C      	POP	HL	;BWS - Adresse auskellern
  4AD2'   AF             C      	XOR	A	;CY:= 0
  4AD3'   C9             C      	RET
  4AD4'   CB BE          C      ZINP4:	RES	7,(HL)	;Kursor loeschen
  4AD6'   E1             C      	POP	HL
  4AD7'   37             C      	SCF		;CY:= 1
  4AD8'   C9             C      	RET
  4AD9'   E1             C      RET0:	POP	HL	;keine Zeicheneingabe
  4ADA'   AF             C      	XOR	A
''	MACRO-80 3.44	09-Dec-81	PAGE	1-6


  4ADB'   C9             C      	RET
  4ADC'   CD 4AE3'       C      ZINP7:	CALL	TCL
  4ADF'   33             C      	INC	SP
  4AE0'   33             C      	INC	SP
  4AE1'   18 C0          C      	JR	ZINP2
  4AE3'   FE F7          C      TCL:	CP	UE.TACL	;   <---
  4AE5'   C0             C      	RET	NZ		;Taste nicht gedrueckt
  4AE6'   F5             C      	PUSH	AF	;Tastencode retten
  4AE7'   04             C      	INC	B
  4AE8'   7A             C      	LD	A,D
  4AE9'   B8             C      	CP	B
  4AEA'   38 07          C      	JR	C,TCLN	;Linksbewegung nicht zulaessig
  4AEC'   CB BE          C      	RES	7,(HL)	;Kursor loeschen
  4AEE'   2B             C      	DEC	HL	;BWS - Adresse decrementieren
  4AEF'   CB FE          C      	SET	7,(HL)	;Kursor setzen
  4AF1'   F1             C      	POP	AF	;Code auskellern
  4AF2'   C9             C      	RET
  4AF3'   05             C      TCLN:	DEC	B
  4AF4'   F1             C      	POP	AF
  4AF5'   C9             C      	RET
  4AF6'   FE F9          C      TCR:	CP	UE.TACR	;   --->
  4AF8'   C0             C      	RET	NZ
  4AF9'   F5             C      	PUSH	AF
  4AFA'   78             C      	LD	A,B
  4AFB'   FE 02          C      	CP	2
  4AFD'   38 06          C      	JR	C,TCRN
  4AFF'   05             C      	DEC	B
  4B00'   CB BE          C      	RES	7,(HL)
  4B02'   23             C      	INC	HL
  4B03'   CB FE          C      	SET	7,(HL)
  4B05'   F1             C      TCRN:	POP	AF
  4B06'   C9             C      	RET
  4B07'   FE CD          C      TSYS:	CP	UE.TASYS	; SYS-Taste
  4B09'   C0             C      	RET	NZ
  4B0A'   33             C      	INC	SP
  4B0B'   33             C      	INC	SP	;Returnadresse uebergehen
  4B0C'   C3 4AD4'       C      	JP	ZINP4
  4B0F'   FE 1E          C      TQUIT:	CP	UE.TAQUI	; POS.QUIT
  4B11'   C0             C      	RET	NZ
  4B12'   33             C      	INC	SP
  4B13'   33             C      	INC	SP
  4B14'   C3 4ACF'       C      	JP	ZINP3
  4B17'   FE 7F          C      ZKONT:	CP	7FH
  4B19'   30 22          C      	JR	NC,ZKON1
  4B1B'   CB 7B          C      	BIT	7,E	;Zeichenschluesselauswertung
  4B1D'   C0             C      	RET	NZ		;Bit 7 = L, alle Tasten erlaubt
  4B1E'   FE 20          C      	CP	20H
  4B20'   C8             C      	RET	Z		;Leertaste
  4B21'   CB 6B          C      	BIT	5,E
  4B23'   37             C      	SCF
  4B24'   C4 4B42'       C      	CALL	NZ,ALPHA
  4B27'   D0             C      	RET	NC		;Bit 5 = L, nur Buchstaben
  4B28'   CB 63          C      	BIT	4,E
  4B2A'   37             C      	SCF
  4B2B'   C4 4B4D'       C      	CALL	NZ,UR.NUM
  4B2E'   D0             C      	RET	NC		;Bit 4 = L, nur Ziffern
  4B2F'   CB 73          C      	BIT	6,E
  4B31'   37             C      	SCF
  4B32'   C4 4B56'       C      	CALL	NZ,ALPNU
  4B35'   D0             C      	RET	NC		;Bit 6 = L, Buchstaben und
                         C      			;            Ziffern
  4B36'   CB 5B          C      	BIT	3,E
''	MACRO-80 3.44	09-Dec-81	PAGE	1-7


  4B38'   37             C      	SCF
  4B39'   C4 4B60'       C      	CALL	NZ,HEXAZ
  4B3C'   D0             C      	RET	NC		;BIT 3 = L ,HEXAZEICHEN
  4B3D'   33             C      ZKON1:	INC	SP
  4B3E'   33             C      	INC	SP
  4B3F'   C3 4AA3'       C      	JP	ZINP2	;unerlaubter Tastencode
  4B42'   FE 41          C      ALPHA:	CP	41H
  4B44'   D8             C      	RET	C
  4B45'   FE 5B          C      	CP	5BH
  4B47'   38 02          C      	JR	C,ALPH1
  4B49'   37             C      	SCF
  4B4A'   C9             C      	RET
  4B4B'   3F             C      ALPH1:	CCF
  4B4C'   C9             C      	RET
  4B4D'   FE 30          C      UR.NUM:	CP	30H
  4B4F'   D8             C      	RET	C
  4B50'   FE 3A          C      	CP	3AH
  4B52'   38 F7          C      	JR	C,ALPH1
  4B54'   37             C      	SCF
  4B55'   C9             C      	RET
  4B56'   CD 4B42'       C      ALPNU:	CALL	ALPHA
  4B59'   D0             C      	RET	NC
  4B5A'   CD 4B4D'       C      	CALL	UR.NUM
  4B5D'   D0             C      	RET	NC
  4B5E'   37             C      	SCF
  4B5F'   C9             C      	RET
  4B60'   CD 4B4D'       C      HEXAZ:	CALL	UR.NUM
  4B63'   D0             C      	RET	NC
  4B64'   FE 41          C      	CP	'A'
  4B66'   D8             C      	RET	C
  4B67'   FE 47          C      	CP	'G'
  4B69'   38 02          C      	JR	C,HEXZ1
  4B6B'   37             C      	SCF
  4B6C'   C9             C      	RET
  4B6D'   3F             C      HEXZ1:	CCF
  4B6E'   C9             C      	RET
  4B6F'   CD 6EE6        C      UR.TAREP:	CALL	UE.TARO	;TASTATURROUTINE FUER ATS
  4B72'   28 FB          C      	JR	Z,$-3	;ES LIEGT KEIN ZEICHEN AN
  4B74'   C9             C      	RET
  4B75'   C5             C      BILRO:	PUSH	BC
  4B76'   D5             C      	PUSH	DE
  4B77'   E5             C      	PUSH	HL
  4B78'   01 03C0        C      	LD	BC,960
  4B7B'   11 3370        C      	LD	DE,UE.BWSA+880
  4B7E'   21 33C0        C      	LD	HL,UE.BWSA+960
  4B81'   ED B0          C      	LDIR
  4B83'   3E 20          C      	LD	A,20H	;letzte Zeile loeschen
  4B85'   06 50          C      	LD	B,80
  4B87'   12             C      BILR1:	LD	(DE),A
  4B88'   10 FD          C      	DJNZ	BILR1
  4B8A'   E1             C      	POP	HL
  4B8B'   AF             C      	XOR	A
  4B8C'   01 0050        C      	LD	BC,80
  4B8F'   ED 42          C      	SBC	HL,BC	;aktuelle BWS-Adresse nach  ROLL
  4B91'   3A 2B00'       C      	LD	A,(UB.ZN)
  4B94'   D1             C      	POP	DE
  4B95'   C1             C      	POP	BC
  4B96'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                         C      	PAGE
''	MACRO-80 3.44	09-Dec-81	PAGE	1-8


                         C      
                         C      ;	PN	UK
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;        Einzelzeicheneingabe fuer KMBG
                         C      ;
                         C      ;----------------------------------------------------------------------
                         C      ;
  4B97'   CD 4F8A'       C      UK.GETK:	CALL	U1.RSAVE
  4B9A'   CD 51A6'       C      	CALL	XY.LIDX	;HL:= Blocklaenge
  4B9D'   09             C      	DB	9
  4B9E'   E5             C      	PUSH	HL
  4B9F'   CD 5196'       C      	CALL	XY.LDDX
  4BA2'   17             C      	DB	23
  4BA3'   EB             C      	EX	DE,HL	;DE:= Pufferzaehler
  4BA4'   AF             C      	XOR	A
  4BA5'   E1             C      	POP	HL	;HL:= Blocklaenge
  4BA6'   ED 52          C      	SBC	HL,DE
  4BA8'   E5             C      	PUSH	HL	;Restbyteanzahl retten
  4BA9'   7C             C      	LD	A,H
  4BAA'   B5             C      	OR	L
  4BAB'   CC 4BF7'       C      	CALL	Z,UK.KBW	;Block lesen
  4BAE'   E1             C      	POP	HL
  4BAF'   AF             C      	XOR	A
  4BB0'   BC             C      	CP	H
  4BB1'   20 05          C      	JR	NZ,GETK2
  4BB3'   7D             C      	LD	A,L
  4BB4'   FE 01          C      	CP	1
  4BB6'   28 08          C      	JR	Z,GETK3	;---> letztes Datenbyte des
  4BB8'   CD 4BC6'       C      GETK2:	CALL	GETK4
  4BBB'   B7             C      	OR	A
  4BBC'   CD 4F92'       C      GETK5:	CALL	U1.RRST
  4BBF'   C9             C      	RET
                         C      ;
                         C      ;
  4BC0'   CD 4BC6'       C      GETK3:	CALL	GETK4
  4BC3'   37             C      	SCF
  4BC4'   18 F6          C      	JR	GETK5
                         C      ;
  4BC6'   CD 5196'       C      GETK4:	CALL	XY.LDDX	;HL:= aktuelle Pufferadresse
  4BC9'   15             C      	DB	21
  4BCA'   7E             C      	LD	A,(HL)	;Datenbyte laden
  4BCB'   CD 51D6'       C      	CALL	XY.INCDX	;Pufferzeiger erhoehen
  4BCE'   15             C      	DB	21
  4BCF'   CD 51D6'       C      	CALL	XY.INCDX	;Pufferzaehler erhoehen
  4BD2'   17             C      	DB	23
  4BD3'   C9             C      	RET
                         C      ;
                         C      ;******************************************************************
                         C      ;
                         C      ;        KMBG  Eingabepuffer bereitstellen
                         C      ;
                         C      ;*******************************************************************
                         C      ;
  4BD4'   CD 4F8A'       C      UK.KLPFB:	CALL	U1.RSAVE
  4BD7'   CD 5090'       C      	CALL	U1.KTIN1
  4BDA'   21 0100        C      	LD	HL,100H	;max. Blocklaenge Kassette
  4BDD'   CD 51C6'       C      	CALL	XY.STIDX	;max. Blocklaenge initialisieren
  4BE0'   09             C      	DB	9
  4BE1'   E5             C      	PUSH	HL
  4BE2'   C1             C      	POP	BC	;BC:= Blocklaenge
''	MACRO-80 3.44	09-Dec-81	PAGE	1-9


  4BE3'   CD 51B6'       C      	CALL	XY.STDX	;Pufferzaehler "Leer"
  4BE6'   17             C      	DB	23
  4BE7'   21 0E66        C      	LD	HL,UE.PUF	;Systempuffer Kassette
  4BEA'   CD 4F9B'       C      	CALL	U1.CLRB	;Systempuffer loeschen
  4BED'   21 8010        C      	LD	HL,UE.KPUFF
  4BF0'   CD 4F9B'       C      	CALL	U1.CLRB
  4BF3'   CD 4F92'       C      	CALL	U1.RRST
  4BF6'   C9             C      	RET
                         C      ;
                         C      ;******************************************************************
                         C      ;
                         C      ;        Einlesen eines Blockes von Kassette
                         C      ;
                         C      ;         - Besonderheit gegenueber MBW: Blockinhalt wird vom
                         C      ;           Systempuffer in den E/A-Puffer uebertragen
                         C      ;
                         C      ;*******************************************************************
                         C      ;
  4BF7'   CD 4F8A'       C      UK.KBW:	CALL	U1.RSAVE
  4BFA'   CD 4BD4'       C      	CALL	UK.KLPFB
  4BFD'   DD 36 04 02    C      	LD	(IX+4),02H
  4C01'   CD 4CD0'       C      	CALL	UF.EXEC
  4C04'   DD 7E 09       C      	LD	A,(IX+9)
  4C07'   DD B6 0A       C      	OR	(IX+10)
  4C0A'   28 2A          C      	JR	Z,UK.KBW1	;EOF
  4C0C'   CD 5196'       C      	CALL	XY.LDDX	;HL:= Blockadresse
  4C0F'   07             C      	DB	7
  4C10'   DD 46 09       C      	LD	B,(IX+9)	;BC:= Blocklaenge
  4C13'   DD 4E 0A       C      	LD	C,(IX+10)
  4C16'   E5             C      	PUSH	HL	;E/A-Puffer
  4C17'   CD 5196'       C      	CALL	XY.LDDX
  4C1A'   19             C      	DB	25
  4C1B'   EB             C      	EX	DE,HL
  4C1C'   E1             C      	POP	HL
  4C1D'   ED B0          C      	LDIR		;Transport in E/A-Puffer
  4C1F'   CD 5196'       C      	CALL	XY.LDDX
  4C22'   19             C      	DB	25
  4C23'   CD 51B6'       C      	CALL	XY.STDX	;Pufferzeiger auf Anfang
  4C26'   15             C      	DB	21
  4C27'   21 0000        C      	LD	HL,0
  4C2A'   CD 51B6'       C      	CALL	XY.STDX	;Pufferzaehler rueckstellen
  4C2D'   17             C      	DB	23
  4C2E'   CD 51D6'       C      	CALL	XY.INCDX	;Blockzaehler incrementieren
  4C31'   11             C      	DB	17
  4C32'   CD 4F92'       C      UK.KBW2:	CALL	U1.RRST
  4C35'   C9             C      	RET
                         C      ;
  4C36'   CD 51D6'       C      UK.KBW1:	CALL	XY.INCDX	;Labelzaehler incrementieren
  4C39'   11             C      	DB	17
  4C3A'   18 F6          C      	JR	UK.KBW2
                         C      ;
                         C      ;********************************************************************
                         C      ;
                         C      ;        Einzelzeichenausgabe fuer KMBG
                         C      ;
                         C      ;*********************************************************************
                         C      ;
  4C3C'   CD 4F8A'       C      UK.PUTK:	CALL	U1.RSAVE
  4C3F'   F5             C      	PUSH	AF	;Zeichen retten
  4C40'   CD 5196'       C      	CALL	XY.LDDX	;HL:= Pufferzaehler
  4C43'   17             C      	DB	23
  4C44'   01 0132        C      	LD	BC,UE.KMPUL	;BC:= max. Pufferlaenge
''	MACRO-80 3.44	09-Dec-81	PAGE	1-10


  4C47'   B7             C      	OR	A
  4C48'   ED 42          C      	SBC	HL,BC
  4C4A'   3F             C      	CCF
  4C4B'   CC 4C85'       C      	CALL	Z,UK.KBA	;---> Puffer voll
  4C4E'   F1             C      	POP	AF	;Zeichen auskellern
  4C4F'   CD 5196'       C      	CALL	XY.LDDX
  4C52'   15             C      	DB	21
  4C53'   77             C      	LD	(HL),A	;Zeichen in Puffer eintragen
  4C54'   CD 51D6'       C      	CALL	XY.INCDX	;Pufferzeiger erhoehen
  4C57'   15             C      	DB	21
  4C58'   CD 51D6'       C      	CALL	XY.INCDX	;Pufferzaehler erhoehen
  4C5B'   17             C      	DB	23
  4C5C'   CD 4F92'       C      	CALL	U1.RRST
  4C5F'   C9             C      	RET
                         C      ;
                         C      ;******************************************************************
                         C      ;
                         C      ;        Ausgabepufferbereitstellung fuer KMBG
                         C      ;
                         C      ;*******************************************************************
                         C      ;
  4C60'   CD 4F8A'       C      UK.KSPFB:	CALL	U1.RSAVE
  4C63'   CD 5090'       C      	CALL	U1.KTIN1
  4C66'   CD 51A6'       C      	CALL	XY.LIDX
  4C69'   09             C      	DB	9
  4C6A'   E5             C      	PUSH	HL
  4C6B'   C1             C      	POP	BC	;BC:= Blocklaenge
  4C6C'   21 0000        C      	LD	HL,0
  4C6F'   CD 51B6'       C      	CALL	XY.STDX	;Pufferzaehler = 0
  4C72'   17             C      	DB	23
  4C73'   CD 5196'       C      	CALL	XY.LDDX
  4C76'   19             C      	DB	25
  4C77'   CD 51B6'       C      	CALL	XY.STDX	;Pufferzeiger setzen
  4C7A'   15             C      	DB	21
  4C7B'   21 0E66        C      	LD	HL,UE.PUF
  4C7E'   CD 4F9B'       C      	CALL	U1.CLRB
  4C81'   CD 4F92'       C      	CALL	U1.RRST
  4C84'   C9             C      	RET
                         C      ;
                         C      ;*******************************************************************
                         C      ;
                         C      ;        Ausgabe eines Blockes auf KMBG
                         C      ;
                         C      ;*******************************************************************
                         C      ;
  4C85'   CD 4F8A'       C      UK.KBA:	CALL	U1.RSAVE
  4C88'   CD 4C60'       C      	CALL	UK.KSPFB
  4C8B'   CD 5196'       C      	CALL	XY.LDDX
  4C8E'   07             C      	DB	7
  4C8F'   EB             C      	EX	DE,HL	;DE:= Blockadresse
  4C90'   D5             C      	PUSH	DE	;Blockadresse retten
  4C91'   CD 51A6'       C      	CALL	XY.LIDX
  4C94'   09             C      	DB	9
  4C95'   E5             C      	PUSH	HL
  4C96'   C1             C      	POP	BC	;BC:= Blocklaenge
  4C97'   D1             C      	POP	DE	;DE:= Blockadresse
  4C98'   C5             C      	PUSH	BC	;Blocklaenge retten
  4C99'   CD 5196'       C      	CALL	XY.LDDX	;HL:= E/A-Pufferanfang
  4C9C'   19             C      	DB	25
  4C9D'   ED B0          C      	LDIR		;Block in Systempuffer
  4C9F'   C1             C      	POP	BC	;BC:= Blocklaenge
  4CA0'   E5             C      	PUSH	HL	;aktuelle Pufferadresse retten
''	MACRO-80 3.44	09-Dec-81	PAGE	1-11


  4CA1'   21 0132        C      	LD	HL,UE.KMPUL	;HL:= max. Laenge
  4CA4'   B7             C      	OR	A
  4CA5'   ED 42          C      	SBC	HL,BC	;HL:= Restbyteanzahl
  4CA7'   CD 51B6'       C      	CALL	XY.STDX	;Pufferzaehler setzen
  4CAA'   17             C      	DB	23
  4CAB'   E5             C      	PUSH	HL
  4CAC'   C1             C      	POP	BC	;BC:= Restbyteanzahl
  4CAD'   CD 5196'       C      	CALL	XY.LDDX	;HL:= aktuelle Pufferadresse
  4CB0'   19             C      	DB	25
  4CB1'   EB             C      	EX	DE,HL	;DE:= Pufferanfang
  4CB2'   E1             C      	POP	HL
  4CB3'   ED B0          C      	LDIR
  4CB5'   EB             C      	EX	DE,HL	;HL:= aktuelle Pufferadresse
  4CB6'   CD 51B6'       C      	CALL	XY.STDX	;Pufferzeiger setzen
  4CB9'   15             C      	DB	21
  4CBA'   DD 36 04 00    C      	LD	(IX+4),00H
  4CBE'   CD 4CD0'       C      	CALL	UF.EXEC	;physische Blockausgabe
  4CC1'   F5             C      	PUSH	AF
  4CC2'   CD 51D6'       C      	CALL	XY.INCDX	;Blockzaehler erhoehen
  4CC5'   11             C      	DB	17
  4CC6'   F1             C      	POP	AF
  4CC7'   CD 4F92'       C      	CALL	U1.RRST
  4CCA'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                         C      	PAGE
''	MACRO-80 3.44	09-Dec-81	PAGE	1-12


                         C      
                         C      ;	PN	UF
                         C      ;***************************************************************
                         C      ;
                         C      ;      Fehleranzeige  UND  BEHANDLUNG
                         C      ;
                         C      ;***************************************************************
  4CCB'   F1             C      UF.RET:	POP	AF
  4CCC'   C1             C      	POP	BC
  4CCD'   D1             C      	POP	DE
  4CCE'   E1             C      	POP	HL
  4CCF'   C9             C      	RET
                         C      ;---------------------Ausfhr. Kass.kommando lt.Steuerblock-------------
  4CD0'   E5             C      UF.EXEC:	PUSH	HL
  4CD1'   D5             C      	PUSH	DE
  4CD2'   C5             C      	PUSH	BC
  4CD3'   F5             C      	PUSH	AF
  4CD4'   DD CB 00 BE    C      	RES	7,(IX)
  4CD8'   DD 36 01 00    C      	LD	(IX+1),0
  4CDC'   C3 694A'       C      	JP	KO.KO05
  4CDF'   3E 41          C      UF.EXEC1:	LD	A,41H
  4CE1'   DD BE 04       C      	CP	(IX+4)
  4CE4'   28 06          C      	JR	Z,$+8
  4CE6'   DD CB 00 66    C      	BIT	4,(IX)
  4CEA'   20 06          C      	JR	NZ,$+8
  4CEC'   DD CB 00 7E    C      	BIT	7,(IX)
  4CF0'   28 D9          C      	JR	Z,UF.RET
                         C      ;-------------------------Fehlerbehandlung---------------
  4CF2'   DD CB 00 BE    C      UF.ERA1:	RES	7,(IX)
  4CF6'   DD 4E 04       C      	LD	C,(IX+4)
  4CF9'   DD 7E 01       C      	LD	A,(IX+1)
  4CFC'   18 04          C      	JR	$+6
  4CFE'   E5             C      UF.ERANZ:	PUSH	HL
  4CFF'   D5             C      	PUSH	DE
  4D00'   C5             C      	PUSH	BC
  4D01'   F5             C      	PUSH	AF
  4D02'   F5             C      	PUSH	AF
  4D03'   3E 13          C      	LD	A,19
  4D05'   32 2B00'       C      	LD	(UB.ZN),A
  4D08'   21 55FE'       C      	LD	HL,UA.ZKF	;IN: <A> Fehlerschluessel
  4D0B'   CD 4A4C'       C      	CALL	UR.MIMO
  4D0E'   F1             C      	POP	AF
  4D0F'   F5             C      	PUSH	AF
  4D10'   EB             C      	EX	DE,HL
  4D11'   CD 523A'       C      	CALL	UC.CVBX+2
  4D14'   F1             C      	POP	AF
  4D15'   FE 17          C      	CP	17H
  4D17'   CA 4E21'       C      	JP	Z,FL17
  4D1A'   FE 18          C      	CP	18H
  4D1C'   CA 4DE6'       C      	JP	Z,FL18
  4D1F'   FE 00          C      	CP	00H
  4D21'   CA 4D89'       C      	JP	Z,BEHB
  4D24'   FE 11          C      	CP	11H
  4D26'   CA 4D89'       C      	JP	Z,BEHB
  4D29'   FE 19          C      	CP	19H
  4D2B'   28 27          C      	JR	Z,AZVB
  4D2D'   FE 22          C      	CP	22H
  4D2F'   CA 4D97'       C      	JP	Z,FL22
  4D32'   FE 21          C      	CP	21H
  4D34'   CA 4DC0'       C      	JP	Z,FL21
  4D37'   FE 14          C      	CP	14H
''	MACRO-80 3.44	09-Dec-81	PAGE	1-13


  4D39'   CA 4F1D'       C      	JP	Z,FL14
  4D3C'   FE 16          C      	CP	16H
  4D3E'   CA 4F65'       C      	JP	Z,FL16
  4D41'   C3 09E3        C      	JP	RET
                         C      ;----------------------------------------------------------------------
  4D44'   DD 7E 01       C      UF.SYS:	LD	A,(IX+1)
  4D47'   11 35A8        C      	LD	DE,UE.BWSA+5A8H
  4D4A'   CD 523A'       C      	CALL	UC.CVBX+2
  4D4D'   00             C      	NOP
  4D4E'   00             C      	NOP
  4D4F'   00             C      	NOP
  4D50'   31 0CFE        C      SYS1:	LD	SP,UE.STANF
  4D53'   C9             C      	RET
                         C      ;----------------------------------------------------------
  4D54'   DD CB 00 96    C      AZVB:	RES	2,(IX)	;Aufzeichnen verboten
  4D58'   DD 36 04 41    C      	LD	(IX+4),41H
  4D5C'   CD 5A93'       C      	CALL	KR.KARO
  4D5F'   DD CB 00 7E    C      	BIT	7,(IX)
  4D63'   20 DF          C      	JR	NZ,UF.SYS
  4D65'   21 556E'       C      	LD	HL,UA.FRZ
  4D68'   CD 4A4C'       C      	CALL	UR.MIMO
  4D6B'   38 E3          C      	JR	C,SYS1
  4D6D'   DD 36 04 31    C      	LD	(IX+4),31H
  4D71'   CD 5A93'       C      	CALL	KR.KARO
  4D74'   DD CB 00 66    C      	BIT	4,(IX)
  4D78'   20 CA          C      	JR	NZ,UF.SYS
  4D7A'   DD CB 00 7E    C      	BIT	7,(IX)
  4D7E'   20 C4          C      	JR	NZ,UF.SYS
  4D80'   DD CB 00 56    C      	BIT	2,(IX)
  4D84'   20 BE          C      	JR	NZ,UF.SYS
  4D86'   C3 6944'       C      	JP	KO.KO04
  4D89'   21 556E'       C      BEHB:	LD	HL,UA.FRZ
  4D8C'   CD 4A4C'       C      	CALL	UR.MIMO
  4D8F'   38 BF          C      	JR	C,SYS1
  4D91'   DD 71 04       C      	LD	(IX+4),C
  4D94'   C3 4CD4'       C      	JP	UF.EXEC+4
                         C      ;---------------------------------------
  4D97'   B7             C      FL22:	OR	A
  4D98'   06 02          C      	LD	B,2
  4D9A'   DD CB 00 BE    C      	RES	7,(IX)
  4D9E'   DD 36 04 15    C      	LD	(IX+4),15H
  4DA2'   CD 5A93'       C      	CALL	KR.KARO
  4DA5'   DD CB 00 7E    C      	BIT	7,(IX)
  4DA9'   20 99          C      	JR	NZ,UF.SYS
  4DAB'   DD 71 04       C      	LD	(IX+4),C
  4DAE'   CD 5A93'       C      	CALL	KR.KARO
  4DB1'   DD CB 00 7E    C      	BIT	7,(IX)
  4DB5'   20 03          C      	JR	NZ,$+5
  4DB7'   C3 09E3        C      	JP	RET
  4DBA'   10 DE          C      	DJNZ	$-32
  4DBC'   38 05          C      	JR	C,$+7
  4DBE'   18 84          C      	JR	UF.SYS
                         C      ;----------------------------------------
  4DC0'   37             C      FL21:	SCF
  4DC1'   18 D5          C      	JR	$-41
  4DC3'   21 556E'       C      	LD	HL,UA.FRZ
  4DC6'   CD 4A4C'       C      	CALL	UR.MIMO
  4DC9'   DA 4D50'       C      	JP	C,SYS1
  4DCC'   7E             C      	LD	A,(HL)
  4DCD'   FE 49          C      	CP	'I'
  4DCF'   28 12          C      	JR	Z,$+20
  4DD1'   FE 55          C      	CP	'U'
''	MACRO-80 3.44	09-Dec-81	PAGE	1-14


  4DD3'   20 EE          C      	JR	NZ,$-16
  4DD5'   DD 36 04 02    C      	LD	(IX+4),02H	;NAECHSTEN BLOCK LESEN
  4DD9'   CD 5A93'       C      	CALL	KR.KARO
  4DDC'   DD CB 00 7E    C      	BIT	7,(IX)
  4DE0'   C2 4D44'       C      	JP	NZ,UF.SYS
  4DE3'   C3 09E3        C      	JP	RET
                         C      ;----------------------------------------
  4DE6'   06 03          C      FL18:	LD	B,3
  4DE8'   DD 36 04 15    C      	LD	(IX+4),15H
  4DEC'   CD 5A93'       C      	CALL	KR.KARO
  4DEF'   DD CB 00 7E    C      	BIT	7,(IX)
  4DF3'   C2 4D44'       C      	JP	NZ,UF.SYS
  4DF6'   10 F0          C      	DJNZ	$-14
  4DF8'   06 08          C      	LD	B,8
  4DFA'   DD 36 04 02    C      	LD	(IX+4),02H
  4DFE'   CD 5A93'       C      	CALL	KR.KARO
  4E01'   DD CB 00 7E    C      	BIT	7,(IX)
  4E05'   C2 4D44'       C      	JP	NZ,UF.SYS
  4E08'   DD 7E 09       C      	LD	A,(IX+9)	;8 BLOECKE LESEN
  4E0B'   DD B6 0A       C      	OR	(IX+10)
  4E0E'   28 05          C      	JR	Z,$+7
  4E10'   10 E8          C      	DJNZ	$-22
  4E12'   C3 4D44'       C      	JP	UF.SYS
  4E15'   21 5574'       C      	LD	HL,UA.BMGF
  4E18'   CD 4A4C'       C      	CALL	UR.MIMO
  4E1B'   DA 4D50'       C      	JP	C,SYS1
  4E1E'   C3 09E3        C      	JP	RET
                         C      ;------------------------------------------
  4E21'   06 05          C      FL17:	LD	B,5
  4E23'   DD CB 00 BE    C      	RES	7,(IX)
  4E27'   DD 36 04 15    C      	LD	(IX+4),15H
  4E2B'   26 02          C      	LD	H,2
  4E2D'   CD 5A93'       C      	CALL	KR.KARO
  4E30'   DD CB 00 7E    C      	BIT	7,(IX)
  4E34'   C2 4D44'       C      	JP	NZ,UF.SYS	;2 BLOECKE ZURUECK
  4E37'   25             C      	DEC	H
  4E38'   20 F3          C      	JR	NZ,$-11
  4E3A'   DD 71 04       C      	LD	(IX+4),C	;WDHLG
  4E3D'   CD 5A93'       C      	CALL	KR.KARO
  4E40'   DD CB 00 7E    C      	BIT	7,(IX)
  4E44'   20 03          C      	JR	NZ,$+5
  4E46'   C3 09E3        C      	JP	RET
  4E49'   10 D8          C      	DJNZ	$-38
                         C      ;----------------------------------------------------------------------
  4E4B'   DD CB 00 BE    C      	RES	7,(IX)	;ERMITTELN DER BLOCKLAENGE
  4E4F'   DD 36 04 15    C      	LD	(IX+4),15H
  4E53'   CD 5A93'       C      	CALL	KR.KARO
  4E56'   DD CB 00 7E    C      	BIT	7,(IX)
  4E5A'   C2 4D44'       C      	JP	NZ,UF.SYS
  4E5D'   DD 36 04 02    C      	LD	(IX+4),02H
  4E61'   CD 5A93'       C      	CALL	KR.KARO	;NAECHSTEN BLOCK LESEN
  4E64'   DD CB 00 7E    C      	BIT	7,(IX)
  4E68'   C2 4D44'       C      	JP	NZ,UF.SYS
  4E6B'   DD 7E 09       C      	LD	A,(IX+9)
  4E6E'   DD B6 0A       C      	OR	(IX+10)	;BM ?
  4E71'   F5             C      	PUSH	AF
  4E72'   06 02          C      	LD	B,2
  4E74'   DD 36 04 15    C      	LD	(IX+4),15H
  4E78'   CD 5A93'       C      	CALL	KR.KARO	;POS.VOR FEHLERHAFTEN BLOCK
  4E7B'   DD CB 00 7E    C      	BIT	7,(IX)
  4E7F'   C2 4D44'       C      	JP	NZ,UF.SYS
  4E82'   10 F4          C      	DJNZ	$-10
''	MACRO-80 3.44	09-Dec-81	PAGE	1-15


  4E84'   F1             C      	POP	AF
  4E85'   20 21          C      	JR	NZ,$+35
  4E87'   CD 5A93'       C      	CALL	KR.KARO
  4E8A'   DD CB 00 7E    C      	BIT	7,(IX)
  4E8E'   C2 4D44'       C      	JP	NZ,UF.SYS
  4E91'   DD 36 04 02    C      	LD	(IX+4),02H
  4E95'   CD 5A93'       C      	CALL	KR.KARO	;BLOCK VOR FEHLERHAFTEN B.LESEN
  4E98'   DD CB 00 7E    C      	BIT	7,(IX)
  4E9C'   C2 4D44'       C      	JP	NZ,UF.SYS
  4E9F'   DD 7E 09       C      	LD	A,(IX+9)
  4EA2'   DD B6 0A       C      	OR	(IX+10)
  4EA5'   CA 4D44'       C      	JP	Z,UF.SYS	;WENN AUCH BM -->SYS
  4EA8'   CD 51A6'       C      	CALL	XY.LIDX	;BLOCKLAENGE -->HL
  4EAB'   09             C      	DB	9
  4EAC'   DD 36 04 02    C      	LD	(IX+4),02H
  4EB0'   CD 5A93'       C      	CALL	KR.KARO	;FEHLERHAFTEN BLOCK LESEN
  4EB3'   45             C      	LD	B,L
  4EB4'   21 0E66        C      	LD	HL,UE.PUF
  4EB7'   CD 4740        C      	CALL	UE.CRC
  4EBA'   23             C      	INC	HL
  4EBB'   46             C      	LD	B,(HL)
  4EBC'   23             C      	INC	HL
  4EBD'   4E             C      	LD	C,(HL)	;BC=CRC VON KASSETTE
  4EBE'   EB             C      	EX	DE,HL
  4EBF'   B7             C      	OR	A
  4EC0'   ED 42          C      	SBC	HL,BC
  4EC2'   28 05          C      	JR	Z,$+7
  4EC4'   21 5585'       C      	LD	HL,UA.DF
  4EC7'   18 03          C      	JR	$+5
  4EC9'   21 557E'       C      	LD	HL,UA.DOK
  4ECC'   CD 4A4C'       C      	CALL	UR.MIMO
  4ECF'   21 556E'       C      	LD	HL,UA.FRZ
  4ED2'   CD 4A4C'       C      	CALL	UR.MIMO
  4ED5'   DA 4D50'       C      	JP	C,SYS1
  4ED8'   7E             C      	LD	A,(HL)
  4ED9'   FE 49          C      	CP	'I'
  4EDB'   28 27          C      	JR	Z,$+41
  4EDD'   FE 55          C      	CP	'U'
  4EDF'   20 EE          C      	JR	NZ,$-16
  4EE1'   DD CB 00 BE    C      	RES	7,(IX)
  4EE5'   DD 36 04 15    C      	LD	(IX+4),15H
  4EE9'   CD 5A93'       C      	CALL	KR.KARO
  4EEC'   DD CB 00 7E    C      	BIT	7,(IX)
  4EF0'   C2 4D44'       C      	JP	NZ,UF.SYS
  4EF3'   DD 36 04 02    C      	LD	(IX+4),02H
  4EF7'   CD 5A93'       C      	CALL	KR.KARO	;NAECHSTEN BLOCK EINLESEN
  4EFA'   DD CB 00 7E    C      	BIT	7,(IX)
  4EFE'   C2 4D44'       C      	JP	NZ,UF.SYS
  4F01'   C3 09E3        C      	JP	RET
  4F04'   DD CB 00 BE    C      	RES	7,(IX)
  4F08'   DD 36 04 15    C      	LD	(IX+4),15H
  4F0C'   CD 5A93'       C      	CALL	KR.KARO
  4F0F'   DD CB 00 7E    C      	BIT	7,(IX)
  4F13'   C2 4D44'       C      	JP	NZ,UF.SYS
  4F16'   DD 36 04 02    C      	LD	(IX+4),02H
  4F1A'   C3 09E3        C      	JP	RET
                         C      ;-------------------------------------
  4F1D'   21 556E'       C      FL14:	LD	HL,UA.FRZ
  4F20'   CD 4A4C'       C      	CALL	UR.MIMO
  4F23'   DA 4D50'       C      	JP	C,SYS1
  4F26'   7E             C      	LD	A,(HL)
  4F27'   FE 42          C      	CP	'B'
''	MACRO-80 3.44	09-Dec-81	PAGE	1-16


  4F29'   28 0A          C      	JR	Z,$+12
  4F2B'   FE 53          C      	CP	'S'
  4F2D'   20 EE          C      	JR	NZ,$-16
  4F2F'   DD 36 04 61    C      	LD	(IX+4),61H	;SL SCHREIBEN
  4F33'   18 12          C      	JR	$+20
  4F35'   DD 36 04 15    C      	LD	(IX+4),15H
  4F39'   CD 5A93'       C      	CALL	KR.KARO
  4F3C'   DD CB 00 7E    C      	BIT	7,(IX)
  4F40'   C2 4D44'       C      	JP	NZ,UF.SYS
  4F43'   DD 36 04 51    C      	LD	(IX+4),51H	;BM HINTER LETZTEN BLOCK
  4F47'   23             C      	INC	HL
  4F48'   7E             C      	LD	A,(HL)
  4F49'   CD 515A'       C      	CALL	U1.TST
  4F4C'   38 CF          C      	JR	C,FL14
  4F4E'   DD 77 03       C      	LD	(IX+3),A
  4F51'   CD 5A93'       C      	CALL	KR.KARO
  4F54'   DD CB 00 7E    C      	BIT	7,(IX)
  4F58'   CA 4D50'       C      	JP	Z,SYS1
  4F5B'   C3 4D44'       C      	JP	UF.SYS
  4F5E'   00             C      	NOP
  4F5F'   00             C      	NOP
  4F60'   00             C      	NOP
  4F61'   00             C      	NOP
  4F62'   00             C      	NOP
  4F63'   00             C      	NOP
  4F64'   00             C      	NOP
  4F65'   21 556E'       C      FL16:	LD	HL,UA.FRZ
  4F68'   CD 4A4C'       C      	CALL	UR.MIMO
  4F6B'   DA 4D50'       C      	JP	C,SYS1
  4F6E'   DD 7E 04       C      	LD	A,(IX+4)
  4F71'   EE 04          C      	XOR	04H	;71 <-----> 75
  4F73'   DD 77 04       C      	LD	(IX+4),A
  4F76'   CD 5A93'       C      	CALL	KR.KARO
  4F79'   DD CB 00 7E    C      	BIT	7,(IX)
  4F7D'   CA 4D50'       C      	JP	Z,SYS1
  4F80'   C3 4D44'       C      	JP	UF.SYS
  4F83'   00             C      	NOP
  4F84'   00             C      	NOP
  4F85'   00             C      	NOP
  4F86'   00             C      	NOP
  4F87'   00             C      	NOP
  4F88'   00             C      	NOP
  4F89'   00             C      	NOP
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                         C      	PAGE
''	MACRO-80 3.44	09-Dec-81	PAGE	1-17


                         C      
                         C      ;	PN	U1
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;        Allgemeine Unterprogramme
                         C      ;
                         C      ;----------------------------------------------------------------------
  4F8A'   E3             C      U1.RSAVE:	EX	(SP),HL	;Register retten (nicht AF)
  4F8B'   D5             C      	PUSH	DE
  4F8C'   C5             C      	PUSH	BC
  4F8D'   FD E5          C      	PUSH	IY
  4F8F'   DD E5          C      	PUSH	IX
  4F91'   E9             C      	JP	(HL)
  4F92'   E1             C      U1.RRST:	POP	HL	;Register wieder herstellen
  4F93'   DD E1          C      	POP	IX
  4F95'   FD E1          C      	POP	IY
  4F97'   C1             C      	POP	BC
  4F98'   D1             C      	POP	DE
  4F99'   E3             C      	EX	(SP),HL
  4F9A'   C9             C      	RET
  4F9B'   E5             C      U1.CLRB:	PUSH	HL	;Bereich loeschen
  4F9C'   D5             C      	PUSH	DE
  4F9D'   C5             C      	PUSH	BC
  4F9E'   E5             C      	PUSH	HL	;IN:  HL= Bereichsanfang
  4F9F'   D1             C      	POP	DE	;     BC= Bereichslaenge
  4FA0'   13             C      	INC	DE
  4FA1'   AF             C      	XOR	A
  4FA2'   77             C      	LD	(HL),A
  4FA3'   0B             C      	DEC	BC
  4FA4'   ED B0          C      	LDIR
  4FA6'   C1             C      	POP	BC
  4FA7'   D1             C      	POP	DE
  4FA8'   E1             C      	POP	HL
  4FA9'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  4FAA'   C5             C      U1.KBR4:	PUSH	BC
  4FAB'   06 04          C      	LD	B,4
  4FAD'   CD 49D9'       C      	CALL	UR.KBR
  4FB0'   10 FB          C      	DJNZ	$-3
  4FB2'   C1             C      	POP	BC
  4FB3'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  4FB4'   F5             C      U1.WAIT:	PUSH	AF
  4FB5'   CD 46AD        C      	CALL	UE.BERT
  4FB8'   38 FB          C      	JR	C,$-3
  4FBA'   F1             C      	POP	AF
  4FBB'   C9             C      	RET
                         C      ;--------------------------------------------------------------------
  4FBC'   CD 4FFF'       C      U1.BREAD:	CALL	U1.EIN	;BLOCK LESEN VON EINGABE
  4FBF'   DD 36 04 02    C      	LD	(IX+4),02H
  4FC3'   CD 4CD0'       C      	CALL	UF.EXEC
  4FC6'   C9             C      	RET
  4FC7'   CD 5008'       C      U1.BWRIT:	CALL	U1.AUS	;BLOCK SCHREIBEN AUF AUSGABE
  4FCA'   DD 36 04 00    C      	LD	(IX+4),00H
  4FCE'   CD 4CD0'       C      	CALL	UF.EXEC
  4FD1'   C9             C      	RET
  4FD2'   F5             C      U1.COPB2:	PUSH	AF
  4FD3'   37             C      	SCF
  4FD4'   18 02          C      	JR	$+4
  4FD6'   F5             C      U1.COPB:	PUSH	AF
  4FD7'   B7             C      	OR	A
''	MACRO-80 3.44	09-Dec-81	PAGE	1-18


  4FD8'   CD 4FFF'       C      	CALL	U1.EIN
  4FDB'   DD 36 04 02    C      	LD	(IX+4),02H
  4FDF'   DC 65CA'       C      	CALL	C,KX.EXEC2
  4FE2'   D4 4CD0'       C      	CALL	NC,UF.EXEC
  4FE5'   F5             C      	PUSH	AF
  4FE6'   CD 5008'       C      	CALL	U1.AUS
  4FE9'   DD 7E 09       C      	LD	A,(IX+9)
  4FEC'   DD B6 0A       C      	OR	(IX+10)
  4FEF'   28 08          C      	JR	Z,$+10
  4FF1'   CD 4FC7'       C      	CALL	U1.BWRIT
  4FF4'   F1             C      	POP	AF
  4FF5'   38 DC          C      	JR	C,$-34
  4FF7'   30 DE          C      	JR	NC,$-32
  4FF9'   CD 49C7'       C      	CALL	UR.KBM
  4FFC'   F1             C      	POP	AF
  4FFD'   F1             C      	POP	AF
  4FFE'   C9             C      	RET
  4FFF'   F5             C      U1.EIN:	PUSH	AF
  5000'   3A E000        C      	LD	A,(BC.TAB1)
  5003'   DD 77 03       C      	LD	(IX+3),A
  5006'   F1             C      	POP	AF
  5007'   C9             C      	RET
  5008'   F5             C      U1.AUS:	PUSH	AF
  5009'   3A E001        C      	LD	A,(BC.TAB1+1)
  500C'   DD 77 03       C      	LD	(IX+3),A
  500F'   F1             C      	POP	AF
  5010'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  5011'   E5             C      U1.VS1:	PUSH	HL
  5012'   C5             C      	PUSH	BC
  5013'   F5             C      	PUSH	AF
  5014'   3E 01          C      	LD	A,01H	;1.DATEIVORSATZ IM PUFFER
  5016'   18 04          C      	JR	$+6
  5018'   E5             C      U1.VSX:	PUSH	HL
  5019'   C5             C      	PUSH	BC
  501A'   F5             C      	PUSH	AF
  501B'   AF             C      	XOR	A	;00-DATEIVORSATZ IM PUFFER
  501C'   06 20          C      	LD	B,32
  501E'   21 0E66        C      	LD	HL,UE.PUF
  5021'   CD 513B'       C      	CALL	U1.TR
  5024'   F1             C      	POP	AF
  5025'   C1             C      	POP	BC
  5026'   E1             C      	POP	HL
  5027'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  5028'   E5             C      U1.DSVG:	PUSH	HL
  5029'   D5             C      	PUSH	DE
  502A'   F5             C      	PUSH	AF
  502B'   06 07          C      	LD	B,7	;MRES KASSETTE ?
  502D'   CD 50D7'       C      	CALL	U1.VORS1
  5030'   11 0E6C        C      	LD	DE,UE.PUF+6
  5033'   21 544B'       C      	LD	HL,UA.DS+6
  5036'   06 0E          C      	LD	B,14
  5038'   1A             C      	LD	A,(DE)
  5039'   BE             C      	CP	(HL)
  503A'   20 10          C      	JR	NZ,$+18
  503C'   13             C      	INC	DE
  503D'   23             C      	INC	HL
  503E'   10 F8          C      	DJNZ	$-6
  5040'   3A 0E67        C      	LD	A,(UE.PUF+1)
  5043'   4F             C      	LD	C,A	;C <-- NEXT RECORD
  5044'   3A 0E69        C      	LD	A,(UE.PUF+3)
''	MACRO-80 3.44	09-Dec-81	PAGE	1-19


  5047'   47             C      	LD	B,A	;B <-- ANZ.VERZ.EINTRAG.
  5048'   F1             C      	POP	AF
  5049'   D1             C      	POP	DE
  504A'   E1             C      	POP	HL
  504B'   C9             C      	RET
  504C'   F1             C      	POP	AF
  504D'   D1             C      	POP	DE
  504E'   E1             C      	POP	HL
  504F'   FD E1          C      	POP	IY
  5051'   3E 90          C      	LD	A,90H
  5053'   CD 4CFE'       C      	CALL	UF.ERANZ
  5056'   C3 000B        C      	JP	UE.SYSTB
                         C      ;----------------------------------------------------------------------
  5059'   C5             C      U1.NMVGL:	PUSH	BC
  505A'   D5             C      	PUSH	DE
  505B'   E5             C      	PUSH	HL
  505C'   06 06          C      	LD	B,6
  505E'   11 0E66        C      	LD	DE,UE.PUF
  5061'   1A             C      	LD	A,(DE)
  5062'   BE             C      	CP	(HL)	;HL:ZU SUCHENDER PROGR.NAME
  5063'   20 0C          C      	JR	NZ,$+14
  5065'   23             C      	INC	HL
  5066'   13             C      	INC	DE
  5067'   10 F8          C      	DJNZ	$-6
  5069'   3A 0E7D        C      	LD	A,(UE.PUF+23)	;LABELNR. -->A
  506C'   37             C      	SCF		;CY=1,WENN PROGR. GEFUNDEN
  506D'   E1             C      	POP	HL
  506E'   D1             C      	POP	DE
  506F'   C1             C      	POP	BC
  5070'   C9             C      	RET
  5071'   B7             C      	OR	A
  5072'   18 F9          C      	JR	$-5
                         C      ;----------------------------------------------------------------------
  5074'   E5             C      U1.KTINI:	PUSH	HL
  5075'   C5             C      	PUSH	BC
  5076'   F5             C      	PUSH	AF
  5077'   CD 6478'       C      	CALL	BILO	;UNTERE HAELFTE BS LOESCHEN
  507A'   DD 21 2B01'    C      	LD	IX,UB.KTAB	;ADR. STEUERTAB. F.KASS.ROUTINE
  507E'   DD E5          C      	PUSH	IX
  5080'   E1             C      	POP	HL
  5081'   AF             C      	XOR	A
  5082'   06 1B          C      	LD	B,27
  5084'   CD 513B'       C      	CALL	U1.TR	;TAB. AUF 00 LOESCHEN
  5087'   DD 36 02 30    C      	LD	(IX+2),30H
  508B'   CD 4965        C      	CALL	UE.KINI
  508E'   18 03          C      	JR	$+5
  5090'   E5             C      U1.KTIN1:	PUSH	HL
  5091'   C5             C      	PUSH	BC
  5092'   F5             C      	PUSH	AF
  5093'   DD 36 0B 07    C      	LD	(IX+11),7	;ANZAHL LESE/SCHREIBWDHLGNN
  5097'   DD 36 0C 04    C      	LD	(IX+12),4	;ANZAHL
  509B'   21 0E66        C      	LD	HL,UE.PUF
  509E'   CD 51B6'       C      	CALL	XY.STDX
  50A1'   07             C      	DB	7	;SYSTEMPUFFERADR.-->TAB
  50A2'   21 8010        C      	LD	HL,UE.KPUFF
  50A5'   CD 51B6'       C      	CALL	XY.STDX
  50A8'   19             C      	DB	25	;E/A PUFFERADR.-->TAB
  50A9'   F1             C      	POP	AF
  50AA'   C1             C      	POP	BC
  50AB'   E1             C      	POP	HL
  50AC'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
''	MACRO-80 3.44	09-Dec-81	PAGE	1-20


  50AD'   E5             C      U1.VERIN:	PUSH	HL
  50AE'   C5             C      	PUSH	BC
  50AF'   F5             C      	PUSH	AF
  50B0'   11 EC82        C      	LD	DE,BC.VTABE	;VERZ. EINGABEGER. EINLESEN
  50B3'   18 03          C      	JR	$+5
  50B5'   E5             C      U1.VERNI:	PUSH	HL
  50B6'   C5             C      	PUSH	BC
  50B7'   F5             C      	PUSH	AF
  50B8'   3A 0E69        C      	LD	A,(UE.PUF+3)	;ANZ. DATEIEN-->B
  50BB'   47             C      	LD	B,A
  50BC'   C5             C      	PUSH	BC
  50BD'   21 0E66        C      	LD	HL,UE.PUF
  50C0'   01 0020        C      	LD	BC,32
  50C3'   ED B0          C      	LDIR
  50C5'   CD 4CD0'       C      	CALL	UF.EXEC
  50C8'   C1             C      	POP	BC
  50C9'   10 F1          C      	DJNZ	$-13
  50CB'   F1             C      	POP	AF
  50CC'   C1             C      	POP	BC
  50CD'   E1             C      	POP	HL
  50CE'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  50CF'   C5             C      U1.VORST:	PUSH	BC
  50D0'   CD 49AE'       C      	CALL	UR.KRWW
  50D3'   06 06          C      	LD	B,6
  50D5'   18 01          C      	JR	$+3
  50D7'   C5             C      U1.VORS1:	PUSH	BC
  50D8'   DD 36 04 02    C      	LD	(IX+4),02H
  50DC'   CD 4CD0'       C      	CALL	UF.EXEC
  50DF'   10 FB          C      	DJNZ	$-3
  50E1'   C1             C      	POP	BC
  50E2'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  50E3'   D5             C      U1.VZS:	PUSH	DE
  50E4'   C5             C      	PUSH	BC
  50E5'   E5             C      	PUSH	HL
  50E6'   F5             C      	PUSH	AF
  50E7'   CD 49D3'       C      	CALL	UR.KBV
  50EA'   CD 49D9'       C      	CALL	UR.KBR
  50ED'   11 0E66        C      	LD	DE,UE.PUF
  50F0'   01 0006        C      	LD	BC,6
  50F3'   ED B0          C      	LDIR		;PROGR.NAME --> PUFFER
  50F5'   3A 2B1E'       C      	LD	A,(UB.PAR2)	;DATEITYP
  50F8'   12             C      	LD	(DE),A
  50F9'   13             C      	INC	DE
  50FA'   3E 44          C      	LD	A,'D'
  50FC'   12             C      	LD	(DE),A
  50FD'   13             C      	INC	DE
  50FE'   3A 2B20'       C      	LD	A,(UB.PAR3)
  5101'   FE 7F          C      	CP	7FH
  5103'   20 0F          C      	JR	NZ,$+17
  5105'   21 548B'       C      	LD	HL,UA.KOMMT	;FRAGE KOMMENTAR WENN PAR3=7F
  5108'   CD 4A4C'       C      	CALL	UR.MIMO
  510B'   01 0006        C      	LD	BC,6
  510E'   ED B0          C      	LDIR
  5110'   06 09          C      	LD	B,9
  5112'   18 02          C      	JR	$+4
  5114'   06 0F          C      	LD	B,15
  5116'   3E 20          C      	LD	A,' '
  5118'   12             C      	LD	(DE),A
  5119'   13             C      	INC	DE
  511A'   10 FC          C      	DJNZ	$-2
''	MACRO-80 3.44	09-Dec-81	PAGE	1-21


  511C'   3A 2B1C'       C      	LD	A,(UB.PAR1)
  511F'   12             C      	LD	(DE),A
  5120'   13             C      	INC	DE
  5121'   06 08          C      	LD	B,8
  5123'   AF             C      	XOR	A
  5124'   12             C      	LD	(DE),A
  5125'   13             C      	INC	DE
  5126'   10 FC          C      	DJNZ	$-2
  5128'   21 0020        C      	LD	HL,32
  512B'   CD 51C6'       C      	CALL	XY.STIDX
  512E'   09             C      	DB	9
  512F'   DD 36 04 00    C      	LD	(IX+4),00H
  5133'   CD 4CD0'       C      	CALL	UF.EXEC
  5136'   F1             C      	POP	AF
  5137'   E1             C      	POP	HL
  5138'   C1             C      	POP	BC
  5139'   D1             C      	POP	DE
  513A'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  513B'   77             C      U1.TR:	LD	(HL),A	;A=INHALT
  513C'   23             C      	INC	HL
  513D'   10 FC          C      	DJNZ	U1.TR	;B=ANZAHL
  513F'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  5140'   01 000E        C      U1.INFO:	LD	BC,14
  5143'   ED B0          C      	LDIR
  5145'   C9             C      	RET
  5146'   CD 4F8A'       C      U1.BILO:	CALL	U1.RSAVE
  5149'   21 3370        C      	LD	HL,3370H
  514C'   01 0460        C      	LD	BC,1120
  514F'   36 20          C      	LD	(HL),20H
  5151'   54             C      	LD	D,H
  5152'   5D             C      	LD	E,L
  5153'   13             C      	INC	DE
  5154'   ED B0          C      	LDIR
  5156'   CD 4F92'       C      	CALL	U1.RRST
  5159'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  515A'   B7             C      U1.TST:	OR	A
  515B'   D6 30          C      	SUB	30H
  515D'   47             C      	LD	B,A
  515E'   05             C      	DEC	B
  515F'   C8             C      	RET	Z
  5160'   05             C      	DEC	B
  5161'   C8             C      	RET	Z
  5162'   37             C      	SCF
  5163'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  5164'   E5             C      U1.PRADR:	PUSH	HL
  5165'   C5             C      	PUSH	BC
  5166'   06 04          C      	LD	B,4
  5168'   7E             C      	LD	A,(HL)
  5169'   FE 20          C      	CP	' '
  516B'   28 07          C      	JR	Z,$+9
  516D'   23             C      	INC	HL
  516E'   10 F8          C      	DJNZ	$-6
  5170'   B7             C      	OR	A
  5171'   C1             C      	POP	BC
  5172'   E1             C      	POP	HL
  5173'   C9             C      	RET
  5174'   37             C      	SCF
  5175'   21 2B00'       C      	LD	HL,UB.ZN
''	MACRO-80 3.44	09-Dec-81	PAGE	1-22


  5178'   35             C      	DEC	(HL)
  5179'   18 F6          C      	JR	$-8
                         C      ;---------------------------------------------------------------------
  517B'   CD 49A0'       C      U1.KRWE:	CALL	UR.KRE
  517E'   CD 49AE'       C      	CALL	UR.KRWW
  5181'   C9             C      	RET
                         C      ;---------------------------------------------------------------------
                         C      ;	END
                         C      	PAGE
''	MACRO-80 3.44	09-Dec-81	PAGE	1-23


                         C      
                         C      ;	PN	XY ; Unterprogramme
                         C      ;**********************************************************************
                         C      ;*                                                                    *
                         C      ;*       Handling f. IX/IY-adressierte Steuer-Bloecke bzw.            *
                         C      ;*                                     Arbeits-Bereiche               *
                         C      ;*                                                                    *
                         C      ;*--------------------------------------------------------------------*
                         C      ;*                                                                    *
                         C      ;*       Ausser den angegebenen Registern bzw. Flags wird nur noch    *
                         C      ;*       die angegebene Anzahl der ersten freien Stack-Plaetze (je    *
                         C      ;*       Byte) veraendert. Weiterer RAM-Platz wird nicht benoetigt.   *
                         C      ;*                                                                    *
                         C      ;**********************************************************************
                         C      ;*                                                                    *
                         C      ;*       Technische (Hilfs-) Unter-Programme                          *
                         C      ;*                                                                    *
                         C      ;**********************************************************************
                         C      			;
                         C      ;        Uebernahme von nach dem CALL stehenden Parameter
                         C      ;        ++++++++++++++++++++++++++++++++++++++++++++++++
                         C      ;        erwarten Stack:           Return-Adresse f.uebergeordnetes UP
                         C      ;                       (SP) -->   Return-Adresse f.CALPn
                         C      ;        geben Stack zurueck:      Return-Adresse f.uebergeordn.UP + n
                         C      ;                                  (DE)
                         C      ;                       (SP) -->   (HL)
                         C      ;        geben in Reg.zurueck:     (DE):  Wert    1.Parameter-Byte
                         C      ;                                  (HL):  Adresse 2.Parameter-Byte
                         C      ;        --------------------------------------------------------------
                         C      			;
  5182'                  C      CALP1	EQU	$	; 1 Byte-Parameter
                         C      			; ++++++++++++++++++++++++++++++
  5182'   E5             C      	PUSH	HL	; Retten HL
  5183'   E1             C      	POP	HL
                         C      			;
  5184'   EB             C      	EX	DE,HL	; DE <--> RET-Adr.f.CALPn
  5185'   E3             C      	EX	(SP),HL
  5186'   EB             C      	EX	DE,HL
                         C      			;
  5187'   E1             C      	POP	HL	; (SP) --> RET-Adr.f.ueberg.UP
                         C      			;
  5188'   E1             C      	POP	HL	; Laden u. korrig. ...
  5189'   23             C      	INC	HL
  518A'   E5             C      	PUSH	HL
  518B'   2B             C      CALPE:	DEC	HL
                         C      			;
  518C'   3B             C      	DEC	SP	; (SP) --> (DE)
  518D'   3B             C      	DEC	SP
  518E'   3B             C      	DEC	SP	; (SP) --> (HL)
  518F'   3B             C      	DEC	SP
                         C      			;
  5190'   D5             C      	PUSH	DE	; RET-Adr.f.CALPn
                         C      			;
  5191'   5E             C      	LD	E,(HL)	; Laden DE, HL
  5192'   16 00          C      	LD	D,0
  5194'   23             C      	INC	HL
                         C      			;
  5195'   C9             C      	RET
                         C      			;
                         C      			;
                         C      ;**********************************************************************
''	MACRO-80 3.44	09-Dec-81	PAGE	1-24


                         C      ;*                                                                    *
                         C      ;*       Lade-, Speicher- und Transport-Unterprogramme                *
                         C      ;*                                                                    *
                         C      ;**********************************************************************
                         C      ;
                         C      ;    CALL  LDDX    'Load':              HL := (IX+d)
                         C      ;    DB    d                                              Stack: 4
                         C      ;    -----------   ----------------------------------------------------
                         C      			;
  5196'   CD 5182'       C      XY.LDDX:	CALL	CALP1	; Uebernahme d
                         C      			;
  5199'   DD E5          C      	PUSH	IX	; HL := IX+d
  519B'   E1             C      	POP	HL	;               <--- LDDY
  519C'   F5             C      	PUSH	AF
  519D'   19             C      	ADD	HL,DE
  519E'   F1             C      	POP	AF
                         C      			;
  519F'   5E             C      	LD	E,(HL)	; HL := (IX+d)
  51A0'   23             C      	INC	HL
  51A1'   56             C      	LD	D,(HL)
  51A2'   EB             C      	EX	DE,HL
                         C      			;
  51A3'   D1             C      	POP	DE	; Return
  51A4'   D1             C      	POP	DE
  51A5'   C9             C      	RET
                         C      			;
                         C      ;**********************************************************************
                         C      ;
                         C      ;    CALL  LIDX    'Load inverse':      LH := (IX+d)
                         C      ;    DB    d                                              Stack: 4
                         C      ;    -----------   ----------------------------------------------------
                         C      			;
  51A6'   CD 5182'       C      XY.LIDX:	CALL	CALP1	; Uebernahme d
                         C      			;
  51A9'   DD E5          C      	PUSH	IX	; HL := IX+d
  51AB'   E1             C      	POP	HL	;               <--- LIDY
  51AC'   F5             C      	PUSH	AF
  51AD'   19             C      	ADD	HL,DE
  51AE'   F1             C      	POP	AF
                         C      			;
  51AF'   56             C      	LD	D,(HL)	; LH := (IX+d)
  51B0'   23             C      	INC	HL
  51B1'   5E             C      	LD	E,(HL)
  51B2'   EB             C      	EX	DE,HL
                         C      			;
  51B3'   D1             C      	POP	DE	; Return
  51B4'   D1             C      	POP	DE
  51B5'   C9             C      	RET
                         C      			;
                         C      ;**********************************************************************
                         C      ;
                         C      ;    CALL  STDX    'Store':            (IX+d) := HL
                         C      ;    DB    d                                                  Stack: 4
                         C      ;    -----------   ----------------------------------------------------
                         C      			;
  51B6'   CD 5182'       C      XY.STDX:	CALL	CALP1	; Uebernahme d
                         C      			;
  51B9'   DD E5          C      	PUSH	IX	; HL := IX+d
  51BB'   E1             C      	POP	HL	;               <--- STDY
  51BC'   F5             C      	PUSH	AF
  51BD'   19             C      	ADD	HL,DE
  51BE'   F1             C      	POP	AF
''	MACRO-80 3.44	09-Dec-81	PAGE	1-25


                         C      			;
  51BF'   D1             C      	POP	DE
  51C0'   73             C      	LD	(HL),E	; (IX+d) := HL
  51C1'   23             C      	INC	HL
  51C2'   72             C      	LD	(HL),D
  51C3'   EB             C      	EX	DE,HL
                         C      			;
  51C4'   D1             C      	POP	DE	; Return
  51C5'   C9             C      	RET
                         C      			;
                         C      ;**********************************************************************
                         C      ;
                         C      ;    CALL  STIDX    'Store inverse':    (IX+d) := LH
                         C      ;    DB    d                                                  Stack: 4
                         C      ;    -----------   ----------------------------------------------------
                         C      			;
  51C6'   CD 5182'       C      XY.STIDX:	CALL	CALP1	; Uebernahme d
                         C      			;
  51C9'   DD E5          C      	PUSH	IX	; HL := IX+d
  51CB'   E1             C      	POP	HL	;               <--- STIDY
  51CC'   F5             C      	PUSH	AF
  51CD'   19             C      	ADD	HL,DE
  51CE'   F1             C      	POP	AF
                         C      			;
  51CF'   D1             C      	POP	DE
  51D0'   72             C      	LD	(HL),D	; (IX+d) := LH
  51D1'   23             C      	INC	HL
  51D2'   73             C      	LD	(HL),E
  51D3'   EB             C      	EX	DE,HL
                         C      			;
  51D4'   D1             C      	POP	DE	; Return
  51D5'   C9             C      	RET
                         C      			;
                         C      ;**********************************************************************
                         C      ;
                         C      ;    CALL  INCDX    'Increment':        (IX+d) := (IX+d) + 1
                         C      ;    DB    d                                    Flags wie ADC HL,...
                         C      ;                                                             Stack: 4
                         C      ;    -----------   ----------------------------------------------------
                         C      			;
  51D6'   CD 5182'       C      XY.INCDX:	CALL	CALP1	; Uebernahme d
                         C      			;
  51D9'   DD E5          C      	PUSH	IX	; HL := IX+d
  51DB'   E1             C      	POP	HL	;               <--- INCDY
  51DC'   19             C      	ADD	HL,DE
                         C      			;
  51DD'   5E             C      	LD	E,(HL)	; DE := (IX+d)
  51DE'   23             C      	INC	HL
  51DF'   56             C      	LD	D,(HL)
                         C      			;
  51E0'   E5             C      	PUSH	HL	; DE := (IX+d) + 1
  51E1'   21 0001        C      	LD	HL,1
  51E4'   B7             C      	OR	A
  51E5'   ED 5A          C      	ADC	HL,DE
  51E7'   EB             C      	EX	DE,HL
  51E8'   E1             C      	POP	HL
  51E9'   72             C      	LD	(HL),D
  51EA'   2B             C      	DEC	HL
  51EB'   73             C      	LD	(HL),E
                         C      			;
  51EC'   E1             C      	POP	HL	; Return
  51ED'   D1             C      	POP	DE
''	MACRO-80 3.44	09-Dec-81	PAGE	1-26


  51EE'   C9             C      	RET
                         C      			;
                         C      ;**********************************************************************
                         C      ;*                                                                    *
                         C      ;*       Unterprogramm  'Unbedingter Sprung'                          *
                         C      ;*                                                                    *
                         C      ;**********************************************************************
                         C      ;
                         C      ;    CALL  JMPDX   'Jump':              JMP  (IX+d)
                         C      ;    DB    d                                              Stack: 4
                         C      ;                                       Achtung!
                         C      ;                                           Veraendert freie Stack-Pl.
                         C      ;    -----------   ----------------------------------------------------
                         C      			;
  51EF'   CD 5182'       C      JMPDX:	CALL	CALP1	; Uebernahme d
                         C      			;
  51F2'   DD E5          C      	PUSH	IX	; HL := IX+d
  51F4'   E1             C      	POP	HL	;               <--- JMPDY
  51F5'   F5             C      	PUSH	AF
  51F6'   19             C      	ADD	HL,DE
  51F7'   F1             C      	POP	AF
                         C      			;
  51F8'   5E             C      	LD	E,(HL)	; HL := (IX+d)
  51F9'   23             C      	INC	HL
  51FA'   56             C      	LD	D,(HL)
  51FB'   EB             C      	EX	DE,HL
                         C      			;
  51FC'   D1             C      	POP	DE	; Return = Jump
  51FD'   E3             C      	EX	(SP),HL
  51FE'   EB             C      	EX	DE,HL
  51FF'   C9             C      	RET
                         C      			;
                         C      ;**********************************************************************
                         C      ;	END
                         C      	PAGE
''	MACRO-80 3.44	09-Dec-81	PAGE	1-27


                         C      
                         C      ;	PN	UC
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;       KONVERTIERUNGEN
                         C      ;
                         C      ;----------------------------------------------------------------------
                         C      ;                            HL := HL * 10
                         C      ;                                      (ohne Kontrolle auf Uebertrag)
  5200'   E5             C      UC.HL10N:	PUSH	HL
  5201'   D1             C      	POP	DE	; alter Wert in DE
  5202'   29             C      	ADD	HL,HL
  5203'   29             C      	ADD	HL,HL
  5204'   19             C      	ADD	HL,DE
  5205'   29             C      	ADD	HL,HL
  5206'   C9             C      	RET
                         C      ;                            HL := HL * 10
                         C      ;                                            -->  C: Uebertrag in A
  5207'   E5             C      UC.HL10C:	PUSH	HL
  5208'   D1             C      	POP	DE	; alter Wert in DE
  5209'   AF             C      	XOR	A
  520A'   29             C      	ADD	HL,HL
  520B'   30 01          C      	JR	NC,$+3
  520D'   3C             C      	INC	A
  520E'   87             C      	ADD	A,A
  520F'   29             C      	ADD	HL,HL
  5210'   30 01          C      	JR	NC,$+3
  5212'   3C             C      	INC	A
  5213'   19             C      	ADD	HL,DE
  5214'   30 01          C      	JR	NC,$+3
  5216'   3C             C      	INC	A
  5217'   87             C      	ADD	A,A
  5218'   29             C      	ADD	HL,HL
  5219'   30 01          C      	JR	NC,$+3
  521B'   3C             C      	INC	A
  521C'   B7             C      	OR	A
  521D'   C8             C      	RET	Z
  521E'   37             C      	SCF
  521F'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      ;                            Division mit Rest:  A  := HL / DE
                         C      ;                                                HL := Rest
                         C      			;      Cy(A) --->  A=255
                         C      			;-------------------------------
  5220'   AF             C      UC.DIVR:	XOR	A
  5221'   ED 52          C      	SBC	HL,DE
  5223'   3C             C      	INC	A
  5224'   20 03          C      	JR	NZ,$+5
  5226'   3D             C      	DEC	A
  5227'   38 03          C      	JR	C,$+5
  5229'   30 F6          C      	JR	NC,$-8
  522B'   3D             C      	DEC	A
  522C'   19             C      	ADD	HL,DE
  522D'   C9             C      	RET
                         C      			;
                         C      ;**********************************************************************
                         C      ;*                                                                    *
                         C      ;*       CV...               Konvertierungen     (convert ...)        *
                         C      ;*                                                                    *
                         C      ;*--------------------------------------------------------------------*
''	MACRO-80 3.44	09-Dec-81	PAGE	1-28


                         C      ;*       ..A..:              in A                                     *
                         C      ;*       ..?*.:              von Typ *                                *
                         C      ;*       ..?.*:              nach Typ *                               *
                         C      ;*                                                                    *
                         C      ;*       Typen:              B - binaer                               *
                         C      ;*                           X - hexadezimal ASCII                    *
                         C      ;*                           A - Adresse binaer (L,H)                 *
                         C      ;*                           D - dezimal ASCII                        *
                         C      ;*                                                                    *
                         C      ;**********************************************************************
                         C      			;
                         C      ;                            In A:      Binaer < 16 --> ASCII hexa
                         C      ;                            ------------------------------------------
  522E'   E6 0F          C      UC.CVABX:	AND	0FH
  5230'   F6 30          C      	OR	30H
  5232'   FE 3A          C      	CP	3AH
  5234'   D8             C      	RET	C
  5235'   C6 07          C      	ADD	A,7H
  5237'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      ;                            Byte binaer (HL) --> 2 ASCII hexa (DE)
                         C      ;                                                            HL+1, DE+2
                         C      ;                            ------------------------------------------
  5238'   7E             C      UC.CVBX:	LD	A,(HL)
  5239'   23             C      	INC	HL	; benutzt: A, 2 Stack-P.
                         C      			;
  523A'   F5             C      	PUSH	AF	;ENTRY,WENN ZEICHEN IN A
  523B'   0F             C      	RRCA
  523C'   0F             C      	RRCA
  523D'   0F             C      	RRCA
  523E'   0F             C      	RRCA
  523F'   CD 5243'       C      	CALL	$+4
  5242'   F1             C      	POP	AF
                         C      			;
  5243'   CD 522E'       C      	CALL	UC.CVABX
  5246'   12             C      	LD	(DE),A
  5247'   13             C      	INC	DE
  5248'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      ;                       Adresse (L,H) binaer (HL) --> 4 ASCII hexa (DE)
                         C      ;                                                            HL+2, DE+4
                         C      ;                       -----------------------------------------------
  5249'   23             C      UC.CVAX:	INC	HL
  524A'   CD 5238'       C      	CALL	UC.CVBX	; benutzt: A, 3 Stack-P.
  524D'   2B             C      	DEC	HL
  524E'   2B             C      	DEC	HL
  524F'   CD 5238'       C      	CALL	UC.CVBX
  5252'   23             C      	INC	HL
  5253'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      ;                       Adresse aus HL, binaer    --> 4 ASCII hexa (DE)
                         C      ;                                                                  DE+4
                         C      ;                       -----------------------------------------------
  5254'   7C             C      UC.CVHLX:	LD	A,H
  5255'   CD 523A'       C      	CALL	UC.CVBX+2	; benutzt: A, 3 Stack-P.
  5258'   7D             C      	LD	A,L
  5259'   CD 523A'       C      	CALL	UC.CVBX+2
  525C'   C9             C      	RET
                         C      			;
''	MACRO-80 3.44	09-Dec-81	PAGE	1-29


                         C      			;
                         C      ;      ---------------------------------------------------------------
                         C      ;                            In A:     ASCII hexa --> binaer < 16
                         C      ;
                         C      ;                                       Datenfehler: Cy, A undefiniert
                         C      ;                            ------------------------------------------
  525D'   D6 30          C      UC.CVAXB:	SUB	30H
  525F'   D8             C      	RET	C		;       (A) < '0'
  5260'   FE 0A          C      	CP	10
  5262'   3F             C      	CCF
  5263'   D0             C      	RET	NC
  5264'   FE 11          C      	CP	11H
  5266'   D8             C      	RET	C		; '9' < (A) < 'A'
  5267'   FE 17          C      	CP	17H
  5269'   3F             C      	CCF
  526A'   D8             C      	RET	C		; 'F' < (A)
  526B'   D6 07          C      	SUB	7H
  526D'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      ;                            2 ASCII hexa (DE) --> Byte binaer (HL)
                         C      ;                                                            DE+2, HL+1
                         C      ;
                         C      ;                                       mit Datenfehler-Behandlung
                         C      ;                            ------------------------------------------
  526E'   C5             C      UC.CVXB:	PUSH	BC
                         C      			; benutzt: A, 3 Stack-P.
  526F'   CD 527F'       C      	CALL	UC.CVX1B
  5272'   87             C      	ADD	A,A
  5273'   87             C      	ADD	A,A
  5274'   87             C      	ADD	A,A
  5275'   87             C      	ADD	A,A
  5276'   4F             C      	LD	C,A
                         C      			;
  5277'   CD 527F'       C      	CALL	UC.CVX1B
  527A'   81             C      	ADD	A,C
                         C      			;
  527B'   77             C      	LD	(HL),A
  527C'   23             C      	INC	HL
  527D'   C1             C      	POP	BC
  527E'   C9             C      	RET
                         C      			;
  527F'   1A             C      UC.CVX1B:	LD	A,(DE)	; ASCII hexa (DE) --> A binaer,
  5280'   CD 525D'       C      	CALL	UC.CVAXB	;                           DE+1
  5283'   DC 5288'       C      	CALL	C,UC.CVXER
  5286'   13             C      	INC	DE
  5287'   C9             C      	RET
                         C      			;
  5288'   EB             C      UC.CVXER:	EX	DE,HL	; Datenfehler-Behandlung hexa
  5289'   CB FE          C      	SET	7,(HL)	;         set cursor
  528B'   CD 4B6F'       C      	CALL	UR.TAREP	; <-+     tast.request
  528E'   77             C      	LD	(HL),A	;   !     write in conv.-area
  528F'   CD 525D'       C      	CALL	UC.CVAXB	;   !     conv.in A
  5292'   38 F7          C      	JR	C,$-7	; $-$-+     on error ...
  5294'   CB BE          C      	RES	7,(HL)
  5296'   EB             C      	EX	DE,HL
  5297'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      ;                       4 ASCII hexa (DE) --> Adresse (L,H) binaer (HL)
                         C      ;                                                            DE+4, HL+2
                         C      ;
''	MACRO-80 3.44	09-Dec-81	PAGE	1-30


                         C      ;                                       mit Datenfehler-Behandlung
                         C      ;                       -----------------------------------------------
  5298'   23             C      UC.CVXA:	INC	HL
  5299'   CD 526E'       C      	CALL	UC.CVXB	; benutzt: A, 4 Stack-P.
  529C'   2B             C      	DEC	HL
  529D'   2B             C      	DEC	HL
  529E'   CD 526E'       C      	CALL	UC.CVXB
  52A1'   23             C      	INC	HL
  52A2'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      ;                     2 Byte binaer in HL ---> 1...5-stellig dezi (DE),
                         C      ;                                                             DE+1...5
                         C      ;                                  mit Vor-Null-Unterdrueckung
                         C      ;                                                    (nach nicht-dezi),
                         C      ;                                  zu wenig Stellen -->
                         C      ;                                      '*' in der obersten angeg.Stelle
                         C      ;                      ------------------------------------------------
  52A3'   3E 05          C      UC.CVBD5:	LD	A,5	; benutzt: A, 7 Stack-P.
  52A5'   18 0E          C      	JR	$+16
  52A7'   3E 04          C      UC.CVBD4:	LD	A,4
  52A9'   18 0A          C      	JR	$+12
  52AB'   3E 03          C      UC.CVBD3:	LD	A,3
  52AD'   18 06          C      	JR	$+8
  52AF'   3E 02          C      UC.CVBD2:	LD	A,2
  52B1'   18 02          C      	JR	$+4
  52B3'   3E 01          C      UC.CVBD1:	LD	A,1
                         C      			;
  52B5'   C5             C      UC.CVBD:	PUSH	BC	; Zeichenzahl in A
  52B6'   E5             C      	PUSH	HL
  52B7'   47             C      	LD	B,A
  52B8'   CD 52C0'       C      	CALL	UC.CVBD0
  52BB'   10 FB          C      	DJNZ	$-3
  52BD'   E1             C      	POP	HL
  52BE'   C1             C      	POP	BC
  52BF'   C9             C      	RET
                         C      			;
                         C      ;                          Abspaltung B-te Stelle dezi von HL nach (DE)
                         C      ;                                                                  DE+1
                         C      ;                          B-te nicht fuehrende Stelle: '*' nach (DE)
                         C      ;                          --------------------------------------------
  52C0'   C5             C      UC.CVBD0:	PUSH	BC	; benutzt: A, 5 Stack-P.
                         C      			; --------
  52C1'   7D             C      	LD	A,L
  52C2'   F6 30          C      	OR	'0'
  52C4'   05             C      	DEC	B
  52C5'   28 29          C      	JR	Z,$+43	; -------$+
                         C      			;        !
  52C7'   D5             C      	PUSH	DE	;        !
  52C8'   E5             C      	PUSH	HL	; DE := (B-1)-te Zehner-Potenz
  52C9'   21 0001        C      	LD	HL,1	;        !
  52CC'   CD 5200'       C      	CALL	UC.HL10N	;        !
  52CF'   10 FB          C      	DJNZ	$-3	;        !
  52D1'   EB             C      	EX	DE,HL	;        !
  52D2'   E1             C      	POP	HL	;        !
                         C      			;        !
  52D3'   CD 5220'       C      	CALL	UC.DIVR	; A := HL / B-te Zehner-Potenz
  52D6'   D1             C      	POP	DE	;        !     HL := Rest
                         C      			;        !
  52D7'   FE 0A          C      	CP	10	; test to decimal
  52D9'   38 04          C      	JR	C,$+6	; ---$+   !
  52DB'   3E 2A          C      	LD	A,'*'	;    !   !
''	MACRO-80 3.44	09-Dec-81	PAGE	1-31


  52DD'   18 11          C      	JR	$+19	;   -----$+
                         C      			; <--+   !
  52DF'   F6 30          C      	OR	'0'	; conv.to decimal
                         C      			;        !
  52E1'   FE 30          C      	CP	'0'	; Vor-Null ?
  52E3'   20 0B          C      	JR	NZ,$+13	; -------$+
  52E5'   1B             C      	DEC	DE	;        !
  52E6'   4F             C      	LD	C,A	;        !
  52E7'   CD 531D'       C      	CALL	UC.CVD1B	;        !
  52EA'   79             C      	LD	A,C	;        !
  52EB'   13             C      	INC	DE	;        !
  52EC'   30 02          C      	JR	NC,$+4	;        !
  52EE'   3E 20          C      	LD	A,' '	;        !
                         C      			; <------+
  52F0'   12             C      	LD	(DE),A
  52F1'   13             C      	INC	DE
  52F2'   C1             C      	POP	BC
  52F3'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      ;                      Dezi von (DE) bis (-->DE) nicht-dezi
                         C      ;                                                --->      binaer in HL
                         C      ;
                         C      ;                         Fehler:
                         C      ;                         -------
                         C      ;                         Cy, NZ: Zahl zu gross, HL ohne letzte Ziffer
                         C      ;                         Cy, Z:  Leere Zahl (1.Position keine Ziffer),
                         C      ;                                        -->     HL = 0
                         C      ;                      ------------------------------------------------
  52F4'   26 00          C      UC.CVDB:	LD	H,0
  52F6'   CD 531D'       C      	CALL	UC.CVD1B
  52F9'   6F             C      	LD	L,A
  52FA'   30 04          C      	JR	NC,$+6
  52FC'   AF             C      	XOR	A
  52FD'   6F             C      	LD	L,A
  52FE'   37             C      	SCF
  52FF'   C9             C      	RET		; ---> abend C, Z
                         C      			;
  5300'   13             C      	INC	DE
  5301'   CD 531D'       C      	CALL	UC.CVD1B
  5304'   3F             C      	CCF
  5305'   D0             C      	RET	NC		; ---> normal end
  5306'   D5             C      	PUSH	DE
  5307'   F5             C      	PUSH	AF
  5308'   CD 5207'       C      	CALL	UC.HL10C
  530B'   38 0B          C      	JR	C,$+13	;      -----$+
  530D'   F1             C      	POP	AF	;           !
  530E'   85             C      	ADD	A,L	;           !
  530F'   6F             C      	LD	L,A	;           !
  5310'   30 03          C      	JR	NC,$+5	; --$+       !
  5312'   24             C      	INC	H	;   !       !
  5313'   28 04          C      	JR	Z,$+6	;   !    ---!--$+
  5315'   D1             C      	POP	DE	; <-+       !  !
  5316'   18 E8          C      	JR	$-22	;           !  !
                         C      			;      <----+  !
  5318'   E1             C      	POP	HL	; abend Cy, NZ !
  5319'   25             C      	DEC	H	;              !
  531A'   EB             C      	EX	DE,HL	;        <-----+
  531B'   D1             C      	POP	DE
  531C'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
''	MACRO-80 3.44	09-Dec-81	PAGE	1-32


                         C      ;                            Ziffer dezi (DE) ---> binaer nach A, DE+1
                         C      ;                                                  Cy: nicht-dezi
                         C      ;                            ------------------------------------------
  531D'   1A             C      UC.CVD1B:	LD	A,(DE)
  531E'   D6 30          C      	SUB	30H
  5320'   D8             C      	RET	C
  5321'   FE 0A          C      	CP	10
  5323'   3F             C      	CCF
  5324'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      ;                    Byte binaer (HL) --> Byte ASCII-Symbol (DE)
                         C      ;                                         (sonst: 7FH )
                         C      ;                                                     HL+1, DE+1
                         C      ;                    --------------------------------------------------
  5325'   7E             C      UC.CVBC:	LD	A,(HL)	; benutzt: A, 0 Stack-P.
  5326'   23             C      	INC	HL	; --------
  5327'   FE 20          C      	CP	20H
  5329'   30 02          C      	JR	NC,$+4
  532B'   3E 7F          C      	LD	A,7FH
  532D'   FE 7F          C      	CP	7FH
  532F'   38 02          C      	JR	C,$+4
  5331'   3E 7F          C      	LD	A,7FH
  5333'   12             C      	LD	(DE),A
  5334'   13             C      	INC	DE
  5335'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      ;                       Byte ASCII-Symbol (DE)   -->   Byte binaer (HL)
                         C      ;                                                      DE+1, HL+1
                         C      ;                       -----------------------------------------------
  5336'   1A             C      UC.CVCB:	LD	A,(DE)	; benutzt: A, 0 Stack-P.
  5337'   13             C      	INC	DE
  5338'   FE 20          C      	CP	20H
  533A'   38 05          C      	JR	C,$+7
  533C'   FE 7E          C      	CP	7EH
  533E'   30 01          C      	JR	NC,$+3
  5340'   77             C      	LD	(HL),A
  5341'   23             C      	INC	HL
  5342'   C9             C      	RET
                         C      			;
                         C      
                         C      ;**********************************************************************
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;      KONVERTIERUNGEN
                         C      ;
                         C      ;----------------------------------------------------------------------
  5343'   7E             C      UC.DKONV:	LD	A,(HL)	;DKOI--->ASCII
  5344'   CD 5357'       C      	CALL	UC.DK1	;(HL)--->(DE)
  5347'   12             C      	LD	(DE),A
  5348'   23             C      	INC	HL
  5349'   13             C      	INC	DE
  534A'   10 F7          C      	DJNZ	UC.DKONV
  534C'   C9             C      	RET
                         C      ;------------------------------------
  534D'   7E             C      UC.KONV:	LD	A,(HL)	;ASCII--->DKOI
  534E'   CD 5362'       C      	CALL	UC.CKONV	;(HL) --->(DE)
  5351'   12             C      	LD	(DE),A
  5352'   23             C      	INC	HL
  5353'   13             C      	INC	DE
  5354'   10 F7          C      	DJNZ	UC.KONV
''	MACRO-80 3.44	09-Dec-81	PAGE	1-33


  5356'   C9             C      	RET
                         C      ;-----------------------------
  5357'   E5             C      UC.DK1:	PUSH	HL	;DKOI--->ASCII
  5358'   D5             C      	PUSH	DE
  5359'   C5             C      	PUSH	BC
  535A'   21 5385'       C      	LD	HL,ASCCO
  535D'   11 53E5'       C      	LD	DE,DKOI
  5360'   18 09          C      	JR	UC.DK2
  5362'   E5             C      UC.CKONV:	PUSH	HL	;ASCII ---> DKOI
  5363'   D5             C      	PUSH	DE
  5364'   C5             C      	PUSH	BC
  5365'   21 53E5'       C      	LD	HL,DKOI	;HL:= Anfangsadresse
  5368'   11 5385'       C      	LD	DE,ASCCO	;DE:= Anfangsadresse
  536B'   F5             C      UC.DK2:	PUSH	AF	;Quellcodebyte retten
  536C'   AF             C      	XOR	A	;CY = 0
  536D'   ED 52          C      	SBC	HL,DE	;Tabellendistanz berechnen
  536F'   2B             C      	DEC	HL
  5370'   E5             C      	PUSH	HL
  5371'   C1             C      	POP	BC	;BC:= Tabellendistanz - 1
  5372'   EB             C      	EX	DE,HL	;HL:= Anfangsadresse
  5373'   F1             C      	POP	AF	;Zeichen wieder herstellen
  5374'   C5             C      	PUSH	BC	;Tabellendistanz retten
  5375'   01 0060        C      	LD	BC,UE.COTAL	;BC:= Tabellenlaenge
  5378'   ED B1          C      	CPIR		;Quellcodebyte suchen
  537A'   37             C      	SCF		;CY = 1
  537B'   C1             C      	POP	BC	;Tabellendistanz auskellern
  537C'   20 03          C      	JR	NZ,UC.KONV2	;---> Quellcodebyte nicht
  537E'   09             C      	ADD	HL,BC	;Zielcodeadresse berechnen
  537F'   AF             C      	XOR	A	;CY = 0
  5380'   7E             C      	LD	A,(HL)	;Zielcodebyte laden
  5381'   C1             C      UC.KONV2:	POP	BC
  5382'   D1             C      	POP	DE
  5383'   E1             C      	POP	HL
  5384'   C9             C      	RET
                         C      ;****************************************************************
                         C      ;         ASCII - Codetabelle
                         C      ;****************************************************************
  5385'   20 21 22 23    C      ASCCO:	DB	' !"#$%&'
  5389'   24 25 26       C      
  538C'   27             C      	DB	27H	;'
  538D'   28 29 2A 2B    C      	DB	'()*+,-./'
  5391'   2C 2D 2E 2F    C      
  5395'   30 31 32 33    C      	DB	'0123456789'
  5399'   34 35 36 37    C      
  539D'   38 39          C      
  539F'   3A 3B 3C 3D    C      	DB	':;<=>?@'
  53A3'   3E 3F 40       C      
  53A6'   41 42 43 44    C      	DB	'ABCDEFGHIJKLMNOPQRSTUVWXYZ'
  53AA'   45 46 47 48    C      
  53AE'   49 4A 4B 4C    C      
  53B2'   4D 4E 4F 50    C      
  53B6'   51 52 53 54    C      
  53BA'   55 56 57 58    C      
  53BE'   59 5A          C      
  53C0'   5B 5C 5D 5E    C      	DB	'[\]^_`'
  53C4'   5F 60          C      
  53C6'   61 62 63 64    C      	DB	'abcdefghijklmnopqrstuvwxyz'
  53CA'   65 66 67 68    C      
  53CE'   69 6A 6B 6C    C      
  53D2'   6D 6E 6F 70    C      
  53D6'   71 72 73 74    C      
  53DA'   75 76 77 78    C      
''	MACRO-80 3.44	09-Dec-81	PAGE	1-34


  53DE'   79 7A          C      
  53E0'   7B 7C 7D 7E    C      	DB	'{|}~'
  53E4'   7F             C      	DB	7FH	;DEL
                         C      ;***************************************************************
                         C      ;         DKOI - Codetabelle
                         C      ;***************************************************************
  53E5'   40             C      DKOI:	DB	40H	;blank
  53E6'   4F             C      	DB	4FH	;!
  53E7'   7F             C      	DB	7FH	;"
  53E8'   7B             C      	DB	7BH	;#
  53E9'   5B             C      	DB	5BH	;$
  53EA'   6C             C      	DB	6CH	;%
  53EB'   50             C      	DB	50H	;&
  53EC'   7D             C      	DB	7DH	;'
  53ED'   4D             C      	DB	4DH	;(
  53EE'   5D             C      	DB	5DH	;)
  53EF'   5C             C      	DB	5CH	;*
  53F0'   4E             C      	DB	4EH	;+
  53F1'   6B             C      	DB	6BH	;,
  53F2'   60             C      	DB	60H	;-
  53F3'   4B             C      	DB	4BH	;.
  53F4'   61             C      	DB	61H	;/
  53F5'   F0             C      	DB	0F0H	;0
  53F6'   F1             C      	DB	0F1H	;1
  53F7'   F2             C      	DB	0F2H	;2
  53F8'   F3             C      	DB	0F3H	;3
  53F9'   F4             C      	DB	0F4H	;4
  53FA'   F5             C      	DB	0F5H	;5
  53FB'   F6             C      	DB	0F6H	;6
  53FC'   F7             C      	DB	0F7H	;7
  53FD'   F8             C      	DB	0F8H	;8
  53FE'   F9             C      	DB	0F9H	;9
  53FF'   7A             C      	DB	7AH	;:
  5400'   5E             C      	DB	5EH	;;
  5401'   4C             C      	DB	4CH	;<
  5402'   7E             C      	DB	7EH	;=
  5403'   6E             C      	DB	6EH	;>
  5404'   6F             C      	DB	6FH	;?
  5405'   7C             C      	DB	7CH	;@
  5406'   C1             C      	DB	0C1H	;A
  5407'   C2             C      	DB	0C2H	;B
  5408'   C3             C      	DB	0C3H	;C
  5409'   C4             C      	DB	0C4H	;D
  540A'   C5             C      	DB	0C5H	;E
  540B'   C6             C      	DB	0C6H	;F
  540C'   C7             C      	DB	0C7H	;G
  540D'   C8             C      	DB	0C8H	;H
  540E'   C9             C      	DB	0C9H	;I
  540F'   D1             C      	DB	0D1H	;J
  5410'   D2             C      	DB	0D2H	;K
  5411'   D3             C      	DB	0D3H	;L
  5412'   D4             C      	DB	0D4H	;M
  5413'   D5             C      	DB	0D5H	;N
  5414'   D6             C      	DB	0D6H	;O
  5415'   D7             C      	DB	0D7H	;P
  5416'   D8             C      	DB	0D8H	;Q
  5417'   D9             C      	DB	0D9H	;R
  5418'   E2             C      	DB	0E2H	;S
  5419'   E3             C      	DB	0E3H	;T
  541A'   E4             C      	DB	0E4H	;U
  541B'   E5             C      	DB	0E5H	;V
  541C'   E6             C      	DB	0E6H	;W
''	MACRO-80 3.44	09-Dec-81	PAGE	1-35


  541D'   E7             C      	DB	0E7H	;X
  541E'   E8             C      	DB	0E8H	;Y
  541F'   E9             C      	DB	0E9H	;Z
  5420'   4A             C      	DB	4AH	;[
  5421'   E0             C      	DB	0E0H	;\
  5422'   5A             C      	DB	5AH	;]
  5423'   5F             C      	DB	5FH	;^
  5424'   6D             C      	DB	6DH	;_
  5425'   79             C      	DB	79H	;`
  5426'   81             C      	DB	81H	;a
  5427'   82             C      	DB	82H	;b
  5428'   83             C      	DB	83H	;c
  5429'   84             C      	DB	84H	;d
  542A'   85             C      	DB	85H	;e
  542B'   86             C      	DB	86H	;f
  542C'   87             C      	DB	87H	;g
  542D'   88             C      	DB	88H	;h
  542E'   89             C      	DB	89H	;i
  542F'   91             C      	DB	91H	;j
  5430'   92             C      	DB	92H	;k
  5431'   93             C      	DB	93H	;l
  5432'   94             C      	DB	94H	;m
  5433'   95             C      	DB	95H	;n
  5434'   96             C      	DB	96H	;o
  5435'   97             C      	DB	97H	;p
  5436'   98             C      	DB	98H	;q
  5437'   99             C      	DB	99H	;r
  5438'   A2             C      	DB	0A2H	;s
  5439'   A3             C      	DB	0A3H	;t
  543A'   A4             C      	DB	0A4H	;u
  543B'   A5             C      	DB	0A5H	;v
  543C'   A6             C      	DB	0A6H	;w
  543D'   A7             C      	DB	0A7H	;x
  543E'   A8             C      	DB	0A8H	;y
  543F'   A9             C      	DB	0A9H	;z
  5440'   C0             C      	DB	0C0H	;{
  5441'   6A             C      	DB	6AH	;|
  5442'   D0             C      	DB	0D0H	;}
  5443'   A1             C      	DB	0A1H	;~
  5444'   FF             C      	DB	0FFH	;DEL
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                         C      	PAGE
''	MACRO-80 3.44	09-Dec-81	PAGE	1-36


                         C      
                         C      ;	PN	UA01
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;     AUSSCHRIFTEN
                         C      ;
                         C      ;----------------------------------------------------------------------
  5445'   00             C      UA.DS:	DB	0
  5446'   01             C      	DB	1
  5447'   00             C      	DB	0
  5448'   01             C      	DB	1
  5449'   20 20 44 53    C      	DB	'  DS************   '
  544D'   2A 2A 2A 2A    C      
  5451'   2A 2A 2A 2A    C      
  5455'   2A 2A 2A 2A    C      
  5459'   20 20 20       C      
  545C'   01             C      	DB	1
  545D'   00             C      	DB	0
  545E'   00             C      	DB	0
  545F'   00             C      	DB	0
  5460'   00             C      	DB	0
  5461'   00             C      	DB	0
  5462'   00             C      	DB	0
  5463'   00             C      	DB	0
  5464'   00             C      	DB	0
                         C      ;----------------------------------------------------------------------
  5465'   06             C      UA.KNAME:	DB	06H
  5466'   10             C      	DB	16
  5467'   40             C      	DB	40H
  5468'   20 4B 61 73    C      	DB	' KassettenName: '
  546C'   73 65 74 74    C      
  5470'   65 6E 4E 61    C      
  5474'   6D 65 3A 20    C      
  5478'   03             C      UA.NR:	DB	03H
  5479'   10             C      	DB	16
  547A'   40             C      	DB	40H
  547B'   20 4B 61 73    C      	DB	' Kassetten-Nr.: '
  547F'   73 65 74 74    C      
  5483'   65 6E 2D 4E    C      
  5487'   72 2E 3A 20    C      
  548B'   0B             C      UA.KOMMT:	DB	0BH
  548C'   10             C      	DB	16
  548D'   80             C      	DB	80H
  548E'   20 20 20 20    C      	DB	'     Kommentar: '
  5492'   20 4B 6F 6D    C      
  5496'   6D 65 6E 74    C      
  549A'   61 72 3A 20    C      
                         C      ;----------------------------------------------------------------------
  549E'   45 69 6E 67    C      UA.Z7E:	DB	'Eingabe      =====>     Ausgabe'
  54A2'   61 62 65 20    C      
  54A6'   20 20 20 20    C      
  54AA'   20 3D 3D 3D    C      
  54AE'   3D 3D 3E 20    C      
  54B2'   20 20 20 20    C      
  54B6'   41 75 73 67    C      
  54BA'   61 62 65       C      
  54BD'   20 20 20 20    C      UA.GER:	DB	'       Geraet: '
  54C1'   20 20 20 47    C      
  54C5'   65 72 61 65    C      
  54C9'   74 3A 20       C      
                         C      ;----------------------------------------------------------------------
''	MACRO-80 3.44	09-Dec-81	PAGE	1-37


  54CC'   01             C      UA.KOPFR:	DB	01H
  54CD'   33             C      	DB	51
  54CE'   80             C      	DB	80H
  54CF'   20 20 20 20    C      	DB	'                Datei               kopieren J/N ? '
  54D3'   20 20 20 20    C      
  54D7'   20 20 20 20    C      
  54DB'   20 20 20 20    C      
  54DF'   44 61 74 65    C      
  54E3'   69 20 20 20    C      
  54E7'   20 20 20 20    C      
  54EB'   20 20 20 20    C      
  54EF'   20 20 20 20    C      
  54F3'   6B 6F 70 69    C      
  54F7'   65 72 65 6E    C      
  54FB'   20 4A 2F 4E    C      
  54FF'   20 3F 20       C      
  5502'   01             C      UA.EABFR:	DB	01H
  5503'   33             C      	DB	51
  5504'   80             C      	DB	80H
  5505'   20 20 20 20    C      	DB	'                Eingaben in Ordnung  ---->   J/N ? '
  5509'   20 20 20 20    C      
  550D'   20 20 20 20    C      
  5511'   20 20 20 20    C      
  5515'   45 69 6E 67    C      
  5519'   61 62 65 6E    C      
  551D'   20 69 6E 20    C      
  5521'   4F 72 64 6E    C      
  5525'   75 6E 67 20    C      
  5529'   20 2D 2D 2D    C      
  552D'   2D 3E 20 20    C      
  5531'   20 4A 2F 4E    C      
  5535'   20 3F 20       C      
  5538'   01             C      UA.VORH:	DB	1
  5539'   33             C      	DB	51
  553A'   80             C      	DB	80H
  553B'   2A 2A 2A 2A    C      	DB	'************* Datei vorh.;SYS-Ende,kopieren  J/N ? '
  553F'   2A 2A 2A 2A    C      
  5543'   2A 2A 2A 2A    C      
  5547'   2A 20 44 61    C      
  554B'   74 65 69 20    C      
  554F'   76 6F 72 68    C      
  5553'   2E 3B 53 59    C      
  5557'   53 2D 45 6E    C      
  555B'   64 65 2C 6B    C      
  555F'   6F 70 69 65    C      
  5563'   72 65 6E 20    C      
  5567'   20 4A 2F 4E    C      
  556B'   20 3F 20       C      
                         C      ;----------------------------------------------------------------------
  556E'   02             C      UA.FRZ:	DB	2
  556F'   03             C      	DB	3
  5570'   80             C      	DB	80H
  5571'   3F 3F 20       C      	DB	'?? '
  5574'   01             C      UA.BMGF:	DB	01H
  5575'   07             C      	DB	7
  5576'   80             C      	DB	80H
  5577'   42 4D 20 21    C      	DB	'BM ! ??'
  557B'   20 3F 3F       C      
  557E'   00             C      UA.DOK:	DB	0
  557F'   04             C      	DB	4
  5580'   80             C      	DB	80H
  5581'   69 2E 4F 2E    C      	DB	'i.O.'
''	MACRO-80 3.44	09-Dec-81	PAGE	1-38


  5585'   00             C      UA.DF:	DB	0
  5586'   04             C      	DB	4
  5587'   80             C      	DB	80H
  5588'   46 68 6C 2E    C      	DB	'Fhl.'
                         C      ;----------------------------------------------------------------------
  558C'   06             C      UA.ZKDAT:	DB	6
  558D'   10             C      	DB	16
  558E'   40             C      	DB	40H
  558F'   20 20 20 20    C      	DB	'     Dateiname: '
  5593'   20 44 61 74    C      
  5597'   65 69 6E 61    C      
  559B'   6D 65 3A 20    C      
  559F'   04             C      UA.ZKLAD:	DB	4
  55A0'   10             C      	DB	16
  55A1'   08             C      	DB	08H
  55A2'   20 20 20 4C    C      	DB	'   Ladeadresse: '
  55A6'   61 64 65 61    C      
  55AA'   64 72 65 73    C      
  55AE'   73 65 3A 20    C      
                         C      ;------------------------------------------------------------------
  55B2'   04             C      UA.ZKBEG:	DB	4
  55B3'   10             C      	DB	16
  55B4'   08             C      	DB	08H
  55B5'   20 20 20 20    C      	DB	'        Beginn: '
  55B9'   20 20 20 20    C      
  55BD'   42 65 67 69    C      
  55C1'   6E 6E 3A 20    C      
  55C5'   04             C      UA.ZKEND:	DB	4
  55C6'   10             C      	DB	16
  55C7'   08             C      	DB	08H
  55C8'   20 20 20 20    C      	DB	'          Ende: '
  55CC'   20 20 20 20    C      
  55D0'   20 20 45 6E    C      
  55D4'   64 65 3A 20    C      
  55D8'   04             C      UA.STADR:	DB	4
  55D9'   10             C      	DB	16
  55DA'   08             C      	DB	08H
  55DB'   20 20 53 74    C      	DB	'  Startadresse: '
  55DF'   61 72 74 61    C      
  55E3'   64 72 65 73    C      
  55E7'   73 65 3A 20    C      
  55EB'   01             C      UA.ZKDL:	DB	1
  55EC'   10             C      	DB	16
  55ED'   20             C      	DB	20H
  55EE'   20 4C 6F 65    C      	DB	' Loeschen J/N : '
  55F2'   73 63 68 65    C      
  55F6'   6E 20 4A 2F    C      
  55FA'   4E 20 3A 20    C      
  55FE'   00             C      UA.ZKF:	DB	0
  55FF'   08             C      	DB	8
  5600'   00             C      	DB	0
  5601'   46 65 68 6C    C      	DB	'Fehler: '
  5605'   65 72 3A 20    C      
                         C      ;----------------------------------------------------------------------
  5609'   03             C      UA.ZKRES:	DB	3
  560A'   10             C      	DB	16
  560B'   10             C      	DB	10H
  560C'   52 65 73 65    C      	DB	'Reservebloecke: '
  5610'   72 76 65 62    C      
  5614'   6C 6F 65 63    C      
  5618'   6B 65 3A 20    C      
  561C'   04             C      UA.ZKSDT:	DB	4
''	MACRO-80 3.44	09-Dec-81	PAGE	1-39


  561D'   12             C      	DB	18
  561E'   40             C      	DB	40H
  561F'   20 20 20 20    C      	DB	'     Dateiname:   '
  5623'   20 44 61 74    C      
  5627'   65 69 6E 61    C      
  562B'   6D 65 3A 20    C      
  562F'   20 20          C      
  5631'   00             C      UA.ZKBEL:	DB	0
  5632'   10             C      	DB	16
  5633'   00             C      	DB	0
  5634'   42 6C 6F 65    C      	DB	'Bloecke belegt: '
  5638'   63 6B 65 20    C      
  563C'   62 65 6C 65    C      
  5640'   67 74 3A 20    C      
  5644'   00             C      UA.ZKBLG:	DB	0
  5645'   10             C      	DB	16
  5646'   00             C      	DB	0
  5647'   42 6C 6F 65    C      	DB	'Bloecke gesamt: '
  564B'   63 6B 65 20    C      
  564F'   67 65 73 61    C      
  5653'   6D 74 3A 20    C      
                         C      ;----------------------------------------------------------------------
  5657'   42 61 6E 64    C      UA.ZKBM:	DB	'Bandmarke'
  565B'   6D 61 72 6B    C      
  565F'   65             C      
                         C      ;----------------------------------------------------------------------
  5660'   26             C      UA.LD:	DB	38
  5661'   0F             C      	DB	15
  5662'   80             C      	DB	80H
  5663'   20 20 20 20    C      	DB	'               '
  5667'   20 20 20 20    C      
  566B'   20 20 20 20    C      
  566F'   20 20 20       C      
  5672'   01             C      UA.ZRSCH:	DB	1
  5673'   16             C      	DB	22
  5674'   80             C      	DB	80H
  5675'   56 65 72 7A    C      	DB	'Verz. schreiben J/N ? '
  5679'   2E 20 73 63    C      
  567D'   68 72 65 69    C      
  5681'   62 65 6E 20    C      
  5685'   4A 2F 4E 20    C      
  5689'   3F 20          C      
  568B'   01             C      UA.ANZWD:	DB	1
  568C'   16             C      	DB	22
  568D'   80             C      	DB	80H
  568E'   41 6E 7A 65    C      	DB	'Anzeige wdhln.  J/N ? '
  5692'   69 67 65 20    C      
  5696'   77 64 68 6C    C      
  569A'   6E 2E 20 20    C      
  569E'   4A 2F 4E 20    C      
  56A2'   3F 20          C      
                         C      ;----------------------------------------------------------------------
  56A4'   20 41 55 53    C      UA.ALTR:	DB	' AUSGLEICH LAUFWERKSTOLERANZEN  '
  56A8'   47 4C 45 49    C      
  56AC'   43 48 20 4C    C      
  56B0'   41 55 46 57    C      
  56B4'   45 52 4B 53    C      
  56B8'   54 4F 4C 45    C      
  56BC'   52 41 4E 5A    C      
  56C0'   45 4E 20 20    C      
                         C      ;----------------------------------------------------------------------
                         C      ;	END
''	MACRO-80 3.44	09-Dec-81	PAGE	1-40


                         C      	PAGE
''	MACRO-80 3.44	09-Dec-81	PAGE	1-41


                         C      
                         C      ;	PN	LD
                         C      ;***********************************************************
                         C      ;
                         C      ;        Laden von MRES-P-Dateien
                         C      ;
                         C      ;***********************************************************
  56C4'   56C4'          C      	DW	$
  56C6'   4C 4F 41 44    C      	DB	'LOAD'
  56CA'   3A 3327        C      	LD	A,(UE.BWSA+327H)
  56CD'   CD 515A'       C      	CALL	U1.TST
  56D0'   D8             C      	RET	C
  56D1'   CD 5074'       C      	CALL	U1.KTINI
  56D4'   DD 77 03       C      	LD	(IX+3),A
  56D7'   CD 5146'       C      	CALL	U1.BILO
  56DA'   3E 0D          C      	LD	A,13
  56DC'   32 2B00'       C      	LD	(UB.ZN),A
  56DF'   21 558C'       C      LD.DATN:	LD	HL,UA.ZKDAT	;Dateiname ?
  56E2'   CD 4A4C'       C      	CALL	UR.MIMO
  56E5'   D8             C      	RET	C
  56E6'   CD 49A0'       C      	CALL	UR.KRE
  56E9'   CD 49AE'       C      	CALL	UR.KRWW
  56EC'   CD 5028'       C      	CALL	U1.DSVG
  56EF'   3E 01          C      	LD	A,01H
  56F1'   B8             C      	CP	B
  56F2'   28 0A          C      	JR	Z,LD21	;NEU INITIALISIERTE KASSETTE
  56F4'   CD 4BF7'       C      LD2:	CALL	UK.KBW
  56F7'   CD 5059'       C      	CALL	U1.NMVGL	;Dateiname vergleichen
  56FA'   38 08          C      	JR	C,DATFU	;---> Datei gefunden
  56FC'   10 F6          C      	DJNZ	LD2
  56FE'   3E 91          C      LD21:	LD	A,91H	;Datei nicht vorhanden
  5700'   CD 4CFE'       C      	CALL	UF.ERANZ	;FEHLERANZEIGE
  5703'   C9             C      	RET
  5704'   3A 0E6C        C      DATFU:	LD	A,(UE.PUF+6)	;TYP
  5707'   FE 4F          C      	CP	'O'
  5709'   F5             C      	PUSH	AF
  570A'   21 0E7D        C      	LD	HL,UE.PUF+23
  570D'   7E             C      	LD	A,(HL)
  570E'   F5             C      	PUSH	AF
  570F'   47             C      	LD	B,A
  5710'   04             C      	INC	B
  5711'   CD 49E8'       C      	CALL	UR.POSIK	;Positionieren
  5714'   CD 4BF7'       C      	CALL	UK.KBW
  5717'   F1             C      	POP	AF
  5718'   21 0E66        C      	LD	HL,UE.PUF
  571B'   BE             C      	CP	(HL)
  571C'   28 07          C      	JR	Z,DATPO	;Datei richtig positioniert
  571E'   F1             C      	POP	AF
  571F'   3E 94          C      	LD	A,94H
  5721'   CD 4CFE'       C      	CALL	UF.ERANZ
  5724'   C9             C      	RET
  5725'   F1             C      DATPO:	POP	AF
  5726'   CA 57BB'       C      	JP	Z,RL.BEG
  5729'   3A 3329        C      	LD	A,(UE.BWSA+329H)
  572C'   FE 56          C      	CP	'V'
  572E'   20 57          C      	JR	NZ,LD3
  5730'   21 559F'       C      	LD	HL,UA.ZKLAD	;Ladeadresse ?
  5733'   CD 4A4C'       C      	CALL	UR.MIMO
  5736'   DA 56DF'       C      	JP	C,LD.DATN
  5739'   CD 5164'       C      	CALL	U1.PRADR	;ADRESSE EINGEGEBEN
  573C'   38 F2          C      	JR	C,$-12
''	MACRO-80 3.44	09-Dec-81	PAGE	1-42


  573E'   EB             C      	EX	DE,HL
  573F'   21 2B1C'       C      	LD	HL,UB.PAR1
  5742'   CD 5298'       C      	CALL	UC.CVXA
  5745'   CD 4BD4'       C      LD4:	CALL	UK.KLPFB
  5748'   CD 4B97'       C      	CALL	UK.GETK
  574B'   CD 4B97'       C      	CALL	UK.GETK
  574E'   67             C      	LD	H,A
  574F'   CD 4B97'       C      	CALL	UK.GETK
  5752'   6F             C      	LD	L,A
  5753'   7A             C      	LD	A,D
  5754'   B3             C      	OR	E
  5755'   28 09          C      	JR	Z,LD5
  5757'   ED 5B 2B1C'    C      	LD	DE,(UB.PAR1)
  575B'   EB             C      	EX	DE,HL
  575C'   B7             C      	OR	A
  575D'   ED 52          C      	SBC	HL,DE
  575F'   EB             C      	EX	DE,HL	;DE:= Verschiebung zur ersten
  5760'   CD 49D9'       C      LD5:	CALL	UR.KBR
  5763'   CD 578C'       C      	CALL	LADER
  5766'   22 2B1E'       C      	LD	(UB.PAR2),HL
  5769'   21 3329        C      	LD	HL,UE.BWSA+329H
  576C'   06 04          C      	LD	B,4
  576E'   7E             C      	LD	A,(HL)
  576F'   FE 53          C      	CP	'S'
  5771'   28 0A          C      	JR	Z,START
  5773'   23             C      	INC	HL
  5774'   10 F8          C      	DJNZ	$-6
  5776'   CD 49A8'       C      	CALL	UR.KRW
  5779'   CD 49B5'       C      	CALL	UR.KRA
  577C'   C9             C      	RET
  577D'   CD 49A8'       C      START:	CALL	UR.KRW
  5780'   CD 49B5'       C      	CALL	UR.KRA
  5783'   2A 2B1E'       C      	LD	HL,(UB.PAR2)
  5786'   E9             C      	JP	(HL)
  5787'   11 0000        C      LD3:	LD	DE,0
  578A'   18 B9          C      	JR	LD4
                         C      ;--------------------------------------------------------------
  578C'   CD 4BD4'       C      LADER:	CALL	UK.KLPFB
  578F'   CD 4B97'       C      LAD2:	CALL	UK.GETK
  5792'   FE 00          C      	CP	0
  5794'   28 16          C      	JR	Z,LDEND
  5796'   47             C      	LD	B,A
  5797'   CD 4B97'       C      	CALL	UK.GETK
  579A'   67             C      	LD	H,A
  579B'   CD 4B97'       C      	CALL	UK.GETK
  579E'   6F             C      	LD	L,A
  579F'   19             C      	ADD	HL,DE
  57A0'   CD 4B97'       C      LAD1:	CALL	UK.GETK
  57A3'   77             C      	LD	(HL),A
  57A4'   BE             C      	CP	(HL)
  57A5'   20 0E          C      	JR	NZ,LADF
  57A7'   23             C      	INC	HL
  57A8'   10 F6          C      	DJNZ	LAD1
  57AA'   18 E3          C      	JR	LAD2
  57AC'   CD 4B97'       C      LDEND:	CALL	UK.GETK
  57AF'   67             C      	LD	H,A
  57B0'   CD 4B97'       C      	CALL	UK.GETK
  57B3'   6F             C      	LD	L,A
  57B4'   C9             C      	RET
  57B5'   3E 93          C      LADF:	LD	A,93H
  57B7'   CD 4CFE'       C      	CALL	UF.ERANZ
  57BA'   C9             C      	RET
''	MACRO-80 3.44	09-Dec-81	PAGE	1-43


                         C      ;----------------------------------------------------------------------
                         C      ;	END
                         C      	PAGE
''	MACRO-80 3.44	09-Dec-81	PAGE	1-44


                         C      
                         C      ;	PN	RL
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;     RELATIVLADER FUER O-DATEIEN
                         C      ;
                         C      ;----------------------------------------------------------------------
  57BB'   21 55B2'       C      RL.BEG:	LD	HL,UA.ZKBEG	;BEGINN ?
  57BE'   CD 4A4C'       C      	CALL	UR.MIMO
  57C1'   DA 56DF'       C      	JP	C,LD.DATN
  57C4'   CD 5164'       C      	CALL	U1.PRADR
  57C7'   38 F2          C      	JR	C,RL.BEG
  57C9'   EB             C      	EX	DE,HL
  57CA'   21 2B26'       C      	LD	HL,UB.PATAB
  57CD'   CD 5298'       C      	CALL	UC.CVXA
  57D0'   CD 4BF7'       C      UG:	CALL	UK.KBW
  57D3'   2A 2B26'       C      	LD	HL,(UB.PATAB)	;BGADR---->HL
  57D6'   0E 01          C      	LD	C,001H	;LADEN BLOCKZAEHLER MIT
                         C      			;ANFANGSWERT
  57D8'   CD 5863'       C      	CALL	UP6	; AUFRUF EINGABE-UP
                         C      ;********** TEST BEFEHLSKENNZEICHENBYTE *******************************
  57DB'   CB 5A          C      M16:	BIT	3,D	;TEST ORG-BEFEHL
  57DD'   C2 58B7'       C      	JP	NZ,OB	;JA--->FEHLER
  57E0'   CB 62          C      	BIT	4,D	;TEST BER -BEFEHL
  57E2'   C2 584C'       C      	JP	NZ,M10
  57E5'   3E 07          C      	LD	A,007H
  57E7'   A2             C      	AND	D	;TEST BEFEHLS LAENGE=0 ?
  57E8'   CA 585D'       C      	JP	Z,M11
  57EB'   47             C      	LD	B,A	;BEFEHLSLAENGE-->B
  57EC'   CD 5863'       C      M12:	CALL	UP6
  57EF'   72             C      	LD	(HL),D
  57F0'   23             C      	INC	HL
  57F1'   10 F9          C      	DJNZ	M12	;EINGABE BEFEHL
  57F3'   CD 5863'       C      	CALL	UP6
  57F6'   CB 7A          C      	BIT	7,D	;TEST BEFEHLSKENNZEICHENBYTE ?
  57F8'   20 E1          C      	JR	NZ,M16	; JA
                         C      ;******* TEST ADRESSKENNZEICHENBYTE ***********************************
  57FA'   CB 6A          C      	BIT	5,D	;TEST OB REL.ADR. FOLGT
  57FC'   CA 58BB'       C      	JP	Z,RA	;NEIN-->FEHLER
  57FF'   CB 72          C      	BIT	6,D	;FOLGT BEZUGNAHME AUF
                         C      			;SYMBOLVERZEICHNIS
  5801'   C2 58BF'       C      	JP	NZ,SV	;JA--->FEHLER
  5804'   CB 52          C      	BIT	2,D	;MINUS ?
  5806'   C2 58C3'       C      	JP	NZ,MN
  5809'   3E 03          C      M17:	LD	A,003H
  580B'   A2             C      	AND	D	;TEST ADRESSLAENGE
  580C'   F5             C      	PUSH	AF
  580D'   E5             C      	PUSH	HL
  580E'   CD 5863'       C      	CALL	UP6
  5811'   62             C      	LD	H,D	;ADRESSE ---->HL
  5812'   CD 5863'       C      	CALL	UP6
  5815'   6A             C      	LD	L,D
  5816'   C5             C      	PUSH	BC
  5817'   E5             C      	PUSH	HL
  5818'   21 2B26'       C      	LD	HL,UB.PATAB
  581B'   4E             C      	LD	C,(HL)	;BEGINN(LADE)ADRESSE--->BC
  581C'   23             C      	INC	HL
  581D'   46             C      	LD	B,(HL)
  581E'   E1             C      	POP	HL
  581F'   09             C      	ADD	HL,BC	;ERMITTELN SPEICHERADRESSE
  5820'   EB             C      	EX	DE,HL	;SP.ADR.--->DE
''	MACRO-80 3.44	09-Dec-81	PAGE	1-45


  5821'   C1             C      	POP	BC
  5822'   E1             C      	POP	HL
  5823'   F1             C      	POP	AF
  5824'   28 04          C      	JR	Z,M13
  5826'   CB 47          C      	BIT	0,A	;NUR L-TEIL DER ADRESSE ?
  5828'   28 10          C      	JR	Z,M14	; JA
                         C      ;********** ADRESSE IN SPEICHER EINTRAGEN *****************************
  582A'   73             C      M13:	LD	(HL),E
  582B'   F5             C      	PUSH	AF
  582C'   7B             C      	LD	A,E
  582D'   BE             C      	CP	(HL)
  582E'   C2 58AE'       C      	JP	NZ,ECHO
  5831'   F1             C      	POP	AF
  5832'   23             C      	INC	HL
  5833'   FE 03          C      	CP	003H
  5835'   28 03          C      	JR	Z,M14
  5837'   B7             C      	OR	A	;NUR H-TEIL DER ADRESSE ?
  5838'   20 08          C      	JR	NZ,M15	; JA
  583A'   72             C      M14:	LD	(HL),D
  583B'   F5             C      	PUSH	AF
  583C'   7A             C      	LD	A,D
  583D'   BE             C      	CP	(HL)
  583E'   20 6E          C      	JR	NZ,ECHO
  5840'   F1             C      	POP	AF
  5841'   23             C      	INC	HL
  5842'   CD 5863'       C      M15:	CALL	UP6
  5845'   CB 7A          C      	BIT	7,D	; TEST BEFEHLSKENNZEICHENBYTE
  5847'   20 92          C      	JR	NZ,M16
  5849'   C3 58C7'       C      	JP	BF	; NEIN--->FEHLER
                         C      ;----------------------------------------------------------------------
  584C'   CD 5863'       C      M10:	CALL	UP6	;BEI BER-BEFEHL ADDIEREN DER
  584F'   D5             C      	PUSH	DE	;DEF. BEREICHSLAENGE ZU
  5850'   CD 5863'       C      	CALL	UP6	;ADRESSE
  5853'   7A             C      	LD	A,D
  5854'   D1             C      	POP	DE
  5855'   5F             C      	LD	E,A
  5856'   19             C      	ADD	HL,DE
  5857'   CD 5863'       C      	CALL	UP6
  585A'   C3 57DB'       C      	JP	M16
  585D'   CD 5863'       C      M11:	CALL	UP6	;BEI BFL=0 SPRUNG ZUM TEST
  5860'   C3 5809'       C      	JP	M17	;ADRESSKENNZEICHENBYTE
                         C      ;******* UP ZUR ZEICHENWEISE EINGABE DER O-DATEI **********************
  5863'   CD 4B97'       C      UP6:	CALL	UK.GETK
  5866'   57             C      	LD	D,A
  5867'   0D             C      	DEC	C	;REDUZIEREN BLOCKLAENGE
  5868'   C0             C      	RET	NZ		;RET BEI UNGLEICH NULL
  5869'   A7             C      	AND	A	;IST NAECHSTE BLOCKLAENGE NULL ?
  586A'   28 04          C      	JR	Z,M21	;JA-->VERZWEIGUNG ENDEBEH
  586C'   4F             C      	LD	C,A	;NEIN-->EINTRAGEN BLKLAENGE
  586D'   0C             C      	INC	C
  586E'   18 F3          C      	JR	UP6
                         C      ;*********** ENDEBEHANDLUNG *******************************************
  5870'   D1             C      M21:	POP	DE
  5871'   E5             C      	PUSH	HL
  5872'   3E 0F          C      	LD	A,15
  5874'   32 2B00'       C      	LD	(UB.ZN),A
  5877'   21 55C8'       C      	LD	HL,UA.ZKEND+3
  587A'   11 3460        C      	LD	DE,3460H
  587D'   01 0010        C      	LD	BC,16
  5880'   ED B0          C      	LDIR
  5882'   21 2B00'       C      	LD	HL,UB.ZN
  5885'   34             C      	INC	(HL)
''	MACRO-80 3.44	09-Dec-81	PAGE	1-46


  5886'   E1             C      	POP	HL
  5887'   2B             C      	DEC	HL
  5888'   11 3470        C      	LD	DE,3470H	;HINTER AUSSCHRIFT ENDE
  588B'   CD 5254'       C      	CALL	UC.CVHLX
  588E'   21 55D8'       C      	LD	HL,UA.STADR	;STARTADRESSE ?
  5891'   CD 4A4C'       C      	CALL	UR.MIMO
  5894'   D8             C      	RET	C
  5895'   EB             C      	EX	DE,HL
  5896'   21 2B28'       C      	LD	HL,UB.PATAB+2
  5899'   CD 5298'       C      	CALL	UC.CVXA	;STARTADR.-->BINAER
  589C'   3A 3329        C      	LD	A,(UE.BWSA+329H)
  589F'   FE 53          C      	CP	'S'
  58A1'   20 04          C      	JR	NZ,$+6
  58A3'   2A 2B28'       C      	LD	HL,(UB.PATAB+2)
  58A6'   E9             C      	JP	(HL)
  58A7'   CD 49A8'       C      	CALL	UR.KRW
  58AA'   CD 49B5'       C      	CALL	UR.KRA
  58AD'   C9             C      	RET
                         C      ;---------------------------------------------------------------------
  58AE'   D1             C      ECHO:	POP	DE
  58AF'   3E 93          C      	LD	A,93H
  58B1'   18 16          C      	JR	FMELD
  58B3'   3E 91          C      DATNV:	LD	A,91H
  58B5'   18 12          C      	JR	FMELD
  58B7'   3E 96          C      OB:	LD	A,96H
  58B9'   18 0E          C      	JR	FMELD
  58BB'   3E 97          C      RA:	LD	A,97H
  58BD'   18 0A          C      	JR	FMELD
  58BF'   3E 98          C      SV:	LD	A,98H
  58C1'   18 06          C      	JR	FMELD
  58C3'   3E 99          C      MN:	LD	A,99H
  58C5'   18 02          C      	JR	FMELD
  58C7'   3E 9A          C      BF:	LD	A,9AH
  58C9'   CD 4CFE'       C      FMELD:	CALL	UF.ERANZ
  58CC'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                         C      	PAGE
''	MACRO-80 3.44	09-Dec-81	PAGE	1-47


                         C      
                         C      ;	PN	SV
                         C      ;**********************************************************************
                         C      ;
                         C      ;      Retten von Maschinencodeprogrammen als MRES - P-Datei
                         C      ;
                         C      ;**********************************************************************
  58CD'   58CD'          C      	DW	$
  58CF'   53 41 56 45    C      	DB	'SAVE'
  58D3'   3A 3327        C      	LD	A,(UE.BWSA+327H)
  58D6'   CD 515A'       C      	CALL	U1.TST
  58D9'   D8             C      	RET	C
  58DA'   CD 5074'       C      	CALL	U1.KTINI
  58DD'   DD 77 03       C      	LD	(IX+3),A
  58E0'   AF             C      	XOR	A
  58E1'   32 2B1D'       C      	LD	(UB.PAR1+1),A
  58E4'   CD 5146'       C      	CALL	U1.BILO	;BS LOESCHEN
  58E7'   CD 49A0'       C      	CALL	UR.KRE
  58EA'   DD CB 00 56    C      	BIT	2,(IX)
  58EE'   28 05          C      	JR	Z,$+7
  58F0'   3E 19          C      	LD	A,19H
  58F2'   CD 4CFE'       C      	CALL	UF.ERANZ
  58F5'   CD 49AE'       C      	CALL	UR.KRWW
  58F8'   CD 5028'       C      SV20:	CALL	U1.DSVG
  58FB'   C5             C      	PUSH	BC
  58FC'   79             C      	LD	A,C
  58FD'   32 2B1C'       C      	LD	(UB.PAR1),A	;NEXT RECORD
  5900'   3E 0D          C      	LD	A,13
  5902'   32 2B00'       C      	LD	(UB.ZN),A
  5905'   21 558C'       C      SV.DATN:	LD	HL,UA.ZKDAT	;Dateiname ?
  5908'   CD 4A4C'       C      	CALL	UR.MIMO
  590B'   D8             C      	RET	C
  590C'   C1             C      	POP	BC
  590D'   05             C      	DEC	B
  590E'   28 1A          C      	JR	Z,SV30	;NEUE KASSETTE
  5910'   CD 4BF7'       C      SV21:	CALL	UK.KBW
  5913'   CD 5059'       C      	CALL	U1.NMVGL
  5916'   38 04          C      	JR	C,DATV1	;Dateiname bereits vorhanden
  5918'   10 F6          C      	DJNZ	SV21
  591A'   18 0E          C      	JR	SV30
  591C'   3E 01          C      DATV1:	LD	A,01H
  591E'   B8             C      	CP	B
  591F'   CC 5A68'       C      	CALL	Z,DALO1
  5922'   28 0E          C      	JR	Z,SV37
  5924'   3E 92          C      DATVO:	LD	A,92H
  5926'   CD 4CFE'       C      	CALL	UF.ERANZ
  5929'   C9             C      	RET
  592A'   3E 50          C      SV30:	LD	A,'P'
  592C'   32 2B1E'       C      	LD	(UB.PAR2),A
  592F'   CD 50E3'       C      	CALL	U1.VZS
  5932'   3A 2B1D'       C      SV37:	LD	A,(UB.PAR1+1)
  5935'   FE 4C          C      	CP	'L'
  5937'   20 0B          C      	JR	NZ,SV31
  5939'   21 55EB'       C      	LD	HL,UA.ZKDL
  593C'   CD 4A4C'       C      	CALL	UR.MIMO
  593F'   7E             C      	LD	A,(HL)
  5940'   FE 4A          C      	CP	'J'
  5942'   20 E0          C      	JR	NZ,DATVO
  5944'   3A 2B1C'       C      SV31:	LD	A,(UB.PAR1)	;NEXT RECORD
  5947'   47             C      	LD	B,A
  5948'   C5             C      	PUSH	BC
''	MACRO-80 3.44	09-Dec-81	PAGE	1-48


  5949'   04             C      	INC	B
  594A'   CD 49E8'       C      	CALL	UR.POSIK
  594D'   CD 4BF7'       C      	CALL	UK.KBW
  5950'   21 0E66        C      	LD	HL,UE.PUF
  5953'   C1             C      	POP	BC
  5954'   7E             C      	LD	A,(HL)
  5955'   B8             C      	CP	B
  5956'   28 06          C      	JR	Z,SAVE3
  5958'   3E 94          C      	LD	A,94H
  595A'   CD 4CFE'       C      	CALL	UF.ERANZ
  595D'   C9             C      	RET
  595E'   21 55B2'       C      SAVE3:	LD	HL,UA.ZKBEG	;Beginn ?
  5961'   CD 4A4C'       C      	CALL	UR.MIMO
  5964'   DA 5905'       C      	JP	C,SV.DATN
  5967'   CD 5164'       C      	CALL	U1.PRADR
  596A'   38 F2          C      	JR	C,SAVE3
  596C'   EB             C      	EX	DE,HL
  596D'   21 2B1E'       C      	LD	HL,UB.PAR2
  5970'   CD 5298'       C      	CALL	UC.CVXA
  5973'   21 55C5'       C      SAVE4:	LD	HL,UA.ZKEND	;Ende ?
  5976'   CD 4A4C'       C      	CALL	UR.MIMO
  5979'   38 E3          C      	JR	C,SAVE3
  597B'   CD 5164'       C      	CALL	U1.PRADR
  597E'   38 F3          C      	JR	C,SAVE4
  5980'   EB             C      	EX	DE,HL
  5981'   21 2B20'       C      	LD	HL,UB.PAR3
  5984'   CD 5298'       C      	CALL	UC.CVXA
  5987'   CD 59D7'       C      	CALL	BYANZ
  598A'   38 D2          C      	JR	C,SAVE3
  598C'   28 D0          C      	JR	Z,SAVE3
  598E'   CD 59FC'       C      	CALL	SV.SAVE
  5991'   CD 49C7'       C      	CALL	UR.KBM
  5994'   CD 59E2'       C      	CALL	DATS1	;1.DATEISATZ SCHREIBEN
  5997'   CD 49CD'       C      	CALL	UR.KSL
  599A'   CD 49AE'       C      	CALL	UR.KRWW
  599D'   CD 5028'       C      	CALL	U1.DSVG
  59A0'   05             C      	DEC	B
  59A1'   3A 2B1D'       C      	LD	A,(UB.PAR1+1)
  59A4'   FE 4C          C      	CP	'L'
  59A6'   28 13          C      	JR	Z,SAVE5
  59A8'   21 0E67        C      	LD	HL,UE.PUF+1
  59AB'   34             C      	INC	(HL)	;NEXT RECORD+1
  59AC'   21 0E69        C      	LD	HL,UE.PUF+3
  59AF'   46             C      	LD	B,(HL)
  59B0'   34             C      	INC	(HL)	;ANZ.VERZ.EINTR.+1
  59B1'   CD 49D9'       C      SAVE6:	CALL	UR.KBR
  59B4'   DD 36 04 00    C      	LD	(IX+4),00H	;NEUEN DS-SATZ AUSGEBEN
  59B8'   CD 4CD0'       C      	CALL	UF.EXEC
  59BB'   CD 4BF7'       C      SAVE5:	CALL	UK.KBW
  59BE'   10 FB          C      	DJNZ	SAVE5
  59C0'   CD 49D9'       C      	CALL	UR.KBR
  59C3'   2A 2B24'       C      	LD	HL,(UB.PAR5)
  59C6'   22 0E7F        C      	LD	(UE.PUF+25),HL	;DATEILAENGE EINTRAGEN
  59C9'   DD 36 04 00    C      	LD	(IX+4),00H
  59CD'   CD 4CD0'       C      	CALL	UF.EXEC
  59D0'   CD 49A8'       C      	CALL	UR.KRW
  59D3'   CD 49B5'       C      	CALL	UR.KRA
  59D6'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  59D7'   2A 2B20'       C      BYANZ:	LD	HL,(UB.PAR3)	;Byteanzahl berechnen
  59DA'   ED 5B 2B1E'    C      	LD	DE,(UB.PAR2)
  59DE'   B7             C      	OR	A
''	MACRO-80 3.44	09-Dec-81	PAGE	1-49


  59DF'   ED 52          C      	SBC	HL,DE
  59E1'   C9             C      	RET
  59E2'   21 0020        C      DATS1:	LD	HL,32	;1. Dateisatz schreiben
  59E5'   CD 51C6'       C      	CALL	XY.STIDX
  59E8'   09             C      	DB	9
  59E9'   CD 5018'       C      	CALL	U1.VSX
  59EC'   21 0E66        C      	LD	HL,UE.PUF
  59EF'   3A 2B1C'       C      	LD	A,(UB.PAR1)	;NEXT RECORD
  59F2'   3C             C      	INC	A
  59F3'   77             C      	LD	(HL),A
  59F4'   DD 36 04 00    C      	LD	(IX+4),00H
  59F8'   CD 4CD0'       C      	CALL	UF.EXEC
  59FB'   C9             C      	RET
  59FC'   21 0000        C      SV.SAVE:	LD	HL,0
  59FF'   CD 51B6'       C      	CALL	XY.STDX
  5A02'   11             C      	DB	17
  5A03'   21 0080        C      	LD	HL,80H	;Blocklaenge
  5A06'   CD 51C6'       C      	CALL	XY.STIDX
  5A09'   09             C      	DB	9
  5A0A'   CD 4C60'       C      	CALL	UK.KSPFB	;Pufferbereitstellung
  5A0D'   CD 59D7'       C      SV.SAVE1:	CALL	BYANZ	;Byteanzahl berechnen
  5A10'   23             C      	INC	HL
  5A11'   E5             C      	PUSH	HL
  5A12'   7C             C      	LD	A,H
  5A13'   B5             C      	OR	L
  5A14'   E1             C      	POP	HL
  5A15'   28 13          C      	JR	Z,SVLS2	;---> 0 Byte
  5A17'   01 007D        C      	LD	BC,UE.SVL	;Satzlaenge
  5A1A'   B7             C      	OR	A
  5A1B'   ED 42          C      	SBC	HL,BC
  5A1D'   38 05          C      	JR	C,SVLS	;---> letzter Satz
  5A1F'   CD 5A73'       C      	CALL	SVSZ
  5A22'   18 E9          C      	JR	SV.SAVE1
  5A24'   7D             C      SVLS:	LD	A,L
  5A25'   C6 7D          C      	ADD	A,UE.SVL	;A:= Laenge des letzten Satzes
  5A27'   CD 5A75'       C      	CALL	SVSZ2
  5A2A'   AF             C      SVLS2:	XOR	A
  5A2B'   CD 4C3C'       C      	CALL	UK.PUTK
  5A2E'   21 55D8'       C      	LD	HL,UA.STADR	;Startadresse
  5A31'   CD 4A4C'       C      	CALL	UR.MIMO
  5A34'   7E             C      	LD	A,(HL)
  5A35'   FE 20          C      	CP	' '
  5A37'   28 27          C      	JR	Z,STAD0	;KEINE EINGABE (0000)
  5A39'   EB             C      	EX	DE,HL
  5A3A'   21 2B22'       C      	LD	HL,UB.PAR4
  5A3D'   CD 5298'       C      	CALL	UC.CVXA
  5A40'   2A 2B22'       C      SVLS1:	LD	HL,(UB.PAR4)
  5A43'   7C             C      	LD	A,H	;Startadresse ausgeben
  5A44'   CD 4C3C'       C      	CALL	UK.PUTK
  5A47'   7D             C      	LD	A,L
  5A48'   CD 4C3C'       C      	CALL	UK.PUTK
  5A4B'   0E 03          C      	LD	C,3
  5A4D'   06 80          C      SVEN2:	LD	B,80H
  5A4F'   AF             C      	XOR	A
  5A50'   CD 4C3C'       C      SVEN1:	CALL	UK.PUTK
  5A53'   10 FB          C      	DJNZ	SVEN1
  5A55'   0D             C      	DEC	C
  5A56'   20 F5          C      	JR	NZ,SVEN2
  5A58'   CD 5196'       C      	CALL	XY.LDDX
  5A5B'   11             C      	DB	17
  5A5C'   22 2B24'       C      	LD	(UB.PAR5),HL
  5A5F'   C9             C      	RET
''	MACRO-80 3.44	09-Dec-81	PAGE	1-50


  5A60'   21 0000        C      STAD0:	LD	HL,0
  5A63'   22 2B22'       C      	LD	(UB.PAR4),HL
  5A66'   18 D8          C      	JR	SVLS1
  5A68'   F5             C      DALO1:	PUSH	AF
  5A69'   21 2B1C'       C      	LD	HL,UB.PAR1
  5A6C'   35             C      	DEC	(HL)
  5A6D'   23             C      	INC	HL
  5A6E'   3E 4C          C      	LD	A,'L'
  5A70'   77             C      	LD	(HL),A
  5A71'   F1             C      	POP	AF
  5A72'   C9             C      	RET
  5A73'   3E 7D          C      SVSZ:	LD	A,UE.SVL
  5A75'   F5             C      SVSZ2:	PUSH	AF
  5A76'   CD 4C3C'       C      	CALL	UK.PUTK
  5A79'   ED 5B 2B1E'    C      	LD	DE,(UB.PAR2)
  5A7D'   7A             C      	LD	A,D
  5A7E'   CD 4C3C'       C      	CALL	UK.PUTK
  5A81'   7B             C      	LD	A,E
  5A82'   CD 4C3C'       C      	CALL	UK.PUTK
  5A85'   F1             C      	POP	AF
  5A86'   47             C      	LD	B,A
  5A87'   1A             C      SVSZ1:	LD	A,(DE)
  5A88'   CD 4C3C'       C      	CALL	UK.PUTK
  5A8B'   13             C      	INC	DE
  5A8C'   10 F9          C      	DJNZ	SVSZ1
  5A8E'   ED 53 2B1E'    C      	LD	(UB.PAR2),DE
  5A92'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                         C      	PAGE
''	MACRO-80 3.44	09-Dec-81	PAGE	1-51


                         C      
                         C      ;	PN	KR
                         C      ;---------------------------------------------------------------------
                         C      ;        Kassettengrundroutinen
                         C      ;---------------------------------------------------------------------
  5A93'   DD 36 05 A1'   C      KR.KARO:	LD	(IX+5),LOW(EINTR)	;Wiedereintrittspunkt
  5A97'   DD 36 06 5A'   C      	LD	(IX+6),HIGH(EINTR)
  5A9B'   CD 4000        C      	CALL	UE.BRKMB	;AUFRUF PHYS.KASS.ROUTINE
  5A9E'   76             C      	HALT
  5A9F'   18 FD          C      	JR	$-1
  5AA1'   33             C      EINTR:	INC	SP
  5AA2'   33             C      	INC	SP
  5AA3'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  5AA4'   5AA4'          C      	DW	$
  5AA6'   4B 32 52 45    C      	DB	'K2RE'
  5AAA'   3E 02          C      GR2:	LD	A,02H
  5AAC'   18 08          C      	JR	$+10
  5AAE'   5AAE'          C      	DW	$
  5AB0'   4B 31 52 45    C      	DB	'K1RE'
  5AB4'   3E 01          C      GR1:	LD	A,01H
  5AB6'   CD 5074'       C      	CALL	U1.KTINI
  5AB9'   DD 77 03       C      	LD	(IX+3),A
  5ABC'   CD 49A0'       C      	CALL	UR.KRE
  5ABF'   C9             C      	RET
                         C      ;-------------------------------------------------------------------
  5AC0'   5AC0'          C      	DW	$
  5AC2'   4B 31 4C 2B    C      	DB	'K1L+'
  5AC6'   CD 5AB4'       C      	CALL	GR1
  5AC9'   18 09          C      	JR	$+11
  5ACB'   5ACB'          C      	DW	$
  5ACD'   4B 32 4C 2B    C      	DB	'K2L+'
  5AD1'   CD 5AAA'       C      	CALL	GR2
  5AD4'   21 0001        C      	LD	HL,1
  5AD7'   CD 51C6'       C      	CALL	XY.STIDX
  5ADA'   09             C      	DB	9
  5ADB'   CD 49BB'       C      	CALL	UR.KLV
  5ADE'   C9             C      	RET
                         C      ;---------------------------------------------------------------------
  5ADF'   5ADF'          C      	DW	$
  5AE1'   4B 31 4C 2D    C      	DB	'K1L-'
  5AE5'   CD 5AB4'       C      	CALL	GR1
  5AE8'   18 09          C      	JR	$+11
  5AEA'   5AEA'          C      	DW	$
  5AEC'   4B 32 4C 2D    C      	DB	'K2L-'
  5AF0'   CD 5AAA'       C      	CALL	GR2
  5AF3'   21 0001        C      	LD	HL,1
  5AF6'   CD 51C6'       C      	CALL	XY.STIDX
  5AF9'   09             C      	DB	9
  5AFA'   CD 49C1'       C      	CALL	UR.KLR
  5AFD'   C9             C      	RET
                         C      ;---------------------------------------------------------------------
  5AFE'   5AFE'          C      	DW	$
  5B00'   4B 31 52 2B    C      	DB	'K1R+'
  5B04'   CD 5AB4'       C      	CALL	GR1
  5B07'   18 09          C      	JR	$+11
  5B09'   5B09'          C      	DW	$
  5B0B'   4B 32 52 2B    C      	DB	'K2R+'
  5B0F'   CD 5AAA'       C      	CALL	GR2
  5B12'   CD 49D3'       C      	CALL	UR.KBV
  5B15'   C9             C      	RET
''	MACRO-80 3.44	09-Dec-81	PAGE	1-52


                         C      ;--------------------------------------------------------------------
  5B16'   5B16'          C      	DW	$
  5B18'   4B 31 52 2D    C      	DB	'K1R-'
  5B1C'   CD 5AB4'       C      	CALL	GR1
  5B1F'   18 09          C      	JR	$+11
  5B21'   5B21'          C      	DW	$
  5B23'   4B 32 52 2D    C      	DB	'K2R-'
  5B27'   CD 5AAA'       C      	CALL	GR2
  5B2A'   CD 49D9'       C      	CALL	UR.KBR
  5B2D'   C9             C      	RET
                         C      ;--------------------------------------------------------------------
  5B2E'   5B2E'          C      	DW	$
  5B30'   4B 31 52 57    C      	DB	'K1RW'
  5B34'   CD 5AB4'       C      	CALL	GR1
  5B37'   18 09          C      	JR	$+11
  5B39'   5B39'          C      	DW	$
  5B3B'   4B 32 52 57    C      	DB	'K2RW'
  5B3F'   CD 5AAA'       C      	CALL	GR2
  5B42'   CD 49A8'       C      	CALL	UR.KRW
  5B45'   18 14          C      	JR	CKRA
                         C      ;---------------------------------------------------------------------
  5B47'   5B47'          C      	DW	$
  5B49'   4B 31 52 41    C      	DB	'K1RA'
  5B4D'   CD 5AB4'       C      	CALL	GR1
  5B50'   18 09          C      	JR	$+11
  5B52'   5B52'          C      	DW	$
  5B54'   4B 32 52 41    C      	DB	'K2RA'
  5B58'   CD 5AAA'       C      	CALL	GR2
  5B5B'   CD 49B5'       C      CKRA:	CALL	UR.KRA
  5B5E'   C9             C      	RET
                         C      ;---------------------------------------------------------------------
  5B5F'   11 3327        C      VORSP:	LD	DE,UE.BWSA+327H
  5B62'   CD 52F4'       C      	CALL	UC.CVDB
  5B65'   45             C      	LD	B,L
  5B66'   3E 46          C      	LD	A,'F'
  5B68'   32 2B1E'       C      	LD	(UB.PAR2),A
  5B6B'   CD 49A0'       C      	CALL	UR.KRE
  5B6E'   CD 49E8'       C      	CALL	UR.POSIK
  5B71'   C9             C      	RET
                         C      ;---------------------------------------------------------------------
  5B72'   5B72'          C      	DW	$
  5B74'   58 4B 41 31    C      	DB	'XKA1'
  5B78'   CD 5AB4'       C      	CALL	GR1
  5B7B'   18 09          C      	JR	$+11
  5B7D'   5B7D'          C      	DW	$
  5B7F'   58 4B 41 32    C      	DB	'XKA2'
  5B83'   CD 5AAA'       C      	CALL	GR2
  5B86'   CD 5B5F'       C      	CALL	VORSP
  5B89'   CD 5C4E'       C      	CALL	FD.FDINP
  5B8C'   CD 49A8'       C      	CALL	UR.KRW
  5B8F'   CD 49B5'       C      	CALL	UR.KRA
  5B92'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  5B93'   5B93'          C      	DW	$
  5B95'   59 4B 41 31    C      	DB	'YKA1'
  5B99'   CD 5AB4'       C      	CALL	GR1
  5B9C'   18 09          C      	JR	$+11
  5B9E'   5B9E'          C      	DW	$
  5BA0'   59 4B 41 32    C      	DB	'YKA2'
  5BA4'   CD 5AAA'       C      	CALL	GR2
  5BA7'   CD 49A0'       C      	CALL	UR.KRE
  5BAA'   11 3327        C      	LD	DE,UE.BWSA+327H
''	MACRO-80 3.44	09-Dec-81	PAGE	1-53


  5BAD'   CD 52F4'       C      	CALL	UC.CVDB
  5BB0'   2D             C      	DEC	L
  5BB1'   28 09          C      	JR	Z,$+11
  5BB3'   DD 75 0A       C      	LD	(IX+10),L
  5BB6'   CD 5BE3'       C      	CALL	TYPT
  5BB9'   CD 49BB'       C      	CALL	UR.KLV
  5BBC'   CD 5CA1'       C      	CALL	FD.FDOUT
  5BBF'   C9             C      	RET
                         C      ;---------------------------------------------------------------------------
  5BC0'   5BC0'          C      	DW	$
  5BC2'   4B 31 43 4C    C      	DB	'K1CL'
  5BC6'   CD 5AB4'       C      	CALL	GR1
  5BC9'   18 09          C      	JR	$+11
  5BCB'   5BCB'          C      	DW	$
  5BCD'   4B 32 43 4C    C      	DB	'K2CL'
  5BD1'   CD 5AAA'       C      	CALL	GR2
  5BD4'   CD 49C7'       C      	CALL	UR.KBM
  5BD7'   CD 49CD'       C      	CALL	UR.KSL
  5BDA'   CD 49A8'       C      	CALL	UR.KRW
  5BDD'   CD 49B5'       C      	CALL	UR.KRA
  5BE0'   C3 000B        C      	JP	UE.SYSTB
                         C      ;--------------------------------------------------------------------
  5BE3'   13             C      TYPT:	INC	DE
  5BE4'   1A             C      	LD	A,(DE)
  5BE5'   32 2B1E'       C      	LD	(UB.PAR2),A
  5BE8'   C9             C      	RET
                         C      ;--------------------------------------------------------------------
                         C      ;	END
                         C      	PAGE
''	MACRO-80 3.44	09-Dec-81	PAGE	1-54


                         C      
                         C      ;	PN	FD
                         C      ;**********************************************************************
                         C      ;
                         C      ;      Ein-/Ausgabe von Dateien im freien Format in bzw. aus demEditor-
                         C      ;      raum von bzw. auf MRES-Kassetten
                         C      ;
                         C      ;**********************************************************************
                         C      ;      Positionieren auf Datei, IN: <C>:= Labelnummer
                         C      ;
  5BE9'   C5             C      POSK:	PUSH	BC
  5BEA'   41             C      	LD	B,C
  5BEB'   04             C      	INC	B
  5BEC'   CD 49E8'       C      	CALL	UR.POSIK
  5BEF'   CD 6927'       C      	CALL	KO.KO01
  5BF2'   3A 0E66        C      	LD	A,(UE.PUF)
  5BF5'   B9             C      	CP	C
  5BF6'   C1             C      	POP	BC
  5BF7'   20 01          C      	JR	NZ,$+3
  5BF9'   C9             C      	RET
  5BFA'   D1             C      	POP	DE
  5BFB'   3E 94          C      	LD	A,94H
  5BFD'   CD 4CFE'       C      	CALL	UF.ERANZ
  5C00'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;      Datei im Verzeichnis suchen
                         C      ;      HL:= Dateiname, <B>:= Anzahl Verzeichniseintragungen + 1
                         C      ;      <D>:= Dateityp
                         C      ;      O:  CY:= 0 Datei nicht vorhanden, <C> unveraendert
                         C      ;          CY:= 1 <C>:= Labelnummer
                         C      ;      K:  B
  5C01'   D5             C      DASU:	PUSH	DE
  5C02'   05             C      	DEC	B
  5C03'   28 0A          C      	JR	Z,$+12
  5C05'   CD 6927'       C      	CALL	KO.KO01
  5C08'   CD 5059'       C      	CALL	U1.NMVGL
  5C0B'   38 05          C      	JR	C,$+7
  5C0D'   10 F6          C      	DJNZ	$-8
  5C0F'   B7             C      	OR	A
  5C10'   D1             C      	POP	DE
  5C11'   C9             C      	RET
  5C12'   5F             C      	LD	E,A
  5C13'   3A 0E6C        C      	LD	A,(UE.PUF+6)
  5C16'   BA             C      	CP	D
  5C17'   20 F4          C      	JR	NZ,$-10
  5C19'   4B             C      	LD	C,E
  5C1A'   37             C      	SCF
  5C1B'   18 F3          C      	JR	$-11
                         C      ;----------------------------------------------------------------------
                         C      ;      Reservebloecke schreiben
                         C      ;
  5C1D'   C5             C      WRRES:	PUSH	BC
  5C1E'   D5             C      	PUSH	DE
  5C1F'   E5             C      	PUSH	HL
  5C20'   21 5609'       C      	LD	HL,UA.ZKRES
  5C23'   CD 4A4C'       C      	CALL	UR.MIMO
  5C26'   EB             C      	EX	DE,HL
  5C27'   CD 52F4'       C      	CALL	UC.CVDB
  5C2A'   7C             C      	LD	A,H
  5C2B'   B5             C      	OR	L
  5C2C'   20 04          C      	JR	NZ,$+6
''	MACRO-80 3.44	09-Dec-81	PAGE	1-55


  5C2E'   E1             C      	POP	HL
  5C2F'   D1             C      	POP	DE
  5C30'   C1             C      	POP	BC
  5C31'   C9             C      	RET
  5C32'   E5             C      	PUSH	HL
  5C33'   21 0E66        C      	LD	HL,UE.PUF
  5C36'   01 0090        C      	LD	BC,90H
  5C39'   CD 4F9B'       C      	CALL	U1.CLRB
  5C3C'   21 0080        C      	LD	HL,80H
  5C3F'   CD 51C6'       C      	CALL	XY.STIDX
  5C42'   09             C      	DB	9
  5C43'   E1             C      	POP	HL
  5C44'   CD 4C85'       C      	CALL	UK.KBA
  5C47'   2B             C      	DEC	HL
  5C48'   7C             C      	LD	A,H
  5C49'   B5             C      	OR	L
  5C4A'   20 E6          C      	JR	NZ,$-24
  5C4C'   18 E0          C      	JR	$-30
                         C      ;----------------------------------------------------------------------
                         C      ;      F/S - Datei in den Editorraum einlesen
                         C      ;
  5C4E'   21 0000        C      FD.FDINP:	LD	HL,0
  5C51'   CD 51B6'       C      	CALL	XY.STDX
  5C54'   11             C      	DB	17
  5C55'   CD 4BD4'       C      	CALL	UK.KLPFB	;Pufferbereitstellung
  5C58'   21 3328        C      	LD	HL,UE.BWSA+328H
  5C5B'   06 05          C      	LD	B,5
  5C5D'   7E             C      	LD	A,(HL)
  5C5E'   FE 45          C      	CP	'E'
  5C60'   28 05          C      	JR	Z,$+7
  5C62'   23             C      	INC	HL
  5C63'   10 F8          C      	DJNZ	$-6
  5C65'   18 05          C      	JR	$+7
  5C67'   2A 0DC4        C      	LD	HL,(UE.EDEND)
  5C6A'   18 03          C      	JR	$+5
  5C6C'   21 8830        C      	LD	HL,UE.TEXAN
  5C6F'   D9             C      	EXX
  5C70'   CD 5F1C'       C      	CALL	DC.INIT	;Dekomprimierung initialisieren
  5C73'   D9             C      	EXX
  5C74'   3A 2B1E'       C      	LD	A,(UB.PAR2)	;Dateitypmerker
  5C77'   FE 53          C      	CP	'S'
  5C79'   F5             C      	PUSH	AF
  5C7A'   CC 5C95'       C      	CALL	Z,SDIN	;Zeicheneingabe S- Datei
  5C7D'   77             C      	LD	(HL),A
  5C7E'   B7             C      	OR	A
  5C7F'   28 12          C      	JR	Z,$+20
  5C81'   F1             C      	POP	AF
  5C82'   28 07          C      	JR	Z,$+9
  5C84'   C4 4B97'       C      	CALL	NZ,UK.GETK	;Zeicheneingabe F- Datei
  5C87'   77             C      	LD	(HL),A	;Zeichen in Speicher eintragen
  5C88'   BE             C      	CP	(HL)	;Echolesen
  5C89'   20 10          C      	JR	NZ,$+18
  5C8B'   B7             C      	OR	A	;<A>:= 0, Z:= 1
  5C8C'   C8             C      	RET	Z
  5C8D'   23             C      	INC	HL	;HL:= HL + 1
  5C8E'   22 0DC4        C      	LD	(UE.EDEND),HL	;Textende
  5C91'   18 E1          C      	JR	$-29
  5C93'   F1             C      	POP	AF
  5C94'   C9             C      	RET
  5C95'   D9             C      SDIN:	EXX
  5C96'   CD 5EE1'       C      	CALL	DC.DCMPR
  5C99'   D9             C      	EXX
''	MACRO-80 3.44	09-Dec-81	PAGE	1-56


  5C9A'   C9             C      	RET
  5C9B'   3E 93          C      	LD	A,93H	;Fehlerschluessel
  5C9D'   CD 4CFE'       C      	CALL	UF.ERANZ
  5CA0'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;      Ausgabe einer F/S - Datei (neuer Bestand)
                         C      ;
  5CA1'   21 0000        C      FD.FDOUT:	LD	HL,0	;Blockzaehler loeschen
  5CA4'   CD 51B6'       C      	CALL	XY.STDX
  5CA7'   11             C      	DB	17
  5CA8'   21 0080        C      	LD	HL,80H	;Blocklaenge eintragen
  5CAB'   CD 51C6'       C      	CALL	XY.STIDX
  5CAE'   09             C      	DB	9
  5CAF'   CD 4C60'       C      	CALL	UK.KSPFB	;Pufferbereitstellung
  5CB2'   21 8830        C      	LD	HL,UE.TEXAN	;HL:= Textanfang
  5CB5'   ED 5B 0DC4     C      	LD	DE,(UE.EDEND)	;BC:= Textende
  5CB9'   D9             C      	EXX
  5CBA'   CD 5F85'       C      	CALL	CP.INIT
  5CBD'   D9             C      	EXX
  5CBE'   B7             C      	OR	A	;CY:= 0
  5CBF'   E5             C      	PUSH	HL
  5CC0'   ED 52          C      	SBC	HL,DE
  5CC2'   30 13          C      	JR	NC,$+21
  5CC4'   E1             C      	POP	HL
  5CC5'   3A 2B1E'       C      	LD	A,(UB.PAR2)
  5CC8'   FE 53          C      	CP	'S'
  5CCA'   F5             C      	PUSH	AF
  5CCB'   7E             C      	LD	A,(HL)
  5CCC'   CC 5CEF'       C      	CALL	Z,SDOUT
  5CCF'   F1             C      	POP	AF
  5CD0'   7E             C      	LD	A,(HL)
  5CD1'   C4 4C3C'       C      	CALL	NZ,UK.PUTK
  5CD4'   23             C      	INC	HL
  5CD5'   18 E7          C      	JR	$-23
  5CD7'   E1             C      	POP	HL	;Endebehandlung
  5CD8'   01 0120        C      	LD	BC,288
  5CDB'   AF             C      	XOR	A
  5CDC'   CD 4C3C'       C      	CALL	UK.PUTK
  5CDF'   0B             C      	DEC	BC
  5CE0'   78             C      	LD	A,B
  5CE1'   B1             C      	OR	C
  5CE2'   20 F7          C      	JR	NZ,$-7
  5CE4'   CD 5EB3'       C      	CALL	DSPBB
  5CE7'   CD 5C1D'       C      	CALL	WRRES	;Reservebloecke schreiben
  5CEA'   CD 5196'       C      	CALL	XY.LDDX	;HL:= Blockzaehler
  5CED'   11             C      	DB	17
  5CEE'   C9             C      	RET
  5CEF'   D9             C      SDOUT:	EXX
  5CF0'   CD 5F22'       C      	CALL	CP.COMPR
  5CF3'   D9             C      	EXX
  5CF4'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;      Ausgabe einer F/S - Datei (alter Bestand)
                         C      ;
  5CF5'   21 0000        C      FDOWR:	LD	HL,0
  5CF8'   CD 51B6'       C      	CALL	XY.STDX
  5CFB'   11             C      	DB	17
  5CFC'   21 8830        C      	LD	HL,UE.TEXAN
  5CFF'   D9             C      	EXX
  5D00'   CD 5F85'       C      	CALL	CP.INIT
  5D03'   D9             C      	EXX
  5D04'   E5             C      	PUSH	HL
''	MACRO-80 3.44	09-Dec-81	PAGE	1-57


  5D05'   CD 5D45'       C      FDOW1:	CALL	FDUP
  5D08'   E1             C      	POP	HL
  5D09'   E5             C      FDOW2:	PUSH	HL
  5D0A'   ED 5B 0DC4     C      	LD	DE,(UE.EDEND)
  5D0E'   B7             C      	OR	A
  5D0F'   ED 52          C      	SBC	HL,DE
  5D11'   30 1B          C      	JR	NC,FDOW3
  5D13'   E1             C      	POP	HL
  5D14'   3A 2B1E'       C      	LD	A,(UB.PAR2)
  5D17'   FE 53          C      	CP	'S'
  5D19'   7E             C      	LD	A,(HL)
  5D1A'   28 42          C      	JR	Z,SDOW
  5D1C'   CD 4C3C'       C      	CALL	UK.PUTK
  5D1F'   0B             C      	DEC	BC
  5D20'   23             C      FDOW4:	INC	HL
  5D21'   78             C      	LD	A,B
  5D22'   B1             C      	OR	C
  5D23'   20 E4          C      	JR	NZ,FDOW2
  5D25'   CD 4C85'       C      	CALL	UK.KBA	;Block schreiben
  5D28'   E5             C      	PUSH	HL
  5D29'   CD 5D3B'       C      	CALL	FD.DECBZ
  5D2C'   18 D7          C      	JR	FDOW1
  5D2E'   E1             C      FDOW3:	POP	HL
  5D2F'   AF             C      	XOR	A	;Endekennzeichen 00H 
  5D30'   CD 4C3C'       C      	CALL	UK.PUTK
  5D33'   CD 4C85'       C      	CALL	UK.KBA
  5D36'   CD 5D3B'       C      	CALL	FD.DECBZ
  5D39'   B7             C      	OR	A
  5D3A'   C9             C      	RET
  5D3B'   CD 5196'       C      FD.DECBZ:	CALL	XY.LDDX
  5D3E'   11             C      	DB	17
  5D3F'   2B             C      	DEC	HL
  5D40'   CD 51B6'       C      	CALL	XY.STDX
  5D43'   11             C      	DB	17
  5D44'   C9             C      	RET
  5D45'   CD 4BF7'       C      FDUP:	CALL	UK.KBW
  5D48'   DD 7E 09       C      	LD	A,(IX+9)
  5D4B'   DD B6 0A       C      	OR	(IX+10)
  5D4E'   CA 5ED9'       C      	JP	Z,BMGF
  5D51'   CD 49D9'       C      	CALL	UR.KBR
  5D54'   CD 51A6'       C      	CALL	XY.LIDX
  5D57'   09             C      	DB	9
  5D58'   E5             C      	PUSH	HL
  5D59'   C1             C      	POP	BC
  5D5A'   CD 4C60'       C      	CALL	UK.KSPFB
  5D5D'   C9             C      	RET
  5D5E'   CD 5CEF'       C      SDOW:	CALL	SDOUT
  5D61'   78             C      	LD	A,B
  5D62'   A1             C      	AND	C
  5D63'   FE FF          C      	CP	0FFH
  5D65'   28 1B          C      	JR	Z,SDK1
  5D67'   FE FE          C      	CP	0FEH
  5D69'   28 03          C      	JR	Z,SDK2
  5D6B'   C3 5D20'       C      	JP	FDOW4
  5D6E'   EB             C      SDK2:	EX	DE,HL
  5D6F'   CD 5D45'       C      	CALL	FDUP
  5D72'   3E 09          C      	LD	A,09H
  5D74'   CD 4C3C'       C      	CALL	UK.PUTK
  5D77'   0B             C      	DEC	BC
  5D78'   3E 3B          C      SDK0:	LD	A,';'
  5D7A'   CD 4C3C'       C      	CALL	UK.PUTK
  5D7D'   0B             C      	DEC	BC
''	MACRO-80 3.44	09-Dec-81	PAGE	1-58


  5D7E'   EB             C      	EX	DE,HL
  5D7F'   C3 5D20'       C      	JP	FDOW4
  5D82'   EB             C      SDK1:	EX	DE,HL
  5D83'   CD 5D45'       C      	CALL	FDUP
  5D86'   18 F0          C      	JR	SDK0
                         C      ;--------------------------------------------------------------
                         C      ;        Startroutine Ein-/Ausgabe
                         C      ;
  5D88'   CD 5146'       C      FSTRT:	CALL	U1.BILO
  5D8B'   CD 5074'       C      	CALL	U1.KTINI
  5D8E'   3A 3326        C      	LD	A,(UE.BWSA+326H)
  5D91'   CD 515A'       C      	CALL	U1.TST
  5D94'   DA 5DC0'       C      	JP	C,STRT1
  5D97'   DD 77 03       C      	LD	(IX+3),A
  5D9A'   CD 49A0'       C      	CALL	UR.KRE
  5D9D'   CD 49AE'       C      	CALL	UR.KRWW
  5DA0'   CD 5028'       C      	CALL	U1.DSVG
  5DA3'   3E 0E          C      	LD	A,14
  5DA5'   32 2B00'       C      	LD	(UB.ZN),A
  5DA8'   3A 3328        C      	LD	A,(UE.BWSA+328H)
  5DAB'   FE 53          C      	CP	'S'
  5DAD'   28 02          C      	JR	Z,$+4
  5DAF'   3E 46          C      	LD	A,'F'
  5DB1'   57             C      	LD	D,A
  5DB2'   32 2B1E'       C      	LD	(UB.PAR2),A
  5DB5'   21 561C'       C      	LD	HL,UA.ZKSDT
  5DB8'   28 03          C      	JR	Z,$+5
  5DBA'   21 558C'       C      	LD	HL,UA.ZKDAT
  5DBD'   CD 4A4C'       C      	CALL	UR.MIMO
  5DC0'   FD E1          C      STRT1:	POP	IY
  5DC2'   D8             C      	RET	C
  5DC3'   FD E5          C      	PUSH	IY
  5DC5'   3E 53          C      	LD	A,'S'
  5DC7'   BA             C      	CP	D
  5DC8'   CC 5DF3'       C      	CALL	Z,DECHL
  5DCB'   CD 5C01'       C      	CALL	DASU
  5DCE'   DC 5DD5'       C      	CALL	C,SETJ
  5DD1'   D4 5DED'       C      	CALL	NC,SETN
  5DD4'   C9             C      	RET
  5DD5'   C5             C      SETJ:	PUSH	BC
  5DD6'   D5             C      	PUSH	DE
  5DD7'   E5             C      	PUSH	HL
  5DD8'   EB             C      	EX	DE,HL
  5DD9'   06 08          C      	LD	B,8
  5DDB'   13             C      	INC	DE
  5DDC'   10 FD          C      	DJNZ	$-1
  5DDE'   21 0E6E        C      	LD	HL,UE.PUF+8
  5DE1'   01 0006        C      	LD	BC,6
  5DE4'   ED B0          C      	LDIR
  5DE6'   E1             C      	POP	HL
  5DE7'   D1             C      	POP	DE
  5DE8'   C1             C      	POP	BC
  5DE9'   3E 4A          C      	LD	A,'J'
  5DEB'   18 02          C      	JR	$+4
  5DED'   3E 4E          C      SETN:	LD	A,'N'
  5DEF'   32 2B1C'       C      	LD	(UB.PAR1),A
  5DF2'   C9             C      	RET
  5DF3'   2B             C      DECHL:	DEC	HL
  5DF4'   2B             C      	DEC	HL
  5DF5'   C9             C      	RET
                         C      ;****************************************************************
                         C      ;        Ausgabeprogramm
''	MACRO-80 3.44	09-Dec-81	PAGE	1-59


                         C      ;****************************************************************
  5DF6'   5DF6'          C      	DW	$
  5DF8'   41 55 53 20    C      	DB	'AUS '
  5DFC'   CD 5D88'       C      FOUT1:	CALL	FSTRT
  5DFF'   3A 2B1C'       C      	LD	A,(UB.PAR1)
  5E02'   FE 4A          C      	CP	'J'	;DATEI SCHON VORHANDEN ?
  5E04'   CA 5E6F'       C      	JP	Z,FOLWR	;JA
                         C      ;-------------------------------NEIN--> NEUE ERSTELLEN-----------------
  5E07'   79             C      	LD	A,C	;NEXT RECORD
  5E08'   32 2B1C'       C      	LD	(UB.PAR1),A
  5E0B'   3E 7F          C      	LD	A,7FH
  5E0D'   32 2B20'       C      	LD	(UB.PAR3),A	;PARAMETER KOMMENTARABFRAGE JA
  5E10'   CD 50E3'       C      	CALL	U1.VZS	;NEUEN VERZ.SATZ SCHREIBEN
  5E13'   CD 5BE9'       C      	CALL	POSK
  5E16'   C5             C      	PUSH	BC
  5E17'   CD 5CA1'       C      	CALL	FD.FDOUT
  5E1A'   E5             C      	PUSH	HL	;BLOCKZAEHLER
  5E1B'   CD 49C7'       C      	CALL	UR.KBM
  5E1E'   21 0020        C      	LD	HL,32
  5E21'   CD 51C6'       C      	CALL	XY.STIDX
  5E24'   09             C      	DB	9
  5E25'   CD 5018'       C      	CALL	U1.VSX
  5E28'   E1             C      	POP	HL
  5E29'   C1             C      	POP	BC
  5E2A'   E5             C      	PUSH	HL
  5E2B'   79             C      	LD	A,C
  5E2C'   3C             C      	INC	A
  5E2D'   32 0E66        C      	LD	(UE.PUF),A
  5E30'   F5             C      	PUSH	AF
  5E31'   DD 36 04 00    C      	LD	(IX+4),00H
  5E35'   CD 4CD0'       C      	CALL	UF.EXEC
  5E38'   CD 49AE'       C      	CALL	UR.KRWW
  5E3B'   CD 5028'       C      	CALL	U1.DSVG
  5E3E'   CD 49D9'       C      	CALL	UR.KBR
  5E41'   F1             C      	POP	AF
  5E42'   32 0E67        C      	LD	(UE.PUF+1),A
  5E45'   78             C      	LD	A,B
  5E46'   3C             C      	INC	A
  5E47'   32 0E69        C      	LD	(UE.PUF+3),A
  5E4A'   DD 36 04 00    C      	LD	(IX+4),00H
  5E4E'   CD 4CD0'       C      	CALL	UF.EXEC
  5E51'   DD 36 04 02    C      	LD	(IX+4),02H
  5E55'   CD 4CD0'       C      	CALL	UF.EXEC
  5E58'   10 FB          C      	DJNZ	$-3
  5E5A'   CD 49D9'       C      	CALL	UR.KBR
  5E5D'   E1             C      	POP	HL
  5E5E'   22 0E7F        C      	LD	(UE.PUF+25),HL
  5E61'   DD 36 04 00    C      	LD	(IX+4),00H
  5E65'   CD 4CD0'       C      	CALL	UF.EXEC
  5E68'   CD 49A8'       C      END:	CALL	UR.KRW
  5E6B'   CD 49B5'       C      	CALL	UR.KRA
  5E6E'   C9             C      	RET
  5E6F'   21 55EB'       C      FOLWR:	LD	HL,UA.ZKDL	;DATEI UEBERSCHREIBEN?
  5E72'   CD 4A4C'       C      	CALL	UR.MIMO
  5E75'   D8             C      	RET	C
  5E76'   7E             C      	LD	A,(HL)
  5E77'   FE 4A          C      	CP	'J'
  5E79'   C0             C      	RET	NZ
  5E7A'   CD 5BE9'       C      	CALL	POSK
  5E7D'   CD 5CF5'       C      	CALL	FDOWR
  5E80'   CD 5EB3'       C      	CALL	DSPBB
  5E83'   CD 5ECD'       C      	CALL	RDEND
''	MACRO-80 3.44	09-Dec-81	PAGE	1-60


  5E86'   CD 5EC3'       C      	CALL	DSPBG
  5E89'   18 DD          C      	JR	$-33
                         C      ;**********************************************************************
                         C      ;      Eingabeprogramm
                         C      ;**********************************************************************
  5E8B'   5E8B'          C      	DW	$
  5E8D'   45 49 4E 20    C      	DB	'EIN '
  5E91'   CD 5D88'       C      FDIN2:	CALL	FSTRT
  5E94'   3A 2B1C'       C      	LD	A,(UB.PAR1)
  5E97'   FE 4A          C      	CP	'J'
  5E99'   28 07          C      	JR	Z,$+9
  5E9B'   3E 91          C      	LD	A,91H
  5E9D'   CD 4CFE'       C      	CALL	UF.ERANZ
  5EA0'   18 C6          C      	JR	END
  5EA2'   CD 5BE9'       C      	CALL	POSK
  5EA5'   CD 5C4E'       C      	CALL	FD.FDINP
  5EA8'   CD 5EB3'       C      	CALL	DSPBB
  5EAB'   CD 5ECD'       C      	CALL	RDEND
  5EAE'   CD 5EC3'       C      	CALL	DSPBG
  5EB1'   18 B5          C      	JR	END
                         C      ;----------------------------------------------------------------------
  5EB3'   CD 5196'       C      DSPBB:	CALL	XY.LDDX
  5EB6'   11             C      	DB	17
  5EB7'   EB             C      	EX	DE,HL
  5EB8'   21 5631'       C      	LD	HL,UA.ZKBEL
  5EBB'   CD 4A4C'       C      	CALL	UR.MIMO
  5EBE'   EB             C      	EX	DE,HL
  5EBF'   CD 52AB'       C      	CALL	UC.CVBD3
  5EC2'   C9             C      	RET
  5EC3'   CD 5196'       C      DSPBG:	CALL	XY.LDDX
  5EC6'   11             C      	DB	17
  5EC7'   EB             C      	EX	DE,HL
  5EC8'   21 5644'       C      	LD	HL,UA.ZKBLG
  5ECB'   18 EE          C      	JR	$-16
  5ECD'   CD 4BF7'       C      RDEND:	CALL	UK.KBW
  5ED0'   DD 7E 09       C      	LD	A,(IX+9)
  5ED3'   DD B6 0A       C      	OR	(IX+10)
  5ED6'   C8             C      	RET	Z
  5ED7'   18 F4          C      	JR	RDEND
  5ED9'   3E 95          C      BMGF:	LD	A,95H
  5EDB'   CD 4CFE'       C      	CALL	UF.ERANZ
  5EDE'   D1             C      	POP	DE
  5EDF'   D1             C      	POP	DE
  5EE0'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                         C      	PAGE
''	MACRO-80 3.44	09-Dec-81	PAGE	1-61


                         C      
                         C      ;	PN	DC
                         C      ;**********************************************************************
                         C      ;*       DCMPR:    Dekomprimierung                                    *
                         C      ;*                 MRES20-Quelltexte   --->   EDIT - Format F         *
                         C      ;**********************************************************************
                         C      			;
  5EE1'                  C      DC.DCMPR	EQU	$
                         C      			; A:  Uebergabe/-nahme Zeichen
                         C      			; HL: Status-Register DCMPR
                         C      			; B:  Position (Spalte)
                         C      			;-------------------------------
                         C      			; INA: Einzelzeichen-Eingabe
                         C      			;      nach Reg. A
                         C      ;        --------------------------------------------------------------
  5EE1'   04             C      	INC	B	;         Position + 1
  5EE2'   E9             C      	JP	(HL)
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      			; Status "Neue Zeile"
                         C      			;-------------------------------
  5EE3'   CD 51D6'       C      DC.NL:	CALL	XY.INCDX	;         Satzzaehler + 1
  5EE6'   13             C      	DB	19
  5EE7'   3E 1E          C      	LD	A,1EH	;         EDIT-New-Line
  5EE9'   06 01          C      	LD	B,1	;         Pos.=1
  5EEB'   21 5EEF'       C      	LD	HL,DC.TEXT	;         Status "TEXT"
  5EEE'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      			; Status "Text"
                         C      			;-------------------------------
  5EEF'   CD 4B97'       C      DC.TEXT:	CALL	UK.GETK	;         Einzelzeichen-Eingabe
  5EF2'   B7             C      	OR	A
  5EF3'   C8             C      	RET	Z
  5EF4'   FE 0A          C      	CP	0AH	;         NL ?
  5EF6'   28 EB          C      	JR	Z,DC.NL
  5EF8'   FE 09          C      	CP	09H	;         TAB ?
  5EFA'   28 01          C      	JR	Z,DC.TAB
  5EFC'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      			; Tabulator-Behandlung
                         C      			;-------------------------------
  5EFD'   78             C      DC.TAB:	LD	A,B
  5EFE'   FE 28          C      	CP	40
  5F00'   D0             C      	RET	NC
  5F01'   21 5F07'       C      	LD	HL,DC.SPACE	;         ---> Status "Space"
  5F04'   3E 20          C      	LD	A,' '	;         anstelle TAB Space
  5F06'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      			; Status "Space"
                         C      			;-------------------------------
  5F07'   78             C      DC.SPACE:	LD	A,B
  5F08'   FE 0B          C      	CP	10+1
  5F0A'   28 0B          C      	JR	Z,DC.EOSPC
  5F0C'   FE 11          C      	CP	16+1
  5F0E'   28 07          C      	JR	Z,DC.EOSPC
  5F10'   FE 24          C      	CP	35+1
  5F12'   28 03          C      	JR	Z,DC.EOSPC
  5F14'   3E 20          C      	LD	A,' '
''	MACRO-80 3.44	09-Dec-81	PAGE	1-62


  5F16'   C9             C      	RET
                         C      			;
  5F17'   21 5EEF'       C      DC.EOSPC:	LD	HL,DC.TEXT	; TAB-Position erreicht
  5F1A'   18 D3          C      	JR	DC.TEXT
                         C      			;
                         C      			;
                         C      ;**********************************************************************
  5F1C'   21 5EEF'       C      DC.INIT:	LD	HL,DC.TEXT	; Initialisierung
  5F1F'   06 01          C      	LD	B,1
  5F21'   C9             C      	RET
                         C      			;
                         C      ;**********************************************************************
                         C      ;	END
                         C      	PAGE
''	MACRO-80 3.44	09-Dec-81	PAGE	1-63


                         C      
                         C      ;	PN	CP
                         C      ;**********************************************************************
                         C      ;*       COMPR:    Komprimierung                                      *
                         C      ;*                 EDIT - F/Q-Format   --->  MRES20 - Quelltextformat *
                         C      ;**********************************************************************
                         C      			;
  5F22'                  C      CP.COMPR	EQU	$	; A  Uebergabe/-nahme Zeichen
                         C      			; HL: Status von COMPR
                         C      			; B:  dekr. Tabulator-Zaehler
                         C      			;-------------------------------
                         C      			; OUTA: Einzelzeichen-Ausgabe
                         C      			;         (Zeichen in Reg. A)
                         C      ;----------------------------------------------------------------------
                         C      			;
  5F22'   FE 1E          C      	CP	1EH	; NL ?
  5F24'   28 01          C      	JR	Z,CP.NL
  5F26'   E9             C      	JP	(HL)
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      			; Status "New-Line"
                         C      			;-------------------------------
  5F27'   CD 51D6'       C      CP.NL:	CALL	XY.INCDX	;         Satz-Zaehler + 1
  5F2A'   13             C      	DB	19
  5F2B'   06 03          C      	LD	B,3	;         noch 3 TAB erlaubt
  5F2D'   3E 0A          C      	LD	A,0AH	;         MRES20-NL
  5F2F'   18 04          C      	JR	CP.OUTT
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      			; Status "String"
                         C      			;-------------------------------
  5F31'   FE 27          C      CP.STRNG:	CP	27H	;         Apostroph
  5F33'   20 20          C      	JR	NZ,CP.OUT
                         C      			;
  5F35'   21 5F45'       C      CP.OUTT:	LD	HL,CP.TEXT	;         --> Status "Text"
  5F38'   18 1B          C      	JR	CP.OUT
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      			; Status "Space"
                         C      			;-------------------------------
  5F3A'   FE 20          C      CP.SPACE:	CP	' '
  5F3C'   C8             C      	RET	Z
  5F3D'   FE 09          C      	CP	09H	;         Tabulator
  5F3F'   C8             C      	RET	Z
  5F40'   21 5F45'       C      	LD	HL,CP.TEXT	;         ---> Status "Text"
  5F43'   18 08          C      	JR	CP.TEXT+8
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      			; Status "Text"
                         C      			;-------------------------------
  5F45'   FE 20          C      CP.TEXT:	CP	' '
  5F47'   28 2E          C      	JR	Z,CP.TAB
  5F49'   FE 09          C      	CP	09H	;         Tabulator
  5F4B'   28 2A          C      	JR	Z,CP.TAB
  5F4D'   FE 3B          C      	CP	';'
  5F4F'   28 0B          C      	JR	Z,CP.SOKOM
  5F51'   FE 27          C      	CP	27H	;         Apostroph
  5F53'   28 1D          C      	JR	Z,CP.SOSTR
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      			; Status "Kom"
''	MACRO-80 3.44	09-Dec-81	PAGE	1-64


                         C      			;-------------------------------
  5F55'                  C      CP.KOM	EQU	$
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      			; Einzelzeichen-Ausgabe u. Ret.
                         C      			;-------------------------------
  5F55'   CD 4C3C'       C      CP.OUT:	CALL	UK.PUTK
  5F58'   D9             C      	EXX
  5F59'   0B             C      	DEC	BC
  5F5A'   D9             C      	EXX
  5F5B'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      			; Start "Kommentar"
                         C      			;-------------------------------
  5F5C'   78             C      CP.SOKOM:	LD	A,B	;         0 oder 3 TAB vorher
  5F5D'   FE 03          C      	CP	3
  5F5F'   28 0A          C      	JR	Z,$+12
  5F61'   B7             C      	OR	A
  5F62'   28 07          C      	JR	Z,$+9	;         --+
  5F64'   3E 09          C      	LD	A,09H	;         <-+!
  5F66'   CD 5F55'       C      	CALL	CP.OUT	;           !!
  5F69'   10 F9          C      	DJNZ	$-5	;           +!
  5F6B'   3E 3B          C      	LD	A,';'	;         <--+
  5F6D'   21 5F55'       C      	LD	HL,CP.KOM
  5F70'   18 E3          C      	JR	CP.OUT
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      			; Start "String"
                         C      			;-------------------------------
  5F72'   21 5F31'       C      CP.SOSTR:	LD	HL,CP.STRNG
  5F75'   18 DE          C      	JR	CP.OUT
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      			; Tabulator-Behandlung
                         C      			;-------------------------------
  5F77'   78             C      CP.TAB:	LD	A,B
  5F78'   B7             C      	OR	A
  5F79'   3E 20          C      	LD	A,' '
  5F7B'   28 D8          C      	JR	Z,CP.OUT
  5F7D'   05             C      	DEC	B
  5F7E'   3E 09          C      	LD	A,09H	;         Tabulator MRES20
  5F80'   21 5F3A'       C      	LD	HL,CP.SPACE
  5F83'   18 D0          C      	JR	CP.OUT
                         C      			;
                         C      ;**********************************************************************
                         C      			;
  5F85'   06 03          C      CP.INIT:	LD	B,3	; Initialisierung COMPR
  5F87'   21 5F45'       C      	LD	HL,CP.TEXT
  5F8A'   C9             C      	RET
                         C      			;
                         C      ;**********************************************************************
                         C      ;	END
                         C      	PAGE
''	MACRO-80 3.44	09-Dec-81	PAGE	1-65


                         C      
                         C      ;	PN	KV
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;    ANZEIGEN UND AENDERN DES VERZEICHNISSES VON MRES KASSETTEN
                         C      ;
                         C      ;----------------------------------------------------------------------
  5F8B'   5F8B'          C      	DW	$
  5F8D'   44 49 52 20    C      	DB	'DIR '
  5F91'   3A 3326        C      	LD	A,(UE.BWSA+326H)
  5F94'   CD 515A'       C      	CALL	U1.TST
  5F97'   D8             C      	RET	C
  5F98'   CD 5074'       C      	CALL	U1.KTINI
  5F9B'   DD 77 03       C      	LD	(IX+3),A
  5F9E'   CD 5146'       C      	CALL	U1.BILO
  5FA1'   CD 49A0'       C      	CALL	UR.KRE
  5FA4'   CD 49AE'       C      	CALL	UR.KRWW
  5FA7'   CD 5028'       C      	CALL	U1.DSVG
  5FAA'   C5             C      	PUSH	BC
                         C      ;----------------------------------------------------------------------
  5FAB'   CD 4FAA'       C      	CALL	U1.KBR4	;KASS.NAME,NR.,KOMMENTAR ANZEIGEN
  5FAE'   DD 36 04 02    C      	LD	(IX+4),02H
  5FB2'   CD 4CD0'       C      	CALL	UF.EXEC
  5FB5'   21 0E6A        C      	LD	HL,UE.PUF+4
  5FB8'   11 3240        C      	LD	DE,3240H	;=8.ZEILE,16.SPALTE
  5FBB'   06 06          C      	LD	B,6
  5FBD'   CD 5343'       C      	CALL	UC.DKONV
  5FC0'   21 0E8B        C      	LD	HL,UE.PUF+37
  5FC3'   13             C      	INC	DE
  5FC4'   13             C      	INC	DE
  5FC5'   06 03          C      	LD	B,3
  5FC7'   CD 5343'       C      	CALL	UC.DKONV
  5FCA'   13             C      	INC	DE
  5FCB'   13             C      	INC	DE
  5FCC'   06 0B          C      	LD	B,11
  5FCE'   CD 5343'       C      	CALL	UC.DKONV
  5FD1'   21 3290        C      	LD	HL,3290H
  5FD4'   3E 3D          C      	LD	A,'='
  5FD6'   77             C      	LD	(HL),A
  5FD7'   E5             C      	PUSH	HL
  5FD8'   D1             C      	POP	DE
  5FD9'   13             C      	INC	DE
  5FDA'   01 0017        C      	LD	BC,23
  5FDD'   ED B0          C      	LDIR
                         C      ;----------------------------------------------------------------------
  5FDF'   06 03          C      	LD	B,3	;POSITIONIEREN VOR DS-SATZ
  5FE1'   CD 4CD0'       C      	CALL	UF.EXEC
  5FE4'   10 FB          C      	DJNZ	$-3
  5FE6'   CD 50AD'       C      	CALL	U1.VERIN
  5FE9'   CD 49AE'       C      	CALL	UR.KRWW
  5FEC'   06 07          C      	LD	B,7
  5FEE'   CD 50D7'       C      	CALL	U1.VORS1
  5FF1'   C1             C      	POP	BC
  5FF2'   05             C      	DEC	B
  5FF3'   CD 6215'       C      	CALL	ANZ
  5FF6'   04             C      	INC	B
  5FF7'   05             C      	DEC	B
  5FF8'   CA 6142'       C      	JP	Z,KRW
  5FFB'   04             C      	INC	B
  5FFC'   C5             C      	PUSH	BC
                         C      ;----------------------------------------------------------------------
''	MACRO-80 3.44	09-Dec-81	PAGE	1-66


  5FFD'   05             C      KV.ANF:	DEC	B
  5FFE'   78             C      	LD	A,B
  5FFF'   58             C      	LD	E,B
  6000'   D6 09          C      	SUB	9
  6002'   38 05          C      	JR	C,$+7
  6004'   0E 09          C      	LD	C,9
  6006'   41             C      	LD	B,C
  6007'   18 03          C      	JR	$+5
  6009'   43             C      	LD	B,E
  600A'   48             C      	LD	C,B
  600B'   AF             C      	XOR	A
  600C'   F5             C      	PUSH	AF	;A=RESTL.ANZAHL ODER 0
  600D'   C5             C      	PUSH	BC
  600E'   21 2B2A'       C      	LD	HL,UB.SATZ
  6011'   36 00          C      	LD	(HL),00H
  6013'   23             C      	INC	HL
  6014'   36 37          C      	LD	(HL),55
  6016'   23             C      	INC	HL
  6017'   36 80          C      	LD	(HL),80H
  6019'   23             C      	INC	HL
  601A'   06 37          C      	LD	B,55
  601C'   3E 20          C      	LD	A,20H
  601E'   CD 513B'       C      	CALL	U1.TR	;AUSGABESATZ LOESCHEN
  6021'   3E 0D          C      	LD	A,13
  6023'   32 2B00'       C      	LD	(UB.ZN),A
  6026'   CD 5146'       C      	CALL	U1.BILO
  6029'   11 2B3C'       C      	LD	DE,UB.SATZ+18
  602C'   D5             C      	PUSH	DE
  602D'   21 ECA2        C      	LD	HL,BC.VTABE+32	;ADR. VERZ.TABELLE
  6030'   E5             C      	PUSH	HL
                         C      ;---------------------------MAX 9 SAETZE ANZEIGEN----------------------
  6031'   CD 619D'       C      ZLTR:	CALL	BSTR	;VTABE-->UB.SATZ
  6034'   D1             C      	POP	DE	;VERZ.ADR.
  6035'   E1             C      	POP	HL	;ADR.AUSGABESATZ
  6036'   E5             C      	PUSH	HL
  6037'   D5             C      	PUSH	DE
  6038'   01 0012        C      	LD	BC,18
  603B'   B7             C      	OR	A
  603C'   ED 42          C      	SBC	HL,BC
  603E'   CD 4A4C'       C      	CALL	UR.MIMO	;ANZEIGE EINE ZEILE
  6041'   E1             C      	POP	HL	;VERZ.ADR
  6042'   D1             C      	POP	DE
  6043'   01 0020        C      	LD	BC,32
  6046'   09             C      	ADD	HL,BC
  6047'   C1             C      	POP	BC
  6048'   05             C      	DEC	B
  6049'   28 05          C      	JR	Z,$+7
  604B'   C5             C      	PUSH	BC
  604C'   D5             C      	PUSH	DE
  604D'   E5             C      	PUSH	HL	;NEUE VERZ.TAB ADR
  604E'   18 E1          C      	JR	ZLTR
                         C      ;----------------------------------------------------------------------
  6050'   41             C      	LD	B,C	;ANZAHL DER ANGEZEIGTEN ZEILEN
  6051'   3A 2B00'       C      	LD	A,(UB.ZN)
  6054'   90             C      	SUB	B
  6055'   32 2B00'       C      	LD	(UB.ZN),A	;KURSOR AUF ANFANG 12.ZEILE
  6058'   C5             C      	PUSH	BC
  6059'   D5             C      	PUSH	DE
  605A'   E5             C      	PUSH	HL
                         C      ;------------------------VERZ. ZEIGER AUF 1.ANGEZEIGTE EINTR.
  605B'   C5             C      	PUSH	BC
  605C'   01 0020        C      	LD	BC,32
''	MACRO-80 3.44	09-Dec-81	PAGE	1-67


  605F'   B7             C      	OR	A
  6060'   ED 42          C      	SBC	HL,BC
  6062'   C1             C      	POP	BC
  6063'   10 F6          C      	DJNZ	$-8
  6065'   E5             C      	PUSH	HL
                         C      ;----------------------------------------------------------------------
  6066'   21 5660'       C      TABTR:	LD	HL,UA.LD
  6069'   CD 4A4C'       C      	CALL	UR.MIMO	;KURSOR AUF ANF.12.ZEILE
  606C'   DA 60AC'       C      	JP	C,ZEIHO
  606F'   D1             C      	POP	DE
  6070'   D5             C      	PUSH	DE	;ZIELADR.IN VTAB
  6071'   CD 61CA'       C      	CALL	SPTR	;ZEILE WIEDER IN SPEICHER
  6074'   E1             C      	POP	HL	;ZIELADR.IN VTAB
  6075'   01 0020        C      	LD	BC,32
  6078'   09             C      	ADD	HL,BC
  6079'   FD E1          C      	POP	IY
  607B'   D1             C      	POP	DE
  607C'   C1             C      	POP	BC
  607D'   05             C      	DEC	B
  607E'   28 07          C      	JR	Z,$+9
  6080'   C5             C      	PUSH	BC
  6081'   D5             C      	PUSH	DE
  6082'   FD E5          C      	PUSH	IY
  6084'   E5             C      	PUSH	HL
  6085'   18 DF          C      	JR	TABTR
                         C      ;--------------------WEITERBLAETTERN ODER AUSGABE----------------------
  6087'   F1             C      	POP	AF
  6088'   B7             C      	OR	A
  6089'   28 42          C      	JR	Z,AUSG	;KEINE WEITEREN ANZEIGEN
  608B'   D6 09          C      	SUB	9
  608D'   38 05          C      	JR	C,$+7
  608F'   06 09          C      	LD	B,9
  6091'   48             C      	LD	C,B
  6092'   18 05          C      	JR	$+7
  6094'   C6 09          C      	ADD	A,9
  6096'   47             C      	LD	B,A
  6097'   48             C      	LD	C,B
  6098'   AF             C      	XOR	A
  6099'   F5             C      	PUSH	AF
  609A'   C5             C      	PUSH	BC
  609B'   D5             C      	PUSH	DE
  609C'   E5             C      	PUSH	HL
  609D'   3E 0D          C      	LD	A,13
  609F'   32 2B00'       C      	LD	(UB.ZN),A
  60A2'   CD 5146'       C      	CALL	U1.BILO
  60A5'   E1             C      	POP	HL
  60A6'   D1             C      	POP	DE
  60A7'   D5             C      	PUSH	DE
  60A8'   E5             C      	PUSH	HL
  60A9'   C3 6031'       C      	JP	ZLTR
                         C      ;----------------------------------------------------------------------
  60AC'   21 2B00'       C      ZEIHO:	LD	HL,UB.ZN
  60AF'   7E             C      	LD	A,(HL)
  60B0'   D6 0F          C      	SUB	15
  60B2'   38 15          C      	JR	C,$+23	;WENN IN 12. ZEILE SYS GEDRUECKT
  60B4'   35             C      	DEC	(HL)
  60B5'   35             C      	DEC	(HL)	;ZEILENNR.-2
  60B6'   E1             C      	POP	HL
  60B7'   01 0020        C      	LD	BC,32
  60BA'   B7             C      	OR	A
  60BB'   ED 42          C      	SBC	HL,BC	;VERZ.ZEIGER RUECKSETZEN
  60BD'   FD E1          C      	POP	IY
''	MACRO-80 3.44	09-Dec-81	PAGE	1-68


  60BF'   D1             C      	POP	DE
  60C0'   C1             C      	POP	BC
  60C1'   04             C      	INC	B
  60C2'   C5             C      	PUSH	BC
  60C3'   D5             C      	PUSH	DE
  60C4'   FD E5          C      	PUSH	IY
  60C6'   E5             C      	PUSH	HL
  60C7'   18 01          C      	JR	$+3
  60C9'   35             C      	DEC	(HL)
  60CA'   C3 6066'       C      	JP	TABTR
                         C      ;----------------------------------------------------------------------
  60CD'   E5             C      AUSG:	PUSH	HL
  60CE'   21 5672'       C      	LD	HL,UA.ZRSCH
  60D1'   CD 4A4C'       C      	CALL	UR.MIMO
  60D4'   7E             C      	LD	A,(HL)
  60D5'   E1             C      	POP	HL
  60D6'   FE 4A          C      	CP	'J'
  60D8'   28 11          C      	JR	Z,$+19
  60DA'   21 568B'       C      	LD	HL,UA.ANZWD
  60DD'   CD 4A4C'       C      	CALL	UR.MIMO
  60E0'   7E             C      	LD	A,(HL)
  60E1'   FE 4A          C      	CP	'J'
  60E3'   C1             C      	POP	BC
  60E4'   C2 6142'       C      	JP	NZ,KRW
  60E7'   C5             C      	PUSH	BC
  60E8'   C3 5FFD'       C      	JP	KV.ANF
                         C      ;--------------------------------Dateien am Ende loeschen ? ---------
  60EB'   CD 620B'       C      	CALL	SBC
  60EE'   20 34          C      	JR	NZ,$+54
  60F0'   3A EC85        C      	LD	A,(BC.VTABE+3)
  60F3'   3D             C      	DEC	A
  60F4'   5F             C      	LD	E,A
  60F5'   16 00          C      	LD	D,0
  60F7'   3E 01          C      	LD	A,1
  60F9'   82             C      	ADD	A,D
  60FA'   57             C      	LD	D,A
  60FB'   1D             C      	DEC	E
  60FC'   28 05          C      	JR	Z,$+7
  60FE'   CD 620B'       C      	CALL	SBC
  6101'   28 F4          C      	JR	Z,$-10
  6103'   C1             C      	POP	BC	;D: Anzahl zu loeschender Dateien
  6104'   79             C      	LD	A,C
  6105'   92             C      	SUB	D
  6106'   32 0E67        C      	LD	(UE.PUF+1),A	;DS-Satz korrigieren
  6109'   78             C      	LD	A,B
  610A'   92             C      	SUB	D
  610B'   32 0E69        C      	LD	(UE.PUF+3),A
  610E'   CD 49D9'       C      	CALL	UR.KBR
  6111'   CD 49D9'       C      	CALL	UR.KBR
  6114'   CD 49D3'       C      	CALL	UR.KBV
  6117'   DD 36 04 08    C      	LD	(IX+4),08H
  611B'   CD 4CD0'       C      	CALL	UF.EXEC	;und schreiben
  611E'   47             C      	LD	B,A
  611F'   05             C      	DEC	B
  6120'   28 20          C      	JR	Z,$+34
  6122'   04             C      	INC	B
  6123'   C5             C      	PUSH	BC
                         C      ;-------------------------------------Verzeichnis schreiben -----------
  6124'   C1             C      	POP	BC
  6125'   05             C      	DEC	B
  6126'   21 ECA2        C      	LD	HL,BC.VTABE+32
  6129'   C5             C      	PUSH	BC
''	MACRO-80 3.44	09-Dec-81	PAGE	1-69


  612A'   11 0E66        C      	LD	DE,UE.PUF
  612D'   01 0020        C      	LD	BC,32
  6130'   ED B0          C      	LDIR
  6132'   CD 49D3'       C      	CALL	UR.KBV
  6135'   CD 49D9'       C      	CALL	UR.KBR
  6138'   DD 36 04 08    C      	LD	(IX+4),08H	;OHNE RAW
  613C'   CD 4CD0'       C      	CALL	UF.EXEC
  613F'   C1             C      	POP	BC
  6140'   10 E7          C      	DJNZ	$-23
                         C      ;---------------------------------------------------------------------
  6142'   CD 49A8'       C      KRW:	CALL	UR.KRW
  6145'   CD 49B5'       C      	CALL	UR.KRA
  6148'   3A 3328        C      	LD	A,(UE.BWSA+328H)
  614B'   FE 44          C      	CP	'D'
  614D'   C0             C      	RET	NZ
  614E'   21 323D        C      	LD	HL,UE.BWSA+23DH
  6151'   00             C      	NOP
  6152'   CD 618E'       C      	CALL	DRU1
  6155'   21 328D        C      	LD	HL,UE.BWSA+28DH
  6158'   CD 618E'       C      	CALL	DRU1
  615B'   CD 7C00        C      	CALL	UE.PRINT
  615E'   21 2B64'       C      	LD	HL,UB.DTAB
  6161'   11 2B65'       C      	LD	DE,UB.DTAB+1
  6164'   01 0028        C      	LD	BC,40
  6167'   36 20          C      	LD	(HL),20H
  6169'   ED B0          C      	LDIR
  616B'   3A EC85        C      	LD	A,(BC.VTABE+3)
  616E'   47             C      	LD	B,A
  616F'   05             C      	DEC	B
  6170'   21 EC82        C      	LD	HL,BC.VTABE
  6173'   11 0020        C      	LD	DE,32
  6176'   C5             C      P1:	PUSH	BC
  6177'   19             C      	ADD	HL,DE
  6178'   E5             C      	PUSH	HL
  6179'   D5             C      	PUSH	DE
  617A'   11 2B64'       C      	LD	DE,UB.DTAB
  617D'   CD 619D'       C      	CALL	BSTR
  6180'   21 2B64'       C      	LD	HL,UB.DTAB
  6183'   06 28          C      	LD	B,40
  6185'   CD 6190'       C      	CALL	DRU2
  6188'   D1             C      	POP	DE
  6189'   E1             C      	POP	HL
  618A'   C1             C      	POP	BC
  618B'   10 E9          C      	DJNZ	P1
  618D'   C9             C      	RET
                         C      
  618E'   06 1E          C      DRU1:	LD	B,30
  6190'   7E             C      DRU2:	LD	A,(HL)
  6191'   23             C      	INC	HL
  6192'   CD 692E'       C      	CALL	KO.KO02
  6195'   10 F9          C      	DJNZ	DRU2
  6197'   3E 1E          C      	LD	A,1EH
  6199'   CD 7C00        C      	CALL	UE.PRINT
  619C'   C9             C      	RET
                         C      ;---------------------------------------------------------------------
  619D'   01 0006        C      BSTR:	LD	BC,6	;Aufbereitung des Verz.Satzes
  61A0'   C5             C      	PUSH	BC
  61A1'   ED B0          C      	LDIR		;Transport VTABE--->UB.SATZ
  61A3'   13             C      	INC	DE
  61A4'   13             C      	INC	DE
  61A5'   13             C      	INC	DE
  61A6'   01 0002        C      	LD	BC,2
''	MACRO-80 3.44	09-Dec-81	PAGE	1-70


  61A9'   ED B0          C      	LDIR
  61AB'   13             C      	INC	DE
  61AC'   13             C      	INC	DE
  61AD'   13             C      	INC	DE
  61AE'   C1             C      	POP	BC
  61AF'   C5             C      	PUSH	BC
  61B0'   ED B0          C      	LDIR
  61B2'   13             C      	INC	DE
  61B3'   13             C      	INC	DE
  61B4'   13             C      	INC	DE
  61B5'   C1             C      	POP	BC
  61B6'   ED B0          C      	LDIR
  61B8'   13             C      	INC	DE
  61B9'   13             C      	INC	DE
  61BA'   13             C      	INC	DE
  61BB'   01 0003        C      	LD	BC,3
  61BE'   ED B0          C      	LDIR
  61C0'   13             C      	INC	DE
  61C1'   13             C      	INC	DE
  61C2'   13             C      	INC	DE
  61C3'   6E             C      	LD	L,(HL)	;Konvertierung Labelnummer
  61C4'   26 00          C      	LD	H,0
  61C6'   CD 52AF'       C      	CALL	UC.CVBD2
  61C9'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  61CA'   7E             C      SPTR:	LD	A,(HL)
  61CB'   FE 09          C      	CP	09H	;Soll Satz geloescht werden?
  61CD'   20 02          C      	JR	NZ,$+4
  61CF'   AF             C      	XOR	A
  61D0'   77             C      	LD	(HL),A
  61D1'   01 0006        C      	LD	BC,6
  61D4'   C5             C      	PUSH	BC
  61D5'   ED B0          C      	LDIR		;Ruecktransport BWSA--->VTABE
  61D7'   23             C      	INC	HL
  61D8'   23             C      	INC	HL
  61D9'   23             C      	INC	HL
  61DA'   01 0002        C      	LD	BC,2
  61DD'   ED B0          C      	LDIR
  61DF'   23             C      	INC	HL
  61E0'   23             C      	INC	HL
  61E1'   23             C      	INC	HL
  61E2'   C1             C      	POP	BC
  61E3'   C5             C      	PUSH	BC
  61E4'   ED B0          C      	LDIR
  61E6'   23             C      	INC	HL
  61E7'   23             C      	INC	HL
  61E8'   23             C      	INC	HL
  61E9'   C1             C      	POP	BC
  61EA'   ED B0          C      	LDIR
  61EC'   23             C      	INC	HL
  61ED'   23             C      	INC	HL
  61EE'   23             C      	INC	HL
  61EF'   01 0003        C      	LD	BC,3
  61F2'   ED B0          C      	LDIR
  61F4'   23             C      	INC	HL
  61F5'   23             C      	INC	HL
  61F6'   23             C      	INC	HL
  61F7'   D5             C      	PUSH	DE
  61F8'   EB             C      	EX	DE,HL
  61F9'   CD 6200'       C      	CALL	DBCVM
  61FC'   7D             C      	LD	A,L
  61FD'   E1             C      	POP	HL
''	MACRO-80 3.44	09-Dec-81	PAGE	1-71


  61FE'   77             C      	LD	(HL),A
  61FF'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  6200'   06 02          C      DBCVM:	LD	B,2	;FELDLAENGE
  6202'   CD 52F4'       C      	CALL	UC.CVDB	;KONVERTIER. DEZI-->BINAER
  6205'   D0             C      	RET	NC		;OHNE FEHLER
  6206'   C0             C      	RET	NZ
  6207'   13             C      	INC	DE	;1.ZEICHEN WAR KEINE DEZ.ZAHL
  6208'   10 F8          C      	DJNZ	$-6
  620A'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  620B'   01 0020        C      SBC:	LD	BC,32
  620E'   B7             C      	OR	A
  620F'   ED 42          C      	SBC	HL,BC
  6211'   7E             C      	LD	A,(HL)
  6212'   FE 00          C      	CP	00H
  6214'   C9             C      	RET	
                         C      ;---------------------------------------------------------------------
  6215'   C5             C      ANZ:	PUSH	BC
  6216'   68             C      	LD	L,B
  6217'   26 00          C      	LD	H,0
  6219'   11 3332        C      	LD	DE,3332H
  621C'   CD 52AB'       C      	CALL	UC.CVBD3
  621F'   13             C      	INC	DE
  6220'   13             C      	INC	DE
  6221'   21 622B'       C      	LD	HL,AVZS
  6224'   01 0011        C      	LD	BC,17
  6227'   ED B0          C      	LDIR
  6229'   C1             C      	POP	BC
  622A'   C9             C      	RET
                         C      ;-----------------------------------------------------------------------
  622B'   56 65 72 7A    C      AVZS:	DB	'Verzeichnissaetze'
  622F'   65 69 63 68    C      
  6233'   6E 69 73 73    C      
  6237'   61 65 74 7A    C      
  623B'   65             C      
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                         C      	PAGE
''	MACRO-80 3.44	09-Dec-81	PAGE	1-72


                         C      
                         C      ;	PN	KI
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;      INITIALISIEREN VON MRES KASSETTEN
                         C      ;
                         C      ;----------------------------------------------------------------------
  623C'   623C'          C      	DW	$
  623E'   49 4E 49 54    C      	DB	'INIT'
  6242'   3A 3327        C      	LD	A,(UE.BWSA+327H)
  6245'   CD 515A'       C      	CALL	U1.TST
  6248'   D8             C      	RET	C
  6249'   F5             C      	PUSH	AF
  624A'   CD 5074'       C      	CALL	U1.KTINI
  624D'   F1             C      	POP	AF
  624E'   DD 77 03       C      	LD	(IX+3),A	;GERAETEADR. -->TAB
  6251'   CD 49A0'       C      	CALL	UR.KRE	;RES. EIN
  6254'   DD CB 00 56    C      	BIT	2,(IX)
  6258'   28 05          C      	JR	Z,$+7
  625A'   3E 19          C      	LD	A,19H
  625C'   CD 4CFE'       C      	CALL	UF.ERANZ
  625F'   CD 49AE'       C      	CALL	UR.KRWW	;RUECKSPULEN MIT WARTEN
  6262'   CD 49C7'       C      	CALL	UR.KBM	;BM SCHREIBEN
  6265'   21 0E66        C      	LD	HL,UE.PUF	;AUFBAU 1.BLOCK
  6268'   3E 40          C      	LD	A,40H
  626A'   06 50          C      	LD	B,80
  626C'   CD 513B'       C      	CALL	U1.TR
  626F'   3E 00          C      	LD	A,00H
  6271'   06 30          C      	LD	B,48
  6273'   CD 513B'       C      	CALL	U1.TR
  6276'   DD 36 0A 80    C      	LD	(IX+10),80H
  627A'   DD 36 04 00    C      	LD	(IX+4),00H	;CMD SCHREIBEN
  627E'   CD 4CD0'       C      	CALL	UF.EXEC
  6281'   CD 6939'       C      	CALL	KO.KO03
  6284'   CD 5146'       C      KN:	CALL	U1.BILO
  6287'   3E 0D          C      	LD	A,13
  6289'   32 2B00'       C      	LD	(UB.ZN),A	;ZEILENNR. 15
  628C'   21 5465'       C      	LD	HL,UA.KNAME	;ABFRAGE KASS.NAME
  628F'   CD 4A4C'       C      	CALL	UR.MIMO
  6292'   D8             C      	RET	C
  6293'   06 06          C      	LD	B,6
  6295'   11 0E6A        C      	LD	DE,UE.PUF+4	;NAME IN PUFFER
  6298'   CD 534D'       C      	CALL	UC.KONV	;MIT KONVERTIERUNG IN DKOI-CODE
  629B'   21 5478'       C      NMR:	LD	HL,UA.NR	;ABFR. KASS.NUMMER
  629E'   CD 4A4C'       C      	CALL	UR.MIMO
  62A1'   38 E1          C      	JR	C,KN	;BEI SYS-TASTE ZU VORHERIGER
  62A3'   06 03          C      	LD	B,3
  62A5'   11 0E8B        C      	LD	DE,UE.PUF+37
  62A8'   CD 534D'       C      	CALL	UC.KONV
  62AB'   21 548B'       C      KM:	LD	HL,UA.KOMMT	;ABFR. KOMMENTAR
  62AE'   CD 4A4C'       C      	CALL	UR.MIMO
  62B1'   38 D1          C      	JR	C,KN
  62B3'   06 0B          C      	LD	B,11
  62B5'   11 0E8E        C      	LD	DE,UE.PUF+40
  62B8'   CD 534D'       C      	CALL	UC.KONV
  62BB'   CD 4CD0'       C      	CALL	UF.EXEC	;3.BLOCK SCHREIBEN
  62BE'   CD 49C7'       C      	CALL	UR.KBM	;BM , 1.LABEL BEENDET
  62C1'   21 56A4'       C      	LD	HL,UA.ALTR
  62C4'   11 0E66        C      	LD	DE,UE.PUF
  62C7'   01 0020        C      	LD	BC,20H
  62CA'   ED B0          C      	LDIR		;AUSGLEICH LFWSTLNZ->PUFFER
''	MACRO-80 3.44	09-Dec-81	PAGE	1-73


  62CC'   DD 36 0A 20    C      	LD	(IX+10),20H	;NEUE BLOCKLAENGE
  62D0'   DD 36 04 00    C      	LD	(IX+4),00H
  62D4'   CD 4CD0'       C      	CALL	UF.EXEC	;SCHREIBEN
  62D7'   21 5445'       C      	LD	HL,UA.DS
  62DA'   11 0E66        C      	LD	DE,UE.PUF
  62DD'   01 0020        C      	LD	BC,32
  62E0'   ED B0          C      	LDIR		;DS-SATZ --> PUFFER
  62E2'   CD 4CD0'       C      	CALL	UF.EXEC
  62E5'   3E A5          C      	LD	A,0A5H
  62E7'   06 20          C      	LD	B,32
  62E9'   21 0E66        C      	LD	HL,UE.PUF
  62EC'   CD 513B'       C      	CALL	U1.TR
  62EF'   06 68          C      	LD	B,68H	;103 VERZ.SAETZE
  62F1'   C5             C      VERZ:	PUSH	BC
  62F2'   CD 4CD0'       C      	CALL	UF.EXEC
  62F5'   C1             C      	POP	BC
  62F6'   10 F9          C      	DJNZ	VERZ
  62F8'   CD 49C7'       C      	CALL	UR.KBM
  62FB'   CD 5011'       C      	CALL	U1.VS1	;1.DATEIVORSATZ -->PUFFER
  62FE'   DD 36 04 00    C      	LD	(IX+4),00H
  6302'   CD 4CD0'       C      	CALL	UF.EXEC
  6305'   CD 49CD'       C      	CALL	UR.KSL	;SCHLUSSLUECKE SCHREIBEN
  6308'   CD 49A8'       C      	CALL	UR.KRW
  630B'   CD 49B5'       C      	CALL	UR.KRA
  630E'   C9             C      	RET
                         C      ;---------------------------------------------------------------------
                         C      ;	END
                         C      	PAGE
''	MACRO-80 3.44	09-Dec-81	PAGE	1-74


                         C      
                         C      ;	PN	KH
                         C      ;**********************************************************************
                         C      ;
                         C      ;   Kommando:
                         C      ;        KRDx...Block einlesen und anzeigen
                         C      ;               zusaetlich werden die entsprechenden Puffer-
                         C      ;               adressen angezeigt.
                         C      ;        KWRx...Block schreiben, standardmaessig nach 'KRDx'
                         C      ;               Ansonsten muessen Blockadresse und Blocklaenge in der
                         C      ;               Verstaendigungstabelle eingetragen werden.
                         C      ;
                         C      ;**********************************************************************
  630F'   630F'          C      	DW	$
  6311'   4B 52 44 31    C      	DB	'KRD1'
  6315'   18 06          C      	JR	RDSTA
  6317'   6317'          C      	DW	$
  6319'   4B 52 44 32    C      	DB	'KRD2'
  631D'   CD 5074'       C      RDSTA:	CALL	U1.KTINI	;Initialisierung E/A-Tab.
  6320'   3A 3325        C      	LD	A,(UE.BWSA+325H)
  6323'   E6 0F          C      	AND	0FH
  6325'   DD 77 03       C      	LD	(IX+3),A	;Subadresse eintragen
  6328'   CD 49A0'       C      RES:	CALL	UR.KRE	;Reservieren
  632B'   DD 36 04 02    C      RD1:	LD	(IX+4),02H	;Block wiedergeben
  632F'   CD 4CD0'       C      	CALL	UF.EXEC
  6332'   DD 7E 09       C      	LD	A,(IX+9)
  6335'   DD B6 0A       C      	OR	(IX+10)
  6338'   CA 639B'       C      	JP	Z,RDBM
  633B'   CD 6478'       C      	CALL	BILO
  633E'   CD 63AC'       C      	CALL	ANZBL	;Block anzeigen
  6341'   CD 4B6F'       C      RD3:	CALL	UR.TAREP	;Tastaturabfrage
  6344'   FE 89          C      	CP	089H
  6346'   28 E3          C      	JR	Z,RD1	;---> P 10
  6348'   FE 8B          C      	CP	08BH
  634A'   CC 6392'       C      RD6:	CALL	Z,RD2	;---> P 12
  634D'   28 DC          C      	JR	Z,RD1
  634F'   FE CD          C      	CP	0CDH
  6351'   28 3B          C      RD4:	JR	Z,SYSRT	;---> SYS
  6353'   FE 85          C      	CP	85H
  6355'   CC 6470'       C      	CALL	Z,KBRS	;---> P 6
  6358'   FE 86          C      	CP	86H
  635A'   DD 36 0A 01    C      	LD	(IX+10),1
  635E'   F5             C      	PUSH	AF
  635F'   CC 49BB'       C      	CALL	Z,UR.KLV	;---> P 7
  6362'   F1             C      	POP	AF
  6363'   28 DC          C      	JR	Z,RD3
  6365'   FE 87          C      	CP	87H
  6367'   F5             C      	PUSH	AF
  6368'   CC 49B5'       C      	CALL	Z,UR.KRA	;---> P 8
  636B'   F1             C      	POP	AF
  636C'   28 D3          C      	JR	Z,RD3
  636E'   FE 88          C      	CP	88H
  6370'   F5             C      	PUSH	AF
  6371'   CC 49C1'       C      	CALL	Z,UR.KLR	;---> P 9
  6374'   F1             C      	POP	AF
  6375'   28 CA          C      	JR	Z,RD3
  6377'   FE E2          C      	CP	0E2H	;CTRL,US,B : BM SCHREIBEN
  6379'   F5             C      	PUSH	AF
  637A'   CC 49C7'       C      	CALL	Z,UR.KBM
  637D'   F1             C      	POP	AF
  637E'   CA 6341'       C      	JP	Z,RD3
''	MACRO-80 3.44	09-Dec-81	PAGE	1-75


  6381'   FE 83          C      	CP	83H
  6383'   CA 6328'       C      	JP	Z,RES	;---> P 4
  6386'   FE 84          C      	CP	84H
  6388'   CC 49AE'       C      	CALL	Z,UR.KRWW	;---> P 5
  638B'   C3 6341'       C      	JP	RD3
  638E'   CD 6478'       C      SYSRT:	CALL	BILO	;Systemruecksprung
  6391'   C9             C      	RET
  6392'   F5             C      RD2:	PUSH	AF	;Flags retten
  6393'   CD 49D9'       C      	CALL	UR.KBR	;Block ruecksetzen
  6396'   CD 49D9'       C      	CALL	UR.KBR
  6399'   F1             C      	POP	AF
  639A'   C9             C      	RET
  639B'   CD 6478'       C      RDBM:	CALL	BILO
  639E'   21 5657'       C      	LD	HL,UA.ZKBM	;"Bandmarke"
  63A1'   11 3000        C      	LD	DE,UE.BWSA
  63A4'   01 0009        C      	LD	BC,9
  63A7'   ED B0          C      	LDIR
  63A9'   C3 6341'       C      	JP	RD3
  63AC'   CD 6478'       C      ANZBL:	CALL	BILO
  63AF'   21 0E66        C      ANZB1:	LD	HL,UE.PUF
  63B2'   CD 63B6'       C      	CALL	KH.AZBLD	;Bild anzeigen (24 Zeilen)
  63B5'   C9             C      	RET		; IN...HL:=akt. Pufferadresse
  63B6'   06 18          C      KH.AZBLD:	LD	B,24	; 24 Zeilen anzeigen
  63B8'   11 3000        C      	LD	DE,UE.BWSA
  63BB'   C5             C      KH.AZBL1:	PUSH	BC
  63BC'   CD 63CB'       C      	CALL	AZ1Z	; 1 Zeile anzeigen
  63BF'   C1             C      	POP	BC
  63C0'   E5             C      	PUSH	HL	;akt. Pufferadresse retten
  63C1'   EB             C      	EX	DE,HL
  63C2'   11 0050        C      	LD	DE,80
  63C5'   19             C      	ADD	HL,DE	;neuen Zeilenanfang berechnen
  63C6'   EB             C      	EX	DE,HL
  63C7'   E1             C      	POP	HL
  63C8'   10 F1          C      	DJNZ	KH.AZBL1
  63CA'   C9             C      	RET
                         C      ;                                IN...HL:= Pufferadresse
                         C      ;                                     DE:= Zeilenanfang
  63CB'   D5             C      AZ1Z:	PUSH	DE	;eine Zeile anzeigen
  63CC'   E5             C      	PUSH	HL
  63CD'   D5             C      	PUSH	DE
  63CE'   E1             C      	POP	HL
  63CF'   01 0040        C      	LD	BC,64
  63D2'   09             C      	ADD	HL,BC
  63D3'   E5             C      	PUSH	HL
  63D4'   C1             C      	POP	BC	;BC:= Anfang ASCII-Darstellung
  63D5'   E1             C      	POP	HL
  63D6'   CD 63EF'       C      	CALL	AZADR	;Adresse anzeigen
  63D9'   13             C      	INC	DE
  63DA'   13             C      	INC	DE
  63DB'   CD 63F8'       C      	CALL	KH.AZ4BY	;1. Vierergruppe
  63DE'   13             C      	INC	DE
  63DF'   13             C      	INC	DE
  63E0'   CD 63F8'       C      	CALL	KH.AZ4BY	;2.      "
  63E3'   13             C      	INC	DE
  63E4'   13             C      	INC	DE
  63E5'   CD 63F8'       C      	CALL	KH.AZ4BY	;3.      "
  63E8'   13             C      	INC	DE
  63E9'   13             C      	INC	DE
  63EA'   CD 63F8'       C      	CALL	KH.AZ4BY	;4.      "
  63ED'   D1             C      	POP	DE
  63EE'   C9             C      	RET
  63EF'   7C             C      AZADR:	LD	A,H	;Anzeige der Adresse
''	MACRO-80 3.44	09-Dec-81	PAGE	1-76


  63F0'   CD 523A'       C      	CALL	UC.CVBX+2
  63F3'   7D             C      	LD	A,L
  63F4'   CD 523A'       C      	CALL	UC.CVBX+2
  63F7'   C9             C      	RET
  63F8'   AF             C      KH.AZ4BY:	XOR	A	;Anzeige einer Vierergruppe
  63F9'   32 2B1C'       C      	LD	(UB.PAR1),A
  63FC'   7E             C      AZ4B0:	LD	A,(HL)
  63FD'   F5             C      	PUSH	AF
  63FE'   CD 523A'       C      	CALL	UC.CVBX+2	;Code als Hexadezimalzahl
  6401'   F1             C      	POP	AF
  6402'   13             C      	INC	DE
  6403'   23             C      	INC	HL
  6404'   FE 20          C      	CP	20H
  6406'   38 15          C      	JR	C,KH.AZ4B1	;nicht darstellbar
  6408'   FE 7F          C      	CP	7FH
  640A'   30 11          C      	JR	NC,KH.AZ4B1	;nicht darstellbar
  640C'   02             C      AZ4B3:	LD	(BC),A	;Code als ASCII-Zeichen
  640D'   03             C      	INC	BC
  640E'   CD 6421'       C      	CALL	BLEVG	;Test auf Blockende
  6411'   3A 2B1C'       C      	LD	A,(UB.PAR1)
  6414'   3C             C      	INC	A
  6415'   FE 04          C      	CP	4
  6417'   C8             C      	RET	Z
  6418'   32 2B1C'       C      	LD	(UB.PAR1),A
  641B'   18 DF          C      	JR	AZ4B0
  641D'   3E 7F          C      KH.AZ4B1:	LD	A,07FH
  641F'   18 EB          C      	JR	AZ4B3
  6421'   D5             C      BLEVG:	PUSH	DE	;Blockendetest
  6422'   E5             C      	PUSH	HL
  6423'   11 0E66        C      	LD	DE,UE.PUF	;DE:= Pufferanfang
  6426'   B7             C      	OR	A
  6427'   ED 52          C      	SBC	HL,DE	;HL:= Anzahl der angezeigten
  6429'   EB             C      	EX	DE,HL
  642A'   CD 51A6'       C      	CALL	XY.LIDX
  642D'   09             C      	DB	9
  642E'   B7             C      	OR	A
  642F'   ED 52          C      	SBC	HL,DE
  6431'   E1             C      	POP	HL
  6432'   D1             C      	POP	DE
  6433'   28 01          C      	JR	Z,BLEV1
  6435'   C9             C      	RET
  6436'   06 0C          C      BLEV1:	LD	B,12
  6438'   33             C      BLEV2:	INC	SP
  6439'   10 FD          C      	DJNZ	BLEV2
  643B'   C9             C      	RET		;---> Anzeige beendet
                         C      ;*********************************************************************
  643C'   643C'          C      	DW	$
  643E'   4B 57 52 31    C      	DB	'KWR1'
  6442'   18 06          C      	JR	WRSTA
  6444'   6444'          C      	DW	$
  6446'   4B 57 52 32    C      	DB	'KWR2'
  644A'   3A 3325        C      WRSTA:	LD	A,(UE.BWSA+325H)
  644D'   DD 21 2B01'    C      	LD	IX,UB.KTAB	;Block aufzeichnen
  6451'   DD CB 00 56    C      	BIT	2,(IX)
  6455'   28 07          C      	JR	Z,$+9
  6457'   F5             C      	PUSH	AF
  6458'   3E 19          C      	LD	A,19H
  645A'   CD 4CFE'       C      	CALL	UF.ERANZ
  645D'   F1             C      	POP	AF
  645E'   E6 0F          C      	AND	0FH
  6460'   DD 77 03       C      	LD	(IX+3),A
  6463'   DD 36 04 00    C      	LD	(IX+4),00H
''	MACRO-80 3.44	09-Dec-81	PAGE	1-77


  6467'   CD 4CD0'       C      	CALL	UF.EXEC
  646A'   CD 49D9'       C      	CALL	UR.KBR
  646D'   C3 632B'       C      	JP	RD1
  6470'   CD 49D9'       C      KBRS:	CALL	UR.KBR
  6473'   CD 6478'       C      	CALL	BILO
  6476'   D1             C      	POP	DE
  6477'   C9             C      	RET
                         C      ;----------------------------------------------------
  6478'   21 3000        C      BILO:	LD	HL,3000H
  647B'   01 0800        C      	LD	BC,800H
  647E'   36 20          C      	LD	(HL),20H
  6480'   E5             C      	PUSH	HL
  6481'   D1             C      	POP	DE
  6482'   13             C      	INC	DE
  6483'   ED B0          C      	LDIR
  6485'   C9             C      	RET
                         C      ;------------------------------------------------------
                         C      ;	END
                         C      	PAGE
''	MACRO-80 3.44	09-Dec-81	PAGE	1-78


                         C      
                         C      ;	PN	KX
                         C      ;------------------------------------------------------------------
                         C      ;
                         C      ;          KOPIEREN VON MRES-KASSETTEN       TEIL1
                         C      ;
                         C      ;----------------------------------------------------------------
  6486'   6486'          C      	DW	$
  6488'   4B 4F 50 49    C      	DB	'KOPI'
  648C'   CD 5074'       C      	CALL	U1.KTINI
  648F'   11 E000        C      	LD	DE,BC.TAB1
  6492'   21 3327        C      	LD	HL,UE.BWSA+327H
  6495'   7E             C      	LD	A,(HL)
  6496'   CD 515A'       C      	CALL	U1.TST
  6499'   D8             C      	RET	C
  649A'   12             C      	LD	(DE),A
  649B'   23             C      	INC	HL
  649C'   EE 33          C      	XOR	33H
  649E'   BE             C      	CP	(HL)
  649F'   C0             C      	RET	NZ
  64A0'   EE 30          C      	XOR	30H
  64A2'   13             C      	INC	DE
  64A3'   12             C      	LD	(DE),A
  64A4'   3A 3326        C      	LD	A,(UE.BWSA+326H)
  64A7'   FE 4A          C      	CP	'J'
  64A9'   28 05          C      	JR	Z,$+7	;BEI KOPIJ WERDEN WEITERE PARAMETER
  64AB'   23             C      	INC	HL	;IGNORIERT
  64AC'   23             C      	INC	HL
  64AD'   7E             C      	LD	A,(HL)
  64AE'   FE 20          C      	CP	20H
  64B0'   F5             C      	PUSH	AF
  64B1'   20 0C          C      	JR	NZ,$+14
  64B3'   CD 4FFF'       C      	CALL	U1.EIN
  64B6'   CD 517B'       C      	CALL	U1.KRWE
  64B9'   CD 5008'       C      	CALL	U1.AUS
  64BC'   CD 517B'       C      	CALL	U1.KRWE
  64BF'   CD 65FA'       C      	CALL	UPA
  64C2'   F1             C      	POP	AF
  64C3'   28 13          C      	JR	Z,$+21
  64C5'   FE 41          C      	CP	'A'
  64C7'   28 0A          C      	JR	Z,$+12
  64C9'   FE 4C          C      	CP	'L'
  64CB'   20 0B          C      	JR	NZ,$+13
  64CD'   CD 4FD6'       C      	CALL	U1.COPB
  64D0'   C3 65A0'       C      	JP	RSPFR
  64D3'   CD 4FD2'       C      	CALL	U1.COPB2
  64D6'   18 FB          C      	JR	$-3
                         C      ;-------------------------------------------------------------------
  64D8'   CD 4FFF'       C      	CALL	U1.EIN
  64DB'   CD 5028'       C      	CALL	U1.DSVG
  64DE'   CD 4FAA'       C      	CALL	U1.KBR4
  64E1'   CD 4FBC'       C      	CALL	U1.BREAD
  64E4'   21 549E'       C      	LD	HL,UA.Z7E
  64E7'   11 3163        C      	LD	DE,3163H
  64EA'   01 001F        C      	LD	BC,31
  64ED'   ED B0          C      	LDIR
  64EF'   21 54BD'       C      	LD	HL,UA.GER
  64F2'   11 31EA        C      	LD	DE,31EAH
  64F5'   CD 5140'       C      	CALL	U1.INFO
  64F8'   21 5468'       C      	LD	HL,UA.KNAME+3
  64FB'   11 323A        C      	LD	DE,323AH
''	MACRO-80 3.44	09-Dec-81	PAGE	1-79


  64FE'   CD 5140'       C      	CALL	U1.INFO
  6501'   21 547B'       C      	LD	HL,UA.NR+3
  6504'   11 328A        C      	LD	DE,328AH
  6507'   CD 5140'       C      	CALL	U1.INFO
  650A'   21 548E'       C      	LD	HL,UA.KOMMT+3
  650D'   11 32DA        C      	LD	DE,32DAH
  6510'   CD 5140'       C      	CALL	U1.INFO
  6513'   11 3203        C      	LD	DE,3203H
  6516'   3A E000        C      	LD	A,(BC.TAB1)
  6519'   CD 523A'       C      	CALL	UC.CVBX+2
  651C'   11 321B        C      	LD	DE,321BH
  651F'   3A E001        C      	LD	A,(BC.TAB1+1)
  6522'   CD 523A'       C      	CALL	UC.CVBX+2
  6525'   21 0E6A        C      	LD	HL,UE.PUF+4
  6528'   11 3253        C      	LD	DE,3253H
  652B'   06 06          C      	LD	B,6
  652D'   CD 5343'       C      	CALL	UC.DKONV
  6530'   21 0E8B        C      	LD	HL,UE.PUF+37
  6533'   11 32A3        C      	LD	DE,32A3H
  6536'   06 03          C      	LD	B,3
  6538'   CD 5343'       C      	CALL	UC.DKONV
  653B'   11 32F3        C      	LD	DE,32F3H
  653E'   06 0B          C      	LD	B,11
  6540'   CD 5343'       C      	CALL	UC.DKONV
  6543'   CD 49D3'       C      	CALL	UR.KBV
  6546'   CD 49D3'       C      	CALL	UR.KBV
  6549'   CD 4FBC'       C      	CALL	U1.BREAD
  654C'   3A 0E69        C      	LD	A,(UE.PUF+3)
  654F'   3D             C      	DEC	A
  6550'   CA 65AB'       C      	JP	Z,KX.ENDR
  6553'   CD 50AD'       C      	CALL	U1.VERIN
  6556'   CD 5008'       C      	CALL	U1.AUS
  6559'   CD 5028'       C      	CALL	U1.DSVG
  655C'   CD 4FAA'       C      	CALL	U1.KBR4
  655F'   DD 36 04 02    C      	LD	(IX+4),02H
  6563'   CD 4CD0'       C      	CALL	UF.EXEC
  6566'   21 0E6A        C      	LD	HL,UE.PUF+4
  6569'   11 326B        C      	LD	DE,326BH
  656C'   06 06          C      	LD	B,6
  656E'   CD 5343'       C      	CALL	UC.DKONV
  6571'   21 0E8B        C      	LD	HL,UE.PUF+37
  6574'   11 32BB        C      	LD	DE,32BBH
  6577'   06 03          C      	LD	B,3
  6579'   CD 5343'       C      	CALL	UC.DKONV
  657C'   11 330B        C      	LD	DE,330BH
  657F'   06 0B          C      	LD	B,11
  6581'   CD 5343'       C      	CALL	UC.DKONV
  6584'   CD 49D3'       C      	CALL	UR.KBV
  6587'   CD 49D3'       C      	CALL	UR.KBV
  658A'   DD 36 04 02    C      	LD	(IX+4),02H
  658E'   CD 4CD0'       C      	CALL	UF.EXEC
  6591'   CD 5146'       C      	CALL	U1.BILO
  6594'   11 E002        C      	LD	DE,BC.VTABA
  6597'   CD 50B5'       C      	CALL	U1.VERNI
  659A'   CD 50CF'       C      	CALL	U1.VORST
  659D'   C3 6617'       C      	JP	KY.MD
  65A0'   F5             C      RSPFR:	PUSH	AF
  65A1'   23             C      	INC	HL
  65A2'   23             C      	INC	HL
  65A3'   7E             C      	LD	A,(HL)
  65A4'   B7             C      	OR	A
  65A5'   FE 52          C      	CP	'R'
''	MACRO-80 3.44	09-Dec-81	PAGE	1-80


  65A7'   20 06          C      	JR	NZ,$+8
  65A9'   18 01          C      	JR	$+3
  65AB'   F5             C      KX.ENDR:	PUSH	AF
  65AC'   37             C      	SCF
  65AD'   18 04          C      	JR	$+6
  65AF'   FE 46          C      	CP	'F'
  65B1'   20 15          C      	JR	NZ,$+23
  65B3'   CD 4FFF'       C      	CALL	U1.EIN
  65B6'   DC 49A8'       C      	CALL	C,UR.KRW
  65B9'   CD 49B5'       C      	CALL	UR.KRA
  65BC'   CD 5008'       C      	CALL	U1.AUS
  65BF'   CD 49A0'       C      	CALL	UR.KRE
  65C2'   DC 49AE'       C      	CALL	C,UR.KRWW
  65C5'   CD 49B5'       C      	CALL	UR.KRA
  65C8'   F1             C      	POP	AF
  65C9'   C9             C      	RET
  65CA'   F5             C      KX.EXEC2:	PUSH	AF
  65CB'   DD CB 00 BE    C      	RES	7,(IX)
  65CF'   DD 36 01 00    C      	LD	(IX+1),0
  65D3'   CD 5A93'       C      	CALL	KR.KARO
  65D6'   DD CB 00 7E    C      	BIT	7,(IX)
  65DA'   28 0A          C      	JR	Z,$+12
  65DC'   DD 7E 01       C      	LD	A,(IX+1)
  65DF'   FE 14          C      	CP	14H
  65E1'   28 05          C      	JR	Z,$+7
  65E3'   CD 4CFE'       C      	CALL	UF.ERANZ
  65E6'   F1             C      	POP	AF
  65E7'   C9             C      	RET
  65E8'   DD CB 00 BE    C      	RES	7,(IX)
  65EC'   CD 5008'       C      	CALL	U1.AUS
  65EF'   CD 49CD'       C      	CALL	UR.KSL
  65F2'   F1             C      	POP	AF
  65F3'   06 06          C      	LD	B,6
  65F5'   33             C      	INC	SP
  65F6'   10 FD          C      	DJNZ	$-1	;STACK BERICHTIGEN
  65F8'   18 A6          C      	JR	RSPFR
  65FA'   CD 4FFF'       C      UPA:	CALL	U1.EIN
  65FD'   CD 49A0'       C      	CALL	UR.KRE
  6600'   DD 36 00 00    C      	LD	(IX+0),0
  6604'   CD 5008'       C      	CALL	U1.AUS
  6607'   CD 49A0'       C      	CALL	UR.KRE
  660A'   DD CB 00 56    C      	BIT	2,(IX)
  660E'   28 05          C      	JR	Z,$+7
  6610'   D1             C      	POP	DE
  6611'   3E 19          C      	LD	A,19H
  6613'   CD 4CFE'       C      	CALL	UF.ERANZ
  6616'   C9             C      	RET
                         C      ;	END
                         C      	PAGE
''	MACRO-80 3.44	09-Dec-81	PAGE	1-81


                         C      
                         C      ;	PN	KY
                         C      ;---------------------------------------------------------------------
                         C      ;
                         C      ;          KOPIEREN VON MRES-KASSETTEN           TEIL 2
                         C      ;
                         C      ;--------------------------------------------------------------------
  6617'   CD 5146'       C      KY.MD:	CALL	U1.BILO
  661A'   21 54CC'       C      	LD	HL,UA.KOPFR
  661D'   CD 6870'       C      	CALL	SATR
  6620'   3E 0D          C      	LD	A,13
  6622'   32 2B00'       C      	LD	(UB.ZN),A
  6625'   21 ECA2        C      	LD	HL,BC.VTABE+32
  6628'   FD 21 F902     C      	LD	IY,BC.TAB2
  662C'   FD 36 00 FF    C      	LD	(IY+0),0FFH
  6630'   3A EC85        C      	LD	A,(BC.VTABE+3)
  6633'   47             C      	LD	B,A
  6634'   05             C      	DEC	B
                         C      ;--------------------------------ABFRAGEZYKLUS------------------------
  6635'   C5             C      KY.DFR:	PUSH	BC
  6636'   11 2B44'       C      	LD	DE,UB.SATZ+26
  6639'   01 0006        C      	LD	BC,6
  663C'   ED B0          C      	LDIR
  663E'   13             C      	INC	DE
  663F'   13             C      	INC	DE
  6640'   01 0002        C      	LD	BC,2
  6643'   ED B0          C      	LDIR
  6645'   01 0018        C      	LD	BC,24
  6648'   09             C      	ADD	HL,BC
  6649'   E5             C      	PUSH	HL
  664A'   21 2B2A'       C      	LD	HL,UB.SATZ
  664D'   CD 4A4C'       C      	CALL	UR.MIMO
  6650'   DC 68CC'       C      	CALL	C,KU.ZEIR
  6653'   CD 6867'       C      	CALL	JHL	;BEI KOPIJ WIRD J GESETZT
  6656'   7E             C      	LD	A,(HL)
  6657'   FE 4A          C      	CP	'J'
  6659'   C4 6894'       C      	CALL	NZ,KU.TAB2L
  665C'   E1             C      	POP	HL
  665D'   01 0009        C      	LD	BC,9
  6660'   B7             C      	OR	A
  6661'   ED 42          C      	SBC	HL,BC
  6663'   7E             C      	LD	A,(HL)
  6664'   FD 77 00       C      	LD	(IY+0),A
  6667'   FD 23          C      	INC	IY
  6669'   FD 36 00 FF    C      	LD	(IY+0),0FFH
  666D'   09             C      	ADD	HL,BC
  666E'   3A E005        C      	LD	A,(BC.VTABA+3)
  6671'   FE 01          C      	CP	01H
  6673'   28 2E          C      	JR	Z,EZYK1
  6675'   E5             C      	PUSH	HL
  6676'   01 0020        C      	LD	BC,32
  6679'   B7             C      	OR	A
  667A'   ED 42          C      	SBC	HL,BC
  667C'   EB             C      	EX	DE,HL
  667D'   E1             C      	POP	HL
  667E'   DD 21 E002     C      	LD	IX,BC.VTABA
  6682'   47             C      	LD	B,A
  6683'   05             C      	DEC	B
  6684'   C5             C      VZVGL:	PUSH	BC
  6685'   01 0020        C      	LD	BC,32
  6688'   DD 09          C      	ADD	IX,BC
''	MACRO-80 3.44	09-Dec-81	PAGE	1-82


  668A'   DD E5          C      	PUSH	IX
  668C'   06 07          C      	LD	B,7
  668E'   D5             C      	PUSH	DE
  668F'   1A             C      SVGL:	LD	A,(DE)
  6690'   DD BE 00       C      	CP	(IX+0)
  6693'   20 08          C      	JR	NZ,NDA
  6695'   DD 23          C      	INC	IX
  6697'   13             C      	INC	DE
  6698'   10 F5          C      	DJNZ	SVGL
  669A'   CD 68FC'       C      	CALL	KU.DD	;DATEI SCHON VORHANDEN
  669D'   D1             C      NDA:	POP	DE
  669E'   DD E1          C      	POP	IX
  66A0'   C1             C      	POP	BC
  66A1'   10 E1          C      	DJNZ	VZVGL
  66A3'   C1             C      EZYK1:	POP	BC
  66A4'   10 8F          C      	DJNZ	KY.DFR
                         C      ;---------------------------------------------------------------------
  66A6'   06 03          C      KY.ATAA:	LD	B,3	;WARTESCHLEIFE FUER
  66A8'   21 FFFF        C      	LD	HL,0FFFFH
  66AB'   2B             C      	DEC	HL
  66AC'   7C             C      	LD	A,H
  66AD'   B5             C      	OR	L
  66AE'   20 FB          C      	JR	NZ,$-3
  66B0'   10 F6          C      	DJNZ	$-8
  66B2'   21 5502'       C      	LD	HL,UA.EABFR
  66B5'   CD 6870'       C      	CALL	SATR
  66B8'   21 2B2A'       C      	LD	HL,UB.SATZ
  66BB'   CD 4A4C'       C      	CALL	UR.MIMO
  66BE'   38 F8          C      	JR	C,$-6
  66C0'   CD 6867'       C      	CALL	JHL
  66C3'   7E             C      	LD	A,(HL)
  66C4'   FE 4A          C      	CP	'J'
  66C6'   C2 6617'       C      	JP	NZ,KY.MD
                         C      ;--------------------------------Labelnummern fuer Ausgabe ---------
  66C9'   06 00          C      ATAB:	LD	B,0
  66CB'   21 F902        C      	LD	HL,BC.TAB2
  66CE'   11 F9D2        C      	LD	DE,BC.TAB3
  66D1'   7E             C      	LD	A,(HL)
  66D2'   FE FF          C      	CP	0FFH	;KEINE DATEI KOPIEREN
  66D4'   CA 65AB'       C      	JP	Z,KX.ENDR
  66D7'   3A E003        C      	LD	A,(BC.VTABA+1)
  66DA'   12             C      ATABE:	LD	(DE),A
  66DB'   23             C      	INC	HL
  66DC'   13             C      	INC	DE
  66DD'   04             C      	INC	B
  66DE'   F5             C      	PUSH	AF
  66DF'   7E             C      	LD	A,(HL)
  66E0'   FE FF          C      	CP	0FFH
  66E2'   28 04          C      	JR	Z,WEI
  66E4'   F1             C      	POP	AF
  66E5'   3C             C      	INC	A
  66E6'   18 F2          C      	JR	ATABE
                         C      ;------------------------------TAB:NR DER VERZ.EINTRAGUNGEN (EING.)------
  66E8'   F1             C      WEI:	POP	AF
  66E9'   C5             C      	PUSH	BC
  66EA'   AF             C      	XOR	A
  66EB'   57             C      	LD	D,A
  66EC'   3A EC85        C      	LD	A,(BC.VTABE+3)
  66EF'   47             C      	LD	B,A
  66F0'   05             C      	DEC	B
  66F1'   21 F902        C      	LD	HL,BC.TAB2
  66F4'   FD 21 F96A     C      	LD	IY,BC.TAB2A
''	MACRO-80 3.44	09-Dec-81	PAGE	1-83


  66F8'   DD 21 ECA2     C      	LD	IX,BC.VTABE+32
  66FC'   14             C      ZYK:	INC	D
  66FD'   7E             C      	LD	A,(HL)
  66FE'   DD BE 17       C      	CP	(IX+23)
  6701'   20 0B          C      	JR	NZ,NE
  6703'   7A             C      	LD	A,D
  6704'   FD 77 00       C      	LD	(IY+0),A
  6707'   FD 36 01 FF    C      	LD	(IY+1),0FFH
  670B'   23             C      	INC	HL
  670C'   FD 23          C      	INC	IY
  670E'   C5             C      NE:	PUSH	BC
  670F'   01 0020        C      	LD	BC,32
  6712'   DD 09          C      	ADD	IX,BC
  6714'   C1             C      	POP	BC
  6715'   10 E5          C      	DJNZ	ZYK
                         C      ;------------------------------------AUFBAU AUSGABEVERZ.-----
  6717'   3A E005        C      	LD	A,(BC.VTABA+3)
  671A'   47             C      	LD	B,A
  671B'   FE 01          C      	CP	01H
  671D'   28 08          C      	JR	Z,EVZ
  671F'   21 E002        C      	LD	HL,BC.VTABA
  6722'   CD 688B'       C      	CALL	KU.VVOR
  6725'   18 03          C      	JR	EVZ1
  6727'   21 E022        C      EVZ:	LD	HL,BC.VTABA+32
  672A'   DD 21 F96A     C      EVZ1:	LD	IX,BC.TAB2A
  672E'   FD 21 F9D2     C      	LD	IY,BC.TAB3
  6732'   EB             C      	EX	DE,HL
  6733'   21 ECA2        C      	LD	HL,BC.VTABE+32
  6736'   DD 7E 00       C      	LD	A,(IX+0)
  6739'   FE 01          C      	CP	01H
  673B'   28 05          C      	JR	Z,VSTR
  673D'   3D             C      	DEC	A
  673E'   47             C      	LD	B,A
  673F'   CD 688B'       C      	CALL	KU.VVOR
  6742'   01 0020        C      VSTR:	LD	BC,32
  6745'   ED B0          C      	LDIR
  6747'   FD 7E 00       C      	LD	A,(IY+0)
  674A'   EB             C      	EX	DE,HL
  674B'   01 0009        C      	LD	BC,9
  674E'   B7             C      	OR	A
  674F'   ED 42          C      	SBC	HL,BC
  6751'   77             C      	LD	(HL),A
  6752'   09             C      	ADD	HL,BC
  6753'   EB             C      	EX	DE,HL
  6754'   DD 7E 01       C      	LD	A,(IX+1)
  6757'   FE FF          C      	CP	0FFH
  6759'   28 10          C      	JR	Z,COPY
  675B'   DD 96 00       C      	SUB	(IX+0)
  675E'   3D             C      	DEC	A
  675F'   47             C      	LD	B,A
  6760'   FE 00          C      	CP	00H
  6762'   C4 688B'       C      	CALL	NZ,KU.VVOR
  6765'   FD 23          C      	INC	IY
  6767'   DD 23          C      	INC	IX
  6769'   18 D7          C      	JR	VSTR
                         C      ;------------------------------------VERZ.SCHREIBEN (NUR NEUE SAETZE)---
  676B'   DD 21 2B01'    C      COPY:	LD	IX,UB.KTAB
  676F'   CD 5090'       C      	CALL	U1.KTIN1
  6772'   DD 36 0A 20    C      	LD	(IX+10),20H
  6776'   CD 5008'       C      	CALL	U1.AUS
  6779'   3A E005        C      	LD	A,(BC.VTABA+3)
  677C'   47             C      	LD	B,A
''	MACRO-80 3.44	09-Dec-81	PAGE	1-84


  677D'   CD 49D3'       C      	CALL	UR.KBV	;AUSGABEKASSETTE
  6780'   3D             C      	DEC	A
  6781'   20 FA          C      	JR	NZ,$-4	;VORSTELLEN BIS HINTER LETZTEN ALTEN
  6783'   21 E002        C      	LD	HL,BC.VTABA	;VERZ.SATZ
  6786'   11 0020        C      	LD	DE,32
  6789'   19             C      	ADD	HL,DE
  678A'   10 FA          C      	DJNZ	$-4	;AUSGABEVERZ.ZEIGER
  678C'   C1             C      	POP	BC
  678D'   78             C      	LD	A,B
  678E'   F5             C      	PUSH	AF
  678F'   11 0E66        C      VSCHR:	LD	DE,UE.PUF
  6792'   01 0020        C      	LD	BC,32
  6795'   ED B0          C      	LDIR
  6797'   CD 49D3'       C      	CALL	UR.KBV
  679A'   CD 49D9'       C      	CALL	UR.KBR
  679D'   DD 36 04 08    C      	LD	(IX+4),08H
  67A1'   CD 4CD0'       C      	CALL	UF.EXEC
  67A4'   3D             C      	DEC	A
  67A5'   20 E8          C      	JR	NZ,VSCHR
                         C      ;----------------------------------------------------------------
  67A7'   11 33FA        C      	LD	DE,33FAH	;''ES WIRD KOPIERT''
  67AA'   21 6857'       C      	LD	HL,EWK
  67AD'   01 0010        C      	LD	BC,16
  67B0'   ED B0          C      	LDIR
                         C      ;------------------------------KOPIEREN--------------------------
  67B2'   21 F902        C      	LD	HL,BC.TAB2
  67B5'   11 F9D2        C      	LD	DE,BC.TAB3
  67B8'   FD 21 F96A     C      	LD	IY,BC.TAB2A
  67BC'   1A             C      	LD	A,(DE)
  67BD'   47             C      	LD	B,A
  67BE'   04             C      	INC	B
  67BF'   CD 49E8'       C      	CALL	UR.POSIK
  67C2'   7E             C      	LD	A,(HL)
  67C3'   47             C      	LD	B,A
  67C4'   04             C      	INC	B
  67C5'   CD 4FFF'       C      KOPV:	CALL	U1.EIN
  67C8'   CD 49E8'       C      	CALL	UR.POSIK
  67CB'   CD 4FBC'       C      KOP:	CALL	U1.BREAD
  67CE'   7E             C      	LD	A,(HL)
  67CF'   FE 01          C      	CP	01H
  67D1'   CC 5018'       C      	CALL	Z,U1.VSX
                         C      ;------------------------ANZEIGE WELCHE DATEI KOPIERT WIRD-------------
  67D4'   E5             C      	PUSH	HL
  67D5'   D5             C      	PUSH	DE
  67D6'   FD 7E 00       C      	LD	A,(IY+0)
  67D9'   47             C      	LD	B,A
  67DA'   05             C      	DEC	B
  67DB'   21 ECA2        C      	LD	HL,BC.VTABE+32
  67DE'   FE 01          C      	CP	01H
  67E0'   28 03          C      	JR	Z,KOPAN
  67E2'   CD 688B'       C      	CALL	KU.VVOR
  67E5'   11 34F0        C      KOPAN:	LD	DE,34F0H
  67E8'   01 0006        C      	LD	BC,6
  67EB'   ED B0          C      	LDIR
  67ED'   13             C      	INC	DE
  67EE'   13             C      	INC	DE
  67EF'   01 0002        C      	LD	BC,2
  67F2'   ED B0          C      	LDIR
  67F4'   FD 23          C      	INC	IY
  67F6'   D1             C      	POP	DE
  67F7'   E1             C      	POP	HL
                         C      ;--------------------------------------------------------------------
''	MACRO-80 3.44	09-Dec-81	PAGE	1-85


  67F8'   1A             C      	LD	A,(DE)
  67F9'   FE 01          C      	CP	01H
  67FB'   CC 5011'       C      	CALL	Z,U1.VS1
  67FE'   32 0E66        C      	LD	(UE.PUF),A
  6801'   CD 4FC7'       C      	CALL	U1.BWRIT
  6804'   CD 4FD6'       C      	CALL	U1.COPB
  6807'   23             C      	INC	HL
  6808'   7E             C      	LD	A,(HL)
  6809'   FE FF          C      	CP	0FFH
  680B'   28 0B          C      	JR	Z,EOV
  680D'   2B             C      	DEC	HL
  680E'   96             C      	SUB	(HL)
  680F'   23             C      	INC	HL
  6810'   13             C      	INC	DE
  6811'   47             C      	LD	B,A
  6812'   FE 01          C      	CP	01H
  6814'   20 AF          C      	JR	NZ,KOPV
  6816'   18 B3          C      	JR	KOP
                         C      ;-------------------------------------------------------------
  6818'   CD 5018'       C      EOV:	CALL	U1.VSX
  681B'   3A E003        C      	LD	A,(BC.VTABA+1)
  681E'   47             C      	LD	B,A
  681F'   F1             C      	POP	AF
  6820'   F5             C      	PUSH	AF
  6821'   80             C      	ADD	A,B
  6822'   32 0E66        C      	LD	(UE.PUF),A
  6825'   CD 5090'       C      	CALL	U1.KTIN1
  6828'   DD 36 0A 20    C      	LD	(IX+10),20H
  682C'   CD 4FC7'       C      	CALL	U1.BWRIT
  682F'   CD 49CD'       C      	CALL	UR.KSL
  6832'   CD 65AB'       C      	CALL	KX.ENDR
  6835'   CD 49A0'       C      	CALL	UR.KRE
  6838'   CD 5028'       C      	CALL	U1.DSVG
  683B'   F1             C      	POP	AF
  683C'   F5             C      	PUSH	AF
  683D'   81             C      	ADD	A,C	;NEXT RECORD UND
  683E'   32 0E67        C      	LD	(UE.PUF+1),A
  6841'   F1             C      	POP	AF
  6842'   80             C      	ADD	A,B	;ANZAHL VERZ.EINTR. KORRIGIEREN
  6843'   32 0E69        C      	LD	(UE.PUF+3),A
  6846'   CD 49D9'       C      	CALL	UR.KBR
  6849'   DD 36 04 08    C      	LD	(IX+4),08H
  684D'   CD 4CD0'       C      	CALL	UF.EXEC	;NEUEN DS-SATZ SCHREIBEN
  6850'   CD 49A8'       C      	CALL	UR.KRW
  6853'   CD 49B5'       C      	CALL	UR.KRA
  6856'   C9             C      	RET
                         C      ;---------------------------------------------------------------
  6857'   45 73 20 77    C      EWK:	DB	'Es wird kopiert:'
  685B'   69 72 64 20    C      
  685F'   6B 6F 70 69    C      
  6863'   65 72 74 3A    C      
                         C      ;---------------------------------------------------------------
  6867'   3A 2B1E'       C      JHL:	LD	A,(UB.PAR2)
  686A'   FE 4A          C      	CP	'J'
  686C'   20 01          C      	JR	NZ,$+3
  686E'   77             C      	LD	(HL),A
  686F'   C9             C      	RET
                         C      ;--------------------------------------------------------------
  6870'   11 2B2A'       C      SATR:	LD	DE,UB.SATZ
  6873'   01 0036        C      	LD	BC,54
  6876'   ED B0          C      	LDIR
  6878'   3A 3326        C      	LD	A,(UE.BWSA+326H)
''	MACRO-80 3.44	09-Dec-81	PAGE	1-86


  687B'   FE 4A          C      	CP	'J'
  687D'   CC 6884'       C      	CALL	Z,AJ
  6880'   32 2B1E'       C      	LD	(UB.PAR2),A
  6883'   C9             C      	RET
  6884'   F5             C      AJ:	PUSH	AF
  6885'   AF             C      	XOR	A
  6886'   32 2B2A'       C      	LD	(UB.SATZ),A
  6889'   F1             C      	POP	AF
  688A'   C9             C      	RET
                         C      ;--------------------------------------------------------------
                         C      ;	END
                         C      	PAGE
''	MACRO-80 3.44	09-Dec-81	PAGE	1-87


                         C      
                         C      ;	PN	KU
                         C      ;------------------------------------------------------------------
                         C      ;
                         C      ;          UNTERPROGRAMME FUER KOPI
                         C      ;
                         C      ;--------------------------------------------------------
  688B'   C5             C      KU.VVOR:	PUSH	BC
  688C'   01 0020        C      	LD	BC,32
  688F'   09             C      	ADD	HL,BC
  6890'   C1             C      	POP	BC
  6891'   10 F8          C      	DJNZ	KU.VVOR
  6893'   C9             C      	RET
  6894'   D1             C      KU.TAB2L:	POP	DE
  6895'   E1             C      	POP	HL
  6896'   FD 7E 00       C      	LD	A,(IY+0)
  6899'   FE FF          C      	CP	0FFH
  689B'   28 22          C      	JR	Z,$+36
  689D'   FD E5          C      	PUSH	IY
  689F'   06 00          C      	LD	B,00H
  68A1'   FD 7E 00       C      	LD	A,(IY+0)
  68A4'   FE FF          C      	CP	0FFH
  68A6'   20 02          C      	JR	NZ,$+4
  68A8'   18 05          C      	JR	$+7
  68AA'   FD 23          C      	INC	IY
  68AC'   04             C      	INC	B
  68AD'   18 F2          C      	JR	$-12
  68AF'   FD E1          C      	POP	IY
  68B1'   FD E5          C      	PUSH	IY
  68B3'   FD 7E 01       C      	LD	A,(IY+1)
  68B6'   FD 77 00       C      	LD	(IY+0),A
  68B9'   FD 23          C      	INC	IY
  68BB'   10 F6          C      	DJNZ	$-8
  68BD'   FD E1          C      	POP	IY
  68BF'   C1             C      	POP	BC
  68C0'   05             C      	DEC	B
  68C1'   78             C      	LD	A,B
  68C2'   FE 00          C      	CP	00H
  68C4'   28 03          C      	JR	Z,$+5
  68C6'   C3 6635'       C      	JP	KY.DFR
  68C9'   C3 66A6'       C      	JP	KY.ATAA
  68CC'   D1             C      KU.ZEIR:	POP	DE
  68CD'   E1             C      	POP	HL
  68CE'   3A 2B00'       C      	LD	A,(UB.ZN)
  68D1'   D6 02          C      	SUB	2
  68D3'   FE 0D          C      	CP	13
  68D5'   30 04          C      	JR	NC,$+6
  68D7'   C1             C      	POP	BC
  68D8'   C3 6617'       C      	JP	KY.MD
  68DB'   32 2B00'       C      	LD	(UB.ZN),A
  68DE'   01 0029        C      	LD	BC,41
  68E1'   B7             C      	OR	A
  68E2'   ED 42          C      	SBC	HL,BC
  68E4'   FD 2B          C      	DEC	IY
  68E6'   7E             C      	LD	A,(HL)
  68E7'   FD BE 00       C      	CP	(IY+0)
  68EA'   CC 68F9'       C      	CALL	Z,DECIY
  68ED'   FD 23          C      	INC	IY
  68EF'   01 0017        C      	LD	BC,23
  68F2'   B7             C      	OR	A
  68F3'   ED 42          C      	SBC	HL,BC
''	MACRO-80 3.44	09-Dec-81	PAGE	1-88


  68F5'   C1             C      	POP	BC
  68F6'   04             C      	INC	B
  68F7'   18 CA          C      	JR	$-52
  68F9'   FD 2B          C      DECIY:	DEC	IY
  68FB'   C9             C      	RET
  68FC'   E5             C      KU.DD:	PUSH	HL
  68FD'   21 5538'       C      	LD	HL,UA.VORH
  6900'   CD 4A4C'       C      	CALL	UR.MIMO
  6903'   38 17          C      	JR	C,$+25
  6905'   7E             C      	LD	A,(HL)
  6906'   FE 4A          C      	CP	'J'
  6908'   28 0C          C      	JR	Z,$+14
  690A'   FD 2B          C      	DEC	IY
  690C'   FD 36 00 FF    C      	LD	(IY+0),0FFH
  6910'   11 0050        C      	LD	DE,80
  6913'   B7             C      	OR	A
  6914'   ED 52          C      	SBC	HL,DE
  6916'   36 20          C      	LD	(HL),20H
  6918'   21 2B00'       C      	LD	HL,UB.ZN
  691B'   35             C      	DEC	(HL)
  691C'   E1             C      	POP	HL
  691D'   C9             C      	RET
  691E'   E1             C      	POP	HL
  691F'   D1             C      	POP	DE
  6920'   DD 21 2B01'    C      	LD	IX,UB.KTAB
  6924'   C3 65AB'       C      	JP	KX.ENDR
                         C      ;	END
                         C      	PAGE
''	MACRO-80 3.44	09-Dec-81	PAGE	1-89


                         C      
                         C      ;	PN	KO
                         C      
                         C      ;KORREKTUREN FUER KASSETTENPROGRAMME
                         C      
                         C      ;------------------------------------
                         C      
  6927'   DD 36 04 02    C      KO.KO01:	LD	(IX+4),2	;FUER FD19
  692B'   C3 4CD0'       C      	JP	UF.EXEC
                         C      
                         C      ;------------------------------------
                         C      
  692E'   CB BF          C      KO.KO02:	RES	7,A	;FUER KV17 (DRUCKERAUSGABE)
  6930'   FE 20          C      	CP	20H
  6932'   30 02          C      	JR	NC,$+4
  6934'   3E 2A          C      	LD	A,2AH
  6936'   C3 7C00        C      	JP	UE.PRINT
                         C      
                         C      ;------------------------------------
                         C      
  6939'   CD 4CD0'       C      KO.KO03:	CALL	UF.EXEC	;FUER KI14
  693C'   06 31          C      	LD	B,49
  693E'   2B             C      	DEC	HL
  693F'   10 FD          C      	DJNZ	$-1
  6941'   36 D9          C      	LD	(HL),0D9H
  6943'   C9             C      	RET
                         C      
                         C      ;------------------------------------
                         C      
  6944'   DD 71 04       C      KO.KO04:	LD	(IX+4),C	;FUER UF19
  6947'   C3 4CD4'       C      	JP	UF.EXEC+4
                         C      
                         C      ;------------------------------------
                         C      
  694A'   DD 4E 04       C      KO.KO05:	LD	C,(IX+4)	;FUER UF19
  694D'   3E 31          C      	LD	A,31H
  694F'   B9             C      	CP	C
  6950'   28 1D          C      	JR	Z,KO051	;BEREITSIGNAL NICHT BEI RESERVIEREN EIN
  6952'   DD CB 00 66    C      	BIT	4,(IX)	;TEST BEREIT
  6956'   28 17          C      	JR	Z,KO051	;Z=1 : GERAET IST BEREIT
                         C      
  6958'   06 0F          C      	LD	B,15
  695A'   DD 36 04 31    C      	LD	(IX+4),31H
  695E'   C5             C      KO052:	PUSH	BC
  695F'   CD 5A93'       C      	CALL	KR.KARO
  6962'   C1             C      	POP	BC
  6963'   10 F9          C      	DJNZ	KO052	;15x RESERVIEREN EIN
                         C      
  6965'   DD 71 04       C      	LD	(IX+4),C
  6968'   DD CB 00 66    C      	BIT	4,(IX)	;GERAET JETZT BEREIT ?
  696C'   C2 4CF2'       C      	JP	NZ,UF.ERA1
                         C      
  696F'   CD 5A93'       C      KO051:	CALL	KR.KARO
  6972'   C3 4CDF'       C      	JP	UF.EXEC1
                         C      
                         C      ;------------------------------------
                         C      
                         C      ;	END
                         C      	PAGE
''	MACRO-80 3.44	09-Dec-81	PAGE	1-90


                         C      
                         C      ;	PN	BC
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;        BEREICHE FUER KASSETTENKOPIEREN
                         C      ;
                         C      ;----------------------------------------------------------------------
  E000                   C      BC.TAB1    EQU	0E000H
  0000                   C      BC.EGG     EQU	0	;EINGABEGERAET
  0001                   C      BC.AGG     EQU	1	;AUSGABEGERAET
  E002                   C      BC.VTABA   EQU	0E002H
  EC82                   C      BC.VTABE   EQU	0E002H+3200
  F902                   C      BC.TAB2    EQU	0E002H+3200+3200
  F96A                   C      BC.TAB2A   EQU	0E002H+3200+3200+104
  F9D2                   C      BC.TAB3    EQU	0E002H+3200+3200+104+104
  FA3A                   C      BC.END     EQU	0E002H+3200+3200+104+104+104
                         C      ;	ORG	0E000H
                         C      ;BC.TAB1:   DS	2
                         C      ;
                         C      ;BC.EGG     EQU	0	;EINGABEGERAET
                         C      ;BC.AGG     EQU	1	;AUSGABEGERAET
                         C      ;----------------------------------------------------------------------
                         C      ;BC.VTABA:  DS	3200
                         C      ;BC.VTABE:  DS	3200
                         C      ;----------------------------------------------------------------------
                         C      ;BC.TAB2:   DS	104
                         C      ;BC.TAB2A:  DS	104
                         C      ;BC.TAB3:   DS	104
                         C      ;BC.END     EQU	$
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                                ;	INCLUDE UE.ASM
                                ;	INCLUDE UB.ASM
                                ;	INCLUDE BC.ASM
                                ;	INCLUDE UR.ASM
                                ;	INCLUDE UK.ASM
                                ;	INCLUDE UF.ASM
                                ;	INCLUDE U1.ASM
                                ;	INCLUDE XY.ASM
                                ;	INCLUDE UC.ASM
                                ;	INCLUDE UA.ASM
                                ;	INCLUDE LD.ASM
                                ;	INCLUDE RL.ASM
                                ;	INCLUDE SV.ASM
                                ;	INCLUDE KR.ASM
                                ;	INCLUDE FD.ASM
                                ;	INCLUDE DC.ASM
                                ;	INCLUDE CP.ASM
                                ;	INCLUDE KV.ASM
                                ;	INCLUDE KI.ASM
                                ;	INCLUDE KH.ASM
                                ;	INCLUDE KX.ASM
                                ;	INCLUDE KY.ASM
                                ;	INCLUDE KU.ASM
                                ;	INCLUDE KO.ASM
                                	
                                ;	INCLUDE KM.ASM
                                							
                                	TITLE ''
                                	END
''	MACRO-80 3.44	09-Dec-81	PAGE	S


Macros:

Symbols:
6884'	AJ              4B4B'	ALPH1           4B42'	ALPHA           
4B56'	ALPNU           6215'	ANZ             63AF'	ANZB1           
63AC'	ANZBL           5385'	ASCCO           66C9'	ATAB            
66DA'	ATABE           24F8 	ATACO           60CD'	AUSG            
622B'	AVZS            63CB'	AZ1Z            63FC'	AZ4B0           
640C'	AZ4B3           63EF'	AZADR           4D54'	AZVB            
4A86'	BBSA1           4A7E'	BBSAD           0001 	BC.AGG          
0000 	BC.EGG          FA3A 	BC.END          E000 	BC.TAB1         
F902 	BC.TAB2         F96A 	BC.TAB2A        F9D2 	BC.TAB3         
E002 	BC.VTABA        EC82 	BC.VTABE        4D89'	BEHB            
58C7'	BF              6478'	BILO            4B87'	BILR1           
4B75'	BILRO           6436'	BLEV1           6438'	BLEV2           
6421'	BLEVG           4A1B'	BM              5ED9'	BMGF            
619D'	BSTR            59D7'	BYANZ           5182'	CALP1           
518B'	CALPE           5B5B'	CKRA            676B'	COPY            
5F22'	CP.COMPR        5F85'	CP.INIT         5F55'	CP.KOM          
5F27'	CP.NL           5F55'	CP.OUT          5F35'	CP.OUTT         
5F5C'	CP.SOKOM        5F72'	CP.SOSTR        5F3A'	CP.SPACE        
5F31'	CP.STRNG        5F77'	CP.TAB          5F45'	CP.TEXT         
5A68'	DALO1           5C01'	DASU            5704'	DATFU           
58B3'	DATNV           5725'	DATPO           59E2'	DATS1           
591C'	DATV1           5924'	DATVO           6200'	DBCVM           
5EE1'	DC.DCMPR        5F17'	DC.EOSPC        5F1C'	DC.INIT         
5EE3'	DC.NL           5F07'	DC.SPACE        5EFD'	DC.TAB          
5EEF'	DC.TEXT         5DF3'	DECHL           68F9'	DECIY           
53E5'	DKOI            618E'	DRU1            6190'	DRU2            
7C00 	DRUZ            5EB3'	DSPBB           5EC3'	DSPBG           
4A8E'	DSPZK           58AE'	ECHO            5AA1'	EINTR           
5E68'	END             6818'	EOV             6727'	EVZ             
672A'	EVZ1            6857'	EWK             66A3'	EZYK1           
5D3B'	FD.DECBZ        5C4E'	FD.FDINP        5CA1'	FD.FDOUT        
5E91'	FDIN2           5D05'	FDOW1           5D09'	FDOW2           
5D2E'	FDOW3           5D20'	FDOW4           5CF5'	FDOWR           
5D45'	FDUP            4F1D'	FL14            4F65'	FL16            
4E21'	FL17            4DE6'	FL18            4DC0'	FL21            
4D97'	FL22            58C9'	FMELD           5E6F'	FOLWR           
5DFC'	FOUT1           5D88'	FSTRT           4BB8'	GETK2           
4BC0'	GETK3           4BC6'	GETK4           4BBC'	GETK5           
5AB4'	GR1             5AAA'	GR2             4B60'	HEXAZ           
4B6D'	HEXZ1           6867'	JHL             51EF'	JMPDX           
6470'	KBRS            641D'	KH.AZ4B1        63F8'	KH.AZ4BY        
63BB'	KH.AZBL1        63B6'	KH.AZBLD        62AB'	KM              
6284'	KN              6927'	KO.KO01         692E'	KO.KO02         
6939'	KO.KO03         6944'	KO.KO04         694A'	KO.KO05         
696F'	KO051           695E'	KO052           67CB'	KOP             
67E5'	KOPAN           67C5'	KOPV            5A93'	KR.KARO         
49A4'	KRE1            6142'	KRW             68FC'	KU.DD           
6894'	KU.TAB2L        688B'	KU.VVOR         68CC'	KU.ZEIR         
5FFD'	KV.ANF          65AB'	KX.ENDR         65CA'	KX.EXEC2        
66A6'	KY.ATAA         6635'	KY.DFR          6617'	KY.MD           
57A0'	LAD1            578F'	LAD2            578C'	LADER           
57B5'	LADF            56DF'	LD.DATN         56F4'	LD2             
56FE'	LD21            5787'	LD3             5745'	LD4             
5760'	LD5             57AC'	LDEND           49F3'	LES             
584C'	M10             585D'	M11             57EC'	M12             
582A'	M13             583A'	M14             5842'	M15             
57DB'	M16             5809'	M17             5870'	M21             
4A68'	MIMO1           4A60'	MIMO2           4A6F'	MIMO3           
''	MACRO-80 3.44	09-Dec-81	PAGE	S-1


58C3'	MN              669D'	NDA             670E'	NE              
629B'	NMR             58B7'	OB              4A29'	OK              
6176'	P1              5BE9'	POSK            58BB'	RA              
632B'	RD1             6392'	RD2             6341'	RD3             
6351'	RD4             634A'	RD6             639B'	RDBM            
5ECD'	RDEND           631D'	RDSTA           6328'	RES             
09E3 	RET             4AD9'	RET0            57BB'	RL.BEG          
49DF'	RPOS            4A48'	RSP             65A0'	RSPFR           
6870'	SATR            595E'	SAVE3           5973'	SAVE4           
59BB'	SAVE5           59B1'	SAVE6           620B'	SBC             
3000 	SD.BWSA         5C95'	SDIN            5D78'	SDK0            
5D82'	SDK1            5D6E'	SDK2            5CEF'	SDOUT           
5D5E'	SDOW            5DD5'	SETJ            5DED'	SETN            
0D00 	SM.FKTAB        61CA'	SPTR            5A60'	STAD0           
577D'	START           5DC0'	STRT1           58BF'	SV              
5905'	SV.DATN         59FC'	SV.SAVE         5A0D'	SV.SAVE1        
58F8'	SV20            5910'	SV21            592A'	SV30            
5944'	SV31            5932'	SV37            5A50'	SVEN1           
5A4D'	SVEN2           668F'	SVGL            5A24'	SVLS            
5A40'	SVLS1           5A2A'	SVLS2           5A73'	SVSZ            
5A87'	SVSZ1           5A75'	SVSZ2           4D50'	SYS1            
638E'	SYSRT           6066'	TABTR           4AE3'	TCL             
4AF3'	TCLN            4AF6'	TCR             4B05'	TCRN            
4B0F'	TQUIT           4B07'	TSYS            5BE3'	TYPT            
5008'	U1.AUS          5146'	U1.BILO         4FBC'	U1.BREAD        
4FC7'	U1.BWRIT        4F9B'	U1.CLRB         4FD6'	U1.COPB         
4FD2'	U1.COPB2        5028'	U1.DSVG         4FFF'	U1.EIN          
5140'	U1.INFO         4FAA'	U1.KBR4         517B'	U1.KRWE         
5090'	U1.KTIN1        5074'	U1.KTINI        5059'	U1.NMVGL        
5164'	U1.PRADR        4F92'	U1.RRST         4F8A'	U1.RSAVE        
513B'	U1.TR           515A'	U1.TST          50AD'	U1.VERIN        
50B5'	U1.VERNI        50D7'	U1.VORS1        50CF'	U1.VORST        
5011'	U1.VS1          5018'	U1.VSX          50E3'	U1.VZS          
4FB4'	U1.WAIT         56A4'	UA.ALTR         568B'	UA.ANZWD        
5574'	UA.BMGF         5585'	UA.DF           557E'	UA.DOK          
5445'	UA.DS           5502'	UA.EABFR        556E'	UA.FRZ          
54BD'	UA.GER          5465'	UA.KNAME        548B'	UA.KOMMT        
54CC'	UA.KOPFR        5660'	UA.LD           5478'	UA.NR           
55D8'	UA.STADR        5538'	UA.VORH         549E'	UA.Z7E          
55B2'	UA.ZKBEG        5631'	UA.ZKBEL        5644'	UA.ZKBLG        
5657'	UA.ZKBM         558C'	UA.ZKDAT        55EB'	UA.ZKDL         
55C5'	UA.ZKEND        55FE'	UA.ZKF          559F'	UA.ZKLAD        
5609'	UA.ZKRES        561C'	UA.ZKSDT        5672'	UA.ZRSCH        
2B64'	UB.DTAB         2B8D'	UB.END          2B01'	UB.KTAB         
2B1C'	UB.PAR1         2B1E'	UB.PAR2         2B20'	UB.PAR3         
2B22'	UB.PAR4         2B24'	UB.PAR5         2B26'	UB.PATAB        
2B2A'	UB.SATZ         2B00'	UB.ZN           5362'	UC.CKONV        
522E'	UC.CVABX        5249'	UC.CVAX         525D'	UC.CVAXB        
5325'	UC.CVBC         52B5'	UC.CVBD         52C0'	UC.CVBD0        
52B3'	UC.CVBD1        52AF'	UC.CVBD2        52AB'	UC.CVBD3        
52A7'	UC.CVBD4        52A3'	UC.CVBD5        5238'	UC.CVBX         
5336'	UC.CVCB         531D'	UC.CVD1B        52F4'	UC.CVDB         
5254'	UC.CVHLX        527F'	UC.CVX1B        5298'	UC.CVXA         
526E'	UC.CVXB         5288'	UC.CVXER        5220'	UC.DIVR         
5357'	UC.DK1          536B'	UC.DK2          5343'	UC.DKONV        
5207'	UC.HL10C        5200'	UC.HL10N        534D'	UC.KONV         
5381'	UC.KONV2        46AD 	UE.BERT         4000 	UE.BRKMB        
3000 	UE.BWSA         0060 	UE.COTAL        4740 	UE.CRC          
0DC4 	UE.EDEND        4965 	UE.KINI         0132 	UE.KMPUL        
8010 	UE.KPUFF        7C00 	UE.PRINT        0E66 	UE.PUF          
0CFE 	UE.STANF        007D 	UE.SVL          000B 	UE.SYSTB        
00F7 	UE.TACL         00F9 	UE.TACR         001E 	UE.TAQUI        
''	MACRO-80 3.44	09-Dec-81	PAGE	S-2


6EE6 	UE.TARO         00CD 	UE.TASYS        8830 	UE.TEXAN        
0E5A 	UE.ZEIN         4CF2'	UF.ERA1         4CFE'	UF.ERANZ        
4CD0'	UF.EXEC         4CDF'	UF.EXEC1        4CCB'	UF.RET          
4D44'	UF.SYS          57D0'	UG              4B97'	UK.GETK         
4C85'	UK.KBA          4BF7'	UK.KBW          4C36'	UK.KBW1         
4C32'	UK.KBW2         4BD4'	UK.KLPFB        4C60'	UK.KSPFB        
4C3C'	UK.PUTK         5863'	UP6             65FA'	UPA             
49C7'	UR.KBM          49D9'	UR.KBR          49D3'	UR.KBV          
49C1'	UR.KLR          49BB'	UR.KLV          49B5'	UR.KRA          
49A0'	UR.KRE          49A8'	UR.KRW          49AE'	UR.KRWW         
49CD'	UR.KSL          4A4C'	UR.MIMO         4B4D'	UR.NUM          
49E8'	UR.POSIK        4B6F'	UR.TAREP        62F1'	VERZ            
5B5F'	VORSP           678F'	VSCHR           6742'	VSTR            
6684'	VZVGL           66E8'	WEI             5C1D'	WRRES           
644A'	WRSTA           51D6'	XY.INCDX        5196'	XY.LDDX         
51A6'	XY.LIDX         51B6'	XY.STDX         51C6'	XY.STIDX        
60AC'	ZEIHO           4A9B'	ZINP            4AA1'	ZINP1           
4AA3'	ZINP2           4ACF'	ZINP3           4AD4'	ZINP4           
4ABD'	ZINP5           4ADC'	ZINP7           4B3D'	ZKON1           
4B17'	ZKONT           6031'	ZLTR            66FC'	ZYK             



No Fatal error(s)


    
6684'	VZVGL           66E8'	WEI             5C1D'	WRRES  