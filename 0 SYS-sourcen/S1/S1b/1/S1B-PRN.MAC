'EQUAL - Anweisungen fuer Assembler'	MACRO-80 3.44	09-Dec-81	PAGE	1


                                	TITLE 'EQUAL - Anweisungen fuer Assembler'
                                	PAGE	87
'EQUAL - Anweisungen fuer Assembler'	MACRO-80 3.44	09-Dec-81	PAGE	1-1


                                
  000B                          SY.SYSTB  EQU	0000BH
  0D00                          SM.FKTAB  EQU	00D00H
  0DA8                          SM.TABU   EQU   00DA8H
  21EF                          ATACO     EQU	021EFH
  3000                          SD.BWSA   EQU	03000H
  4026                          TA.ABFR1  EQU	04026H
  4033                          SY.SETCHL EQU	04033H
  4036                          SY.RESC   EQU	04036H
  4040                          PRINT     EQU	04040H
  4070                          PUF.KASS  EQU	04070H
                                
                         C      	INCLUDE K0.MAC	;EQUAL - Anweisungen fuer Assembler
                         C      ;         PN    UE01
                         C      ;****************************************************************
                         C      ;*                  EQUAL - Anweisungen fuer Assembler          *
                         C      ;****************************************************************
  00F7                   C      UE.TACL  EQU	0F7H    ;Kursor nach links
  00F9                   C      UE.TACR  EQU	0F9H    ; ''    nach rechts
  00CD                   C      UE.TASYS EQU	0CDH    ;SYS-Taste
  001E                   C      UE.TAQUI EQU	01EH    ;ET1
  007D                   C      UE.SVL   EQU	07DH    ;Laenge der SAVE-Bloecke
  0060                   C      UE.COTAL EQU	060H    ;Laenge ASC/KOI Codetabelle
  0132                   C      UE.KMPUL EQU	132H    ;max. Laenge E/A-Puffer
                         C      
  000B                   C      UE.SYSTB EQU	0000BH   ;SY.SYSTB
  0CFE                   C      UE.STANF EQU	00CFEH   ;STACK
  0DC4                   C      UE.EDEND EQU	00DC4H   ;Speicherpl. fuer Adr. Editorende
  0E5A                   C      UE.ZEIN  EQU	00E5AH   ;Pufferzaehler Eingabe
  0E66                   C      UE.PUF   EQU	00E66H   ;System-Puffer
  3000                   C      UE.BWSA  EQU	03000H   ;Bildwiederholspeicher
  8010                   C      UE.KPUFF EQU	08010H   ;E/A Puffer
  8830                   C      UE.TEXAN EQU	08830H   ;Begin Editorraum
                         C      
  5400'                  C      UE.BRKMB EQU	K1.BRKMB ;04000H	;phys. Kass.Routine
  5501'                  C      UE.CRC   EQU	K1.CRC   ;04740H	;CRC-Berechnung
                         C      
                         C      ;         END
                         C      ;         PN    UB
                         C                ORG   2B00H
  2B00'                  C      UB.ZN:    DS	1,0
  2B01'                  C      K0.HSB:   DS	1,0   ;HS-Bereich
  2B02'                  C      K0.LPD:   DS	1,0   ;Laenge der Daten im Puffer
  2B03'                  C      UB.KTAB:  DS	27,0  ;Originale Tabelle nach Robotron
  2B1E'                  C      UB.KTABE: DS	8,0   ;Tabelle fuer Kassetten im DEG2000 Emulator
  2B26'   0000           C      UB.PAR1:  DW	0
  2B28'   0000           C      UB.PAR2:  DW	0
  2B2A'   0000           C      UB.PAR3:  DW	0
  2B2C'   0000           C      UB.PAR4:  DW	0
  2B2E'   0000           C      UB.PAR5:  DW	0
  2B30'                  C      UB.PATAB: DS	4,0
  2B34'   00             C      UB.SATZ:  DB	0
  2B35'   37             C                DB	55
  2B36'   80             C                DB	80H
  2B37'                  C                DS	55,' '
  2B6E'                  C      UB.DTAB:  DS	41,0
  2B97'                  C      UB.END    EQU	$
                         C      ;         END
                         C      ;         PN    BC
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;        BEREICHE FUER KASSETTENKOPIEREN
                         C      ;
                         C      ;----------------------------------------------------------------------
  0000                   C      BC.EGG     EQU	0	;EINGABEGERAET
  0001                   C      BC.AGG     EQU	1	;AUSGABEGERAET
                         C      
  E000                   C      BC.TAB1    EQU	0E000H
  E002                   C      BC.VTABA   EQU	BC.TAB1  +    2
  EC82                   C      BC.VTABE   EQU	BC.VTABA + 3200
  F902                   C      BC.TAB2    EQU	BC.VTABE + 3200
  F96A                   C      BC.TAB2A   EQU	BC.TAB2  +  104
  F9D2                   C      BC.TAB3    EQU	BC.TAB2A +  104
  FA3A                   C      BC.END     EQU	BC.TAB3  +  104
                         C      ;	ORG	0E000H
                         C      ;BC.TAB1:   DS	2
                         C      ;
                         C      ;BC.EGG     EQU	0	;EINGABEGERAET
                         C      ;BC.AGG     EQU	1	;AUSGABEGERAET
                         C      ;----------------------------------------------------------------------
                         C      ;BC.VTABA:  DS	3200
                         C      ;BC.VTABE:  DS	3200
'EQUAL - Anweisungen fuer Assembler'	MACRO-80 3.44	09-Dec-81	PAGE	1-2


                         C      ;----------------------------------------------------------------------
                         C      ;BC.TAB2:   DS	104
                         C      ;BC.TAB2A:  DS	104
                         C      ;BC.TAB3:   DS	104
                         C      ;BC.END     EQU	$
                         C      ;----------------------------------------------------------------------
                         C      ;         END
                                ;
                                	ORG	05400H
                         C      	INCLUDE K1.MAC	;BAMOS/Emulator  ---  Kassettenmagnetband
                         C      	TITLE 'BAMOS/Emulator  ---  Kassettenmagnetband'
                         C      	PAGE
'BAMOS/Emulator  ---  Kassettenmagnetband'	MACRO-80 3.44	09-Dec-81	PAGE	1-3


                         C      
                         C      ;****************************************************************
                         C      ;*               BAMOS/Emulator  ---  Kassettenmagnetband       *
                         C      ;* OS - Version  -----------------------------------------------*
                         C      ;*               Programmierer: Marcus Herbote                  *
                         C      ;* V 1 . 2       -----------------------------------------------*
                         C      ;*               Stand        : 18.November 2022                *
                         C      ;****************************************************************
                         C      
                         C      ;****************************************************************
                         C      ;*               BAMOS/Robotron         Stand: 01.Januar 1981   *
                         C      ;*               -----------------------------------------------*
                         C      ;*               Geraetebedienroutine fuer Kassettenmagnetband  *
                         C      ;*               Anschluss von zwei Laufwerken K5200            *
                         C      ;*               an einer AKB K5020                             *
                         C      ;*               -----------------------------------------------*
                         C      ;*               E/A-Tabelle                                    *
                         C      ;*               Byte -2   HS-Bereich                           *
                         C      ;*               Byte -1   laenge der Daten im Puffer           *
                         C      ;*                         1, 10H, 20H, 80H                     *
                         C      ;*               -----------------------------------------------*
                         C      ;*               Byte  0   Status                               *
                         C      ;*               Byte  1   Fehlerschluessel                     *
                         C      ;*               Byte  2   Basisadresse der AKB                 *
                         C      ;*               Byte  3   Subadresse                           *
                         C      ;*               Byte  4   Kommando                             *
                         C      ;*               Byte  5   L-Teil Adresse Eintrittspunkt        *
                         C      ;*               Byte  6   H-Teil Adresse Eintrittspunkt        *
                         C      ;*               Byte  7   L-Teil Blockadresse                  *
                         C      ;*               Byte  8   H-Teil Blockadresse                  *
                         C      ;*               Byte  9   H-Teil Blocklaenge (Bit 15...Bit 8)  *
                         C      ;*               Byte 10   L-Teil Blocklaenge (Bit  7...Bit 0)  *
                         C      ;*                         n      bei suchen Bandmarke          *
                         C      ;*               Byte 11   Anzahl Lese-/Schreib wiederholen     *
                         C      ;*               Byte 12   Anzahl Blocklueckenverlaengerungen   *
                         C      ;****************************************************************
                         C      ;*               Bytes fuer die Uebergabe an den Z80-Emulator   *
                         C      ;*               -----------------------------------------------*
                         C      ;*               Byte 28 1 0F0H  Startbyte                      *
                         C      ;*               Byte 29 2       Kommando                       *
                         C      ;*               Byte 30 3       Subadresse                     *
                         C      ;*               Byte 31 4       Anzahl BM  bei 71, 75          *
                         C      ;*               Byte 31 4       'B'        bei 51              *
                         C      ;*               Byte 31 4       'S'        bei 61              *
                         C      ;*               Byte 31 4       HS-Bereich bei 02              *
                         C      ;*               Byte 31 4       Laenge     bei 08              *
                         C      ;*               Byte 31 4 0FFH             bei 31,41,21,11,15  *
                         C      ;*               Byte 32 5       H(Puffer)  bei 02              *
                         C      ;*               Byte 32 5       HS-Bereich bei 08              *
                         C      ;*               Byte 32 5 0FFH             bei 51,61,71,75     *
                         C      ;*               Byte 33 6       L(Puffer)  bei 02              *
                         C      ;*               Byte 33 6       H(Puffer)  bei 08              *
                         C      ;*               Byte 34 7       L(Puffer)  bei 08              *
                         C      ;*               Byte 34 7 0FFH             bei 02              *
                         C      ;*               Byte 35 8 0FFH             bei 08              *
                         C      ;****************************************************************
                         C      ;*               Kommandos:                                     *
                         C      ;*                 Hex   Kommando                               *
                         C      ;*                 02    naechsten Record einlesen              *
                         C      ;*                 08    naechsten Record schreiben             *
                         C      ;*                 11    einen Block vorsetzen                  *
                         C      ;*                 15    einen Block ruecksetzen                *
                         C      ;*                 21    umspulen                               *
                         C      ;*                 31    reservieren ein                        *
                         C      ;*                 41    reservieren aus                        *
                         C      ;*                 51    schreiben einer Bandmarke              *
                         C      ;*                 61    schreiben Schlussluecke                *
                         C      ;*                 71    suche n-te Bandmarke vorwaerts         *
                         C      ;*                 75    suche n-te Bandmarke rueckwaerts       *
                         C      ;****************************************************************
                         C      	PAGE
'BAMOS/Emulator  ---  Kassettenmagnetband'	MACRO-80 3.44	09-Dec-81	PAGE	1-4


                         C      
                         C      ;****************************************************************
                         C      ;*               Status                                         *
                         C      ;*               Bit 0     0 Geraet frei                        *
                         C      ;*                         1 Geraet besetzt                     *
                         C      ;*               Bit 1     0                                    *
                         C      ;*                         1 Datentraegerende                   *
                         C      ;*               Bit 2     0 Aufzeichnen erlaubt                *
                         C      ;*                         1 Aufzeichnen verboten               *
                         C      ;*               Bit 3     0 Kassettenseite A                   *
                         C      ;*                         1 Kassettenseite B                   *
                         C      ;*               Bit 4     0 Geraet       bereit                *
                         C      ;*                         1 Geraet nicht bereit                *
                         C      ;*               Bit 5     0 Geraet nicht reserviert            *
                         C      ;*                         1 Geraet       reserviert            *
                         C      ;*               Bit 6     0 Aufzeichnungsverf.  38 CM*S**-1    *
                         C      ;*                         1 Aufzeichnungsverf.  19 CM*S**-1    *
                         C      ;*               Bit 7     0 Kommando fehlerfrei ausgefuehrt    *
                         C      ;*                         1 Fehler (siehe Fehlerschluessel)    *
                         C      ;*               -----------------------------------------------*
                         C      ;*               Fehlerschluessel                               *
                         C      ;*                 Hex   Fehler                                 *
                         C      ;*                 10    falsches Kommando                      *
                         C      ;*                 11    angewaehltes Geraet nicht reserviert   *
                         C      ;*                 12    Subadresse falsch                      *
                         C      ;*                 13    Pufferl. kleiner 12 oder groesser 256  *
                         C      ;*                 14    Ende der Aufzeichnungen auf dieser     *
                         C      ;*                       Kassettenseite (Lesen)                 *
                         C      ;*                 15    angewaehltes Geraet besetzt            *
                         C      ;*                 16    Ende/Anfang der Aufzeichnungen         *
                         C      ;*                       (Bandmarke suchen)                     *
                         C      ;*                 17    gelesener Block laenger 260 Byte       *
                         C      ;*                 18    Bandmarke nicht gefunden               *
                         C      ;*                 19    Aufzeichnen verboten                   *
                         C      ;*                       (mit Kommando: Aufzeichnen)            *
                         C      ;****************************************************************
                         C      ;*               Hinweise zur Arbeit mit der Geraetebedienr.    *
                         C      ;*                - E/A-Tabelle laden (Basisadresse AKB)        *
                         C      ;*                - Adresse E/A-Tabelle in IX laden             *
                         C      ;*                - laden Schluessel fuer Kommando , Subadresse *
                         C      ;*                    Adresse Eintrittspunkt                    *
                         C      ;*                - Aufruf Geraetebedienroutine immer mit       *
                         C      ;*                    CALL   KR.BRKMB                           *
                         C      ;*                - wird keine Parallelarbeit mit anderen       *
                         C      ;*                  Programmen gewuenscht , kann wie in         *
                         C      ;*                  folgendem Beispiel verfahren werden:        *
                         C      ;*                        ...                                   *
                         C      ;*                        CALL KR.BRKMB ;Aufruf                 *
                         C      ;*                  MARKE:HALT                                  *
                         C      ;*                        JR   MARKE-#                          *
                         C      ;*                  ADREP:............  ;Adresse Eintrittspunkt *
                         C      ;*                        ...                                   *
                         C      ;*                - bei Rueckkehr der Bedienroutine zum Ein-    *
                         C      ;*                  trittspunkt ist die Adresse des folgenden   *
                         C      ;*                  Befehls , bei dem der letzte Interrupt      *
                         C      ;*                  angenommen wurde , noch im SP .             *
                         C      ;*                  Wird , wie im obigen Beispiel , diese       *
                         C      ;*                  Adresse nicht mehr benoetigt , so ist der   *
                         C      ;*                  SP  um 2 zu erhoehen.                       *
                         C      ;****************************************************************
                         C      	TITLE	'Steuerteil Geraetebedienroutine'
                         C          PAGE
'Steuerteil Geraetebedienroutine'	MACRO-80 3.44	09-Dec-81	PAGE	1-5


                         C      
                         C      ;	ORG	05400H
                         C      ;****************************************************************
                         C      ;*               Steuerteil der Geraetebedienroutine            *
                         C      ;****************************************************************
  5400'                  C      K1.BRKMB:
  5400'   F3             C          DI
  5401'   CD 54EA'       C          CALL    RRET
                         C      
                         C      ;****************************************************************
                         C      ;*               Analyse Kommando                               *
                         C      ;****************************************************************
  5404'   DD 7E 04       C          LD  A,(IX+4)
  5407'   FE 02          C          CP  002H    ;naechsten Record einlesen
  5409'   CA 549A'       C          JP  Z,STT02
  540C'   FE 08          C          CP  008H    ;naechsten Record schreiben
  540E'   CA 54B8'       C          JP  Z,STT08
  5411'   FE 11          C          CP  011H    ;einen Block vorsetzen
  5413'   CA 5472'       C          JP  Z,STT11
  5416'   FE 15          C          CP  015H    ;einen Block ruecksetzen
  5418'   CA 5472'       C          JP  Z,STT15
  541B'   FE 21          C          CP  021H    ;umspulen
  541D'   CA 5472'       C          JP  Z,STT21
  5420'   FE 31          C          CP  031H    ;reservieren ein
  5422'   CA 5472'       C          JP  Z,STT31
  5425'   FE 41          C          CP  041H    ;reservieren aus
  5427'   CA 5472'       C          JP  Z,STT41
  542A'   FE 51          C          CP  051H    ;schreiben einer Bandmarke
  542C'   CA 547E'       C          JP  Z,STT51
  542F'   FE 61          C          CP  061H    ;schreiben Schlussluecke
  5431'   CA 5482'       C          JP  Z,STT61
  5434'   FE 71          C          CP  071H    ;suche n-te Bandmarke vorwaerts
  5436'   CA 5486'       C          JP  Z,STT71
  5439'   FE 75          C          CP  075H    ;suche n-te Bandmarke rueckwaerts
  543B'   CA 5486'       C          JP  Z,STT75
  543E'   C3 54E6'       C          JP  STF07   ;falsches Kommando
                         C      
                         C      ;****************************************************************
                         C      ;*               Kernroutine MB                                 *
                         C      ;****************************************************************
  5441'                  C      K1.KERN:
  5441'   DD 36 1C F0    C          LD  (IX+28),0F0H
  5445'   DD 7E 04       C          LD  A,(IX+4)    ;Kommando
  5448'   DD 77 1D       C          LD  (IX+29),A
  544B'   DD 7E 03       C          LD  A,(IX+3)    ;Subadresse
  544E'   DD 77 1E       C          LD  (IX+30),A
                         C      
  5451'   DD 4E 02       C          LD  C,(IX+2)    ;Basisadresse der AKB
  5454'   DD E5          C          PUSH    IX
  5456'   E1             C          POP HL
  5457'   11 001C        C          LD  DE,28
  545A'   19             C          ADD  HL,DE
  545B'   ED B3          C          OTIR            ;KM - Routine aufrufen
  545D'   DD E5          C          PUSH    IX
  545F'   E1             C          POP HL
  5460'   2B             C          DEC HL
  5461'   2B             C          DEC HL
  5462'   06 04          C          LD  B,4
  5464'   ED B2          C          INIR            ;Status und Fehler holen
  5466'   2B             C          DEC HL          ;Laenge der Daten im Puffer holen
  5467'   2B             C          DEC HL
  5468'   2B             C          DEC HL
  5469'   DD 36 09 00    C          LD  (IX+9),0
  546D'   7E             C          LD  A,(HL)
  546E'   DD 77 0A       C          LD  (IX+10),A
  5471'   C9             C          RET
                         C          TITLE   '4-/5-Byte IO-Kommandos'
                         C          PAGE
'4-/5-Byte IO-Kommandos'	MACRO-80 3.44	09-Dec-81	PAGE	1-6


                         C      
                         C      ;****************************************************************
                         C      ;*               reservieren ein / aus                          *
                         C      ;****************************************************************
  5472'                  C      STT31:
  5472'                  C      STT41:
                         C      ;****************************************************************
                         C      ;*               umspulen                                       *
                         C      ;****************************************************************
  5472'                  C      STT21:
                         C      ;****************************************************************
                         C      ;*               vor-/ruecksetzen um einen Block                *
                         C      ;****************************************************************
  5472'                  C      STT11:
  5472'                  C      STT15:
  5472'   DD 36 1F FF    C          LD  (IX+31),0FFH
                         C      
  5476'   06 04          C          LD  B,4
  5478'   CD 5441'       C          CALL K1.KERN
  547B'   C3 54F7'       C          JP	KOMED	;Kommandoende
                         C      
                         C      ;****************************************************************
                         C      ;*               schreiben einer Bandmarke                      *
                         C      ;****************************************************************
  547E'                  C      STT51:
  547E'   3E 42          C          LD  A,'B'
  5480'   18 09          C          JR  STT5
                         C      ;****************************************************************
                         C      ;*               schreiben einer Schlussluecke                  *
                         C      ;****************************************************************
  5482'                  C      STT61:
  5482'   3E 53          C          LD  A,'S'
  5484'   18 05          C          JR  STT5
                         C      ;****************************************************************
                         C      ;*               suche Bandmarke vorwaerts / rueckwaerts        *
                         C      ;****************************************************************
  5486'                  C      STT71:
  5486'                  C      STT75:
  5486'   DD 7E 0A       C          LD  A,(IX+10)
  5489'   18 00          C          JR  STT5
  548B'                  C      STT5:
  548B'   DD 77 1F       C          LD  (IX+31),A
  548E'   DD 36 20 FF    C          LD  (IX+32),0FFH
                         C      
  5492'   06 05          C          LD  B,5
  5494'   CD 5441'       C          CALL K1.KERN
  5497'   C3 54F7'       C          JP	KOMED	;Kommandoende
                         C      
                         C          TITLE   '7-/8-Byte IO-Kommandos'
                         C          PAGE
'7-/8-Byte IO-Kommandos'	MACRO-80 3.44	09-Dec-81	PAGE	1-7


                         C      
                         C      ;****************************************************************
                         C      ;*               Eingabezweig                                   *
                         C      ;****************************************************************
  549A'                  C      STT02:
  549A'   3A 2B01'       C          LD  A,(K0.HSB)   ;HS-Bereich
  549D'   DD 77 1F       C          LD  (IX+31),A
                         C      
  54A0'   DD 7E 07       C          LD  A,(IX+7)
  54A3'   DD 77 20       C          LD  (IX+32),A
  54A6'   DD 7E 08       C          LD  A,(IX+8)
  54A9'   DD 77 21       C          LD  (IX+33),A
                         C      
  54AC'   DD 36 22 FF    C          LD  (IX+34),0FFH
                         C      
  54B0'   06 07          C          LD  B,7
  54B2'   CD 5441'       C          CALL K1.KERN
  54B5'   C3 54F7'       C          JP	KOMED	;Kommandoende
                         C      
                         C      ;****************************************************************
                         C      ;*               Aufzeichnungszweig                             *
                         C      ;****************************************************************
  54B8'                  C      STT08:
  54B8'   DD 7E 0A       C          LD  A,(IX+10)   ;Laenge der Daten im Puffer
  54BB'   DD 77 1F       C          LD  (IX+31),A
                         C      
  54BE'   3A 2B01'       C          LD  A,(K0.HSB)   ;HS-Bereich
  54C1'   DD 77 20       C          LD  (IX+32),A
                         C      
  54C4'   DD 7E 07       C          LD  A,(IX+7)
  54C7'   DD 77 21       C          LD  (IX+33),A
  54CA'   DD 7E 08       C          LD  A,(IX+8)
  54CD'   DD 77 22       C          LD  (IX+34),A
                         C      
  54D0'   DD 36 23 FF    C          LD  (IX+35),0FFH
                         C      
  54D4'   06 08          C          LD  B,8
  54D6'   CD 5441'       C          CALL K1.KERN
  54D9'   C3 54F7'       C          JP	KOMED	;Kommandoende
                         C      
                         C          PAGE
'7-/8-Byte IO-Kommandos'	MACRO-80 3.44	09-Dec-81	PAGE	1-8


                         C      
                         C      ;****************************************************************
                         C      ;*               Fehler                                         *
                         C      ;****************************************************************
  54DC'                  C      STF99:
  54DC'   DD 75 01       C      	LD	(IX+1),L	;Fehlerschluessel laden
  54DF'   DD CB 00 FE    C      	SET	7,(IX+0)	;Fehlerbit setzen
  54E3'                  C      STFRS:
  54E3'   C3 54F7'       C      	JP	KOMED	;Kommandoende
                         C      
  54E6'                  C      STF07:
  54E6'   2E 10          C      	LD	L,10H	;falsches Kommando
  54E8'   18 F2          C      	JR	STF99
                         C      
                         C          PAGE
'7-/8-Byte IO-Kommandos'	MACRO-80 3.44	09-Dec-81	PAGE	1-9


                         C      
                         C      ;****************************************************************
                         C      ;*               Register AF , BC , DE , HL retten in SP        *
                         C      ;****************************************************************
  54EA'                  C      RRET:
  54EA'   E3             C          EX  (SP),HL
  54EB'   D5             C      	PUSH	DE
  54EC'   C5             C      	PUSH	BC
  54ED'   F5             C      	PUSH	AF
  54EE'   E9             C          JP  (HL)
                         C      ;****************************************************************
                         C      ;*               Register AF , BC , DE , HL laden aus SP        *
                         C      ;****************************************************************
  54EF'                  C      RLAD:
  54EF'   E3             C          EX  (SP),HL
  54F0'   33             C          INC SP
  54F1'   33             C          INC SP
  54F2'   F1             C      	POP	AF
  54F3'   C1             C      	POP	BC
  54F4'   D1             C      	POP	DE
  54F5'   E3             C          EX  (SP),HL
  54F6'   C9             C      	RET
                         C      
                         C      ;****************************************************************
                         C      ;*               Verzweigung aus Steuerteil zum Eintrittspunkt  *
                         C      ;*               des Steuerprogrammes                           *
                         C      ;****************************************************************
  54F7'                  C      KOMED:
  54F7'   F3             C      	DI
  54F8'   DD CB 00 86    C      	RES 0,(IX)
  54FC'   CD 54EF'       C      	CALL	RLAD
  54FF'   FB             C      	EI
  5500'   C9             C      	RET
                         C          PAGE
'7-/8-Byte IO-Kommandos'	MACRO-80 3.44	09-Dec-81	PAGE	1-10


                         C      
                         C      ;****************************************************************
                         C      ;*               CRC-Zeichen berechnen                          *
                         C      ;*               <B>  = Blocklaenge , 0 = 256                   *
                         C      ;*               <HL> = Pufferadresse                           *
                         C      ;*               in  DE  nach Aufruf CRC-Zeichen                *
                         C      ;*                <D> = 1.Byte , wird zuerst gesendet           *
                         C      ;*                <E> = 2.Byte , wird danach gesendet           *
                         C      ;****************************************************************
  5501'                  C      K1.CRC:
  5501'   11 0000        C      	LD	DE,0
  5504'                  C      CRC0:
  5504'   C5             C      	PUSH	BC	;Bytelaenge
  5505'   06 08          C      	LD	B,8
  5507'   4E             C      	LD	C,(HL)
  5508'                  C      CRC1:
  5508'   79             C      	LD	A,C
  5509'   AA             C      	XOR	D
  550A'   0F             C      	RRCA		;Ergebnis Antivalenz Wort-Byte/CRC-Byte,Bit 0
  550B'   F5             C      	PUSH	AF
  550C'   CB 1B          C      	RR	E	;Verschiebung von DE um 1 Bit nach rechts
  550E'   CB 1A          C      	RR	D
  5510'   F1             C      	POP	AF	;Rueckretten F
  5511'   30 08          C      	JR	NC,CRC2	;Sprung wenn Antivalenz 0 + 0 = 0
  5513'   7A             C      	LD	A,D	;Korrektur = Umkehr Bit 13/Bit 0
  5514'   EE 01          C      	XOR	1	;Maske fuer D
  5516'   57             C      	LD	D,A	;Korrektur  D
  5517'   7B             C      	LD	A,E
  5518'   EE 20          C      	XOR	20H	;Maske fuer E
  551A'   5F             C      	LD	E,A	;Korrektur  E
  551B'                  C      CRC2:
  551B'   CB 09          C      	RRC	C	;Schieben Datenbyte
  551D'   10 E9          C      	DJNZ	CRC1
  551F'   C1             C      	POP	BC	;Byte abgearbeitet
  5520'   0B             C      	DEC	BC
  5521'   79             C      	LD	A,C
  5522'   B0             C      	OR	B
  5523'   C8             C      	RET	Z
  5524'   23             C      	INC	HL
  5525'   18 DD          C      	JR	CRC0
                         C      
                         C      ;	END
                                ;
                                ;	INCLUDE	KR.MAC	;Kassettengrundroutinen
                                ;	INCLUDE	UF.MAC	;Fehleranzeige und Behandlung
                                ;	INCLUDE	UA.MAC	;Ausschriften
                         C      	INCLUDE K2.MAC	;Grundroutinen
                         C      	TITLE	'Kassettengrundroutinen'
                         C      	PAGE
'Kassettengrundroutinen'	MACRO-80 3.44	09-Dec-81	PAGE	1-11


                         C      
                         C      ;****************************************************************
                         C      ;*               Anschlussroutinen fuer BAMOS/Emulator          *
                         C      ;* OS - Version  -----------------------------------------------*
                         C      ;*               Programmierer: Marcus Herbote                  *
                         C      ;* V 1 . 2       -----------------------------------------------*
                         C      ;*               Stand        : 18.November 2022                *
                         C      ;****************************************************************
                         C      ;	PN	KR
                         C      ;---------------------------------------------------------------------
                         C      ;        Kassettengrundroutinen
                         C      ;---------------------------------------------------------------------
  5527'   5527'          C      	DW	$
  5529'   4B 31 52 45    C      	DB	'K1RE'
  552D'                  C      KR.GR1:
  552D'   3E 01          C      	LD	A,01H
  552F'   18 08          C      	JR	KR.GR3
                         C      ;
  5531'   5531'          C      	DW	$
  5533'   4B 32 52 45    C      	DB	'K2RE'
  5537'                  C      KR.GR2:
  5537'   3E 02          C      	LD	A,02H
  5539'                  C      KR.GR3:
  5539'   CD 6DA9'       C      	CALL	U1.KTINI
  553C'   DD 77 03       C      	LD	(IX+3),A
  553F'   CD 6ACA'       C      	CALL	UR.KRE
  5542'   C9             C      	RET
                         C      ;-------------------------------------------------------------------
  5543'   5543'          C      	DW	$
  5545'   4B 31 4C 2B    C      	DB	'K1L+'
  5549'   CD 552D'       C      	CALL	KR.GR1
  554C'   18 09          C      	JR	$+11
                         C      ;
  554E'   554E'          C      	DW	$
  5550'   4B 32 4C 2B    C      	DB	'K2L+'
  5554'   CD 5537'       C      	CALL	KR.GR2
  5557'   21 0001        C      	LD	HL,1	; IX + 10 := 1 / Anzahl BM
  555A'   CD 6EE8'       C      	CALL	XY.STDX
  555D'   09             C      	DB	9
  555E'   CD 6AE2'       C      	CALL	UR.KLV
  5561'   C9             C      	RET
                         C      ;---------------------------------------------------------------------
  5562'   5562'          C      	DW	$
  5564'   4B 31 4C 2D    C      	DB	'K1L-'
  5568'   CD 552D'       C      	CALL	KR.GR1
  556B'   18 09          C      	JR	$+11
                         C      ;
  556D'   556D'          C      	DW	$
  556F'   4B 32 4C 2D    C      	DB	'K2L-'
  5573'   CD 5537'       C      	CALL	KR.GR2
  5576'   21 0001        C      	LD	HL,1	; IX + 10 := 1 / Anzahl BM
  5579'   CD 6EE8'       C      	CALL	XY.STDX
  557C'   09             C      	DB	9
  557D'   CD 6AE8'       C      	CALL	UR.KLR
  5580'   C9             C      	RET
                         C      ;---------------------------------------------------------------------
  5581'   5581'          C      	DW	$
  5583'   4B 31 52 2B    C      	DB	'K1R+'
  5587'   CD 552D'       C      	CALL	KR.GR1
  558A'   18 09          C      	JR	$+11
                         C      ;
  558C'   558C'          C      	DW	$
  558E'   4B 32 52 2B    C      	DB	'K2R+'
  5592'   CD 5537'       C      	CALL	KR.GR2
  5595'   CD 6AFA'       C      	CALL	UR.KBV
  5598'   C9             C      	RET
                         C      ;--------------------------------------------------------------------
  5599'   5599'          C      	DW	$
  559B'   4B 31 52 2D    C      	DB	'K1R-'
  559F'   CD 552D'       C      	CALL	KR.GR1
  55A2'   18 09          C      	JR	$+11
                         C      ;
  55A4'   55A4'          C      	DW	$
  55A6'   4B 32 52 2D    C      	DB	'K2R-'
  55AA'   CD 5537'       C      	CALL	KR.GR2
  55AD'   CD 6B00'       C      	CALL	UR.KBR
  55B0'   C9             C      	RET
                         C      ;--------------------------------------------------------------------
  55B1'   55B1'          C      	DW	$
  55B3'   4B 31 52 57    C      	DB	'K1RW'
  55B7'   CD 552D'       C      	CALL	KR.GR1
  55BA'   18 09          C      	JR	$+11
'Kassettengrundroutinen'	MACRO-80 3.44	09-Dec-81	PAGE	1-12


                         C      ;
  55BC'   55BC'          C      	DW	$
  55BE'   4B 32 52 57    C      	DB	'K2RW'
  55C2'   CD 5537'       C      	CALL	KR.GR2
  55C5'   CD 6AD2'       C      	CALL	UR.KRW
  55C8'   18 14          C      	JR	KR.CKRA
                         C      ;---------------------------------------------------------------------
  55CA'   55CA'          C      	DW	$
  55CC'   4B 31 52 41    C      	DB	'K1RA'
  55D0'   CD 552D'       C      	CALL	KR.GR1
  55D3'   18 09          C      	JR	$+11
                         C      ;
  55D5'   55D5'          C      	DW	$
  55D7'   4B 32 52 41    C      	DB	'K2RA'
  55DB'   CD 5537'       C      	CALL	KR.GR2
  55DE'                  C      KR.CKRA:
  55DE'   CD 6ADC'       C      	CALL	UR.KRA
  55E1'   C9             C      	RET
                         C      ;---------------------------------------------------------------------
  55E2'                  C      KR.KARO:
  55E2'   CD 5400'       C      	CALL	UE.BRKMB	;AUFRUF PHYS.KASS.ROUTINE
  55E5'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  55E6'                  C      KR.VORSP:
  55E6'   11 3327        C      	LD	DE,UE.BWSA+327H
  55E9'   CD 7028'       C      	CALL	UC.CVDB
  55EC'   45             C      	LD	B,L
  55ED'   3E 46          C      	LD	A,'F'
  55EF'   32 2B28'       C      	LD	(UB.PAR2),A
  55F2'   CD 6ACA'       C      	CALL	UR.KRE
  55F5'   CD 6B0F'       C      	CALL	UR.POSIK
  55F8'   C9             C      	RET
                         C      ;---------------------------------------------------------------------
  55F9'   55F9'          C      	DW	$
  55FB'   58 4B 41 31    C      	DB	'XKA1'
  55FF'   CD 552D'       C      	CALL	KR.GR1
  5602'   18 09          C      	JR	$+11
                         C      ;
  5604'   5604'          C      	DW	$
  5606'   58 4B 41 32    C      	DB	'XKA2'
  560A'   CD 5537'       C      	CALL	KR.GR2
  560D'   CD 55E6'       C      	CALL	KR.VORSP
  5610'   CD 5FC9'       C      	CALL	FD.FDINP
  5613'   CD 6AD2'       C      	CALL	UR.KRW
  5616'   CD 6ADC'       C      	CALL	UR.KRA
  5619'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  561A'   561A'          C      	DW	$
  561C'   59 4B 41 31    C      	DB	'YKA1'
  5620'   CD 552D'       C      	CALL	KR.GR1
  5623'   18 09          C      	JR	KR.YKA1	;$+11
                         C      ;
  5625'   5625'          C      	DW	$
  5627'   59 4B 41 32    C      	DB	'YKA2'
  562B'   CD 5537'       C      	CALL	KR.GR2
  562E'                  C      KR.YKA1:
  562E'   CD 6ACA'       C      	CALL	UR.KRE
  5631'   11 3327        C      	LD	DE,UE.BWSA+327H
  5634'   CD 7028'       C      	CALL	UC.CVDB
  5637'   2D             C      	DEC	L
  5638'   28 09          C      	JR	Z,KR.YKA2	;$+11
  563A'   DD 75 0A       C      	LD	(IX+10),L
  563D'   CD 566A'       C      	CALL	KR.TYPT
  5640'   CD 6AE2'       C      	CALL	UR.KLV
  5643'                  C      KR.YKA2:
  5643'   CD 601C'       C      	CALL	FD.FDOUT
  5646'   C9             C      	RET
                         C      ;---------------------------------------------------------------------------
  5647'   5647'          C      	DW	$
  5649'   4B 31 43 4C    C      	DB	'K1CL'
  564D'   CD 552D'       C      	CALL	KR.GR1
  5650'   18 09          C      	JR	KR.KCL	;$+11
                         C      ;
  5652'   5652'          C      	DW	$
  5654'   4B 32 43 4C    C      	DB	'K2CL'
  5658'   CD 5537'       C      	CALL	KR.GR2
  565B'                  C      KR.KCL:
  565B'   CD 6AEE'       C      	CALL	UR.KBM
  565E'   CD 6AF4'       C      	CALL	UR.KSL
  5661'   CD 6AD2'       C      	CALL	UR.KRW
  5664'   CD 6ADC'       C      	CALL	UR.KRA
  5667'   C3 000B        C      	JP	UE.SYSTB
                         C      ;--------------------------------------------------------------------
'Kassettengrundroutinen'	MACRO-80 3.44	09-Dec-81	PAGE	1-13


  566A'                  C      KR.TYPT:
  566A'   13             C      	INC	DE
  566B'   1A             C      	LD	A,(DE)
  566C'   32 2B28'       C      	LD	(UB.PAR2),A
  566F'   C9             C      	RET
                         C      ;--------------------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Fehleranzeige und Behandlung'
                         C      	PAGE
'Fehleranzeige und Behandlung'	MACRO-80 3.44	09-Dec-81	PAGE	1-14


                         C      
                         C      ;	PN	UF
                         C      ;***************************************************************
                         C      ;
                         C      ;      Fehleranzeige  UND  BEHANDLUNG
                         C      ;
                         C      ;***************************************************************
  5670'                  C      UF.RET:
  5670'   F1             C      	POP	AF
  5671'   C1             C      	POP	BC
  5672'   D1             C      	POP	DE
  5673'   E1             C      	POP	HL
  5674'   C9             C      	RET
                         C      ;---------------------Ausfhr. Kass.kommando lt.Steuerblock-------------
  5675'                  C      UF.EXEC:
  5675'   E5             C      	PUSH	HL
  5676'   D5             C      	PUSH	DE
  5677'   C5             C      	PUSH	BC
  5678'   F5             C      	PUSH	AF
  5679'   DD CB 00 BE    C      	RES	7,(IX)
  567D'   DD 36 01 00    C      	LD	(IX+1),0
                         C      	;JP	KO.KO05
                         C      
  5681'   3E 01          C      	LD	A,1
  5683'   32 2B01'       C      	LD	(K0.HSB),A	;HS-Bereich
  5686'   DD 7E 04       C      	LD	A,(IX+4)	;Kommando
  5689'   FE 71          C      	CP	071H
  568B'   28 0C          C      	JR	Z,UF.EXEC2
  568D'   FE 75          C      	CP	075H
  568F'   28 08          C      	JR	Z,UF.EXEC2
  5691'   DD 36 07 0E    C      	LD	(IX+7),HIGH(UE.PUF)
  5695'   DD 36 08 66    C      	LD	(IX+8),LOW(UE.PUF)
  5699'                  C      UF.EXEC2:
  5699'   CD 55E2'       C      	CALL	KR.KARO
  569C'                  C      UF.EXEC1:
  569C'   DD CB 00 7E    C      	BIT	7,(IX)	;Status
  56A0'   28 CE          C      	JR	Z,UF.RET
  56A2'   DD 7E 01       C      	LD	A,(IX+1)	;FehlerschlC<ssel
                         C      ;-------------------------Fehlerbehandlung---------------
  56A5'                  C      UF.ERANZ:
  56A5'   E5             C      	PUSH	HL
  56A6'   D5             C      	PUSH	DE
  56A7'   C5             C      	PUSH	BC
  56A8'   F5             C      	PUSH	AF
  56A9'   F5             C      	PUSH	AF
  56AA'   3E 13          C      	LD	A,19
  56AC'   32 2B00'       C      	LD	(UB.ZN),A
  56AF'   21 5908'       C      	LD	HL,UA.ZKF	;IN: <A> Fehlerschluessel
  56B2'   CD 6B72'       C      	CALL	UR.MIMO
  56B5'   F1             C      	POP	AF
  56B6'   F5             C      	PUSH	AF
  56B7'   EB             C      	EX	DE,HL
  56B8'   CD 6F6C'       C      	CALL	UC.CVBX+2
  56BB'   F1             C      	POP	AF
  56BC'   FE 17          C      	CP	17H
  56BE'   CA 5740'       C      	JP	Z,UF.FL17
  56C1'   FE 18          C      	CP	18H
  56C3'   CA 5734'       C      	JP	Z,UF.FL18
  56C6'   FE 00          C      	CP	00H
  56C8'   CA 5726'       C      	JP	Z,UF.BEHB
  56CB'   FE 11          C      	CP	11H
  56CD'   CA 5726'       C      	JP	Z,UF.BEHB
  56D0'   FE 19          C      	CP	19H
  56D2'   28 1D          C      	JR	Z,UF.AZVB
  56D4'   FE 14          C      	CP	14H
  56D6'   CA 5743'       C      	JP	Z,UF.FL14
  56D9'   FE 16          C      	CP	16H
  56DB'   CA 5746'       C      	JP	Z,UF.FL16
  56DE'   C3 5670'       C      	JP	UF.RET		;??? 22H 21H nicht C<bernommen!
                         C      ;----------------------------------------------------------------------
  56E1'                  C      UF.SYS:
  56E1'   DD 7E 01       C      	LD	A,(IX+1)
  56E4'   11 35A8        C      	LD	DE,UE.BWSA+5A8H
  56E7'   CD 6F6C'       C      	CALL	UC.CVBX+2
  56EA'   00             C      	NOP
  56EB'   00             C      	NOP
  56EC'   00             C      	NOP
  56ED'                  C      UF.SYS1:
  56ED'   31 0CFE        C      	LD	SP,UE.STANF
  56F0'   C9             C      	RET
                         C      ;----------------------------------------------------------
  56F1'                  C      UF.AZVB:
'Fehleranzeige und Behandlung'	MACRO-80 3.44	09-Dec-81	PAGE	1-15


  56F1'   DD CB 00 96    C      	RES	2,(IX)	;Aufzeichnen verboten
  56F5'   DD 36 04 41    C      	LD	(IX+4),41H
  56F9'   CD 55E2'       C      	CALL	KR.KARO
  56FC'   DD CB 00 7E    C      	BIT	7,(IX)
  5700'   20 DF          C      	JR	NZ,UF.SYS
  5702'   21 5878'       C      	LD	HL,UA.FRZ
  5705'   CD 6B72'       C      	CALL	UR.MIMO
  5708'   38 E3          C      	JR	C,UF.SYS1
  570A'   DD 36 04 31    C      	LD	(IX+4),31H
  570E'   CD 55E2'       C      	CALL	KR.KARO
  5711'   DD CB 00 66    C      	BIT	4,(IX+0)
  5715'   20 CA          C      	JR	NZ,UF.SYS
  5717'   DD CB 00 7E    C      	BIT	7,(IX+0)
  571B'   20 C4          C      	JR	NZ,UF.SYS
  571D'   DD CB 00 56    C      	BIT	2,(IX+0)
  5721'   20 BE          C      	JR	NZ,UF.SYS
  5723'   C3 572E'       C      	JP	UF.BEHB1	;??? KO.KO04
                         C      ;----------------------------------------------------------
  5726'                  C      UF.BEHB:
  5726'   21 5878'       C      	LD	HL,UA.FRZ
  5729'   CD 6B72'       C      	CALL	UR.MIMO
  572C'   38 BF          C      	JR	C,UF.SYS1
  572E'                  C      UF.BEHB1:
  572E'   DD 71 04       C      	LD	(IX+4),C	;??? Inhalt von C
  5731'   C3 5679'       C      	JP	UF.EXEC+4
                         C      ;---------------------------------------
  5734'                  C      UF.FL18:
  5734'   21 587E'       C      	LD	HL,UA.BMGF
  5737'   CD 6B72'       C      	CALL	UR.MIMO
  573A'   DA 56ED'       C      	JP	C,UF.SYS1
  573D'   C3 5670'       C      	JP	UF.RET
                         C      ;------------------------------------------
  5740'                  C      UF.FL17:
  5740'   C3 5670'       C      	JP	UF.RET
                         C      ;-------------------------------------
  5743'                  C      UF.FL14:
  5743'   C3 5670'       C      	JP	UF.RET
                         C      
  5746'                  C      UF.FL16:
  5746'   21 5878'       C      	LD	HL,UA.FRZ
  5749'   CD 6B72'       C      	CALL	UR.MIMO
  574C'   C3 5670'       C      	JP	UF.RET
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                         C          PAGE
'Fehleranzeige und Behandlung'	MACRO-80 3.44	09-Dec-81	PAGE	1-16


                         C      
                         C      ;--------------------------------------------------------------------
                         C      	TITLE	'Ausschriften'
                         C      	PAGE
'Ausschriften'	MACRO-80 3.44	09-Dec-81	PAGE	1-17


                         C      
                         C      ;	PN	UA01
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;     AUSSCHRIFTEN
                         C      ;
                         C      ;----------------------------------------------------------------------
  574F'                  C      UA.DS:
  574F'   00             C      	DB	0
  5750'   01             C      	DB	1
  5751'   00             C      	DB	0
  5752'   01             C      	DB	1
  5753'   20 20 44 53    C      	DB	'  DS************   '
  5757'   2A 2A 2A 2A    C      
  575B'   2A 2A 2A 2A    C      
  575F'   2A 2A 2A 2A    C      
  5763'   20 20 20       C      
  5766'   01             C      	DB	1
  5767'   00             C      	DB	0
  5768'   00             C      	DB	0
  5769'   00             C      	DB	0
  576A'   00             C      	DB	0
  576B'   00             C      	DB	0
  576C'   00             C      	DB	0
  576D'   00             C      	DB	0
  576E'   00             C      	DB	0
                         C      ;----------------------------------------------------------------------
  576F'                  C      UA.KNAME:
  576F'   06             C      	DB	06H
  5770'   10             C      	DB	16
  5771'   40             C      	DB	40H
  5772'   20 4B 61 73    C      	DB	' KassettenName: '
  5776'   73 65 74 74    C      
  577A'   65 6E 4E 61    C      
  577E'   6D 65 3A 20    C      
  5782'                  C      UA.NR:
  5782'   03             C      	DB	03H
  5783'   10             C      	DB	16
  5784'   40             C      	DB	40H
  5785'   20 4B 61 73    C      	DB	' Kassetten-Nr.: '
  5789'   73 65 74 74    C      
  578D'   65 6E 2D 4E    C      
  5791'   72 2E 3A 20    C      
  5795'                  C      UA.KOMMT:
  5795'   0B             C      	DB	0BH
  5796'   10             C      	DB	16
  5797'   80             C      	DB	80H
  5798'   20 20 20 20    C      	DB	'     Kommentar: '
  579C'   20 4B 6F 6D    C      
  57A0'   6D 65 6E 74    C      
  57A4'   61 72 3A 20    C      
                         C      ;----------------------------------------------------------------------
  57A8'                  C      UA.Z7E:
  57A8'   45 69 6E 67    C      	DB	'Eingabe      =====>     Ausgabe'
  57AC'   61 62 65 20    C      
  57B0'   20 20 20 20    C      
  57B4'   20 3D 3D 3D    C      
  57B8'   3D 3D 3E 20    C      
  57BC'   20 20 20 20    C      
  57C0'   41 75 73 67    C      
  57C4'   61 62 65       C      
  57C7'                  C      UA.GER:
  57C7'   20 20 20 20    C      	DB	'       Geraet: '
  57CB'   20 20 20 47    C      
  57CF'   65 72 61 65    C      
  57D3'   74 3A 20       C      
                         C      ;----------------------------------------------------------------------
  57D6'                  C      UA.KOPFR:
  57D6'   01             C      	DB	01H
  57D7'   33             C      	DB	51
  57D8'   80             C      	DB	80H
  57D9'   20 20 20 20    C      	DB	'                Datei               kopieren J/N ? '
  57DD'   20 20 20 20    C      
  57E1'   20 20 20 20    C      
  57E5'   20 20 20 20    C      
  57E9'   44 61 74 65    C      
  57ED'   69 20 20 20    C      
  57F1'   20 20 20 20    C      
  57F5'   20 20 20 20    C      
  57F9'   20 20 20 20    C      
  57FD'   6B 6F 70 69    C      
  5801'   65 72 65 6E    C      
'Ausschriften'	MACRO-80 3.44	09-Dec-81	PAGE	1-18


  5805'   20 4A 2F 4E    C      
  5809'   20 3F 20       C      
  580C'                  C      UA.EABFR:
  580C'   01             C      	DB	01H
  580D'   33             C      	DB	51
  580E'   80             C      	DB	80H
  580F'   20 20 20 20    C      	DB	'                Eingaben in Ordnung  ---->   J/N ? '
  5813'   20 20 20 20    C      
  5817'   20 20 20 20    C      
  581B'   20 20 20 20    C      
  581F'   45 69 6E 67    C      
  5823'   61 62 65 6E    C      
  5827'   20 69 6E 20    C      
  582B'   4F 72 64 6E    C      
  582F'   75 6E 67 20    C      
  5833'   20 2D 2D 2D    C      
  5837'   2D 3E 20 20    C      
  583B'   20 4A 2F 4E    C      
  583F'   20 3F 20       C      
  5842'                  C      UA.VORH:
  5842'   01             C      	DB	1
  5843'   33             C      	DB	51
  5844'   80             C      	DB	80H
  5845'   2A 2A 2A 2A    C      	DB	'************* Datei vorh.;SYS-Ende,kopieren  J/N ? '
  5849'   2A 2A 2A 2A    C      
  584D'   2A 2A 2A 2A    C      
  5851'   2A 20 44 61    C      
  5855'   74 65 69 20    C      
  5859'   76 6F 72 68    C      
  585D'   2E 3B 53 59    C      
  5861'   53 2D 45 6E    C      
  5865'   64 65 2C 6B    C      
  5869'   6F 70 69 65    C      
  586D'   72 65 6E 20    C      
  5871'   20 4A 2F 4E    C      
  5875'   20 3F 20       C      
                         C      ;----------------------------------------------------------------------
  5878'                  C      UA.FRZ:
  5878'   02             C      	DB	2
  5879'   03             C      	DB	3
  587A'   80             C      	DB	80H
  587B'   3F 3F 20       C      	DB	'?? '
  587E'                  C      UA.BMGF:
  587E'   01             C      	DB	01H
  587F'   07             C      	DB	7
  5880'   80             C      	DB	80H
  5881'   42 4D 20 21    C      	DB	'BM ! ??'
  5885'   20 3F 3F       C      
  5888'                  C      UA.DOK:
  5888'   00             C      	DB	0
  5889'   04             C      	DB	4
  588A'   80             C      	DB	80H
  588B'   69 2E 4F 2E    C      	DB	'i.O.'
  588F'                  C      UA.DF:
  588F'   00             C      	DB	0
  5890'   04             C      	DB	4
  5891'   80             C      	DB	80H
  5892'   46 68 6C 2E    C      	DB	'Fhl.'
                         C      ;----------------------------------------------------------------------
  5896'                  C      UA.ZKDAT:
  5896'   06             C      	DB	6
  5897'   10             C      	DB	16
  5898'   40             C      	DB	40H
  5899'   20 20 20 20    C      	DB	'     Dateiname: '
  589D'   20 44 61 74    C      
  58A1'   65 69 6E 61    C      
  58A5'   6D 65 3A 20    C      
  58A9'                  C      UA.ZKLAD:
  58A9'   04             C      	DB	4
  58AA'   10             C      	DB	16
  58AB'   08             C      	DB	08H
  58AC'   20 20 20 4C    C      	DB	'   Ladeadresse: '
  58B0'   61 64 65 61    C      
  58B4'   64 72 65 73    C      
  58B8'   73 65 3A 20    C      
                         C      ;------------------------------------------------------------------
  58BC'                  C      UA.ZKBEG:
  58BC'   04             C      	DB	4
  58BD'   10             C      	DB	16
  58BE'   08             C      	DB	08H
  58BF'   20 20 20 20    C      	DB	'        Beginn: '
  58C3'   20 20 20 20    C      
  58C7'   42 65 67 69    C      
'Ausschriften'	MACRO-80 3.44	09-Dec-81	PAGE	1-19


  58CB'   6E 6E 3A 20    C      
  58CF'                  C      UA.ZKEND:
  58CF'   04             C      	DB	4
  58D0'   10             C      	DB	16
  58D1'   08             C      	DB	08H
  58D2'   20 20 20 20    C      	DB	'          Ende: '
  58D6'   20 20 20 20    C      
  58DA'   20 20 45 6E    C      
  58DE'   64 65 3A 20    C      
  58E2'                  C      UA.STADR:
  58E2'   04             C      	DB	4
  58E3'   10             C      	DB	16
  58E4'   08             C      	DB	08H
  58E5'   20 20 53 74    C      	DB	'  Startadresse: '
  58E9'   61 72 74 61    C      
  58ED'   64 72 65 73    C      
  58F1'   73 65 3A 20    C      
  58F5'                  C      UA.ZKDL:
  58F5'   01             C      	DB	1
  58F6'   10             C      	DB	16
  58F7'   20             C      	DB	20H
  58F8'   20 4C 6F 65    C      	DB	' Loeschen J/N : '
  58FC'   73 63 68 65    C      
  5900'   6E 20 4A 2F    C      
  5904'   4E 20 3A 20    C      
  5908'                  C      UA.ZKF:
  5908'   00             C      	DB	0
  5909'   08             C      	DB	8
  590A'   00             C      	DB	0
  590B'   46 65 68 6C    C      	DB	'Fehler: '
  590F'   65 72 3A 20    C      
                         C      ;----------------------------------------------------------------------
  5913'                  C      UA.ZKRES:
  5913'   03             C      	DB	3
  5914'   10             C      	DB	16
  5915'   10             C      	DB	10H
  5916'   52 65 73 65    C      	DB	'Reservebloecke: '
  591A'   72 76 65 62    C      
  591E'   6C 6F 65 63    C      
  5922'   6B 65 3A 20    C      
  5926'                  C      UA.ZKSDT:
  5926'   04             C      	DB	4
  5927'   12             C      	DB	18
  5928'   40             C      	DB	40H
  5929'   20 20 20 20    C      	DB	'     Dateiname:   '
  592D'   20 44 61 74    C      
  5931'   65 69 6E 61    C      
  5935'   6D 65 3A 20    C      
  5939'   20 20          C      
  593B'                  C      UA.ZKBEL:
  593B'   00             C      	DB	0
  593C'   10             C      	DB	16
  593D'   00             C      	DB	0
  593E'   42 6C 6F 65    C      	DB	'Bloecke belegt: '
  5942'   63 6B 65 20    C      
  5946'   62 65 6C 65    C      
  594A'   67 74 3A 20    C      
  594E'                  C      UA.ZKBLG:
  594E'   00             C      	DB	0
  594F'   10             C      	DB	16
  5950'   00             C      	DB	0
  5951'   42 6C 6F 65    C      	DB	'Bloecke gesamt: '
  5955'   63 6B 65 20    C      
  5959'   67 65 73 61    C      
  595D'   6D 74 3A 20    C      
                         C      ;----------------------------------------------------------------------
  5961'                  C      UA.ZKBA:
  5961'   42 61 6E 64    C      	DB	'Bandanfang'
  5965'   61 6E 66 61    C      
  5969'   6E 67          C      
  596B'                  C      UA.ZKBM:
  596B'   42 61 6E 64    C      	DB	'Bandmarke'
  596F'   6D 61 72 6B    C      
  5973'   65             C      
  5974'                  C      UA.ZKSL:
  5974'   53 63 68 6C    C      	DB	'Schlussluecke'
  5978'   75 73 73 6C    C      
  597C'   75 65 63 6B    C      
  5980'   65             C      
  5981'                  C      UA.ZKEE:
                         C      ;----------------------------------------------------------------------
  5981'                  C      UA.LD:
  5981'   26             C      	DB	38
'Ausschriften'	MACRO-80 3.44	09-Dec-81	PAGE	1-20


  5982'   0F             C      	DB	15
  5983'   80             C      	DB	80H
  5984'   20 20 20 20    C      	DB	'               '
  5988'   20 20 20 20    C      
  598C'   20 20 20 20    C      
  5990'   20 20 20       C      
  5993'                  C      UA.ZRSCH:
  5993'   01             C      	DB	1
  5994'   16             C      	DB	22
  5995'   80             C      	DB	80H
  5996'   56 65 72 7A    C      	DB	'Verz. schreiben J/N ? '
  599A'   2E 20 73 63    C      
  599E'   68 72 65 69    C      
  59A2'   62 65 6E 20    C      
  59A6'   4A 2F 4E 20    C      
  59AA'   3F 20          C      
  59AC'                  C      UA.ANZWD:
  59AC'   01             C      	DB	1
  59AD'   16             C      	DB	22
  59AE'   80             C      	DB	80H
  59AF'   41 6E 7A 65    C      	DB	'Anzeige wdhln.  J/N ? '
  59B3'   69 67 65 20    C      
  59B7'   77 64 68 6C    C      
  59BB'   6E 2E 20 20    C      
  59BF'   4A 2F 4E 20    C      
  59C3'   3F 20          C      
                         C      ;----------------------------------------------------------------------
  59C5'                  C      UA.ALTR:
  59C5'   20 41 55 53    C      	DB	' AUSGLEICH LAUFWERKSTOLERANZEN  '
  59C9'   47 4C 45 49    C      
  59CD'   43 48 20 4C    C      
  59D1'   41 55 46 57    C      
  59D5'   45 52 4B 53    C      
  59D9'   54 4F 4C 45    C      
  59DD'   52 41 4E 5A    C      
  59E1'   45 4E 20 20    C      
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                                ;
                                ;	INCLUDE	KI.MAC	;Initialisieren von MRES Kassetten
                                ;	INCLUDE	KV.MAC	;Anzeigen und Aendern des MRES-Verzeichnisses
                                ;	INCLUDE	KH.MAC	;Kommandos: KRDx und KWRx
                                ;	INCLUDE	FD.MAC	;Ein-/Ausgabe im freien Format
                                ;	INCLUDE LD.MAC	;Laden von MRES-P-Dateien
                                ;	INCLUDE RL.MAC	;Relativloader fuer O-Dateien
                                ;	INCLUDE SV.MAC	;Retten von Maschinencodeprogrammen als MRES - P-Datei
                         C      	INCLUDE K3.MAC	;MRES Routinen
                         C      	TITLE	'Initialisieren von MRES Kassetten'
                         C      	PAGE
'Initialisieren von MRES Kassetten'	MACRO-80 3.44	09-Dec-81	PAGE	1-21


                         C      
                         C      ;	PN	KI
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;      INITIALISIEREN VON MRES KASSETTEN
                         C      ;
                         C      ;----------------------------------------------------------------------
  59E5'   59E5'          C      	DW	$
  59E7'   49 4E 49 54    C      	DB	'INIT'
  59EB'   21 4070        C      	LD	HL,PUF.KASS	;Puffer fuer Umbenennung Kassette loeschen
  59EE'   11 4071        C      	LD	DE,PUF.KASS+1
  59F1'   01 000F        C      	LD	BC,15
  59F4'   36 20          C      	LD	(HL),020H
  59F6'   ED B0          C      	LDIR
  59F8'   3A 3327        C      	LD	A,(UE.BWSA+327H)
  59FB'   CD 6E8C'       C      	CALL	U1.TST
  59FE'   D8             C      	RET	C
  59FF'   F5             C      	PUSH	AF
  5A00'   CD 6DA9'       C      	CALL	U1.KTINI
  5A03'   F1             C      	POP	AF
  5A04'   DD 77 03       C      	LD	(IX+3),A	;GERAETEADR. -->TAB
  5A07'   CD 6ACA'       C      	CALL	UR.KRE	;RES. EIN
  5A0A'   DD CB 00 56    C      	BIT	2,(IX+0)
  5A0E'   28 05          C      	JR	Z,$+7
  5A10'   3E 19          C      	LD	A,19H
  5A12'   CD 56A5'       C      	CALL	UF.ERANZ
  5A15'   CD 6AD8'       C      	CALL	UR.KRWW	;RUECKSPULEN MIT WARTEN
  5A18'   CD 6AEE'       C      	CALL	UR.KBM	;BM SCHREIBEN
  5A1B'   21 0E66        C      	LD	HL,UE.PUF	;AUFBAU 1.BLOCK
  5A1E'   3E 40          C      	LD	A,40H
  5A20'   06 50          C      	LD	B,80
  5A22'   CD 6E6D'       C      	CALL	U1.TR
  5A25'   3E 00          C      	LD	A,00H
  5A27'   06 30          C      	LD	B,48
  5A29'   CD 6E6D'       C      	CALL	U1.TR
  5A2C'   DD 36 0A 80    C      	LD	(IX+10),80H	;Blocklaenge
  5A30'   DD 36 04 08    C      	LD	(IX+4),08H	;CMD SCHREIBEN
  5A34'   CD 5675'       C      	CALL	UF.EXEC
  5A37'   CD 5AE0'       C      	CALL	KI.KO03
  5A3A'                  C      KI.KN:
  5A3A'   CD 6E78'       C      	CALL	U1.BILO
  5A3D'   3E 0D          C      	LD	A,13
  5A3F'   32 2B00'       C      	LD	(UB.ZN),A	;ZEILENNR. 15
  5A42'   21 576F'       C      	LD	HL,UA.KNAME	;ABFRAGE KASS.NAME
  5A45'   CD 6B72'       C      	CALL	UR.MIMO
  5A48'   D8             C      	RET	C
                         C      ;??? ---\
  5A49'   E5             C      	PUSH	HL
  5A4A'   C5             C      	PUSH	BC
  5A4B'   11 4070        C      	LD	DE,PUF.KASS
  5A4E'   01 0006        C      	LD	BC,6
  5A51'   ED B0          C      	LDIR
  5A53'   C1             C      	POP	BC
  5A54'   E1             C      	POP	HL
                         C      ;??? ---/
  5A55'   06 06          C      	LD	B,6
  5A57'   11 0E6A        C      	LD	DE,UE.PUF+4	;NAME IN PUFFER
  5A5A'   CD 7081'       C      	CALL	UC.KONV	;MIT KONVERTIERUNG IN DKOI-CODE
  5A5D'                  C      KI.NMR:
  5A5D'   21 5782'       C      	LD	HL,UA.NR	;ABFR. KASS.NUMMER
  5A60'   CD 6B72'       C      	CALL	UR.MIMO
  5A63'   38 D5          C      	JR	C,KI.KN	;BEI SYS-TASTE ZU VORHERIGER
                         C      ;??? ---\
  5A65'   E5             C      	PUSH	HL
  5A66'   C5             C      	PUSH	BC
  5A67'   11 4076        C      	LD	DE,PUF.KASS+6
  5A6A'   01 0003        C      	LD	BC,3
  5A6D'   ED B0          C      	LDIR
  5A6F'   C1             C      	POP	BC
  5A70'   E1             C      	POP	HL
                         C      ;??? ---/
  5A71'   06 03          C      	LD	B,3
  5A73'   11 0E8B        C      	LD	DE,UE.PUF+37
  5A76'   CD 7081'       C      	CALL	UC.KONV
  5A79'                  C      KI.KM:
  5A79'   21 5795'       C      	LD	HL,UA.KOMMT	;ABFR. KOMMENTAR
  5A7C'   CD 6B72'       C      	CALL	UR.MIMO
  5A7F'   38 B9          C      	JR	C,KI.KN
  5A81'   06 0B          C      	LD	B,11
  5A83'   11 0E8E        C      	LD	DE,UE.PUF+40
  5A86'   CD 7081'       C      	CALL	UC.KONV
  5A89'   CD 5675'       C      	CALL	UF.EXEC	;3.BLOCK SCHREIBEN
'Initialisieren von MRES Kassetten'	MACRO-80 3.44	09-Dec-81	PAGE	1-22


  5A8C'   CD 5AEB'       C      	CALL	KI.RENA	;Kassette umbenennen	;???
  5A8F'   CD 6AEE'       C      	CALL	UR.KBM	;BM , 1.LABEL BEENDET
  5A92'   21 59C5'       C      	LD	HL,UA.ALTR
  5A95'   11 0E66        C      	LD	DE,UE.PUF
  5A98'   01 0020        C      	LD	BC,20H
  5A9B'   ED B0          C      	LDIR		;AUSGLEICH LFWSTLNZ->PUFFER
  5A9D'   DD 36 0A 20    C      	LD	(IX+10),20H	;NEUE BLOCKLAENGE
  5AA1'   DD 36 04 08    C      	LD	(IX+4),08H
  5AA5'   CD 5675'       C      	CALL	UF.EXEC	;SCHREIBEN
  5AA8'   21 574F'       C      	LD	HL,UA.DS
  5AAB'   11 0E66        C      	LD	DE,UE.PUF
  5AAE'   01 0020        C      	LD	BC,32
  5AB1'   ED B0          C      	LDIR		;DS-SATZ --> PUFFER
  5AB3'   CD 5675'       C      	CALL	UF.EXEC
  5AB6'   3E A5          C      	LD	A,0A5H
  5AB8'   06 20          C      	LD	B,32
  5ABA'   21 0E66        C      	LD	HL,UE.PUF
  5ABD'   CD 6E6D'       C      	CALL	U1.TR
  5AC0'   06 68          C      	LD	B,68H	;103 VERZ.SAETZE
  5AC2'                  C      KI.VERZ:
  5AC2'   C5             C      	PUSH	BC
  5AC3'   CD 5675'       C      	CALL	UF.EXEC
  5AC6'   C1             C      	POP	BC
  5AC7'   10 F9          C      	DJNZ	KI.VERZ
  5AC9'   CD 6AEE'       C      	CALL	UR.KBM
  5ACC'   CD 6D46'       C      	CALL	U1.VS1	;1.DATEIVORSATZ -->PUFFER
  5ACF'   DD 36 04 08    C      	LD	(IX+4),08H
  5AD3'   CD 5675'       C      	CALL	UF.EXEC
  5AD6'   CD 6AF4'       C      	CALL	UR.KSL	;SCHLUSSLUECKE SCHREIBEN
  5AD9'   CD 6AD2'       C      	CALL	UR.KRW
  5ADC'   CD 6ADC'       C      	CALL	UR.KRA
  5ADF'   C9             C      	RET
                         C      ;
  5AE0'                  C      KI.KO03:
  5AE0'   CD 5675'       C      	CALL	UF.EXEC	;FUER KI14
  5AE3'   06 31          C      	LD	B,49
  5AE5'   2B             C      	DEC	HL
  5AE6'   10 FD          C      	DJNZ	$-1
  5AE8'   36 D9          C      	LD	(HL),0D9H
  5AEA'   C9             C      	RET
                         C      ;
  5AEB'                  C      KI.RENA:	;Kassettendateiname umbenennen
  5AEB'   E5             C      	PUSH	HL
  5AEC'   D5             C      	PUSH	DE
  5AED'   C5             C      	PUSH	BC
  5AEE'   F5             C      	PUSH	AF
  5AEF'   21 407A        C      	LD	HL,PUF.KASS+10
  5AF2'   36 00          C      	LD	(HL),0	;AbschluC neuer Name
  5AF4'   21 5B0A'       C      	LD	HL,KI.RENA9+2
  5AF7'   DD 7E 03       C      	LD	A,(IX+3)	;SubAdresse
  5AFA'   77             C      	LD	(HL),A
  5AFB'   21 5B08'       C      	LD	HL,KI.RENA9
  5AFE'   01 0730        C      	LD	BC,00730H	;AKB-Adresse + LC$nge Parameterbereich
  5B01'   ED B3          C      	OTIR
  5B03'   F1             C      	POP	AF
  5B04'   C1             C      	POP	BC
  5B05'   D1             C      	POP	DE
  5B06'   E1             C      	POP	HL
  5B07'   C9             C      	RET
  5B08'                  C      KI.RENA9:
  5B08'   F0             C      	DB	0F0H
  5B09'   44             C      	DB	044H	;Kommando
  5B0A'   00             C      	DB	0		;SubAdresse
  5B0B'   01             C      	DB	1		;HSbereich
  5B0C'   40             C      	DB	HIGH(PUF.KASS)
  5B0D'   70             C      	DB	LOW(PUF.KASS)
  5B0E'   FF             C      	DB	0FFH
                         C      ;---------------------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Anzeigen und Aendern des MRES-Verzeichnisses'
                         C      	PAGE
'Anzeigen und Aendern des MRES-Verzeichnisses'	MACRO-80 3.44	09-Dec-81	PAGE	1-23


                         C      
                         C      ;	PN	KV
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;    ANZEIGEN UND AENDERN DES VERZEICHNISSES VON MRES KASSETTEN
                         C      ;
                         C      ;----------------------------------------------------------------------
  5B0F'   5B0F'          C      	DW	$
  5B11'   44 49 52 20    C      	DB	'DIR '
  5B15'   3A 3326        C      	LD	A,(UE.BWSA+326H)
  5B18'   CD 6E8C'       C      	CALL	U1.TST
  5B1B'   D8             C      	RET	C
  5B1C'   CD 6DA9'       C      	CALL	U1.KTINI
  5B1F'   DD 77 03       C      	LD	(IX+3),A
  5B22'   CD 6E78'       C      	CALL	U1.BILO
  5B25'   CD 6ACA'       C      	CALL	UR.KRE
  5B28'   CD 6AD8'       C      	CALL	UR.KRWW
  5B2B'   CD 6D5D'       C      	CALL	U1.DSVG
  5B2E'   C5             C      	PUSH	BC
                         C      ;----------------------------------------------------------------------
  5B2F'   CD 6CE6'       C      	CALL	U1.KBR4	;KASS.NAME,NR.,KOMMENTAR ANZEIGEN
  5B32'   DD 36 04 02    C      	LD	(IX+4),02H
  5B36'   CD 5675'       C      	CALL	UF.EXEC
  5B39'   21 0E6A        C      	LD	HL,UE.PUF+4
  5B3C'   11 3240        C      	LD	DE,UE.BWSA + 7*80 + 16	;3240H	;=8.ZEILE,16.SPALTE
  5B3F'   06 06          C      	LD	B,6
  5B41'   CD 7077'       C      	CALL	UC.DKONV
  5B44'   21 0E8B        C      	LD	HL,UE.PUF+37
  5B47'   13             C      	INC	DE
  5B48'   13             C      	INC	DE
  5B49'   06 03          C      	LD	B,3
  5B4B'   CD 7077'       C      	CALL	UC.DKONV
  5B4E'   13             C      	INC	DE
  5B4F'   13             C      	INC	DE
  5B50'   06 0B          C      	LD	B,11
  5B52'   CD 7077'       C      	CALL	UC.DKONV
  5B55'   21 3290        C      	LD	HL,UE.BWSA + 8*80 + 16	;3290H
  5B58'   3E 3D          C      	LD	A,'='
  5B5A'   77             C      	LD	(HL),A
  5B5B'   E5             C      	PUSH	HL
  5B5C'   D1             C      	POP	DE
  5B5D'   13             C      	INC	DE
  5B5E'   01 0017        C      	LD	BC,23
  5B61'   ED B0          C      	LDIR
                         C      ;----------------------------------------------------------------------
  5B63'   06 03          C      	LD	B,3	;POSITIONIEREN VOR DS-SATZ
  5B65'   CD 5675'       C      	CALL	UF.EXEC
  5B68'   10 FB          C      	DJNZ	$-3
  5B6A'   CD 6DDF'       C      	CALL	U1.VERIN
  5B6D'   CD 6AD8'       C      	CALL	UR.KRWW
  5B70'   06 07          C      	LD	B,7
  5B72'   CD 6E09'       C      	CALL	U1.VORS1
  5B75'   C1             C      	POP	BC
  5B76'   05             C      	DEC	B
  5B77'   CD 5DA4'       C      	CALL	KV.ANZ
  5B7A'   04             C      	INC	B
  5B7B'   05             C      	DEC	B
  5B7C'   CA 5CC6'       C      	JP	Z,KV.KRW
  5B7F'   04             C      	INC	B
  5B80'   C5             C      	PUSH	BC
                         C      ;----------------------------------------------------------------------
  5B81'                  C      KV.ANF:
  5B81'   05             C      	DEC	B
  5B82'   78             C      	LD	A,B
  5B83'   58             C      	LD	E,B
  5B84'   D6 09          C      	SUB	9
  5B86'   38 05          C      	JR	C,$+7
  5B88'   0E 09          C      	LD	C,9
  5B8A'   41             C      	LD	B,C
  5B8B'   18 03          C      	JR	$+5
  5B8D'   43             C      	LD	B,E
  5B8E'   48             C      	LD	C,B
  5B8F'   AF             C      	XOR	A
  5B90'   F5             C      	PUSH	AF	;A=RESTL.ANZAHL ODER 0
  5B91'   C5             C      	PUSH	BC
  5B92'   21 2B34'       C      	LD	HL,UB.SATZ
  5B95'   36 00          C      	LD	(HL),00H
  5B97'   23             C      	INC	HL
  5B98'   36 37          C      	LD	(HL),55
  5B9A'   23             C      	INC	HL
  5B9B'   36 80          C      	LD	(HL),80H
  5B9D'   23             C      	INC	HL
'Anzeigen und Aendern des MRES-Verzeichnisses'	MACRO-80 3.44	09-Dec-81	PAGE	1-24


  5B9E'   06 37          C      	LD	B,55
  5BA0'   3E 20          C      	LD	A,20H
  5BA2'   CD 6E6D'       C      	CALL	U1.TR	;AUSGABESATZ LOESCHEN
  5BA5'   3E 0D          C      	LD	A,13
  5BA7'   32 2B00'       C      	LD	(UB.ZN),A
  5BAA'   CD 6E78'       C      	CALL	U1.BILO
  5BAD'   11 2B46'       C      	LD	DE,UB.SATZ+18
  5BB0'   D5             C      	PUSH	DE
  5BB1'   21 ECA2        C      	LD	HL,BC.VTABE+32	;ADR. VERZ.TABELLE
  5BB4'   E5             C      	PUSH	HL
                         C      ;---------------------------MAX 9 SAETZE ANZEIGEN----------------------
  5BB5'                  C      KV.ZLTR:
  5BB5'   CD 5D2C'       C      	CALL	KV.BSTR	;VTABE-->UB.SATZ
  5BB8'   D1             C      	POP	DE	;VERZ.ADR.
  5BB9'   E1             C      	POP	HL	;ADR.AUSGABESATZ
  5BBA'   E5             C      	PUSH	HL
  5BBB'   D5             C      	PUSH	DE
  5BBC'   01 0012        C      	LD	BC,18
  5BBF'   B7             C      	OR	A
  5BC0'   ED 42          C      	SBC	HL,BC
  5BC2'   CD 6B72'       C      	CALL	UR.MIMO	;ANZEIGE EINE ZEILE
  5BC5'   E1             C      	POP	HL	;VERZ.ADR
  5BC6'   D1             C      	POP	DE
  5BC7'   01 0020        C      	LD	BC,32
  5BCA'   09             C      	ADD	HL,BC
  5BCB'   C1             C      	POP	BC
  5BCC'   05             C      	DEC	B
  5BCD'   28 05          C      	JR	Z,$+7
  5BCF'   C5             C      	PUSH	BC
  5BD0'   D5             C      	PUSH	DE
  5BD1'   E5             C      	PUSH	HL	;NEUE VERZ.TAB ADR
  5BD2'   18 E1          C      	JR	KV.ZLTR
                         C      ;----------------------------------------------------------------------
  5BD4'   41             C      	LD	B,C	;ANZAHL DER ANGEZEIGTEN ZEILEN
  5BD5'   3A 2B00'       C      	LD	A,(UB.ZN)
  5BD8'   90             C      	SUB	B
  5BD9'   32 2B00'       C      	LD	(UB.ZN),A	;KURSOR AUF ANFANG 12.ZEILE
  5BDC'   C5             C      	PUSH	BC
  5BDD'   D5             C      	PUSH	DE
  5BDE'   E5             C      	PUSH	HL
                         C      ;------------------------VERZ. ZEIGER AUF 1.ANGEZEIGTE EINTR.
  5BDF'   C5             C      	PUSH	BC
  5BE0'   01 0020        C      	LD	BC,32
  5BE3'   B7             C      	OR	A
  5BE4'   ED 42          C      	SBC	HL,BC
  5BE6'   C1             C      	POP	BC
  5BE7'   10 F6          C      	DJNZ	$-8
  5BE9'   E5             C      	PUSH	HL
                         C      ;----------------------------------------------------------------------
  5BEA'                  C      KV.TABTR:
  5BEA'   21 5981'       C      	LD	HL,UA.LD
  5BED'   CD 6B72'       C      	CALL	UR.MIMO	;KURSOR AUF ANF.12.ZEILE
  5BF0'   DA 5C30'       C      	JP	C,KV.ZEIHO
  5BF3'   D1             C      	POP	DE
  5BF4'   D5             C      	PUSH	DE	;ZIELADR.IN VTAB
  5BF5'   CD 5D59'       C      	CALL	KV.SPTR	;ZEILE WIEDER IN SPEICHER
  5BF8'   E1             C      	POP	HL	;ZIELADR.IN VTAB
  5BF9'   01 0020        C      	LD	BC,32
  5BFC'   09             C      	ADD	HL,BC
  5BFD'   FD E1          C      	POP	IY
  5BFF'   D1             C      	POP	DE
  5C00'   C1             C      	POP	BC
  5C01'   05             C      	DEC	B
  5C02'   28 07          C      	JR	Z,$+9
  5C04'   C5             C      	PUSH	BC
  5C05'   D5             C      	PUSH	DE
  5C06'   FD E5          C      	PUSH	IY
  5C08'   E5             C      	PUSH	HL
  5C09'   18 DF          C      	JR	KV.TABTR
                         C      ;--------------------WEITERBLAETTERN ODER AUSGABE----------------------
  5C0B'   F1             C      	POP	AF
  5C0C'   B7             C      	OR	A
  5C0D'   28 42          C      	JR	Z,KV.AUSG	;KEINE WEITEREN ANZEIGEN
  5C0F'   D6 09          C      	SUB	9
  5C11'   38 05          C      	JR	C,$+7
  5C13'   06 09          C      	LD	B,9
  5C15'   48             C      	LD	C,B
  5C16'   18 05          C      	JR	$+7
  5C18'   C6 09          C      	ADD	A,9
  5C1A'   47             C      	LD	B,A
  5C1B'   48             C      	LD	C,B
  5C1C'   AF             C      	XOR	A
  5C1D'   F5             C      	PUSH	AF
'Anzeigen und Aendern des MRES-Verzeichnisses'	MACRO-80 3.44	09-Dec-81	PAGE	1-25


  5C1E'   C5             C      	PUSH	BC
  5C1F'   D5             C      	PUSH	DE
  5C20'   E5             C      	PUSH	HL
  5C21'   3E 0D          C      	LD	A,13
  5C23'   32 2B00'       C      	LD	(UB.ZN),A
  5C26'   CD 6E78'       C      	CALL	U1.BILO
  5C29'   E1             C      	POP	HL
  5C2A'   D1             C      	POP	DE
  5C2B'   D5             C      	PUSH	DE
  5C2C'   E5             C      	PUSH	HL
  5C2D'   C3 5BB5'       C      	JP	KV.ZLTR
                         C      ;----------------------------------------------------------------------
  5C30'                  C      KV.ZEIHO:
  5C30'   21 2B00'       C      	LD	HL,UB.ZN
  5C33'   7E             C      	LD	A,(HL)
  5C34'   D6 0F          C      	SUB	15
  5C36'   38 15          C      	JR	C,$+23	;WENN IN 12. ZEILE SYS GEDRUECKT
  5C38'   35             C      	DEC	(HL)
  5C39'   35             C      	DEC	(HL)	;ZEILENNR.-2
  5C3A'   E1             C      	POP	HL
  5C3B'   01 0020        C      	LD	BC,32
  5C3E'   B7             C      	OR	A
  5C3F'   ED 42          C      	SBC	HL,BC	;VERZ.ZEIGER RUECKSETZEN
  5C41'   FD E1          C      	POP	IY
  5C43'   D1             C      	POP	DE
  5C44'   C1             C      	POP	BC
  5C45'   04             C      	INC	B
  5C46'   C5             C      	PUSH	BC
  5C47'   D5             C      	PUSH	DE
  5C48'   FD E5          C      	PUSH	IY
  5C4A'   E5             C      	PUSH	HL
  5C4B'   18 01          C      	JR	$+3
  5C4D'   35             C      	DEC	(HL)
  5C4E'   C3 5BEA'       C      	JP	KV.TABTR
                         C      ;----------------------------------------------------------------------
  5C51'                  C      KV.AUSG:
  5C51'   E5             C      	PUSH	HL
  5C52'   21 5993'       C      	LD	HL,UA.ZRSCH
  5C55'   CD 6B72'       C      	CALL	UR.MIMO
  5C58'   7E             C      	LD	A,(HL)
  5C59'   E1             C      	POP	HL
  5C5A'   FE 4A          C      	CP	'J'
  5C5C'   28 11          C      	JR	Z,$+19
  5C5E'   21 59AC'       C      	LD	HL,UA.ANZWD
  5C61'   CD 6B72'       C      	CALL	UR.MIMO
  5C64'   7E             C      	LD	A,(HL)
  5C65'   FE 4A          C      	CP	'J'
  5C67'   C1             C      	POP	BC
  5C68'   C2 5CC6'       C      	JP	NZ,KV.KRW
  5C6B'   C5             C      	PUSH	BC
  5C6C'   C3 5B81'       C      	JP	KV.ANF
                         C      ;--------------------------------Dateien am Ende loeschen ? ---------
  5C6F'   CD 5D9A'       C      	CALL	KV.SBC
  5C72'   20 34          C      	JR	NZ,$+54
  5C74'   3A EC85        C      	LD	A,(BC.VTABE+3)
  5C77'   3D             C      	DEC	A
  5C78'   5F             C      	LD	E,A
  5C79'   16 00          C      	LD	D,0
  5C7B'   3E 01          C      	LD	A,1
  5C7D'   82             C      	ADD	A,D
  5C7E'   57             C      	LD	D,A
  5C7F'   1D             C      	DEC	E
  5C80'   28 05          C      	JR	Z,$+7
  5C82'   CD 5D9A'       C      	CALL	KV.SBC
  5C85'   28 F4          C      	JR	Z,$-10
  5C87'   C1             C      	POP	BC	;D: Anzahl zu loeschender Dateien
  5C88'   79             C      	LD	A,C
  5C89'   92             C      	SUB	D
  5C8A'   32 0E67        C      	LD	(UE.PUF+1),A	;DS-Satz korrigieren
  5C8D'   78             C      	LD	A,B
  5C8E'   92             C      	SUB	D
  5C8F'   32 0E69        C      	LD	(UE.PUF+3),A
  5C92'   CD 6B00'       C      	CALL	UR.KBR
  5C95'   CD 6B00'       C      	CALL	UR.KBR
  5C98'   CD 6AFA'       C      	CALL	UR.KBV
  5C9B'   DD 36 04 08    C      	LD	(IX+4),08H
  5C9F'   CD 5675'       C      	CALL	UF.EXEC	;und schreiben
  5CA2'   47             C      	LD	B,A
  5CA3'   05             C      	DEC	B
  5CA4'   28 20          C      	JR	Z,$+34
  5CA6'   04             C      	INC	B
  5CA7'   C5             C      	PUSH	BC
                         C      ;-------------------------------------Verzeichnis schreiben -----------
'Anzeigen und Aendern des MRES-Verzeichnisses'	MACRO-80 3.44	09-Dec-81	PAGE	1-26


  5CA8'   C1             C      	POP	BC
  5CA9'   05             C      	DEC	B
  5CAA'   21 ECA2        C      	LD	HL,BC.VTABE+32
  5CAD'   C5             C      	PUSH	BC
  5CAE'   11 0E66        C      	LD	DE,UE.PUF
  5CB1'   01 0020        C      	LD	BC,32
  5CB4'   ED B0          C      	LDIR
  5CB6'   CD 6AFA'       C      	CALL	UR.KBV
  5CB9'   CD 6B00'       C      	CALL	UR.KBR
  5CBC'   DD 36 04 08    C      	LD	(IX+4),08H	;OHNE RAW
  5CC0'   CD 5675'       C      	CALL	UF.EXEC
  5CC3'   C1             C      	POP	BC
  5CC4'   10 E7          C      	DJNZ	$-23
                         C      ;---------------------------------------------------------------------
  5CC6'                  C      KV.KRW:
  5CC6'   CD 6AD2'       C      	CALL	UR.KRW
  5CC9'   CD 6ADC'       C      	CALL	UR.KRA
  5CCC'   3A 3328        C      	LD	A,(UE.BWSA+328H)
  5CCF'   FE 44          C      	CP	'D'
  5CD1'   C0             C      	RET	NZ
  5CD2'   21 323D        C      	LD	HL,UE.BWSA+23DH
  5CD5'   00             C      	NOP
  5CD6'   CD 5D12'       C      	CALL	KV.DRU1
  5CD9'   21 328D        C      	LD	HL,UE.BWSA+28DH
  5CDC'   CD 5D12'       C      	CALL	KV.DRU1
  5CDF'   CD 4040        C      	CALL	PRINT
  5CE2'   21 2B6E'       C      	LD	HL,UB.DTAB
  5CE5'   11 2B6F'       C      	LD	DE,UB.DTAB+1
  5CE8'   01 0028        C      	LD	BC,40
  5CEB'   36 20          C      	LD	(HL),20H
  5CED'   ED B0          C      	LDIR
  5CEF'   3A EC85        C      	LD	A,(BC.VTABE+3)
  5CF2'   47             C      	LD	B,A
  5CF3'   05             C      	DEC	B
  5CF4'   21 EC82        C      	LD	HL,BC.VTABE
  5CF7'   11 0020        C      	LD	DE,32
  5CFA'                  C      KV.P1:
  5CFA'   C5             C      	PUSH	BC
  5CFB'   19             C      	ADD	HL,DE
  5CFC'   E5             C      	PUSH	HL
  5CFD'   D5             C      	PUSH	DE
  5CFE'   11 2B6E'       C      	LD	DE,UB.DTAB
  5D01'   CD 5D2C'       C      	CALL	KV.BSTR
  5D04'   21 2B6E'       C      	LD	HL,UB.DTAB
  5D07'   06 28          C      	LD	B,40
  5D09'   CD 5D14'       C      	CALL	KV.DRU
  5D0C'   D1             C      	POP	DE
  5D0D'   E1             C      	POP	HL
  5D0E'   C1             C      	POP	BC
  5D0F'   10 E9          C      	DJNZ	KV.P1
  5D11'   C9             C      	RET
                         C      
  5D12'                  C      KV.DRU1:
  5D12'   06 1E          C      	LD	B,30
  5D14'                  C      KV.DRU:
  5D14'   7E             C      	LD	A,(HL)
  5D15'   23             C      	INC	HL
  5D16'   CD 5D21'       C      	CALL	KV.KO02
  5D19'   10 F9          C      	DJNZ	KV.DRU
  5D1B'   3E 1E          C      	LD	A,1EH
  5D1D'   CD 4040        C      	CALL	PRINT
  5D20'   C9             C      	RET
                         C      ;
  5D21'                  C      KV.KO02:
  5D21'   CB BF          C      	RES	7,A	;FUER KV17 (DRUCKERAUSGABE)
  5D23'   FE 20          C      	CP	20H
  5D25'   30 02          C      	JR	NC,$+4
  5D27'   3E 2A          C      	LD	A,2AH
  5D29'   C3 4040        C      	JP	PRINT
                         C      ;---------------------------------------------------------------------
  5D2C'                  C      KV.BSTR:
  5D2C'   01 0006        C      	LD	BC,6	;Aufbereitung des Verz.Satzes
  5D2F'   C5             C      	PUSH	BC
  5D30'   ED B0          C      	LDIR		;Transport VTABE--->UB.SATZ
  5D32'   13             C      	INC	DE
  5D33'   13             C      	INC	DE
  5D34'   13             C      	INC	DE
  5D35'   01 0002        C      	LD	BC,2
  5D38'   ED B0          C      	LDIR
  5D3A'   13             C      	INC	DE
  5D3B'   13             C      	INC	DE
  5D3C'   13             C      	INC	DE
  5D3D'   C1             C      	POP	BC
'Anzeigen und Aendern des MRES-Verzeichnisses'	MACRO-80 3.44	09-Dec-81	PAGE	1-27


  5D3E'   C5             C      	PUSH	BC
  5D3F'   ED B0          C      	LDIR
  5D41'   13             C      	INC	DE
  5D42'   13             C      	INC	DE
  5D43'   13             C      	INC	DE
  5D44'   C1             C      	POP	BC
  5D45'   ED B0          C      	LDIR
  5D47'   13             C      	INC	DE
  5D48'   13             C      	INC	DE
  5D49'   13             C      	INC	DE
  5D4A'   01 0003        C      	LD	BC,3
  5D4D'   ED B0          C      	LDIR
  5D4F'   13             C      	INC	DE
  5D50'   13             C      	INC	DE
  5D51'   13             C      	INC	DE
  5D52'   6E             C      	LD	L,(HL)	;Konvertierung Labelnummer
  5D53'   26 00          C      	LD	H,0
  5D55'   CD 6FE3'       C      	CALL	UC.CVBD2
  5D58'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  5D59'                  C      KV.SPTR:
  5D59'   7E             C      	LD	A,(HL)
  5D5A'   FE 09          C      	CP	09H	;Soll Satz geloescht werden?
  5D5C'   20 02          C      	JR	NZ,$+4
  5D5E'   AF             C      	XOR	A
  5D5F'   77             C      	LD	(HL),A
  5D60'   01 0006        C      	LD	BC,6
  5D63'   C5             C      	PUSH	BC
  5D64'   ED B0          C      	LDIR		;Ruecktransport BWSA--->VTABE
  5D66'   23             C      	INC	HL
  5D67'   23             C      	INC	HL
  5D68'   23             C      	INC	HL
  5D69'   01 0002        C      	LD	BC,2
  5D6C'   ED B0          C      	LDIR
  5D6E'   23             C      	INC	HL
  5D6F'   23             C      	INC	HL
  5D70'   23             C      	INC	HL
  5D71'   C1             C      	POP	BC
  5D72'   C5             C      	PUSH	BC
  5D73'   ED B0          C      	LDIR
  5D75'   23             C      	INC	HL
  5D76'   23             C      	INC	HL
  5D77'   23             C      	INC	HL
  5D78'   C1             C      	POP	BC
  5D79'   ED B0          C      	LDIR
  5D7B'   23             C      	INC	HL
  5D7C'   23             C      	INC	HL
  5D7D'   23             C      	INC	HL
  5D7E'   01 0003        C      	LD	BC,3
  5D81'   ED B0          C      	LDIR
  5D83'   23             C      	INC	HL
  5D84'   23             C      	INC	HL
  5D85'   23             C      	INC	HL
  5D86'   D5             C      	PUSH	DE
  5D87'   EB             C      	EX	DE,HL
  5D88'   CD 5D8F'       C      	CALL	KV.DBCVM
  5D8B'   7D             C      	LD	A,L
  5D8C'   E1             C      	POP	HL
  5D8D'   77             C      	LD	(HL),A
  5D8E'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  5D8F'                  C      KV.DBCVM:
  5D8F'   06 02          C      	LD	B,2	;FELDLAENGE
  5D91'   CD 7028'       C      	CALL	UC.CVDB	;KONVERTIER. DEZI-->BINAER
  5D94'   D0             C      	RET	NC		;OHNE FEHLER
  5D95'   C0             C      	RET	NZ
  5D96'   13             C      	INC	DE	;1.ZEICHEN WAR KEINE DEZ.ZAHL
  5D97'   10 F8          C      	DJNZ	$-6
  5D99'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  5D9A'                  C      KV.SBC:
  5D9A'   01 0020        C      	LD	BC,32
  5D9D'   B7             C      	OR	A
  5D9E'   ED 42          C      	SBC	HL,BC
  5DA0'   7E             C      	LD	A,(HL)
  5DA1'   FE 00          C      	CP	00H
  5DA3'   C9             C      	RET
                         C      ;---------------------------------------------------------------------
  5DA4'                  C      KV.ANZ:
  5DA4'   C5             C      	PUSH	BC
  5DA5'   68             C      	LD	L,B
  5DA6'   26 00          C      	LD	H,0
  5DA8'   11 3332        C      	LD	DE,3332H
'Anzeigen und Aendern des MRES-Verzeichnisses'	MACRO-80 3.44	09-Dec-81	PAGE	1-28


  5DAB'   CD 6FDF'       C      	CALL	UC.CVBD3
  5DAE'   13             C      	INC	DE
  5DAF'   13             C      	INC	DE
  5DB0'   21 5DBA'       C      	LD	HL,KV.AVZS
  5DB3'   01 0011        C      	LD	BC,17
  5DB6'   ED B0          C      	LDIR
  5DB8'   C1             C      	POP	BC
  5DB9'   C9             C      	RET
                         C      ;-----------------------------------------------------------------------
  5DBA'                  C      KV.AVZS:
  5DBA'   56 65 72 7A    C      	DB	'Verzeichnissaetze'
  5DBE'   65 69 63 68    C      
  5DC2'   6E 69 73 73    C      
  5DC6'   61 65 74 7A    C      
  5DCA'   65             C      
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Kommandos: KRDx und KWRx'
                         C      	PAGE
'Kommandos: KRDx und KWRx'	MACRO-80 3.44	09-Dec-81	PAGE	1-29


                         C      
                         C      ;	PN	KH
                         C      ;**********************************************************************
                         C      ;
                         C      ;   Kommando:
                         C      ;        KRDx...Block einlesen und anzeigen
                         C      ;               zusaetlich werden die entsprechenden Puffer-
                         C      ;               adressen angezeigt.
                         C      ;        KWRx...Block schreiben, standardmaessig nach 'KRDx'
                         C      ;               Ansonsten muessen Blockadresse und Blocklaenge in der
                         C      ;               Verstaendigungstabelle eingetragen werden.
                         C      ;
                         C      ;**********************************************************************
  5DCB'   5DCB'          C      	DW	$
  5DCD'   4B 52 57 31    C      	DB	'KRW1'
  5DD1'   18 06          C      	JR	KH.RDSTA
                         C      ;
  5DD3'   5DD3'          C      	DW	$
  5DD5'   4B 52 57 32    C      	DB	'KRW2'
  5DD9'                  C      KH.RDSTA:
  5DD9'   CD 6DA9'       C      	CALL	U1.KTINI	;Initialisierung E/A-Tab.
  5DDC'   3A 3325        C      	LD	A,(UE.BWSA + 10*80 + 5)	;325H i von KRDi
  5DDF'   E6 0F          C      	AND	0FH
  5DE1'   DD 77 03       C      	LD	(IX+3),A	;Subadresse eintragen
  5DE4'                  C      KH.RES:
  5DE4'                  C      KH.KSRE:
  5DE4'   CD 6ACA'       C      	CALL	UR.KRE	;Reservieren
  5DE7'                  C      KH.RD1:
  5DE7'                  C      KH.KSRW:
  5DE7'   DD 36 04 21    C      	LD	(IX+4),021H	;umspulen (rewind)
  5DEB'   CD 5675'       C      	CALL	UF.EXEC
  5DEE'   C3 5E73'       C      	JP		KH.RDBA
                         C      ;
                         C      ;	Z Y K L U S  C<ber Tastatureingaben
  5DF1'                  C      KH.RD3:	;Zyklus
  5DF1'   DD 36 0A 00    C      	LD	(IX+10),0	;Anzahl Bandmarken
  5DF5'   CD 6C9E'       C      	CALL	UR.TAREP	;Tastaturabfrage
  5DF8'   FE 80          C      	CP	080H
  5DFA'   28 E8          C      	JR	Z,KH.KSRE	;---> P 01	Reservieren EIN
  5DFC'   FE 82          C      	CP	082H
  5DFE'   28 2A          C      	JR	Z,KH.KSRA	;---> P 03	Reservieren AUS
  5E00'   FE 81          C      	CP	081H
  5E02'   28 E3          C      	JR	Z,KH.KSRW	;---> P 02	Rewind
                         C      
  5E04'   FE 83          C      	CP	083H
  5E06'   28 31          C      	JR	Z,KH.KSRP	;---> P 04	        read; display
  5E08'   FE 85          C      	CP	085H
  5E0A'   28 2A          C      	JR	Z,KH.KSRM	;---> P 06	R-; R-; read; display
                         C      
  5E0C'   DD 36 0A 01    C      	LD	(IX+10),1	;Anzahl Bandmarken
  5E10'   FE 86          C      	CP	086H
  5E12'   28 3C          C      	JR	Z,KH.BMP	;---> P07	BM+
  5E14'   FE 88          C      	CP	088H
  5E16'   28 40          C      	JR	Z,KH.BMM	;---> P09	BM-
                         C      
  5E18'   FE 89          C      	CP	089H
  5E1A'   28 41          C      	JR	Z,KH.WREC	;---> P10	write Record
  5E1C'   FE 8A          C      	CP	08AH
  5E1E'   28 49          C      	JR	Z,KH.WBM	;---> P11	write BM
  5E20'   FE 8B          C      	CP	08BH
  5E22'   28 47          C      	JR	Z,KH.WSL	;---> P11	write SL
                         C      
  5E24'   FE CD          C      	CP	0CDH
  5E26'   28 45          C      	JR	Z,KH.SYSRT	;---> SYS
                         C      
  5E28'   18 C7          C      	JR	KH.RD3
                         C      
                         C      ;	P 03	Reservieren AUS
  5E2A'                  C      KH.KSRA:
  5E2A'   DD 36 04 21    C      	LD	(IX+4),021H	;umspulen (rewind)
  5E2E'   CD 5675'       C      	CALL	UF.EXEC
  5E31'   CD 6ADC'       C      	CALL	UR.KRA
  5E34'   18 3D          C      	JR		KH.RDBA
                         C      
                         C      ;	P 06	R-; R-; read; display
  5E36'                  C      KH.KSRM:
  5E36'   CD 5ED5'       C      	CALL	KH.RD2
                         C      ;	P 04	        read; display
  5E39'                  C      KH.KSRP:
  5E39'   DD 36 04 02    C       	LD	(IX+4),002H	;naechst Record lesen
  5E3D'   CD 5675'       C      	CALL	UF.EXEC
  5E40'   DD 7E 1C       C      	LD	A,(IX+28)	;Lade die Laenge des Blockes
'Kommandos: KRDx und KWRx'	MACRO-80 3.44	09-Dec-81	PAGE	1-30


  5E43'   FE 01          C      	CP	1	;Laenge = 1, dann BandMarke
  5E45'   28 3D          C      	JR	Z,KH.RDBM
  5E47'   FE 02          C      	CP	2	;Laenge = 2, dann Schlussluecke
  5E49'   28 4A          C      	JR	Z,KH.RDSL
  5E4B'   CD 5EA6'       C      	CALL	KH.ANZBL	;Block anzeigen
  5E4E'   18 A1          C      	JR	KH.RD3
                         C      
                         C      ;	P 07	BM+
  5E50'                  C      KH.BMP:
  5E50'   CD 6AE2'       C      	CALL	UR.KLV	;Bandmarke vorsetzen
  5E53'   CD 6B00'       C      	CALL	UR.KBR	;Record    zuruecksetzen
  5E56'   18 E1          C      	JR	KH.KSRP
                         C      ;	P 09	BM-
  5E58'                  C      KH.BMM:
  5E58'   CD 6AE8'       C      	CALL	UR.KLR	;Bandmarke zurC<cksetzen
  5E5B'   18 DC          C      	JR	KH.KSRP
                         C      
                         C      ;	P 10	write Record
  5E5D'                  C      KH.WREC:
  5E5D'   DD 36 04 08    C      	LD	(IX+4),08H
  5E61'   CD 5675'       C      	CALL	UF.EXEC
  5E64'   CD 6B00'       C      	CALL	UR.KBR
  5E67'   18 88          C      	JR	KH.RD3
                         C      
                         C      ;	P 11	write BM
  5E69'                  C      KH.WBM:
  5E69'   18 86          C      	JR	KH.RD3
                         C      
                         C      ;	P 12	write SL
  5E6B'                  C      KH.WSL:
  5E6B'   18 84          C      	JR	KH.RD3
                         C      
                         C      ;	SYS		Systemruecksprung
  5E6D'                  C      KH.SYSRT:
  5E6D'   CD 5F4F'       C      	CALL	KH.BILO
  5E70'   C3 000B        C      	JP	SY.SYSTB
                         C      
  5E73'                  C      KH.RDBA:
  5E73'   CD 5F4F'       C      	CALL	KH.BILO
  5E76'   21 5961'       C      	LD	HL,UA.ZKBA	;"Bandanfang"
  5E79'   11 3000        C      	LD	DE,UE.BWSA
  5E7C'   01 000A        C      	LD	BC,UA.ZKBM-UA.ZKBA
  5E7F'   ED B0          C      	LDIR
  5E81'   C3 5DF1'       C      	JP	KH.RD3
                         C      
  5E84'                  C      KH.RDBM:
  5E84'   CD 5F4F'       C      	CALL	KH.BILO
  5E87'   21 596B'       C      	LD	HL,UA.ZKBM	;"Bandmarke"
  5E8A'   11 3000        C      	LD	DE,UE.BWSA
  5E8D'   01 0009        C      	LD	BC,UA.ZKSL-UA.ZKBM
  5E90'   ED B0          C      	LDIR
  5E92'   C3 5DF1'       C      	JP	KH.RD3
                         C      
  5E95'                  C      KH.RDSL:
  5E95'   CD 5F4F'       C      	CALL	KH.BILO
  5E98'   21 5974'       C      	LD	HL,UA.ZKSL	;"Schlussluecke"
  5E9B'   11 3000        C      	LD	DE,UE.BWSA
  5E9E'   01 000D        C      	LD	BC,UA.ZKEE-UA.ZKSL
  5EA1'   ED B0          C      	LDIR
  5EA3'   C3 5DF1'       C      	JP	KH.RD3
                         C      
  5EA6'                  C      KH.ANZBL:
  5EA6'   CD 5F4F'       C      	CALL	KH.BILO
  5EA9'                  C      KH.ANZB1:
  5EA9'   21 0E66        C      	LD	HL,UE.PUF
  5EAC'   FE 20          C      	CP	020H
  5EAE'   20 04          C      	JR	NZ,KH.ANZB2
  5EB0'   06 02          C      	LD	B,2	; 2 Zeilen anzeigen
  5EB2'   18 0A          C      	JR	KH.ANZB4
  5EB4'                  C      KH.ANZB2:
  5EB4'   FE 80          C      	CP	080H
  5EB6'   20 04          C      	JR	NZ,KH.ANZB3
  5EB8'   06 08          C      	LD	B,8	; 8 Zeilen anzeigen
  5EBA'   18 02          C      	JR	KH.ANZB4
  5EBC'                  C      KH.ANZB3:
  5EBC'   06 18          C      	LD	B,24	; 24 Zeilen anzeigen
  5EBE'                  C      KH.ANZB4:
  5EBE'   CD 5EC2'       C      	CALL	KH.AZBLD	;Bild anzeigen (24 Zeilen)
  5EC1'   C9             C      	RET		; IN...HL:=akt. Pufferadresse
                         C      
  5EC2'                  C      KH.AZBLD:
  5EC2'   11 3000        C      	LD	DE,UE.BWSA
  5EC5'                  C      KH.AZBL1:
'Kommandos: KRDx und KWRx'	MACRO-80 3.44	09-Dec-81	PAGE	1-31


  5EC5'   C5             C      	PUSH	BC
  5EC6'   CD 5EDE'       C      	CALL	KH.AZ1Z	; 1 Zeile anzeigen
  5EC9'   C1             C      	POP	BC
  5ECA'   E5             C      	PUSH	HL	;akt. Pufferadresse retten
  5ECB'   EB             C      	EX	DE,HL
  5ECC'   11 0050        C      	LD	DE,80
  5ECF'   19             C      	ADD	HL,DE	;neuen Zeilenanfang berechnen
  5ED0'   EB             C      	EX	DE,HL
  5ED1'   E1             C      	POP	HL
  5ED2'   10 F1          C      	DJNZ	KH.AZBL1
  5ED4'   C9             C      	RET
                         C      
  5ED5'                  C      KH.RD2:
  5ED5'   F5             C      	PUSH	AF	;Flags retten
  5ED6'   CD 6B00'       C      	CALL	UR.KBR	;Block ruecksetzen
  5ED9'   CD 6B00'       C      	CALL	UR.KBR
  5EDC'   F1             C      	POP	AF
  5EDD'   C9             C      	RET
                         C      ;                                IN...HL:= Pufferadresse
                         C      ;                                     DE:= Zeilenanfang
  5EDE'                  C      KH.AZ1Z:
  5EDE'   D5             C      	PUSH	DE	;eine Zeile anzeigen
  5EDF'   E5             C      	PUSH	HL
  5EE0'   D5             C      	PUSH	DE
  5EE1'   E1             C      	POP	HL
  5EE2'   01 0040        C      	LD	BC,64
  5EE5'   09             C      	ADD	HL,BC
  5EE6'   E5             C      	PUSH	HL
  5EE7'   C1             C      	POP	BC	;BC:= Anfang ASCII-Darstellung
  5EE8'   E1             C      	POP	HL
  5EE9'   CD 5F02'       C      	CALL	KH.AZADR	;Adresse anzeigen
  5EEC'   13             C      	INC	DE
  5EED'   13             C      	INC	DE
  5EEE'   CD 5F0B'       C      	CALL	KH.AZ4BY	;1. Vierergruppe
  5EF1'   13             C      	INC	DE
  5EF2'   13             C      	INC	DE
  5EF3'   CD 5F0B'       C      	CALL	KH.AZ4BY	;2.      ''
  5EF6'   13             C      	INC	DE
  5EF7'   13             C      	INC	DE
  5EF8'   CD 5F0B'       C      	CALL	KH.AZ4BY	;3.      ''
  5EFB'   13             C      	INC	DE
  5EFC'   13             C      	INC	DE
  5EFD'   CD 5F0B'       C      	CALL	KH.AZ4BY	;4.      ''
  5F00'   D1             C      	POP	DE
  5F01'   C9             C      	RET
  5F02'                  C      KH.AZADR:
  5F02'   7C             C      	LD	A,H	;Anzeige der Adresse
  5F03'   CD 6F6C'       C      	CALL	UC.CVBX+2
  5F06'   7D             C      	LD	A,L
  5F07'   CD 6F6C'       C      	CALL	UC.CVBX+2
  5F0A'   C9             C      	RET
  5F0B'                  C      KH.AZ4BY:
  5F0B'   AF             C      	XOR	A	;Anzeige einer Vierergruppe
  5F0C'   32 2B26'       C      	LD	(UB.PAR1),A
  5F0F'                  C      KH.AZ4B0:
  5F0F'   7E             C      	LD	A,(HL)
  5F10'   F5             C      	PUSH	AF
  5F11'   CD 6F6C'       C      	CALL	UC.CVBX+2	;Code als Hexadezimalzahl
  5F14'   F1             C      	POP	AF
  5F15'   13             C      	INC	DE
  5F16'   23             C      	INC	HL
  5F17'   FE 20          C      	CP	20H
  5F19'   38 15          C      	JR	C,KH.AZ4B1	;nicht darstellbar
  5F1B'   FE 7F          C      	CP	7FH
  5F1D'   30 11          C      	JR	NC,KH.AZ4B1	;nicht darstellbar
  5F1F'                  C      KH.AZ4B3:
  5F1F'   02             C      	LD	(BC),A	;Code als ASCII-Zeichen
  5F20'   03             C      	INC	BC
  5F21'   CD 5F34'       C      	CALL	KH.BLEVG	;Test auf Blockende
  5F24'   3A 2B26'       C      	LD	A,(UB.PAR1)
  5F27'   3C             C      	INC	A
  5F28'   FE 04          C      	CP	4
  5F2A'   C8             C      	RET	Z
  5F2B'   32 2B26'       C      	LD	(UB.PAR1),A
  5F2E'   18 DF          C      	JR	KH.AZ4B0
  5F30'                  C      KH.AZ4B1:
  5F30'   3E 7F          C      	LD	A,07FH
  5F32'   18 EB          C      	JR	KH.AZ4B3
  5F34'                  C      KH.BLEVG:
  5F34'   D5             C      	PUSH	DE	;Blockendetest
  5F35'   E5             C      	PUSH	HL
  5F36'   11 0E66        C      	LD	DE,UE.PUF	;DE:= Pufferanfang
  5F39'   B7             C      	OR	A
'Kommandos: KRDx und KWRx'	MACRO-80 3.44	09-Dec-81	PAGE	1-32


  5F3A'   ED 52          C      	SBC	HL,DE	;HL:= Anzahl der angezeigten
  5F3C'   EB             C      	EX	DE,HL
  5F3D'   CD 6ED8'       C      	CALL	XY.LIDX
  5F40'   09             C      	DB	9
  5F41'   B7             C      	OR	A
  5F42'   ED 52          C      	SBC	HL,DE
  5F44'   E1             C      	POP	HL
  5F45'   D1             C      	POP	DE
  5F46'   28 01          C      	JR	Z,KH.BLEV1
  5F48'   C9             C      	RET
  5F49'                  C      KH.BLEV1:
  5F49'   06 0C          C      	LD	B,12
  5F4B'                  C      KH.BLEV2:
  5F4B'   33             C      	INC	SP
  5F4C'   10 FD          C      	DJNZ	KH.BLEV2
  5F4E'   C9             C      	RET		;---> Anzeige beendet
                         C      
                         C      ;----------------------------------------------------
  5F4F'                  C      KH.BILO:
  5F4F'   21 3000        C      	LD	HL,UE.BWSA
  5F52'   01 077F        C      	LD	BC,24*80 -1	;800H
  5F55'   36 20          C      	LD	(HL),20H
  5F57'   E5             C      	PUSH	HL
  5F58'   D1             C      	POP	DE
  5F59'   13             C      	INC	DE
  5F5A'   ED B0          C      	LDIR
  5F5C'   C9             C      	RET
                         C      ;------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Ein-/Ausgabe im freien Format'
                         C      	PAGE
'Ein-/Ausgabe im freien Format'	MACRO-80 3.44	09-Dec-81	PAGE	1-33


                         C      
                         C      ;	PN	FD
                         C      ;**********************************************************************
                         C      ;
                         C      ;      Ein-/Ausgabe von Dateien im freien Format in bzw. aus demEditor-
                         C      ;      raum von bzw. auf MRES-Kassetten
                         C      ;
                         C      ;**********************************************************************
                         C      ;      Positionieren auf Datei, IN: <C>:= Labelnummer
                         C      ;
  5F5D'                  C      FD.POSK:
  5F5D'   C5             C      	PUSH	BC
  5F5E'   41             C      	LD	B,C
  5F5F'   04             C      	INC	B
  5F60'   CD 6B0F'       C      	CALL	UR.POSIK
  5F63'   CD 5F75'       C      	CALL	FD.KO01
  5F66'   3A 0E66        C      	LD	A,(UE.PUF)
  5F69'   B9             C      	CP	C
  5F6A'   C1             C      	POP	BC
  5F6B'   20 01          C      	JR	NZ,$+3
  5F6D'   C9             C      	RET
  5F6E'   D1             C      	POP	DE
  5F6F'   3E 94          C      	LD	A,94H
  5F71'   CD 56A5'       C      	CALL	UF.ERANZ
  5F74'   C9             C      	RET
                         C      ;
  5F75'                  C      FD.KO01:	;???
  5F75'   DD 36 04 02    C      	LD	(IX+4),2	;FUER FD19
  5F79'   C3 5675'       C      	JP	UF.EXEC
                         C      ;----------------------------------------------------------------------
                         C      ;      Datei im Verzeichnis suchen
                         C      ;      HL:= Dateiname, <B>:= Anzahl Verzeichniseintragungen + 1
                         C      ;      <D>:= Dateityp
                         C      ;      O:  CY:= 0 Datei nicht vorhanden, <C> unveraendert
                         C      ;          CY:= 1 <C>:= Labelnummer
                         C      ;      K:  B
  5F7C'                  C      FD.DASU:
  5F7C'   D5             C      	PUSH	DE
  5F7D'   05             C      	DEC	B
  5F7E'   28 0A          C      	JR	Z,$+12
  5F80'   CD 5F75'       C      	CALL	FD.KO01
  5F83'   CD 6D8E'       C      	CALL	U1.NMVGL
  5F86'   38 05          C      	JR	C,$+7
  5F88'   10 F6          C      	DJNZ	$-8
  5F8A'   B7             C      	OR	A
  5F8B'   D1             C      	POP	DE
  5F8C'   C9             C      	RET
  5F8D'   5F             C      	LD	E,A
  5F8E'   3A 0E6C        C      	LD	A,(UE.PUF+6)
  5F91'   BA             C      	CP	D
  5F92'   20 F4          C      	JR	NZ,$-10
  5F94'   4B             C      	LD	C,E
  5F95'   37             C      	SCF
  5F96'   18 F3          C      	JR	$-11
                         C      ;----------------------------------------------------------------------
                         C      ;      Reservebloecke schreiben
                         C      ;
  5F98'                  C      FD.WRRES:
  5F98'   C5             C      	PUSH	BC
  5F99'   D5             C      	PUSH	DE
  5F9A'   E5             C      	PUSH	HL
  5F9B'   21 5913'       C      	LD	HL,UA.ZKRES
  5F9E'   CD 6B72'       C      	CALL	UR.MIMO
  5FA1'   EB             C      	EX	DE,HL
  5FA2'   CD 7028'       C      	CALL	UC.CVDB
  5FA5'   7C             C      	LD	A,H
  5FA6'   B5             C      	OR	L
  5FA7'   20 04          C      	JR	NZ,$+6
  5FA9'   E1             C      	POP	HL
  5FAA'   D1             C      	POP	DE
  5FAB'   C1             C      	POP	BC
  5FAC'   C9             C      	RET
  5FAD'   E5             C      	PUSH	HL
  5FAE'   21 0E66        C      	LD	HL,UE.PUF
  5FB1'   01 0090        C      	LD	BC,90H
  5FB4'   CD 6CD7'       C      	CALL	U1.CLRB
  5FB7'   21 0080        C      	LD	HL,80H
  5FBA'   CD 6EF8'       C      	CALL	XY.STIDX
  5FBD'   09             C      	DB	9
  5FBE'   E1             C      	POP	HL
  5FBF'   CD 7311'       C      	CALL	UK.KBA
  5FC2'   2B             C      	DEC	HL
'Ein-/Ausgabe im freien Format'	MACRO-80 3.44	09-Dec-81	PAGE	1-34


  5FC3'   7C             C      	LD	A,H
  5FC4'   B5             C      	OR	L
  5FC5'   20 E6          C      	JR	NZ,$-24
  5FC7'   18 E0          C      	JR	$-30
                         C      ;----------------------------------------------------------------------
                         C      ;      F/S - Datei in den Editorraum einlesen
                         C      ;
  5FC9'                  C      FD.FDINP:
  5FC9'   21 0000        C      	LD	HL,0
  5FCC'   CD 6EE8'       C      	CALL	XY.STDX
  5FCF'   11             C      	DB	17
  5FD0'   CD 7260'       C      	CALL	UK.KLPFB	;Pufferbereitstellung
  5FD3'   21 3328        C      	LD	HL,UE.BWSA+328H
  5FD6'   06 05          C      	LD	B,5
  5FD8'   7E             C      	LD	A,(HL)
  5FD9'   FE 45          C      	CP	'E'
  5FDB'   28 05          C      	JR	Z,$+7
  5FDD'   23             C      	INC	HL
  5FDE'   10 F8          C      	DJNZ	$-6
  5FE0'   18 05          C      	JR	$+7
  5FE2'   2A 0DC4        C      	LD	HL,(UE.EDEND)
  5FE5'   18 03          C      	JR	$+5
  5FE7'   21 8830        C      	LD	HL,UE.TEXAN
  5FEA'   D9             C      	EXX
  5FEB'   CD 721D'       C      	CALL	DC.INIT	;Dekomprimierung initialisieren
  5FEE'   D9             C      	EXX
  5FEF'   3A 2B28'       C      	LD	A,(UB.PAR2)	;Dateitypmerker
  5FF2'   FE 53          C      	CP	'S'
  5FF4'   F5             C      	PUSH	AF
  5FF5'   CC 6010'       C      	CALL	Z,FD.SDIN	;Zeicheneingabe S- Datei
  5FF8'   77             C      	LD	(HL),A
  5FF9'   B7             C      	OR	A
  5FFA'   28 12          C      	JR	Z,$+20
  5FFC'   F1             C      	POP	AF
  5FFD'   28 07          C      	JR	Z,$+9
  5FFF'   C4 7223'       C      	CALL	NZ,UK.GETK	;Zeicheneingabe F- Datei
  6002'   77             C      	LD	(HL),A	;Zeichen in Speicher eintragen
  6003'   BE             C      	CP	(HL)	;Echolesen
  6004'   20 10          C      	JR	NZ,$+18
  6006'   B7             C      	OR	A	;<A>:= 0, Z:= 1
  6007'   C8             C      	RET	Z
  6008'   23             C      	INC	HL	;HL:= HL + 1
  6009'   22 0DC4        C      	LD	(UE.EDEND),HL	;Textende
  600C'   18 E1          C      	JR	$-29
  600E'   F1             C      	POP	AF
  600F'   C9             C      	RET
  6010'                  C      FD.SDIN:
  6010'   D9             C      	EXX
  6011'   CD 71E2'       C      	CALL	DC.DCMPR
  6014'   D9             C      	EXX
  6015'   C9             C      	RET
  6016'   3E 93          C      	LD	A,93H	;Fehlerschluessel
  6018'   CD 56A5'       C      	CALL	UF.ERANZ
  601B'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;      Ausgabe einer F/S - Datei (neuer Bestand)
                         C      ;
  601C'                  C      FD.FDOUT:
  601C'   21 0000        C      	LD	HL,0	;Blockzaehler loeschen
  601F'   CD 6EE8'       C      	CALL	XY.STDX
  6022'   11             C      	DB	17
  6023'   21 0080        C      	LD	HL,80H	;Blocklaenge eintragen
  6026'   CD 6EF8'       C      	CALL	XY.STIDX
  6029'   09             C      	DB	9
  602A'   CD 72EC'       C      	CALL	UK.KSPFB	;Pufferbereitstellung
  602D'   21 8830        C      	LD	HL,UE.TEXAN	;HL:= Textanfang
  6030'   ED 5B 0DC4     C      	LD	DE,(UE.EDEND)	;BC:= Textende
  6034'   D9             C      	EXX
  6035'   CD 71DC'       C      	CALL	CP.INIT
  6038'   D9             C      	EXX
  6039'   B7             C      	OR	A	;CY:= 0
  603A'   E5             C      	PUSH	HL
  603B'   ED 52          C      	SBC	HL,DE
  603D'   30 13          C      	JR	NC,$+21
  603F'   E1             C      	POP	HL
  6040'   3A 2B28'       C      	LD	A,(UB.PAR2)
  6043'   FE 53          C      	CP	'S'
  6045'   F5             C      	PUSH	AF
  6046'   7E             C      	LD	A,(HL)
  6047'   CC 606A'       C      	CALL	Z,FD.SDOUT
  604A'   F1             C      	POP	AF
  604B'   7E             C      	LD	A,(HL)
  604C'   C4 72C8'       C      	CALL	NZ,UK.PUTK
'Ein-/Ausgabe im freien Format'	MACRO-80 3.44	09-Dec-81	PAGE	1-35


  604F'   23             C      	INC	HL
  6050'   18 E7          C      	JR	$-23
  6052'   E1             C      	POP	HL	;Endebehandlung
  6053'   01 0120        C      	LD	BC,288
  6056'   AF             C      	XOR	A
  6057'   CD 72C8'       C      	CALL	UK.PUTK
  605A'   0B             C      	DEC	BC
  605B'   78             C      	LD	A,B
  605C'   B1             C      	OR	C
  605D'   20 F7          C      	JR	NZ,$-7
  605F'   CD 622D'       C      	CALL	FD.DSPBB
  6062'   CD 5F98'       C      	CALL	FD.WRRES	;Reservebloecke schreiben
  6065'   CD 6EC8'       C      	CALL	XY.LDDX	;HL:= Blockzaehler
  6068'   11             C      	DB	17
  6069'   C9             C      	RET
  606A'                  C      FD.SDOUT:
  606A'   D9             C      	EXX
  606B'   CD 7179'       C      	CALL	CP.COMPR
  606E'   D9             C      	EXX
  606F'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;      Ausgabe einer F/S - Datei (alter Bestand)
                         C      ;
  6070'                  C      FD.FDOWR:
  6070'   21 0000        C      	LD	HL,0
  6073'   CD 6EE8'       C      	CALL	XY.STDX
  6076'   11             C      	DB	17
  6077'   21 8830        C      	LD	HL,UE.TEXAN
  607A'   D9             C      	EXX
  607B'   CD 71DC'       C      	CALL	CP.INIT
  607E'   D9             C      	EXX
  607F'   E5             C      	PUSH	HL
  6080'                  C      FD.FDOW1:
  6080'   CD 60C0'       C      	CALL	FD.FDUP
  6083'   E1             C      	POP	HL
  6084'                  C      FD.FDOW2:
  6084'   E5             C      	PUSH	HL
  6085'   ED 5B 0DC4     C      	LD	DE,(UE.EDEND)
  6089'   B7             C      	OR	A
  608A'   ED 52          C      	SBC	HL,DE
  608C'   30 1B          C      	JR	NC,FD.FDOW3
  608E'   E1             C      	POP	HL
  608F'   3A 2B28'       C      	LD	A,(UB.PAR2)
  6092'   FE 53          C      	CP	'S'
  6094'   7E             C      	LD	A,(HL)
  6095'   28 41          C      	JR	Z,FD.SDOW
  6097'   CD 72C8'       C      	CALL	UK.PUTK
  609A'   0B             C      	DEC	BC
  609B'                  C      FD.FDOW4:
  609B'   23             C      	INC	HL
  609C'   78             C      	LD	A,B
  609D'   B1             C      	OR	C
  609E'   20 E4          C      	JR	NZ,FD.FDOW2
  60A0'   CD 7311'       C      	CALL	UK.KBA	;Block schreiben
  60A3'   E5             C      	PUSH	HL
  60A4'   CD 60B6'       C      	CALL	FD.DECBZ
  60A7'   18 D7          C      	JR	FD.FDOW1
  60A9'                  C      FD.FDOW3:
  60A9'   E1             C      	POP	HL
  60AA'   AF             C      	XOR	A	;Endekennzeichen 00H
  60AB'   CD 72C8'       C      	CALL	UK.PUTK
  60AE'   CD 7311'       C      	CALL	UK.KBA
  60B1'   CD 60B6'       C      	CALL	FD.DECBZ
  60B4'   B7             C      	OR	A
  60B5'   C9             C      	RET
  60B6'                  C      FD.DECBZ:
  60B6'   CD 6EC8'       C      	CALL	XY.LDDX
  60B9'   11             C      	DB	17
  60BA'   2B             C      	DEC	HL
  60BB'   CD 6EE8'       C      	CALL	XY.STDX
  60BE'   11             C      	DB	17
  60BF'   C9             C      	RET
  60C0'                  C      FD.FDUP:
  60C0'   CD 7283'       C      	CALL	UK.KBW
  60C3'   DD 7E 0A       C      	LD	A,(IX+10)	;Laenge = 1, dann BM
  60C6'   FE 01          C      	CP	1
  60C8'   CA 6252'       C      	JP	Z,FD.BMGF
  60CB'   CD 6B00'       C      	CALL	UR.KBR
  60CE'   CD 6ED8'       C      	CALL	XY.LIDX
  60D1'   09             C      	DB	9
  60D2'   E5             C      	PUSH	HL
  60D3'   C1             C      	POP	BC
  60D4'   CD 72EC'       C      	CALL	UK.KSPFB
'Ein-/Ausgabe im freien Format'	MACRO-80 3.44	09-Dec-81	PAGE	1-36


  60D7'   C9             C      	RET
  60D8'                  C      FD.SDOW:
  60D8'   CD 606A'       C      	CALL	FD.SDOUT
  60DB'   78             C      	LD	A,B
  60DC'   A1             C      	AND	C
  60DD'   FE FF          C      	CP	0FFH
  60DF'   28 1B          C      	JR	Z,FD.SDK1
  60E1'   FE FE          C      	CP	0FEH
  60E3'   28 03          C      	JR	Z,FD.SDK2
  60E5'   C3 609B'       C      	JP	FD.FDOW4
  60E8'                  C      FD.SDK2:
  60E8'   EB             C      	EX	DE,HL
  60E9'   CD 60C0'       C      	CALL	FD.FDUP
  60EC'   3E 09          C      	LD	A,09H
  60EE'   CD 72C8'       C      	CALL	UK.PUTK
  60F1'   0B             C      	DEC	BC
  60F2'                  C      FD.SDK0:
  60F2'   3E 3B          C      	LD	A,';'
  60F4'   CD 72C8'       C      	CALL	UK.PUTK
  60F7'   0B             C      	DEC	BC
  60F8'   EB             C      	EX	DE,HL
  60F9'   C3 609B'       C      	JP	FD.FDOW4
  60FC'                  C      FD.SDK1:
  60FC'   EB             C      	EX	DE,HL
  60FD'   CD 60C0'       C      	CALL	FD.FDUP
  6100'   18 F0          C      	JR	FD.SDK0
                         C      ;--------------------------------------------------------------
                         C      ;        Startroutine Ein-/Ausgabe
                         C      ;
  6102'                  C      FD.FSTRT:
  6102'   CD 6E78'       C      	CALL	U1.BILO
  6105'   CD 6DA9'       C      	CALL	U1.KTINI
  6108'   3A 3326        C      	LD	A,(UE.BWSA+326H)
  610B'   CD 6E8C'       C      	CALL	U1.TST
  610E'   DA 613A'       C      	JP	C,FD.STRT1
  6111'   DD 77 03       C      	LD	(IX+3),A
  6114'   CD 6ACA'       C      	CALL	UR.KRE
  6117'   CD 6AD8'       C      	CALL	UR.KRWW
  611A'   CD 6D5D'       C      	CALL	U1.DSVG
  611D'   3E 0E          C      	LD	A,14
  611F'   32 2B00'       C      	LD	(UB.ZN),A
  6122'   3A 3328        C      	LD	A,(UE.BWSA+328H)
  6125'   FE 53          C      	CP	'S'
  6127'   28 02          C      	JR	Z,$+4
  6129'   3E 46          C      	LD	A,'F'
  612B'   57             C      	LD	D,A
  612C'   32 2B28'       C      	LD	(UB.PAR2),A
  612F'   21 5926'       C      	LD	HL,UA.ZKSDT
  6132'   28 03          C      	JR	Z,$+5
  6134'   21 5896'       C      	LD	HL,UA.ZKDAT
  6137'   CD 6B72'       C      	CALL	UR.MIMO
  613A'                  C      FD.STRT1:
  613A'   FD E1          C      	POP	IY
  613C'   D8             C      	RET	C
  613D'   FD E5          C      	PUSH	IY
  613F'   3E 53          C      	LD	A,'S'
  6141'   BA             C      	CP	D
  6142'   CC 616D'       C      	CALL	Z,FD.DECHL
  6145'   CD 5F7C'       C      	CALL	FD.DASU
  6148'   DC 614F'       C      	CALL	C,FD.SETJ
  614B'   D4 6167'       C      	CALL	NC,FD.SETN
  614E'   C9             C      	RET
  614F'                  C      FD.SETJ:
  614F'   C5             C      	PUSH	BC
  6150'   D5             C      	PUSH	DE
  6151'   E5             C      	PUSH	HL
  6152'   EB             C      	EX	DE,HL
  6153'   06 08          C      	LD	B,8
  6155'   13             C      	INC	DE
  6156'   10 FD          C      	DJNZ	$-1
  6158'   21 0E6E        C      	LD	HL,UE.PUF+8
  615B'   01 0006        C      	LD	BC,6
  615E'   ED B0          C      	LDIR
  6160'   E1             C      	POP	HL
  6161'   D1             C      	POP	DE
  6162'   C1             C      	POP	BC
  6163'   3E 4A          C      	LD	A,'J'
  6165'   18 02          C      	JR	$+4
  6167'                  C      FD.SETN:
  6167'   3E 4E          C      	LD	A,'N'
  6169'   32 2B26'       C      	LD	(UB.PAR1),A
  616C'   C9             C      	RET
  616D'                  C      FD.DECHL:
'Ein-/Ausgabe im freien Format'	MACRO-80 3.44	09-Dec-81	PAGE	1-37


  616D'   2B             C      	DEC	HL
  616E'   2B             C      	DEC	HL
  616F'   C9             C      	RET
                         C      ;****************************************************************
                         C      ;        Ausgabeprogramm
                         C      ;****************************************************************
  6170'   6170'          C      	DW	$
  6172'   41 55 53 20    C      	DB	'AUS '
  6176'                  C      FD.FOUT1:
  6176'   CD 6102'       C      	CALL	FD.FSTRT
  6179'   3A 2B26'       C      	LD	A,(UB.PAR1)
  617C'   FE 4A          C      	CP	'J'	;DATEI SCHON VORHANDEN ?
  617E'   CA 61E9'       C      	JP	Z,FD.FOLWR	;JA
                         C      ;-------------------------------NEIN--> NEUE ERSTELLEN-----------------
  6181'   79             C      	LD	A,C	;NEXT RECORD
  6182'   32 2B26'       C      	LD	(UB.PAR1),A
  6185'   3E 7F          C      	LD	A,7FH
  6187'   32 2B2A'       C      	LD	(UB.PAR3),A	;PARAMETER KOMMENTARABFRAGE JA
  618A'   CD 6E15'       C      	CALL	U1.VZS	;NEUEN VERZ.SATZ SCHREIBEN
  618D'   CD 5F5D'       C      	CALL	FD.POSK
  6190'   C5             C      	PUSH	BC
  6191'   CD 601C'       C      	CALL	FD.FDOUT
  6194'   E5             C      	PUSH	HL	;BLOCKZAEHLER
  6195'   CD 6AEE'       C      	CALL	UR.KBM
  6198'   21 0020        C      	LD	HL,32
  619B'   CD 6EF8'       C      	CALL	XY.STIDX
  619E'   09             C      	DB	9
  619F'   CD 6D4D'       C      	CALL	U1.VSX
  61A2'   E1             C      	POP	HL
  61A3'   C1             C      	POP	BC
  61A4'   E5             C      	PUSH	HL
  61A5'   79             C      	LD	A,C
  61A6'   3C             C      	INC	A
  61A7'   32 0E66        C      	LD	(UE.PUF),A
  61AA'   F5             C      	PUSH	AF
  61AB'   DD 36 04 08    C      	LD	(IX+4),08H
  61AF'   CD 5675'       C      	CALL	UF.EXEC
  61B2'   CD 6AD8'       C      	CALL	UR.KRWW
  61B5'   CD 6D5D'       C      	CALL	U1.DSVG
  61B8'   CD 6B00'       C      	CALL	UR.KBR
  61BB'   F1             C      	POP	AF
  61BC'   32 0E67        C      	LD	(UE.PUF+1),A
  61BF'   78             C      	LD	A,B
  61C0'   3C             C      	INC	A
  61C1'   32 0E69        C      	LD	(UE.PUF+3),A
  61C4'   DD 36 04 08    C      	LD	(IX+4),08H
  61C8'   CD 5675'       C      	CALL	UF.EXEC
  61CB'   DD 36 04 02    C      	LD	(IX+4),02H
  61CF'   CD 5675'       C      	CALL	UF.EXEC
  61D2'   10 FB          C      	DJNZ	$-3
  61D4'   CD 6B00'       C      	CALL	UR.KBR
  61D7'   E1             C      	POP	HL
  61D8'   22 0E7F        C      	LD	(UE.PUF+25),HL
  61DB'   DD 36 04 08    C      	LD	(IX+4),08H
  61DF'   CD 5675'       C      	CALL	UF.EXEC
  61E2'                  C      FD.END:
  61E2'   CD 6AD2'       C      	CALL	UR.KRW
  61E5'   CD 6ADC'       C      	CALL	UR.KRA
  61E8'   C9             C      	RET
  61E9'                  C      FD.FOLWR:
  61E9'   21 58F5'       C      	LD	HL,UA.ZKDL	;DATEI UEBERSCHREIBEN?
  61EC'   CD 6B72'       C      	CALL	UR.MIMO
  61EF'   D8             C      	RET	C
  61F0'   7E             C      	LD	A,(HL)
  61F1'   FE 4A          C      	CP	'J'
  61F3'   C0             C      	RET	NZ
  61F4'   CD 5F5D'       C      	CALL	FD.POSK
  61F7'   CD 6070'       C      	CALL	FD.FDOWR
  61FA'   CD 622D'       C      	CALL	FD.DSPBB
  61FD'   CD 6247'       C      	CALL	FD.RDEND
  6200'   CD 623D'       C      	CALL	FD.DSPBG
  6203'   18 DD          C      	JR	$-33
                         C      ;**********************************************************************
                         C      ;      Eingabeprogramm
                         C      ;**********************************************************************
  6205'   6205'          C      	DW	$
  6207'   45 49 4E 20    C      	DB	'EIN '
  620B'                  C      FD.FDIN2:
  620B'   CD 6102'       C      	CALL	FD.FSTRT
  620E'   3A 2B26'       C      	LD	A,(UB.PAR1)
  6211'   FE 4A          C      	CP	'J'
  6213'   28 07          C      	JR	Z,$+9
  6215'   3E 91          C      	LD	A,91H
'Ein-/Ausgabe im freien Format'	MACRO-80 3.44	09-Dec-81	PAGE	1-38


  6217'   CD 56A5'       C      	CALL	UF.ERANZ
  621A'   18 C6          C      	JR	FD.END
  621C'   CD 5F5D'       C      	CALL	FD.POSK
  621F'   CD 5FC9'       C      	CALL	FD.FDINP
  6222'   CD 622D'       C      	CALL	FD.DSPBB
  6225'   CD 6247'       C      	CALL	FD.RDEND
  6228'   CD 623D'       C      	CALL	FD.DSPBG
  622B'   18 B5          C      	JR	FD.END
                         C      ;----------------------------------------------------------------------
  622D'                  C      FD.DSPBB:
  622D'   CD 6EC8'       C      	CALL	XY.LDDX
  6230'   11             C      	DB	17
  6231'   EB             C      	EX	DE,HL
  6232'   21 593B'       C      	LD	HL,UA.ZKBEL
  6235'   CD 6B72'       C      	CALL	UR.MIMO
  6238'   EB             C      	EX	DE,HL
  6239'   CD 6FDF'       C      	CALL	UC.CVBD3
  623C'   C9             C      	RET
  623D'                  C      FD.DSPBG:
  623D'   CD 6EC8'       C      	CALL	XY.LDDX
  6240'   11             C      	DB	17
  6241'   EB             C      	EX	DE,HL
  6242'   21 594E'       C      	LD	HL,UA.ZKBLG
  6245'   18 EE          C      	JR	$-16
  6247'                  C      FD.RDEND:
  6247'   CD 7283'       C      	CALL	UK.KBW
  624A'   DD 7E 0A       C      	LD	A,(IX+10)	;Laenge = 1, dann BM
  624D'   FE 01          C      	CP	1
  624F'   C8             C      	RET	Z
  6250'   18 F5          C      	JR	FD.RDEND
  6252'                  C      FD.BMGF:
  6252'   3E 95          C      	LD	A,95H
  6254'   CD 56A5'       C      	CALL	UF.ERANZ
  6257'   D1             C      	POP	DE
  6258'   D1             C      	POP	DE
  6259'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Laden von MRES-P-Dateien'
                         C      	PAGE
'Laden von MRES-P-Dateien'	MACRO-80 3.44	09-Dec-81	PAGE	1-39


                         C      
                         C      ;	PN	LD
                         C      ;***********************************************************
                         C      ;
                         C      ;        Laden von MRES-P-Dateien
                         C      ;
                         C      ;***********************************************************
  625A'   625A'          C      	DW	$
  625C'   4C 4F 41 44    C      	DB	'LOAD'
  6260'   3A 3327        C      	LD	A,(UE.BWSA+327H)
  6263'   CD 6E8C'       C      	CALL	U1.TST
  6266'   D8             C      	RET	C
  6267'   CD 6DA9'       C      	CALL	U1.KTINI
  626A'   DD 77 03       C      	LD	(IX+3),A
  626D'   CD 6E78'       C      	CALL	U1.BILO
  6270'   3E 0D          C      	LD	A,13
  6272'   32 2B00'       C      	LD	(UB.ZN),A
  6275'                  C      LD.DATN:
  6275'   21 5896'       C      	LD	HL,UA.ZKDAT	;Dateiname ?
  6278'   CD 6B72'       C      	CALL	UR.MIMO
  627B'   D8             C      	RET	C
  627C'   CD 6ACA'       C      	CALL	UR.KRE
  627F'   CD 6AD8'       C      	CALL	UR.KRWW
  6282'   CD 6D5D'       C      	CALL	U1.DSVG
  6285'   3E 01          C      	LD	A,01H
  6287'   B8             C      	CP	B
  6288'   28 0A          C      	JR	Z,LD.LD21	;NEU INITIALISIERTE KASSETTE
  628A'                  C      LD.LD2:
  628A'   CD 7283'       C      	CALL	UK.KBW
  628D'   CD 6D8E'       C      	CALL	U1.NMVGL	;Dateiname vergleichen
  6290'   38 08          C      	JR	C,LD.DATFU	;---> Datei gefunden
  6292'   10 F6          C      	DJNZ	LD.LD2
  6294'                  C      LD.LD21:
  6294'   3E 91          C      	LD	A,91H	;Datei nicht vorhanden
  6296'   CD 56A5'       C      	CALL	UF.ERANZ	;FEHLERANZEIGE
  6299'   C9             C      	RET
  629A'                  C      LD.DATFU:
  629A'   3A 0E6C        C      	LD	A,(UE.PUF+6)	;TYP
  629D'   FE 4F          C      	CP	'O'
  629F'   F5             C      	PUSH	AF
  62A0'   21 0E7D        C      	LD	HL,UE.PUF+23
  62A3'   7E             C      	LD	A,(HL)
  62A4'   F5             C      	PUSH	AF
  62A5'   47             C      	LD	B,A
  62A6'   04             C      	INC	B
  62A7'   CD 6B0F'       C      	CALL	UR.POSIK	;Positionieren
  62AA'   CD 7283'       C      	CALL	UK.KBW
  62AD'   F1             C      	POP	AF
  62AE'   21 0E66        C      	LD	HL,UE.PUF
  62B1'   BE             C      	CP	(HL)
  62B2'   28 07          C      	JR	Z,LD.DATPO	;Datei richtig positioniert
  62B4'   F1             C      	POP	AF
  62B5'   3E 94          C      	LD	A,94H
  62B7'   CD 56A5'       C      	CALL	UF.ERANZ
  62BA'   C9             C      	RET
  62BB'                  C      LD.DATPO:
  62BB'   F1             C      	POP	AF
  62BC'   CA 6351'       C      	JP	Z,RL.BEG
  62BF'   3A 3329        C      	LD	A,(UE.BWSA+329H)
  62C2'   FE 56          C      	CP	'V'
  62C4'   20 57          C      	JR	NZ,LD.LD3
  62C6'   21 58A9'       C      	LD	HL,UA.ZKLAD	;Ladeadresse ?
  62C9'   CD 6B72'       C      	CALL	UR.MIMO
  62CC'   DA 6275'       C      	JP	C,LD.DATN
  62CF'   CD 6E96'       C      	CALL	U1.PRADR	;ADRESSE EINGEGEBEN
  62D2'   38 F2          C      	JR	C,$-12
  62D4'   EB             C      	EX	DE,HL
  62D5'   21 2B26'       C      	LD	HL,UB.PAR1
  62D8'   CD 6FCC'       C      	CALL	UC.CVXA
  62DB'                  C      LD.LD4:
  62DB'   CD 7260'       C      	CALL	UK.KLPFB
  62DE'   CD 7223'       C      	CALL	UK.GETK
  62E1'   CD 7223'       C      	CALL	UK.GETK
  62E4'   67             C      	LD	H,A
  62E5'   CD 7223'       C      	CALL	UK.GETK
  62E8'   6F             C      	LD	L,A
  62E9'   7A             C      	LD	A,D
  62EA'   B3             C      	OR	E
  62EB'   28 09          C      	JR	Z,LD.LD5
  62ED'   ED 5B 2B26'    C      	LD	DE,(UB.PAR1)
  62F1'   EB             C      	EX	DE,HL
  62F2'   B7             C      	OR	A
'Laden von MRES-P-Dateien'	MACRO-80 3.44	09-Dec-81	PAGE	1-40


  62F3'   ED 52          C      	SBC	HL,DE
  62F5'   EB             C      	EX	DE,HL	;DE:= Verschiebung zur ersten
  62F6'                  C      LD.LD5:
  62F6'   CD 6B00'       C      	CALL	UR.KBR
  62F9'   CD 6322'       C      	CALL	LD.LADER
  62FC'   22 2B28'       C      	LD	(UB.PAR2),HL
  62FF'   21 3329        C      	LD	HL,UE.BWSA+329H
  6302'   06 04          C      	LD	B,4
  6304'   7E             C      	LD	A,(HL)
  6305'   FE 53          C      	CP	'S'
  6307'   28 0A          C      	JR	Z,LD.START
  6309'   23             C      	INC	HL
  630A'   10 F8          C      	DJNZ	$-6
  630C'   CD 6AD2'       C      	CALL	UR.KRW
  630F'   CD 6ADC'       C      	CALL	UR.KRA
  6312'   C9             C      	RET
  6313'                  C      LD.START:
  6313'   CD 6AD2'       C      	CALL	UR.KRW
  6316'   CD 6ADC'       C      	CALL	UR.KRA
  6319'   2A 2B28'       C      	LD	HL,(UB.PAR2)
  631C'   E9             C      	JP	(HL)
  631D'                  C      LD.LD3:
  631D'   11 0000        C      	LD	DE,0
  6320'   18 B9          C      	JR	LD.LD4
                         C      ;--------------------------------------------------------------
  6322'                  C      LD.LADER:
  6322'   CD 7260'       C      	CALL	UK.KLPFB
  6325'                  C      LD.LAD2:
  6325'   CD 7223'       C      	CALL	UK.GETK
  6328'   FE 00          C      	CP	0
  632A'   28 16          C      	JR	Z,LD.LDEND
  632C'   47             C      	LD	B,A
  632D'   CD 7223'       C      	CALL	UK.GETK
  6330'   67             C      	LD	H,A
  6331'   CD 7223'       C      	CALL	UK.GETK
  6334'   6F             C      	LD	L,A
  6335'   19             C      	ADD	HL,DE
  6336'                  C      LD.LAD1:
  6336'   CD 7223'       C      	CALL	UK.GETK
  6339'   77             C      	LD	(HL),A
  633A'   BE             C      	CP	(HL)
  633B'   20 0E          C      	JR	NZ,LD.LADF
  633D'   23             C      	INC	HL
  633E'   10 F6          C      	DJNZ	LD.LAD1
  6340'   18 E3          C      	JR	LD.LAD2
  6342'                  C      LD.LDEND:
  6342'   CD 7223'       C      	CALL	UK.GETK
  6345'   67             C      	LD	H,A
  6346'   CD 7223'       C      	CALL	UK.GETK
  6349'   6F             C      	LD	L,A
  634A'   C9             C      	RET
  634B'                  C      LD.LADF:
  634B'   3E 93          C      	LD	A,93H
  634D'   CD 56A5'       C      	CALL	UF.ERANZ
  6350'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Relativloader fuer O-Dateien'
                         C      	PAGE
'Relativloader fuer O-Dateien'	MACRO-80 3.44	09-Dec-81	PAGE	1-41


                         C      
                         C      ;	PN	RL
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;     RELATIVLOADER FUER O-DATEIEN
                         C      ;
                         C      ;----------------------------------------------------------------------
  6351'                  C      RL.BEG:
  6351'   21 58BC'       C      	LD	HL,UA.ZKBEG	;BEGINN ?
  6354'   CD 6B72'       C      	CALL	UR.MIMO
  6357'   DA 6275'       C      	JP	C,LD.DATN
  635A'   CD 6E96'       C      	CALL	U1.PRADR
  635D'   38 F2          C      	JR	C,RL.BEG
  635F'   EB             C      	EX	DE,HL
  6360'   21 2B30'       C      	LD	HL,UB.PATAB
  6363'   CD 6FCC'       C      	CALL	UC.CVXA
  6366'                  C      RL.UG:
  6366'   CD 7283'       C      	CALL	UK.KBW
  6369'   2A 2B30'       C      	LD	HL,(UB.PATAB)	;BGADR---->HL
  636C'   0E 01          C      	LD	C,001H	;LADEN BLOCKZAEHLER MIT
                         C      			;ANFANGSWERT
  636E'   CD 63F9'       C      	CALL	RL.UP6	; AUFRUF EINGABE-UP
                         C      ;********** TEST BEFEHLSKENNZEICHENBYTE *******************************
  6371'                  C      RL.M16:
  6371'   CB 5A          C      	BIT	3,D	;TEST ORG-BEFEHL
  6373'   C2 644D'       C      	JP	NZ,RL.OB	;JA--->FEHLER
  6376'   CB 62          C      	BIT	4,D	;TEST BER -BEFEHL
  6378'   C2 63E2'       C      	JP	NZ,RL.M10
  637B'   3E 07          C      	LD	A,007H
  637D'   A2             C      	AND	D	;TEST BEFEHLS LAENGE=0 ?
  637E'   CA 63F3'       C      	JP	Z,RL.M11
  6381'   47             C      	LD	B,A	;BEFEHLSLAENGE-->B
  6382'                  C      RL.M12:
  6382'   CD 63F9'       C      	CALL	RL.UP6
  6385'   72             C      	LD	(HL),D
  6386'   23             C      	INC	HL
  6387'   10 F9          C      	DJNZ	RL.M12	;EINGABE BEFEHL
  6389'   CD 63F9'       C      	CALL	RL.UP6
  638C'   CB 7A          C      	BIT	7,D	;TEST BEFEHLSKENNZEICHENBYTE ?
  638E'   20 E1          C      	JR	NZ,RL.M16	; JA
                         C      ;******* TEST ADRESSKENNZEICHENBYTE ***********************************
  6390'   CB 6A          C      	BIT	5,D	;TEST OB REL.ADR. FOLGT
  6392'   CA 6451'       C      	JP	Z,RL.RA	;NEIN-->FEHLER
  6395'   CB 72          C      	BIT	6,D	;FOLGT BEZUGNAHME AUF
                         C      			;SYMBOLVERZEICHNIS
  6397'   C2 6455'       C      	JP	NZ,RL.SV	;JA--->FEHLER
  639A'   CB 52          C      	BIT	2,D	;MINUS ?
  639C'   C2 6459'       C      	JP	NZ,RL.MN
  639F'                  C      RL.M17:
  639F'   3E 03          C      	LD	A,003H
  63A1'   A2             C      	AND	D	;TEST ADRESSLAENGE
  63A2'   F5             C      	PUSH	AF
  63A3'   E5             C      	PUSH	HL
  63A4'   CD 63F9'       C      	CALL	RL.UP6
  63A7'   62             C      	LD	H,D	;ADRESSE ---->HL
  63A8'   CD 63F9'       C      	CALL	RL.UP6
  63AB'   6A             C      	LD	L,D
  63AC'   C5             C      	PUSH	BC
  63AD'   E5             C      	PUSH	HL
  63AE'   21 2B30'       C      	LD	HL,UB.PATAB
  63B1'   4E             C      	LD	C,(HL)	;BEGINN(LADE)ADRESSE--->BC
  63B2'   23             C      	INC	HL
  63B3'   46             C      	LD	B,(HL)
  63B4'   E1             C      	POP	HL
  63B5'   09             C      	ADD	HL,BC	;ERMITTELN SPEICHERADRESSE
  63B6'   EB             C      	EX	DE,HL	;SP.ADR.--->DE
  63B7'   C1             C      	POP	BC
  63B8'   E1             C      	POP	HL
  63B9'   F1             C      	POP	AF
  63BA'   28 04          C      	JR	Z,RL.M13
  63BC'   CB 47          C      	BIT	0,A	;NUR L-TEIL DER ADRESSE ?
  63BE'   28 10          C      	JR	Z,RL.M14	; JA
                         C      ;********** ADRESSE IN SPEICHER EINTRAGEN *****************************
  63C0'                  C      RL.M13:
  63C0'   73             C      	LD	(HL),E
  63C1'   F5             C      	PUSH	AF
  63C2'   7B             C      	LD	A,E
  63C3'   BE             C      	CP	(HL)
  63C4'   C2 6444'       C      	JP	NZ,RL.ECHO
  63C7'   F1             C      	POP	AF
  63C8'   23             C      	INC	HL
  63C9'   FE 03          C      	CP	003H
'Relativloader fuer O-Dateien'	MACRO-80 3.44	09-Dec-81	PAGE	1-42


  63CB'   28 03          C      	JR	Z,RL.M14
  63CD'   B7             C      	OR	A	;NUR H-TEIL DER ADRESSE ?
  63CE'   20 08          C      	JR	NZ,RL.M15	; JA
  63D0'                  C      RL.M14:
  63D0'   72             C      	LD	(HL),D
  63D1'   F5             C      	PUSH	AF
  63D2'   7A             C      	LD	A,D
  63D3'   BE             C      	CP	(HL)
  63D4'   20 6E          C      	JR	NZ,RL.ECHO
  63D6'   F1             C      	POP	AF
  63D7'   23             C      	INC	HL
  63D8'                  C      RL.M15:
  63D8'   CD 63F9'       C      	CALL	RL.UP6
  63DB'   CB 7A          C      	BIT	7,D	; TEST BEFEHLSKENNZEICHENBYTE
  63DD'   20 92          C      	JR	NZ,RL.M16
  63DF'   C3 645D'       C      	JP	RL.BF	; NEIN--->FEHLER
                         C      ;----------------------------------------------------------------------
  63E2'                  C      RL.M10:
  63E2'   CD 63F9'       C      	CALL	RL.UP6	;BEI BER-BEFEHL ADDIEREN DER
  63E5'   D5             C      	PUSH	DE	;DEF. BEREICHSLAENGE ZU
  63E6'   CD 63F9'       C      	CALL	RL.UP6	;ADRESSE
  63E9'   7A             C      	LD	A,D
  63EA'   D1             C      	POP	DE
  63EB'   5F             C      	LD	E,A
  63EC'   19             C      	ADD	HL,DE
  63ED'   CD 63F9'       C      	CALL	RL.UP6
  63F0'   C3 6371'       C      	JP	RL.M16
  63F3'                  C      RL.M11:
  63F3'   CD 63F9'       C      	CALL	RL.UP6	;BEI BFL=0 SPRUNG ZUM TEST
  63F6'   C3 639F'       C      	JP	RL.M17	;ADRESSKENNZEICHENBYTE
                         C      ;******* UP ZUR ZEICHENWEISE EINGABE DER O-DATEI **********************
  63F9'                  C      RL.UP6:
  63F9'   CD 7223'       C      	CALL	UK.GETK
  63FC'   57             C      	LD	D,A
  63FD'   0D             C      	DEC	C	;REDUZIEREN BLOCKLAENGE
  63FE'   C0             C      	RET	NZ		;RET BEI UNGLEICH NULL
  63FF'   A7             C      	AND	A	;IST NAECHSTE BLOCKLAENGE NULL ?
  6400'   28 04          C      	JR	Z,RL.M21	;JA-->VERZWEIGUNG ENDEBEH
  6402'   4F             C      	LD	C,A	;NEIN-->EINTRAGEN BLKLAENGE
  6403'   0C             C      	INC	C
  6404'   18 F3          C      	JR	RL.UP6
                         C      ;*********** ENDEBEHANDLUNG *******************************************
  6406'                  C      RL.M21:
  6406'   D1             C      	POP	DE
  6407'   E5             C      	PUSH	HL
  6408'   3E 0F          C      	LD	A,15
  640A'   32 2B00'       C      	LD	(UB.ZN),A
  640D'   21 58D2'       C      	LD	HL,UA.ZKEND+3
  6410'   11 3460        C      	LD	DE,3460H
  6413'   01 0010        C      	LD	BC,16
  6416'   ED B0          C      	LDIR
  6418'   21 2B00'       C      	LD	HL,UB.ZN
  641B'   34             C      	INC	(HL)
  641C'   E1             C      	POP	HL
  641D'   2B             C      	DEC	HL
  641E'   11 3470        C      	LD	DE,3470H	;HINTER AUSSCHRIFT ENDE
  6421'   CD 6F86'       C      	CALL	UC.CVHLX
  6424'   21 58E2'       C      	LD	HL,UA.STADR	;STARTADRESSE ?
  6427'   CD 6B72'       C      	CALL	UR.MIMO
  642A'   D8             C      	RET	C
  642B'   EB             C      	EX	DE,HL
  642C'   21 2B32'       C      	LD	HL,UB.PATAB+2
  642F'   CD 6FCC'       C      	CALL	UC.CVXA	;STARTADR.-->BINAER
  6432'   3A 3329        C      	LD	A,(UE.BWSA+329H)
  6435'   FE 53          C      	CP	'S'
  6437'   20 04          C      	JR	NZ,$+6
  6439'   2A 2B32'       C      	LD	HL,(UB.PATAB+2)
  643C'   E9             C      	JP	(HL)
  643D'   CD 6AD2'       C      	CALL	UR.KRW
  6440'   CD 6ADC'       C      	CALL	UR.KRA
  6443'   C9             C      	RET
                         C      ;---------------------------------------------------------------------
  6444'                  C      RL.ECHO:
  6444'   D1             C      	POP	DE
  6445'   3E 93          C      	LD	A,93H
  6447'   18 16          C      	JR	RL.FMELD
  6449'                  C      RL.DATNV:
  6449'   3E 91          C      	LD	A,91H
  644B'   18 12          C      	JR	RL.FMELD
  644D'                  C      RL.OB:
  644D'   3E 96          C      	LD	A,96H
  644F'   18 0E          C      	JR	RL.FMELD
  6451'                  C      RL.RA:
'Relativloader fuer O-Dateien'	MACRO-80 3.44	09-Dec-81	PAGE	1-43


  6451'   3E 97          C      	LD	A,97H
  6453'   18 0A          C      	JR	RL.FMELD
  6455'                  C      RL.SV:
  6455'   3E 98          C      	LD	A,98H
  6457'   18 06          C      	JR	RL.FMELD
  6459'                  C      RL.MN:
  6459'   3E 99          C      	LD	A,99H
  645B'   18 02          C      	JR	RL.FMELD
  645D'                  C      RL.BF:
  645D'   3E 9A          C      	LD	A,9AH
  645F'                  C      RL.FMELD:
  645F'   CD 56A5'       C      	CALL	UF.ERANZ
  6462'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Retten von Maschinencodeprogrammen als MRES - P-Datei'
                         C      	PAGE
'Retten von Maschinencodeprogrammen als MRES - P-Datei'	MACRO-80 3.44	09-Dec-81	PAGE	1-44


                         C      
                         C      ;	PN	SV
                         C      ;**********************************************************************
                         C      ;
                         C      ;      Retten von Maschinencodeprogrammen als MRES - P-Datei
                         C      ;
                         C      ;**********************************************************************
  6463'   6463'          C      	DW	$
  6465'   53 41 56 45    C      	DB	'SAVE'
  6469'   3A 3327        C      	LD	A,(UE.BWSA+327H)
  646C'   CD 6E8C'       C      	CALL	U1.TST
  646F'   D8             C      	RET	C
  6470'   CD 6DA9'       C      	CALL	U1.KTINI
  6473'   DD 77 03       C      	LD	(IX+3),A
  6476'   AF             C      	XOR	A
  6477'   32 2B27'       C      	LD	(UB.PAR1+1),A
  647A'   CD 6E78'       C      	CALL	U1.BILO	;BS LOESCHEN
  647D'   CD 6ACA'       C      	CALL	UR.KRE
  6480'   DD CB 00 56    C      	BIT	2,(IX)
  6484'   28 05          C      	JR	Z,$+7
  6486'   3E 19          C      	LD	A,19H
  6488'   CD 56A5'       C      	CALL	UF.ERANZ
  648B'   CD 6AD8'       C      	CALL	UR.KRWW
  648E'                  C      SV.SV20:
  648E'   CD 6D5D'       C      	CALL	U1.DSVG
  6491'   C5             C      	PUSH	BC
  6492'   79             C      	LD	A,C
  6493'   32 2B26'       C      	LD	(UB.PAR1),A	;NEXT RECORD
  6496'   3E 0D          C      	LD	A,13
  6498'   32 2B00'       C      	LD	(UB.ZN),A
  649B'                  C      SV.DATN:
  649B'   21 5896'       C      	LD	HL,UA.ZKDAT	;Dateiname ?
  649E'   CD 6B72'       C      	CALL	UR.MIMO
  64A1'   D8             C      	RET	C
  64A2'   C1             C      	POP	BC
  64A3'   05             C      	DEC	B
  64A4'   28 1A          C      	JR	Z,SV.SV30	;NEUE KASSETTE
  64A6'                  C      SV.SV21:
  64A6'   CD 7283'       C      	CALL	UK.KBW
  64A9'   CD 6D8E'       C      	CALL	U1.NMVGL
  64AC'   38 04          C      	JR	C,SV.DATV1	;Dateiname bereits vorhanden
  64AE'   10 F6          C      	DJNZ	SV.SV21
  64B0'   18 0E          C      	JR	SV.SV30
  64B2'                  C      SV.DATV1:
  64B2'   3E 01          C      	LD	A,01H
  64B4'   B8             C      	CP	B
  64B5'   CC 65FE'       C      	CALL	Z,SV.DALO1
  64B8'   28 0E          C      	JR	Z,SV.SV37
  64BA'                  C      SV.DATVO:
  64BA'   3E 92          C      	LD	A,92H
  64BC'   CD 56A5'       C      	CALL	UF.ERANZ
  64BF'   C9             C      	RET
  64C0'                  C      SV.SV30:
  64C0'   3E 50          C      	LD	A,'P'
  64C2'   32 2B28'       C      	LD	(UB.PAR2),A
  64C5'   CD 6E15'       C      	CALL	U1.VZS
  64C8'                  C      SV.SV37:
  64C8'   3A 2B27'       C      	LD	A,(UB.PAR1+1)
  64CB'   FE 4C          C      	CP	'L'
  64CD'   20 0B          C      	JR	NZ,SV.SV31
  64CF'   21 58F5'       C      	LD	HL,UA.ZKDL
  64D2'   CD 6B72'       C      	CALL	UR.MIMO
  64D5'   7E             C      	LD	A,(HL)
  64D6'   FE 4A          C      	CP	'J'
  64D8'   20 E0          C      	JR	NZ,SV.DATVO
  64DA'                  C      SV.SV31:
  64DA'   3A 2B26'       C      	LD	A,(UB.PAR1)	;NEXT RECORD
  64DD'   47             C      	LD	B,A
  64DE'   C5             C      	PUSH	BC
  64DF'   04             C      	INC	B
  64E0'   CD 6B0F'       C      	CALL	UR.POSIK
  64E3'   CD 7283'       C      	CALL	UK.KBW
  64E6'   21 0E66        C      	LD	HL,UE.PUF
  64E9'   C1             C      	POP	BC
  64EA'   7E             C      	LD	A,(HL)
  64EB'   B8             C      	CP	B
  64EC'   28 06          C      	JR	Z,SV.SAVE3
  64EE'   3E 94          C      	LD	A,94H
  64F0'   CD 56A5'       C      	CALL	UF.ERANZ
  64F3'   C9             C      	RET
  64F4'                  C      SV.SAVE3:
  64F4'   21 58BC'       C      	LD	HL,UA.ZKBEG	;Beginn ?
'Retten von Maschinencodeprogrammen als MRES - P-Datei'	MACRO-80 3.44	09-Dec-81	PAGE	1-45


  64F7'   CD 6B72'       C      	CALL	UR.MIMO
  64FA'   DA 649B'       C      	JP	C,SV.DATN
  64FD'   CD 6E96'       C      	CALL	U1.PRADR
  6500'   38 F2          C      	JR	C,SV.SAVE3
  6502'   EB             C      	EX	DE,HL
  6503'   21 2B28'       C      	LD	HL,UB.PAR2
  6506'   CD 6FCC'       C      	CALL	UC.CVXA
  6509'                  C      SV.SAVE4:
  6509'   21 58CF'       C      	LD	HL,UA.ZKEND	;Ende ?
  650C'   CD 6B72'       C      	CALL	UR.MIMO
  650F'   38 E3          C      	JR	C,SV.SAVE3
  6511'   CD 6E96'       C      	CALL	U1.PRADR
  6514'   38 F3          C      	JR	C,SV.SAVE4
  6516'   EB             C      	EX	DE,HL
  6517'   21 2B2A'       C      	LD	HL,UB.PAR3
  651A'   CD 6FCC'       C      	CALL	UC.CVXA
  651D'   CD 656D'       C      	CALL	SV.BYANZ
  6520'   38 D2          C      	JR	C,SV.SAVE3
  6522'   28 D0          C      	JR	Z,SV.SAVE3
  6524'   CD 6592'       C      	CALL	SV.SAVE
  6527'   CD 6AEE'       C      	CALL	UR.KBM
  652A'   CD 6578'       C      	CALL	SV.DATS1	;1.DATEISATZ SCHREIBEN
  652D'   CD 6AF4'       C      	CALL	UR.KSL
  6530'   CD 6AD8'       C      	CALL	UR.KRWW
  6533'   CD 6D5D'       C      	CALL	U1.DSVG
  6536'   05             C      	DEC	B
  6537'   3A 2B27'       C      	LD	A,(UB.PAR1+1)
  653A'   FE 4C          C      	CP	'L'
  653C'   28 13          C      	JR	Z,SV.SAVE5
  653E'   21 0E67        C      	LD	HL,UE.PUF+1
  6541'   34             C      	INC	(HL)	;NEXT RECORD+1
  6542'   21 0E69        C      	LD	HL,UE.PUF+3
  6545'   46             C      	LD	B,(HL)
  6546'   34             C      	INC	(HL)	;ANZ.VERZ.EINTR.+1
  6547'                  C      SV.SAVE6:
  6547'   CD 6B00'       C      	CALL	UR.KBR
  654A'   DD 36 04 08    C      	LD	(IX+4),08H	;NEUEN DS-SATZ AUSGEBEN
  654E'   CD 5675'       C      	CALL	UF.EXEC
  6551'                  C      SV.SAVE5:
  6551'   CD 7283'       C      	CALL	UK.KBW
  6554'   10 FB          C      	DJNZ	SV.SAVE5
  6556'   CD 6B00'       C      	CALL	UR.KBR
  6559'   2A 2B2E'       C      	LD	HL,(UB.PAR5)
  655C'   22 0E7F        C      	LD	(UE.PUF+25),HL	;DATEILAENGE EINTRAGEN
  655F'   DD 36 04 08    C      	LD	(IX+4),08H
  6563'   CD 5675'       C      	CALL	UF.EXEC
  6566'   CD 6AD2'       C      	CALL	UR.KRW
  6569'   CD 6ADC'       C      	CALL	UR.KRA
  656C'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  656D'                  C      SV.BYANZ:
  656D'   2A 2B2A'       C      	LD	HL,(UB.PAR3)	;Byteanzahl berechnen
  6570'   ED 5B 2B28'    C      	LD	DE,(UB.PAR2)
  6574'   B7             C      	OR	A
  6575'   ED 52          C      	SBC	HL,DE
  6577'   C9             C      	RET
  6578'                  C      SV.DATS1:
  6578'   21 0020        C      	LD	HL,32	;1. Dateisatz schreiben
  657B'   CD 6EF8'       C      	CALL	XY.STIDX
  657E'   09             C      	DB	9
  657F'   CD 6D4D'       C      	CALL	U1.VSX
  6582'   21 0E66        C      	LD	HL,UE.PUF
  6585'   3A 2B26'       C      	LD	A,(UB.PAR1)	;NEXT RECORD
  6588'   3C             C      	INC	A
  6589'   77             C      	LD	(HL),A
  658A'   DD 36 04 08    C      	LD	(IX+4),08H
  658E'   CD 5675'       C      	CALL	UF.EXEC
  6591'   C9             C      	RET
  6592'                  C      SV.SAVE:
  6592'   21 0000        C      	LD	HL,0
  6595'   CD 6EE8'       C      	CALL	XY.STDX
  6598'   11             C      	DB	17
  6599'   21 0080        C      	LD	HL,80H	;Blocklaenge
  659C'   CD 6EF8'       C      	CALL	XY.STIDX
  659F'   09             C      	DB	9
  65A0'   CD 72EC'       C      	CALL	UK.KSPFB	;Pufferbereitstellung
  65A3'                  C      SV.SAVE1:
  65A3'   CD 656D'       C      	CALL	SV.BYANZ	;Byteanzahl berechnen
  65A6'   23             C      	INC	HL
  65A7'   E5             C      	PUSH	HL
  65A8'   7C             C      	LD	A,H
  65A9'   B5             C      	OR	L
  65AA'   E1             C      	POP	HL
'Retten von Maschinencodeprogrammen als MRES - P-Datei'	MACRO-80 3.44	09-Dec-81	PAGE	1-46


  65AB'   28 13          C      	JR	Z,SV.SVLS2	;---> 0 Byte
  65AD'   01 007D        C      	LD	BC,UE.SVL	;Satzlaenge
  65B0'   B7             C      	OR	A
  65B1'   ED 42          C      	SBC	HL,BC
  65B3'   38 05          C      	JR	C,SV.SVLS	;---> letzter Satz
  65B5'   CD 6609'       C      	CALL	SV.SVSZ
  65B8'   18 E9          C      	JR	SV.SAVE1
  65BA'                  C      SV.SVLS:
  65BA'   7D             C      	LD	A,L
  65BB'   C6 7D          C      	ADD	A,UE.SVL	;A:= Laenge des letzten Satzes
  65BD'   CD 660B'       C      	CALL	SV.SVSZ2
  65C0'                  C      SV.SVLS2:
  65C0'   AF             C      	XOR	A
  65C1'   CD 72C8'       C      	CALL	UK.PUTK
  65C4'   21 58E2'       C      	LD	HL,UA.STADR	;Startadresse
  65C7'   CD 6B72'       C      	CALL	UR.MIMO
  65CA'   7E             C      	LD	A,(HL)
  65CB'   FE 20          C      	CP	' '
  65CD'   28 27          C      	JR	Z,SV.STAD0	;KEINE EINGABE (0000)
  65CF'   EB             C      	EX	DE,HL
  65D0'   21 2B2C'       C      	LD	HL,UB.PAR4
  65D3'   CD 6FCC'       C      	CALL	UC.CVXA
  65D6'                  C      SV.SVLS1:
  65D6'   2A 2B2C'       C      	LD	HL,(UB.PAR4)
  65D9'   7C             C      	LD	A,H	;Startadresse ausgeben
  65DA'   CD 72C8'       C      	CALL	UK.PUTK
  65DD'   7D             C      	LD	A,L
  65DE'   CD 72C8'       C      	CALL	UK.PUTK
  65E1'   0E 03          C      	LD	C,3
  65E3'                  C      SV.SVEN2:
  65E3'   06 80          C      	LD	B,80H
  65E5'   AF             C      	XOR	A
  65E6'                  C      SV.SVEN1:
  65E6'   CD 72C8'       C      	CALL	UK.PUTK
  65E9'   10 FB          C      	DJNZ	SV.SVEN1
  65EB'   0D             C      	DEC	C
  65EC'   20 F5          C      	JR	NZ,SV.SVEN2
  65EE'   CD 6EC8'       C      	CALL	XY.LDDX
  65F1'   11             C      	DB	17
  65F2'   22 2B2E'       C      	LD	(UB.PAR5),HL
  65F5'   C9             C      	RET
  65F6'                  C      SV.STAD0:
  65F6'   21 0000        C      	LD	HL,0
  65F9'   22 2B2C'       C      	LD	(UB.PAR4),HL
  65FC'   18 D8          C      	JR	SV.SVLS1
  65FE'                  C      SV.DALO1:
  65FE'   F5             C      	PUSH	AF
  65FF'   21 2B26'       C      	LD	HL,UB.PAR1
  6602'   35             C      	DEC	(HL)
  6603'   23             C      	INC	HL
  6604'   3E 4C          C      	LD	A,'L'
  6606'   77             C      	LD	(HL),A
  6607'   F1             C      	POP	AF
  6608'   C9             C      	RET
  6609'                  C      SV.SVSZ:
  6609'   3E 7D          C      	LD	A,UE.SVL
  660B'                  C      SV.SVSZ2:
  660B'   F5             C      	PUSH	AF
  660C'   CD 72C8'       C      	CALL	UK.PUTK
  660F'   ED 5B 2B28'    C      	LD	DE,(UB.PAR2)
  6613'   7A             C      	LD	A,D
  6614'   CD 72C8'       C      	CALL	UK.PUTK
  6617'   7B             C      	LD	A,E
  6618'   CD 72C8'       C      	CALL	UK.PUTK
  661B'   F1             C      	POP	AF
  661C'   47             C      	LD	B,A
  661D'                  C      SV.SVSZ1:
  661D'   1A             C      	LD	A,(DE)
  661E'   CD 72C8'       C      	CALL	UK.PUTK
  6621'   13             C      	INC	DE
  6622'   10 F9          C      	DJNZ	SV.SVSZ1
  6624'   ED 53 2B28'    C      	LD	(UB.PAR2),DE
  6628'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                                ;
                                ;	INCLUDE	KX.MAC	;Kopieren von MRES-Kassetten Teil 1
                                ;	INCLUDE	KY.MAC	;Kopieren von MRES-Kassetten Teil 2
                                ;	INCLUDE	KU.MAC	;Unterprogramme fuer KOPI
                         C      	INCLUDE K6.MAC	;Kopieren MRES
                         C      	TITLE	'Kopieren von MRES-Kassetten Teil 1'
                         C      	PAGE
'Kopieren von MRES-Kassetten Teil 1'	MACRO-80 3.44	09-Dec-81	PAGE	1-47


                         C      
                         C      ;	PN	KX
                         C      ;------------------------------------------------------------------
                         C      ;
                         C      ;          KOPIEREN VON MRES-KASSETTEN       TEIL1
                         C      ;
                         C      ;----------------------------------------------------------------
  6629'   6629'          C      	DW	$
  662B'   4B 4F 50 49    C      	DB	'KOPI'
  662F'   CD 6DA9'       C      	CALL	U1.KTINI
  6632'   11 E000        C      	LD	DE,BC.TAB1
  6635'   21 3327        C      	LD	HL,UE.BWSA+327H
  6638'   7E             C      	LD	A,(HL)
  6639'   CD 6E8C'       C      	CALL	U1.TST
  663C'   D8             C      	RET	C
  663D'   12             C      	LD	(DE),A
  663E'   23             C      	INC	HL
  663F'   EE 33          C      	XOR	33H
  6641'   BE             C      	CP	(HL)
  6642'   C0             C      	RET	NZ
  6643'   EE 30          C      	XOR	30H
  6645'   13             C      	INC	DE
  6646'   12             C      	LD	(DE),A
  6647'   3A 3326        C      	LD	A,(UE.BWSA+326H)
  664A'   FE 4A          C      	CP	'J'
  664C'   28 05          C      	JR	Z,$+7	;BEI KOPIJ WERDEN WEITERE PARAMETER
  664E'   23             C      	INC	HL	;IGNORIERT
  664F'   23             C      	INC	HL
  6650'   7E             C      	LD	A,(HL)
  6651'   FE 20          C      	CP	20H
  6653'   F5             C      	PUSH	AF
  6654'   20 0C          C      	JR	NZ,$+14
  6656'   CD 6D34'       C      	CALL	U1.EIN
  6659'   CD 6EAD'       C      	CALL	U1.KRWE
  665C'   CD 6D3D'       C      	CALL	U1.AUS
  665F'   CD 6EAD'       C      	CALL	U1.KRWE
  6662'   CD 679D'       C      	CALL	KX.UPA
  6665'   F1             C      	POP	AF
  6666'   28 13          C      	JR	Z,$+21
  6668'   FE 41          C      	CP	'A'
  666A'   28 0A          C      	JR	Z,$+12
  666C'   FE 4C          C      	CP	'L'
  666E'   20 0B          C      	JR	NZ,$+13
  6670'   CD 6D0B'       C      	CALL	U1.COPB
  6673'   C3 6743'       C      	JP	KX.RSPFR
  6676'   CD 6D07'       C      	CALL	U1.COPB2
  6679'   18 FB          C      	JR	$-3
                         C      ;-------------------------------------------------------------------
  667B'   CD 6D34'       C      	CALL	U1.EIN
  667E'   CD 6D5D'       C      	CALL	U1.DSVG
  6681'   CD 6CE6'       C      	CALL	U1.KBR4
  6684'   CD 6CF1'       C      	CALL	U1.BREAD
  6687'   21 57A8'       C      	LD	HL,UA.Z7E
  668A'   11 3163        C      	LD	DE,3163H	;??? BWSA
  668D'   01 001F        C      	LD	BC,31
  6690'   ED B0          C      	LDIR
  6692'   21 57C7'       C      	LD	HL,UA.GER
  6695'   11 31EA        C      	LD	DE,31EAH	;??? BWSA
  6698'   CD 6E72'       C      	CALL	U1.INFO
  669B'   21 5772'       C      	LD	HL,UA.KNAME+3
  669E'   11 323A        C      	LD	DE,323AH	;??? BWSA
  66A1'   CD 6E72'       C      	CALL	U1.INFO
  66A4'   21 5785'       C      	LD	HL,UA.NR+3
  66A7'   11 328A        C      	LD	DE,328AH	;??? BWSA
  66AA'   CD 6E72'       C      	CALL	U1.INFO
  66AD'   21 5798'       C      	LD	HL,UA.KOMMT+3
  66B0'   11 32DA        C      	LD	DE,32DAH	;??? BWSA
  66B3'   CD 6E72'       C      	CALL	U1.INFO
  66B6'   11 3203        C      	LD	DE,3203H	;??? BWSA
  66B9'   3A E000        C      	LD	A,(BC.TAB1)
  66BC'   CD 6F6C'       C      	CALL	UC.CVBX+2
  66BF'   11 321B        C      	LD	DE,321BH	;??? BWSA
  66C2'   3A E001        C      	LD	A,(BC.TAB1+1)
  66C5'   CD 6F6C'       C      	CALL	UC.CVBX+2
  66C8'   21 0E6A        C      	LD	HL,UE.PUF+4
  66CB'   11 3253        C      	LD	DE,3253H	;??? BWSA
  66CE'   06 06          C      	LD	B,6
  66D0'   CD 7077'       C      	CALL	UC.DKONV
  66D3'   21 0E8B        C      	LD	HL,UE.PUF+37
  66D6'   11 32A3        C      	LD	DE,32A3H	;??? BWSA
  66D9'   06 03          C      	LD	B,3
  66DB'   CD 7077'       C      	CALL	UC.DKONV
'Kopieren von MRES-Kassetten Teil 1'	MACRO-80 3.44	09-Dec-81	PAGE	1-48


  66DE'   11 32F3        C      	LD	DE,32F3H	;??? BWSA
  66E1'   06 0B          C      	LD	B,11
  66E3'   CD 7077'       C      	CALL	UC.DKONV
  66E6'   CD 6AFA'       C      	CALL	UR.KBV
  66E9'   CD 6AFA'       C      	CALL	UR.KBV
  66EC'   CD 6CF1'       C      	CALL	U1.BREAD
  66EF'   3A 0E69        C      	LD	A,(UE.PUF+3)
  66F2'   3D             C      	DEC	A
  66F3'   CA 674E'       C      	JP	Z,KX.ENDR
  66F6'   CD 6DDF'       C      	CALL	U1.VERIN
  66F9'   CD 6D3D'       C      	CALL	U1.AUS
  66FC'   CD 6D5D'       C      	CALL	U1.DSVG
  66FF'   CD 6CE6'       C      	CALL	U1.KBR4
  6702'   DD 36 04 02    C      	LD	(IX+4),02H
  6706'   CD 5675'       C      	CALL	UF.EXEC
  6709'   21 0E6A        C      	LD	HL,UE.PUF+4
  670C'   11 326B        C      	LD	DE,326BH	;??? BWSA
  670F'   06 06          C      	LD	B,6
  6711'   CD 7077'       C      	CALL	UC.DKONV
  6714'   21 0E8B        C      	LD	HL,UE.PUF+37
  6717'   11 32BB        C      	LD	DE,32BBH	;??? BWSA
  671A'   06 03          C      	LD	B,3
  671C'   CD 7077'       C      	CALL	UC.DKONV
  671F'   11 330B        C      	LD	DE,330BH	;??? BWSA
  6722'   06 0B          C      	LD	B,11
  6724'   CD 7077'       C      	CALL	UC.DKONV
  6727'   CD 6AFA'       C      	CALL	UR.KBV
  672A'   CD 6AFA'       C      	CALL	UR.KBV
  672D'   DD 36 04 02    C      	LD	(IX+4),02H
  6731'   CD 5675'       C      	CALL	UF.EXEC
  6734'   CD 6E78'       C      	CALL	U1.BILO
  6737'   11 E002        C      	LD	DE,BC.VTABA
  673A'   CD 6DE7'       C      	CALL	U1.VERNI
  673D'   CD 6E01'       C      	CALL	U1.VORST
  6740'   C3 67BA'       C      	JP	KY.MD
  6743'                  C      KX.RSPFR:
  6743'   F5             C      	PUSH	AF
  6744'   23             C      	INC	HL
  6745'   23             C      	INC	HL
  6746'   7E             C      	LD	A,(HL)
  6747'   B7             C      	OR	A
  6748'   FE 52          C      	CP	'R'
  674A'   20 06          C      	JR	NZ,$+8
  674C'   18 01          C      	JR	$+3
  674E'                  C      KX.ENDR:
  674E'   F5             C      	PUSH	AF
  674F'   37             C      	SCF
  6750'   18 04          C      	JR	$+6
  6752'   FE 46          C      	CP	'F'
  6754'   20 15          C      	JR	NZ,$+23
  6756'   CD 6D34'       C      	CALL	U1.EIN
  6759'   DC 6AD2'       C      	CALL	C,UR.KRW
  675C'   CD 6ADC'       C      	CALL	UR.KRA
  675F'   CD 6D3D'       C      	CALL	U1.AUS
  6762'   CD 6ACA'       C      	CALL	UR.KRE
  6765'   DC 6AD8'       C      	CALL	C,UR.KRWW
  6768'   CD 6ADC'       C      	CALL	UR.KRA
  676B'   F1             C      	POP	AF
  676C'   C9             C      	RET
  676D'                  C      KX.EXEC2:
  676D'   F5             C      	PUSH	AF
  676E'   DD CB 00 BE    C      	RES	7,(IX+0)
  6772'   DD 36 01 00    C      	LD	(IX+1),0
  6776'   CD 55E2'       C      	CALL	KR.KARO
  6779'   DD CB 00 7E    C      	BIT	7,(IX+0)
  677D'   28 0A          C      	JR	Z,$+12
  677F'   DD 7E 01       C      	LD	A,(IX+1)
  6782'   FE 14          C      	CP	14H
  6784'   28 05          C      	JR	Z,$+7
  6786'   CD 56A5'       C      	CALL	UF.ERANZ
  6789'   F1             C      	POP	AF
  678A'   C9             C      	RET
  678B'   DD CB 00 BE    C      	RES	7,(IX)
  678F'   CD 6D3D'       C      	CALL	U1.AUS
  6792'   CD 6AF4'       C      	CALL	UR.KSL
  6795'   F1             C      	POP	AF
  6796'   06 06          C      	LD	B,6
  6798'   33             C      	INC	SP
  6799'   10 FD          C      	DJNZ	$-1	;STACK BERICHTIGEN
  679B'   18 A6          C      	JR	KX.RSPFR
  679D'                  C      KX.UPA:
  679D'   CD 6D34'       C      	CALL	U1.EIN
  67A0'   CD 6ACA'       C      	CALL	UR.KRE
'Kopieren von MRES-Kassetten Teil 1'	MACRO-80 3.44	09-Dec-81	PAGE	1-49


  67A3'   DD 36 00 00    C      	LD	(IX+0),0
  67A7'   CD 6D3D'       C      	CALL	U1.AUS
  67AA'   CD 6ACA'       C      	CALL	UR.KRE
  67AD'   DD CB 00 56    C      	BIT	2,(IX+0)
  67B1'   28 05          C      	JR	Z,$+7
  67B3'   D1             C      	POP	DE
  67B4'   3E 19          C      	LD	A,19H
  67B6'   CD 56A5'       C      	CALL	UF.ERANZ
  67B9'   C9             C      	RET
                         C      ;	END
                         C      	TITLE	'Kopieren von MRES-Kassetten Teil 2'
                         C      	PAGE
'Kopieren von MRES-Kassetten Teil 2'	MACRO-80 3.44	09-Dec-81	PAGE	1-50


                         C      
                         C      ;	PN	KY
                         C      ;---------------------------------------------------------------------
                         C      ;
                         C      ;          KOPIEREN VON MRES-KASSETTEN           TEIL 2
                         C      ;
                         C      ;--------------------------------------------------------------------
  67BA'                  C      KY.MD:
  67BA'   CD 6E78'       C      	CALL	U1.BILO
  67BD'   21 57D6'       C      	LD	HL,UA.KOPFR
  67C0'   CD 6A13'       C      	CALL	KY.SATR
  67C3'   3E 0D          C      	LD	A,13
  67C5'   32 2B00'       C      	LD	(UB.ZN),A
  67C8'   21 ECA2        C      	LD	HL,BC.VTABE+32
  67CB'   FD 21 F902     C      	LD	IY,BC.TAB2
  67CF'   FD 36 00 FF    C      	LD	(IY+0),0FFH
  67D3'   3A EC85        C      	LD	A,(BC.VTABE+3)
  67D6'   47             C      	LD	B,A
  67D7'   05             C      	DEC	B
                         C      ;--------------------------------ABFRAGEZYKLUS------------------------
  67D8'                  C      KY.DFR:
  67D8'   C5             C      	PUSH	BC
  67D9'   11 2B4E'       C      	LD	DE,UB.SATZ+26
  67DC'   01 0006        C      	LD	BC,6
  67DF'   ED B0          C      	LDIR
  67E1'   13             C      	INC	DE
  67E2'   13             C      	INC	DE
  67E3'   01 0002        C      	LD	BC,2
  67E6'   ED B0          C      	LDIR
  67E8'   01 0018        C      	LD	BC,24
  67EB'   09             C      	ADD	HL,BC
  67EC'   E5             C      	PUSH	HL
  67ED'   21 2B34'       C      	LD	HL,UB.SATZ
  67F0'   CD 6B72'       C      	CALL	UR.MIMO
  67F3'   DC 6A6F'       C      	CALL	C,KU.ZEIR
  67F6'   CD 6A0A'       C      	CALL	KY.JHL	;BEI KOPIJ WIRD J GESETZT
  67F9'   7E             C      	LD	A,(HL)
  67FA'   FE 4A          C      	CP	'J'
  67FC'   C4 6A37'       C      	CALL	NZ,KU.TAB2L
  67FF'   E1             C      	POP	HL
  6800'   01 0009        C      	LD	BC,9
  6803'   B7             C      	OR	A
  6804'   ED 42          C      	SBC	HL,BC
  6806'   7E             C      	LD	A,(HL)
  6807'   FD 77 00       C      	LD	(IY+0),A
  680A'   FD 23          C      	INC	IY
  680C'   FD 36 00 FF    C      	LD	(IY+0),0FFH
  6810'   09             C      	ADD	HL,BC
  6811'   3A E005        C      	LD	A,(BC.VTABA+3)
  6814'   FE 01          C      	CP	01H
  6816'   28 2E          C      	JR	Z,KY.EZYK1
  6818'   E5             C      	PUSH	HL
  6819'   01 0020        C      	LD	BC,32
  681C'   B7             C      	OR	A
  681D'   ED 42          C      	SBC	HL,BC
  681F'   EB             C      	EX	DE,HL
  6820'   E1             C      	POP	HL
  6821'   DD 21 E002     C      	LD	IX,BC.VTABA
  6825'   47             C      	LD	B,A
  6826'   05             C      	DEC	B
  6827'                  C      KY.VZVGL:
  6827'   C5             C      	PUSH	BC
  6828'   01 0020        C      	LD	BC,32
  682B'   DD 09          C      	ADD	IX,BC
  682D'   DD E5          C      	PUSH	IX
  682F'   06 07          C      	LD	B,7
  6831'   D5             C      	PUSH	DE
  6832'                  C      KY.SVGL:
  6832'   1A             C      	LD	A,(DE)
  6833'   DD BE 00       C      	CP	(IX+0)
  6836'   20 08          C      	JR	NZ,KY.NDA
  6838'   DD 23          C      	INC	IX
  683A'   13             C      	INC	DE
  683B'   10 F5          C      	DJNZ	KY.SVGL
  683D'   CD 6A9F'       C      	CALL	KU.DD	;DATEI SCHON VORHANDEN
  6840'                  C      KY.NDA:
  6840'   D1             C      	POP	DE
  6841'   DD E1          C      	POP	IX
  6843'   C1             C      	POP	BC
  6844'   10 E1          C      	DJNZ	KY.VZVGL
  6846'                  C      KY.EZYK1:
  6846'   C1             C      	POP	BC
'Kopieren von MRES-Kassetten Teil 2'	MACRO-80 3.44	09-Dec-81	PAGE	1-51


  6847'   10 8F          C      	DJNZ	KY.DFR
                         C      ;---------------------------------------------------------------------
  6849'                  C      KY.ATAA:
  6849'   06 03          C      	LD	B,3	;WARTESCHLEIFE FUER
  684B'   21 FFFF        C      	LD	HL,0FFFFH
  684E'   2B             C      	DEC	HL
  684F'   7C             C      	LD	A,H
  6850'   B5             C      	OR	L
  6851'   20 FB          C      	JR	NZ,$-3
  6853'   10 F6          C      	DJNZ	$-8
  6855'   21 580C'       C      	LD	HL,UA.EABFR
  6858'   CD 6A13'       C      	CALL	KY.SATR
  685B'   21 2B34'       C      	LD	HL,UB.SATZ
  685E'   CD 6B72'       C      	CALL	UR.MIMO
  6861'   38 F8          C      	JR	C,$-6
  6863'   CD 6A0A'       C      	CALL	KY.JHL
  6866'   7E             C      	LD	A,(HL)
  6867'   FE 4A          C      	CP	'J'
  6869'   C2 67BA'       C      	JP	NZ,KY.MD
                         C      ;--------------------------------Labelnummern fuer Ausgabe ---------
  686C'                  C      KY.ATAB:
  686C'   06 00          C      	LD	B,0
  686E'   21 F902        C      	LD	HL,BC.TAB2
  6871'   11 F9D2        C      	LD	DE,BC.TAB3
  6874'   7E             C      	LD	A,(HL)
  6875'   FE FF          C      	CP	0FFH	;KEINE DATEI KOPIEREN
  6877'   CA 674E'       C      	JP	Z,KX.ENDR
  687A'   3A E003        C      	LD	A,(BC.VTABA+1)
  687D'                  C      KY.ATABE:
  687D'   12             C      	LD	(DE),A
  687E'   23             C      	INC	HL
  687F'   13             C      	INC	DE
  6880'   04             C      	INC	B
  6881'   F5             C      	PUSH	AF
  6882'   7E             C      	LD	A,(HL)
  6883'   FE FF          C      	CP	0FFH
  6885'   28 04          C      	JR	Z,KY.WEI
  6887'   F1             C      	POP	AF
  6888'   3C             C      	INC	A
  6889'   18 F2          C      	JR	KY.ATABE
                         C      ;------------------------------TAB:NR DER VERZ.EINTRAGUNGEN (EING.)------
  688B'                  C      KY.WEI:
  688B'   F1             C      	POP	AF
  688C'   C5             C      	PUSH	BC
  688D'   AF             C      	XOR	A
  688E'   57             C      	LD	D,A
  688F'   3A EC85        C      	LD	A,(BC.VTABE+3)
  6892'   47             C      	LD	B,A
  6893'   05             C      	DEC	B
  6894'   21 F902        C      	LD	HL,BC.TAB2
  6897'   FD 21 F96A     C      	LD	IY,BC.TAB2A
  689B'   DD 21 ECA2     C      	LD	IX,BC.VTABE+32	;???
  689F'                  C      KY.ZYK:
  689F'   14             C      	INC	D
  68A0'   7E             C      	LD	A,(HL)
  68A1'   DD BE 17       C      	CP	(IX+23)
  68A4'   20 0B          C      	JR	NZ,KY.NE
  68A6'   7A             C      	LD	A,D
  68A7'   FD 77 00       C      	LD	(IY+0),A
  68AA'   FD 36 01 FF    C      	LD	(IY+1),0FFH
  68AE'   23             C      	INC	HL
  68AF'   FD 23          C      	INC	IY
  68B1'                  C      KY.NE:
  68B1'   C5             C      	PUSH	BC
  68B2'   01 0020        C      	LD	BC,32
  68B5'   DD 09          C      	ADD	IX,BC
  68B7'   C1             C      	POP	BC
  68B8'   10 E5          C      	DJNZ	KY.ZYK
                         C      ;------------------------------------AUFBAU AUSGABEVERZ.-----
  68BA'   3A E005        C      	LD	A,(BC.VTABA+3)
  68BD'   47             C      	LD	B,A
  68BE'   FE 01          C      	CP	01H
  68C0'   28 08          C      	JR	Z,KY.EVZ
  68C2'   21 E002        C      	LD	HL,BC.VTABA
  68C5'   CD 6A2E'       C      	CALL	KU.VVOR
  68C8'   18 03          C      	JR	KY.EVZ1
  68CA'                  C      KY.EVZ:
  68CA'   21 E022        C      	LD	HL,BC.VTABA+32
  68CD'                  C      KY.EVZ1:
  68CD'   DD 21 F96A     C      	LD	IX,BC.TAB2A
  68D1'   FD 21 F9D2     C      	LD	IY,BC.TAB3
  68D5'   EB             C      	EX	DE,HL
  68D6'   21 ECA2        C      	LD	HL,BC.VTABE+32
'Kopieren von MRES-Kassetten Teil 2'	MACRO-80 3.44	09-Dec-81	PAGE	1-52


  68D9'   DD 7E 00       C      	LD	A,(IX+0)
  68DC'   FE 01          C      	CP	01H
  68DE'   28 05          C      	JR	Z,KY.VSTR
  68E0'   3D             C      	DEC	A
  68E1'   47             C      	LD	B,A
  68E2'   CD 6A2E'       C      	CALL	KU.VVOR
  68E5'                  C      KY.VSTR:
  68E5'   01 0020        C      	LD	BC,32
  68E8'   ED B0          C      	LDIR
  68EA'   FD 7E 00       C      	LD	A,(IY+0)
  68ED'   EB             C      	EX	DE,HL
  68EE'   01 0009        C      	LD	BC,9
  68F1'   B7             C      	OR	A
  68F2'   ED 42          C      	SBC	HL,BC
  68F4'   77             C      	LD	(HL),A
  68F5'   09             C      	ADD	HL,BC
  68F6'   EB             C      	EX	DE,HL
  68F7'   DD 7E 01       C      	LD	A,(IX+1)
  68FA'   FE FF          C      	CP	0FFH
  68FC'   28 10          C      	JR	Z,KY.COPY
  68FE'   DD 96 00       C      	SUB	(IX+0)
  6901'   3D             C      	DEC	A
  6902'   47             C      	LD	B,A
  6903'   FE 00          C      	CP	00H
  6905'   C4 6A2E'       C      	CALL	NZ,KU.VVOR
  6908'   FD 23          C      	INC	IY
  690A'   DD 23          C      	INC	IX
  690C'   18 D7          C      	JR	KY.VSTR
                         C      ;------------------------------------VERZ.SCHREIBEN (NUR NEUE SAETZE)---
  690E'                  C      KY.COPY:
  690E'   DD 21 2B03'    C      	LD	IX,UB.KTAB
  6912'   CD 6DC2'       C      	CALL	U1.KTIN1
  6915'   DD 36 0A 20    C      	LD	(IX+10),20H	;???
  6919'   CD 6D3D'       C      	CALL	U1.AUS
  691C'   3A E005        C      	LD	A,(BC.VTABA+3)
  691F'   47             C      	LD	B,A
  6920'   CD 6AFA'       C      	CALL	UR.KBV	;AUSGABEKASSETTE
  6923'   3D             C      	DEC	A
  6924'   20 FA          C      	JR	NZ,$-4	;VORSTELLEN BIS HINTER LETZTEN ALTEN
  6926'   21 E002        C      	LD	HL,BC.VTABA	;VERZ.SATZ
  6929'   11 0020        C      	LD	DE,32
  692C'   19             C      	ADD	HL,DE
  692D'   10 FA          C      	DJNZ	$-4	;AUSGABEVERZ.ZEIGER
  692F'   C1             C      	POP	BC
  6930'   78             C      	LD	A,B
  6931'   F5             C      	PUSH	AF
  6932'                  C      KY.VSCHR:
  6932'   11 0E66        C      	LD	DE,UE.PUF
  6935'   01 0020        C      	LD	BC,32
  6938'   ED B0          C      	LDIR
  693A'   CD 6AFA'       C      	CALL	UR.KBV
  693D'   CD 6B00'       C      	CALL	UR.KBR
  6940'   DD 36 04 08    C      	LD	(IX+4),08H
  6944'   CD 5675'       C      	CALL	UF.EXEC
  6947'   3D             C      	DEC	A
  6948'   20 E8          C      	JR	NZ,KY.VSCHR
                         C      ;----------------------------------------------------------------
  694A'   11 33FA        C      	LD	DE,33FAH	;''ES WIRD KOPIERT'' ;???
  694D'   21 69FA'       C      	LD	HL,KY.EWK
  6950'   01 0010        C      	LD	BC,16
  6953'   ED B0          C      	LDIR
                         C      ;------------------------------KOPIEREN--------------------------
  6955'   21 F902        C      	LD	HL,BC.TAB2
  6958'   11 F9D2        C      	LD	DE,BC.TAB3
  695B'   FD 21 F96A     C      	LD	IY,BC.TAB2A
  695F'   1A             C      	LD	A,(DE)
  6960'   47             C      	LD	B,A
  6961'   04             C      	INC	B
  6962'   CD 6B0F'       C      	CALL	UR.POSIK
  6965'   7E             C      	LD	A,(HL)
  6966'   47             C      	LD	B,A
  6967'   04             C      	INC	B
  6968'                  C      KY.KOPV:
  6968'   CD 6D34'       C      	CALL	U1.EIN
  696B'   CD 6B0F'       C      	CALL	UR.POSIK
  696E'                  C      KY.KOP:
  696E'   CD 6CF1'       C      	CALL	U1.BREAD
  6971'   7E             C      	LD	A,(HL)
  6972'   FE 01          C      	CP	01H
  6974'   CC 6D4D'       C      	CALL	Z,U1.VSX
                         C      ;------------------------ANZEIGE WELCHE DATEI KOPIERT WIRD-------------
  6977'   E5             C      	PUSH	HL
  6978'   D5             C      	PUSH	DE
'Kopieren von MRES-Kassetten Teil 2'	MACRO-80 3.44	09-Dec-81	PAGE	1-53


  6979'   FD 7E 00       C      	LD	A,(IY+0)
  697C'   47             C      	LD	B,A
  697D'   05             C      	DEC	B
  697E'   21 ECA2        C      	LD	HL,BC.VTABE+32
  6981'   FE 01          C      	CP	01H
  6983'   28 03          C      	JR	Z,KY.KOPAN
  6985'   CD 6A2E'       C      	CALL	KU.VVOR
  6988'                  C      KY.KOPAN:
  6988'   11 34F0        C      	LD	DE,34F0H	;???
  698B'   01 0006        C      	LD	BC,6
  698E'   ED B0          C      	LDIR
  6990'   13             C      	INC	DE
  6991'   13             C      	INC	DE
  6992'   01 0002        C      	LD	BC,2
  6995'   ED B0          C      	LDIR
  6997'   FD 23          C      	INC	IY
  6999'   D1             C      	POP	DE
  699A'   E1             C      	POP	HL
                         C      ;--------------------------------------------------------------------
  699B'   1A             C      	LD	A,(DE)
  699C'   FE 01          C      	CP	01H
  699E'   CC 6D46'       C      	CALL	Z,U1.VS1
  69A1'   32 0E66        C      	LD	(UE.PUF),A
  69A4'   CD 6CFC'       C      	CALL	U1.BWRIT
  69A7'   CD 6D0B'       C      	CALL	U1.COPB
  69AA'   23             C      	INC	HL
  69AB'   7E             C      	LD	A,(HL)
  69AC'   FE FF          C      	CP	0FFH
  69AE'   28 0B          C      	JR	Z,KY.EOV
  69B0'   2B             C      	DEC	HL
  69B1'   96             C      	SUB	(HL)
  69B2'   23             C      	INC	HL
  69B3'   13             C      	INC	DE
  69B4'   47             C      	LD	B,A
  69B5'   FE 01          C      	CP	01H
  69B7'   20 AF          C      	JR	NZ,KY.KOPV
  69B9'   18 B3          C      	JR	KY.KOP
                         C      ;-------------------------------------------------------------
  69BB'                  C      KY.EOV:
  69BB'   CD 6D4D'       C      	CALL	U1.VSX
  69BE'   3A E003        C      	LD	A,(BC.VTABA+1)
  69C1'   47             C      	LD	B,A
  69C2'   F1             C      	POP	AF
  69C3'   F5             C      	PUSH	AF
  69C4'   80             C      	ADD	A,B
  69C5'   32 0E66        C      	LD	(UE.PUF),A
  69C8'   CD 6DC2'       C      	CALL	U1.KTIN1
  69CB'   DD 36 0A 20    C      	LD	(IX+10),20H	;???
  69CF'   CD 6CFC'       C      	CALL	U1.BWRIT
  69D2'   CD 6AF4'       C      	CALL	UR.KSL
  69D5'   CD 674E'       C      	CALL	KX.ENDR
  69D8'   CD 6ACA'       C      	CALL	UR.KRE
  69DB'   CD 6D5D'       C      	CALL	U1.DSVG
  69DE'   F1             C      	POP	AF
  69DF'   F5             C      	PUSH	AF
  69E0'   81             C      	ADD	A,C	;NEXT RECORD UND
  69E1'   32 0E67        C      	LD	(UE.PUF+1),A
  69E4'   F1             C      	POP	AF
  69E5'   80             C      	ADD	A,B	;ANZAHL VERZ.EINTR. KORRIGIEREN
  69E6'   32 0E69        C      	LD	(UE.PUF+3),A
  69E9'   CD 6B00'       C      	CALL	UR.KBR
  69EC'   DD 36 04 08    C      	LD	(IX+4),08H
  69F0'   CD 5675'       C      	CALL	UF.EXEC	;NEUEN DS-SATZ SCHREIBEN
  69F3'   CD 6AD2'       C      	CALL	UR.KRW
  69F6'   CD 6ADC'       C      	CALL	UR.KRA
  69F9'   C9             C      	RET
                         C      ;---------------------------------------------------------------
  69FA'                  C      KY.EWK:
  69FA'   45 73 20 77    C      	DB	'Es wird kopiert:'
  69FE'   69 72 64 20    C      
  6A02'   6B 6F 70 69    C      
  6A06'   65 72 74 3A    C      
                         C      ;---------------------------------------------------------------
  6A0A'                  C      KY.JHL:
  6A0A'   3A 2B28'       C      	LD	A,(UB.PAR2)
  6A0D'   FE 4A          C      	CP	'J'
  6A0F'   20 01          C      	JR	NZ,$+3
  6A11'   77             C      	LD	(HL),A
  6A12'   C9             C      	RET
                         C      ;--------------------------------------------------------------
  6A13'                  C      KY.SATR:
  6A13'   11 2B34'       C      	LD	DE,UB.SATZ
  6A16'   01 0036        C      	LD	BC,54
'Kopieren von MRES-Kassetten Teil 2'	MACRO-80 3.44	09-Dec-81	PAGE	1-54


  6A19'   ED B0          C      	LDIR
  6A1B'   3A 3326        C      	LD	A,(UE.BWSA+326H)
  6A1E'   FE 4A          C      	CP	'J'
  6A20'   CC 6A27'       C      	CALL	Z,KY.AJ
  6A23'   32 2B28'       C      	LD	(UB.PAR2),A
  6A26'   C9             C      	RET
  6A27'                  C      KY.AJ:
  6A27'   F5             C      	PUSH	AF
  6A28'   AF             C      	XOR	A
  6A29'   32 2B34'       C      	LD	(UB.SATZ),A
  6A2C'   F1             C      	POP	AF
  6A2D'   C9             C      	RET
                         C      ;--------------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Unterprogramme fuer KOPI'
                         C      	PAGE
'Unterprogramme fuer KOPI'	MACRO-80 3.44	09-Dec-81	PAGE	1-55


                         C      
                         C      ;	PN	KU
                         C      ;------------------------------------------------------------------
                         C      ;
                         C      ;          UNTERPROGRAMME FUER KOPI
                         C      ;
                         C      ;--------------------------------------------------------
  6A2E'                  C      KU.VVOR:
  6A2E'   C5             C      	PUSH	BC
  6A2F'   01 0020        C      	LD	BC,32
  6A32'   09             C      	ADD	HL,BC
  6A33'   C1             C      	POP	BC
  6A34'   10 F8          C      	DJNZ	KU.VVOR
  6A36'   C9             C      	RET
  6A37'                  C      KU.TAB2L:
  6A37'   D1             C      	POP	DE
  6A38'   E1             C      	POP	HL
  6A39'   FD 7E 00       C      	LD	A,(IY+0)
  6A3C'   FE FF          C      	CP	0FFH
  6A3E'   28 22          C      	JR	Z,$+36
  6A40'   FD E5          C      	PUSH	IY
  6A42'   06 00          C      	LD	B,00H
  6A44'   FD 7E 00       C      	LD	A,(IY+0)
  6A47'   FE FF          C      	CP	0FFH
  6A49'   20 02          C      	JR	NZ,$+4
  6A4B'   18 05          C      	JR	$+7
  6A4D'   FD 23          C      	INC	IY
  6A4F'   04             C      	INC	B
  6A50'   18 F2          C      	JR	$-12
  6A52'   FD E1          C      	POP	IY
  6A54'   FD E5          C      	PUSH	IY
  6A56'   FD 7E 01       C      	LD	A,(IY+1)
  6A59'   FD 77 00       C      	LD	(IY+0),A
  6A5C'   FD 23          C      	INC	IY
  6A5E'   10 F6          C      	DJNZ	$-8
  6A60'   FD E1          C      	POP	IY
  6A62'   C1             C      	POP	BC
  6A63'   05             C      	DEC	B
  6A64'   78             C      	LD	A,B
  6A65'   FE 00          C      	CP	00H
  6A67'   28 03          C      	JR	Z,$+5
  6A69'   C3 67D8'       C      	JP	KY.DFR
  6A6C'   C3 6849'       C      	JP	KY.ATAA
  6A6F'                  C      KU.ZEIR:
  6A6F'   D1             C      	POP	DE
  6A70'   E1             C      	POP	HL
  6A71'   3A 2B00'       C      	LD	A,(UB.ZN)
  6A74'   D6 02          C      	SUB	2
  6A76'   FE 0D          C      	CP	13
  6A78'   30 04          C      	JR	NC,$+6
  6A7A'   C1             C      	POP	BC
  6A7B'   C3 67BA'       C      	JP	KY.MD
  6A7E'   32 2B00'       C      	LD	(UB.ZN),A
  6A81'   01 0029        C      	LD	BC,41
  6A84'   B7             C      	OR	A
  6A85'   ED 42          C      	SBC	HL,BC
  6A87'   FD 2B          C      	DEC	IY
  6A89'   7E             C      	LD	A,(HL)
  6A8A'   FD BE 00       C      	CP	(IY+0)
  6A8D'   CC 6A9C'       C      	CALL	Z,KU.DECIY
  6A90'   FD 23          C      	INC	IY
  6A92'   01 0017        C      	LD	BC,23
  6A95'   B7             C      	OR	A
  6A96'   ED 42          C      	SBC	HL,BC
  6A98'   C1             C      	POP	BC
  6A99'   04             C      	INC	B
  6A9A'   18 CA          C      	JR	$-52
  6A9C'                  C      KU.DECIY:
  6A9C'   FD 2B          C      	DEC	IY
  6A9E'   C9             C      	RET
  6A9F'                  C      KU.DD:
  6A9F'   E5             C      	PUSH	HL
  6AA0'   21 5842'       C      	LD	HL,UA.VORH
  6AA3'   CD 6B72'       C      	CALL	UR.MIMO
  6AA6'   38 17          C      	JR	C,$+25
  6AA8'   7E             C      	LD	A,(HL)
  6AA9'   FE 4A          C      	CP	'J'
  6AAB'   28 0C          C      	JR	Z,$+14
  6AAD'   FD 2B          C      	DEC	IY
  6AAF'   FD 36 00 FF    C      	LD	(IY+0),0FFH
  6AB3'   11 0050        C      	LD	DE,80
  6AB6'   B7             C      	OR	A
'Unterprogramme fuer KOPI'	MACRO-80 3.44	09-Dec-81	PAGE	1-56


  6AB7'   ED 52          C      	SBC	HL,DE
  6AB9'   36 20          C      	LD	(HL),20H
  6ABB'   21 2B00'       C      	LD	HL,UB.ZN
  6ABE'   35             C      	DEC	(HL)
  6ABF'   E1             C      	POP	HL
  6AC0'   C9             C      	RET
  6AC1'   E1             C      	POP	HL
  6AC2'   D1             C      	POP	DE
  6AC3'   DD 21 2B03'    C      	LD	IX,UB.KTAB
  6AC7'   C3 674E'       C      	JP	KX.ENDR
                         C      ;	END
                                ;
                         C      	INCLUDE K7.MAC	;Routinen fuer Kassette,Monitor UND Tastatur (UR.ASM)
                         C      	TITLE 'Routinen fuer Kassette,Monitor UND Tastatur'
                         C      	PAGE
'Routinen fuer Kassette,Monitor UND Tastatur'	MACRO-80 3.44	09-Dec-81	PAGE	1-57


                         C      
                         C      ;	PN	UR
                         C      ;	ORG	49A0H
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;   ROUTINEN FUER KASSETTE,MONITOR UND TASTATUR
                         C      ;
                         C      ;----------------------------------------------------------------------
                         C      ;   1.     KASSETTE
                         C      ;----------------------------------------------------------------------
  6ACA'                  C      UR.KRE:
  6ACA'   DD 36 04 31    C      	LD	(IX+4),31H
  6ACE'                  C      UR.KRE1:
  6ACE'   CD 5675'       C      	CALL	UF.EXEC
  6AD1'   C9             C      	RET
  6AD2'                  C      UR.KRW:
  6AD2'   DD 36 04 21    C      	LD	(IX+4),21H
  6AD6'   18 F6          C      	JR	UR.KRE1	;Umspulen
  6AD8'                  C      UR.KRWW:
  6AD8'   CD 6AD2'       C      	CALL	UR.KRW
  6ADB'   C9             C      	RET
  6ADC'                  C      UR.KRA:
  6ADC'   DD 36 04 41    C      	LD	(IX+4),41H
  6AE0'   18 EC          C      	JR	UR.KRE1	;Reservieren aus
  6AE2'                  C      UR.KLV:
  6AE2'   DD 36 04 71    C      	LD	(IX+4),71H
  6AE6'   18 E6          C      	JR	UR.KRE1	;Label vorsetzen
  6AE8'                  C      UR.KLR:
  6AE8'   DD 36 04 75    C      	LD	(IX+4),75H
  6AEC'   18 E0          C      	JR	UR.KRE1	;LABEL RUECKSETZEN
  6AEE'                  C      UR.KBM:
  6AEE'   DD 36 04 51    C      	LD	(IX+4),51H
  6AF2'   18 DA          C      	JR	UR.KRE1	;BANDMARKE SCHREIBEN
  6AF4'                  C      UR.KSL:
  6AF4'   DD 36 04 61    C      	LD	(IX+4),61H
  6AF8'   18 D4          C      	JR	UR.KRE1	;SCHLUSSLUECKE SCHREIBEN
  6AFA'                  C      UR.KBV:
  6AFA'   DD 36 04 11    C      	LD	(IX+4),11H
  6AFE'   18 CE          C      	JR	UR.KRE1	;Block vorsetzen
  6B00'                  C      UR.KBR:
  6B00'   DD 36 04 15    C      	LD	(IX+4),15H
  6B04'   18 C8          C      	JR	UR.KRE1
                         C      ;--------------------------------------------------------------------
  6B06'                  C      UR.RPOS:
  6B06'   E5             C      	PUSH	HL
  6B07'   D5             C      	PUSH	DE
  6B08'   F5             C      	PUSH	AF
  6B09'   C5             C      	PUSH	BC
  6B0A'   AF             C      	XOR	A
  6B0B'   3D             C      	DEC	A
  6B0C'   4F             C      	LD	C,A
  6B0D'   18 06          C      	JR	POSIK1
  6B0F'                  C      UR.POSIK:
  6B0F'   E5             C      	PUSH	HL
  6B10'   D5             C      	PUSH	DE
  6B11'   F5             C      	PUSH	AF
  6B12'   C5             C      	PUSH	BC	;Positionieren
  6B13'   AF             C      	XOR	A
  6B14'   4F             C      	LD	C,A
  6B15'                  C      POSIK1:
  6B15'   06 00          C      	LD	B,0
  6B17'   11 0000        C      	LD	DE,0
  6B1A'                  C      UR.LES:
  6B1A'   DD 36 04 02    C      	LD	(IX+4),02H
  6B1E'   CD 5675'       C      	CALL	UF.EXEC	;BLOCK LESEN
  6B21'   DD 7E 0A       C      	LD	A,(IX+10)
  6B24'   FE 01          C      	CP	1	;BANDMARKE?
  6B26'   28 19          C      	JR	Z,UR.BM
  6B28'   04             C      	INC	B	;ANZAHL BLOECKE
  6B29'   78             C      	LD	A,B
  6B2A'   FE 04          C      	CP	4
  6B2C'   28 21          C      	JR	Z,UR.OK
  6B2E'   21 0000        C      	LD	HL,0
  6B31'   CD 6ED8'       C      	CALL	XY.LIDX
  6B34'   09             C      	DB	9	;HL<--BLOCKLAENGE
  6B35'   19             C      	ADD	HL,DE
  6B36'   EB             C      	EX	DE,HL
  6B37'   21 012C        C      	LD	HL,300
  6B3A'   B7             C      	OR	A
  6B3B'   ED 52          C      	SBC	HL,DE
  6B3D'   38 10          C      	JR	C,UR.OK
  6B3F'   18 D9          C      	JR	UR.LES
'Routinen fuer Kassette,Monitor UND Tastatur'	MACRO-80 3.44	09-Dec-81	PAGE	1-58


  6B41'                  C      UR.BM:
  6B41'   AF             C      	XOR	A
  6B42'   B1             C      	OR	C
  6B43'   28 04          C      	JR	Z,$+6
  6B45'   C1             C      	POP	BC
  6B46'   04             C      	INC	B
  6B47'   18 C9          C      	JR	UR.POSIK+3
  6B49'   C1             C      	POP	BC
  6B4A'   05             C      	DEC	B
  6B4B'   28 21          C      	JR	Z,UR.RSP
  6B4D'   18 C3          C      	JR	UR.POSIK+3
  6B4F'                  C      UR.OK:
  6B4F'   AF             C      	XOR	A
  6B50'   B1             C      	OR	C
  6B51'   28 08          C      	JR	Z,$+10
  6B53'   DD 70 0A       C      	LD	(IX+10),B
  6B56'   CD 6AE8'       C      	CALL	UR.KLR
  6B59'   18 13          C      	JR	UR.RSP
  6B5B'   DD 36 04 15    C      	LD	(IX+4),15H
  6B5F'   CD 5675'       C      	CALL	UF.EXEC
  6B62'   10 F7          C      	DJNZ	$-7
  6B64'   C1             C      	POP	BC
  6B65'   05             C      	DEC	B
  6B66'   28 06          C      	JR	Z,UR.RSP
  6B68'   DD 70 0A       C      	LD	(IX+10),B
  6B6B'   CD 6AE2'       C      	CALL	UR.KLV
  6B6E'                  C      UR.RSP:
  6B6E'   F1             C      	POP	AF
  6B6F'   D1             C      	POP	DE
  6B70'   E1             C      	POP	HL
  6B71'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;     2.     MONITOR
                         C      ;----------------------------------------------------------------------
  6B72'                  C      UR.MIMO:
  6B72'   D5             C      	PUSH	DE	;Register DE, BC retten
  6B73'   C5             C      	PUSH	BC
  6B74'   46             C      	LD	B,(HL)	;Anzahl einzugebender Zeichen
  6B75'   23             C      	INC	HL
  6B76'   4E             C      	LD	C,(HL)	;Laenge der Zeichenkette
  6B77'   23             C      	INC	HL
  6B78'   5E             C      	LD	E,(HL)	;Zeichenschluessel
  6B79'   23             C      	INC	HL
  6B7A'   3A 2B00'       C      	LD	A,(UB.ZN)	;Zeilennummer
  6B7D'   57             C      	LD	D,A	;D:= Zeilennummer
  6B7E'   AF             C      	XOR	A
  6B7F'   B9             C      	CP	C
  6B80'   28 0C          C      	JR	Z,UR.MIMO1	;Anzeige entfaellt
  6B82'   D5             C      	PUSH	DE
  6B83'   CD 6BB4'       C      	CALL	UR.DSPZK	;Anzeige
  6B86'                  C      UR.MIMO2:
  6B86'   D1             C      	POP	DE
  6B87'   CD 6BC1'       C      	CALL	UR.ZINP	;Zeicheneingabe ueber Tastatur
  6B8A'   C1             C      	POP	BC
  6B8B'   D1             C      	POP	DE
  6B8C'   18 07          C      	JR	UR.MIMO3
  6B8E'                  C      UR.MIMO1:
  6B8E'   D5             C      	PUSH	DE
  6B8F'   CD 6BA4'       C      	CALL	UR.BBSAD	;BWS - Adresse berechnen
  6B92'   EB             C      	EX	DE,HL	;HL:= akt. Bildschirmposition
  6B93'   18 F1          C      	JR	UR.MIMO2
  6B95'                  C      UR.MIMO3:
  6B95'   F5             C      	PUSH	AF
  6B96'   3A 2B00'       C      	LD	A,(UB.ZN)
  6B99'   3C             C      	INC	A
  6B9A'   FE 18          C      	CP	24
  6B9C'   CC 6CA4'       C      	CALL	Z,UR.BILRO	;Zeile 24 ---> Bild rollen
  6B9F'   32 2B00'       C      	LD	(UB.ZN),A
  6BA2'   F1             C      	POP	AF
  6BA3'   C9             C      	RET
  6BA4'                  C      UR.BBSAD:
  6BA4'   E5             C      	PUSH	HL	;Berechnung der BWS-Adresse
  6BA5'   C5             C      	PUSH	BC	;IN:    D...Zeilennummer
  6BA6'   21 2FB0        C      	LD	HL,UE.BWSA-80	;OUT:   DE..BWS-Adresse
  6BA9'   01 0050        C      	LD	BC,80	;BC:= Zeichen/Zeile
  6BAC'                  C      UR.BBSA1:
  6BAC'   09             C      	ADD	HL,BC
  6BAD'   15             C      	DEC	D
  6BAE'   20 FC          C      	JR	NZ,UR.BBSA1
  6BB0'   EB             C      	EX	DE,HL
  6BB1'   C1             C      	POP	BC
  6BB2'   E1             C      	POP	HL
  6BB3'   C9             C      	RET
'Routinen fuer Kassette,Monitor UND Tastatur'	MACRO-80 3.44	09-Dec-81	PAGE	1-59


  6BB4'                  C      UR.DSPZK:
  6BB4'   D5             C      	PUSH	DE	;Anzeige
  6BB5'   C5             C      	PUSH	BC	;IN   HL...Anfangsadresse ZK
  6BB6'   CD 6BA4'       C      	CALL	UR.BBSAD	;      D...Zeilennummer
  6BB9'   06 00          C      	LD	B,0	;      C...Zeichenkettenlaenge
  6BBB'   ED B0          C      	LDIR		;OUT  HL...akt. BWS-Adresse
  6BBD'   EB             C      	EX	DE,HL
  6BBE'   C1             C      	POP	BC
  6BBF'   D1             C      	POP	DE
  6BC0'   C9             C      	RET
  6BC1'                  C      UR.ZINP:
  6BC1'   E5             C      	PUSH	HL	;Zeicheneingabe ueber Tastatur
  6BC2'   AF             C      	XOR	A	;IN    B...Zeichenanzahl (max.)
  6BC3'   50             C      	LD	D,B	;     HL...akt. Adresse
  6BC4'   B8             C      	CP	B	;      E...Zeichenschluessel
  6BC5'   28 3D          C      	JR	Z,UR.RET0	;keine Zeicheneingabe
  6BC7'                  C      UR.ZINP1:
  6BC7'   CD 4033        C      	CALL	SY.SETCHL	;Kursor setzen
  6BCA'                  C      UR.ZINP2:
  6BCA'   CD 6C9E'       C      	CALL	UR.TAREP	;Tastaturabfrage
  6BCD'   CD 6C0E'       C      	CALL	UR.TCL	; <---
  6BD0'   CD 6C23'       C      	CALL	UR.TCR	; --->
  6BD3'   CD 6C36'       C      	CALL	UR.TSYS	; SYS
  6BD6'   CD 6C3E'       C      	CALL	UR.TQUIT	; POS.QUIT
  6BD9'   CD 6C46'       C      	CALL	UR.ZKONT	;Zeichenkontrolle
  6BDC'   CD 4036        C      	CALL	SY.RESC	;Kursor loeschen
  6BDF'   77             C      	LD	(HL),A	;Zeichen anzeigen
  6BE0'   23             C      	INC	HL	;akt. Adresse erhoehen
  6BE1'   10 E4          C      	DJNZ	UR.ZINP1	;B > 0, naechstes Zeichen
  6BE3'   CD 4033        C      	CALL	SY.SETCHL	;Kursor setzen
  6BE6'                  C      UR.ZINP5:
  6BE6'   CD 6C9E'       C      	CALL	UR.TAREP
  6BE9'   FE F7          C      	CP	UE.TACL
  6BEB'   CC 6C07'       C      	CALL	Z,UR.ZINP7
  6BEE'   FE 1E          C      	CP	UE.TAQUI
  6BF0'   28 06          C      	JR	Z,UR.ZINP3	;---> POS.QUIT
  6BF2'   FE CD          C      	CP	UE.TASYS
  6BF4'   28 08          C      	JR	Z,UR.ZINP4	;---> SYS
  6BF6'   18 EE          C      	JR	UR.ZINP5
  6BF8'                  C      UR.ZINP3:
  6BF8'   CD 4036        C      	CALL	SY.RESC	;Kursor loeschen
  6BFB'   E1             C      	POP	HL	;BWS - Adresse auskellern
  6BFC'   AF             C      	XOR	A	;CY:= 0
  6BFD'   C9             C      	RET
  6BFE'                  C      UR.ZINP4:
  6BFE'   CD 4036        C      	CALL	SY.RESC	;Kursor loeschen
  6C01'   E1             C      	POP	HL
  6C02'   37             C      	SCF		;CY:= 1
  6C03'   C9             C      	RET
  6C04'                  C      UR.RET0:
  6C04'   E1             C      	POP	HL	;keine Zeicheneingabe
  6C05'   AF             C      	XOR	A
  6C06'   C9             C      	RET
  6C07'                  C      UR.ZINP7:
  6C07'   CD 6C0E'       C      	CALL	UR.TCL
  6C0A'   33             C      	INC	SP
  6C0B'   33             C      	INC	SP
  6C0C'   18 BC          C      	JR	UR.ZINP2
  6C0E'                  C      UR.TCL:
  6C0E'   FE F7          C      	CP	UE.TACL	;   <---
  6C10'   C0             C      	RET	NZ		;Taste nicht gedrueckt
  6C11'   F5             C      	PUSH	AF	;Tastencode retten
  6C12'   04             C      	INC	B
  6C13'   7A             C      	LD	A,D
  6C14'   B8             C      	CP	B
  6C15'   38 09          C      	JR	C,UR.TCLN	;Linksbewegung nicht zulaessig
  6C17'   CD 4036        C      	CALL	SY.RESC	;Kursor loeschen
  6C1A'   2B             C      	DEC	HL	;BWS - Adresse decrementieren
  6C1B'   CD 4033        C      	CALL	SY.SETCHL	;Kursor setzen
  6C1E'   F1             C      	POP	AF	;Code auskellern
  6C1F'   C9             C      	RET
  6C20'                  C      UR.TCLN:
  6C20'   05             C      	DEC	B
  6C21'   F1             C      	POP	AF
  6C22'   C9             C      	RET
  6C23'                  C      UR.TCR:
  6C23'   FE F9          C      	CP	UE.TACR	;   --->
  6C25'   C0             C      	RET	NZ
  6C26'   F5             C      	PUSH	AF
  6C27'   78             C      	LD	A,B
  6C28'   FE 02          C      	CP	2
  6C2A'   38 08          C      	JR	C,UR.TCRN
  6C2C'   05             C      	DEC	B
'Routinen fuer Kassette,Monitor UND Tastatur'	MACRO-80 3.44	09-Dec-81	PAGE	1-60


  6C2D'   CD 4036        C      	CALL	SY.RESC
  6C30'   23             C      	INC	HL
  6C31'   CD 4033        C      	CALL	SY.SETCHL
  6C34'                  C      UR.TCRN:
  6C34'   F1             C      	POP	AF
  6C35'   C9             C      	RET
  6C36'                  C      UR.TSYS:
  6C36'   FE CD          C      	CP	UE.TASYS	; SYS-Taste
  6C38'   C0             C      	RET	NZ
  6C39'   33             C      	INC	SP
  6C3A'   33             C      	INC	SP	;Returnadresse uebergehen
  6C3B'   C3 6BFE'       C      	JP	UR.ZINP4
  6C3E'                  C      UR.TQUIT:
  6C3E'   FE 1E          C      	CP	UE.TAQUI	; POS.QUIT
  6C40'   C0             C      	RET	NZ
  6C41'   33             C      	INC	SP
  6C42'   33             C      	INC	SP
  6C43'   C3 6BF8'       C      	JP	UR.ZINP3
  6C46'                  C      UR.ZKONT:
  6C46'   FE 7F          C      	CP	7FH
  6C48'   30 22          C      	JR	NC,UR.ZKON1
  6C4A'   CB 7B          C      	BIT	7,E	;Zeichenschluesselauswertung
  6C4C'   C0             C      	RET	NZ		;Bit 7 = L, alle Tasten erlaubt
  6C4D'   FE 20          C      	CP	20H
  6C4F'   C8             C      	RET	Z		;Leertaste
  6C50'   CB 6B          C      	BIT	5,E
  6C52'   37             C      	SCF
  6C53'   C4 6C71'       C      	CALL	NZ,UR.ALPHA
  6C56'   D0             C      	RET	NC		;Bit 5 = L, nur Buchstaben
  6C57'   CB 63          C      	BIT	4,E
  6C59'   37             C      	SCF
  6C5A'   C4 6C7C'       C      	CALL	NZ,UR.NUM
  6C5D'   D0             C      	RET	NC		;Bit 4 = L, nur Ziffern
  6C5E'   CB 73          C      	BIT	6,E
  6C60'   37             C      	SCF
  6C61'   C4 6C85'       C      	CALL	NZ,UR.ALPNU
  6C64'   D0             C      	RET	NC		;Bit 6 = L, Buchstaben und
                         C      			;            Ziffern
  6C65'   CB 5B          C      	BIT	3,E
  6C67'   37             C      	SCF
  6C68'   C4 6C8F'       C      	CALL	NZ,UR.HEXAZ
  6C6B'   D0             C      	RET	NC		;BIT 3 = L ,HEXAZEICHEN
  6C6C'                  C      UR.ZKON1:
  6C6C'   33             C      	INC	SP
  6C6D'   33             C      	INC	SP
  6C6E'   C3 6BCA'       C      	JP	UR.ZINP2	;unerlaubter Tastencode
  6C71'                  C      UR.ALPHA:
  6C71'   FE 41          C      	CP	41H
  6C73'   D8             C      	RET	C
  6C74'   FE 5B          C      	CP	5BH
  6C76'   38 02          C      	JR	C,UR.ALPH1
  6C78'   37             C      	SCF
  6C79'   C9             C      	RET
  6C7A'                  C      UR.ALPH1:
  6C7A'   3F             C      	CCF
  6C7B'   C9             C      	RET
  6C7C'                  C      UR.NUM:
  6C7C'   FE 30          C      	CP	30H
  6C7E'   D8             C      	RET	C
  6C7F'   FE 3A          C      	CP	3AH
  6C81'   38 F7          C      	JR	C,UR.ALPH1
  6C83'   37             C      	SCF
  6C84'   C9             C      	RET
  6C85'                  C      UR.ALPNU:
  6C85'   CD 6C71'       C      	CALL	UR.ALPHA
  6C88'   D0             C      	RET	NC
  6C89'   CD 6C7C'       C      	CALL	UR.NUM
  6C8C'   D0             C      	RET	NC
  6C8D'   37             C      	SCF
  6C8E'   C9             C      	RET
  6C8F'                  C      UR.HEXAZ:
  6C8F'   CD 6C7C'       C      	CALL	UR.NUM
  6C92'   D0             C      	RET	NC
  6C93'   FE 41          C      	CP	'A'
  6C95'   D8             C      	RET	C
  6C96'   FE 47          C      	CP	'G'
  6C98'   38 02          C      	JR	C,UR.HEXZ1
  6C9A'   37             C      	SCF
  6C9B'   C9             C      	RET
  6C9C'                  C      UR.HEXZ1:
  6C9C'   3F             C      	CCF
  6C9D'   C9             C      	RET
                         C      
'Routinen fuer Kassette,Monitor UND Tastatur'	MACRO-80 3.44	09-Dec-81	PAGE	1-61


  6C9E'                  C      UR.TAREP:
  6C9E'   CD 4026        C      	CALL	TA.ABFR1	;TASTATURROUTINE FUER ATS
  6CA1'   28 FB          C      	JR	Z,$-3	;ES LIEGT KEIN ZEICHEN AN
  6CA3'   C9             C      	RET
                         C      
  6CA4'                  C      UR.BILRO:
  6CA4'   C5             C      	PUSH	BC
  6CA5'   D5             C      	PUSH	DE
  6CA6'   E5             C      	PUSH	HL
  6CA7'   01 03C0        C      	LD	BC,960
  6CAA'   11 3370        C      	LD	DE,UE.BWSA+880
  6CAD'   21 33C0        C      	LD	HL,UE.BWSA+960
  6CB0'   ED B0          C      	LDIR
  6CB2'   3E 20          C      	LD	A,20H	;letzte Zeile loeschen
  6CB4'   06 50          C      	LD	B,80
  6CB6'                  C      UR.BILR1:
  6CB6'   12             C      	LD	(DE),A
  6CB7'   10 FD          C      	DJNZ	UR.BILR1
  6CB9'   E1             C      	POP	HL
  6CBA'   AF             C      	XOR	A
  6CBB'   01 0050        C      	LD	BC,80
  6CBE'   ED 42          C      	SBC	HL,BC	;aktuelle BWS-Adresse nach  ROLL
  6CC0'   3A 2B00'       C      	LD	A,(UB.ZN)
  6CC3'   D1             C      	POP	DE
  6CC4'   C1             C      	POP	BC
  6CC5'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                                ;
                                ;	INCLUDE	U1.MAC	;Allgemeine Unterprogramme
                                ;	INCLUDE	XY.MAC	;Handling f. IX/IY-adressierte Bereiche
                                ;	INCLUDE	UC.MAC	;Konvertierungen
                                ;	INCLUDE	CP.MAC	;Komprimierung
                                ;	INCLUDE	DC.MAC	;Dekomprimierung
                                ;	INCLUDE	UK.MAC	;Einzelzeicheneingabe fuer KMBG
                         C      	INCLUDE K8.MAC	;Allgemeine Unterprogramme
                         C      	TITLE	'Allgemeine Unterprogramme'
                         C      	PAGE
'Allgemeine Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-62


                         C      
                         C      ;	PN	U1
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;        Allgemeine Unterprogramme
                         C      ;
                         C      ;----------------------------------------------------------------------
  6CC6'                  C      U1.RSAVE:
  6CC6'   E3             C      	EX	(SP),HL	;Register retten (nicht AF)
  6CC7'   D5             C      	PUSH	DE
  6CC8'   C5             C      	PUSH	BC
  6CC9'   FD E5          C      	PUSH	IY
  6CCB'   DD E5          C      	PUSH	IX
  6CCD'   E9             C      	JP	(HL)
  6CCE'                  C      U1.RRST:
  6CCE'   E1             C      	POP	HL	;Register wieder herstellen
  6CCF'   DD E1          C      	POP	IX
  6CD1'   FD E1          C      	POP	IY
  6CD3'   C1             C      	POP	BC
  6CD4'   D1             C      	POP	DE
  6CD5'   E3             C      	EX	(SP),HL
  6CD6'   C9             C      	RET
  6CD7'                  C      U1.CLRB:
  6CD7'   E5             C      	PUSH	HL	;Bereich loeschen
  6CD8'   D5             C      	PUSH	DE
  6CD9'   C5             C      	PUSH	BC
  6CDA'   E5             C      	PUSH	HL	;IN:  HL= Bereichsanfang
  6CDB'   D1             C      	POP	DE	;     BC= Bereichslaenge
  6CDC'   13             C      	INC	DE
  6CDD'   AF             C      	XOR	A
  6CDE'   77             C      	LD	(HL),A
  6CDF'   0B             C      	DEC	BC
  6CE0'   ED B0          C      	LDIR
  6CE2'   C1             C      	POP	BC
  6CE3'   D1             C      	POP	DE
  6CE4'   E1             C      	POP	HL
  6CE5'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  6CE6'                  C      U1.KBR4:
  6CE6'   C5             C      	PUSH	BC
  6CE7'   06 04          C      	LD	B,4
  6CE9'   CD 6B00'       C      	CALL	UR.KBR
  6CEC'   10 FB          C      	DJNZ	$-3
  6CEE'   C1             C      	POP	BC
  6CEF'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  6CF0'                  C      U1.WAIT:
                         C      	; PUSH	AF
                         C      	; CALL	UE.BERT
                         C      	; JR	C,$-3
                         C      	; POP	AF
  6CF0'   C9             C      	RET
                         C      ;--------------------------------------------------------------------
  6CF1'                  C      U1.BREAD:
  6CF1'   CD 6D34'       C      	CALL	U1.EIN	;BLOCK LESEN VON EINGABE
  6CF4'   DD 36 04 02    C      	LD	(IX+4),02H
  6CF8'   CD 5675'       C      	CALL	UF.EXEC
  6CFB'   C9             C      	RET
  6CFC'                  C      U1.BWRIT:
  6CFC'   CD 6D3D'       C      	CALL	U1.AUS	;BLOCK SCHREIBEN AUF AUSGABE
  6CFF'   DD 36 04 08    C      	LD	(IX+4),08H
  6D03'   CD 5675'       C      	CALL	UF.EXEC
  6D06'   C9             C      	RET
  6D07'                  C      U1.COPB2:
  6D07'   F5             C      	PUSH	AF
  6D08'   37             C      	SCF
  6D09'   18 02          C      	JR	$+4
  6D0B'                  C      U1.COPB:
  6D0B'   F5             C      	PUSH	AF
  6D0C'   B7             C      	OR	A
  6D0D'   CD 6D34'       C      	CALL	U1.EIN
  6D10'   DD 36 04 02    C      	LD	(IX+4),02H
  6D14'   DC 676D'       C      	CALL	C,KX.EXEC2
  6D17'   D4 5675'       C      	CALL	NC,UF.EXEC
  6D1A'   F5             C      	PUSH	AF
  6D1B'   CD 6D3D'       C      	CALL	U1.AUS
  6D1E'   DD 7E 09       C      	LD	A,(IX+9)	;??? C$ndern =!
  6D21'   DD B6 0A       C      	OR	(IX+10)
  6D24'   28 08          C      	JR	Z,$+10
  6D26'   CD 6CFC'       C      	CALL	U1.BWRIT
  6D29'   F1             C      	POP	AF
  6D2A'   38 DC          C      	JR	C,$-34
'Allgemeine Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-63


  6D2C'   30 DE          C      	JR	NC,$-32
  6D2E'   CD 6AEE'       C      	CALL	UR.KBM
  6D31'   F1             C      	POP	AF
  6D32'   F1             C      	POP	AF
  6D33'   C9             C      	RET
  6D34'                  C      U1.EIN:
  6D34'   F5             C      	PUSH	AF
  6D35'   3A E000        C      	LD	A,(BC.TAB1)
  6D38'   DD 77 03       C      	LD	(IX+3),A	;???
  6D3B'   F1             C      	POP	AF
  6D3C'   C9             C      	RET
  6D3D'                  C      U1.AUS:
  6D3D'   F5             C      	PUSH	AF
  6D3E'   3A E001        C      	LD	A,(BC.TAB1+1)
  6D41'   DD 77 03       C      	LD	(IX+3),A	;???
  6D44'   F1             C      	POP	AF
  6D45'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  6D46'                  C      U1.VS1:
  6D46'   E5             C      	PUSH	HL
  6D47'   C5             C      	PUSH	BC
  6D48'   F5             C      	PUSH	AF
  6D49'   3E 01          C      	LD	A,01H	;1.DATEIVORSATZ IM PUFFER
  6D4B'   18 04          C      	JR	$+6
  6D4D'                  C      U1.VSX:
  6D4D'   E5             C      	PUSH	HL
  6D4E'   C5             C      	PUSH	BC
  6D4F'   F5             C      	PUSH	AF
  6D50'   AF             C      	XOR	A	;00-DATEIVORSATZ IM PUFFER
  6D51'   06 20          C      	LD	B,32
  6D53'   21 0E66        C      	LD	HL,UE.PUF
  6D56'   CD 6E6D'       C      	CALL	U1.TR
  6D59'   F1             C      	POP	AF
  6D5A'   C1             C      	POP	BC
  6D5B'   E1             C      	POP	HL
  6D5C'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  6D5D'                  C      U1.DSVG:
  6D5D'   E5             C      	PUSH	HL
  6D5E'   D5             C      	PUSH	DE
  6D5F'   F5             C      	PUSH	AF
  6D60'   06 07          C      	LD	B,7	;MRES KASSETTE ?
  6D62'   CD 6E09'       C      	CALL	U1.VORS1
  6D65'   11 0E6C        C      	LD	DE,UE.PUF+6
  6D68'   21 5755'       C      	LD	HL,UA.DS+6
  6D6B'   06 0E          C      	LD	B,14
  6D6D'   1A             C      	LD	A,(DE)
  6D6E'   BE             C      	CP	(HL)
  6D6F'   20 10          C      	JR	NZ,$+18
  6D71'   13             C      	INC	DE
  6D72'   23             C      	INC	HL
  6D73'   10 F8          C      	DJNZ	$-6
  6D75'   3A 0E67        C      	LD	A,(UE.PUF+1)
  6D78'   4F             C      	LD	C,A	;C <-- NEXT RECORD
  6D79'   3A 0E69        C      	LD	A,(UE.PUF+3)
  6D7C'   47             C      	LD	B,A	;B <-- ANZ.VERZ.EINTRAG.
  6D7D'   F1             C      	POP	AF
  6D7E'   D1             C      	POP	DE
  6D7F'   E1             C      	POP	HL
  6D80'   C9             C      	RET
                         C      
  6D81'   F1             C      	POP	AF
  6D82'   D1             C      	POP	DE
  6D83'   E1             C      	POP	HL
  6D84'   FD E1          C      	POP	IY
  6D86'   3E 90          C      	LD	A,90H
  6D88'   CD 56A5'       C      	CALL	UF.ERANZ
  6D8B'   C3 000B        C      	JP	UE.SYSTB
                         C      ;----------------------------------------------------------------------
  6D8E'                  C      U1.NMVGL:
  6D8E'   C5             C      	PUSH	BC
  6D8F'   D5             C      	PUSH	DE
  6D90'   E5             C      	PUSH	HL
  6D91'   06 06          C      	LD	B,6
  6D93'   11 0E66        C      	LD	DE,UE.PUF
  6D96'   1A             C      	LD	A,(DE)
  6D97'   BE             C      	CP	(HL)	;HL:ZU SUCHENDER PROGR.NAME
  6D98'   20 0C          C      	JR	NZ,$+14
  6D9A'   23             C      	INC	HL
  6D9B'   13             C      	INC	DE
  6D9C'   10 F8          C      	DJNZ	$-6
  6D9E'   3A 0E7D        C      	LD	A,(UE.PUF+23)	;LABELNR. -->A
  6DA1'   37             C      	SCF		;CY=1,WENN PROGR. GEFUNDEN
'Allgemeine Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-64


  6DA2'   E1             C      	POP	HL
  6DA3'   D1             C      	POP	DE
  6DA4'   C1             C      	POP	BC
  6DA5'   C9             C      	RET
                         C      
  6DA6'   B7             C      	OR	A
  6DA7'   18 F9          C      	JR	$-5
                         C      ;----------------------------------------------------------------------
  6DA9'                  C      U1.KTINI:
  6DA9'   E5             C      	PUSH	HL
  6DAA'   C5             C      	PUSH	BC
  6DAB'   F5             C      	PUSH	AF
  6DAC'   CD 6E78'       C      	CALL	U1.BILO	;UNTERE HAELFTE BS LOESCHEN
  6DAF'   DD 21 2B03'    C      	LD	IX,UB.KTAB	;ADR. STEUERTAB. F.KASS.ROUTINE
  6DB3'   DD E5          C      	PUSH	IX
  6DB5'   E1             C      	POP	HL
  6DB6'   AF             C      	XOR	A
  6DB7'   06 1B          C      	LD	B,27
  6DB9'   CD 6E6D'       C      	CALL	U1.TR	;TAB. AUF 00 LOESCHEN
  6DBC'   DD 36 02 30    C      	LD	(IX+2),30H	;??? AKB Adresse
                         C      ;	CALL	UE.KINI
  6DC0'   18 03          C      	JR	$+5
  6DC2'                  C      U1.KTIN1:
  6DC2'   E5             C      	PUSH	HL
  6DC3'   C5             C      	PUSH	BC
  6DC4'   F5             C      	PUSH	AF
  6DC5'   DD 36 0B 07    C      	LD	(IX+11),7	;ANZAHL LESE/SCHREIBWDHLGNN
  6DC9'   DD 36 0C 04    C      	LD	(IX+12),4	;ANZAHL
  6DCD'   21 0E66        C      	LD	HL,UE.PUF
  6DD0'   CD 6EF8'       C      	CALL	XY.STIDX
  6DD3'   07             C      	DB	7	;SYSTEMPUFFERADR.-->TAB
  6DD4'   21 8010        C      	LD	HL,UE.KPUFF
  6DD7'   CD 6EE8'       C      	CALL	XY.STDX
  6DDA'   19             C      	DB	25	;E/A PUFFERADR.-->TAB	;???
  6DDB'   F1             C      	POP	AF
  6DDC'   C1             C      	POP	BC
  6DDD'   E1             C      	POP	HL
  6DDE'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  6DDF'                  C      U1.VERIN:
  6DDF'   E5             C      	PUSH	HL
  6DE0'   C5             C      	PUSH	BC
  6DE1'   F5             C      	PUSH	AF
  6DE2'   11 EC82        C      	LD	DE,BC.VTABE	;VERZ. EINGABEGER. EINLESEN
  6DE5'   18 03          C      	JR	$+5
  6DE7'                  C      U1.VERNI:
  6DE7'   E5             C      	PUSH	HL
  6DE8'   C5             C      	PUSH	BC
  6DE9'   F5             C      	PUSH	AF
  6DEA'   3A 0E69        C      	LD	A,(UE.PUF+3)	;ANZ. DATEIEN-->B
  6DED'   47             C      	LD	B,A
  6DEE'   C5             C      	PUSH	BC
  6DEF'   21 0E66        C      	LD	HL,UE.PUF
  6DF2'   01 0020        C      	LD	BC,32
  6DF5'   ED B0          C      	LDIR
  6DF7'   CD 5675'       C      	CALL	UF.EXEC
  6DFA'   C1             C      	POP	BC
  6DFB'   10 F1          C      	DJNZ	$-13
  6DFD'   F1             C      	POP	AF
  6DFE'   C1             C      	POP	BC
  6DFF'   E1             C      	POP	HL
  6E00'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  6E01'                  C      U1.VORST:
  6E01'   C5             C      	PUSH	BC
  6E02'   CD 6AD8'       C      	CALL	UR.KRWW
  6E05'   06 06          C      	LD	B,6
  6E07'   18 01          C      	JR	$+3
  6E09'                  C      U1.VORS1:
  6E09'   C5             C      	PUSH	BC
  6E0A'   DD 36 04 02    C      	LD	(IX+4),02H
  6E0E'   CD 5675'       C      	CALL	UF.EXEC
  6E11'   10 FB          C      	DJNZ	$-3
  6E13'   C1             C      	POP	BC
  6E14'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  6E15'                  C      U1.VZS:
  6E15'   D5             C      	PUSH	DE
  6E16'   C5             C      	PUSH	BC
  6E17'   E5             C      	PUSH	HL
  6E18'   F5             C      	PUSH	AF
  6E19'   CD 6AFA'       C      	CALL	UR.KBV
  6E1C'   CD 6B00'       C      	CALL	UR.KBR
'Allgemeine Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-65


  6E1F'   11 0E66        C      	LD	DE,UE.PUF
  6E22'   01 0006        C      	LD	BC,6
  6E25'   ED B0          C      	LDIR		;PROGR.NAME --> PUFFER
  6E27'   3A 2B28'       C      	LD	A,(UB.PAR2)	;DATEITYP
  6E2A'   12             C      	LD	(DE),A
  6E2B'   13             C      	INC	DE
  6E2C'   3E 44          C      	LD	A,'D'
  6E2E'   12             C      	LD	(DE),A
  6E2F'   13             C      	INC	DE
  6E30'   3A 2B2A'       C      	LD	A,(UB.PAR3)
  6E33'   FE 7F          C      	CP	7FH
  6E35'   20 0F          C      	JR	NZ,$+17
  6E37'   21 5795'       C      	LD	HL,UA.KOMMT	;FRAGE KOMMENTAR WENN PAR3=7F
  6E3A'   CD 6B72'       C      	CALL	UR.MIMO
  6E3D'   01 0006        C      	LD	BC,6
  6E40'   ED B0          C      	LDIR
  6E42'   06 09          C      	LD	B,9
  6E44'   18 02          C      	JR	$+4
  6E46'   06 0F          C      	LD	B,15
  6E48'   3E 20          C      	LD	A,' '
  6E4A'   12             C      	LD	(DE),A
  6E4B'   13             C      	INC	DE
  6E4C'   10 FC          C      	DJNZ	$-2
  6E4E'   3A 2B26'       C      	LD	A,(UB.PAR1)
  6E51'   12             C      	LD	(DE),A
  6E52'   13             C      	INC	DE
  6E53'   06 08          C      	LD	B,8
  6E55'   AF             C      	XOR	A
  6E56'   12             C      	LD	(DE),A
  6E57'   13             C      	INC	DE
  6E58'   10 FC          C      	DJNZ	$-2
  6E5A'   21 0020        C      	LD	HL,32
  6E5D'   CD 6EF8'       C      	CALL	XY.STIDX
  6E60'   09             C      	DB	9
  6E61'   DD 36 04 08    C      	LD	(IX+4),08H
  6E65'   CD 5675'       C      	CALL	UF.EXEC
  6E68'   F1             C      	POP	AF
  6E69'   E1             C      	POP	HL
  6E6A'   C1             C      	POP	BC
  6E6B'   D1             C      	POP	DE
  6E6C'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  6E6D'                  C      U1.TR:
  6E6D'   77             C      	LD	(HL),A	;A=INHALT
  6E6E'   23             C      	INC	HL
  6E6F'   10 FC          C      	DJNZ	U1.TR	;B=ANZAHL
  6E71'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  6E72'                  C      U1.INFO:
  6E72'   01 000E        C      	LD	BC,14
  6E75'   ED B0          C      	LDIR
  6E77'   C9             C      	RET
  6E78'                  C      U1.BILO:
  6E78'   CD 6CC6'       C      	CALL	U1.RSAVE
  6E7B'   21 3370        C      	LD	HL,SD.BWSA + 11*80	;3370H
  6E7E'   01 040F        C      	LD	BC,13*80 - 1	;1120  ( -80 ... eine Zeile )
  6E81'   36 20          C      	LD	(HL),20H
  6E83'   54             C      	LD	D,H
  6E84'   5D             C      	LD	E,L
  6E85'   13             C      	INC	DE
  6E86'   ED B0          C      	LDIR
  6E88'   CD 6CCE'       C      	CALL	U1.RRST
  6E8B'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  6E8C'                  C      U1.TST:
  6E8C'   B7             C      	OR	A
  6E8D'   D6 30          C      	SUB	30H
  6E8F'   47             C      	LD	B,A
  6E90'   05             C      	DEC	B
  6E91'   C8             C      	RET	Z
  6E92'   05             C      	DEC	B
  6E93'   C8             C      	RET	Z
  6E94'   37             C      	SCF
  6E95'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  6E96'                  C      U1.PRADR:
  6E96'   E5             C      	PUSH	HL
  6E97'   C5             C      	PUSH	BC
  6E98'   06 04          C      	LD	B,4
  6E9A'   7E             C      	LD	A,(HL)
  6E9B'   FE 20          C      	CP	' '
  6E9D'   28 07          C      	JR	Z,$+9
  6E9F'   23             C      	INC	HL
'Allgemeine Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-66


  6EA0'   10 F8          C      	DJNZ	$-6
  6EA2'   B7             C      	OR	A
  6EA3'   C1             C      	POP	BC
  6EA4'   E1             C      	POP	HL
  6EA5'   C9             C      	RET
  6EA6'   37             C      	SCF
  6EA7'   21 2B00'       C      	LD	HL,UB.ZN
  6EAA'   35             C      	DEC	(HL)
  6EAB'   18 F6          C      	JR	$-8
                         C      ;---------------------------------------------------------------------
  6EAD'                  C      U1.KRWE:
  6EAD'   CD 6ACA'       C      	CALL	UR.KRE
  6EB0'   CD 6AD8'       C      	CALL	UR.KRWW
  6EB3'   C9             C      	RET
                         C      ;---------------------------------------------------------------------
                         C      ;	END
                         C      	TITLE 'Handling f. IX/IY-adressierte Bereiche'
                         C      	PAGE
'Handling f. IX/IY-adressierte Bereiche'	MACRO-80 3.44	09-Dec-81	PAGE	1-67


                         C      
                         C      ;	PN	XY ; Unterprogramme
                         C      ;**********************************************************************
                         C      ;*                                                                    *
                         C      ;*       Handling f. IX/IY-adressierte Steuer-Bloecke bzw.            *
                         C      ;*                                     Arbeits-Bereiche               *
                         C      ;*                                                                    *
                         C      ;*--------------------------------------------------------------------*
                         C      ;*                                                                    *
                         C      ;*       Ausser den angegebenen Registern bzw. Flags wird nur noch    *
                         C      ;*       die angegebene Anzahl der ersten freien Stack-Plaetze (je    *
                         C      ;*       Byte) veraendert. Weiterer RAM-Platz wird nicht benoetigt.   *
                         C      ;*                                                                    *
                         C      ;**********************************************************************
                         C      ;*                                                                    *
                         C      ;*       Technische (Hilfs-) Unter-Programme                          *
                         C      ;*                                                                    *
                         C      ;**********************************************************************
                         C      			;
                         C      ;        Uebernahme von nach dem CALL stehenden Parameter
                         C      ;        ++++++++++++++++++++++++++++++++++++++++++++++++
                         C      ;        erwarten Stack:           Return-Adresse f.uebergeordnetes UP
                         C      ;                       (SP) -->   Return-Adresse f.CALPn
                         C      ;        geben Stack zurueck:      Return-Adresse f.uebergeordn.UP + n
                         C      ;                                  (DE)
                         C      ;                       (SP) -->   (HL)
                         C      ;        geben in Reg.zurueck:     (DE):  Wert    1.Parameter-Byte
                         C      ;                                  (HL):  Adresse 2.Parameter-Byte
                         C      ;        --------------------------------------------------------------
                         C      			;
  6EB4'                  C      XY.CALP1	EQU	$	; 1 Byte-Parameter
                         C      			; ++++++++++++++++++++++++++++++
  6EB4'   E5             C      	PUSH	HL	; Retten HL
  6EB5'   E1             C      	POP	HL
                         C      			;
  6EB6'   EB             C      	EX	DE,HL	; DE <--> RET-Adr.f.CALPn
  6EB7'   E3             C      	EX	(SP),HL
  6EB8'   EB             C      	EX	DE,HL
                         C      			;
  6EB9'   E1             C      	POP	HL	; (SP) --> RET-Adr.f.ueberg.UP
                         C      			;
  6EBA'   E1             C      	POP	HL	; Laden u. korrig. ...
  6EBB'   23             C      	INC	HL
  6EBC'   E5             C      	PUSH	HL
  6EBD'                  C      XY.CALPE:
  6EBD'   2B             C      	DEC	HL
                         C      			;
  6EBE'   3B             C      	DEC	SP	; (SP) --> (DE)
  6EBF'   3B             C      	DEC	SP
  6EC0'   3B             C      	DEC	SP	; (SP) --> (HL)
  6EC1'   3B             C      	DEC	SP
                         C      			;
  6EC2'   D5             C      	PUSH	DE	; RET-Adr.f.CALPn
                         C      			;
  6EC3'   5E             C      	LD	E,(HL)	; Laden DE, HL
  6EC4'   16 00          C      	LD	D,0
  6EC6'   23             C      	INC	HL
                         C      			;
  6EC7'   C9             C      	RET
                         C      			;
                         C      			;
                         C      ;**********************************************************************
                         C      ;*                                                                    *
                         C      ;*       Lade-, Speicher- und Transport-Unterprogramme                *
                         C      ;*                                                                    *
                         C      ;**********************************************************************
                         C      ;
                         C      ;    CALL  LDDX    'Load':              HL := (IX+d)
                         C      ;    DB    d                                              Stack: 4
                         C      ;    -----------   ----------------------------------------------------
                         C      			;
  6EC8'                  C      XY.LDDX:
  6EC8'   CD 6EB4'       C      	CALL	XY.CALP1	; Uebernahme d
                         C      			;
  6ECB'   DD E5          C      	PUSH	IX	; HL := IX+d
  6ECD'   E1             C      	POP	HL	;               <--- LDDY
  6ECE'   F5             C      	PUSH	AF
  6ECF'   19             C      	ADD	HL,DE
  6ED0'   F1             C      	POP	AF
                         C      			;
  6ED1'   5E             C      	LD	E,(HL)	; HL := (IX+d)
  6ED2'   23             C      	INC	HL
'Handling f. IX/IY-adressierte Bereiche'	MACRO-80 3.44	09-Dec-81	PAGE	1-68


  6ED3'   56             C      	LD	D,(HL)
  6ED4'   EB             C      	EX	DE,HL
                         C      			;
  6ED5'   D1             C      	POP	DE	; Return
  6ED6'   D1             C      	POP	DE
  6ED7'   C9             C      	RET
                         C      			;
                         C      ;**********************************************************************
                         C      ;
                         C      ;    CALL  LIDX    'Load inverse':      LH := (IX+d)
                         C      ;    DB    d                                              Stack: 4
                         C      ;    -----------   ----------------------------------------------------
                         C      			;
  6ED8'                  C      XY.LIDX:
  6ED8'   CD 6EB4'       C      	CALL	XY.CALP1	; Uebernahme d
                         C      			;
  6EDB'   DD E5          C      	PUSH	IX	; HL := IX+d
  6EDD'   E1             C      	POP	HL	;               <--- LIDY
  6EDE'   F5             C      	PUSH	AF
  6EDF'   19             C      	ADD	HL,DE
  6EE0'   F1             C      	POP	AF
                         C      			;
  6EE1'   56             C      	LD	D,(HL)	; LH := (IX+d)
  6EE2'   23             C      	INC	HL
  6EE3'   5E             C      	LD	E,(HL)
  6EE4'   EB             C      	EX	DE,HL
                         C      			;
  6EE5'   D1             C      	POP	DE	; Return
  6EE6'   D1             C      	POP	DE
  6EE7'   C9             C      	RET
                         C      			;
                         C      ;**********************************************************************
                         C      ;
                         C      ;    CALL  STDX    'Store':            (IX+d) := HL
                         C      ;    DB    d                                                  Stack: 4
                         C      ;    -----------   ----------------------------------------------------
                         C      			;
  6EE8'                  C      XY.STDX:
  6EE8'   CD 6EB4'       C      	CALL	XY.CALP1	; Uebernahme d
                         C      			;
  6EEB'   DD E5          C      	PUSH	IX	; HL := IX+d
  6EED'   E1             C      	POP	HL	;               <--- STDY
  6EEE'   F5             C      	PUSH	AF
  6EEF'   19             C      	ADD	HL,DE
  6EF0'   F1             C      	POP	AF
                         C      			;
  6EF1'   D1             C      	POP	DE
  6EF2'   73             C      	LD	(HL),E	; (IX+d) := HL
  6EF3'   23             C      	INC	HL
  6EF4'   72             C      	LD	(HL),D
  6EF5'   EB             C      	EX	DE,HL
                         C      			;
  6EF6'   D1             C      	POP	DE	; Return
  6EF7'   C9             C      	RET
                         C      			;
                         C      ;**********************************************************************
                         C      ;
                         C      ;    CALL  STIDX    'Store inverse':    (IX+d) := LH
                         C      ;    DB    d                                                  Stack: 4
                         C      ;    -----------   ----------------------------------------------------
                         C      			;
  6EF8'                  C      XY.STIDX:
  6EF8'   CD 6EB4'       C      	CALL	XY.CALP1	; Uebernahme d
                         C      			;
  6EFB'   DD E5          C      	PUSH	IX	; HL := IX+d
  6EFD'   E1             C      	POP	HL	;               <--- STIDY
  6EFE'   F5             C      	PUSH	AF
  6EFF'   19             C      	ADD	HL,DE
  6F00'   F1             C      	POP	AF
                         C      			;
  6F01'   D1             C      	POP	DE
  6F02'   72             C      	LD	(HL),D	; (IX+d) := LH
  6F03'   23             C      	INC	HL
  6F04'   73             C      	LD	(HL),E
  6F05'   EB             C      	EX	DE,HL
                         C      			;
  6F06'   D1             C      	POP	DE	; Return
  6F07'   C9             C      	RET
                         C      			;
                         C      ;**********************************************************************
                         C      ;
                         C      ;    CALL  INCDX    'Increment':        (IX+d) := (IX+d) + 1
                         C      ;    DB    d                                    Flags wie ADC HL,...
'Handling f. IX/IY-adressierte Bereiche'	MACRO-80 3.44	09-Dec-81	PAGE	1-69


                         C      ;                                                             Stack: 4
                         C      ;    -----------   ----------------------------------------------------
                         C      			;
  6F08'                  C      XY.INCDX:
  6F08'   CD 6EB4'       C      	CALL	XY.CALP1	; Uebernahme d
                         C      			;
  6F0B'   DD E5          C      	PUSH	IX	; HL := IX+d
  6F0D'   E1             C      	POP	HL	;               <--- INCDY
  6F0E'   19             C      	ADD	HL,DE
                         C      			;
  6F0F'   5E             C      	LD	E,(HL)	; DE := (IX+d)
  6F10'   23             C      	INC	HL
  6F11'   56             C      	LD	D,(HL)
                         C      			;
  6F12'   E5             C      	PUSH	HL	; DE := (IX+d) + 1
  6F13'   21 0001        C      	LD	HL,1
  6F16'   B7             C      	OR	A
  6F17'   ED 5A          C      	ADC	HL,DE
  6F19'   EB             C      	EX	DE,HL
  6F1A'   E1             C      	POP	HL
  6F1B'   72             C      	LD	(HL),D
  6F1C'   2B             C      	DEC	HL
  6F1D'   73             C      	LD	(HL),E
                         C      			;
  6F1E'   E1             C      	POP	HL	; Return
  6F1F'   D1             C      	POP	DE
  6F20'   C9             C      	RET
                         C      			;
                         C      ;**********************************************************************
                         C      ;*                                                                    *
                         C      ;*       Unterprogramm  'Unbedingter Sprung'                          *
                         C      ;*                                                                    *
                         C      ;**********************************************************************
                         C      ;
                         C      ;    CALL  JMPDX   'Jump':              JMP  (IX+d)
                         C      ;    DB    d                                              Stack: 4
                         C      ;                                       Achtung!
                         C      ;                                           Veraendert freie Stack-Pl.
                         C      ;    -----------   ----------------------------------------------------
                         C      			;
  6F21'                  C      XY.JMPDX:
  6F21'   CD 6EB4'       C      	CALL	XY.CALP1	; Uebernahme d
                         C      			;
  6F24'   DD E5          C      	PUSH	IX	; HL := IX+d
  6F26'   E1             C      	POP	HL	;               <--- JMPDY
  6F27'   F5             C      	PUSH	AF
  6F28'   19             C      	ADD	HL,DE
  6F29'   F1             C      	POP	AF
                         C      			;
  6F2A'   5E             C      	LD	E,(HL)	; HL := (IX+d)
  6F2B'   23             C      	INC	HL
  6F2C'   56             C      	LD	D,(HL)
  6F2D'   EB             C      	EX	DE,HL
                         C      			;
  6F2E'   D1             C      	POP	DE	; Return = Jump
  6F2F'   E3             C      	EX	(SP),HL
  6F30'   EB             C      	EX	DE,HL
  6F31'   C9             C      	RET
                         C      			;
                         C      ;**********************************************************************
                         C      ;	END
                         C      	TITLE 'Konvertierungen'
                         C      	PAGE
'Konvertierungen'	MACRO-80 3.44	09-Dec-81	PAGE	1-70


                         C      
                         C      ;	PN	UC
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;       KONVERTIERUNGEN
                         C      ;
                         C      ;----------------------------------------------------------------------
                         C      ;                            HL := HL * 10
                         C      ;                                      (ohne Kontrolle auf Uebertrag)
  6F32'                  C      UC.HL10N:
  6F32'   E5             C      	PUSH	HL
  6F33'   D1             C      	POP	DE	; alter Wert in DE
  6F34'   29             C      	ADD	HL,HL
  6F35'   29             C      	ADD	HL,HL
  6F36'   19             C      	ADD	HL,DE
  6F37'   29             C      	ADD	HL,HL
  6F38'   C9             C      	RET
                         C      ;                            HL := HL * 10
                         C      ;                                            -->  C: Uebertrag in A
  6F39'                  C      UC.HL10C:
  6F39'   E5             C      	PUSH	HL
  6F3A'   D1             C      	POP	DE	; alter Wert in DE
  6F3B'   AF             C      	XOR	A
  6F3C'   29             C      	ADD	HL,HL
  6F3D'   30 01          C      	JR	NC,$+3
  6F3F'   3C             C      	INC	A
  6F40'   87             C      	ADD	A,A
  6F41'   29             C      	ADD	HL,HL
  6F42'   30 01          C      	JR	NC,$+3
  6F44'   3C             C      	INC	A
  6F45'   19             C      	ADD	HL,DE
  6F46'   30 01          C      	JR	NC,$+3
  6F48'   3C             C      	INC	A
  6F49'   87             C      	ADD	A,A
  6F4A'   29             C      	ADD	HL,HL
  6F4B'   30 01          C      	JR	NC,$+3
  6F4D'   3C             C      	INC	A
  6F4E'   B7             C      	OR	A
  6F4F'   C8             C      	RET	Z
  6F50'   37             C      	SCF
  6F51'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      ;                            Division mit Rest:  A  := HL / DE
                         C      ;                                                HL := Rest
                         C      			;      Cy(A) --->  A=255
                         C      			;-------------------------------
  6F52'                  C      UC.DIVR:
  6F52'   AF             C      	XOR	A
  6F53'   ED 52          C      	SBC	HL,DE
  6F55'   3C             C      	INC	A
  6F56'   20 03          C      	JR	NZ,$+5
  6F58'   3D             C      	DEC	A
  6F59'   38 03          C      	JR	C,$+5
  6F5B'   30 F6          C      	JR	NC,$-8
  6F5D'   3D             C      	DEC	A
  6F5E'   19             C      	ADD	HL,DE
  6F5F'   C9             C      	RET
                         C      			;
                         C      ;**********************************************************************
                         C      ;*                                                                    *
                         C      ;*       CV...               Konvertierungen     (convert ...)        *
                         C      ;*                                                                    *
                         C      ;*--------------------------------------------------------------------*
                         C      ;*       ..A..:              in A                                     *
                         C      ;*       ..?*.:              von Typ *                                *
                         C      ;*       ..?.*:              nach Typ *                               *
                         C      ;*                                                                    *
                         C      ;*       Typen:              B - binaer                               *
                         C      ;*                           X - hexadezimal ASCII                    *
                         C      ;*                           A - Adresse binaer (L,H)                 *
                         C      ;*                           D - dezimal ASCII                        *
                         C      ;*                                                                    *
                         C      ;**********************************************************************
                         C      			;
                         C      ;                            In A:      Binaer < 16 --> ASCII hexa
                         C      ;                            ------------------------------------------
  6F60'                  C      UC.CVABX:
  6F60'   E6 0F          C      	AND	0FH
  6F62'   F6 30          C      	OR	30H
  6F64'   FE 3A          C      	CP	3AH
  6F66'   D8             C      	RET	C
'Konvertierungen'	MACRO-80 3.44	09-Dec-81	PAGE	1-71


  6F67'   C6 07          C      	ADD	A,7H
  6F69'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      ;                            Byte binaer (HL) --> 2 ASCII hexa (DE)
                         C      ;                                                            HL+1, DE+2
                         C      ;                            ------------------------------------------
  6F6A'                  C      UC.CVBX:
  6F6A'   7E             C      	LD	A,(HL)
  6F6B'   23             C      	INC	HL	; benutzt: A, 2 Stack-P.
                         C      			;
  6F6C'   F5             C      	PUSH	AF	;ENTRY,WENN ZEICHEN IN A
  6F6D'   0F             C      	RRCA
  6F6E'   0F             C      	RRCA
  6F6F'   0F             C      	RRCA
  6F70'   0F             C      	RRCA
  6F71'   CD 6F75'       C      	CALL	$+4
  6F74'   F1             C      	POP	AF
                         C      			;
  6F75'   CD 6F60'       C      	CALL	UC.CVABX
  6F78'   12             C      	LD	(DE),A
  6F79'   13             C      	INC	DE
  6F7A'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      ;                       Adresse (L,H) binaer (HL) --> 4 ASCII hexa (DE)
                         C      ;                                                            HL+2, DE+4
                         C      ;                       -----------------------------------------------
  6F7B'                  C      UC.CVAX:
  6F7B'   23             C      	INC	HL
  6F7C'   CD 6F6A'       C      	CALL	UC.CVBX	; benutzt: A, 3 Stack-P.
  6F7F'   2B             C      	DEC	HL
  6F80'   2B             C      	DEC	HL
  6F81'   CD 6F6A'       C      	CALL	UC.CVBX
  6F84'   23             C      	INC	HL
  6F85'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      ;                       Adresse aus HL, binaer    --> 4 ASCII hexa (DE)
                         C      ;                                                                  DE+4
                         C      ;                       -----------------------------------------------
  6F86'                  C      UC.CVHLX:
  6F86'   7C             C      	LD	A,H
  6F87'   CD 6F6C'       C      	CALL	UC.CVBX+2	; benutzt: A, 3 Stack-P.
  6F8A'   7D             C      	LD	A,L
  6F8B'   CD 6F6C'       C      	CALL	UC.CVBX+2
  6F8E'   C9             C      	RET
                         C      			;
                         C      			;
                         C      ;      ---------------------------------------------------------------
                         C      ;                            In A:     ASCII hexa --> binaer < 16
                         C      ;
                         C      ;                                       Datenfehler: Cy, A undefiniert
                         C      ;                            ------------------------------------------
  6F8F'                  C      UC.CVAXB:
  6F8F'   D6 30          C      	SUB	30H
  6F91'   D8             C      	RET	C		;       (A) < '0'
  6F92'   FE 0A          C      	CP	10
  6F94'   3F             C      	CCF
  6F95'   D0             C      	RET	NC
  6F96'   FE 11          C      	CP	11H
  6F98'   D8             C      	RET	C		; '9' < (A) < 'A'
  6F99'   FE 17          C      	CP	17H
  6F9B'   3F             C      	CCF
  6F9C'   D8             C      	RET	C		; 'F' < (A)
  6F9D'   D6 07          C      	SUB	7H
  6F9F'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      ;                            2 ASCII hexa (DE) --> Byte binaer (HL)
                         C      ;                                                            DE+2, HL+1
                         C      ;
                         C      ;                                       mit Datenfehler-Behandlung
                         C      ;                            ------------------------------------------
  6FA0'                  C      UC.CVXB:
  6FA0'   C5             C      	PUSH	BC
                         C      			; benutzt: A, 3 Stack-P.
  6FA1'   CD 6FB1'       C      	CALL	UC.CVX1B
  6FA4'   87             C      	ADD	A,A
  6FA5'   87             C      	ADD	A,A
  6FA6'   87             C      	ADD	A,A
  6FA7'   87             C      	ADD	A,A
  6FA8'   4F             C      	LD	C,A
'Konvertierungen'	MACRO-80 3.44	09-Dec-81	PAGE	1-72


                         C      			;
  6FA9'   CD 6FB1'       C      	CALL	UC.CVX1B
  6FAC'   81             C      	ADD	A,C
                         C      			;
  6FAD'   77             C      	LD	(HL),A
  6FAE'   23             C      	INC	HL
  6FAF'   C1             C      	POP	BC
  6FB0'   C9             C      	RET
                         C      			;
  6FB1'                  C      UC.CVX1B:
  6FB1'   1A             C      	LD	A,(DE)	; ASCII hexa (DE) --> A binaer,
  6FB2'   CD 6F8F'       C      	CALL	UC.CVAXB	;                           DE+1
  6FB5'   DC 6FBA'       C      	CALL	C,UC.CVXER
  6FB8'   13             C      	INC	DE
  6FB9'   C9             C      	RET
                         C      			;
  6FBA'                  C      UC.CVXER:
  6FBA'   EB             C      	EX	DE,HL       ; Datenfehler-Behandlung hexa
  6FBB'   CD 4033        C      	CALL	SY.SETCHL      ;         set cursor
  6FBE'   CD 6C9E'       C          CALL  UR.TAREP  ; <-+     tast.request
  6FC1'   77             C          LD    (HL),A    ;   |     write in conv.-area
  6FC2'   CD 6F8F'       C          CALL  UC.CVAXB  ;   |     conv.in A
  6FC5'   38 F7          C          JR    C,$-7     ; --+     on error ...
  6FC7'   CD 4036        C          CALL	SY.RESC
  6FCA'   EB             C          EX    DE,HL
  6FCB'   C9             C          RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      ;                       4 ASCII hexa (DE) --> Adresse (L,H) binaer (HL)
                         C      ;                                                            DE+4, HL+2
                         C      ;
                         C      ;                                       mit Datenfehler-Behandlung
                         C      ;                       -----------------------------------------------
  6FCC'                  C      UC.CVXA:
  6FCC'   23             C      	INC	HL
  6FCD'   CD 6FA0'       C      	CALL	UC.CVXB	; benutzt: A, 4 Stack-P.
  6FD0'   2B             C      	DEC	HL
  6FD1'   2B             C      	DEC	HL
  6FD2'   CD 6FA0'       C      	CALL	UC.CVXB
  6FD5'   23             C      	INC	HL
  6FD6'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      ;                     2 Byte binaer in HL ---> 1...5-stellig dezi (DE),
                         C      ;                                                             DE+1...5
                         C      ;                                  mit Vor-Null-Unterdrueckung
                         C      ;                                                    (nach nicht-dezi),
                         C      ;                                  zu wenig Stellen -->
                         C      ;                                      '*' in der obersten angeg.Stelle
                         C      ;                      ------------------------------------------------
  6FD7'                  C      UC.CVBD5:
  6FD7'   3E 05          C      	LD	A,5	; benutzt: A, 7 Stack-P.
  6FD9'   18 0E          C      	JR	$+16
  6FDB'                  C      UC.CVBD4:
  6FDB'   3E 04          C      	LD	A,4
  6FDD'   18 0A          C      	JR	$+12
  6FDF'                  C      UC.CVBD3:
  6FDF'   3E 03          C      	LD	A,3
  6FE1'   18 06          C      	JR	$+8
  6FE3'                  C      UC.CVBD2:
  6FE3'   3E 02          C      	LD	A,2
  6FE5'   18 02          C      	JR	$+4
  6FE7'                  C      UC.CVBD1:
  6FE7'   3E 01          C      	LD	A,1
                         C      			;
  6FE9'   C5             C      UC.CVBD:	PUSH	BC	; Zeichenzahl in A
  6FEA'   E5             C      	PUSH	HL
  6FEB'   47             C      	LD	B,A
  6FEC'   CD 6FF4'       C      	CALL	UC.CVBD0
  6FEF'   10 FB          C      	DJNZ	$-3
  6FF1'   E1             C      	POP	HL
  6FF2'   C1             C      	POP	BC
  6FF3'   C9             C      	RET
                         C      			;
                         C      ;                          Abspaltung B-te Stelle dezi von HL nach (DE)
                         C      ;                                                                  DE+1
                         C      ;                          B-te nicht fuehrende Stelle: '*' nach (DE)
                         C      ;                          --------------------------------------------
  6FF4'                  C      UC.CVBD0:
  6FF4'   C5             C      	PUSH	BC	; benutzt: A, 5 Stack-P.
                         C      			; --------
  6FF5'   7D             C      	LD	A,L
  6FF6'   F6 30          C      	OR	'0'
'Konvertierungen'	MACRO-80 3.44	09-Dec-81	PAGE	1-73


  6FF8'   05             C      	DEC	B
  6FF9'   28 29          C          JR   Z,$+43	  ; -------+
                         C                        ;        |
  6FFB'   D5             C          PUSH DE       ;        |
  6FFC'   E5             C          PUSH HL       ; DE := (B-1)-te Zehner-Potenz
  6FFD'   21 0001        C          LD   HL,1     ;        |
  7000'   CD 6F32'       C          CALL UC.HL10N ;        |
  7003'   10 FB          C          DJNZ $-3      ;        |
  7005'   EB             C          EX   DE,HL    ;        |
  7006'   E1             C          POP  HL       ;        |
                         C                        ;        |
  7007'   CD 6F52'       C          CALL UC.DIVR  ; A := HL / B-te Zehner-Potenz
  700A'   D1             C          POP  DE       ;        |     HL := Rest
                         C                        ;        |
  700B'   FE 0A          C          CP   10       ; test to decimal
  700D'   38 04          C          JR   C,$+6    ; ---+   |
  700F'   3E 2A          C          LD   A,'*'    ;    |   |
  7011'   18 11          C          JR   $+19     ; -------+
                         C                        ; <--+   |
  7013'   F6 30          C          OR   '0'      ; conv.to decimal
                         C                        ;        |
  7015'   FE 30          C          CP   '0'      ; Vor-Null ?
  7017'   20 0B          C          JR   NZ,$+13  ; -------+
  7019'   1B             C          DEC  DE       ;        |
  701A'   4F             C          LD   C,A      ;        |
  701B'   CD 7051'       C          CALL UC.CVD1B ;        |
  701E'   79             C          LD   A,C      ;        |
  701F'   13             C          INC  DE       ;        |
  7020'   30 02          C          JR   NC,$+4   ;        |
  7022'   3E 20          C          LD   A,' '    ;        |
                         C                        ; <------+
  7024'   12             C      	LD	(DE),A
  7025'   13             C      	INC	DE
  7026'   C1             C      	POP	BC
  7027'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      ;                      Dezi von (DE) bis (-->DE) nicht-dezi
                         C      ;                                                --->      binaer in HL
                         C      ;
                         C      ;                         Fehler:
                         C      ;                         -------
                         C      ;                         Cy, NZ: Zahl zu gross, HL ohne letzte Ziffer
                         C      ;                         Cy, Z:  Leere Zahl (1.Position keine Ziffer),
                         C      ;                                        -->     HL = 0
                         C      ;                      ------------------------------------------------
  7028'                  C      UC.CVDB:
  7028'   26 00          C      	LD	H,0
  702A'   CD 7051'       C      	CALL	UC.CVD1B
  702D'   6F             C      	LD	L,A
  702E'   30 04          C      	JR	NC,$+6
  7030'   AF             C      	XOR	A
  7031'   6F             C      	LD	L,A
  7032'   37             C      	SCF
  7033'   C9             C      	RET		; ---> abend C, Z
                         C      			;
  7034'   13             C      	INC	DE
  7035'   CD 7051'       C      	CALL	UC.CVD1B
  7038'   3F             C      	CCF
  7039'   D0             C      	RET	NC		; ---> normal end
  703A'   D5             C          PUSH  DE
  703B'   F5             C          PUSH  AF
  703C'   CD 6F39'       C          CALL  UC.HL10C
  703F'   38 0B          C          JR    C,$+13    ; ----------+
  7041'   F1             C          POP   AF        ;           |
  7042'   85             C          ADD   A,L       ;           |
  7043'   6F             C          LD    L,A       ;           |
  7044'   30 03          C          JR    NC,$+5	; --+       |
  7046'   24             C          INC   H         ;   |       |
  7047'   28 04          C          JR    Z,$+6     ;   |    ---|--+
  7049'   D1             C          POP   DE        ; <-+       |  |
  704A'   18 E8          C          JR    $-22      ;           |  |
                         C                          ;      <----+  !
  704C'   E1             C          POP   HL        ; abend Cy, NZ !
  704D'   25             C          DEC   H         ;              |
  704E'   EB             C          EX    DE,HL     ;        <-----+
  704F'   D1             C          POP   DE
  7050'   C9             C          RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      ;                            Ziffer dezi (DE) ---> binaer nach A, DE+1
                         C      ;                                                  Cy: nicht-dezi
                         C      ;                            ------------------------------------------
'Konvertierungen'	MACRO-80 3.44	09-Dec-81	PAGE	1-74


  7051'                  C      UC.CVD1B:
  7051'   1A             C      	LD	A,(DE)
  7052'   D6 30          C      	SUB	30H
  7054'   D8             C      	RET	C
  7055'   FE 0A          C      	CP	10
  7057'   3F             C      	CCF
  7058'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      ;                    Byte binaer (HL) --> Byte ASCII-Symbol (DE)
                         C      ;                                         (sonst: 7FH )
                         C      ;                                                     HL+1, DE+1
                         C      ;                    --------------------------------------------------
  7059'                  C      UC.CVBC:
  7059'   7E             C      	LD	A,(HL)	; benutzt: A, 0 Stack-P.
  705A'   23             C      	INC	HL	; --------
  705B'   FE 20          C      	CP	20H
  705D'   30 02          C      	JR	NC,$+4
  705F'   3E 7F          C      	LD	A,7FH
  7061'   FE 7F          C      	CP	7FH
  7063'   38 02          C      	JR	C,$+4
  7065'   3E 7F          C      	LD	A,7FH
  7067'   12             C      	LD	(DE),A
  7068'   13             C      	INC	DE
  7069'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      ;                       Byte ASCII-Symbol (DE)   -->   Byte binaer (HL)
                         C      ;                                                      DE+1, HL+1
                         C      ;                       -----------------------------------------------
  706A'                  C      UC.CVCB:
  706A'   1A             C      	LD	A,(DE)	; benutzt: A, 0 Stack-P.
  706B'   13             C      	INC	DE
  706C'   FE 20          C      	CP	20H
  706E'   38 05          C      	JR	C,$+7
  7070'   FE 7E          C      	CP	7EH
  7072'   30 01          C      	JR	NC,$+3
  7074'   77             C      	LD	(HL),A
  7075'   23             C      	INC	HL
  7076'   C9             C      	RET
                         C      			;
                         C      
                         C      ;**********************************************************************
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;      KONVERTIERUNGEN
                         C      ;
                         C      ;----------------------------------------------------------------------
  7077'                  C      UC.DKONV:
  7077'   7E             C      	LD	A,(HL)	;DKOI--->ASCII
  7078'   CD 708B'       C      	CALL	UC.DK1	;(HL)--->(DE)
  707B'   12             C      	LD	(DE),A
  707C'   23             C      	INC	HL
  707D'   13             C      	INC	DE
  707E'   10 F7          C      	DJNZ	UC.DKONV
  7080'   C9             C      	RET
                         C      ;------------------------------------
  7081'                  C      UC.KONV:
  7081'   7E             C      	LD	A,(HL)	;ASCII--->DKOI
  7082'   CD 7096'       C      	CALL	UC.CKONV	;(HL) --->(DE)
  7085'   12             C      	LD	(DE),A
  7086'   23             C      	INC	HL
  7087'   13             C      	INC	DE
  7088'   10 F7          C      	DJNZ	UC.KONV
  708A'   C9             C      	RET
                         C      ;-----------------------------
  708B'                  C      UC.DK1:
  708B'   E5             C      	PUSH	HL	;DKOI--->ASCII
  708C'   D5             C      	PUSH	DE
  708D'   C5             C      	PUSH	BC
  708E'   21 70B9'       C      	LD	HL,UC.ASCCO
  7091'   11 7119'       C      	LD	DE,UC.DKOI
  7094'   18 09          C      	JR	UC.DK2
  7096'                  C      UC.CKONV:
  7096'   E5             C      	PUSH	HL	;ASCII ---> DKOI
  7097'   D5             C      	PUSH	DE
  7098'   C5             C      	PUSH	BC
  7099'   21 7119'       C      	LD	HL,UC.DKOI	;HL:= Anfangsadresse
  709C'   11 70B9'       C      	LD	DE,UC.ASCCO	;DE:= Anfangsadresse
  709F'                  C      UC.DK2:
  709F'   F5             C      	PUSH	AF	;Quellcodebyte retten
  70A0'   AF             C      	XOR	A	;CY = 0
  70A1'   ED 52          C      	SBC	HL,DE	;Tabellendistanz berechnen
'Konvertierungen'	MACRO-80 3.44	09-Dec-81	PAGE	1-75


  70A3'   2B             C      	DEC	HL
  70A4'   E5             C      	PUSH	HL
  70A5'   C1             C      	POP	BC	;BC:= Tabellendistanz - 1
  70A6'   EB             C      	EX	DE,HL	;HL:= Anfangsadresse
  70A7'   F1             C      	POP	AF	;Zeichen wieder herstellen
  70A8'   C5             C      	PUSH	BC	;Tabellendistanz retten
  70A9'   01 0060        C      	LD	BC,UE.COTAL	;BC:= Tabellenlaenge
  70AC'   ED B1          C      	CPIR		;Quellcodebyte suchen
  70AE'   37             C      	SCF		;CY = 1
  70AF'   C1             C      	POP	BC	;Tabellendistanz auskellern
  70B0'   20 03          C      	JR	NZ,UC.KONV2	;---> Quellcodebyte nicht
  70B2'   09             C      	ADD	HL,BC	;Zielcodeadresse berechnen
  70B3'   AF             C      	XOR	A	;CY = 0
  70B4'   7E             C      	LD	A,(HL)	;Zielcodebyte laden
  70B5'                  C      UC.KONV2:
  70B5'   C1             C      	POP	BC
  70B6'   D1             C      	POP	DE
  70B7'   E1             C      	POP	HL
  70B8'   C9             C      	RET
                         C      ;****************************************************************
                         C      ;         ASCII - Codetabelle
                         C      ;****************************************************************
  70B9'                  C      UC.ASCCO:
  70B9'   20 21 22 23    C      	DB	' !"#$%&'
  70BD'   24 25 26       C      
  70C0'   27             C      	DB	27H	;'
  70C1'   28 29 2A 2B    C      	DB	'()*+,-./'
  70C5'   2C 2D 2E 2F    C      
  70C9'   30 31 32 33    C      	DB	'0123456789'
  70CD'   34 35 36 37    C      
  70D1'   38 39          C      
  70D3'   3A 3B 3C 3D    C      	DB	':;<=>?@'
  70D7'   3E 3F 40       C      
  70DA'   41 42 43 44    C      	DB	'ABCDEFGHIJKLMNOPQRSTUVWXYZ'
  70DE'   45 46 47 48    C      
  70E2'   49 4A 4B 4C    C      
  70E6'   4D 4E 4F 50    C      
  70EA'   51 52 53 54    C      
  70EE'   55 56 57 58    C      
  70F2'   59 5A          C      
  70F4'   5B 5C 5D 5E    C      	DB	'[\]^_`'
  70F8'   5F 60          C      
  70FA'   61 62 63 64    C      	DB	'abcdefghijklmnopqrstuvwxyz'
  70FE'   65 66 67 68    C      
  7102'   69 6A 6B 6C    C      
  7106'   6D 6E 6F 70    C      
  710A'   71 72 73 74    C      
  710E'   75 76 77 78    C      
  7112'   79 7A          C      
  7114'   7B 7C 7D 7E    C      	DB	'{|}~'
  7118'   7F             C      	DB	7FH	;DEL
                         C      ;***************************************************************
                         C      ;         DKOI - Codetabelle
                         C      ;***************************************************************
  7119'                  C      UC.DKOI:
  7119'   40             C      	DB	40H	;blank
  711A'   4F             C      	DB	4FH	;!
  711B'   7F             C      	DB	7FH	;"
  711C'   7B             C      	DB	7BH	;#
  711D'   5B             C      	DB	5BH	;$
  711E'   6C             C      	DB	6CH	;%
  711F'   50             C      	DB	50H	;&
  7120'   7D             C      	DB	7DH	;'
  7121'   4D             C      	DB	4DH	;(
  7122'   5D             C      	DB	5DH	;)
  7123'   5C             C      	DB	5CH	;*
  7124'   4E             C      	DB	4EH	;+
  7125'   6B             C      	DB	6BH	;,
  7126'   60             C      	DB	60H	;-
  7127'   4B             C      	DB	4BH	;.
  7128'   61             C      	DB	61H	;/
  7129'   F0             C      	DB	0F0H	;0
  712A'   F1             C      	DB	0F1H	;1
  712B'   F2             C      	DB	0F2H	;2
  712C'   F3             C      	DB	0F3H	;3
  712D'   F4             C      	DB	0F4H	;4
  712E'   F5             C      	DB	0F5H	;5
  712F'   F6             C      	DB	0F6H	;6
  7130'   F7             C      	DB	0F7H	;7
  7131'   F8             C      	DB	0F8H	;8
  7132'   F9             C      	DB	0F9H	;9
  7133'   7A             C      	DB	7AH	;:
  7134'   5E             C      	DB	5EH	;;
'Konvertierungen'	MACRO-80 3.44	09-Dec-81	PAGE	1-76


  7135'   4C             C      	DB	4CH	;<
  7136'   7E             C      	DB	7EH	;=
  7137'   6E             C      	DB	6EH	;>
  7138'   6F             C      	DB	6FH	;?
  7139'   7C             C      	DB	7CH	;@
  713A'   C1             C      	DB	0C1H	;A
  713B'   C2             C      	DB	0C2H	;B
  713C'   C3             C      	DB	0C3H	;C
  713D'   C4             C      	DB	0C4H	;D
  713E'   C5             C      	DB	0C5H	;E
  713F'   C6             C      	DB	0C6H	;F
  7140'   C7             C      	DB	0C7H	;G
  7141'   C8             C      	DB	0C8H	;H
  7142'   C9             C      	DB	0C9H	;I
  7143'   D1             C      	DB	0D1H	;J
  7144'   D2             C      	DB	0D2H	;K
  7145'   D3             C      	DB	0D3H	;L
  7146'   D4             C      	DB	0D4H	;M
  7147'   D5             C      	DB	0D5H	;N
  7148'   D6             C      	DB	0D6H	;O
  7149'   D7             C      	DB	0D7H	;P
  714A'   D8             C      	DB	0D8H	;Q
  714B'   D9             C      	DB	0D9H	;R
  714C'   E2             C      	DB	0E2H	;S
  714D'   E3             C      	DB	0E3H	;T
  714E'   E4             C      	DB	0E4H	;U
  714F'   E5             C      	DB	0E5H	;V
  7150'   E6             C      	DB	0E6H	;W
  7151'   E7             C      	DB	0E7H	;X
  7152'   E8             C      	DB	0E8H	;Y
  7153'   E9             C      	DB	0E9H	;Z
  7154'   4A             C      	DB	4AH	;[
  7155'   E0             C      	DB	0E0H	;\
  7156'   5A             C      	DB	5AH	;]
  7157'   5F             C      	DB	5FH	;^
  7158'   6D             C      	DB	6DH	;_
  7159'   79             C      	DB	79H	;`
  715A'   81             C      	DB	81H	;a
  715B'   82             C      	DB	82H	;b
  715C'   83             C      	DB	83H	;c
  715D'   84             C      	DB	84H	;d
  715E'   85             C      	DB	85H	;e
  715F'   86             C      	DB	86H	;f
  7160'   87             C      	DB	87H	;g
  7161'   88             C      	DB	88H	;h
  7162'   89             C      	DB	89H	;i
  7163'   91             C      	DB	91H	;j
  7164'   92             C      	DB	92H	;k
  7165'   93             C      	DB	93H	;l
  7166'   94             C      	DB	94H	;m
  7167'   95             C      	DB	95H	;n
  7168'   96             C      	DB	96H	;o
  7169'   97             C      	DB	97H	;p
  716A'   98             C      	DB	98H	;q
  716B'   99             C      	DB	99H	;r
  716C'   A2             C      	DB	0A2H	;s
  716D'   A3             C      	DB	0A3H	;t
  716E'   A4             C      	DB	0A4H	;u
  716F'   A5             C      	DB	0A5H	;v
  7170'   A6             C      	DB	0A6H	;w
  7171'   A7             C      	DB	0A7H	;x
  7172'   A8             C      	DB	0A8H	;y
  7173'   A9             C      	DB	0A9H	;z
  7174'   C0             C      	DB	0C0H	;{
  7175'   6A             C      	DB	6AH	;|
  7176'   D0             C      	DB	0D0H	;}
  7177'   A1             C      	DB	0A1H	;~
  7178'   FF             C      	DB	0FFH	;DEL
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Komprimierung'
                         C      	PAGE
'Komprimierung'	MACRO-80 3.44	09-Dec-81	PAGE	1-77


                         C      
                         C      ;	PN	CP
                         C      ;**********************************************************************
                         C      ;*       COMPR:    Komprimierung                                      *
                         C      ;*                 EDIT - F/Q-Format   --->  MRES20 - Quelltextformat *
                         C      ;**********************************************************************
                         C      			;
  7179'                  C      CP.COMPR	EQU	$	; A  Uebergabe/-nahme Zeichen
                         C      			; HL: Status von COMPR
                         C      			; B:  dekr. Tabulator-Zaehler
                         C      			;-------------------------------
                         C      			; OUTA: Einzelzeichen-Ausgabe
                         C      			;         (Zeichen in Reg. A)
                         C      ;----------------------------------------------------------------------
                         C      			;
  7179'   FE 1E          C      	CP	1EH	; NL ?
  717B'   28 01          C      	JR	Z,CP.NL
  717D'   E9             C      	JP	(HL)
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      			; Status "New-Line"
                         C      			;-------------------------------
  717E'                  C      CP.NL:
  717E'   CD 6F08'       C      	CALL	XY.INCDX	;         Satz-Zaehler + 1
  7181'   13             C      	DB	19
  7182'   06 03          C      	LD	B,3	;         noch 3 TAB erlaubt
  7184'   3E 0A          C      	LD	A,0AH	;         MRES20-NL
  7186'   18 04          C      	JR	CP.OUTT
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      			; Status "String"
                         C      			;-------------------------------
  7188'                  C      CP.STRNG:
  7188'   FE 27          C      	CP	27H	;         Apostroph
  718A'   20 20          C      	JR	NZ,CP.OUT
                         C      			;
  718C'                  C      CP.OUTT:
  718C'   21 719C'       C      	LD	HL,CP.TEXT	;         --> Status "Text"
  718F'   18 1B          C      	JR	CP.OUT
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      			; Status "Space"
                         C      			;-------------------------------
  7191'                  C      CP.SPACE:
  7191'   FE 20          C      	CP	' '
  7193'   C8             C      	RET	Z
  7194'   FE 09          C      	CP	09H	;         Tabulator
  7196'   C8             C      	RET	Z
  7197'   21 719C'       C      	LD	HL,CP.TEXT	;         ---> Status "Text"
  719A'   18 08          C      	JR	CP.TEXT+8
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      			; Status "Text"
                         C      			;-------------------------------
  719C'                  C      CP.TEXT:
  719C'   FE 20          C      	CP	' '
  719E'   28 2E          C      	JR	Z,CP.TAB
  71A0'   FE 09          C      	CP	09H	;         Tabulator
  71A2'   28 2A          C      	JR	Z,CP.TAB
  71A4'   FE 3B          C      	CP	';'
  71A6'   28 0B          C      	JR	Z,CP.SOKOM
  71A8'   FE 27          C      	CP	27H	;         Apostroph
  71AA'   28 1D          C      	JR	Z,CP.SOSTR
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      			; Status "Kom"
                         C      			;-------------------------------
  71AC'                  C      CP.KOM	EQU	$
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      			; Einzelzeichen-Ausgabe u. Ret.
                         C      			;-------------------------------
  71AC'                  C      CP.OUT:
  71AC'   CD 72C8'       C      	CALL	UK.PUTK
  71AF'   D9             C      	EXX
  71B0'   0B             C      	DEC	BC
  71B1'   D9             C      	EXX
  71B2'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      			; Start "Kommentar"
                         C      			;-------------------------------
'Komprimierung'	MACRO-80 3.44	09-Dec-81	PAGE	1-78


  71B3'                  C      CP.SOKOM:
  71B3'   78             C          LD	A,B	;         0 oder 3 TAB vorher
  71B4'   FE 03          C          CP   3
  71B6'   28 0A          C          JR   Z,$+12
  71B8'   B7             C          OR   A
  71B9'   28 07          C          JR   Z,$+9      ;         ---+
  71BB'   3E 09          C          LD   A,09H      ;         <-+|
  71BD'   CD 71AC'       C          CALL CP.OUT     ;           ||
  71C0'   10 F9          C          DJNZ $-5        ;         --+|
  71C2'   3E 3B          C          LD   A,';'      ;         <--+
  71C4'   21 71AC'       C          LD   HL,CP.KOM
  71C7'   18 E3          C          JR   CP.OUT
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      			; Start "String"
                         C      			;-------------------------------
  71C9'                  C      CP.SOSTR:
  71C9'   21 7188'       C      	LD	HL,CP.STRNG
  71CC'   18 DE          C      	JR	CP.OUT
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      			; Tabulator-Behandlung
                         C      			;-------------------------------
  71CE'                  C      CP.TAB:
  71CE'   78             C      	LD	A,B
  71CF'   B7             C      	OR	A
  71D0'   3E 20          C      	LD	A,' '
  71D2'   28 D8          C      	JR	Z,CP.OUT
  71D4'   05             C      	DEC	B
  71D5'   3E 09          C      	LD	A,09H	;         Tabulator MRES20
  71D7'   21 7191'       C      	LD	HL,CP.SPACE
  71DA'   18 D0          C      	JR	CP.OUT
                         C      			;
                         C      ;**********************************************************************
                         C      			;
  71DC'                  C      CP.INIT:
  71DC'   06 03          C      	LD	B,3	; Initialisierung COMPR
  71DE'   21 719C'       C      	LD	HL,CP.TEXT
  71E1'   C9             C      	RET
                         C      			;
                         C      ;**********************************************************************
                         C      ;	END
                         C      	TITLE	'Dekomprimierung'
                         C      	PAGE
'Dekomprimierung'	MACRO-80 3.44	09-Dec-81	PAGE	1-79


                         C      
                         C      ;	PN	DC
                         C      ;**********************************************************************
                         C      ;*       DCMPR:    Dekomprimierung                                    *
                         C      ;*                 MRES20-Quelltexte   --->   EDIT - Format F         *
                         C      ;**********************************************************************
                         C      			;
  71E2'                  C      DC.DCMPR	EQU	$
                         C      			; A:  Uebergabe/-nahme Zeichen
                         C      			; HL: Status-Register DCMPR
                         C      			; B:  Position (Spalte)
                         C      			;-------------------------------
                         C      			; INA: Einzelzeichen-Eingabe
                         C      			;      nach Reg. A
                         C      ;        --------------------------------------------------------------
  71E2'   04             C      	INC	B	;         Position + 1
  71E3'   E9             C      	JP	(HL)
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      			; Status "Neue Zeile"
                         C      			;-------------------------------
  71E4'                  C      DC.NL:
  71E4'   CD 6F08'       C      	CALL	XY.INCDX	;         Satzzaehler + 1
  71E7'   13             C      	DB	19
  71E8'   3E 1E          C      	LD	A,1EH	;         EDIT-New-Line
  71EA'   06 01          C      	LD	B,1	;         Pos.=1
  71EC'   21 71F0'       C      	LD	HL,DC.TEXT	;         Status "TEXT"
  71EF'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      			; Status "Text"
                         C      			;-------------------------------
  71F0'                  C      DC.TEXT:
  71F0'   CD 7223'       C      	CALL	UK.GETK	;         Einzelzeichen-Eingabe
  71F3'   B7             C      	OR	A
  71F4'   C8             C      	RET	Z
  71F5'   FE 0A          C      	CP	0AH	;         NL ?
  71F7'   28 EB          C      	JR	Z,DC.NL
  71F9'   FE 09          C      	CP	09H	;         TAB ?
  71FB'   28 01          C      	JR	Z,DC.TAB
  71FD'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      			; Tabulator-Behandlung
                         C      			;-------------------------------
  71FE'                  C      DC.TAB:
  71FE'   78             C      	LD	A,B
  71FF'   FE 28          C      	CP	40
  7201'   D0             C      	RET	NC
  7202'   21 7208'       C      	LD	HL,DC.SPACE	;         ---> Status "Space"
  7205'   3E 20          C      	LD	A,' '	;         anstelle TAB Space
  7207'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      			; Status "Space"
                         C      			;-------------------------------
  7208'                  C      DC.SPACE:
  7208'   78             C      	LD	A,B
  7209'   FE 0B          C      	CP	10+1
  720B'   28 0B          C      	JR	Z,DC.EOSPC
  720D'   FE 11          C      	CP	16+1
  720F'   28 07          C      	JR	Z,DC.EOSPC
  7211'   FE 24          C      	CP	35+1
  7213'   28 03          C      	JR	Z,DC.EOSPC
  7215'   3E 20          C      	LD	A,' '
  7217'   C9             C      	RET
                         C      			;
  7218'                  C      DC.EOSPC:
  7218'   21 71F0'       C      	LD	HL,DC.TEXT	; TAB-Position erreicht
  721B'   18 D3          C      	JR	DC.TEXT
                         C      			;
                         C      			;
                         C      ;**********************************************************************
  721D'                  C      DC.INIT:
  721D'   21 71F0'       C      	LD	HL,DC.TEXT	; Initialisierung
  7220'   06 01          C      	LD	B,1
  7222'   C9             C      	RET
                         C      			;
                         C      ;**********************************************************************
                         C      ;	END
                         C      	TITLE	'Einzelzeicheneingabe fuer KMBG'
                         C      	PAGE
'Einzelzeicheneingabe fuer KMBG'	MACRO-80 3.44	09-Dec-81	PAGE	1-80


                         C      
                         C      ;	PN	UK
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;        Einzelzeicheneingabe fuer KMBG
                         C      ;
                         C      ;----------------------------------------------------------------------
                         C      ;
  7223'                  C      UK.GETK:
  7223'   CD 6CC6'       C      	CALL	U1.RSAVE
  7226'   CD 6ED8'       C      	CALL	XY.LIDX	;HL:= Blocklaenge
  7229'   09             C      	DB	9
  722A'   E5             C      	PUSH	HL
  722B'   CD 6EC8'       C      	CALL	XY.LDDX
  722E'   17             C      	DB	23
  722F'   EB             C      	EX	DE,HL	;DE:= Pufferzaehler
  7230'   AF             C      	XOR	A
  7231'   E1             C      	POP	HL	;HL:= Blocklaenge
  7232'   ED 52          C      	SBC	HL,DE
  7234'   E5             C      	PUSH	HL	;Restbyteanzahl retten
  7235'   7C             C      	LD	A,H
  7236'   B5             C      	OR	L
  7237'   CC 7283'       C      	CALL	Z,UK.KBW	;Block lesen
  723A'   E1             C      	POP	HL
  723B'   AF             C      	XOR	A
  723C'   BC             C      	CP	H
  723D'   20 05          C      	JR	NZ,UK.GETK2
  723F'   7D             C      	LD	A,L
  7240'   FE 01          C      	CP	1
  7242'   28 08          C      	JR	Z,UK.GETK3	;---> letztes Datenbyte des
  7244'                  C      UK.GETK2:
  7244'   CD 7252'       C      	CALL	UK.GETK4
  7247'   B7             C      	OR	A
  7248'                  C      UK.GETK5:
  7248'   CD 6CCE'       C      	CALL	U1.RRST
  724B'   C9             C      	RET
                         C      ;
                         C      ;
  724C'                  C      UK.GETK3:
  724C'   CD 7252'       C      	CALL	UK.GETK4
  724F'   37             C      	SCF
  7250'   18 F6          C      	JR	UK.GETK5
                         C      ;
  7252'                  C      UK.GETK4:
  7252'   CD 6EC8'       C      	CALL	XY.LDDX	;HL:= aktuelle Pufferadresse
  7255'   15             C      	DB	21
  7256'   7E             C      	LD	A,(HL)	;Datenbyte laden
  7257'   CD 6F08'       C      	CALL	XY.INCDX	;Pufferzeiger erhoehen
  725A'   15             C      	DB	21
  725B'   CD 6F08'       C      	CALL	XY.INCDX	;Pufferzaehler erhoehen
  725E'   17             C      	DB	23
  725F'   C9             C      	RET
                         C      ;
                         C      ;******************************************************************
                         C      ;
                         C      ;        KMBG  Eingabepuffer bereitstellen
                         C      ;
                         C      ;*******************************************************************
                         C      ;
  7260'                  C      UK.KLPFB:
  7260'   CD 6CC6'       C      	CALL	U1.RSAVE
  7263'   CD 6DC2'       C      	CALL	U1.KTIN1
  7266'   21 0100        C      	LD	HL,100H	;max. Blocklaenge Kassette	;??? zentral definieren!!!
  7269'   CD 6EF8'       C      	CALL	XY.STIDX	;max. Blocklaenge initialisieren
  726C'   09             C      	DB	9
  726D'   E5             C      	PUSH	HL
  726E'   C1             C      	POP	BC	;BC:= Blocklaenge
  726F'   CD 6EE8'       C      	CALL	XY.STDX	;Pufferzaehler "Leer"
  7272'   17             C      	DB	23
  7273'   21 0E66        C      	LD	HL,UE.PUF	;Systempuffer Kassette
  7276'   CD 6CD7'       C      	CALL	U1.CLRB	;Systempuffer loeschen
  7279'   21 8010        C      	LD	HL,UE.KPUFF
  727C'   CD 6CD7'       C      	CALL	U1.CLRB
  727F'   CD 6CCE'       C      	CALL	U1.RRST
  7282'   C9             C      	RET
                         C      ;
                         C      ;******************************************************************
                         C      ;
                         C      ;        Einlesen eines Blockes von Kassette
                         C      ;
                         C      ;         - Besonderheit gegenueber MBW: Blockinhalt wird vom
                         C      ;           Systempuffer in den E/A-Puffer uebertragen
'Einzelzeicheneingabe fuer KMBG'	MACRO-80 3.44	09-Dec-81	PAGE	1-81


                         C      ;
                         C      ;*******************************************************************
                         C      ;
  7283'                  C      UK.KBW:
  7283'   CD 6CC6'       C      	CALL	U1.RSAVE
  7286'   CD 7260'       C      	CALL	UK.KLPFB
  7289'   DD 36 04 02    C      	LD	(IX+4),02H
  728D'   CD 5675'       C      	CALL	UF.EXEC
  7290'   DD 7E 09       C      	LD	A,(IX+9)	;??? EOF anders ermitteln !!!
  7293'   DD B6 0A       C      	OR	(IX+10)
  7296'   28 2A          C      	JR	Z,UK.KBW1	;EOF
  7298'   CD 6EC8'       C      	CALL	XY.LDDX	;HL:= Blockadresse
  729B'   07             C      	DB	7
  729C'   DD 46 09       C      	LD	B,(IX+9)	;BC:= Blocklaenge
  729F'   DD 4E 0A       C      	LD	C,(IX+10)
  72A2'   E5             C      	PUSH	HL	;E/A-Puffer
  72A3'   CD 6EC8'       C      	CALL	XY.LDDX
  72A6'   19             C      	DB	25
  72A7'   EB             C      	EX	DE,HL
  72A8'   E1             C      	POP	HL
  72A9'   ED B0          C      	LDIR		;Transport in E/A-Puffer
  72AB'   CD 6EC8'       C      	CALL	XY.LDDX
  72AE'   19             C      	DB	25
  72AF'   CD 6EE8'       C      	CALL	XY.STDX	;Pufferzeiger auf Anfang
  72B2'   15             C      	DB	21
  72B3'   21 0000        C      	LD	HL,0
  72B6'   CD 6EE8'       C      	CALL	XY.STDX	;Pufferzaehler rueckstellen
  72B9'   17             C      	DB	23
  72BA'   CD 6F08'       C      	CALL	XY.INCDX	;Blockzaehler incrementieren
  72BD'   11             C      	DB	17
  72BE'                  C      UK.KBW2:
  72BE'   CD 6CCE'       C      	CALL	U1.RRST
  72C1'   C9             C      	RET
                         C      ;
  72C2'                  C      UK.KBW1:
  72C2'   CD 6F08'       C      	CALL	XY.INCDX	;Labelzaehler incrementieren
  72C5'   11             C      	DB	17
  72C6'   18 F6          C      	JR	UK.KBW2
                         C      ;
                         C      ;********************************************************************
                         C      ;
                         C      ;        Einzelzeichenausgabe fuer KMBG
                         C      ;
                         C      ;*********************************************************************
                         C      ;
  72C8'                  C      UK.PUTK:
  72C8'   CD 6CC6'       C      	CALL	U1.RSAVE
  72CB'   F5             C      	PUSH	AF	;Zeichen retten
  72CC'   CD 6EC8'       C      	CALL	XY.LDDX	;HL:= Pufferzaehler
  72CF'   17             C      	DB	23
  72D0'   01 0132        C      	LD	BC,UE.KMPUL	;BC:= max. Pufferlaenge
  72D3'   B7             C      	OR	A
  72D4'   ED 42          C      	SBC	HL,BC
  72D6'   3F             C      	CCF
  72D7'   CC 7311'       C      	CALL	Z,UK.KBA	;---> Puffer voll
  72DA'   F1             C      	POP	AF	;Zeichen auskellern
  72DB'   CD 6EC8'       C      	CALL	XY.LDDX
  72DE'   15             C      	DB	21
  72DF'   77             C      	LD	(HL),A	;Zeichen in Puffer eintragen
  72E0'   CD 6F08'       C      	CALL	XY.INCDX	;Pufferzeiger erhoehen
  72E3'   15             C      	DB	21
  72E4'   CD 6F08'       C      	CALL	XY.INCDX	;Pufferzaehler erhoehen
  72E7'   17             C      	DB	23
  72E8'   CD 6CCE'       C      	CALL	U1.RRST
  72EB'   C9             C      	RET
                         C      ;
                         C      ;******************************************************************
                         C      ;
                         C      ;        Ausgabepufferbereitstellung fuer KMBG
                         C      ;
                         C      ;*******************************************************************
                         C      ;
  72EC'                  C      UK.KSPFB:
  72EC'   CD 6CC6'       C      	CALL	U1.RSAVE
  72EF'   CD 6DC2'       C      	CALL	U1.KTIN1
  72F2'   CD 6ED8'       C      	CALL	XY.LIDX
  72F5'   09             C      	DB	9
  72F6'   E5             C      	PUSH	HL
  72F7'   C1             C      	POP	BC	;BC:= Blocklaenge
  72F8'   21 0000        C      	LD	HL,0
  72FB'   CD 6EE8'       C      	CALL	XY.STDX	;Pufferzaehler = 0
  72FE'   17             C      	DB	23
  72FF'   CD 6EC8'       C      	CALL	XY.LDDX
'Einzelzeicheneingabe fuer KMBG'	MACRO-80 3.44	09-Dec-81	PAGE	1-82


  7302'   19             C      	DB	25
  7303'   CD 6EE8'       C      	CALL	XY.STDX	;Pufferzeiger setzen
  7306'   15             C      	DB	21
  7307'   21 0E66        C      	LD	HL,UE.PUF
  730A'   CD 6CD7'       C      	CALL	U1.CLRB
  730D'   CD 6CCE'       C      	CALL	U1.RRST
  7310'   C9             C      	RET
                         C      ;
                         C      ;*******************************************************************
                         C      ;
                         C      ;        Ausgabe eines Blockes auf KMBG
                         C      ;
                         C      ;*******************************************************************
                         C      ;
  7311'                  C      UK.KBA:
  7311'   CD 6CC6'       C      	CALL	U1.RSAVE
  7314'   CD 72EC'       C      	CALL	UK.KSPFB
  7317'   CD 6EC8'       C      	CALL	XY.LDDX
  731A'   07             C      	DB	7
  731B'   EB             C      	EX	DE,HL	;DE:= Blockadresse
  731C'   D5             C      	PUSH	DE	;Blockadresse retten
  731D'   CD 6ED8'       C      	CALL	XY.LIDX
  7320'   09             C      	DB	9
  7321'   E5             C      	PUSH	HL
  7322'   C1             C      	POP	BC	;BC:= Blocklaenge
  7323'   D1             C      	POP	DE	;DE:= Blockadresse
  7324'   C5             C      	PUSH	BC	;Blocklaenge retten
  7325'   CD 6EC8'       C      	CALL	XY.LDDX	;HL:= E/A-Pufferanfang
  7328'   19             C      	DB	25
  7329'   ED B0          C      	LDIR		;Block in Systempuffer
  732B'   C1             C      	POP	BC	;BC:= Blocklaenge
  732C'   E5             C      	PUSH	HL	;aktuelle Pufferadresse retten
  732D'   21 0132        C      	LD	HL,UE.KMPUL	;HL:= max. Laenge
  7330'   B7             C      	OR	A
  7331'   ED 42          C      	SBC	HL,BC	;HL:= Restbyteanzahl
  7333'   CD 6EE8'       C      	CALL	XY.STDX	;Pufferzaehler setzen
  7336'   17             C      	DB	23
  7337'   E5             C      	PUSH	HL
  7338'   C1             C      	POP	BC	;BC:= Restbyteanzahl
  7339'   CD 6EC8'       C      	CALL	XY.LDDX	;HL:= aktuelle Pufferadresse
  733C'   19             C      	DB	25
  733D'   EB             C      	EX	DE,HL	;DE:= Pufferanfang
  733E'   E1             C      	POP	HL
  733F'   ED B0          C      	LDIR
  7341'   EB             C      	EX	DE,HL	;HL:= aktuelle Pufferadresse
  7342'   CD 6EE8'       C      	CALL	XY.STDX	;Pufferzeiger setzen
  7345'   15             C      	DB	21
  7346'   DD 36 04 08    C      	LD	(IX+4),08H
  734A'   CD 5675'       C      	CALL	UF.EXEC	;physische Blockausgabe
  734D'   F5             C      	PUSH	AF
  734E'   CD 6F08'       C      	CALL	XY.INCDX	;Blockzaehler erhoehen
  7351'   11             C      	DB	17
  7352'   F1             C      	POP	AF
  7353'   CD 6CCE'       C      	CALL	U1.RRST
  7356'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                                ;
                         C      	INCLUDE KM.MAC
                         C      	TITLE	'Kmbg'
                         C      	PAGE
'Kmbg'	MACRO-80 3.44	09-Dec-81	PAGE	1-83


                         C      
                         C      ;	PN	KM01
                         C      ;****************************************************************
                         C      ;*                  DEG2000   V.1.2   ---   Programm:   K m b g *
                         C      ;*  Version         --------------------------------------------*
                         C      ;*                  Programmierer: R. Sieber   A d W            *
                         C      ;*  V 1 . 2         --------------------------------------------*
                         C      ;*                  Stand        : 25.Februar 1985              *
                         C      ;****************************************************************
                         C      
  7357'                  C      KM.ANF:
  7357'   7357'          C      	DW	$
  7359'   4B 6D 62 67    C      	DB	'Kmbg'
  735D'   21 754C'       C      	LD	HL,KM.DEL	;Taste:   D E L
  7360'   22 0D58        C      	LD	(SM.FKTAB+58H),HL
  7363'   21 750A'       C      	LD	HL,KM.ABS	;Taste:   A B S
  7366'   22 0D24        C      	LD	(SM.FKTAB+24H),HL
  7369'   21 73B5'       C      	LD	HL,KM.HOME	;Taste:   H O M E
  736C'   22 0D74        C      	LD	(SM.FKTAB+74H),HL
  736F'   21 73BF'       C      	LD	HL,KM.SL	;Taste:   SCH_LINKS
  7372'   22 0D26        C      	LD	(SM.FKTAB+26H),HL
  7375'   21 73CC'       C      	LD	HL,KM.SR	;Taste:   SCH_RECHTS
  7378'   22 0D36        C      	LD	(SM.FKTAB+36H),HL
  737B'   21 73A9'       C      	LD	HL,KM.CO	;Taste:   C_HOCH
  737E'   22 0D06        C      	LD	(SM.FKTAB+06H),HL
  7381'   21 73D1'       C      	LD	HL,KM.CR	;Taste:   C_RECHTS
  7384'   22 0D16        C      	LD	(SM.FKTAB+16H),HL
  7387'   21 73BA'       C      	LD	HL,KM.CU	;Taste:   C_RUNTER
  738A'   22 0D18        C      	LD	(SM.FKTAB+18H),HL
  738D'   21 73C7'       C      	LD	HL,KM.CL	;Taste:   C_LINKS
  7390'   22 0D08        C      	LD	(SM.FKTAB+08H),HL
  7393'   21 73D6'       C      	LD	HL,KM.CNZA	;Taste:   C N Z A
  7396'   22 0D76        C      	LD	(SM.FKTAB+76H),HL
  7399'   21 7406'       C      	LD	HL,KM.NEWL	;Taste:   E T 1
  739C'   22 0DAE        C      	LD	(KM.TNEWL),HL
  739F'   21 742B'       C      	LD	HL,KM.EINA	;alphanum. Tasten
  73A2'   22 0DB0        C      	LD	(KM.TEINA),HL
                         C      
                         C      	; LD	HL,KM.UP13
                         C      	; LD	DE,KM.RAM
                         C      	; LD	BC,KM.UPEND-KM.UP13
                         C      	; LDIR
                         C      
  73A5'   DD 21 2B03'    C      	LD	IX,KM.KMTAB
  73A9'                  C      KM.CO:
  73A9'   DD CB 00 7E    C      	BIT	7,(IX)
  73AD'   C2 75F4'       C      	JP	NZ,KM.UP4-KM.UP13+KM.RAM
  73B0'   CD 755A'       C      	CALL	KM.UP2	;KMBG Reservieren EIN
  73B3'   31             C      	DB	31H
  73B4'   C9             C      	RET
                         C      
                         C      	PAGE
'Kmbg'	MACRO-80 3.44	09-Dec-81	PAGE	1-84


                         C      
                         C      ;****************************************************************
                         C      ;*                  Auswertung der Cursor-Tasten                *
                         C      ;****************************************************************
  73B5'                  C      KM.HOME:
  73B5'   CD 7557'       C      	CALL	KM.UP1	;KMBG Kassette zurueckspulen
  73B8'   21             C      	DB	21H
  73B9'   C9             C      	RET
                         C      
  73BA'                  C      KM.CU:
  73BA'   CD 755A'       C      	CALL	KM.UP2	;KMBG Reservieren AUS
  73BD'   41             C      	DB	41H
  73BE'   C9             C      	RET
                         C      
  73BF'                  C      KM.SL:
  73BF'   CD 755A'       C      	CALL	KM.UP2	;KMBG vorh.  Datensatz anzeigen
  73C2'   15             C      	DB	15H
  73C3'   CD 7557'       C      	CALL	KM.UP1
  73C6'   02             C      	DB	2
  73C7'                  C      KM.CL:
  73C7'   CD 755A'       C      	CALL	KM.UP2	;KMBG einen  Datensatz zuruecksetzen
  73CA'   15             C      	DB	15H
  73CB'   C9             C      	RET
                         C      
  73CC'                  C      KM.SR:
  73CC'   CD 7557'       C      	CALL	KM.UP1	;KMBG nachf. Datensatz anzeigen
  73CF'   02             C      	DB	2
  73D0'   C9             C      	RET
                         C      
  73D1'                  C      KM.CR:
  73D1'   CD 755A'       C      	CALL	KM.UP2	;KMBG einen  Datensatz vorsetzen
  73D4'   11             C      	DB	11H
  73D5'   C9             C      	RET
                         C      
  73D6'                  C      KM.CNZA:
  73D6'   DD CB 00 7E    C      	BIT	7,(IX)
  73DA'   C0             C      	RET	NZ
  73DB'   3A 7606'       C      	LD	A,(KM.TX2-KM.UP13+KM.RAM)
  73DE'   FE 6C          C      	CP	'l'
  73E0'   28 08          C      	JR	Z,KM.CNZA1
  73E2'   DD 36 09 00    C      	LD	(IX+9),0
  73E6'   DD 36 0A 01    C      	LD	(IX+10),1
  73EA'                  C      KM.CNZA1:
  73EA'   3E 71          C      	LD	A,71H
  73EC'   DD B6 04       C      	OR	(IX+4)
  73EF'   DD 77 04       C      	LD	(IX+4),A
  73F2'   CD 756B'       C      	CALL	KM.UP5
  73F5'   DD 7E 04       C      	LD	A,(IX+4)
  73F8'   CD 7557'       C      	CALL	KM.UP1
  73FB'   02             C      	DB	2
  73FC'   CD 755A'       C      	CALL	KM.UP2
  73FF'   15             C      	DB	15H
  7400'   DD 77 04       C      	LD	(IX+4),A
  7403'   C3 75F4'       C      	JP	KM.UP4-KM.UP13+KM.RAM
                         C      ;****************************************************************
                         C      ;*                  Routine fuer die Taste   E T 1              *
                         C      ;****************************************************************
  7406'                  C      KM.NEWL:
  7406'   DD CB 00 7E    C      	BIT	7,(IX)
  740A'   C0             C      	RET	NZ
  740B'   21 0E66        C      	LD	HL,KM.PUFF
  740E'   22 2BE2'       C      	LD	(KM.KMTAB+0DFH),HL	;2BE0	;???
  7411'   DD 7E 0A       C      	LD	A,(IX+10)
  7414'   3D             C      	DEC	A
  7415'   E6 F0          C      	AND	0F0H
  7417'   07             C      	RLCA
  7418'   07             C      	RLCA
  7419'   07             C      	RLCA
  741A'   07             C      	RLCA
  741B'   3C             C      	INC	A
  741C'   32 2BED'       C      	LD	(KM.KMTAB+0EAH),A	;2BEB
  741F'   CD 2060        C      	CALL	KM.MHOME
  7422'   CD 23BA        C      	CALL	KM.MINSL
  7425'   CD 21EF        C      	CALL	ATACO
  7428'   C3 75F4'       C      	JP	KM.UP4-KM.UP13+KM.RAM
                         C      
                         C      	PAGE
'Kmbg'	MACRO-80 3.44	09-Dec-81	PAGE	1-85


                         C      
                         C      ;****************************************************************
                         C      ;*                  Auswertung der alphanumerischen Tasten      *
                         C      ;****************************************************************
  742B'                  C      KM.EINA:
  742B'   79             C      	LD	A,C
  742C'   21 0000        C      	LD	HL,0
  742F'   FE 72          C      	CP	'r'
  7431'   20 03          C      	JR	NZ,KM.EINA1
  7433'   21 7495'       C      	LD	HL,KM.EINAB
  7436'                  C      KM.EINA1:
  7436'   FE 7A          C      	CP	'z'
  7438'   20 03          C      	JR	NZ,KM.EINA2
  743A'   21 74A0'       C      	LD	HL,KM.EINAC
  743D'                  C      KM.EINA2:
  743D'   FE 70          C      	CP	'p'
  743F'   20 03          C      	JR	NZ,KM.EINA3
  7441'   21 0000        C      	LD	HL,0
  7444'                  C      KM.EINA3:
  7444'   FE 63          C      	CP	'c'
  7446'   20 03          C      	JR	NZ,KM.EINA4
  7448'   21 0000        C      	LD	HL,0
  744B'                  C      KM.EINA4:
  744B'   22 0DA8        C      	LD	(KM.TTABU),HL
  744E'   FE 30          C      	CP	'0'
  7450'   38 04          C      	JR	C,KM.EINA5
  7452'   FE 47          C      	CP	'G'
  7454'   38 06          C      	JR	C,KM.EINA7
  7456'                  C      KM.EINA5:
  7456'   32 7606'       C      	LD	(KM.TX2-KM.UP13+KM.RAM),A
  7459'                  C      KM.EINA6:
  7459'   C3 75F4'       C      	JP	KM.UP4-KM.UP13+KM.RAM
                         C      
  745C'                  C      KM.EINA7:
  745C'   3A 7606'       C      	LD	A,(KM.TX2-KM.UP13+KM.RAM)
  745F'   FE 67          C      	CP	'g'
  7461'   20 10          C      	JR	NZ,KM.EINA8
  7463'   79             C      	LD	A,C
  7464'   D6 30          C      	SUB	30H
  7466'   D8             C      	RET	C
  7467'   C8             C      	RET	Z
  7468'   FE 03          C      	CP	3
  746A'   D0             C      	RET	NC
  746B'   DD 77 03       C      	LD	(IX+3),A
  746E'   CD 74CB'       C      	CALL	KM.UP20
  7471'   18 E6          C      	JR	KM.EINA6
                         C      
  7473'                  C      KM.EINA8:
  7473'   FE 6C          C      	CP	'l'
  7475'   20 1D          C      	JR	NZ,KM.EINAA
  7477'   79             C      	LD	A,C
  7478'   D6 30          C      	SUB	30H
  747A'   FE 0A          C      	CP	00AH
  747C'   38 02          C      	JR	C,KM.EINA9
  747E'   D6 07          C      	SUB	7
  7480'                  C      KM.EINA9:
  7480'   5F             C      	LD	E,A
  7481'   16 00          C      	LD	D,0
  7483'   62             C      	LD	H,D
  7484'   DD 6E 0A       C      	LD	L,(IX+10)
  7487'   29             C      	ADD	HL,HL
  7488'   29             C      	ADD	HL,HL
  7489'   29             C      	ADD	HL,HL
  748A'   29             C      	ADD	HL,HL
  748B'   19             C      	ADD	HL,DE
  748C'   DD 74 09       C      	LD	(IX+9),H
  748F'   DD 75 0A       C      	LD	(IX+10),L
  7492'   18 C5          C      	JR	KM.EINA6
                         C      
  7494'                  C      KM.EINAA:
  7494'   C9             C      	RET
                         C      
  7495'                  C      KM.EINAB:
  7495'   CD 755A'       C      	CALL	KM.UP2
  7498'   08             C      	DB	8
  7499'   21 0000        C      	LD	HL,0
  749C'   22 0DA8        C      	LD	(SM.TABU),HL	;00DA8H
  749F'   C9             C      	RET
                         C      
  74A0'                  C      KM.EINAC:
  74A0'   DD 36 0D 00    C      	LD	(IX+13),0	;???
  74A4'   DD 36 0E 00    C      	LD	(IX+14),0	;???
'Kmbg'	MACRO-80 3.44	09-Dec-81	PAGE	1-86


  74A8'                  C      KM.EINAD:
  74A8'   CD 7557'       C      	CALL	KM.UP1
  74AB'   02             C      	DB	2
  74AC'   DD 7E 09       C      	LD	A,(IX+9)
  74AF'   DD B6 0A       C      	OR	(IX+10)
  74B2'   28 08          C      	JR	Z,KM.EINAE
  74B4'   DD 34 0D       C      	INC	(IX+13)	;???
  74B7'   CD 74BC'       C      	CALL	KM.EINAE
  74BA'   18 EC          C      	JR	KM.EINAD
                         C      
  74BC'                  C      KM.EINAE:
  74BC'   CD 75F4'       C      	CALL	KM.UP4-KM.UP13+KM.RAM
  74BF'   11 35E0        C      	LD	DE,SD.BWSA + 18*80 + 64	;5E0H
  74C2'   CD 758F'       C      	CALL	KM.UP10
  74C5'   62 7A 3A       C      	DB	'bz:'
  74C8'   0D             C      	DB	00DH
  74C9'   A0             C      	DB	20H+80H
  74CA'   C9             C      	RET
                         C      
  74CB'                  C      KM.UP20:
  74CB'   DD 4E 02       C      	LD	C,(IX+2)
  74CE'   0C             C      	INC	C	;???
  74CF'   0C             C      	INC	C
  74D0'   0C             C      	INC	C
  74D1'   0C             C      	INC	C
  74D2'   ED 40          C      	IN	B,(C)
  74D4'   FE 01          C      	CP	1
  74D6'   20 04          C      	JR	NZ,KM.UP21
  74D8'   CB 48          C      	BIT	1,B
  74DA'   20 29          C      	JR	NZ,KM.UP25
  74DC'                  C      KM.UP21:
  74DC'   CB D8          C      	SET	3,B
  74DE'   18 06          C      	JR	KM.UP22
  74E0'   CB 40          C      	BIT	0,B
  74E2'   20 21          C      	JR	NZ,KM.UP25
  74E4'   CB D0          C      	SET	2,B
  74E6'                  C      KM.UP22:
  74E6'   ED 41          C      	OUT	(C),B
  74E8'   0C             C      	INC	C
  74E9'   ED 50          C      	IN	D,(C)
  74EB'   0D             C      	DEC	C
  74EC'   CB 90          C      	RES	2,B
  74EE'   CB 98          C      	RES	3,B
  74F0'   ED 41          C      	OUT	(C),B
  74F2'   FE 01          C      	CP	1
  74F4'   20 04          C      	JR	NZ,KM.UP23
  74F6'   CB 62          C      	BIT	4,D
  74F8'   18 02          C      	JR	KM.UP24
                         C      
  74FA'                  C      KM.UP23:
  74FA'   CB 5A          C      	BIT	3,D
  74FC'                  C      KM.UP24:
  74FC'   28 07          C      	JR	Z,KM.UP25
  74FE'   DD 36 00 00    C      	LD	(IX+0),0
  7502'   C3 73A9'       C      	JP	KM.CO
                         C      
  7505'                  C      KM.UP25:
  7505'   DD CB 00 FE    C      	SET	7,(IX+0)
  7509'   C9             C      	RET
                         C      
                         C      	PAGE
'Kmbg'	MACRO-80 3.44	09-Dec-81	PAGE	1-87


                         C      
  750A'                  C      KM.ABS:
  750A'   21 3000        C      	LD	HL,SD.BWSA
  750D'   06 11          C      	LD	B,17
  750F'                  C      KM.ABS1:
  750F'   C5             C      	PUSH	BC
  7510'   CD 7519'       C      	CALL	KM.UP30
  7513'   C1             C      	POP	BC
  7514'   10 F9          C      	DJNZ	KM.ABS1
  7516'   C3 752C'       C      	JP	KM.UP36
                         C      
  7519'                  C      KM.UP30:
  7519'   CD 7538'       C      	CALL	KM.UP34
  751C'   A0             C      	DB	0A0H
  751D'   28 15          C      	JR	Z,KM.UP33
  751F'   CD 7538'       C      	CALL	KM.UP34
  7522'   50             C      	DB	050H
  7523'   28 0C          C      	JR	Z,KM.UP32
  7525'                  C      KM.UP31:
  7525'   7E             C      	LD	A,(HL)
  7526'   23             C      	INC	HL
  7527'   CD 4040        C      	CALL	PRINT
  752A'   10 F9          C      	DJNZ	KM.UP31
  752C'                  C      KM.UP36:
  752C'   3E 1E          C      	LD	A,1EH
  752E'   C3 4040        C      	JP	PRINT
                         C      
  7531'                  C      KM.UP32:
  7531'   CD 752C'       C      	CALL	KM.UP36
  7534'                  C      KM.UP33:
  7534'   23             C      	INC	HL
  7535'   10 FD          C      	DJNZ	KM.UP33
  7537'   C9             C      	RET
                         C      
  7538'                  C      KM.UP34:
  7538'   E3             C      	EX	(SP),HL
  7539'   46             C      	LD	B,(HL)
  753A'   23             C      	INC	HL
  753B'   E3             C      	EX	(SP),HL
  753C'   E5             C      	PUSH	HL
  753D'   CD 7544'       C      	CALL	KM.UP35
  7540'   E1             C      	POP	HL
  7541'   06 50          C      	LD	B,80
  7543'   C9             C      	RET
                         C      
  7544'                  C      KM.UP35:
  7544'   3E 20          C      	LD	A,' '
  7546'   BE             C      	CP	(HL)
  7547'   23             C      	INC	HL
  7548'   C0             C      	RET	NZ
  7549'   10 F9          C      	DJNZ	KM.UP35
  754B'   C9             C      	RET
                         C      
  754C'                  C      KM.DEL:
  754C'   DD CB 00 BE    C      	RES	7,(IX+0)
  7550'   DD 36 01 00    C      	LD	(IX+1),0
  7554'   C3 75F4'       C      	JP	KM.UP4-KM.UP13+KM.RAM
                         C      
                         C      	PAGE
'Kmbg'	MACRO-80 3.44	09-Dec-81	PAGE	1-88


                         C      
                         C      ;****************************************************************
                         C      ;*                  Unterprogramme                              *
                         C      ;****************************************************************
  7557'                  C      KM.UP1:
  7557'   CD 7577'       C      	CALL	KM.LOE1
  755A'                  C      KM.UP2:
  755A'   DD CB 00 7E    C      	BIT	7,(IX)
  755E'   28 02          C      	JR	Z,KM.UP3
  7560'   E1             C      	POP	HL
  7561'   C0             C      	RET	NZ
  7562'                  C      KM.UP3:
  7562'   E3             C      	EX	(SP),HL
  7563'   F5             C      	PUSH	AF
  7564'   7E             C      	LD	A,(HL)
  7565'   23             C      	INC	HL
  7566'   DD 77 04       C      	LD	(IX+4),A
  7569'   F1             C      	POP	AF
  756A'   E3             C      	EX	(SP),HL
  756B'                  C      KM.UP5:
  756B'   CD 55E2'       C      	CALL	KM.KARO
  756E'   21 5F7C'       C      	LD	HL,FD.DASU	;05C01H
  7571'   22 0D8E        C      	LD	(SM.FKTAB+8EH),HL	;SM.ZSMER , SM.ZSTC
  7574'   C3 75F4'       C      	JP	KM.UP4-KM.UP13+KM.RAM
                         C      
  7577'                  C      KM.LOE1:
  7577'   21 0E65        C      	LD	HL,KM.PUFF-1
  757A'   36 00          C      	LD	(HL),0
  757C'   01 0103        C      	LD	BC,103H
  757F'   18 08          C      	JR	KM.LOE3
  7581'                  C      KM.LOE2:
  7581'   21 3000        C      	LD	HL,SD.BWSA
  7584'   01 077F        C      	LD	BC,24*80 -1 ;007FFH ??? (25*80-1 = 07CFH; 07FFH-07CFH=30H=48)
  7587'   36 20          C      	LD	(HL),' '
  7589'                  C      KM.LOE3:
  7589'   E5             C      	PUSH	HL
  758A'   D1             C      	POP	DE
  758B'   13             C      	INC	DE
  758C'   ED B0          C      	LDIR
  758E'   C9             C      	RET
                         C      
  758F'                  C      KM.UP10:
  758F'   E3             C      	EX	(SP),HL
  7590'                  C      KM.UP11:
  7590'   7E             C      	LD	A,(HL)
  7591'   E6 7F          C      	AND	07FH
  7593'   FE 20          C      	CP	' '
  7595'   38 02          C      	JR	C,KM.UP12
  7597'   12             C      	LD	(DE),A
  7598'   13             C      	INC	DE
  7599'                  C      KM.UP12:
  7599'   DC 75D8'       C      	CALL	C,KM.UP13-KM.UP13+KM.RAM
  759C'   CB 7E          C      	BIT	7,(HL)
  759E'   23             C      	INC	HL
  759F'   28 EF          C      	JR	Z,KM.UP11
  75A1'   E3             C      	EX	(SP),HL
  75A2'   C9             C      	RET
                         C      
  75A3'                  C      KM.UP41:
  75A3'   11 3000        C      	LD	DE,SD.BWSA
  75A6'   DD 7E 0A       C      	LD	A,(IX+10)
  75A9'   B7             C      	OR	A
  75AA'   20 0C          C      	JR	NZ,KM.UP42
  75AC'   DD CB 09 46    C      	BIT	0,(IX+9)
  75B0'   C8             C      	RET	Z
  75B1'   F5             C      	PUSH	AF
  75B2'   CD 201D        C      	CALL	KM.MANZ
  75B5'   F1             C      	POP	AF
  75B6'   D6 10          C      	SUB	10H
  75B8'                  C      KM.UP42:
  75B8'   F5             C      	PUSH	AF
  75B9'   CD 201D        C      	CALL	KM.MANZ
  75BC'   F1             C      	POP	AF
  75BD'   D6 10          C      	SUB	10H
  75BF'   C8             C      	RET	Z
  75C0'   D8             C      	RET	C
  75C1'   18 F5          C      	JR	KM.UP42
                         C      
  75C3'                  C      KM.UP43:
  75C3'   FE 1E          C      	CP	01EH
  75C5'   C8             C      	RET	Z
  75C6'   FE 0A          C      	CP	00AH
'Kmbg'	MACRO-80 3.44	09-Dec-81	PAGE	1-89


  75C8'   C8             C      	RET	Z
  75C9'   FE 0D          C      	CP	00DH
  75CB'   C8             C      	RET	Z
  75CC'   B7             C      	OR	A
  75CD'   C8             C      	RET	Z
  75CE'   FE 20          C      	CP	' '
  75D0'   38 03          C      	JR	C,KM.UP44
  75D2'   FE 80          C      	CP	080H
  75D4'   D8             C      	RET	C
  75D5'                  C      KM.UP44:
  75D5'   3E 7F          C      	LD	A,07FH
  75D7'   C9             C      	RET
                         C      
                         C      	PAGE
'Kmbg'	MACRO-80 3.44	09-Dec-81	PAGE	1-90


                         C      
                         C      ;	ORG	00300H
                         C      
  75D8'   32 75DD'       C      KM.UP13:	LD	(KM.UP15-KM.UP13+KM.RAM-1),A	;???
  75DB'   DD 7E 01       C      	LD	A,(IX+1)	;<<<
  75DE'                  C      KM.UP15:
  75DE'   EB             C      	EX	DE,HL
  75DF'   77             C      	LD	(HL),A
  75E0'   3E 33          C      	LD	A,33H
  75E2'   ED 67          C      	RRD
  75E4'   EB             C      	EX	DE,HL
  75E5'   F5             C      	PUSH	AF
  75E6'   1A             C      	LD	A,(DE)
  75E7'   CD 75EB'       C      	CALL	KM.UP14-KM.UP13+KM.RAM
  75EA'   F1             C      	POP	AF
  75EB'                  C      KM.UP14:
  75EB'   FE 3A          C      	CP	03AH
  75ED'   38 02          C      	JR	C,$+4	;---!
  75EF'   C6 07          C      	ADD	A,7	;   !
  75F1'   12             C      	LD	(DE),A	;<--!
  75F2'   13             C      	INC	DE
  75F3'   C9             C      	RET
                         C      
  75F4'                  C      KM.UP4:
  75F4'   F5             C      	PUSH	AF
  75F5'   CD 7581'       C      	CALL	KM.LOE2
  75F8'   DD 7E 03       C      	LD	A,(IX+3)
  75FB'   C6 30          C      	ADD	A,30H
  75FD'   32 760A'       C      	LD	(KM.TX1-KM.UP13+KM.RAM),A
  7600'   11 35A0        C      	LD	DE,SD.BWSA + 18*80 ;5A0H
  7603'   CD 758F'       C      	CALL	KM.UP10
  7606'                  C      KM.TX2:
  7606'   67 20          C      	DB	'g '
  7608'   04             C      	DB	004H
  7609'   28             C      	DB	'('	;<<<
  760A'                  C      KM.TX1:
  760A'   32 29          C      	DB	'2)'	;<<<
  760C'   BA             C      	DB	3AH+80H	;":"
  760D'   11 35AE        C      	LD	DE,SD.BWSA + 18*80 + 14 ;5AEH	;18*80 +20	;5B4H
  7610'   CD 758F'       C      	CALL	KM.UP10
  7613'   6C 3A          C      	DB	'l:'
  7615'   09             C      	DB	9
  7616'   0A             C      	DB	10
  7617'   20 73 3A       C      	DB	' s:'
  761A'   00             C      	DB	0
  761B'   2F             C      	DB	'/'
  761C'   01             C      	DB	1
  761D'   20 20 20 20    C      	DB	'      '
  7621'   20 20          C      
  7623'   AD             C      	DB	2DH+80H	;"-"
  7624'   1B             C      	DEC	DE
  7625'   1B             C      	DEC	DE
  7626'   1B             C      	DEC	DE
  7627'   21 0E65        C      	LD	HL,KM.PUFF-1
  762A'   7E             C      	LD	A,(HL)
  762B'   23             C      	INC	HL
  762C'   CD 75DE'       C      	CALL	KM.UP15-KM.UP13+KM.RAM
  762F'   13             C      	INC	DE
  7630'   DD 46 0A       C      	LD	B,(IX+10)
  7633'   E5             C      	PUSH	HL
  7634'   23             C      	INC	HL
  7635'   10 FD          C      	DJNZ	$-1
  7637'   7E             C      	LD	A,(HL)
  7638'   CD 75DE'       C      	CALL	KM.UP15-KM.UP13+KM.RAM
  763B'   23             C      	INC	HL
  763C'   7E             C      	LD	A,(HL)
  763D'   CD 75DE'       C      	CALL	KM.UP15-KM.UP13+KM.RAM
  7640'   E1             C      	POP	HL
  7641'   E5             C      	PUSH	HL
  7642'   11 3640        C      	LD	DE,SD.BWSA + 20*80	;640H
  7645'   06 00          C      	LD	B,0
  7647'   7E             C      	LD	A,(HL)
  7648'   CD 75C3'       C      	CALL	KM.UP43
  764B'   12             C      	LD	(DE),A
  764C'   23             C      	INC	HL
  764D'   13             C      	INC	DE
  764E'   10 F7          C      	DJNZ	$-7
  7650'   E1             C      	POP	HL
  7651'                  C      KM.UP40:
  7651'   CD 75A3'       C      	CALL	KM.UP41
  7654'   F1             C      	POP	AF
  7655'   C9             C      	RET
'Kmbg'	MACRO-80 3.44	09-Dec-81	PAGE	1-91


                         C      
  7656'                  C      KM.UPEND	EQU	$
                         C      
                         C      ;SM.FKTAB	EQU	00D00H
  0DA8                   C      KM.TTABU  EQU	00DA8H
  0DAE                   C      KM.TNEWL  EQU	00DAEH
  0DB0                   C      KM.TEINA  EQU	00DB0H
  0E66                   C      KM.PUFF   EQU	00E66H
                         C      
  201D                   C      KM.MANZ   EQU	0201DH
  2060                   C      KM.MHOME  EQU	02060H
  23BA                   C      KM.MINSL  EQU	023BAH
                         C      ;ATACO    EQU	024F8H
                         C      
  2B03'                  C      KM.KMTAB  EQU	UB.KTAB
                         C      ;         DEFS  17,0
                         C      ;SD.BWSA  EQU	03000H
                         C      
  55E2'                  C      KM.KARO   EQU	KR.KARO   ;05A93H
                         C      
                         C      ;DRUZ     EQU	07C00H
                         C      
  75D8'                  C      KM.RAM    EQU	KM.UP13   ;0FF80H
                         C      
                         C      			;(C) Rainer Sieber     A d W
                         C      
                         C      
                         C      ;	END
                                
                                	TITLE 'Symbolliste S1b'
                                	END
'Symbolliste S1b'	MACRO-80 3.44	09-Dec-81	PAGE	S


Macros:

Symbols:
21EF 	ATACO           0001 	BC.AGG          0000 	BC.EGG          
FA3A 	BC.END          E000 	BC.TAB1         F902 	BC.TAB2         
F96A 	BC.TAB2A        F9D2 	BC.TAB3         E002 	BC.VTABA        
EC82 	BC.VTABE        7179'	CP.COMPR        71DC'	CP.INIT         
71AC'	CP.KOM          717E'	CP.NL           71AC'	CP.OUT          
718C'	CP.OUTT         71B3'	CP.SOKOM        71C9'	CP.SOSTR        
7191'	CP.SPACE        7188'	CP.STRNG        71CE'	CP.TAB          
719C'	CP.TEXT         5504'	CRC0            5508'	CRC1            
551B'	CRC2            71E2'	DC.DCMPR        7218'	DC.EOSPC        
721D'	DC.INIT         71E4'	DC.NL           7208'	DC.SPACE        
71FE'	DC.TAB          71F0'	DC.TEXT         6252'	FD.BMGF         
5F7C'	FD.DASU         60B6'	FD.DECBZ        616D'	FD.DECHL        
622D'	FD.DSPBB        623D'	FD.DSPBG        61E2'	FD.END          
620B'	FD.FDIN2        5FC9'	FD.FDINP        601C'	FD.FDOUT        
6080'	FD.FDOW1        6084'	FD.FDOW2        60A9'	FD.FDOW3        
609B'	FD.FDOW4        6070'	FD.FDOWR        60C0'	FD.FDUP         
61E9'	FD.FOLWR        6176'	FD.FOUT1        6102'	FD.FSTRT        
5F75'	FD.KO01         5F5D'	FD.POSK         6247'	FD.RDEND        
6010'	FD.SDIN         60F2'	FD.SDK0         60FC'	FD.SDK1         
60E8'	FD.SDK2         606A'	FD.SDOUT        60D8'	FD.SDOW         
614F'	FD.SETJ         6167'	FD.SETN         613A'	FD.STRT1        
5F98'	FD.WRRES        2B01'	K0.HSB          2B02'	K0.LPD          
5400'	K1.BRKMB        5501'	K1.CRC          5441'	K1.KERN         
5EA9'	KH.ANZB1        5EB4'	KH.ANZB2        5EBC'	KH.ANZB3        
5EBE'	KH.ANZB4        5EA6'	KH.ANZBL        5EDE'	KH.AZ1Z         
5F0F'	KH.AZ4B0        5F30'	KH.AZ4B1        5F1F'	KH.AZ4B3        
5F0B'	KH.AZ4BY        5F02'	KH.AZADR        5EC5'	KH.AZBL1        
5EC2'	KH.AZBLD        5F4F'	KH.BILO         5F49'	KH.BLEV1        
5F4B'	KH.BLEV2        5F34'	KH.BLEVG        5E58'	KH.BMM          
5E50'	KH.BMP          5E2A'	KH.KSRA         5DE4'	KH.KSRE         
5E36'	KH.KSRM         5E39'	KH.KSRP         5DE7'	KH.KSRW         
5DE7'	KH.RD1          5ED5'	KH.RD2          5DF1'	KH.RD3          
5E73'	KH.RDBA         5E84'	KH.RDBM         5E95'	KH.RDSL         
5DD9'	KH.RDSTA        5DE4'	KH.RES          5E6D'	KH.SYSRT        
5E69'	KH.WBM          5E5D'	KH.WREC         5E6B'	KH.WSL          
5A79'	KI.KM           5A3A'	KI.KN           5AE0'	KI.KO03         
5A5D'	KI.NMR          5AEB'	KI.RENA         5B08'	KI.RENA9        
5AC2'	KI.VERZ         750A'	KM.ABS          750F'	KM.ABS1         
7357'	KM.ANF          73C7'	KM.CL           73D6'	KM.CNZA         
73EA'	KM.CNZA1        73A9'	KM.CO           73D1'	KM.CR           
73BA'	KM.CU           754C'	KM.DEL          742B'	KM.EINA         
7436'	KM.EINA1        743D'	KM.EINA2        7444'	KM.EINA3        
744B'	KM.EINA4        7456'	KM.EINA5        7459'	KM.EINA6        
745C'	KM.EINA7        7473'	KM.EINA8        7480'	KM.EINA9        
7494'	KM.EINAA        7495'	KM.EINAB        74A0'	KM.EINAC        
74A8'	KM.EINAD        74BC'	KM.EINAE        73B5'	KM.HOME         
55E2'	KM.KARO         2B03'	KM.KMTAB        7577'	KM.LOE1         
7581'	KM.LOE2         7589'	KM.LOE3         201D 	KM.MANZ         
2060 	KM.MHOME        23BA 	KM.MINSL        7406'	KM.NEWL         
0E66 	KM.PUFF         75D8'	KM.RAM          73BF'	KM.SL           
73CC'	KM.SR           0DB0 	KM.TEINA        0DAE 	KM.TNEWL        
0DA8 	KM.TTABU        760A'	KM.TX1          7606'	KM.TX2          
7557'	KM.UP1          758F'	KM.UP10         7590'	KM.UP11         
7599'	KM.UP12         75D8'	KM.UP13         75EB'	KM.UP14         
75DE'	KM.UP15         755A'	KM.UP2          74CB'	KM.UP20         
74DC'	KM.UP21         74E6'	KM.UP22         74FA'	KM.UP23         
74FC'	KM.UP24         7505'	KM.UP25         7562'	KM.UP3          
7519'	KM.UP30         7525'	KM.UP31         7531'	KM.UP32         
7534'	KM.UP33         7538'	KM.UP34         7544'	KM.UP35         
752C'	KM.UP36         75F4'	KM.UP4          7651'	KM.UP40         
75A3'	KM.UP41         75B8'	KM.UP42         75C3'	KM.UP43         
75D5'	KM.UP44         756B'	KM.UP5          7656'	KM.UPEND        
54F7'	KOMED           55DE'	KR.CKRA         552D'	KR.GR1          
5537'	KR.GR2          5539'	KR.GR3          55E2'	KR.KARO         
565B'	KR.KCL          566A'	KR.TYPT         55E6'	KR.VORSP        
562E'	KR.YKA1         5643'	KR.YKA2         6A9F'	KU.DD           
6A9C'	KU.DECIY        6A37'	KU.TAB2L        6A2E'	KU.VVOR         
6A6F'	KU.ZEIR         5B81'	KV.ANF          5DA4'	KV.ANZ          
5C51'	KV.AUSG         5DBA'	KV.AVZS         5D2C'	KV.BSTR         
5D8F'	KV.DBCVM        5D14'	KV.DRU          5D12'	KV.DRU1         
5D21'	KV.KO02         5CC6'	KV.KRW          5CFA'	KV.P1           
5D9A'	KV.SBC          5D59'	KV.SPTR         5BEA'	KV.TABTR        
5C30'	KV.ZEIHO        5BB5'	KV.ZLTR         674E'	KX.ENDR         
676D'	KX.EXEC2        6743'	KX.RSPFR        679D'	KX.UPA          
6A27'	KY.AJ           6849'	KY.ATAA         686C'	KY.ATAB         
687D'	KY.ATABE        690E'	KY.COPY         67D8'	KY.DFR          
69BB'	KY.EOV          68CA'	KY.EVZ          68CD'	KY.EVZ1         
69FA'	KY.EWK          6846'	KY.EZYK1        6A0A'	KY.JHL          
696E'	KY.KOP          6988'	KY.KOPAN        6968'	KY.KOPV         
'Symbolliste S1b'	MACRO-80 3.44	09-Dec-81	PAGE	S-1


67BA'	KY.MD           6840'	KY.NDA          68B1'	KY.NE           
6A13'	KY.SATR         6832'	KY.SVGL         6932'	KY.VSCHR        
68E5'	KY.VSTR         6827'	KY.VZVGL        688B'	KY.WEI          
689F'	KY.ZYK          629A'	LD.DATFU        6275'	LD.DATN         
62BB'	LD.DATPO        6336'	LD.LAD1         6325'	LD.LAD2         
6322'	LD.LADER        634B'	LD.LADF         628A'	LD.LD2          
6294'	LD.LD21         631D'	LD.LD3          62DB'	LD.LD4          
62F6'	LD.LD5          6342'	LD.LDEND        6313'	LD.START        
6B15'	POSIK1          4040 	PRINT           4070 	PUF.KASS        
6351'	RL.BEG          645D'	RL.BF           6449'	RL.DATNV        
6444'	RL.ECHO         645F'	RL.FMELD        63E2'	RL.M10          
63F3'	RL.M11          6382'	RL.M12          63C0'	RL.M13          
63D0'	RL.M14          63D8'	RL.M15          6371'	RL.M16          
639F'	RL.M17          6406'	RL.M21          6459'	RL.MN           
644D'	RL.OB           6451'	RL.RA           6455'	RL.SV           
6366'	RL.UG           63F9'	RL.UP6          54EF'	RLAD            
54EA'	RRET            3000 	SD.BWSA         0D00 	SM.FKTAB        
0DA8 	SM.TABU         54E6'	STF07           54DC'	STF99           
54E3'	STFRS           549A'	STT02           54B8'	STT08           
5472'	STT11           5472'	STT15           5472'	STT21           
5472'	STT31           5472'	STT41           548B'	STT5            
547E'	STT51           5482'	STT61           5486'	STT71           
5486'	STT75           656D'	SV.BYANZ        65FE'	SV.DALO1        
649B'	SV.DATN         6578'	SV.DATS1        64B2'	SV.DATV1        
64BA'	SV.DATVO        6592'	SV.SAVE         65A3'	SV.SAVE1        
64F4'	SV.SAVE3        6509'	SV.SAVE4        6551'	SV.SAVE5        
6547'	SV.SAVE6        65F6'	SV.STAD0        648E'	SV.SV20         
64A6'	SV.SV21         64C0'	SV.SV30         64DA'	SV.SV31         
64C8'	SV.SV37         65E6'	SV.SVEN1        65E3'	SV.SVEN2        
65BA'	SV.SVLS         65D6'	SV.SVLS1        65C0'	SV.SVLS2        
6609'	SV.SVSZ         661D'	SV.SVSZ1        660B'	SV.SVSZ2        
4036 	SY.RESC         4033 	SY.SETCHL       000B 	SY.SYSTB        
4026 	TA.ABFR1        6D3D'	U1.AUS          6E78'	U1.BILO         
6CF1'	U1.BREAD        6CFC'	U1.BWRIT        6CD7'	U1.CLRB         
6D0B'	U1.COPB         6D07'	U1.COPB2        6D5D'	U1.DSVG         
6D34'	U1.EIN          6E72'	U1.INFO         6CE6'	U1.KBR4         
6EAD'	U1.KRWE         6DC2'	U1.KTIN1        6DA9'	U1.KTINI        
6D8E'	U1.NMVGL        6E96'	U1.PRADR        6CCE'	U1.RRST         
6CC6'	U1.RSAVE        6E6D'	U1.TR           6E8C'	U1.TST          
6DDF'	U1.VERIN        6DE7'	U1.VERNI        6E09'	U1.VORS1        
6E01'	U1.VORST        6D46'	U1.VS1          6D4D'	U1.VSX          
6E15'	U1.VZS          6CF0'	U1.WAIT         59C5'	UA.ALTR         
59AC'	UA.ANZWD        587E'	UA.BMGF         588F'	UA.DF           
5888'	UA.DOK          574F'	UA.DS           580C'	UA.EABFR        
5878'	UA.FRZ          57C7'	UA.GER          576F'	UA.KNAME        
5795'	UA.KOMMT        57D6'	UA.KOPFR        5981'	UA.LD           
5782'	UA.NR           58E2'	UA.STADR        5842'	UA.VORH         
57A8'	UA.Z7E          5961'	UA.ZKBA         58BC'	UA.ZKBEG        
593B'	UA.ZKBEL        594E'	UA.ZKBLG        596B'	UA.ZKBM         
5896'	UA.ZKDAT        58F5'	UA.ZKDL         5981'	UA.ZKEE         
58CF'	UA.ZKEND        5908'	UA.ZKF          58A9'	UA.ZKLAD        
5913'	UA.ZKRES        5926'	UA.ZKSDT        5974'	UA.ZKSL         
5993'	UA.ZRSCH        2B6E'	UB.DTAB         2B97'	UB.END          
2B03'	UB.KTAB         2B1E'	UB.KTABE        2B26'	UB.PAR1         
2B28'	UB.PAR2         2B2A'	UB.PAR3         2B2C'	UB.PAR4         
2B2E'	UB.PAR5         2B30'	UB.PATAB        2B34'	UB.SATZ         
2B00'	UB.ZN           70B9'	UC.ASCCO        7096'	UC.CKONV        
6F60'	UC.CVABX        6F7B'	UC.CVAX         6F8F'	UC.CVAXB        
7059'	UC.CVBC         6FE9'	UC.CVBD         6FF4'	UC.CVBD0        
6FE7'	UC.CVBD1        6FE3'	UC.CVBD2        6FDF'	UC.CVBD3        
6FDB'	UC.CVBD4        6FD7'	UC.CVBD5        6F6A'	UC.CVBX         
706A'	UC.CVCB         7051'	UC.CVD1B        7028'	UC.CVDB         
6F86'	UC.CVHLX        6FB1'	UC.CVX1B        6FCC'	UC.CVXA         
6FA0'	UC.CVXB         6FBA'	UC.CVXER        6F52'	UC.DIVR         
708B'	UC.DK1          709F'	UC.DK2          7119'	UC.DKOI         
7077'	UC.DKONV        6F39'	UC.HL10C        6F32'	UC.HL10N        
7081'	UC.KONV         70B5'	UC.KONV2        5400'	UE.BRKMB        
3000 	UE.BWSA         0060 	UE.COTAL        5501'	UE.CRC          
0DC4 	UE.EDEND        0132 	UE.KMPUL        8010 	UE.KPUFF        
0E66 	UE.PUF          0CFE 	UE.STANF        007D 	UE.SVL          
000B 	UE.SYSTB        00F7 	UE.TACL         00F9 	UE.TACR         
001E 	UE.TAQUI        00CD 	UE.TASYS        8830 	UE.TEXAN        
0E5A 	UE.ZEIN         56F1'	UF.AZVB         5726'	UF.BEHB         
572E'	UF.BEHB1        56A5'	UF.ERANZ        5675'	UF.EXEC         
569C'	UF.EXEC1        5699'	UF.EXEC2        5743'	UF.FL14         
5746'	UF.FL16         5740'	UF.FL17         5734'	UF.FL18         
5670'	UF.RET          56E1'	UF.SYS          56ED'	UF.SYS1         
7223'	UK.GETK         7244'	UK.GETK2        724C'	UK.GETK3        
7252'	UK.GETK4        7248'	UK.GETK5        7311'	UK.KBA          
7283'	UK.KBW          72C2'	UK.KBW1         72BE'	UK.KBW2         
7260'	UK.KLPFB        72EC'	UK.KSPFB        72C8'	UK.PUTK         
6C7A'	UR.ALPH1        6C71'	UR.ALPHA        6C85'	UR.ALPNU        
6BAC'	UR.BBSA1        6BA4'	UR.BBSAD        6CB6'	UR.BILR1        
'Symbolliste S1b'	MACRO-80 3.44	09-Dec-81	PAGE	S-2


6CA4'	UR.BILRO        6B41'	UR.BM           6BB4'	UR.DSPZK        
6C8F'	UR.HEXAZ        6C9C'	UR.HEXZ1        6AEE'	UR.KBM          
6B00'	UR.KBR          6AFA'	UR.KBV          6AE8'	UR.KLR          
6AE2'	UR.KLV          6ADC'	UR.KRA          6ACA'	UR.KRE          
6ACE'	UR.KRE1         6AD2'	UR.KRW          6AD8'	UR.KRWW         
6AF4'	UR.KSL          6B1A'	UR.LES          6B72'	UR.MIMO         
6B8E'	UR.MIMO1        6B86'	UR.MIMO2        6B95'	UR.MIMO3        
6C7C'	UR.NUM          6B4F'	UR.OK           6B0F'	UR.POSIK        
6C04'	UR.RET0         6B06'	UR.RPOS         6B6E'	UR.RSP          
6C9E'	UR.TAREP        6C0E'	UR.TCL          6C20'	UR.TCLN         
6C23'	UR.TCR          6C34'	UR.TCRN         6C3E'	UR.TQUIT        
6C36'	UR.TSYS         6BC1'	UR.ZINP         6BC7'	UR.ZINP1        
6BCA'	UR.ZINP2        6BF8'	UR.ZINP3        6BFE'	UR.ZINP4        
6BE6'	UR.ZINP5        6C07'	UR.ZINP7        6C6C'	UR.ZKON1        
6C46'	UR.ZKONT        6EB4'	XY.CALP1        6EBD'	XY.CALPE        
6F08'	XY.INCDX        6F21'	XY.JMPDX        6EC8'	XY.LDDX         
6ED8'	XY.LIDX         6EE8'	XY.STDX         6EF8'	XY.STIDX        



No Fatal error(s)


    
6C23'	UR.TCR          6C34'	UR.TCRN         6C3E'	UR.TQUIT        
6C36'	UR.TS