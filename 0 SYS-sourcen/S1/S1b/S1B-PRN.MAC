'EQUAL - Anweisungen fuer Assembler'	MACRO-80 3.44	09-Dec-81	PAGE	1


                                	TITLE 'EQUAL - Anweisungen fuer Assembler'
                                	PAGE	87
'EQUAL - Anweisungen fuer Assembler'	MACRO-80 3.44	09-Dec-81	PAGE	1-1



  000B                          SY.SYSTB  EQU	0000BH
  0CE0                          SM.STACK  EQU	00CE0H
  0CE0                          SM.FKTAB  EQU	00CE0H
  0DAA                          SM.TABU   EQU	00DAAH
  0DC6                          SM.END    EQU	00DC6H  ;Position Textende
  0E5A                          SM.ZEIN   EQU	00E5AH  ;Zaehler Eingabe
  0E65                          SM.PUFFS  EQU	00E65H  ;Eingabepuffer
  8010                          SD.PFFI   EQU	08010H  ;Eingabepuffer
  8830                          SD.TPA    EQU	08830H  ;Anf.adr. Textpuffer
  225C                          ATACO     EQU	0225CH
  3000                          SD.BWSA   EQU	03000H
  4026                          TA.ABFR1  EQU	04026H
  4033                          SY.SETCHL EQU	04033H
  4036                          SY.RESC   EQU	04036H
  4040                          PRINT     EQU	04040H
  4070                          PUF.KASS  EQU	04070H

                         C      	INCLUDE K0.MAC	;EQUAL - Anweisungen fuer Assembler
                         C      ;         PN    UE01
                         C      ;****************************************************************
                         C      ;*                  EQUAL - Anweisungen fuer Assembler          *
                         C      ;****************************************************************
  0030                   C      AKB      EQU	030H    ;IO-Adresse der AKB
  0080                   C      MaxBL    EQU	080H    ;max. Blocklaenge
                         C
  00F7                   C      UE.TACL  EQU	0F7H    ;Kursor nach links
  00F9                   C      UE.TACR  EQU	0F9H    ; ''    nach rechts
  00CD                   C      UE.TASYS EQU	0CDH    ;SYS-Taste
  001E                   C      UE.TAQUI EQU	01EH    ;ET1
  007D                   C      UE.SVL   EQU	07DH    ;Laenge der SAVE-Bloecke
  0060                   C      UE.COTAL EQU	060H    ;Laenge ASC/KOI Codetabelle
  0132                   C      UE.KMPUL EQU	132H    ;max. Laenge E/A-Puffer
                         C
  000B                   C      UE.SYSTB EQU	SY.SYSTB
  0CE0                   C      UE.STANF EQU	SM.STACK
  0DC6                   C      UE.EDEND EQU	SM.END   ;Speicherpl. fuer Adr. Editorende
  0E5A                   C      UE.ZEIN  EQU	SM.ZEIN  ;Pufferzaehler Eingabe
  0E65                   C      UE.PUF   EQU	SM.PUFFS ;System-Puffer
  3000                   C      UE.BWSA  EQU	SD.BWSA  ;Bildwiederholspeicher
  8010                   C      UE.KPUFF EQU	SD.PFFI  ;E/A Puffer
  8830                   C      UE.TEXAN EQU	SD.TPA   ;Begin Editorraum
                         C
  5AB0*                  C      UE.BRKMB EQU	K1.BRKMB ;04000H	;phys. Kass.Routine
  5BC0*                  C      UE.CRC   EQU	K1.CRC   ;04740H	;CRC-Berechnung
                         C
                         C      ;         END
                         C      ;         PN    UB
                         C                ORG   2B00H
  2B00*                  C      UB.ZN:    DS	1,0
  2B01*                  C      K0.HSB:   DS	1,0   ;HS-Bereich
  2B02*                  C      K0.LPD:   DS	1,0   ;Laenge der Daten im Puffer
  2B03*                  C      UB.KTAB:  DS	27,0  ;Originale Tabelle nach Robotron
  2B1E*                  C      UB.KTABE: DS	8,0   ;Tabelle fuer Kassetten im DEG2000 Emulator
  2B26*   0000           C      UB.PAR1:  DW	0
  2B28*   0000           C      UB.PAR2:  DW	0
  2B2A*   0000           C      UB.PAR3:  DW	0
  2B2C*   0000           C      UB.PAR4:  DW	0
  2B2E*   0000           C      UB.PAR5:  DW	0
  2B30*                  C      UB.PATAB: DS	4,0
  2B34*   00             C      UB.SATZ:  DB	0
  2B35*   37             C                DB	55
  2B36*   80             C                DB	80H
  2B37*                  C                DS	55,' '
  2B6E*                  C      UB.DTAB:  DS	41,0
  2B97*                  C      UB.END    EQU	$
                         C      ;         END
                         C      ;         PN    BC
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;        BEREICHE FUER KASSETTENKOPIEREN
                         C      ;
                         C      ;----------------------------------------------------------------------
  0000                   C      BC.EGG     EQU	0	;EINGABEGERAET
  0001                   C      BC.AGG     EQU	1	;AUSGABEGERAET
                         C
                         C      ;	ORG	0E000H
  E000                   C      BC.TAB1    EQU	0E000H               ;Subadresse fuer Input -Kassette
                         C      ;          EQU	0E001H               ;Subadresse fuer Output-Kassette
  E002                   C      BC.VTABA   EQU	BC.TAB1  +    2
  EC82                   C      BC.VTABE   EQU	BC.VTABA + 3200
  F902                   C      BC.TAB2    EQU	BC.VTABE + 3200
'EQUAL - Anweisungen fuer Assembler'	MACRO-80 3.44	09-Dec-81	PAGE	1-2


  F96A                   C      BC.TAB2A   EQU	BC.TAB2  +  104
  F9D2                   C      BC.TAB3    EQU	BC.TAB2A +  104
  FA3A                   C      BC.END     EQU	BC.TAB3  +  104
                         C      ;         END
                                ;
                                	ORG	05400H
                                ;
                                ;	INCLUDE	U1.MAC	;Allgemeine Unterprogramme
                                ;	INCLUDE	XY.MAC	;Handling f. IX/IY-adressierte Bereiche
                                ;	INCLUDE	UC.MAC	;Konvertierungen
                                ;	INCLUDE	CP.MAC	;Komprimierung
                                ;	INCLUDE	DC.MAC	;Dekomprimierung
                                ;	INCLUDE UR.MAC	;Routinen fuer Monitor UND Tastatur
                         C      	INCLUDE K1.MAC	;Allgemeine Unterprogramme
                         C      	TITLE	'Allgemeine Unterprogramme'
                         C      	PAGE
'Allgemeine Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-3


                         C
                         C      ;	PN	U1
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;        Allgemeine Unterprogramme
                         C      ;
                         C      ;----------------------------------------------------------------------
  5400*                  C      U1.RSAVE:
  5400*   E3             C      	EX	(SP),HL      ;Register retten (nicht AF)
  5401*   D5             C      	PUSH	DE
  5402*   C5             C      	PUSH	BC
  5403*   FD E5          C      	PUSH	IY
  5405*   DD E5          C      	PUSH	IX
  5407*   E9             C      	JP	(HL)
  5408*                  C      U1.RRST:
  5408*   E1             C      	POP	HL           ;Register wieder herstellen
  5409*   DD E1          C      	POP	IX
  540B*   FD E1          C      	POP	IY
  540D*   C1             C      	POP	BC
  540E*   D1             C      	POP	DE
  540F*   E3             C      	EX	(SP),HL
  5410*   C9             C      	RET
  5411*                  C      U1.CLRB:
  5411*   E5             C      	PUSH	HL           ;Bereich loeschen
  5412*   D5             C      	PUSH	DE
  5413*   C5             C      	PUSH	BC
  5414*   E5             C      	PUSH	HL          ;IN:  HL= Bereichsanfang
  5415*   D1             C      	POP	DE          ;     BC= Bereichslaenge
  5416*   13             C      	INC	DE
  5417*   AF             C      	XOR	A
  5418*   77             C      	LD	(HL),A
  5419*   0B             C      	DEC	BC
  541A*   ED B0          C      	LDIR
  541C*   C1             C      	POP	BC
  541D*   D1             C      	POP	DE
  541E*   E1             C      	POP	HL
  541F*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  5420*                  C      U1.KBR4:
  5420*   C5             C      	PUSH	BC
  5421*   06 04          C      	LD	B,4
  5423*   CD 60DA*       C      	CALL	UR.KBR
  5426*   10 FB          C      	DJNZ	$-3
  5428*   C1             C      	POP	BC
  5429*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  542A*                  C      U1.WAIT:
                         C      	; PUSH	AF
                         C      	; CALL	UE.BERT
                         C      	; JR	C,$-3
                         C      	; POP	AF
  542A*   C9             C      	RET
                         C      ;--------------------------------------------------------------------
  542B*                  C      U1.BREAD:
  542B*   CD 546D*       C      	CALL	U1.EIN       ;BLOCK LESEN VON EINGABE
  542E*   DD 36 04 02    C      	LD	(IX+4),02H
  5432*   CD 5D34*       C      	CALL	UF.EXEC
  5435*   C9             C      	RET
  5436*                  C      U1.BWRIT:
  5436*   CD 5476*       C      	CALL	U1.AUS       ;BLOCK SCHREIBEN AUF AUSGABE
  5439*   DD 36 04 08    C      	LD	(IX+4),08H
  543D*   CD 5D34*       C      	CALL	UF.EXEC
  5440*   C9             C      	RET
  5441*                  C      U1.COPB2:
  5441*   F5             C      	PUSH	AF
  5442*   37             C      	SCF
  5443*   18 02          C      	JR	$+4
  5445*                  C      U1.COPB:
  5445*   F5             C      	PUSH	AF
  5446*   B7             C      	OR	A
  5447*   CD 546D*       C      	CALL	U1.EIN
  544A*   DD 36 04 02    C      	LD	(IX+4),02H
  544E*   DC 7007*       C      	CALL	C,KX.EXEC2
  5451*   D4 5D34*       C      	CALL	NC,UF.EXEC
  5454*   F5             C      	PUSH	AF
  5455*   CD 5476*       C      	CALL	U1.AUS
                         C      	;LD	A,(IX+9)
                         C      	;OR	(IX+10)
  5458*   DD 7E 0A       C      	LD	A,(IX+10)    ;Laenge = 1, dann BM
  545B*   FE 01          C      	CP	1
  545D*   28 08          C      	JR	Z,$+10
  545F*   CD 5436*       C      	CALL	U1.BWRIT
'Allgemeine Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-4


  5462*   F1             C      	POP	AF
  5463*   38 DC          C      	JR	C,$-34
  5465*   30 DE          C      	JR	NC,$-32
  5467*   CD 60C8*       C      	CALL	UR.KBM
  546A*   F1             C      	POP	AF
  546B*   F1             C      	POP	AF
  546C*   C9             C      	RET
  546D*                  C      U1.EIN:
  546D*   F5             C      	PUSH	AF
  546E*   3A E000        C      	LD	A,(BC.TAB1)
  5471*   DD 77 03       C      	LD	(IX+3),A
  5474*   F1             C      	POP	AF
  5475*   C9             C      	RET
  5476*                  C      U1.AUS:
  5476*   F5             C      	PUSH	AF
  5477*   3A E001        C      	LD	A,(BC.TAB1+1)
  547A*   DD 77 03       C      	LD	(IX+3),A
  547D*   F1             C      	POP	AF
  547E*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  547F*                  C      U1.VS1:
  547F*   E5             C      	PUSH	HL
  5480*   C5             C      	PUSH	BC
  5481*   F5             C      	PUSH	AF
  5482*   3E 01          C      	LD	A,01H        ;1.DATEIVORSATZ IM PUFFER
  5484*   18 04          C      	JR	$+6
  5486*                  C      U1.VSX:
  5486*   E5             C      	PUSH	HL
  5487*   C5             C      	PUSH	BC
  5488*   F5             C      	PUSH	AF
  5489*   AF             C      	XOR	A            ;00-DATEIVORSATZ IM PUFFER
  548A*   06 20          C      	LD	B,32
  548C*   21 0E65        C      	LD	HL,UE.PUF
  548F*   CD 55A6*       C      	CALL	U1.TR
  5492*   F1             C      	POP	AF
  5493*   C1             C      	POP	BC
  5494*   E1             C      	POP	HL
  5495*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  5496*                  C      U1.DSVG:
  5496*   E5             C      	PUSH	HL
  5497*   D5             C      	PUSH	DE
  5498*   F5             C      	PUSH	AF
  5499*   06 07          C      	LD	B,7          ;MRES KASSETTE ?
  549B*   CD 5542*       C      	CALL	U1.VORS1
  549E*   11 0E6B        C      	LD	DE,UE.PUF+6
  54A1*   21 5E14*       C      	LD	HL,UA.DS+6
  54A4*   06 0E          C      	LD	B,14
  54A6*   1A             C      	LD	A,(DE)
  54A7*   BE             C      	CP	(HL)
  54A8*   20 10          C      	JR	NZ,$+18
  54AA*   13             C      	INC	DE
  54AB*   23             C      	INC	HL
  54AC*   10 F8          C      	DJNZ	$-6
  54AE*   3A 0E66        C      	LD	A,(UE.PUF+1)
  54B1*   4F             C      	LD	C,A          ;C <-- NEXT RECORD
  54B2*   3A 0E68        C      	LD	A,(UE.PUF+3)
  54B5*   47             C      	LD	B,A          ;B <-- ANZ.VERZ.EINTRAG.
  54B6*   F1             C      	POP	AF
  54B7*   D1             C      	POP	DE
  54B8*   E1             C      	POP	HL
  54B9*   C9             C      	RET
                         C
  54BA*   F1             C      	POP	AF
  54BB*   D1             C      	POP	DE
  54BC*   E1             C      	POP	HL
  54BD*   FD E1          C      	POP	IY
  54BF*   3E 90          C      	LD	A,90H
  54C1*   CD 5D64*       C      	CALL	UF.ERANZ
  54C4*   C3 000B        C      	JP	UE.SYSTB
                         C      ;----------------------------------------------------------------------
  54C7*                  C      U1.NMVGL:
  54C7*   C5             C      	PUSH	BC
  54C8*   D5             C      	PUSH	DE
  54C9*   E5             C      	PUSH	HL
  54CA*   06 06          C      	LD	B,6
  54CC*   11 0E65        C      	LD	DE,UE.PUF
  54CF*   1A             C      	LD	A,(DE)
  54D0*   BE             C      	CP	(HL)         ;HL:ZU SUCHENDER PROGR.NAME
  54D1*   20 0C          C      	JR	NZ,$+14
  54D3*   23             C      	INC	HL
  54D4*   13             C      	INC	DE
  54D5*   10 F8          C      	DJNZ	$-6
'Allgemeine Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-5


  54D7*   3A 0E7C        C      	LD	A,(UE.PUF+23);LABELNR. -->A
  54DA*   37             C      	SCF	             ;CY=1,WENN PROGR. GEFUNDEN
  54DB*   E1             C      	POP	HL
  54DC*   D1             C      	POP	DE
  54DD*   C1             C      	POP	BC
  54DE*   C9             C      	RET
                         C
  54DF*   B7             C      	OR	A
  54E0*   18 F9          C      	JR	$-5
                         C      ;----------------------------------------------------------------------
  54E2*                  C      U1.KTINI:
  54E2*   E5             C      	PUSH	HL
  54E3*   C5             C      	PUSH	BC
  54E4*   F5             C      	PUSH	AF
  54E5*   CD 55B1*       C      	CALL	U1.BILO      ;UNTERE HAELFTE BS LOESCHEN
  54E8*   DD 21 2B03*    C      	LD	IX,UB.KTAB   ;ADR. STEUERTAB. F.KASS.ROUTINE
  54EC*   DD E5          C      	PUSH	IX
  54EE*   E1             C      	POP	HL
  54EF*   AF             C      	XOR	A
  54F0*   06 1B          C      	LD	B,27
  54F2*   CD 55A6*       C      	CALL	U1.TR        ;TAB. AUF 00 LOESCHEN
  54F5*   DD 36 02 30    C      	LD	(IX+2),AKB
                         C      ;	CALL	UE.KINI
  54F9*   18 03          C      	JR	$+5
                         C      ;----------------------------------------------------------------------
  54FB*                  C      U1.KTIN1:
  54FB*   E5             C      	PUSH	HL
  54FC*   C5             C      	PUSH	BC
  54FD*   F5             C      	PUSH	AF
  54FE*   DD 36 0B 07    C      	LD	(IX+11),7    ;ANZAHL LESE/SCHREIBWDHLGNN
  5502*   DD 36 0C 04    C      	LD	(IX+12),4    ;ANZAHL
  5506*   21 0E65        C      	LD	HL,UE.PUF
  5509*   CD 5631*       C      	CALL	XY.STIDX
  550C*   07             C      	DB	7            ;SYSTEMPUFFERADR.-->TAB
  550D*   21 8010        C      	LD	HL,UE.KPUFF
  5510*   CD 5621*       C      	CALL	XY.STDX
  5513*   19             C      	DB	25           ;E/A PUFFERADR.-->TAB
  5514*   F1             C      	POP	AF
  5515*   C1             C      	POP	BC
  5516*   E1             C      	POP	HL
  5517*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  5518*                  C      U1.VERIN:
  5518*   E5             C      	PUSH	HL
  5519*   C5             C      	PUSH	BC
  551A*   F5             C      	PUSH	AF
  551B*   11 EC82        C      	LD	DE,BC.VTABE  ;VERZ. EINGABEGER. EINLESEN
  551E*   18 03          C      	JR	$+5
  5520*                  C      U1.VERNI:
  5520*   E5             C      	PUSH	HL
  5521*   C5             C      	PUSH	BC
  5522*   F5             C      	PUSH	AF
  5523*   3A 0E68        C      	LD	A,(UE.PUF+3) ;ANZ. DATEIEN-->B
  5526*   47             C      	LD	B,A
  5527*   C5             C      	PUSH	BC
  5528*   21 0E65        C      	LD	HL,UE.PUF
  552B*   01 0020        C      	LD	BC,32
  552E*   ED B0          C      	LDIR
  5530*   CD 5D34*       C      	CALL	UF.EXEC
  5533*   C1             C      	POP	BC
  5534*   10 F1          C      	DJNZ	$-13
  5536*   F1             C      	POP	AF
  5537*   C1             C      	POP	BC
  5538*   E1             C      	POP	HL
  5539*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  553A*                  C      U1.VORST:
  553A*   C5             C      	PUSH	BC
  553B*   CD 60B2*       C      	CALL	UR.KRWW
  553E*   06 06          C      	LD	B,6
  5540*   18 01          C      	JR	$+3
  5542*                  C      U1.VORS1:
  5542*   C5             C      	PUSH	BC
  5543*   DD 36 04 02    C      	LD	(IX+4),02H
  5547*   CD 5D34*       C      	CALL	UF.EXEC
  554A*   10 FB          C      	DJNZ	$-3
  554C*   C1             C      	POP	BC
  554D*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  554E*                  C      U1.VZS:
  554E*   D5             C      	PUSH	DE
  554F*   C5             C      	PUSH	BC
  5550*   E5             C      	PUSH	HL
'Allgemeine Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-6


  5551*   F5             C      	PUSH	AF
  5552*   CD 60D4*       C      	CALL	UR.KBV
  5555*   CD 60DA*       C      	CALL	UR.KBR
  5558*   11 0E65        C      	LD	DE,UE.PUF
  555B*   01 0006        C      	LD	BC,6
  555E*   ED B0          C      	LDIR	             ;PROGR.NAME --> PUFFER
  5560*   3A 2B28*       C      	LD	A,(UB.PAR2)  ;DATEITYP
  5563*   12             C      	LD	(DE),A
  5564*   13             C      	INC	DE
  5565*   3E 44          C      	LD	A,'D'
  5567*   12             C      	LD	(DE),A
  5568*   13             C      	INC	DE
  5569*   3A 2B2A*       C      	LD	A,(UB.PAR3)
  556C*   FE 7F          C      	CP	7FH
  556E*   20 0F          C      	JR	NZ,$+17
  5570*   21 5E54*       C      	LD	HL,UA.KOMMT  ;FRAGE KOMMENTAR WENN PAR3=7F
  5573*   CD 595C*       C      	CALL	UR.MIMO
  5576*   01 0006        C      	LD	BC,6
  5579*   ED B0          C      	LDIR
  557B*   06 09          C      	LD	B,9
  557D*   18 02          C      	JR	$+4
  557F*   06 0F          C      	LD	B,15
  5581*   3E 20          C      	LD	A,' '
  5583*   12             C      	LD	(DE),A
  5584*   13             C      	INC	DE
  5585*   10 FC          C      	DJNZ	$-2
  5587*   3A 2B26*       C      	LD	A,(UB.PAR1)
  558A*   12             C      	LD	(DE),A
  558B*   13             C      	INC	DE
  558C*   06 08          C      	LD	B,8
  558E*   AF             C      	XOR	A
  558F*   12             C      	LD	(DE),A
  5590*   13             C      	INC	DE
  5591*   10 FC          C      	DJNZ	$-2
  5593*   21 0020        C      	LD	HL,32
  5596*   CD 5631*       C      	CALL	XY.STIDX
  5599*   09             C      	DB	9
  559A*   DD 36 04 08    C      	LD	(IX+4),08H
  559E*   CD 5D34*       C      	CALL	UF.EXEC
  55A1*   F1             C      	POP	AF
  55A2*   E1             C      	POP	HL
  55A3*   C1             C      	POP	BC
  55A4*   D1             C      	POP	DE
  55A5*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  55A6*                  C      U1.TR:
  55A6*   77             C      	LD	(HL),A       ;A=INHALT
  55A7*   23             C      	INC	HL
  55A8*   10 FC          C      	DJNZ	U1.TR        ;B=ANZAHL
  55AA*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  55AB*                  C      U1.INFO:
  55AB*   01 000E        C      	LD	BC,14
  55AE*   ED B0          C      	LDIR
  55B0*   C9             C      	RET
  55B1*                  C      U1.BILO:
  55B1*   CD 5400*       C      	CALL	U1.RSAVE
  55B4*   21 3370        C      	LD	HL,SD.BWSA + 11*80 ;3370H
  55B7*   01 040F        C      	LD	BC,13*80 - 1       ;1120  ( -80 ... eine Zeile )
  55BA*   36 20          C      	LD	(HL),20H
  55BC*   54             C      	LD	D,H
  55BD*   5D             C      	LD	E,L
  55BE*   13             C      	INC	DE
  55BF*   ED B0          C      	LDIR
  55C1*   CD 5408*       C      	CALL	U1.RRST
  55C4*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  55C5*                  C      U1.TST:
  55C5*   B7             C      	OR	A
  55C6*   D6 30          C      	SUB	30H
  55C8*   47             C      	LD	B,A
  55C9*   05             C      	DEC	B
  55CA*   C8             C      	RET	Z
  55CB*   05             C      	DEC	B
  55CC*   C8             C      	RET	Z
  55CD*   37             C      	SCF
  55CE*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  55CF*                  C      U1.PRADR:
  55CF*   E5             C      	PUSH	HL
  55D0*   C5             C      	PUSH	BC
  55D1*   06 04          C      	LD	B,4
  55D3*   7E             C      	LD	A,(HL)
'Allgemeine Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-7


  55D4*   FE 20          C      	CP	' '
  55D6*   28 07          C      	JR	Z,$+9
  55D8*   23             C      	INC	HL
  55D9*   10 F8          C      	DJNZ	$-6
  55DB*   B7             C      	OR	A
  55DC*   C1             C      	POP	BC
  55DD*   E1             C      	POP	HL
  55DE*   C9             C      	RET
  55DF*   37             C      	SCF
  55E0*   21 2B00*       C      	LD	HL,UB.ZN
  55E3*   35             C      	DEC	(HL)
  55E4*   18 F6          C      	JR	$-8
                         C      ;---------------------------------------------------------------------
  55E6*                  C      U1.KRWE:
  55E6*   CD 60A4*       C      	CALL	UR.KRE
  55E9*   CD 60B2*       C      	CALL	UR.KRWW
  55EC*   C9             C      	RET
                         C      ;---------------------------------------------------------------------
                         C      ;	END
                         C      	TITLE 'Handling f. IX/IY-adressierte Bereiche'
                         C      	PAGE
'Handling f. IX/IY-adressierte Bereiche'	MACRO-80 3.44	09-Dec-81	PAGE	1-8


                         C
                         C      ;	PN	XY ; Unterprogramme
                         C      ;**********************************************************************
                         C      ;*                                                                    *
                         C      ;*       Handling f. IX/IY-adressierte Steuer-Bloecke bzw.            *
                         C      ;*                                     Arbeits-Bereiche               *
                         C      ;*                                                                    *
                         C      ;*--------------------------------------------------------------------*
                         C      ;*                                                                    *
                         C      ;*       Ausser den angegebenen Registern bzw. Flags wird nur noch    *
                         C      ;*       die angegebene Anzahl der ersten freien Stack-Plaetze (je    *
                         C      ;*       Byte) veraendert. Weiterer RAM-Platz wird nicht benoetigt.   *
                         C      ;*                                                                    *
                         C      ;**********************************************************************
                         C      ;*                                                                    *
                         C      ;*       Technische (Hilfs-) Unter-Programme                          *
                         C      ;*                                                                    *
                         C      ;**********************************************************************
                         C      			;
                         C      ;        Uebernahme von nach dem CALL stehenden Parameter
                         C      ;        ++++++++++++++++++++++++++++++++++++++++++++++++
                         C      ;        erwarten Stack:           Return-Adresse f.uebergeordnetes UP
                         C      ;                       (SP) -->   Return-Adresse f.CALPn
                         C      ;        geben Stack zurueck:      Return-Adresse f.uebergeordn.UP + n
                         C      ;                                  (DE)
                         C      ;                       (SP) -->   (HL)
                         C      ;        geben in Reg.zurueck:     (DE):  Wert    1.Parameter-Byte
                         C      ;                                  (HL):  Adresse 2.Parameter-Byte
                         C      ;        --------------------------------------------------------------
                         C      		             ;
  55ED*                  C      XY.CALP1	EQU	$    ; 1 Byte-Parameter
                         C      		             ; ++++++++++++++++++++++++++++++
  55ED*   E5             C      	PUSH	HL           ; Retten HL
  55EE*   E1             C      	POP	HL
                         C      		             ;
  55EF*   EB             C      	EX	DE,HL        ; DE <--> RET-Adr.f.CALPn
  55F0*   E3             C      	EX	(SP),HL
  55F1*   EB             C      	EX	DE,HL
                         C      		             ;
  55F2*   E1             C      	POP	HL           ; (SP) --> RET-Adr.f.ueberg.UP
                         C      		             ;
  55F3*   E1             C      	POP	HL           ; Laden u. korrig. ...
  55F4*   23             C      	INC	HL
  55F5*   E5             C      	PUSH	HL
  55F6*                  C      XY.CALPE:
  55F6*   2B             C      	DEC	HL
                         C      		             ;
  55F7*   3B             C      	DEC	SP           ; (SP) --> (DE)
  55F8*   3B             C      	DEC	SP
  55F9*   3B             C      	DEC	SP           ; (SP) --> (HL)
  55FA*   3B             C      	DEC	SP
                         C      		             ;
  55FB*   D5             C      	PUSH	DE           ; RET-Adr.f.CALPn
                         C      		             ;
  55FC*   5E             C      	LD	E,(HL)       ; Laden DE, HL
  55FD*   16 00          C      	LD	D,0
  55FF*   23             C      	INC	HL
                         C      		             ;
  5600*   C9             C      	RET
                         C      ;**********************************************************************
                         C      ;*                                                                    *
                         C      ;*       Lade-, Speicher- und Transport-Unterprogramme                *
                         C      ;*                                                                    *
                         C      ;**********************************************************************
                         C      ;
                         C      ;    CALL  LDDX    'Load':              HL := (IX+d)
                         C      ;    DB    d                                              Stack: 4
                         C      ;    -----------   ----------------------------------------------------
                         C      		             ;
  5601*                  C      XY.LDDX:
  5601*   CD 55ED*       C      	CALL	XY.CALP1     ; Uebernahme d
                         C      		             ;
  5604*   DD E5          C      	PUSH	IX           ; HL := IX+d
  5606*   E1             C      	POP	HL           ;               <--- LDDY
  5607*   F5             C      	PUSH	AF
  5608*   19             C      	ADD	HL,DE
  5609*   F1             C      	POP	AF
                         C      		             ;
  560A*   5E             C      	LD	E,(HL)       ; HL := (IX+d)
  560B*   23             C      	INC	HL
  560C*   56             C      	LD	D,(HL)
  560D*   EB             C      	EX	DE,HL
'Handling f. IX/IY-adressierte Bereiche'	MACRO-80 3.44	09-Dec-81	PAGE	1-9


                         C      		             ;
  560E*   D1             C      	POP	DE           ; Return
  560F*   D1             C      	POP	DE
  5610*   C9             C      	RET
                         C      		             ;
                         C      ;**********************************************************************
                         C      ;
                         C      ;    CALL  LIDX    'Load inverse':      LH := (IX+d)
                         C      ;    DB    d                                              Stack: 4
                         C      ;    -----------   ----------------------------------------------------
                         C      		             ;
  5611*                  C      XY.LIDX:
  5611*   CD 55ED*       C      	CALL	XY.CALP1     ; Uebernahme d
                         C      		             ;
  5614*   DD E5          C      	PUSH	IX           ; HL := IX+d
  5616*   E1             C      	POP	HL           ;               <--- LIDY
  5617*   F5             C      	PUSH	AF
  5618*   19             C      	ADD	HL,DE
  5619*   F1             C      	POP	AF
                         C      		             ;
  561A*   56             C      	LD	D,(HL)       ; LH := (IX+d)
  561B*   23             C      	INC	HL
  561C*   5E             C      	LD	E,(HL)
  561D*   EB             C      	EX	DE,HL
                         C      		             ;
  561E*   D1             C      	POP	DE           ; Return
  561F*   D1             C      	POP	DE
  5620*   C9             C      	RET
                         C      		             ;
                         C      ;**********************************************************************
                         C      ;
                         C      ;    CALL  STDX    'Store':            (IX+d) := HL
                         C      ;    DB    d                                                  Stack: 4
                         C      ;    -----------   ----------------------------------------------------
                         C      		             ;
  5621*                  C      XY.STDX:
  5621*   CD 55ED*       C      	CALL	XY.CALP1     ; Uebernahme d
                         C      		             ;
  5624*   DD E5          C      	PUSH	IX           ; HL := IX+d
  5626*   E1             C      	POP	HL           ;               <--- STDY
  5627*   F5             C      	PUSH	AF
  5628*   19             C      	ADD	HL,DE
  5629*   F1             C      	POP	AF
                         C      		             ;
  562A*   D1             C      	POP	DE
  562B*   73             C      	LD	(HL),E       ; (IX+d) := HL
  562C*   23             C      	INC	HL
  562D*   72             C      	LD	(HL),D
  562E*   EB             C      	EX	DE,HL
                         C      		             ;
  562F*   D1             C      	POP	DE           ; Return
  5630*   C9             C      	RET
                         C      		             ;
                         C      ;**********************************************************************
                         C      ;
                         C      ;    CALL  STIDX    'Store inverse':    (IX+d) := LH
                         C      ;    DB    d                                                  Stack: 4
                         C      ;    -----------   ----------------------------------------------------
                         C      		             ;
  5631*                  C      XY.STIDX:
  5631*   CD 55ED*       C      	CALL	XY.CALP1     ; Uebernahme d
                         C      		             ;
  5634*   DD E5          C      	PUSH	IX           ; HL := IX+d
  5636*   E1             C      	POP	HL           ;               <--- STIDY
  5637*   F5             C      	PUSH	AF
  5638*   19             C      	ADD	HL,DE
  5639*   F1             C      	POP	AF
                         C      		             ;
  563A*   D1             C      	POP	DE
  563B*   72             C      	LD	(HL),D       ; (IX+d) := LH
  563C*   23             C      	INC	HL
  563D*   73             C      	LD	(HL),E
  563E*   EB             C      	EX	DE,HL
                         C      		             ;
  563F*   D1             C      	POP	DE           ; Return
  5640*   C9             C      	RET
                         C      		             ;
                         C      ;**********************************************************************
                         C      ;
                         C      ;    CALL  INCDX    'Increment':        (IX+d) := (IX+d) + 1
                         C      ;    DB    d                                    Flags wie ADC HL,...
                         C      ;                                                             Stack: 4
                         C      ;    -----------   ----------------------------------------------------
'Handling f. IX/IY-adressierte Bereiche'	MACRO-80 3.44	09-Dec-81	PAGE	1-10


                         C      		             ;
  5641*                  C      XY.INCDX:
  5641*   CD 55ED*       C      	CALL	XY.CALP1     ; Uebernahme d
                         C      		             ;
  5644*   DD E5          C      	PUSH	IX           ; HL := IX+d
  5646*   E1             C      	POP	HL           ;               <--- INCDY
  5647*   19             C      	ADD	HL,DE
                         C      		             ;
  5648*   5E             C      	LD	E,(HL)       ; DE := (IX+d)
  5649*   23             C      	INC	HL
  564A*   56             C      	LD	D,(HL)
                         C      		             ;
  564B*   E5             C      	PUSH	HL           ; DE := (IX+d) + 1
  564C*   21 0001        C      	LD	HL,1
  564F*   B7             C      	OR	A
  5650*   ED 5A          C      	ADC	HL,DE
  5652*   EB             C      	EX	DE,HL
  5653*   E1             C      	POP	HL
  5654*   72             C      	LD	(HL),D
  5655*   2B             C      	DEC	HL
  5656*   73             C      	LD	(HL),E
                         C      		             ;
  5657*   E1             C      	POP	HL           ; Return
  5658*   D1             C      	POP	DE
  5659*   C9             C      	RET
                         C      		             ;
                         C      ;**********************************************************************
                         C      ;*                                                                    *
                         C      ;*       Unterprogramm  'Unbedingter Sprung'                          *
                         C      ;*                                                                    *
                         C      ;**********************************************************************
                         C      ;
                         C      ;    CALL  JMPDX   'Jump':              JMP  (IX+d)
                         C      ;    DB    d                                              Stack: 4
                         C      ;                                       Achtung!
                         C      ;                                           Veraendert freie Stack-Pl.
                         C      ;    -----------   ----------------------------------------------------
                         C      		             ;
  565A*                  C      XY.JMPDX:
  565A*   CD 55ED*       C      	CALL	XY.CALP1     ; Uebernahme d
                         C      		             ;
  565D*   DD E5          C      	PUSH	IX           ; HL := IX+d
  565F*   E1             C      	POP	HL           ;               <--- JMPDY
  5660*   F5             C      	PUSH	AF
  5661*   19             C      	ADD	HL,DE
  5662*   F1             C      	POP	AF
                         C      		             ;
  5663*   5E             C      	LD	E,(HL)       ; HL := (IX+d)
  5664*   23             C      	INC	HL
  5665*   56             C      	LD	D,(HL)
  5666*   EB             C      	EX	DE,HL
                         C      		             ;
  5667*   D1             C      	POP	DE           ; Return = Jump
  5668*   E3             C      	EX	(SP),HL
  5669*   EB             C      	EX	DE,HL
  566A*   C9             C      	RET
                         C      		             ;
                         C      ;**********************************************************************
                         C      ;	END
                         C      	TITLE 'Konvertierungen'
                         C      	PAGE
'Konvertierungen'	MACRO-80 3.44	09-Dec-81	PAGE	1-11


                         C
                         C      ;	PN	UC
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;       KONVERTIERUNGEN
                         C      ;
                         C      ;----------------------------------------------------------------------
                         C      ;                            HL := HL * 10
                         C      ;                                      (ohne Kontrolle auf Uebertrag)
  566B*                  C      UC.HL10N:
  566B*   E5             C      	PUSH	HL
  566C*   D1             C      	POP	DE           ; alter Wert in DE
  566D*   29             C      	ADD	HL,HL
  566E*   29             C      	ADD	HL,HL
  566F*   19             C      	ADD	HL,DE
  5670*   29             C      	ADD	HL,HL
  5671*   C9             C      	RET
                         C      ;                            HL := HL * 10
                         C      ;                                            -->  C: Uebertrag in A
  5672*                  C      UC.HL10C:
  5672*   E5             C      	PUSH	HL
  5673*   D1             C      	POP	DE           ; alter Wert in DE
  5674*   AF             C      	XOR	A
  5675*   29             C      	ADD	HL,HL
  5676*   30 01          C      	JR	NC,$+3
  5678*   3C             C      	INC	A
  5679*   87             C      	ADD	A,A
  567A*   29             C      	ADD	HL,HL
  567B*   30 01          C      	JR	NC,$+3
  567D*   3C             C      	INC	A
  567E*   19             C      	ADD	HL,DE
  567F*   30 01          C      	JR	NC,$+3
  5681*   3C             C      	INC	A
  5682*   87             C      	ADD	A,A
  5683*   29             C      	ADD	HL,HL
  5684*   30 01          C      	JR	NC,$+3
  5686*   3C             C      	INC	A
  5687*   B7             C      	OR	A
  5688*   C8             C      	RET	Z
  5689*   37             C      	SCF
  568A*   C9             C      	RET
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      ;                            Division mit Rest:  A  := HL / DE
                         C      ;                                                HL := Rest
                         C      		             ;      Cy(A) --->  A=255
                         C      		             ;-------------------------------
  568B*                  C      UC.DIVR:
  568B*   AF             C      	XOR	A
  568C*   ED 52          C      	SBC	HL,DE
  568E*   3C             C      	INC	A
  568F*   20 03          C      	JR	NZ,$+5
  5691*   3D             C      	DEC	A
  5692*   38 03          C      	JR	C,$+5
  5694*   30 F6          C      	JR	NC,$-8
  5696*   3D             C      	DEC	A
  5697*   19             C      	ADD	HL,DE
  5698*   C9             C      	RET
                         C      		             ;
                         C      ;**********************************************************************
                         C      ;*                                                                    *
                         C      ;*       CV...               Konvertierungen     (convert ...)        *
                         C      ;*                                                                    *
                         C      ;*--------------------------------------------------------------------*
                         C      ;*       ..A..:              in A                                     *
                         C      ;*       ..?*.:              von Typ *                                *
                         C      ;*       ..?.*:              nach Typ *                               *
                         C      ;*                                                                    *
                         C      ;*       Typen:              B - binaer                               *
                         C      ;*                           X - hexadezimal ASCII                    *
                         C      ;*                           A - Adresse binaer (L,H)                 *
                         C      ;*                           D - dezimal ASCII                        *
                         C      ;*                                                                    *
                         C      ;**********************************************************************
                         C      		             ;
                         C      ;                            In A:      Binaer < 16 --> ASCII hexa
                         C      ;                            ------------------------------------------
  5699*                  C      UC.CVABX:
  5699*   E6 0F          C      	AND	0FH
  569B*   F6 30          C      	OR	30H
  569D*   FE 3A          C      	CP	3AH
  569F*   D8             C      	RET	C
'Konvertierungen'	MACRO-80 3.44	09-Dec-81	PAGE	1-12


  56A0*   C6 07          C      	ADD	A,7H
  56A2*   C9             C      	RET
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      ;                            Byte binaer (HL) --> 2 ASCII hexa (DE)
                         C      ;                                                            HL+1, DE+2
                         C      ;                            ------------------------------------------
  56A3*                  C      UC.CVBX:
  56A3*   7E             C      	LD	A,(HL)
  56A4*   23             C      	INC	HL           ; benutzt: A, 2 Stack-P.
                         C      		             ;
  56A5*   F5             C      	PUSH	AF           ;ENTRY,WENN ZEICHEN IN A
  56A6*   0F             C      	RRCA
  56A7*   0F             C      	RRCA
  56A8*   0F             C      	RRCA
  56A9*   0F             C      	RRCA
  56AA*   CD 56AE*       C      	CALL	$+4
  56AD*   F1             C      	POP	AF
                         C      		             ;
  56AE*   CD 5699*       C      	CALL	UC.CVABX
  56B1*   12             C      	LD	(DE),A
  56B2*   13             C      	INC	DE
  56B3*   C9             C      	RET
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      ;                       Adresse (L,H) binaer (HL) --> 4 ASCII hexa (DE)
                         C      ;                                                            HL+2, DE+4
                         C      ;                       -----------------------------------------------
  56B4*                  C      UC.CVAX:
  56B4*   23             C      	INC	HL
  56B5*   CD 56A3*       C      	CALL	UC.CVBX      ; benutzt: A, 3 Stack-P.
  56B8*   2B             C      	DEC	HL
  56B9*   2B             C      	DEC	HL
  56BA*   CD 56A3*       C      	CALL	UC.CVBX
  56BD*   23             C      	INC	HL
  56BE*   C9             C      	RET
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      ;                       Adresse aus HL, binaer    --> 4 ASCII hexa (DE)
                         C      ;                                                                  DE+4
                         C      ;                       -----------------------------------------------
  56BF*                  C      UC.CVHLX:
  56BF*   7C             C      	LD	A,H
  56C0*   CD 56A5*       C      	CALL	UC.CVBX+2    ; benutzt: A, 3 Stack-P.
  56C3*   7D             C      	LD	A,L
  56C4*   CD 56A5*       C      	CALL	UC.CVBX+2
  56C7*   C9             C      	RET
                         C      		             ;
                         C      		             ;
                         C      ;      ---------------------------------------------------------------
                         C      ;                            In A:     ASCII hexa --> binaer < 16
                         C      ;
                         C      ;                                       Datenfehler: Cy, A undefiniert
                         C      ;                            ------------------------------------------
  56C8*                  C      UC.CVAXB:
  56C8*   D6 30          C      	SUB	30H
  56CA*   D8             C      	RET	C            ;       (A) < '0'
  56CB*   FE 0A          C      	CP	10
  56CD*   3F             C      	CCF
  56CE*   D0             C      	RET	NC
  56CF*   FE 11          C      	CP	11H
  56D1*   D8             C      	RET	C            ; '9' < (A) < 'A'
  56D2*   FE 17          C      	CP	17H
  56D4*   3F             C      	CCF
  56D5*   D8             C      	RET	C            ; 'F' < (A)
  56D6*   D6 07          C      	SUB	7H
  56D8*   C9             C      	RET
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      ;                            2 ASCII hexa (DE) --> Byte binaer (HL)
                         C      ;                                                            DE+2, HL+1
                         C      ;
                         C      ;                                       mit Datenfehler-Behandlung
                         C      ;                            ------------------------------------------
  56D9*                  C      UC.CVXB:
  56D9*   C5             C      	PUSH	BC
                         C      		             ; benutzt: A, 3 Stack-P.
  56DA*   CD 56EA*       C      	CALL	UC.CVX1B
  56DD*   87             C      	ADD	A,A
  56DE*   87             C      	ADD	A,A
  56DF*   87             C      	ADD	A,A
  56E0*   87             C      	ADD	A,A
  56E1*   4F             C      	LD	C,A
'Konvertierungen'	MACRO-80 3.44	09-Dec-81	PAGE	1-13


                         C      		             ;
  56E2*   CD 56EA*       C      	CALL	UC.CVX1B
  56E5*   81             C      	ADD	A,C
                         C      		             ;
  56E6*   77             C      	LD	(HL),A
  56E7*   23             C      	INC	HL
  56E8*   C1             C      	POP	BC
  56E9*   C9             C      	RET
                         C      		             ;
  56EA*                  C      UC.CVX1B:
  56EA*   1A             C      	LD	A,(DE)       ; ASCII hexa (DE) --> A binaer,
  56EB*   CD 56C8*       C      	CALL	UC.CVAXB     ;                           DE+1
  56EE*   DC 56F3*       C      	CALL	C,UC.CVXER
  56F1*   13             C      	INC	DE
  56F2*   C9             C      	RET
                         C      		             ;
  56F3*                  C      UC.CVXER:
  56F3*   EB             C      	EX	DE,HL        ; Datenfehler-Behandlung hexa
  56F4*   CD 4033        C      	CALL	SY.SETCHL    ;         set cursor
  56F7*   CD 5A88*       C      	CALL 	UR.TAREP     ; <-+     tast.request
  56FA*   77             C      	LD   	(HL),A       ;   |     write in conv.-area
  56FB*   CD 56C8*       C      	CALL 	UC.CVAXB     ;   |     conv.in A
  56FE*   38 F7          C      	JR   	C,$-7        ; --+     on error ...
  5700*   CD 4036        C      	CALL	SY.RESC
  5703*   EB             C      	EX   	DE,HL
  5704*   C9             C      	RET
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      ;                       4 ASCII hexa (DE) --> Adresse (L,H) binaer (HL)
                         C      ;                                                            DE+4, HL+2
                         C      ;
                         C      ;                                       mit Datenfehler-Behandlung
                         C      ;                       -----------------------------------------------
  5705*                  C      UC.CVXA:
  5705*   23             C      	INC	HL
  5706*   CD 56D9*       C      	CALL	UC.CVXB      ; benutzt: A, 4 Stack-P.
  5709*   2B             C      	DEC	HL
  570A*   2B             C      	DEC	HL
  570B*   CD 56D9*       C      	CALL	UC.CVXB
  570E*   23             C      	INC	HL
  570F*   C9             C      	RET
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      ;                     2 Byte binaer in HL ---> 1...5-stellig dezi (DE),
                         C      ;                                                             DE+1...5
                         C      ;                                  mit Vor-Null-Unterdrueckung
                         C      ;                                                    (nach nicht-dezi),
                         C      ;                                  zu wenig Stellen -->
                         C      ;                                      '*' in der obersten angeg.Stelle
                         C      ;                      ------------------------------------------------
  5710*                  C      UC.CVBD5:
  5710*   3E 05          C      	LD	A,5          ; benutzt: A, 7 Stack-P.
  5712*   18 0E          C      	JR	$+16
  5714*                  C      UC.CVBD4:
  5714*   3E 04          C      	LD	A,4
  5716*   18 0A          C      	JR	$+12
  5718*                  C      UC.CVBD3:
  5718*   3E 03          C      	LD	A,3
  571A*   18 06          C      	JR	$+8
  571C*                  C      UC.CVBD2:
  571C*   3E 02          C      	LD	A,2
  571E*   18 02          C      	JR	$+4
  5720*                  C      UC.CVBD1:
  5720*   3E 01          C      	LD	A,1
                         C      		             ;
  5722*                  C      UC.CVBD:
  5722*   C5             C      	PUSH	BC           ; Zeichenzahl in A
  5723*   E5             C      	PUSH	HL
  5724*   47             C      	LD	B,A
  5725*   CD 572D*       C      	CALL	UC.CVBD0
  5728*   10 FB          C      	DJNZ	$-3
  572A*   E1             C      	POP	HL
  572B*   C1             C      	POP	BC
  572C*   C9             C      	RET
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      ;                          Abspaltung B-te Stelle dezi von HL nach (DE)
                         C      ;                                                                  DE+1
                         C      ;                          B-te nicht fuehrende Stelle: '*' nach (DE)
                         C      ;                          --------------------------------------------
  572D*                  C      UC.CVBD0:
  572D*   C5             C      	PUSH	BC           ; benutzt: A, 5 Stack-P.
                         C      		             ; --------
'Konvertierungen'	MACRO-80 3.44	09-Dec-81	PAGE	1-14


  572E*   7D             C      	LD	A,L
  572F*   F6 30          C      	OR	'0'
  5731*   05             C      	DEC	B
  5732*   28 29          C              JR      Z,$+43       ; -------+
                         C                                   ;        |
  5734*   D5             C              PUSH    DE           ;        |
  5735*   E5             C              PUSH    HL           ; DE := (B-1)-te Zehner-Potenz
  5736*   21 0001        C              LD      HL,1         ;        |
  5739*   CD 566B*       C              CALL    UC.HL10N     ;        |
  573C*   10 FB          C              DJNZ    $-3          ;        |
  573E*   EB             C              EX      DE,HL        ;        |
  573F*   E1             C              POP     HL           ;        |
                         C                                   ;        |
  5740*   CD 568B*       C              CALL    UC.DIVR      ; A := HL / B-te Zehner-Potenz
  5743*   D1             C              POP     DE           ;        |     HL := Rest
                         C                                   ;        |
  5744*   FE 0A          C              CP      10           ; test to decimal
  5746*   38 04          C              JR      C,$+6        ; ---+   |
  5748*   3E 2A          C              LD      A,'*'        ;    |   |
  574A*   18 11          C              JR      $+19         ; -------+
                         C                                   ; <--+   |
  574C*   F6 30          C              OR      '0'          ; conv.to decimal
                         C                                   ;        |
  574E*   FE 30          C              CP      '0'          ; Vor-Null ?
  5750*   20 0B          C              JR      NZ,$+13      ; -------+
  5752*   1B             C              DEC     DE           ;        |
  5753*   4F             C              LD      C,A          ;        |
  5754*   CD 578A*       C              CALL    UC.CVD1B     ;        |
  5757*   79             C              LD      A,C          ;        |
  5758*   13             C              INC     DE           ;        |
  5759*   30 02          C              JR      NC,$+4       ;        |
  575B*   3E 20          C              LD      A,' '        ;        |
                         C                                   ; <------+
  575D*   12             C      	LD	(DE),A
  575E*   13             C      	INC	DE
  575F*   C1             C      	POP	BC
  5760*   C9             C      	RET
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      ;                      Dezi von (DE) bis (-->DE) nicht-dezi
                         C      ;                                                --->      binaer in HL
                         C      ;
                         C      ;                         Fehler:
                         C      ;                         -------
                         C      ;                         Cy, NZ: Zahl zu gross, HL ohne letzte Ziffer
                         C      ;                         Cy, Z:  Leere Zahl (1.Position keine Ziffer),
                         C      ;                                        -->     HL = 0
                         C      ;                      ------------------------------------------------
  5761*                  C      UC.CVDB:
  5761*   26 00          C      	LD	H,0
  5763*   CD 578A*       C      	CALL	UC.CVD1B
  5766*   6F             C      	LD	L,A
  5767*   30 04          C      	JR	NC,$+6
  5769*   AF             C      	XOR	A
  576A*   6F             C      	LD	L,A
  576B*   37             C      	SCF
  576C*   C9             C      	RET                  ; ---> abend C, Z
                         C                                   ;
  576D*   13             C      	INC	DE
  576E*   CD 578A*       C      	CALL	UC.CVD1B
  5771*   3F             C      	CCF
  5772*   D0             C      	RET	NC           ; ---> normal end
  5773*   D5             C      	PUSH	DE
  5774*   F5             C      	PUSH	AF
  5775*   CD 5672*       C      	CALL	UC.HL10C
  5778*   38 0B          C      	JR	C,$+13       ; ----------+
  577A*   F1             C      	POP	AF           ;           |
  577B*   85             C      	ADD	A,L          ;           |
  577C*   6F             C      	LD	L,A          ;           |
  577D*   30 03          C      	JR	NC,$+5       ; --+       |
  577F*   24             C      	INC	H            ;   |       |
  5780*   28 04          C      	JR	Z,$+6        ;   |    ---|--+
  5782*   D1             C      	POP	DE           ; <-+       |  |
  5783*   18 E8          C      	JR	$-22         ;           |  |
                         C                         ;      <----+  !
  5785*   E1             C      	POP	HL           ; abend Cy, NZ !
  5786*   25             C      	DEC	H            ;              |
  5787*   EB             C      	EX	DE,HL        ;        <-----+
  5788*   D1             C      	POP	DE
  5789*   C9             C      	RET
                         C                                   ;
                         C      ;        --------------------------------------------------------------
                         C      ;                            Ziffer dezi (DE) ---> binaer nach A, DE+1
'Konvertierungen'	MACRO-80 3.44	09-Dec-81	PAGE	1-15


                         C      ;                                                  Cy: nicht-dezi
                         C      ;                            ------------------------------------------
  578A*                  C      UC.CVD1B:
  578A*   1A             C      	LD	A,(DE)
  578B*   D6 30          C      	SUB	30H
  578D*   D8             C      	RET	C
  578E*   FE 0A          C      	CP	10
  5790*   3F             C      	CCF
  5791*   C9             C      	RET
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      ;                    Byte binaer (HL) --> Byte ASCII-Symbol (DE)
                         C      ;                                         (sonst: 7FH )
                         C      ;                                                     HL+1, DE+1
                         C      ;                    --------------------------------------------------
  5792*                  C      UC.CVBC:
  5792*   7E             C      	LD	A,(HL)       ; benutzt: A, 0 Stack-P.
  5793*   23             C      	INC	HL           ; --------
  5794*   FE 20          C      	CP	20H
  5796*   30 02          C      	JR	NC,$+4
  5798*   3E 7F          C      	LD	A,7FH
  579A*   FE 7F          C      	CP	7FH
  579C*   38 02          C      	JR	C,$+4
  579E*   3E 7F          C      	LD	A,7FH
  57A0*   12             C      	LD	(DE),A
  57A1*   13             C      	INC	DE
  57A2*   C9             C      	RET
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      ;                       Byte ASCII-Symbol (DE)   -->   Byte binaer (HL)
                         C      ;                                                      DE+1, HL+1
                         C      ;                       -----------------------------------------------
  57A3*                  C      UC.CVCB:
  57A3*   1A             C      	LD	A,(DE)       ; benutzt: A, 0 Stack-P.
  57A4*   13             C      	INC	DE
  57A5*   FE 20          C      	CP	20H
  57A7*   38 05          C      	JR	C,$+7
  57A9*   FE 7E          C      	CP	7EH
  57AB*   30 01          C      	JR	NC,$+3
  57AD*   77             C      	LD	(HL),A
  57AE*   23             C      	INC	HL
  57AF*   C9             C      	RET
                         C      		             ;
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;      KONVERTIERUNGEN
                         C      ;
                         C      ;----------------------------------------------------------------------
  57B0*                  C      UC.DKONV:
  57B0*   7E             C      	LD	A,(HL)       ;DKOI--->ASCII
  57B1*   CD 57C4*       C      	CALL	UC.DK1       ;(HL)--->(DE)
  57B4*   12             C      	LD	(DE),A
  57B5*   23             C      	INC	HL
  57B6*   13             C      	INC	DE
  57B7*   10 F7          C      	DJNZ	UC.DKONV
  57B9*   C9             C      	RET
                         C      ;------------------------------------
  57BA*                  C      UC.KONV:
  57BA*   7E             C      	LD	A,(HL)       ;ASCII--->DKOI
  57BB*   CD 57CF*       C      	CALL	UC.CKONV     ;(HL) --->(DE)
  57BE*   12             C      	LD	(DE),A
  57BF*   23             C      	INC	HL
  57C0*   13             C      	INC	DE
  57C1*   10 F7          C      	DJNZ	UC.KONV
  57C3*   C9             C      	RET
                         C      ;-----------------------------
  57C4*                  C      UC.DK1:
  57C4*   E5             C      	PUSH	HL           ;DKOI--->ASCII
  57C5*   D5             C      	PUSH	DE
  57C6*   C5             C      	PUSH	BC
  57C7*   21 57F2*       C      	LD	HL,UC.ASCCO
  57CA*   11 5852*       C      	LD	DE,UC.DKOI
  57CD*   18 09          C      	JR	UC.DK2
  57CF*                  C      UC.CKONV:
  57CF*   E5             C      	PUSH	HL           ;ASCII ---> DKOI
  57D0*   D5             C      	PUSH	DE
  57D1*   C5             C      	PUSH	BC
  57D2*   21 5852*       C      	LD	HL,UC.DKOI   ;HL:= Anfangsadresse
  57D5*   11 57F2*       C      	LD	DE,UC.ASCCO  ;DE:= Anfangsadresse
  57D8*                  C      UC.DK2:
  57D8*   F5             C      	PUSH	AF           ;Quellcodebyte retten
  57D9*   AF             C      	XOR	A            ;CY = 0
  57DA*   ED 52          C      	SBC	HL,DE        ;Tabellendistanz berechnen
'Konvertierungen'	MACRO-80 3.44	09-Dec-81	PAGE	1-16


  57DC*   2B             C      	DEC	HL
  57DD*   E5             C      	PUSH	HL
  57DE*   C1             C      	POP	BC           ;BC:= Tabellendistanz - 1
  57DF*   EB             C      	EX	DE,HL        ;HL:= Anfangsadresse
  57E0*   F1             C      	POP	AF           ;Zeichen wieder herstellen
  57E1*   C5             C      	PUSH	BC           ;Tabellendistanz retten
  57E2*   01 0060        C      	LD	BC,UE.COTAL  ;BC:= Tabellenlaenge
  57E5*   ED B1          C      	CPIR	             ;Quellcodebyte suchen
  57E7*   37             C      	SCF                  ;CY = 1
  57E8*   C1             C      	POP	BC           ;Tabellendistanz auskellern
  57E9*   20 03          C      	JR	NZ,UC.KONV2  ;---> Quellcodebyte nicht
  57EB*   09             C      	ADD	HL,BC        ;Zielcodeadresse berechnen
  57EC*   AF             C      	XOR	A            ;CY = 0
  57ED*   7E             C      	LD	A,(HL)       ;Zielcodebyte laden
  57EE*                  C      UC.KONV2:
  57EE*   C1             C      	POP	BC
  57EF*   D1             C      	POP	DE
  57F0*   E1             C      	POP	HL
  57F1*   C9             C      	RET
                         C      ;****************************************************************
                         C      ;         ASCII - Codetabelle
                         C      ;****************************************************************
  57F2*                  C      UC.ASCCO:
  57F2*   20 21 22 23    C      	DB	' !"#$%&'
  57F6*   24 25 26       C
  57F9*   27             C      	DB	27H	;'
  57FA*   28 29 2A 2B    C      	DB	'()*+,-./'
  57FE*   2C 2D 2E 2F    C
  5802*   30 31 32 33    C      	DB	'0123456789'
  5806*   34 35 36 37    C
  580A*   38 39          C
  580C*   3A 3B 3C 3D    C      	DB	':;<=>?@'
  5810*   3E 3F 40       C
  5813*   41 42 43 44    C      	DB	'ABCDEFGHIJKLMNOPQRSTUVWXYZ'
  5817*   45 46 47 48    C
  581B*   49 4A 4B 4C    C
  581F*   4D 4E 4F 50    C
  5823*   51 52 53 54    C
  5827*   55 56 57 58    C
  582B*   59 5A          C
  582D*   5B 5C 5D 5E    C      	DB	'[\]^_`'
  5831*   5F 60          C
  5833*   61 62 63 64    C      	DB	'abcdefghijklmnopqrstuvwxyz'
  5837*   65 66 67 68    C
  583B*   69 6A 6B 6C    C
  583F*   6D 6E 6F 70    C
  5843*   71 72 73 74    C
  5847*   75 76 77 78    C
  584B*   79 7A          C
  584D*   7B 7C 7D 7E    C      	DB	'{|}~'
  5851*   7F             C      	DB	7FH	;DEL
                         C      ;***************************************************************
                         C      ;         DKOI - Codetabelle
                         C      ;***************************************************************
  5852*                  C      UC.DKOI:
  5852*   40             C      	DB	40H	;blank
  5853*   4F             C      	DB	4FH	;!
  5854*   7F             C      	DB	7FH	;"
  5855*   7B             C      	DB	7BH	;#
  5856*   5B             C      	DB	5BH	;$
  5857*   6C             C      	DB	6CH	;%
  5858*   50             C      	DB	50H	;&
  5859*   7D             C      	DB	7DH	;'
  585A*   4D             C      	DB	4DH	;(
  585B*   5D             C      	DB	5DH	;)
  585C*   5C             C      	DB	5CH	;*
  585D*   4E             C      	DB	4EH	;+
  585E*   6B             C      	DB	6BH	;,
  585F*   60             C      	DB	60H	;-
  5860*   4B             C      	DB	4BH	;.
  5861*   61             C      	DB	61H	;/
  5862*   F0             C      	DB	0F0H	;0
  5863*   F1             C      	DB	0F1H	;1
  5864*   F2             C      	DB	0F2H	;2
  5865*   F3             C      	DB	0F3H	;3
  5866*   F4             C      	DB	0F4H	;4
  5867*   F5             C      	DB	0F5H	;5
  5868*   F6             C      	DB	0F6H	;6
  5869*   F7             C      	DB	0F7H	;7
  586A*   F8             C      	DB	0F8H	;8
  586B*   F9             C      	DB	0F9H	;9
  586C*   7A             C      	DB	7AH	;:
  586D*   5E             C      	DB	5EH	;;
'Konvertierungen'	MACRO-80 3.44	09-Dec-81	PAGE	1-17


  586E*   4C             C      	DB	4CH	;<
  586F*   7E             C      	DB	7EH	;=
  5870*   6E             C      	DB	6EH	;>
  5871*   6F             C      	DB	6FH	;?
  5872*   7C             C      	DB	7CH	;@
  5873*   C1             C      	DB	0C1H	;A
  5874*   C2             C      	DB	0C2H	;B
  5875*   C3             C      	DB	0C3H	;C
  5876*   C4             C      	DB	0C4H	;D
  5877*   C5             C      	DB	0C5H	;E
  5878*   C6             C      	DB	0C6H	;F
  5879*   C7             C      	DB	0C7H	;G
  587A*   C8             C      	DB	0C8H	;H
  587B*   C9             C      	DB	0C9H	;I
  587C*   D1             C      	DB	0D1H	;J
  587D*   D2             C      	DB	0D2H	;K
  587E*   D3             C      	DB	0D3H	;L
  587F*   D4             C      	DB	0D4H	;M
  5880*   D5             C      	DB	0D5H	;N
  5881*   D6             C      	DB	0D6H	;O
  5882*   D7             C      	DB	0D7H	;P
  5883*   D8             C      	DB	0D8H	;Q
  5884*   D9             C      	DB	0D9H	;R
  5885*   E2             C      	DB	0E2H	;S
  5886*   E3             C      	DB	0E3H	;T
  5887*   E4             C      	DB	0E4H	;U
  5888*   E5             C      	DB	0E5H	;V
  5889*   E6             C      	DB	0E6H	;W
  588A*   E7             C      	DB	0E7H	;X
  588B*   E8             C      	DB	0E8H	;Y
  588C*   E9             C      	DB	0E9H	;Z
  588D*   4A             C      	DB	4AH	;[
  588E*   E0             C      	DB	0E0H	;\
  588F*   5A             C      	DB	5AH	;]
  5890*   5F             C      	DB	5FH	;^
  5891*   6D             C      	DB	6DH	;_
  5892*   79             C      	DB	79H	;`
  5893*   81             C      	DB	81H	;a
  5894*   82             C      	DB	82H	;b
  5895*   83             C      	DB	83H	;c
  5896*   84             C      	DB	84H	;d
  5897*   85             C      	DB	85H	;e
  5898*   86             C      	DB	86H	;f
  5899*   87             C      	DB	87H	;g
  589A*   88             C      	DB	88H	;h
  589B*   89             C      	DB	89H	;i
  589C*   91             C      	DB	91H	;j
  589D*   92             C      	DB	92H	;k
  589E*   93             C      	DB	93H	;l
  589F*   94             C      	DB	94H	;m
  58A0*   95             C      	DB	95H	;n
  58A1*   96             C      	DB	96H	;o
  58A2*   97             C      	DB	97H	;p
  58A3*   98             C      	DB	98H	;q
  58A4*   99             C      	DB	99H	;r
  58A5*   A2             C      	DB	0A2H	;s
  58A6*   A3             C      	DB	0A3H	;t
  58A7*   A4             C      	DB	0A4H	;u
  58A8*   A5             C      	DB	0A5H	;v
  58A9*   A6             C      	DB	0A6H	;w
  58AA*   A7             C      	DB	0A7H	;x
  58AB*   A8             C      	DB	0A8H	;y
  58AC*   A9             C      	DB	0A9H	;z
  58AD*   C0             C      	DB	0C0H	;{
  58AE*   6A             C      	DB	6AH	;|
  58AF*   D0             C      	DB	0D0H	;}
  58B0*   A1             C      	DB	0A1H	;~
  58B1*   FF             C      	DB	0FFH	;DEL
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Komprimierung'
                         C      	PAGE
'Komprimierung'	MACRO-80 3.44	09-Dec-81	PAGE	1-18


                         C
                         C      ;	PN	CP
                         C      ;**********************************************************************
                         C      ;*       COMPR:    Komprimierung                                      *
                         C      ;*                 EDIT - F/Q-Format   --->  MRES20 - Quelltextformat *
                         C      ;**********************************************************************
                         C      		             ;
  58B2*                  C      CP.COMPR	EQU	$    ; A  Uebergabe/-nahme Zeichen
                         C      		             ; HL: Status von COMPR
                         C      		             ; B:  dekr. Tabulator-Zaehler
                         C      		             ;-------------------------------
                         C      		             ; OUTA: Einzelzeichen-Ausgabe
                         C      		             ;         (Zeichen in Reg. A)
                         C      ;----------------------------------------------------------------------
                         C      		             ;
  58B2*   FE 1E          C      	CP	1EH          ; NL ?
  58B4*   28 01          C      	JR	Z,CP.NL
  58B6*   E9             C      	JP	(HL)
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      		             ; Status "New-Line"
                         C      		             ;-------------------------------
  58B7*                  C      CP.NL:
  58B7*   CD 5641*       C      	CALL	XY.INCDX     ;         Satz-Zaehler + 1
  58BA*   13             C      	DB	19
  58BB*   06 03          C      	LD	B,3          ;         noch 3 TAB erlaubt
  58BD*   3E 0A          C      	LD	A,0AH        ;         MRES20-NL
  58BF*   18 04          C      	JR	CP.OUTT
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      		             ; Status "String"
                         C      		             ;-------------------------------
  58C1*                  C      CP.STRNG:
  58C1*   FE 27          C      	CP	27H          ;         Apostroph
  58C3*   20 20          C      	JR	NZ,CP.OUT
                         C      		             ;
  58C5*                  C      CP.OUTT:
  58C5*   21 58D5*       C      	LD	HL,CP.TEXT   ;         --> Status "Text"
  58C8*   18 1B          C      	JR	CP.OUT
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      		             ; Status "Space"
                         C      		             ;-------------------------------
  58CA*                  C      CP.SPACE:
  58CA*   FE 20          C      	CP	' '
  58CC*   C8             C      	RET	Z
  58CD*   FE 09          C      	CP	09H          ;         Tabulator
  58CF*   C8             C      	RET	Z
  58D0*   21 58D5*       C      	LD	HL,CP.TEXT   ;         ---> Status "Text"
  58D3*   18 08          C      	JR	CP.TEXT+8
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      		             ; Status "Text"
                         C      		             ;-------------------------------
  58D5*                  C      CP.TEXT:
  58D5*   FE 20          C      	CP	' '
  58D7*   28 2E          C      	JR	Z,CP.TAB
  58D9*   FE 09          C      	CP	09H          ;         Tabulator
  58DB*   28 2A          C      	JR	Z,CP.TAB
  58DD*   FE 3B          C      	CP	';'
  58DF*   28 0B          C      	JR	Z,CP.SOKOM
  58E1*   FE 27          C      	CP	27H          ;         Apostroph
  58E3*   28 1D          C      	JR	Z,CP.SOSTR
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      		             ; Status "Kom"
                         C      		             ;-------------------------------
  58E5*                  C      CP.KOM	EQU	$
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      		             ; Einzelzeichen-Ausgabe u. Ret.
                         C      		             ;-------------------------------
  58E5*                  C      CP.OUT:
  58E5*   CD 61F0*       C      	CALL	UK.PUTK
  58E8*   D9             C      	EXX
  58E9*   0B             C      	DEC	BC
  58EA*   D9             C      	EXX
  58EB*   C9             C      	RET
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      		             ; Start "Kommentar"
                         C      		             ;-------------------------------
'Komprimierung'	MACRO-80 3.44	09-Dec-81	PAGE	1-19


  58EC*                  C      CP.SOKOM:
  58EC*   78             C      	LD	A,B          ;         0 oder 3 TAB vorher
  58ED*   FE 03          C      	CP	3
  58EF*   28 0A          C      	JR	Z,$+12
  58F1*   B7             C      	OR	A
  58F2*   28 07          C      	JR	Z,$+9        ;         ---+
  58F4*   3E 09          C      	LD	A,09H        ;         <-+|
  58F6*   CD 58E5*       C      	CALL	CP.OUT       ;           ||
  58F9*   10 F9          C      	DJNZ	$-5          ;         --+|
  58FB*   3E 3B          C      	LD	A,';'        ;         <--+
  58FD*   21 58E5*       C      	LD	HL,CP.KOM
  5900*   18 E3          C      	JR	CP.OUT
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      		             ; Start "String"
                         C      		             ;-------------------------------
  5902*                  C      CP.SOSTR:
  5902*   21 58C1*       C      	LD	HL,CP.STRNG
  5905*   18 DE          C      	JR	CP.OUT
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      		             ; Tabulator-Behandlung
                         C      		             ;-------------------------------
  5907*                  C      CP.TAB:
  5907*   78             C      	LD	A,B
  5908*   B7             C      	OR	A
  5909*   3E 20          C      	LD	A,' '
  590B*   28 D8          C      	JR	Z,CP.OUT
  590D*   05             C      	DEC	B
  590E*   3E 09          C      	LD	A,09H        ;         Tabulator MRES20
  5910*   21 58CA*       C      	LD	HL,CP.SPACE
  5913*   18 D0          C      	JR	CP.OUT
                         C      		             ;
                         C      ;**********************************************************************
                         C      		             ;
  5915*                  C      CP.INIT:
  5915*   06 03          C      	LD	B,3          ; Initialisierung COMPR
  5917*   21 58D5*       C      	LD	HL,CP.TEXT
  591A*   C9             C      	RET
                         C      		             ;
                         C      ;**********************************************************************
                         C      ;	END
                         C      	TITLE	'Dekomprimierung'
                         C      	PAGE
'Dekomprimierung'	MACRO-80 3.44	09-Dec-81	PAGE	1-20


                         C
                         C      ;	PN	DC
                         C      ;**********************************************************************
                         C      ;*       DCMPR:    Dekomprimierung                                    *
                         C      ;*                 MRES20-Quelltexte   --->   EDIT - Format F         *
                         C      ;**********************************************************************
                         C      		             ;
  591B*                  C      DC.DCMPR	EQU	$
                         C      		             ; A:  Uebergabe/-nahme Zeichen
                         C      		             ; HL: Status-Register DCMPR
                         C      		             ; B:  Position (Spalte)
                         C      		             ;-------------------------------
                         C      		             ; INA: Einzelzeichen-Eingabe
                         C      		             ;      nach Reg. A
                         C      ;        --------------------------------------------------------------
  591B*   04             C      	INC	B            ;         Position + 1
  591C*   E9             C      	JP	(HL)
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      		             ; Status "Neue Zeile"
                         C      		             ;-------------------------------
  591D*                  C      DC.NL:
  591D*   CD 5641*       C      	CALL	XY.INCDX     ;         Satzzaehler + 1
  5920*   13             C      	DB	19
  5921*   3E 1E          C      	LD	A,1EH        ;         EDIT-New-Line
  5923*   06 01          C      	LD	B,1          ;         Pos.=1
  5925*   21 5929*       C      	LD	HL,DC.TEXT   ;         Status "TEXT"
  5928*   C9             C      	RET
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      		             ; Status "Text"
                         C      		             ;-------------------------------
  5929*                  C      DC.TEXT:
  5929*   CD 614C*       C      	CALL	UK.GETK      ;         Einzelzeichen-Eingabe
  592C*   B7             C      	OR	A
  592D*   C8             C      	RET	Z
  592E*   FE 0A          C      	CP	0AH          ;         NL ?
  5930*   28 EB          C      	JR	Z,DC.NL
  5932*   FE 09          C      	CP	09H          ;         TAB ?
  5934*   28 01          C      	JR	Z,DC.TAB
  5936*   C9             C      	RET
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      		             ; Tabulator-Behandlung
                         C      		             ;-------------------------------
  5937*                  C      DC.TAB:
  5937*   78             C      	LD	A,B
  5938*   FE 28          C      	CP	40
  593A*   D0             C      	RET	NC
  593B*   21 5941*       C      	LD	HL,DC.SPACE  ;         ---> Status "Space"
  593E*   3E 20          C      	LD	A,' '        ;         anstelle TAB Space
  5940*   C9             C      	RET
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      		             ; Status "Space"
                         C      		             ;-------------------------------
  5941*                  C      DC.SPACE:
  5941*   78             C      	LD	A,B
  5942*   FE 0B          C      	CP	10+1
  5944*   28 0B          C      	JR	Z,DC.EOSPC
  5946*   FE 11          C      	CP	16+1
  5948*   28 07          C      	JR	Z,DC.EOSPC
  594A*   FE 24          C      	CP	35+1
  594C*   28 03          C      	JR	Z,DC.EOSPC
  594E*   3E 20          C      	LD	A,' '
  5950*   C9             C      	RET
                         C      		             ;
  5951*                  C      DC.EOSPC:
  5951*   21 5929*       C      	LD	HL,DC.TEXT   ; TAB-Position erreicht
  5954*   18 D3          C      	JR	DC.TEXT
                         C      		             ;
                         C      		             ;
                         C      ;**********************************************************************
  5956*                  C      DC.INIT:
  5956*   21 5929*       C      	LD	HL,DC.TEXT   ; Initialisierung
  5959*   06 01          C      	LD	B,1
  595B*   C9             C      	RET
                         C      		             ;
                         C      ;**********************************************************************
                         C      ;	END
                         C      	TITLE 'Routinen fuer Monitor UND Tastatur'
                         C      	PAGE
'Routinen fuer Monitor UND Tastatur'	MACRO-80 3.44	09-Dec-81	PAGE	1-21


                         C
  595C*                  C      UR.MIMO:
  595C*   D5             C      	PUSH	DE           ;Register DE, BC retten
  595D*   C5             C      	PUSH	BC
  595E*   46             C      	LD	B,(HL)       ;Anzahl einzugebender Zeichen
  595F*   23             C      	INC	HL
  5960*   4E             C      	LD	C,(HL)       ;Laenge der Zeichenkette
  5961*   23             C      	INC	HL
  5962*   5E             C      	LD	E,(HL)       ;Zeichenschluessel
  5963*   23             C      	INC	HL
  5964*   3A 2B00*       C      	LD	A,(UB.ZN)    ;Zeilennummer
  5967*   57             C      	LD	D,A          ;D:= Zeilennummer
  5968*   AF             C      	XOR	A
  5969*   B9             C      	CP	C
  596A*   28 0C          C      	JR	Z,UR.MIMO1   ;Anzeige entfaellt
  596C*   D5             C      	PUSH	DE
  596D*   CD 599E*       C      	CALL	UR.DSPZK     ;Anzeige
  5970*                  C      UR.MIMO2:
  5970*   D1             C      	POP	DE
  5971*   CD 59AB*       C      	CALL	UR.ZINP	     ;Zeicheneingabe ueber Tastatur
  5974*   C1             C      	POP	BC
  5975*   D1             C      	POP	DE
  5976*   18 07          C      	JR	UR.MIMO3
  5978*                  C      UR.MIMO1:
  5978*   D5             C      	PUSH	DE
  5979*   CD 598E*       C      	CALL	UR.BBSAD     ;BWS - Adresse berechnen
  597C*   EB             C      	EX	DE,HL        ;HL:= akt. Bildschirmposition
  597D*   18 F1          C      	JR	UR.MIMO2
  597F*                  C      UR.MIMO3:
  597F*   F5             C      	PUSH	AF
  5980*   3A 2B00*       C      	LD	A,(UB.ZN)
  5983*   3C             C      	INC	A
  5984*   FE 18          C      	CP	24
  5986*   CC 5A8E*       C      	CALL	Z,UR.BILRO   ;Zeile 24 ---> Bild rollen
  5989*   32 2B00*       C      	LD	(UB.ZN),A
  598C*   F1             C      	POP	AF
  598D*   C9             C      	RET
  598E*                  C      UR.BBSAD:
  598E*   E5             C      	PUSH	HL           ;Berechnung der BWS-Adresse
  598F*   C5             C      	PUSH	BC           ;IN:    D...Zeilennummer
  5990*   21 2FB0        C      	LD	HL,UE.BWSA-80;OUT:   DE..BWS-Adresse
  5993*   01 0050        C      	LD	BC,80        ;BC:= Zeichen/Zeile
  5996*                  C      UR.BBSA1:
  5996*   09             C      	ADD	HL,BC
  5997*   15             C      	DEC	D
  5998*   20 FC          C      	JR	NZ,UR.BBSA1
  599A*   EB             C      	EX	DE,HL
  599B*   C1             C      	POP	BC
  599C*   E1             C      	POP	HL
  599D*   C9             C      	RET
  599E*                  C      UR.DSPZK:
  599E*   D5             C      	PUSH	DE           ;Anzeige
  599F*   C5             C      	PUSH	BC           ;IN   HL...Anfangsadresse ZK
  59A0*   CD 598E*       C      	CALL	UR.BBSAD     ;      D...Zeilennummer
  59A3*   06 00          C      	LD	B,0          ;      C...Zeichenkettenlaenge
  59A5*   ED B0          C      	LDIR	             ;OUT  HL...akt. BWS-Adresse
  59A7*   EB             C      	EX	DE,HL
  59A8*   C1             C      	POP	BC
  59A9*   D1             C      	POP	DE
  59AA*   C9             C      	RET
  59AB*                  C      UR.ZINP:
  59AB*   E5             C      	PUSH	HL           ;Zeicheneingabe ueber Tastatur
  59AC*   AF             C      	XOR	A            ;IN    B...Zeichenanzahl (max.)
  59AD*   50             C      	LD	D,B          ;     HL...akt. Adresse
  59AE*   B8             C      	CP	B            ;      E...Zeichenschluessel
  59AF*   28 3D          C      	JR	Z,UR.RET0    ;keine Zeicheneingabe
  59B1*                  C      UR.ZINP1:
  59B1*   CD 4033        C      	CALL	SY.SETCHL    ;Kursor setzen
  59B4*                  C      UR.ZINP2:
  59B4*   CD 5A88*       C      	CALL	UR.TAREP     ;Tastaturabfrage
  59B7*   CD 59F8*       C      	CALL	UR.TCL       ; <---
  59BA*   CD 5A0D*       C      	CALL	UR.TCR       ; --->
  59BD*   CD 5A20*       C      	CALL	UR.TSYS      ; SYS
  59C0*   CD 5A28*       C      	CALL	UR.TQUIT     ; POS.QUIT
  59C3*   CD 5A30*       C      	CALL	UR.ZKONT     ;Zeichenkontrolle
  59C6*   CD 4036        C      	CALL	SY.RESC      ;Kursor loeschen
  59C9*   77             C      	LD	(HL),A       ;Zeichen anzeigen
  59CA*   23             C      	INC	HL           ;akt. Adresse erhoehen
  59CB*   10 E4          C      	DJNZ	UR.ZINP1     ;B > 0, naechstes Zeichen
  59CD*   CD 4033        C      	CALL	SY.SETCHL    ;Kursor setzen
  59D0*                  C      UR.ZINP5:
  59D0*   CD 5A88*       C      	CALL	UR.TAREP
'Routinen fuer Monitor UND Tastatur'	MACRO-80 3.44	09-Dec-81	PAGE	1-22


  59D3*   FE F7          C      	CP	UE.TACL
  59D5*   CC 59F1*       C      	CALL	Z,UR.ZINP7
  59D8*   FE 1E          C      	CP	UE.TAQUI
  59DA*   28 06          C      	JR	Z,UR.ZINP3   ;---> POS.QUIT
  59DC*   FE CD          C      	CP	UE.TASYS
  59DE*   28 08          C      	JR	Z,UR.ZINP4   ;---> SYS
  59E0*   18 EE          C      	JR	UR.ZINP5
  59E2*                  C      UR.ZINP3:
  59E2*   CD 4036        C      	CALL	SY.RESC      ;Kursor loeschen
  59E5*   E1             C      	POP	HL           ;BWS - Adresse auskellern
  59E6*   AF             C      	XOR	A            ;CY:= 0
  59E7*   C9             C      	RET
  59E8*                  C      UR.ZINP4:
  59E8*   CD 4036        C      	CALL	SY.RESC      ;Kursor loeschen
  59EB*   E1             C      	POP	HL
  59EC*   37             C      	SCF	             ;CY:= 1
  59ED*   C9             C      	RET
  59EE*                  C      UR.RET0:
  59EE*   E1             C      	POP	HL           ;keine Zeicheneingabe
  59EF*   AF             C      	XOR	A
  59F0*   C9             C      	RET
  59F1*                  C      UR.ZINP7:
  59F1*   CD 59F8*       C      	CALL	UR.TCL
  59F4*   33             C      	INC	SP
  59F5*   33             C      	INC	SP
  59F6*   18 BC          C      	JR	UR.ZINP2
  59F8*                  C      UR.TCL:
  59F8*   FE F7          C      	CP	UE.TACL      ;   <---
  59FA*   C0             C      	RET	NZ           ;Taste nicht gedrueckt
  59FB*   F5             C      	PUSH	AF           ;Tastencode retten
  59FC*   04             C      	INC	B
  59FD*   7A             C      	LD	A,D
  59FE*   B8             C      	CP	B
  59FF*   38 09          C      	JR	C,UR.TCLN    ;Linksbewegung nicht zulaessig
  5A01*   CD 4036        C      	CALL	SY.RESC      ;Kursor loeschen
  5A04*   2B             C      	DEC	HL           ;BWS - Adresse decrementieren
  5A05*   CD 4033        C      	CALL	SY.SETCHL    ;Kursor setzen
  5A08*   F1             C      	POP	AF           ;Code auskellern
  5A09*   C9             C      	RET
  5A0A*                  C      UR.TCLN:
  5A0A*   05             C      	DEC	B
  5A0B*   F1             C      	POP	AF
  5A0C*   C9             C      	RET
  5A0D*                  C      UR.TCR:
  5A0D*   FE F9          C      	CP	UE.TACR      ;   --->
  5A0F*   C0             C      	RET	NZ
  5A10*   F5             C      	PUSH	AF
  5A11*   78             C      	LD	A,B
  5A12*   FE 02          C      	CP	2
  5A14*   38 08          C      	JR	C,UR.TCRN
  5A16*   05             C      	DEC	B
  5A17*   CD 4036        C      	CALL	SY.RESC
  5A1A*   23             C      	INC	HL
  5A1B*   CD 4033        C      	CALL	SY.SETCHL
  5A1E*                  C      UR.TCRN:
  5A1E*   F1             C      	POP	AF
  5A1F*   C9             C      	RET
  5A20*                  C      UR.TSYS:
  5A20*   FE CD          C      	CP	UE.TASYS     ; SYS-Taste
  5A22*   C0             C      	RET	NZ
  5A23*   33             C      	INC	SP
  5A24*   33             C      	INC	SP           ;Returnadresse uebergehen
  5A25*   C3 59E8*       C      	JP	UR.ZINP4
  5A28*                  C      UR.TQUIT:
  5A28*   FE 1E          C      	CP	UE.TAQUI     ; POS.QUIT
  5A2A*   C0             C      	RET	NZ
  5A2B*   33             C      	INC	SP
  5A2C*   33             C      	INC	SP
  5A2D*   C3 59E2*       C      	JP	UR.ZINP3
  5A30*                  C      UR.ZKONT:
  5A30*   FE 7F          C      	CP	7FH
  5A32*   30 22          C      	JR	NC,UR.ZKON1
  5A34*   CB 7B          C      	BIT	7,E          ;Zeichenschluesselauswertung
  5A36*   C0             C      	RET	NZ           ;Bit 7 = L, alle Tasten erlaubt
  5A37*   FE 20          C      	CP	20H
  5A39*   C8             C      	RET	Z            ;Leertaste
  5A3A*   CB 6B          C      	BIT	5,E
  5A3C*   37             C      	SCF
  5A3D*   C4 5A5B*       C      	CALL	NZ,UR.ALPHA
  5A40*   D0             C      	RET	NC           ;Bit 5 = L, nur Buchstaben
  5A41*   CB 63          C      	BIT	4,E
  5A43*   37             C      	SCF
  5A44*   C4 5A66*       C      	CALL	NZ,UR.NUM
'Routinen fuer Monitor UND Tastatur'	MACRO-80 3.44	09-Dec-81	PAGE	1-23


  5A47*   D0             C      	RET	NC           ;Bit 4 = L, nur Ziffern
  5A48*   CB 73          C      	BIT	6,E
  5A4A*   37             C      	SCF
  5A4B*   C4 5A6F*       C      	CALL	NZ,UR.ALPNU
  5A4E*   D0             C      	RET	NC           ;Bit 6 = L, Buchstaben und
                         C      		             ;            Ziffern
  5A4F*   CB 5B          C      	BIT	3,E
  5A51*   37             C      	SCF
  5A52*   C4 5A79*       C      	CALL	NZ,UR.HEXAZ
  5A55*   D0             C      	RET	NC           ;BIT 3 = L ,HEXAZEICHEN
  5A56*                  C      UR.ZKON1:
  5A56*   33             C      	INC	SP
  5A57*   33             C      	INC	SP
  5A58*   C3 59B4*       C      	JP	UR.ZINP2     ;unerlaubter Tastencode
  5A5B*                  C      UR.ALPHA:
  5A5B*   FE 41          C      	CP	41H
  5A5D*   D8             C      	RET	C
  5A5E*   FE 5B          C      	CP	5BH
  5A60*   38 02          C      	JR	C,UR.ALPH1
  5A62*   37             C      	SCF
  5A63*   C9             C      	RET
  5A64*                  C      UR.ALPH1:
  5A64*   3F             C      	CCF
  5A65*   C9             C      	RET
  5A66*                  C      UR.NUM:
  5A66*   FE 30          C      	CP	30H
  5A68*   D8             C      	RET	C
  5A69*   FE 3A          C      	CP	3AH
  5A6B*   38 F7          C      	JR	C,UR.ALPH1
  5A6D*   37             C      	SCF
  5A6E*   C9             C      	RET
  5A6F*                  C      UR.ALPNU:
  5A6F*   CD 5A5B*       C      	CALL	UR.ALPHA
  5A72*   D0             C      	RET	NC
  5A73*   CD 5A66*       C      	CALL	UR.NUM
  5A76*   D0             C      	RET	NC
  5A77*   37             C      	SCF
  5A78*   C9             C      	RET
  5A79*                  C      UR.HEXAZ:
  5A79*   CD 5A66*       C      	CALL	UR.NUM
  5A7C*   D0             C      	RET	NC
  5A7D*   FE 41          C      	CP	'A'
  5A7F*   D8             C      	RET	C
  5A80*   FE 47          C      	CP	'G'
  5A82*   38 02          C      	JR	C,UR.HEXZ1
  5A84*   37             C      	SCF
  5A85*   C9             C      	RET
  5A86*                  C      UR.HEXZ1:
  5A86*   3F             C      	CCF
  5A87*   C9             C      	RET
                         C
  5A88*                  C      UR.TAREP:
  5A88*   CD 4026        C      	CALL	TA.ABFR1     ;TASTATURROUTINE FUER ATS
  5A8B*   28 FB          C      	JR	Z,$-3        ;ES LIEGT KEIN ZEICHEN AN
  5A8D*   C9             C      	RET
                         C
  5A8E*                  C      UR.BILRO:
  5A8E*   C5             C      	PUSH	BC
  5A8F*   D5             C      	PUSH	DE
  5A90*   E5             C      	PUSH	HL
  5A91*   01 03C0        C      	LD	BC,960
  5A94*   11 3370        C      	LD	DE,UE.BWSA+880
  5A97*   21 33C0        C      	LD	HL,UE.BWSA+960
  5A9A*   ED B0          C      	LDIR
  5A9C*   3E 20          C      	LD	A,20H        ;letzte Zeile loeschen
  5A9E*   06 50          C      	LD	B,80
  5AA0*                  C      UR.BILR1:
  5AA0*   12             C      	LD	(DE),A
  5AA1*   10 FD          C      	DJNZ	UR.BILR1
  5AA3*   E1             C      	POP	HL
  5AA4*   AF             C      	XOR	A
  5AA5*   01 0050        C      	LD	BC,80
  5AA8*   ED 42          C      	SBC	HL,BC        ;aktuelle BWS-Adresse nach  ROLL
  5AAA*   3A 2B00*       C      	LD	A,(UB.ZN)
  5AAD*   D1             C      	POP	DE
  5AAE*   C1             C      	POP	BC
  5AAF*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                                ;
                                ;	INCLUDE K1.MAC	;BAMOS/Emulator  ---  Kassettenmagnetband
                                ;	INCLUDE	KR.MAC	;Kassettengrundroutinen
                                ;	INCLUDE	UF.MAC	;Fehleranzeige und Behandlung
'Routinen fuer Monitor UND Tastatur'	MACRO-80 3.44	09-Dec-81	PAGE	1-24


                                ;	INCLUDE	UA.MAC	;Ausschriften
                                ;	INCLUDE UR.MAC	;Routinen fuer Kassette
                                ;	INCLUDE	UK.MAC	;Einzelzeicheneingabe fuer KMBG
                         C      	INCLUDE K2.MAC	;BAMOS/Emulator  ---  Kassettenmagnetband
                         C      	TITLE 'BAMOS/Emulator  ---  Kassettenmagnetband'
                         C      	PAGE
'BAMOS/Emulator  ---  Kassettenmagnetband'	MACRO-80 3.44	09-Dec-81	PAGE	1-25


                         C
                         C      ;****************************************************************
                         C      ;*               BAMOS/Emulator  ---  Kassettenmagnetband       *
                         C      ;* OS - Version  -----------------------------------------------*
                         C      ;*               Programmierer: Marcus Herbote                  *
                         C      ;* V 1 . 2       -----------------------------------------------*
                         C      ;*               Stand        : 18.November 2022                *
                         C      ;****************************************************************
                         C
                         C      ;****************************************************************
                         C      ;*               BAMOS/Robotron         Stand: 01.Januar 1981   *
                         C      ;*               -----------------------------------------------*
                         C      ;*               Geraetebedienroutine fuer Kassettenmagnetband  *
                         C      ;*               Anschluss von zwei Laufwerken K5200            *
                         C      ;*               an einer AKB K5020                             *
                         C      ;*               -----------------------------------------------*
                         C      ;*               E/A-Tabelle                                    *
                         C      ;*               Byte -2   HS-Bereich                           *
                         C      ;*               Byte -1   laenge der Daten im Puffer           *
                         C      ;*                         1, 10H, 20H, 80H                     *
                         C      ;*               -----------------------------------------------*
                         C      ;*               Byte  0   Status                               *
                         C      ;*               Byte  1   Fehlerschluessel                     *
                         C      ;*               Byte  2   Basisadresse der AKB                 *
                         C      ;*               Byte  3   Subadresse                           *
                         C      ;*               Byte  4   Kommando                             *
                         C      ;*               Byte  5   L-Teil Adresse Eintrittspunkt        *
                         C      ;*               Byte  6   H-Teil Adresse Eintrittspunkt        *
                         C      ;*               Byte  7   L-Teil Blockadresse                  *
                         C      ;*               Byte  8   H-Teil Blockadresse                  *
                         C      ;*               Byte  9   H-Teil Blocklaenge (Bit 15...Bit 8)  *
                         C      ;*               Byte 10   L-Teil Blocklaenge (Bit  7...Bit 0)  *
                         C      ;*                         n      bei suchen Bandmarke          *
                         C      ;*               Byte 11   Anzahl Lese-/Schreib wiederholen     *
                         C      ;*               Byte 12   Anzahl Blocklueckenverlaengerungen   *
                         C      ;****************************************************************
                         C      ;*               Bytes fuer die Uebergabe an den Z80-Emulator   *
                         C      ;*               -----------------------------------------------*
                         C      ;*               Byte 28 1 0F0H  Startbyte                      *
                         C      ;*               Byte 29 2       Kommando                       *
                         C      ;*               Byte 30 3       Subadresse                     *
                         C      ;*               Byte 31 4       Anzahl BM  bei 71, 75          *
                         C      ;*               Byte 31 4       'B'        bei 51              *
                         C      ;*               Byte 31 4       'S'        bei 61              *
                         C      ;*               Byte 31 4       HS-Bereich bei 02              *
                         C      ;*               Byte 31 4       Laenge     bei 08              *
                         C      ;*               Byte 31 4 0FFH             bei 31,41,21,11,15  *
                         C      ;*               Byte 32 5       H(Puffer)  bei 02              *
                         C      ;*               Byte 32 5       HS-Bereich bei 08              *
                         C      ;*               Byte 32 5 0FFH             bei 51,61,71,75     *
                         C      ;*               Byte 33 6       L(Puffer)  bei 02              *
                         C      ;*               Byte 33 6       H(Puffer)  bei 08              *
                         C      ;*               Byte 34 7       L(Puffer)  bei 08              *
                         C      ;*               Byte 34 7 0FFH             bei 02              *
                         C      ;*               Byte 35 8 0FFH             bei 08              *
                         C      ;****************************************************************
                         C      ;*               Kommandos:                                     *
                         C      ;*                 Hex   Kommando                               *
                         C      ;*                 02    naechsten Record einlesen              *
                         C      ;*                 08    naechsten Record schreiben             *
                         C      ;*                 11    einen Block vorsetzen                  *
                         C      ;*                 15    einen Block ruecksetzen                *
                         C      ;*                 21    umspulen                               *
                         C      ;*                 31    reservieren ein                        *
                         C      ;*                 41    reservieren aus                        *
                         C      ;*                 51    schreiben einer Bandmarke              *
                         C      ;*                 61    schreiben Schlussluecke                *
                         C      ;*                 71    suche n-te Bandmarke vorwaerts         *
                         C      ;*                 75    suche n-te Bandmarke rueckwaerts       *
                         C      ;****************************************************************
                         C      	PAGE
'BAMOS/Emulator  ---  Kassettenmagnetband'	MACRO-80 3.44	09-Dec-81	PAGE	1-26


                         C
                         C      ;****************************************************************
                         C      ;*               Status                                         *
                         C      ;*               Bit 0     0 Geraet frei                        *
                         C      ;*                         1 Geraet besetzt                     *
                         C      ;*               Bit 1     0                                    *
                         C      ;*                         1 Datentraegerende                   *
                         C      ;*               Bit 2     0 Aufzeichnen erlaubt                *
                         C      ;*                         1 Aufzeichnen verboten               *
                         C      ;*               Bit 3     0 Kassettenseite A                   *
                         C      ;*                         1 Kassettenseite B                   *
                         C      ;*               Bit 4     0 Geraet       bereit                *
                         C      ;*                         1 Geraet nicht bereit                *
                         C      ;*               Bit 5     0 Geraet nicht reserviert            *
                         C      ;*                         1 Geraet       reserviert            *
                         C      ;*               Bit 6     0 Aufzeichnungsverf.  38 CM*S**-1    *
                         C      ;*                         1 Aufzeichnungsverf.  19 CM*S**-1    *
                         C      ;*               Bit 7     0 Kommando fehlerfrei ausgefuehrt    *
                         C      ;*                         1 Fehler (siehe Fehlerschluessel)    *
                         C      ;*               -----------------------------------------------*
                         C      ;*               Fehlerschluessel                               *
                         C      ;*                 Hex   Fehler                                 *
                         C      ;*                 10    falsches Kommando                      *
                         C      ;*                 11    angewaehltes Geraet nicht reserviert   *
                         C      ;*                 12    Subadresse falsch                      *
                         C      ;*                 13    Pufferl. kleiner 12 oder groesser 256  *
                         C      ;*                 14    Ende der Aufzeichnungen auf dieser     *
                         C      ;*                       Kassettenseite (Lesen)                 *
                         C      ;*                 15    angewaehltes Geraet besetzt            *
                         C      ;*                 16    Ende/Anfang der Aufzeichnungen         *
                         C      ;*                       (Bandmarke suchen)                     *
                         C      ;*                 17    gelesener Block laenger 260 Byte       *
                         C      ;*                 18    Bandmarke nicht gefunden               *
                         C      ;*                 19    Aufzeichnen verboten                   *
                         C      ;*                       (mit Kommando: Aufzeichnen)            *
                         C      ;*               -----------------------------------------------*
                         C      ;*               nachfolgende Codes nicht bei DEG2000-Emulator  *
                         C      ;*                 21    Fehler nach festgelegter Anzahl        *
                         C      ;*                       Lesewiederholungen                     *
                         C      ;*                 22    Fehler nach festgelegter Anzahl        *
                         C      ;*                       Schreibwiederholungen                  *
                         C      ;*                 23    kein Echosignal vom Eingabekanal       *
                         C      ;*                       bei  RAW                               *
                         C      ;****************************************************************
                         C      ;*               Hinweise zur Arbeit mit der Geraetebedienr.    *
                         C      ;*                - E/A-Tabelle laden (Basisadresse AKB)        *
                         C      ;*                - Adresse E/A-Tabelle in IX laden             *
                         C      ;*                - laden Schluessel fuer Kommando , Subadresse *
                         C      ;*                    Adresse Eintrittspunkt                    *
                         C      ;*                - Aufruf Geraetebedienroutine immer mit       *
                         C      ;*                    CALL   KR.BRKMB                           *
                         C      ;*                - wird keine Parallelarbeit mit anderen       *
                         C      ;*                  Programmen gewuenscht , kann wie in         *
                         C      ;*                  folgendem Beispiel verfahren werden:        *
                         C      ;*                        ...                                   *
                         C      ;*                        CALL KR.BRKMB ;Aufruf                 *
                         C      ;*                  MARKE:HALT                                  *
                         C      ;*                        JR   MARKE-#                          *
                         C      ;*                  ADREP:............  ;Adresse Eintrittspunkt *
                         C      ;*                        ...                                   *
                         C      ;*                - bei Rueckkehr der Bedienroutine zum Ein-    *
                         C      ;*                  trittspunkt ist die Adresse des folgenden   *
                         C      ;*                  Befehls , bei dem der letzte Interrupt      *
                         C      ;*                  angenommen wurde , noch im SP .             *
                         C      ;*                  Wird , wie im obigen Beispiel , diese       *
                         C      ;*                  Adresse nicht mehr benoetigt , so ist der   *
                         C      ;*                  SP  um 2 zu erhoehen.                       *
                         C      ;****************************************************************
                         C      	TITLE	'Steuerteil Geraetebedienroutine'
                         C      	PAGE
'Steuerteil Geraetebedienroutine'	MACRO-80 3.44	09-Dec-81	PAGE	1-27


                         C
                         C      ;****************************************************************
                         C      ;*               Steuerteil der Geraetebedienroutine            *
                         C      ;****************************************************************
  5AB0*                  C      K1.BRKMB:
  5AB0*   F3             C          DI
  5AB1*   CD 5BA9*       C          CALL    RRET
                         C
                         C      ;****************************************************************
                         C      ;*               Analyse Kommando                               *
                         C      ;****************************************************************
  5AB4*   DD 7E 04       C          LD  A,(IX+4)
  5AB7*   FE 02          C          CP  002H    ;naechsten Record einlesen
  5AB9*   CA 5B48*       C          JP  Z,STT02
  5ABC*   FE 08          C          CP  008H    ;naechsten Record schreiben
  5ABE*   CA 5B66*       C          JP  Z,STT08
  5AC1*   FE 11          C          CP  011H    ;einen Block vorsetzen
  5AC3*   CA 5B22*       C          JP  Z,STT11
  5AC6*   FE 15          C          CP  015H    ;einen Block ruecksetzen
  5AC8*   CA 5B22*       C          JP  Z,STT15
  5ACB*   FE 21          C          CP  021H    ;umspulen
  5ACD*   CA 5B22*       C          JP  Z,STT21
  5AD0*   FE 31          C          CP  031H    ;reservieren ein
  5AD2*   CA 5B22*       C          JP  Z,STT31
  5AD5*   FE 41          C          CP  041H    ;reservieren aus
  5AD7*   CA 5B22*       C          JP  Z,STT41
  5ADA*   FE 51          C          CP  051H    ;schreiben einer Bandmarke
  5ADC*   CA 5B2E*       C          JP  Z,STT51
  5ADF*   FE 61          C          CP  061H    ;schreiben Schlussluecke
  5AE1*   CA 5B32*       C          JP  Z,STT61
  5AE4*   FE 71          C          CP  071H    ;suche n-te Bandmarke vorwaerts
  5AE6*   CA 5B36*       C          JP  Z,STT71
  5AE9*   FE 75          C          CP  075H    ;suche n-te Bandmarke rueckwaerts
  5AEB*   CA 5B36*       C          JP  Z,STT75
  5AEE*   C3 5BA5*       C          JP  STF07   ;falsches Kommando
                         C
                         C      ;****************************************************************
                         C      ;*               Kernroutine MB                                 *
                         C      ;*               -----------------------------------------------*
                         C      ;*               Schnittstelle zum DEG2000 - Emulator           *
                         C      ;****************************************************************
  5AF1*                  C      K1.KERN:
  5AF1*   DD 36 1C F0    C          LD  (IX+28),0F0H
  5AF5*   DD 7E 04       C          LD  A,(IX+4)    ;Kommando
  5AF8*   DD 77 1D       C          LD  (IX+29),A
  5AFB*   DD 7E 03       C          LD  A,(IX+3)    ;Subadresse
  5AFE*   DD 77 1E       C          LD  (IX+30),A
                         C
  5B01*   DD 4E 02       C          LD  C,(IX+2)    ;Basisadresse der AKB
  5B04*   DD E5          C          PUSH    IX
  5B06*   E1             C          POP HL
  5B07*   11 001C        C          LD  DE,28
  5B0A*   19             C          ADD  HL,DE
  5B0B*   ED B3          C          OTIR            ;KM - Routine aufrufen
  5B0D*   DD E5          C          PUSH    IX
  5B0F*   E1             C          POP HL
  5B10*   2B             C          DEC HL
  5B11*   2B             C          DEC HL
  5B12*   06 04          C          LD  B,4
  5B14*   ED B2          C          INIR            ;Status und Fehler holen
  5B16*   2B             C          DEC HL          ;Laenge der Daten im Puffer holen
  5B17*   2B             C          DEC HL
  5B18*   2B             C          DEC HL
  5B19*   DD 36 09 00    C          LD  (IX+9),0
  5B1D*   7E             C          LD  A,(HL)
  5B1E*   DD 77 0A       C          LD  (IX+10),A
  5B21*   C9             C          RET
                         C          TITLE   '4-/5-Byte IO-Kommandos'
                         C          PAGE
'4-/5-Byte IO-Kommandos'	MACRO-80 3.44	09-Dec-81	PAGE	1-28


                         C
                         C      ;****************************************************************
                         C      ;*               reservieren ein / aus                          *
                         C      ;****************************************************************
  5B22*                  C      STT31:
  5B22*                  C      STT41:
                         C      ;****************************************************************
                         C      ;*               umspulen                                       *
                         C      ;****************************************************************
  5B22*                  C      STT21:
                         C      ;****************************************************************
                         C      ;*               vor-/ruecksetzen um einen Block                *
                         C      ;****************************************************************
  5B22*                  C      STT11:
  5B22*                  C      STT15:
  5B22*   DD 36 1F FF    C          LD  (IX+31),0FFH
                         C
  5B26*   06 04          C          LD  B,4
  5B28*   CD 5AF1*       C          CALL K1.KERN
  5B2B*   C3 5BB6*       C          JP	KOMED	;Kommandoende
                         C
                         C      ;****************************************************************
                         C      ;*               schreiben einer Bandmarke                      *
                         C      ;****************************************************************
  5B2E*                  C      STT51:
  5B2E*   3E 42          C          LD  A,'B'
  5B30*   18 07          C          JR  STT5
                         C      ;****************************************************************
                         C      ;*               schreiben einer Schlussluecke                  *
                         C      ;****************************************************************
  5B32*                  C      STT61:
  5B32*   3E 53          C          LD  A,'S'
  5B34*   18 03          C          JR  STT5
                         C      ;****************************************************************
                         C      ;*               suche Bandmarke vorwaerts / rueckwaerts        *
                         C      ;****************************************************************
  5B36*                  C      STT71:
  5B36*                  C      STT75:
  5B36*   DD 7E 07       C          LD  A,(IX+7)
                         C
  5B39*                  C      STT5:
  5B39*   DD 77 1F       C          LD  (IX+31),A
  5B3C*   DD 36 20 FF    C          LD  (IX+32),0FFH
                         C
  5B40*   06 05          C          LD  B,5
  5B42*   CD 5AF1*       C          CALL K1.KERN
  5B45*   C3 5BB6*       C          JP	KOMED	;Kommandoende
                         C
                         C          TITLE   '7-/8-Byte IO-Kommandos'
                         C          PAGE
'7-/8-Byte IO-Kommandos'	MACRO-80 3.44	09-Dec-81	PAGE	1-29


                         C
                         C      ;****************************************************************
                         C      ;*               Eingabezweig                                   *
                         C      ;****************************************************************
  5B48*                  C      STT02:
  5B48*   3A 2B01*       C          LD  A,(K0.HSB)   ;HS-Bereich
  5B4B*   DD 77 1F       C          LD  (IX+31),A
                         C
  5B4E*   DD 7E 08       C          LD  A,(IX+8)
  5B51*   DD 77 20       C          LD  (IX+32),A
  5B54*   DD 7E 07       C          LD  A,(IX+7)
  5B57*   DD 77 21       C          LD  (IX+33),A
                         C
  5B5A*   DD 36 22 FF    C          LD  (IX+34),0FFH
                         C
  5B5E*   06 07          C          LD  B,7
  5B60*   CD 5AF1*       C          CALL K1.KERN
  5B63*   C3 5BB6*       C          JP	KOMED	;Kommandoende
                         C
                         C      ;****************************************************************
                         C      ;*               Aufzeichnungszweig                             *
                         C      ;****************************************************************
  5B66*                  C      STT08:
  5B66*   DD 7E 0A       C          LD  A,(IX+10)            ;Laenge der Daten im Puffer
  5B69*   DD 77 1F       C          LD  (IX+31),A
                         C
  5B6C*   3A 2B01*       C          LD  A,(K0.HSB)           ;HS-Bereich
  5B6F*   DD 77 20       C          LD  (IX+32),A
                         C
  5B72*   DD 7E 08       C          LD  A,(IX+8)
  5B75*   DD 77 21       C          LD  (IX+33),A
  5B78*   DD 7E 07       C          LD  A,(IX+7)
  5B7B*   DD 77 22       C          LD  (IX+34),A
                         C
  5B7E*   DD 36 23 FF    C          LD  (IX+35),0FFH
                         C
  5B82*   11 0E65        C          LD  DE,UE.PUF            ;Kassettenpuffer
  5B85*   DD 66 1A       C          LD  H,(IX+26)
  5B88*   DD 6E 19       C          LD  L,(IX+25)
  5B8B*   DD 46 09       C          LD  B,(IX+9)
  5B8E*   DD 4E 0A       C          LD  C,(IX+10)
  5B91*   ED B0          C          LDIR
                         C
  5B93*   06 08          C          LD  B,8
  5B95*   CD 5AF1*       C          CALL K1.KERN
  5B98*   C3 5BB6*       C          JP	KOMED	;Kommandoende
                         C
                         C          PAGE
'7-/8-Byte IO-Kommandos'	MACRO-80 3.44	09-Dec-81	PAGE	1-30


                         C
                         C      ;****************************************************************
                         C      ;*               Fehler                                         *
                         C      ;****************************************************************
  5B9B*                  C      STF99:
  5B9B*   DD 75 01       C      	LD	(IX+1),L	;Fehlerschluessel laden
  5B9E*   DD CB 00 FE    C      	SET	7,(IX+0)	;Fehlerbit setzen
  5BA2*                  C      STFRS:
  5BA2*   C3 5BB6*       C      	JP	KOMED	;Kommandoende
                         C
  5BA5*                  C      STF07:
  5BA5*   2E 10          C      	LD	L,10H	;falsches Kommando
  5BA7*   18 F2          C      	JR	STF99
                         C
                         C          PAGE
'7-/8-Byte IO-Kommandos'	MACRO-80 3.44	09-Dec-81	PAGE	1-31


                         C
                         C      ;****************************************************************
                         C      ;*               Register AF , BC , DE , HL retten in SP        *
                         C      ;****************************************************************
  5BA9*                  C      RRET:
  5BA9*   E3             C          EX  (SP),HL
  5BAA*   D5             C      	PUSH	DE
  5BAB*   C5             C      	PUSH	BC
  5BAC*   F5             C      	PUSH	AF
  5BAD*   E9             C          JP  (HL)
                         C      ;****************************************************************
                         C      ;*               Register AF , BC , DE , HL laden aus SP        *
                         C      ;****************************************************************
  5BAE*                  C      RLAD:
  5BAE*   E3             C          EX  (SP),HL
  5BAF*   33             C          INC SP
  5BB0*   33             C          INC SP
  5BB1*   F1             C      	POP	AF
  5BB2*   C1             C      	POP	BC
  5BB3*   D1             C      	POP	DE
  5BB4*   E3             C          EX  (SP),HL
  5BB5*   C9             C      	RET
                         C
                         C      ;****************************************************************
                         C      ;*               Verzweigung aus Steuerteil zum Eintrittspunkt  *
                         C      ;*               des Steuerprogrammes                           *
                         C      ;****************************************************************
  5BB6*                  C      KOMED:
  5BB6*   F3             C      	DI
  5BB7*   DD CB 00 86    C      	RES 0,(IX)
  5BBB*   CD 5BAE*       C      	CALL	RLAD
  5BBE*   FB             C      	EI
  5BBF*   C9             C      	RET
                         C
                         C          PAGE
'7-/8-Byte IO-Kommandos'	MACRO-80 3.44	09-Dec-81	PAGE	1-32


                         C
                         C      ;****************************************************************
                         C      ;*               CRC-Zeichen berechnen                          *
                         C      ;*               <B>  = Blocklaenge , 0 = 256                   *
                         C      ;*               <HL> = Pufferadresse                           *
                         C      ;*               in  DE  nach Aufruf CRC-Zeichen                *
                         C      ;*                <D> = 1.Byte , wird zuerst gesendet           *
                         C      ;*                <E> = 2.Byte , wird danach gesendet           *
                         C      ;****************************************************************
  5BC0*                  C      K1.CRC:
  5BC0*   11 0000        C      	LD	DE,0
  5BC3*                  C      CRC0:
  5BC3*   C5             C      	PUSH	BC	;Bytelaenge
  5BC4*   06 08          C      	LD	B,8
  5BC6*   4E             C      	LD	C,(HL)
  5BC7*                  C      CRC1:
  5BC7*   79             C      	LD	A,C
  5BC8*   AA             C      	XOR	D
  5BC9*   0F             C      	RRCA		;Ergebnis Antivalenz Wort-Byte/CRC-Byte,Bit 0
  5BCA*   F5             C      	PUSH	AF
  5BCB*   CB 1B          C      	RR	E	;Verschiebung von DE um 1 Bit nach rechts
  5BCD*   CB 1A          C      	RR	D
  5BCF*   F1             C      	POP	AF	;Rueckretten F
  5BD0*   30 08          C      	JR	NC,CRC2	;Sprung wenn Antivalenz 0 + 0 = 0
  5BD2*   7A             C      	LD	A,D	;Korrektur = Umkehr Bit 13/Bit 0
  5BD3*   EE 01          C      	XOR	1	;Maske fuer D
  5BD5*   57             C      	LD	D,A	;Korrektur  D
  5BD6*   7B             C      	LD	A,E
  5BD7*   EE 20          C      	XOR	20H	;Maske fuer E
  5BD9*   5F             C      	LD	E,A	;Korrektur  E
  5BDA*                  C      CRC2:
  5BDA*   CB 09          C      	RRC	C	;Schieben Datenbyte
  5BDC*   10 E9          C      	DJNZ	CRC1
  5BDE*   C1             C      	POP	BC	;Byte abgearbeitet
  5BDF*   0B             C      	DEC	BC
  5BE0*   79             C      	LD	A,C
  5BE1*   B0             C      	OR	B
  5BE2*   C8             C      	RET	Z
  5BE3*   23             C      	INC	HL
  5BE4*   18 DD          C      	JR	CRC0
                         C
                         C      ;	END
                         C      	TITLE	'Kassettengrundroutinen'
                         C      	PAGE
'Kassettengrundroutinen'	MACRO-80 3.44	09-Dec-81	PAGE	1-33


                         C
                         C      ;****************************************************************
                         C      ;*               Anschlussroutinen fuer BAMOS/Emulator          *
                         C      ;* OS - Version  -----------------------------------------------*
                         C      ;*               Programmierer: Marcus Herbote                  *
                         C      ;* V 1 . 2       -----------------------------------------------*
                         C      ;*               Stand        : 18.November 2022                *
                         C      ;****************************************************************
                         C      ;	PN	KR
                         C      ;---------------------------------------------------------------------
                         C      ;        Kassettengrundroutinen
                         C      ;---------------------------------------------------------------------
  5BE6*   5BE6*          C      	DW	$
  5BE8*   4B 31 52 45    C      	DB	'K1RE'
  5BEC*                  C      KR.GR1:
  5BEC*   3E 01          C      	LD	A,01H
  5BEE*   18 08          C      	JR	KR.GR3
                         C      ;
  5BF0*   5BF0*          C      	DW	$
  5BF2*   4B 32 52 45    C      	DB	'K2RE'
  5BF6*                  C      KR.GR2:
  5BF6*   3E 02          C      	LD	A,02H
  5BF8*                  C      KR.GR3:
  5BF8*   CD 54E2*       C      	CALL	U1.KTINI
  5BFB*   DD 77 03       C      	LD	(IX+3),A
  5BFE*   CD 60A4*       C      	CALL	UR.KRE
  5C01*   C9             C      	RET
                         C      ;-------------------------------------------------------------------
  5C02*   5C02*          C      	DW	$
  5C04*   4B 31 4C 2B    C      	DB	'K1L+'
  5C08*   CD 5BEC*       C      	CALL	KR.GR1
  5C0B*   18 09          C      	JR	$+11
                         C      ;
  5C0D*   5C0D*          C      	DW	$
  5C0F*   4B 32 4C 2B    C      	DB	'K2L+'
  5C13*   CD 5BF6*       C      	CALL	KR.GR2
  5C16*   21 0001        C      	LD	HL,1	; IX + 10 := 1 / Anzahl BM
  5C19*   CD 5621*       C      	CALL	XY.STDX
  5C1C*   09             C      	DB	9
  5C1D*   CD 60BC*       C      	CALL	UR.KLV
  5C20*   C9             C      	RET
                         C      ;---------------------------------------------------------------------
  5C21*   5C21*          C      	DW	$
  5C23*   4B 31 4C 2D    C      	DB	'K1L-'
  5C27*   CD 5BEC*       C      	CALL	KR.GR1
  5C2A*   18 09          C      	JR	$+11
                         C      ;
  5C2C*   5C2C*          C      	DW	$
  5C2E*   4B 32 4C 2D    C      	DB	'K2L-'
  5C32*   CD 5BF6*       C      	CALL	KR.GR2
  5C35*   21 0001        C      	LD	HL,1	; IX + 10 := 1 / Anzahl BM
  5C38*   CD 5621*       C      	CALL	XY.STDX
  5C3B*   09             C      	DB	9
  5C3C*   CD 60C2*       C      	CALL	UR.KLR
  5C3F*   C9             C      	RET
                         C      ;---------------------------------------------------------------------
  5C40*   5C40*          C      	DW	$
  5C42*   4B 31 52 2B    C      	DB	'K1R+'
  5C46*   CD 5BEC*       C      	CALL	KR.GR1
  5C49*   18 09          C      	JR	$+11
                         C      ;
  5C4B*   5C4B*          C      	DW	$
  5C4D*   4B 32 52 2B    C      	DB	'K2R+'
  5C51*   CD 5BF6*       C      	CALL	KR.GR2
  5C54*   CD 60D4*       C      	CALL	UR.KBV
  5C57*   C9             C      	RET
                         C      ;--------------------------------------------------------------------
  5C58*   5C58*          C      	DW	$
  5C5A*   4B 31 52 2D    C      	DB	'K1R-'
  5C5E*   CD 5BEC*       C      	CALL	KR.GR1
  5C61*   18 09          C      	JR	$+11
                         C      ;
  5C63*   5C63*          C      	DW	$
  5C65*   4B 32 52 2D    C      	DB	'K2R-'
  5C69*   CD 5BF6*       C      	CALL	KR.GR2
  5C6C*   CD 60DA*       C      	CALL	UR.KBR
  5C6F*   C9             C      	RET
                         C      ;--------------------------------------------------------------------
  5C70*   5C70*          C      	DW	$
  5C72*   4B 31 52 57    C      	DB	'K1RW'
  5C76*   CD 5BEC*       C      	CALL	KR.GR1
  5C79*   18 09          C      	JR	$+11
'Kassettengrundroutinen'	MACRO-80 3.44	09-Dec-81	PAGE	1-34


                         C      ;
  5C7B*   5C7B*          C      	DW	$
  5C7D*   4B 32 52 57    C      	DB	'K2RW'
  5C81*   CD 5BF6*       C      	CALL	KR.GR2
  5C84*   CD 60AC*       C      	CALL	UR.KRW
  5C87*   18 14          C      	JR	KR.CKRA
                         C      ;---------------------------------------------------------------------
  5C89*   5C89*          C      	DW	$
  5C8B*   4B 31 52 41    C      	DB	'K1RA'
  5C8F*   CD 5BEC*       C      	CALL	KR.GR1
  5C92*   18 09          C      	JR	$+11
                         C      ;
  5C94*   5C94*          C      	DW	$
  5C96*   4B 32 52 41    C      	DB	'K2RA'
  5C9A*   CD 5BF6*       C      	CALL	KR.GR2
  5C9D*                  C      KR.CKRA:
  5C9D*   CD 60B6*       C      	CALL	UR.KRA
  5CA0*   C9             C      	RET
                         C      ;---------------------------------------------------------------------
  5CA1*                  C      KR.KARO:
  5CA1*   CD 5AB0*       C      	CALL	UE.BRKMB	;AUFRUF PHYS.KASS.ROUTINE
  5CA4*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  5CA5*                  C      KR.VORSP:
  5CA5*   11 3327        C      	LD	DE,UE.BWSA + 10*80 +7	;327H
  5CA8*   CD 5761*       C      	CALL	UC.CVDB
  5CAB*   45             C      	LD	B,L
  5CAC*   3E 46          C      	LD	A,'F'
  5CAE*   32 2B28*       C      	LD	(UB.PAR2),A
  5CB1*   CD 60A4*       C      	CALL	UR.KRE
  5CB4*   CD 60E9*       C      	CALL	UR.POSIK
  5CB7*   C9             C      	RET
                         C      ;---------------------------------------------------------------------
  5CB8*   5CB8*          C      	DW	$
  5CBA*   58 4B 41 31    C      	DB	'XKA1'
  5CBE*   CD 5BEC*       C      	CALL	KR.GR1
  5CC1*   18 09          C      	JR	$+11
                         C      ;
  5CC3*   5CC3*          C      	DW	$
  5CC5*   58 4B 41 32    C      	DB	'XKA2'
  5CC9*   CD 5BF6*       C      	CALL	KR.GR2
  5CCC*   CD 5CA5*       C      	CALL	KR.VORSP
  5CCF*   CD 6863*       C      	CALL	FD.FDINP
  5CD2*   CD 60AC*       C      	CALL	UR.KRW
  5CD5*   CD 60B6*       C      	CALL	UR.KRA
  5CD8*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  5CD9*   5CD9*          C      	DW	$
  5CDB*   59 4B 41 31    C      	DB	'YKA1'
  5CDF*   CD 5BEC*       C      	CALL	KR.GR1
  5CE2*   18 09          C      	JR	KR.YKA1	;$+11
                         C      ;
  5CE4*   5CE4*          C      	DW	$
  5CE6*   59 4B 41 32    C      	DB	'YKA2'
  5CEA*   CD 5BF6*       C      	CALL	KR.GR2
  5CED*                  C      KR.YKA1:
  5CED*   CD 60A4*       C      	CALL	UR.KRE
  5CF0*   11 3327        C      	LD	DE,UE.BWSA + 10*80 +7	;327H
  5CF3*   CD 5761*       C      	CALL	UC.CVDB
  5CF6*   2D             C      	DEC	L
  5CF7*   28 09          C      	JR	Z,KR.YKA2	;$+11
  5CF9*   DD 75 07       C      	LD	(IX+7),L
  5CFC*   CD 5D29*       C      	CALL	KR.TYPT
  5CFF*   CD 60BC*       C      	CALL	UR.KLV
  5D02*                  C      KR.YKA2:
  5D02*   CD 68B6*       C      	CALL	FD.FDOUT
  5D05*   C9             C      	RET
                         C      ;---------------------------------------------------------------------------
  5D06*   5D06*          C      	DW	$
  5D08*   4B 31 43 4C    C      	DB	'K1CL'
  5D0C*   CD 5BEC*       C      	CALL	KR.GR1
  5D0F*   18 09          C      	JR	KR.KCL	;$+11
                         C      ;
  5D11*   5D11*          C      	DW	$
  5D13*   4B 32 43 4C    C      	DB	'K2CL'
  5D17*   CD 5BF6*       C      	CALL	KR.GR2
  5D1A*                  C      KR.KCL:
  5D1A*   CD 60C8*       C      	CALL	UR.KBM
  5D1D*   CD 60CE*       C      	CALL	UR.KSL
  5D20*   CD 60AC*       C      	CALL	UR.KRW
  5D23*   CD 60B6*       C      	CALL	UR.KRA
  5D26*   C3 000B        C      	JP	UE.SYSTB
                         C      ;--------------------------------------------------------------------
'Kassettengrundroutinen'	MACRO-80 3.44	09-Dec-81	PAGE	1-35


  5D29*                  C      KR.TYPT:
  5D29*   13             C      	INC	DE
  5D2A*   1A             C      	LD	A,(DE)
  5D2B*   32 2B28*       C      	LD	(UB.PAR2),A
  5D2E*   C9             C      	RET
                         C      ;--------------------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Fehleranzeige und Behandlung'
                         C      	PAGE
'Fehleranzeige und Behandlung'	MACRO-80 3.44	09-Dec-81	PAGE	1-36


                         C
                         C      ;	PN	UF
                         C      ;***************************************************************
                         C      ;
                         C      ;      Fehleranzeige  UND  BEHANDLUNG
                         C      ;
                         C      ;***************************************************************
  5D2F*                  C      UF.RET:
  5D2F*   F1             C      	POP	AF
  5D30*   C1             C      	POP	BC
  5D31*   D1             C      	POP	DE
  5D32*   E1             C      	POP	HL
  5D33*   C9             C      	RET
                         C      ;---------------------Ausfhr. Kass.kommando lt.Steuerblock-------------
  5D34*                  C      UF.EXEC:
  5D34*   E5             C      	PUSH	HL
  5D35*   D5             C      	PUSH	DE
  5D36*   C5             C      	PUSH	BC
  5D37*   F5             C      	PUSH	AF
  5D38*   DD CB 00 BE    C      	RES	7,(IX)
  5D3C*   DD 36 01 00    C      	LD	(IX+1),0
                         C      	;JP	KO.KO05
                         C
  5D40*   3E 01          C      	LD	A,1
  5D42*   32 2B01*       C      	LD	(K0.HSB),A	;HS-Bereich
  5D45*   DD 7E 04       C      	LD	A,(IX+4)	;Kommando
  5D48*   FE 71          C      	CP	071H
  5D4A*   28 0C          C      	JR	Z,UF.EXEC2
  5D4C*   FE 75          C      	CP	075H
  5D4E*   28 08          C      	JR	Z,UF.EXEC2
  5D50*   DD 36 07 65    C      	LD	(IX+7),LOW(UE.PUF)
  5D54*   DD 36 08 0E    C      	LD	(IX+8),HIGH(UE.PUF)
  5D58*                  C      UF.EXEC2:
  5D58*   CD 5CA1*       C      	CALL	KR.KARO
  5D5B*                  C      UF.EXEC1:
  5D5B*   DD CB 00 7E    C      	BIT	7,(IX)	;Status
  5D5F*   28 CE          C      	JR	Z,UF.RET
  5D61*   DD 7E 01       C      	LD	A,(IX+1)	;FehlerschlC<ssel
                         C      ;-------------------------Fehlerbehandlung---------------
  5D64*                  C      UF.ERANZ:
  5D64*   E5             C      	PUSH	HL
  5D65*   D5             C      	PUSH	DE
  5D66*   C5             C      	PUSH	BC
  5D67*   F5             C      	PUSH	AF
  5D68*   F5             C      	PUSH	AF
  5D69*   3E 13          C      	LD	A,19
  5D6B*   32 2B00*       C      	LD	(UB.ZN),A
  5D6E*   21 5FC7*       C      	LD	HL,UA.ZKF	;IN: <A> Fehlerschluessel
  5D71*   CD 595C*       C      	CALL	UR.MIMO
  5D74*   F1             C      	POP	AF
  5D75*   F5             C      	PUSH	AF
  5D76*   EB             C      	EX	DE,HL
  5D77*   CD 56A5*       C      	CALL	UC.CVBX+2
  5D7A*   F1             C      	POP	AF
  5D7B*   FE 17          C      	CP	17H
  5D7D*   CA 5DFF*       C      	JP	Z,UF.FL17
  5D80*   FE 18          C      	CP	18H
  5D82*   CA 5DF3*       C      	JP	Z,UF.FL18
  5D85*   FE 00          C      	CP	00H
  5D87*   CA 5DE5*       C      	JP	Z,UF.BEHB
  5D8A*   FE 11          C      	CP	11H
  5D8C*   CA 5DE5*       C      	JP	Z,UF.BEHB
  5D8F*   FE 19          C      	CP	19H
  5D91*   28 1D          C      	JR	Z,UF.AZVB
  5D93*   FE 14          C      	CP	14H
  5D95*   CA 5E02*       C      	JP	Z,UF.FL14
  5D98*   FE 16          C      	CP	16H
  5D9A*   CA 5E05*       C      	JP	Z,UF.FL16
  5D9D*   C3 5D2F*       C      	JP	UF.RET
                         C      ;----------------------------------------------------------------------
  5DA0*                  C      UF.SYS:
  5DA0*   DD 7E 01       C      	LD	A,(IX+1)
  5DA3*   11 35A8        C      	LD	DE,UE.BWSA+5A8H
  5DA6*   CD 56A5*       C      	CALL	UC.CVBX+2
  5DA9*   00             C      	NOP
  5DAA*   00             C      	NOP
  5DAB*   00             C      	NOP
  5DAC*                  C      UF.SYS1:
  5DAC*   31 0CE0        C      	LD	SP,UE.STANF
  5DAF*   C9             C      	RET
                         C      ;----------------------------------------------------------
  5DB0*                  C      UF.AZVB:
'Fehleranzeige und Behandlung'	MACRO-80 3.44	09-Dec-81	PAGE	1-37


  5DB0*   DD CB 00 96    C      	RES	2,(IX)	;Aufzeichnen verboten
  5DB4*   DD 36 04 41    C      	LD	(IX+4),41H
  5DB8*   CD 5CA1*       C      	CALL	KR.KARO
  5DBB*   DD CB 00 7E    C      	BIT	7,(IX)
  5DBF*   20 DF          C      	JR	NZ,UF.SYS
  5DC1*   21 5F37*       C      	LD	HL,UA.FRZ
  5DC4*   CD 595C*       C      	CALL	UR.MIMO
  5DC7*   38 E3          C      	JR	C,UF.SYS1
  5DC9*   DD 36 04 31    C      	LD	(IX+4),31H
  5DCD*   CD 5CA1*       C      	CALL	KR.KARO
  5DD0*   DD CB 00 66    C      	BIT	4,(IX+0)
  5DD4*   20 CA          C      	JR	NZ,UF.SYS
  5DD6*   DD CB 00 7E    C      	BIT	7,(IX+0)
  5DDA*   20 C4          C      	JR	NZ,UF.SYS
  5DDC*   DD CB 00 56    C      	BIT	2,(IX+0)
  5DE0*   20 BE          C      	JR	NZ,UF.SYS
  5DE2*   C3 5DED*       C      	JP	UF.BEHB1
                         C      ;----------------------------------------------------------
  5DE5*                  C      UF.BEHB:
  5DE5*   21 5F37*       C      	LD	HL,UA.FRZ
  5DE8*   CD 595C*       C      	CALL	UR.MIMO
  5DEB*   38 BF          C      	JR	C,UF.SYS1
                         C
  5DED*                  C      UF.BEHB1:
  5DED*                  C      KO.KO04:
  5DED*   DD 71 04       C      	LD	(IX+4),C	;FUER UF19
  5DF0*   C3 5D38*       C      	JP	UF.EXEC+4
                         C      ;---------------------------------------
  5DF3*                  C      UF.FL18:
  5DF3*   21 5F3D*       C      	LD	HL,UA.BMGF
  5DF6*   CD 595C*       C      	CALL	UR.MIMO
  5DF9*   DA 5DAC*       C      	JP	C,UF.SYS1
  5DFC*   C3 5D2F*       C      	JP	UF.RET
                         C      ;------------------------------------------
  5DFF*                  C      UF.FL17:
  5DFF*   C3 5D2F*       C      	JP	UF.RET
                         C      ;-------------------------------------
  5E02*                  C      UF.FL14:
  5E02*   C3 5D2F*       C      	JP	UF.RET
                         C
  5E05*                  C      UF.FL16:
  5E05*   21 5F37*       C      	LD	HL,UA.FRZ
  5E08*   CD 595C*       C      	CALL	UR.MIMO
  5E0B*   C3 5D2F*       C      	JP	UF.RET
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Ausschriften'
                         C      	PAGE
'Ausschriften'	MACRO-80 3.44	09-Dec-81	PAGE	1-38


                         C
                         C      ;	PN	UA01
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;     AUSSCHRIFTEN
                         C      ;
                         C      ;----------------------------------------------------------------------
  5E0E*                  C      UA.DS:
  5E0E*   00             C      	DB	0
  5E0F*   01             C      	DB	1
  5E10*   00             C      	DB	0
  5E11*   01             C      	DB	1
  5E12*   20 20 44 53    C      	DB	'  DS************   '
  5E16*   2A 2A 2A 2A    C
  5E1A*   2A 2A 2A 2A    C
  5E1E*   2A 2A 2A 2A    C
  5E22*   20 20 20       C
  5E25*   01             C      	DB	1
  5E26*   00             C      	DB	0
  5E27*   00             C      	DB	0
  5E28*   00             C      	DB	0
  5E29*   00             C      	DB	0
  5E2A*   00             C      	DB	0
  5E2B*   00             C      	DB	0
  5E2C*   00             C      	DB	0
  5E2D*   00             C      	DB	0
                         C      ;----------------------------------------------------------------------
  5E2E*                  C      UA.KNAME:
  5E2E*   06             C      	DB	06H
  5E2F*   10             C      	DB	16
  5E30*   40             C      	DB	40H
  5E31*   20 4B 61 73    C      	DB	' KassettenName: '
  5E35*   73 65 74 74    C
  5E39*   65 6E 4E 61    C
  5E3D*   6D 65 3A 20    C
  5E41*                  C      UA.NR:
  5E41*   03             C      	DB	03H
  5E42*   10             C      	DB	16
  5E43*   40             C      	DB	40H
  5E44*   20 4B 61 73    C      	DB	' Kassetten-Nr.: '
  5E48*   73 65 74 74    C
  5E4C*   65 6E 2D 4E    C
  5E50*   72 2E 3A 20    C
  5E54*                  C      UA.KOMMT:
  5E54*   0B             C      	DB	0BH
  5E55*   10             C      	DB	16
  5E56*   80             C      	DB	80H
  5E57*   20 20 20 20    C      	DB	'     Kommentar: '
  5E5B*   20 4B 6F 6D    C
  5E5F*   6D 65 6E 74    C
  5E63*   61 72 3A 20    C
                         C      ;----------------------------------------------------------------------
  5E67*                  C      UA.Z7E:
  5E67*   45 69 6E 67    C      	DB	'Eingabe      =====>     Ausgabe'
  5E6B*   61 62 65 20    C
  5E6F*   20 20 20 20    C
  5E73*   20 3D 3D 3D    C
  5E77*   3D 3D 3E 20    C
  5E7B*   20 20 20 20    C
  5E7F*   41 75 73 67    C
  5E83*   61 62 65       C
  5E86*                  C      UA.GER:
  5E86*   20 20 20 20    C      	DB	'       Geraet: '
  5E8A*   20 20 20 47    C
  5E8E*   65 72 61 65    C
  5E92*   74 3A 20       C
                         C      ;----------------------------------------------------------------------
  5E95*                  C      UA.KOPFR:
  5E95*   01             C      	DB	01H
  5E96*   33             C      	DB	51
  5E97*   80             C      	DB	80H
  5E98*   20 20 20 20    C      	DB	'                Datei               kopieren J/N ? '
  5E9C*   20 20 20 20    C
  5EA0*   20 20 20 20    C
  5EA4*   20 20 20 20    C
  5EA8*   44 61 74 65    C
  5EAC*   69 20 20 20    C
  5EB0*   20 20 20 20    C
  5EB4*   20 20 20 20    C
  5EB8*   20 20 20 20    C
  5EBC*   6B 6F 70 69    C
  5EC0*   65 72 65 6E    C
'Ausschriften'	MACRO-80 3.44	09-Dec-81	PAGE	1-39


  5EC4*   20 4A 2F 4E    C
  5EC8*   20 3F 20       C
  5ECB*                  C      UA.EABFR:
  5ECB*   01             C      	DB	01H
  5ECC*   33             C      	DB	51
  5ECD*   80             C      	DB	80H
  5ECE*   20 20 20 20    C      	DB	'                Eingaben in Ordnung  ---->   J/N ? '
  5ED2*   20 20 20 20    C
  5ED6*   20 20 20 20    C
  5EDA*   20 20 20 20    C
  5EDE*   45 69 6E 67    C
  5EE2*   61 62 65 6E    C
  5EE6*   20 69 6E 20    C
  5EEA*   4F 72 64 6E    C
  5EEE*   75 6E 67 20    C
  5EF2*   20 2D 2D 2D    C
  5EF6*   2D 3E 20 20    C
  5EFA*   20 4A 2F 4E    C
  5EFE*   20 3F 20       C
  5F01*                  C      UA.VORH:
  5F01*   01             C      	DB	1
  5F02*   33             C      	DB	51
  5F03*   80             C      	DB	80H
  5F04*   2A 2A 2A 2A    C      	DB	'************* Datei vorh.;SYS-Ende,kopieren  J/N ? '
  5F08*   2A 2A 2A 2A    C
  5F0C*   2A 2A 2A 2A    C
  5F10*   2A 20 44 61    C
  5F14*   74 65 69 20    C
  5F18*   76 6F 72 68    C
  5F1C*   2E 3B 53 59    C
  5F20*   53 2D 45 6E    C
  5F24*   64 65 2C 6B    C
  5F28*   6F 70 69 65    C
  5F2C*   72 65 6E 20    C
  5F30*   20 4A 2F 4E    C
  5F34*   20 3F 20       C
                         C      ;----------------------------------------------------------------------
  5F37*                  C      UA.FRZ:
  5F37*   02             C      	DB	2
  5F38*   03             C      	DB	3
  5F39*   80             C      	DB	80H
  5F3A*   3F 3F 20       C      	DB	'?? '
  5F3D*                  C      UA.BMGF:
  5F3D*   01             C      	DB	01H
  5F3E*   07             C      	DB	7
  5F3F*   80             C      	DB	80H
  5F40*   42 4D 20 21    C      	DB	'BM ! ??'
  5F44*   20 3F 3F       C
  5F47*                  C      UA.DOK:
  5F47*   00             C      	DB	0
  5F48*   04             C      	DB	4
  5F49*   80             C      	DB	80H
  5F4A*   69 2E 4F 2E    C      	DB	'i.O.'
  5F4E*                  C      UA.DF:
  5F4E*   00             C      	DB	0
  5F4F*   04             C      	DB	4
  5F50*   80             C      	DB	80H
  5F51*   46 68 6C 2E    C      	DB	'Fhl.'
                         C      ;----------------------------------------------------------------------
  5F55*                  C      UA.ZKDAT:
  5F55*   06             C      	DB	6
  5F56*   10             C      	DB	16
  5F57*   40             C      	DB	40H
  5F58*   20 20 20 20    C      	DB	'     Dateiname: '
  5F5C*   20 44 61 74    C
  5F60*   65 69 6E 61    C
  5F64*   6D 65 3A 20    C
  5F68*                  C      UA.ZKLAD:
  5F68*   04             C      	DB	4
  5F69*   10             C      	DB	16
  5F6A*   08             C      	DB	08H
  5F6B*   20 20 20 4C    C      	DB	'   Ladeadresse: '
  5F6F*   61 64 65 61    C
  5F73*   64 72 65 73    C
  5F77*   73 65 3A 20    C
                         C      ;------------------------------------------------------------------
  5F7B*                  C      UA.ZKBEG:
  5F7B*   04             C      	DB	4
  5F7C*   10             C      	DB	16
  5F7D*   08             C      	DB	08H
  5F7E*   20 20 20 20    C      	DB	'        Beginn: '
  5F82*   20 20 20 20    C
  5F86*   42 65 67 69    C
'Ausschriften'	MACRO-80 3.44	09-Dec-81	PAGE	1-40


  5F8A*   6E 6E 3A 20    C
  5F8E*                  C      UA.ZKEND:
  5F8E*   04             C      	DB	4
  5F8F*   10             C      	DB	16
  5F90*   08             C      	DB	08H
  5F91*   20 20 20 20    C      	DB	'          Ende: '
  5F95*   20 20 20 20    C
  5F99*   20 20 45 6E    C
  5F9D*   64 65 3A 20    C
  5FA1*                  C      UA.STADR:
  5FA1*   04             C      	DB	4
  5FA2*   10             C      	DB	16
  5FA3*   08             C      	DB	08H
  5FA4*   20 20 53 74    C      	DB	'  Startadresse: '
  5FA8*   61 72 74 61    C
  5FAC*   64 72 65 73    C
  5FB0*   73 65 3A 20    C
  5FB4*                  C      UA.ZKDL:
  5FB4*   01             C      	DB	1
  5FB5*   10             C      	DB	16
  5FB6*   20             C      	DB	20H
  5FB7*   20 4C 6F 65    C      	DB	' Loeschen J/N : '
  5FBB*   73 63 68 65    C
  5FBF*   6E 20 4A 2F    C
  5FC3*   4E 20 3A 20    C
  5FC7*                  C      UA.ZKF:
  5FC7*   00             C      	DB	0
  5FC8*   08             C      	DB	8
  5FC9*   00             C      	DB	0
  5FCA*   46 65 68 6C    C      	DB	'Fehler: '
  5FCE*   65 72 3A 20    C
                         C      ;----------------------------------------------------------------------
  5FD2*                  C      UA.ZKRES:
  5FD2*   03             C      	DB	3
  5FD3*   10             C      	DB	16
  5FD4*   10             C      	DB	10H
  5FD5*   52 65 73 65    C      	DB	'Reservebloecke: '
  5FD9*   72 76 65 62    C
  5FDD*   6C 6F 65 63    C
  5FE1*   6B 65 3A 20    C
  5FE5*                  C      UA.ZKSDT:
  5FE5*   04             C      	DB	4
  5FE6*   12             C      	DB	18
  5FE7*   40             C      	DB	40H
  5FE8*   20 20 20 20    C      	DB	'     Dateiname:   '
  5FEC*   20 44 61 74    C
  5FF0*   65 69 6E 61    C
  5FF4*   6D 65 3A 20    C
  5FF8*   20 20          C
  5FFA*                  C      UA.ZKBEL:
  5FFA*   00             C      	DB	0
  5FFB*   10             C      	DB	16
  5FFC*   00             C      	DB	0
  5FFD*   42 6C 6F 65    C      	DB	'Bloecke belegt: '
  6001*   63 6B 65 20    C
  6005*   62 65 6C 65    C
  6009*   67 74 3A 20    C
  600D*                  C      UA.ZKBLG:
  600D*   00             C      	DB	0
  600E*   10             C      	DB	16
  600F*   00             C      	DB	0
  6010*   42 6C 6F 65    C      	DB	'Bloecke gesamt: '
  6014*   63 6B 65 20    C
  6018*   67 65 73 61    C
  601C*   6D 74 3A 20    C
                         C      ;----------------------------------------------------------------------
  6020*                  C      UA.ZKBA:
  6020*   42 61 6E 64    C      	DB	'Bandanfang'
  6024*   61 6E 66 61    C
  6028*   6E 67          C
  602A*                  C      UA.ZKBM:
  602A*   42 61 6E 64    C      	DB	'Bandmarke'
  602E*   6D 61 72 6B    C
  6032*   65             C
  6033*                  C      UA.ZKSL:
  6033*   53 63 68 6C    C      	DB	'Schlussluecke'
  6037*   75 73 73 6C    C
  603B*   75 65 63 6B    C
  603F*   65             C
  6040*                  C      UA.ZKEE:
                         C      ;----------------------------------------------------------------------
  6040*                  C      UA.LD:
  6040*   26             C      	DB	38
'Ausschriften'	MACRO-80 3.44	09-Dec-81	PAGE	1-41


  6041*   0F             C      	DB	15
  6042*   80             C      	DB	80H
  6043*   20 20 20 20    C      	DB	'               '
  6047*   20 20 20 20    C
  604B*   20 20 20 20    C
  604F*   20 20 20       C
  6052*                  C      UA.ZRSCH:
  6052*   01             C      	DB	1
  6053*   16             C      	DB	22
  6054*   80             C      	DB	80H
  6055*   56 65 72 7A    C      	DB	'Verz. schreiben J/N ? '
  6059*   2E 20 73 63    C
  605D*   68 72 65 69    C
  6061*   62 65 6E 20    C
  6065*   4A 2F 4E 20    C
  6069*   3F 20          C
  606B*                  C      UA.ANZWD:
  606B*   01             C      	DB	1
  606C*   16             C      	DB	22
  606D*   80             C      	DB	80H
  606E*   41 6E 7A 65    C      	DB	'Anzeige wdhln.  J/N ? '
  6072*   69 67 65 20    C
  6076*   77 64 68 6C    C
  607A*   6E 2E 20 20    C
  607E*   4A 2F 4E 20    C
  6082*   3F 20          C
                         C      ;----------------------------------------------------------------------
  6084*                  C      UA.ALTR:
  6084*   20 41 55 53    C      	DB	' AUSGLEICH LAUFWERKSTOLERANZEN  '
  6088*   47 4C 45 49    C
  608C*   43 48 20 4C    C
  6090*   41 55 46 57    C
  6094*   45 52 4B 53    C
  6098*   54 4F 4C 45    C
  609C*   52 41 4E 5A    C
  60A0*   45 4E 20 20    C
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                         C      	TITLE 'Routinen fuer Kassette'
                         C      	PAGE
'Routinen fuer Kassette'	MACRO-80 3.44	09-Dec-81	PAGE	1-42


                         C
                         C      ;----------------------------------------------------------------------
                         C      ;   Routinen fuer KASSETTE
                         C      ;----------------------------------------------------------------------
  60A4*                  C      UR.KRE:
  60A4*   DD 36 04 31    C      	LD	(IX+4),31H
  60A8*                  C      UR.KRE1:
  60A8*   CD 5D34*       C      	CALL	UF.EXEC
  60AB*   C9             C      	RET
  60AC*                  C      UR.KRW:
  60AC*   DD 36 04 21    C      	LD	(IX+4),21H
  60B0*   18 F6          C      	JR	UR.KRE1	;Umspulen
  60B2*                  C      UR.KRWW:
  60B2*   CD 60AC*       C      	CALL	UR.KRW
  60B5*   C9             C      	RET
  60B6*                  C      UR.KRA:
  60B6*   DD 36 04 41    C      	LD	(IX+4),41H
  60BA*   18 EC          C      	JR	UR.KRE1	;Reservieren aus
  60BC*                  C      UR.KLV:
  60BC*   DD 36 04 71    C      	LD	(IX+4),71H
  60C0*   18 E6          C      	JR	UR.KRE1	;Label vorsetzen
  60C2*                  C      UR.KLR:
  60C2*   DD 36 04 75    C      	LD	(IX+4),75H
  60C6*   18 E0          C      	JR	UR.KRE1	;LABEL RUECKSETZEN
  60C8*                  C      UR.KBM:
  60C8*   DD 36 04 51    C      	LD	(IX+4),51H
  60CC*   18 DA          C      	JR	UR.KRE1	;BANDMARKE SCHREIBEN
  60CE*                  C      UR.KSL:
  60CE*   DD 36 04 61    C      	LD	(IX+4),61H
  60D2*   18 D4          C      	JR	UR.KRE1	;SCHLUSSLUECKE SCHREIBEN
  60D4*                  C      UR.KBV:
  60D4*   DD 36 04 11    C      	LD	(IX+4),11H
  60D8*   18 CE          C      	JR	UR.KRE1	;Block vorsetzen
  60DA*                  C      UR.KBR:
  60DA*   DD 36 04 15    C      	LD	(IX+4),15H
  60DE*   18 C8          C      	JR	UR.KRE1
                         C      ;--------------------------------------------------------------------
  60E0*                  C      UR.RPOS:
  60E0*   E5             C      	PUSH	HL
  60E1*   D5             C      	PUSH	DE
  60E2*   F5             C      	PUSH	AF
  60E3*   C5             C      	PUSH	BC
  60E4*   AF             C      	XOR	A
  60E5*   3D             C      	DEC	A
  60E6*   4F             C      	LD	C,A
  60E7*   18 06          C      	JR	POSIK1
  60E9*                  C      UR.POSIK:
  60E9*   E5             C      	PUSH	HL
  60EA*   D5             C      	PUSH	DE
  60EB*   F5             C      	PUSH	AF
  60EC*   C5             C      	PUSH	BC	;Positionieren
  60ED*   AF             C      	XOR	A
  60EE*   4F             C      	LD	C,A
  60EF*                  C      POSIK1:
  60EF*   06 00          C      	LD	B,0
  60F1*   11 0000        C      	LD	DE,0
  60F4*                  C      UR.LES:
  60F4*   DD 36 04 02    C      	LD	(IX+4),02H
  60F8*   CD 5D34*       C      	CALL	UF.EXEC	;BLOCK LESEN
  60FB*   DD 7E 0A       C      	LD	A,(IX+10)
  60FE*   FE 01          C      	CP	1	;BANDMARKE?
  6100*   28 19          C      	JR	Z,UR.BM
  6102*   04             C      	INC	B	;ANZAHL BLOECKE
  6103*   78             C      	LD	A,B
  6104*   FE 04          C      	CP	4
  6106*   28 21          C      	JR	Z,UR.OK
  6108*   21 0000        C      	LD	HL,0
  610B*   CD 5611*       C      	CALL	XY.LIDX
  610E*   09             C      	DB	9	;HL<--BLOCKLAENGE
  610F*   19             C      	ADD	HL,DE
  6110*   EB             C      	EX	DE,HL
  6111*   21 012C        C      	LD	HL,300
  6114*   B7             C      	OR	A
  6115*   ED 52          C      	SBC	HL,DE
  6117*   38 10          C      	JR	C,UR.OK
  6119*   18 D9          C      	JR	UR.LES
  611B*                  C      UR.BM:
  611B*   AF             C      	XOR	A
  611C*   B1             C      	OR	C
  611D*   28 04          C      	JR	Z,$+6
  611F*   C1             C      	POP	BC
  6120*   04             C      	INC	B
'Routinen fuer Kassette'	MACRO-80 3.44	09-Dec-81	PAGE	1-43


  6121*   18 C9          C      	JR	UR.POSIK+3
  6123*   C1             C      	POP	BC
  6124*   05             C      	DEC	B
  6125*   28 21          C      	JR	Z,UR.RSP
  6127*   18 C3          C      	JR	UR.POSIK+3
  6129*                  C      UR.OK:
  6129*   AF             C      	XOR	A
  612A*   B1             C      	OR	C
  612B*   28 08          C      	JR	Z,$+10
  612D*   DD 70 0A       C      	LD	(IX+10),B
  6130*   CD 60C2*       C      	CALL	UR.KLR
  6133*   18 13          C      	JR	UR.RSP
  6135*   DD 36 04 15    C      	LD	(IX+4),15H
  6139*   CD 5D34*       C      	CALL	UF.EXEC
  613C*   10 F7          C      	DJNZ	$-7
  613E*   C1             C      	POP	BC
  613F*   05             C      	DEC	B
  6140*   28 06          C      	JR	Z,UR.RSP
  6142*   DD 70 0A       C      	LD	(IX+10),B
  6145*   CD 60BC*       C      	CALL	UR.KLV
  6148*                  C      UR.RSP:
  6148*   F1             C      	POP	AF
  6149*   D1             C      	POP	DE
  614A*   E1             C      	POP	HL
  614B*   C9             C      	RET
                         C      	TITLE	'Einzelzeicheneingabe fuer KMBG'
                         C      	PAGE
'Einzelzeicheneingabe fuer KMBG'	MACRO-80 3.44	09-Dec-81	PAGE	1-44


                         C
                         C      ;	PN	UK
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;        Einzelzeicheneingabe fuer KMBG
                         C      ;
                         C      ;----------------------------------------------------------------------
  614C*                  C      UK.GETK:
  614C*   CD 5400*       C      	CALL	U1.RSAVE
  614F*   CD 5611*       C      	CALL	XY.LIDX	;HL:= Blocklaenge
  6152*   09             C      	DB	9
  6153*   E5             C      	PUSH	HL
  6154*   CD 5601*       C      	CALL	XY.LDDX
  6157*   17             C      	DB	23
  6158*   EB             C      	EX	DE,HL	;DE:= Pufferzaehler
  6159*   AF             C      	XOR	A
  615A*   E1             C      	POP	HL	;HL:= Blocklaenge
  615B*   ED 52          C      	SBC	HL,DE
  615D*   E5             C      	PUSH	HL	;Restbyteanzahl retten
  615E*   7C             C      	LD	A,H
  615F*   B5             C      	OR	L
  6160*   CC 61AC*       C      	CALL	Z,UK.KBW	;Block lesen
  6163*   E1             C      	POP	HL
  6164*   AF             C      	XOR	A
  6165*   BC             C      	CP	H
  6166*   20 05          C      	JR	NZ,UK.GETK2
  6168*   7D             C      	LD	A,L
  6169*   FE 01          C      	CP	1
  616B*   28 08          C      	JR	Z,UK.GETK3	;---> letztes Datenbyte des
  616D*                  C      UK.GETK2:
  616D*   CD 617B*       C      	CALL	UK.GETK4
  6170*   B7             C      	OR	A
  6171*                  C      UK.GETK5:
  6171*   CD 5408*       C      	CALL	U1.RRST
  6174*   C9             C      	RET
                         C      ;
                         C      ;
  6175*                  C      UK.GETK3:
  6175*   CD 617B*       C      	CALL	UK.GETK4
  6178*   37             C      	SCF
  6179*   18 F6          C      	JR	UK.GETK5
                         C      ;
  617B*                  C      UK.GETK4:
  617B*   CD 5601*       C      	CALL	XY.LDDX	;HL:= aktuelle Pufferadresse
  617E*   15             C      	DB	21
  617F*   7E             C      	LD	A,(HL)	;Datenbyte laden
  6180*   CD 5641*       C      	CALL	XY.INCDX	;Pufferzeiger erhoehen
  6183*   15             C      	DB	21
  6184*   CD 5641*       C      	CALL	XY.INCDX	;Pufferzaehler erhoehen
  6187*   17             C      	DB	23
  6188*   C9             C      	RET
                         C
                         C      ;******************************************************************
                         C      ;
                         C      ;        KMBG  Eingabepuffer bereitstellen
                         C      ;
                         C      ;*******************************************************************
  6189*                  C      UK.KLPFB:
  6189*   CD 5400*       C      	CALL	U1.RSAVE
  618C*   CD 54FB*       C      	CALL	U1.KTIN1
  618F*   21 0080        C      	LD	HL,MaxBL     ;max. Blocklaenge Kassette (100H)
  6192*   CD 5631*       C      	CALL	XY.STIDX     ;max. Blocklaenge initialisieren
  6195*   09             C      	DB	9
  6196*   E5             C      	PUSH	HL
  6197*   C1             C      	POP	BC           ;BC:= Blocklaenge
  6198*   CD 5621*       C      	CALL	XY.STDX      ;Pufferzaehler "Leer"
  619B*   17             C      	DB	23
  619C*   21 0E65        C      	LD	HL,UE.PUF    ;Systempuffer Kassette
  619F*   CD 5411*       C      	CALL	U1.CLRB      ;Systempuffer loeschen
  61A2*   21 8010        C      	LD	HL,UE.KPUFF
  61A5*   CD 5411*       C      	CALL	U1.CLRB
  61A8*   CD 5408*       C      	CALL	U1.RRST
  61AB*   C9             C      	RET
                         C
                         C      ;******************************************************************
                         C      ;
                         C      ;        Einlesen eines Blockes von Kassette
                         C      ;
                         C      ;         - Besonderheit gegenueber MBW: Blockinhalt wird vom
                         C      ;           Systempuffer in den E/A-Puffer uebertragen
                         C      ;
                         C      ;*******************************************************************
'Einzelzeicheneingabe fuer KMBG'	MACRO-80 3.44	09-Dec-81	PAGE	1-45


  61AC*                  C      UK.KBW:
  61AC*   CD 5400*       C      	CALL	U1.RSAVE
  61AF*   CD 6189*       C      	CALL	UK.KLPFB
  61B2*   DD 36 04 02    C      	LD	(IX+4),02H
  61B6*   CD 5D34*       C      	CALL	UF.EXEC
                         C      	;LD	A,(IX+9)
                         C      	;OR	(IX+10)
  61B9*   DD 7E 0A       C      	LD	A,(IX+10)	;Laenge = 1, dann BM
  61BC*   FE 01          C      	CP	1
  61BE*   28 2A          C      	JR	Z,UK.KBW1	;EOF
  61C0*   CD 5601*       C      	CALL	XY.LDDX	;HL:= Blockadresse
  61C3*   07             C      	DB	7
  61C4*   DD 46 09       C      	LD	B,(IX+9)	;BC:= Blocklaenge
  61C7*   DD 4E 0A       C      	LD	C,(IX+10)
  61CA*   E5             C      	PUSH	HL	;E/A-Puffer
  61CB*   CD 5601*       C      	CALL	XY.LDDX
  61CE*   19             C      	DB	25
  61CF*   EB             C      	EX	DE,HL
  61D0*   E1             C      	POP	HL
  61D1*   ED B0          C      	LDIR		;Transport in E/A-Puffer
  61D3*   CD 5601*       C      	CALL	XY.LDDX
  61D6*   19             C      	DB	25
  61D7*   CD 5621*       C      	CALL	XY.STDX	;Pufferzeiger auf Anfang
  61DA*   15             C      	DB	21
  61DB*   21 0000        C      	LD	HL,0
  61DE*   CD 5621*       C      	CALL	XY.STDX	;Pufferzaehler rueckstellen
  61E1*   17             C      	DB	23
  61E2*   CD 5641*       C      	CALL	XY.INCDX	;Blockzaehler incrementieren
  61E5*   11             C      	DB	17
  61E6*                  C      UK.KBW2:
  61E6*   CD 5408*       C      	CALL	U1.RRST
  61E9*   C9             C      	RET
                         C      ;
  61EA*                  C      UK.KBW1:
  61EA*   CD 5641*       C      	CALL	XY.INCDX	;Labelzaehler incrementieren
  61ED*   11             C      	DB	17
  61EE*   18 F6          C      	JR	UK.KBW2
                         C
                         C      ;********************************************************************
                         C      ;
                         C      ;        Einzelzeichenausgabe fuer KMBG
                         C      ;
                         C      ;*********************************************************************
  61F0*                  C      UK.PUTK:
  61F0*   CD 5400*       C      	CALL	U1.RSAVE
  61F3*   F5             C      	PUSH	AF	;Zeichen retten
  61F4*   CD 5601*       C      	CALL	XY.LDDX	;HL:= Pufferzaehler
  61F7*   17             C      	DB	23
  61F8*   01 0132        C      	LD	BC,UE.KMPUL	;BC:= max. Pufferlaenge
  61FB*   B7             C      	OR	A
  61FC*   ED 42          C      	SBC	HL,BC
  61FE*   3F             C      	CCF
  61FF*   CC 6239*       C      	CALL	Z,UK.KBA	;---> Puffer voll
  6202*   F1             C      	POP	AF	;Zeichen auskellern
  6203*   CD 5601*       C      	CALL	XY.LDDX
  6206*   15             C      	DB	21
  6207*   77             C      	LD	(HL),A	;Zeichen in Puffer eintragen
  6208*   CD 5641*       C      	CALL	XY.INCDX	;Pufferzeiger erhoehen
  620B*   15             C      	DB	21
  620C*   CD 5641*       C      	CALL	XY.INCDX	;Pufferzaehler erhoehen
  620F*   17             C      	DB	23
  6210*   CD 5408*       C      	CALL	U1.RRST
  6213*   C9             C      	RET
                         C
                         C      ;******************************************************************
                         C      ;
                         C      ;        Ausgabepufferbereitstellung fuer KMBG
                         C      ;
                         C      ;*******************************************************************
  6214*                  C      UK.KSPFB:
  6214*   CD 5400*       C      	CALL	U1.RSAVE
  6217*   CD 54FB*       C      	CALL	U1.KTIN1
  621A*   CD 5611*       C      	CALL	XY.LIDX
  621D*   09             C      	DB	9
  621E*   E5             C      	PUSH	HL
  621F*   C1             C      	POP	BC	;BC:= Blocklaenge
  6220*   21 0000        C      	LD	HL,0
  6223*   CD 5621*       C      	CALL	XY.STDX	;Pufferzaehler = 0
  6226*   17             C      	DB	23
  6227*   CD 5601*       C      	CALL	XY.LDDX
  622A*   19             C      	DB	25
  622B*   CD 5621*       C      	CALL	XY.STDX	;Pufferzeiger setzen
  622E*   15             C      	DB	21
'Einzelzeicheneingabe fuer KMBG'	MACRO-80 3.44	09-Dec-81	PAGE	1-46


  622F*   21 0E65        C      	LD	HL,UE.PUF
  6232*   CD 5411*       C      	CALL	U1.CLRB
  6235*   CD 5408*       C      	CALL	U1.RRST
  6238*   C9             C      	RET
                         C
                         C      ;*******************************************************************
                         C      ;
                         C      ;        Ausgabe eines Blockes auf KMBG
                         C      ;
                         C      ;*******************************************************************
  6239*                  C      UK.KBA:
  6239*   CD 5400*       C      	CALL	U1.RSAVE
  623C*   CD 6214*       C      	CALL	UK.KSPFB
  623F*   CD 5601*       C      	CALL	XY.LDDX
  6242*   07             C      	DB	7
  6243*   EB             C      	EX	DE,HL	;DE:= Blockadresse
  6244*   D5             C      	PUSH	DE	;Blockadresse retten
  6245*   CD 5611*       C      	CALL	XY.LIDX
  6248*   09             C      	DB	9
  6249*   E5             C      	PUSH	HL
  624A*   C1             C      	POP	BC	;BC:= Blocklaenge
  624B*   D1             C      	POP	DE	;DE:= Blockadresse
  624C*   C5             C      	PUSH	BC	;Blocklaenge retten
  624D*   CD 5601*       C      	CALL	XY.LDDX	;HL:= E/A-Pufferanfang
  6250*   19             C      	DB	25
  6251*   ED B0          C      	LDIR		;Block in Systempuffer
  6253*   C1             C      	POP	BC	;BC:= Blocklaenge
  6254*   E5             C      	PUSH	HL	;aktuelle Pufferadresse retten
  6255*   21 0132        C      	LD	HL,UE.KMPUL	;HL:= max. Laenge
  6258*   B7             C      	OR	A
  6259*   ED 42          C      	SBC	HL,BC	;HL:= Restbyteanzahl
  625B*   CD 5621*       C      	CALL	XY.STDX	;Pufferzaehler setzen
  625E*   17             C      	DB	23
  625F*   E5             C      	PUSH	HL
  6260*   C1             C      	POP	BC	;BC:= Restbyteanzahl
  6261*   CD 5601*       C      	CALL	XY.LDDX	;HL:= aktuelle Pufferadresse
  6264*   19             C      	DB	25
  6265*   EB             C      	EX	DE,HL	;DE:= Pufferanfang
  6266*   E1             C      	POP	HL
  6267*   ED B0          C      	LDIR
  6269*   EB             C      	EX	DE,HL	;HL:= aktuelle Pufferadresse
  626A*   CD 5621*       C      	CALL	XY.STDX	;Pufferzeiger setzen
  626D*   15             C      	DB	21
  626E*   DD 36 04 08    C      	LD	(IX+4),08H
  6272*   CD 5D34*       C      	CALL	UF.EXEC	;physische Blockausgabe
  6275*   F5             C      	PUSH	AF
  6276*   CD 5641*       C      	CALL	XY.INCDX	;Blockzaehler erhoehen
  6279*   11             C      	DB	17
  627A*   F1             C      	POP	AF
  627B*   CD 5408*       C      	CALL	U1.RRST
  627E*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                                ;
                                ;	INCLUDE	KI.MAC	;Initialisieren von MRES Kassetten
                                ;	INCLUDE	KV.MAC	;Anzeigen und Aendern des MRES-Verzeichnisses
                                ;	INCLUDE	KH.MAC	;Kommandos: KRDx und KWRx
                                ;	INCLUDE	FD.MAC	;Ein-/Ausgabe im freien Format
                                ;	INCLUDE LD.MAC	;Laden von MRES-P-Dateien
                                ;	INCLUDE RL.MAC	;Relativloader fuer O-Dateien
                                ;	INCLUDE SV.MAC	;Retten von Maschinencodeprogrammen als MRES - P-Datei
                         C      	INCLUDE K3.MAC	;MRES Routinen
                         C      	TITLE	'Initialisieren von MRES Kassetten'
                         C      	PAGE
'Initialisieren von MRES Kassetten'	MACRO-80 3.44	09-Dec-81	PAGE	1-47


                         C
                         C      ;	PN	KI
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;      INITIALISIEREN VON MRES KASSETTEN
                         C      ;
                         C      ;----------------------------------------------------------------------
  627F*   627F*          C      	DW	$
  6281*   49 4E 49 54    C      	DB	'INIT'
  6285*   21 4070        C      	LD	HL,PUF.KASS	;Puffer fuer Umbenennung Kassette loeschen
  6288*   11 4071        C      	LD	DE,PUF.KASS+1
  628B*   01 000F        C      	LD	BC,15
  628E*   36 20          C      	LD	(HL),020H
  6290*   ED B0          C      	LDIR
  6292*   3A 3327        C      	LD	A,(UE.BWSA + 10*80 +7)	;327H
  6295*   CD 55C5*       C      	CALL	U1.TST
  6298*   D8             C      	RET	C
  6299*   F5             C      	PUSH	AF
  629A*   CD 54E2*       C      	CALL	U1.KTINI
  629D*   F1             C      	POP	AF
  629E*   DD 77 03       C      	LD	(IX+3),A	;GERAETEADR. -->TAB
  62A1*   CD 60A4*       C      	CALL	UR.KRE	;RES. EIN
  62A4*   DD CB 00 56    C      	BIT	2,(IX+0)
  62A8*   28 05          C      	JR	Z,$+7
  62AA*   3E 19          C      	LD	A,19H
  62AC*   CD 5D64*       C      	CALL	UF.ERANZ
  62AF*   CD 60B2*       C      	CALL	UR.KRWW	;RUECKSPULEN MIT WARTEN
  62B2*   CD 60C8*       C      	CALL	UR.KBM	;BM SCHREIBEN
  62B5*   21 0E65        C      	LD	HL,UE.PUF	;AUFBAU 1.BLOCK
  62B8*   3E 40          C      	LD	A,40H
  62BA*   06 50          C      	LD	B,80
  62BC*   CD 55A6*       C      	CALL	U1.TR
  62BF*   3E 00          C      	LD	A,00H
  62C1*   06 30          C      	LD	B,48
  62C3*   CD 55A6*       C      	CALL	U1.TR
  62C6*   DD 36 0A 80    C      	LD	(IX+10),80H	;Blocklaenge
  62CA*   DD 36 04 08    C      	LD	(IX+4),08H	;CMD SCHREIBEN
  62CE*   CD 5D34*       C      	CALL	UF.EXEC
  62D1*   CD 637A*       C      	CALL	KI.KO03
  62D4*                  C      KI.KN:
  62D4*   CD 55B1*       C      	CALL	U1.BILO
  62D7*   3E 0D          C      	LD	A,13
  62D9*   32 2B00*       C      	LD	(UB.ZN),A	;ZEILENNR. 15
  62DC*   21 5E2E*       C      	LD	HL,UA.KNAME	;ABFRAGE KASS.NAME
  62DF*   CD 595C*       C      	CALL	UR.MIMO
  62E2*   D8             C      	RET	C
                         C      ;---\
  62E3*   E5             C      	PUSH	HL
  62E4*   C5             C      	PUSH	BC
  62E5*   11 4070        C      	LD	DE,PUF.KASS
  62E8*   01 0006        C      	LD	BC,6
  62EB*   ED B0          C      	LDIR
  62ED*   C1             C      	POP	BC
  62EE*   E1             C      	POP	HL
                         C      ;---/
  62EF*   06 06          C      	LD	B,6
  62F1*   11 0E69        C      	LD	DE,UE.PUF+4	;NAME IN PUFFER
  62F4*   CD 57BA*       C      	CALL	UC.KONV	;MIT KONVERTIERUNG IN DKOI-CODE
  62F7*                  C      KI.NMR:
  62F7*   21 5E41*       C      	LD	HL,UA.NR	;ABFR. KASS.NUMMER
  62FA*   CD 595C*       C      	CALL	UR.MIMO
  62FD*   38 D5          C      	JR	C,KI.KN	;BEI SYS-TASTE ZU VORHERIGER
                         C      ;---\
  62FF*   E5             C      	PUSH	HL
  6300*   C5             C      	PUSH	BC
  6301*   11 4076        C      	LD	DE,PUF.KASS+6
  6304*   01 0003        C      	LD	BC,3
  6307*   ED B0          C      	LDIR
  6309*   C1             C      	POP	BC
  630A*   E1             C      	POP	HL
                         C      ;---/
  630B*   06 03          C      	LD	B,3
  630D*   11 0E8A        C      	LD	DE,UE.PUF+37
  6310*   CD 57BA*       C      	CALL	UC.KONV
  6313*                  C      KI.KM:
  6313*   21 5E54*       C      	LD	HL,UA.KOMMT	;ABFR. KOMMENTAR
  6316*   CD 595C*       C      	CALL	UR.MIMO
  6319*   38 B9          C      	JR	C,KI.KN
  631B*   06 0B          C      	LD	B,11
  631D*   11 0E8D        C      	LD	DE,UE.PUF+40
  6320*   CD 57BA*       C      	CALL	UC.KONV
  6323*   CD 5D34*       C      	CALL	UF.EXEC	;3.BLOCK SCHREIBEN
'Initialisieren von MRES Kassetten'	MACRO-80 3.44	09-Dec-81	PAGE	1-48


  6326*   CD 6385*       C      	CALL	KI.RENA	;Kassette umbenennen
  6329*   CD 60C8*       C      	CALL	UR.KBM	;BM , 1.LABEL BEENDET
  632C*   21 6084*       C      	LD	HL,UA.ALTR
  632F*   11 0E65        C      	LD	DE,UE.PUF
  6332*   01 0020        C      	LD	BC,20H
  6335*   ED B0          C      	LDIR		;AUSGLEICH LFWSTLNZ->PUFFER
  6337*   DD 36 0A 20    C      	LD	(IX+10),20H	;NEUE BLOCKLAENGE
  633B*   DD 36 04 08    C      	LD	(IX+4),08H
  633F*   CD 5D34*       C      	CALL	UF.EXEC	;SCHREIBEN
  6342*   21 5E0E*       C      	LD	HL,UA.DS
  6345*   11 0E65        C      	LD	DE,UE.PUF
  6348*   01 0020        C      	LD	BC,32
  634B*   ED B0          C      	LDIR		;DS-SATZ --> PUFFER
  634D*   CD 5D34*       C      	CALL	UF.EXEC
  6350*   3E A5          C      	LD	A,0A5H
  6352*   06 20          C      	LD	B,32
  6354*   21 0E65        C      	LD	HL,UE.PUF
  6357*   CD 55A6*       C      	CALL	U1.TR
  635A*   06 68          C      	LD	B,68H	;103 VERZ.SAETZE
  635C*                  C      KI.VERZ:
  635C*   C5             C      	PUSH	BC
  635D*   CD 5D34*       C      	CALL	UF.EXEC
  6360*   C1             C      	POP	BC
  6361*   10 F9          C      	DJNZ	KI.VERZ
  6363*   CD 60C8*       C      	CALL	UR.KBM
  6366*   CD 547F*       C      	CALL	U1.VS1	;1.DATEIVORSATZ -->PUFFER
  6369*   DD 36 04 08    C      	LD	(IX+4),08H
  636D*   CD 5D34*       C      	CALL	UF.EXEC
  6370*   CD 60CE*       C      	CALL	UR.KSL	;SCHLUSSLUECKE SCHREIBEN
  6373*   CD 60AC*       C      	CALL	UR.KRW
  6376*   CD 60B6*       C      	CALL	UR.KRA
  6379*   C9             C      	RET
                         C      ;
  637A*                  C      KI.KO03:
  637A*   CD 5D34*       C      	CALL	UF.EXEC	;FUER KI14
  637D*   06 31          C      	LD	B,49
  637F*   2B             C      	DEC	HL
  6380*   10 FD          C      	DJNZ	$-1
  6382*   36 D9          C      	LD	(HL),0D9H
  6384*   C9             C      	RET
                         C      ;
  6385*                  C      KI.RENA:	;Kassettendateiname umbenennen
  6385*   E5             C      	PUSH	HL
  6386*   D5             C      	PUSH	DE
  6387*   C5             C      	PUSH	BC
  6388*   F5             C      	PUSH	AF
  6389*   21 407A        C      	LD	HL,PUF.KASS+10
  638C*   36 00          C      	LD	(HL),0          ;Abschluss neuer Name
  638E*   21 63A4*       C      	LD	HL,KI.RENA9+2
  6391*   DD 7E 03       C      	LD	A,(IX+3)        ;SubAdresse
  6394*   77             C      	LD	(HL),A
  6395*   21 63A2*       C      	LD	HL,KI.RENA9
  6398*   01 0730        C      	LD	BC,00700H + AKB ;AKB-Adresse + Laenge Parameterbereich
  639B*   ED B3          C      	OTIR
  639D*   F1             C      	POP	AF
  639E*   C1             C      	POP	BC
  639F*   D1             C      	POP	DE
  63A0*   E1             C      	POP	HL
  63A1*   C9             C      	RET
  63A2*                  C      KI.RENA9:
  63A2*   F0             C      	DB	0F0H
  63A3*   44             C      	DB	044H            ;Kommando
  63A4*   00             C      	DB	0               ;SubAdresse
  63A5*   01             C      	DB	1               ;HSbereich
  63A6*   40             C      	DB	HIGH(PUF.KASS)
  63A7*   70             C      	DB	LOW(PUF.KASS)
  63A8*   FF             C      	DB	0FFH
                         C      ;---------------------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Anzeigen und Aendern des MRES-Verzeichnisses'
                         C      	PAGE
'Anzeigen und Aendern des MRES-Verzeichnisses'	MACRO-80 3.44	09-Dec-81	PAGE	1-49


                         C
                         C      ;	PN	KV
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;    ANZEIGEN UND AENDERN DES VERZEICHNISSES VON MRES KASSETTEN
                         C      ;
                         C      ;----------------------------------------------------------------------
  63A9*   63A9*          C      	DW	$
  63AB*   44 49 52 20    C      	DB	'DIR '
  63AF*   3A 3326        C      	LD	A,(UE.BWSA + 10*80 +6)	;326H
  63B2*   CD 55C5*       C      	CALL	U1.TST
  63B5*   D8             C      	RET	C
  63B6*   CD 54E2*       C      	CALL	U1.KTINI
  63B9*   DD 77 03       C      	LD	(IX+3),A
  63BC*   CD 55B1*       C      	CALL	U1.BILO
  63BF*   CD 60A4*       C      	CALL	UR.KRE
  63C2*   CD 60B2*       C      	CALL	UR.KRWW
  63C5*   CD 5496*       C      	CALL	U1.DSVG
  63C8*   C5             C      	PUSH	BC
                         C      ;----------------------------------------------------------------------
  63C9*   CD 5420*       C      	CALL	U1.KBR4	;KASS.NAME,NR.,KOMMENTAR ANZEIGEN
  63CC*   DD 36 04 02    C      	LD	(IX+4),02H
  63D0*   CD 5D34*       C      	CALL	UF.EXEC
  63D3*   21 0E69        C      	LD	HL,UE.PUF+4
  63D6*   11 3240        C      	LD	DE,UE.BWSA + 7*80 + 16	;3240H	;=8.ZEILE,16.SPALTE
  63D9*   06 06          C      	LD	B,6
  63DB*   CD 57B0*       C      	CALL	UC.DKONV
  63DE*   21 0E8A        C      	LD	HL,UE.PUF+37
  63E1*   13             C      	INC	DE
  63E2*   13             C      	INC	DE
  63E3*   06 03          C      	LD	B,3
  63E5*   CD 57B0*       C      	CALL	UC.DKONV
  63E8*   13             C      	INC	DE
  63E9*   13             C      	INC	DE
  63EA*   06 0B          C      	LD	B,11
  63EC*   CD 57B0*       C      	CALL	UC.DKONV
  63EF*   21 3290        C      	LD	HL,UE.BWSA + 8*80 + 16	;3290H
  63F2*   3E 3D          C      	LD	A,'='
  63F4*   77             C      	LD	(HL),A
  63F5*   E5             C      	PUSH	HL
  63F6*   D1             C      	POP	DE
  63F7*   13             C      	INC	DE
  63F8*   01 0017        C      	LD	BC,23
  63FB*   ED B0          C      	LDIR
                         C      ;----------------------------------------------------------------------
  63FD*   06 03          C      	LD	B,3	;POSITIONIEREN VOR DS-SATZ
  63FF*   CD 5D34*       C      	CALL	UF.EXEC
  6402*   10 FB          C      	DJNZ	$-3
  6404*   CD 5518*       C      	CALL	U1.VERIN
  6407*   CD 60B2*       C      	CALL	UR.KRWW
  640A*   06 07          C      	LD	B,7
  640C*   CD 5542*       C      	CALL	U1.VORS1
  640F*   C1             C      	POP	BC
  6410*   05             C      	DEC	B
  6411*   CD 663E*       C      	CALL	KV.ANZ
  6414*   04             C      	INC	B
  6415*   05             C      	DEC	B
  6416*   CA 6560*       C      	JP	Z,KV.KRW
  6419*   04             C      	INC	B
  641A*   C5             C      	PUSH	BC
                         C      ;----------------------------------------------------------------------
  641B*                  C      KV.ANF:
  641B*   05             C      	DEC	B
  641C*   78             C      	LD	A,B
  641D*   58             C      	LD	E,B
  641E*   D6 09          C      	SUB	9
  6420*   38 05          C      	JR	C,$+7
  6422*   0E 09          C      	LD	C,9
  6424*   41             C      	LD	B,C
  6425*   18 03          C      	JR	$+5
  6427*   43             C      	LD	B,E
  6428*   48             C      	LD	C,B
  6429*   AF             C      	XOR	A
  642A*   F5             C      	PUSH	AF	;A=RESTL.ANZAHL ODER 0
  642B*   C5             C      	PUSH	BC
  642C*   21 2B34*       C      	LD	HL,UB.SATZ
  642F*   36 00          C      	LD	(HL),00H
  6431*   23             C      	INC	HL
  6432*   36 37          C      	LD	(HL),55
  6434*   23             C      	INC	HL
  6435*   36 80          C      	LD	(HL),80H
  6437*   23             C      	INC	HL
'Anzeigen und Aendern des MRES-Verzeichnisses'	MACRO-80 3.44	09-Dec-81	PAGE	1-50


  6438*   06 37          C      	LD	B,55
  643A*   3E 20          C      	LD	A,20H
  643C*   CD 55A6*       C      	CALL	U1.TR	;AUSGABESATZ LOESCHEN
  643F*   3E 0D          C      	LD	A,13
  6441*   32 2B00*       C      	LD	(UB.ZN),A
  6444*   CD 55B1*       C      	CALL	U1.BILO
  6447*   11 2B46*       C      	LD	DE,UB.SATZ+18
  644A*   D5             C      	PUSH	DE
  644B*   21 ECA2        C      	LD	HL,BC.VTABE+32	;ADR. VERZ.TABELLE
  644E*   E5             C      	PUSH	HL
                         C      ;---------------------------MAX 9 SAETZE ANZEIGEN----------------------
  644F*                  C      KV.ZLTR:
  644F*   CD 65C6*       C      	CALL	KV.BSTR	;VTABE-->UB.SATZ
  6452*   D1             C      	POP	DE	;VERZ.ADR.
  6453*   E1             C      	POP	HL	;ADR.AUSGABESATZ
  6454*   E5             C      	PUSH	HL
  6455*   D5             C      	PUSH	DE
  6456*   01 0012        C      	LD	BC,18
  6459*   B7             C      	OR	A
  645A*   ED 42          C      	SBC	HL,BC
  645C*   CD 595C*       C      	CALL	UR.MIMO	;ANZEIGE EINE ZEILE
  645F*   E1             C      	POP	HL	;VERZ.ADR
  6460*   D1             C      	POP	DE
  6461*   01 0020        C      	LD	BC,32
  6464*   09             C      	ADD	HL,BC
  6465*   C1             C      	POP	BC
  6466*   05             C      	DEC	B
  6467*   28 05          C      	JR	Z,$+7
  6469*   C5             C      	PUSH	BC
  646A*   D5             C      	PUSH	DE
  646B*   E5             C      	PUSH	HL	;NEUE VERZ.TAB ADR
  646C*   18 E1          C      	JR	KV.ZLTR
                         C      ;----------------------------------------------------------------------
  646E*   41             C      	LD	B,C	;ANZAHL DER ANGEZEIGTEN ZEILEN
  646F*   3A 2B00*       C      	LD	A,(UB.ZN)
  6472*   90             C      	SUB	B
  6473*   32 2B00*       C      	LD	(UB.ZN),A	;KURSOR AUF ANFANG 12.ZEILE
  6476*   C5             C      	PUSH	BC
  6477*   D5             C      	PUSH	DE
  6478*   E5             C      	PUSH	HL
                         C      ;------------------------VERZ. ZEIGER AUF 1.ANGEZEIGTE EINTR.
  6479*   C5             C      	PUSH	BC
  647A*   01 0020        C      	LD	BC,32
  647D*   B7             C      	OR	A
  647E*   ED 42          C      	SBC	HL,BC
  6480*   C1             C      	POP	BC
  6481*   10 F6          C      	DJNZ	$-8
  6483*   E5             C      	PUSH	HL
                         C      ;----------------------------------------------------------------------
  6484*                  C      KV.TABTR:
  6484*   21 6040*       C      	LD	HL,UA.LD
  6487*   CD 595C*       C      	CALL	UR.MIMO	;KURSOR AUF ANF.12.ZEILE
  648A*   DA 64CA*       C      	JP	C,KV.ZEIHO
  648D*   D1             C      	POP	DE
  648E*   D5             C      	PUSH	DE	;ZIELADR.IN VTAB
  648F*   CD 65F3*       C      	CALL	KV.SPTR	;ZEILE WIEDER IN SPEICHER
  6492*   E1             C      	POP	HL	;ZIELADR.IN VTAB
  6493*   01 0020        C      	LD	BC,32
  6496*   09             C      	ADD	HL,BC
  6497*   FD E1          C      	POP	IY
  6499*   D1             C      	POP	DE
  649A*   C1             C      	POP	BC
  649B*   05             C      	DEC	B
  649C*   28 07          C      	JR	Z,$+9
  649E*   C5             C      	PUSH	BC
  649F*   D5             C      	PUSH	DE
  64A0*   FD E5          C      	PUSH	IY
  64A2*   E5             C      	PUSH	HL
  64A3*   18 DF          C      	JR	KV.TABTR
                         C      ;--------------------WEITERBLAETTERN ODER AUSGABE----------------------
  64A5*   F1             C      	POP	AF
  64A6*   B7             C      	OR	A
  64A7*   28 42          C      	JR	Z,KV.AUSG	;KEINE WEITEREN ANZEIGEN
  64A9*   D6 09          C      	SUB	9
  64AB*   38 05          C      	JR	C,$+7
  64AD*   06 09          C      	LD	B,9
  64AF*   48             C      	LD	C,B
  64B0*   18 05          C      	JR	$+7
  64B2*   C6 09          C      	ADD	A,9
  64B4*   47             C      	LD	B,A
  64B5*   48             C      	LD	C,B
  64B6*   AF             C      	XOR	A
  64B7*   F5             C      	PUSH	AF
'Anzeigen und Aendern des MRES-Verzeichnisses'	MACRO-80 3.44	09-Dec-81	PAGE	1-51


  64B8*   C5             C      	PUSH	BC
  64B9*   D5             C      	PUSH	DE
  64BA*   E5             C      	PUSH	HL
  64BB*   3E 0D          C      	LD	A,13
  64BD*   32 2B00*       C      	LD	(UB.ZN),A
  64C0*   CD 55B1*       C      	CALL	U1.BILO
  64C3*   E1             C      	POP	HL
  64C4*   D1             C      	POP	DE
  64C5*   D5             C      	PUSH	DE
  64C6*   E5             C      	PUSH	HL
  64C7*   C3 644F*       C      	JP	KV.ZLTR
                         C      ;----------------------------------------------------------------------
  64CA*                  C      KV.ZEIHO:
  64CA*   21 2B00*       C      	LD	HL,UB.ZN
  64CD*   7E             C      	LD	A,(HL)
  64CE*   D6 0F          C      	SUB	15
  64D0*   38 15          C      	JR	C,$+23	;WENN IN 12. ZEILE SYS GEDRUECKT
  64D2*   35             C      	DEC	(HL)
  64D3*   35             C      	DEC	(HL)	;ZEILENNR.-2
  64D4*   E1             C      	POP	HL
  64D5*   01 0020        C      	LD	BC,32
  64D8*   B7             C      	OR	A
  64D9*   ED 42          C      	SBC	HL,BC	;VERZ.ZEIGER RUECKSETZEN
  64DB*   FD E1          C      	POP	IY
  64DD*   D1             C      	POP	DE
  64DE*   C1             C      	POP	BC
  64DF*   04             C      	INC	B
  64E0*   C5             C      	PUSH	BC
  64E1*   D5             C      	PUSH	DE
  64E2*   FD E5          C      	PUSH	IY
  64E4*   E5             C      	PUSH	HL
  64E5*   18 01          C      	JR	$+3
  64E7*   35             C      	DEC	(HL)
  64E8*   C3 6484*       C      	JP	KV.TABTR
                         C      ;----------------------------------------------------------------------
  64EB*                  C      KV.AUSG:
  64EB*   E5             C      	PUSH	HL
  64EC*   21 6052*       C      	LD	HL,UA.ZRSCH
  64EF*   CD 595C*       C      	CALL	UR.MIMO
  64F2*   7E             C      	LD	A,(HL)
  64F3*   E1             C      	POP	HL
  64F4*   FE 4A          C      	CP	'J'
  64F6*   28 11          C      	JR	Z,$+19
  64F8*   21 606B*       C      	LD	HL,UA.ANZWD
  64FB*   CD 595C*       C      	CALL	UR.MIMO
  64FE*   7E             C      	LD	A,(HL)
  64FF*   FE 4A          C      	CP	'J'
  6501*   C1             C      	POP	BC
  6502*   C2 6560*       C      	JP	NZ,KV.KRW
  6505*   C5             C      	PUSH	BC
  6506*   C3 641B*       C      	JP	KV.ANF
                         C      ;--------------------------------Dateien am Ende loeschen ? ---------
  6509*   CD 6634*       C      	CALL	KV.SBC
  650C*   20 34          C      	JR	NZ,$+54
  650E*   3A EC85        C      	LD	A,(BC.VTABE+3)
  6511*   3D             C      	DEC	A
  6512*   5F             C      	LD	E,A
  6513*   16 00          C      	LD	D,0
  6515*   3E 01          C      	LD	A,1
  6517*   82             C      	ADD	A,D
  6518*   57             C      	LD	D,A
  6519*   1D             C      	DEC	E
  651A*   28 05          C      	JR	Z,$+7
  651C*   CD 6634*       C      	CALL	KV.SBC
  651F*   28 F4          C      	JR	Z,$-10
  6521*   C1             C      	POP	BC	;D: Anzahl zu loeschender Dateien
  6522*   79             C      	LD	A,C
  6523*   92             C      	SUB	D
  6524*   32 0E66        C      	LD	(UE.PUF+1),A	;DS-Satz korrigieren
  6527*   78             C      	LD	A,B
  6528*   92             C      	SUB	D
  6529*   32 0E68        C      	LD	(UE.PUF+3),A
  652C*   CD 60DA*       C      	CALL	UR.KBR
  652F*   CD 60DA*       C      	CALL	UR.KBR
  6532*   CD 60D4*       C      	CALL	UR.KBV
  6535*   DD 36 04 08    C      	LD	(IX+4),08H
  6539*   CD 5D34*       C      	CALL	UF.EXEC	;und schreiben
  653C*   47             C      	LD	B,A
  653D*   05             C      	DEC	B
  653E*   28 20          C      	JR	Z,$+34
  6540*   04             C      	INC	B
  6541*   C5             C      	PUSH	BC
                         C      ;-------------------------------------Verzeichnis schreiben -----------
'Anzeigen und Aendern des MRES-Verzeichnisses'	MACRO-80 3.44	09-Dec-81	PAGE	1-52


  6542*   C1             C      	POP	BC
  6543*   05             C      	DEC	B
  6544*   21 ECA2        C      	LD	HL,BC.VTABE+32
  6547*   C5             C      	PUSH	BC
  6548*   11 0E65        C      	LD	DE,UE.PUF
  654B*   01 0020        C      	LD	BC,32
  654E*   ED B0          C      	LDIR
  6550*   CD 60D4*       C      	CALL	UR.KBV
  6553*   CD 60DA*       C      	CALL	UR.KBR
  6556*   DD 36 04 08    C      	LD	(IX+4),08H	;OHNE RAW
  655A*   CD 5D34*       C      	CALL	UF.EXEC
  655D*   C1             C      	POP	BC
  655E*   10 E7          C      	DJNZ	$-23
                         C      ;---------------------------------------------------------------------
  6560*                  C      KV.KRW:
  6560*   CD 60AC*       C      	CALL	UR.KRW
  6563*   CD 60B6*       C      	CALL	UR.KRA
  6566*   3A 3328        C      	LD	A,(UE.BWSA+328H)
  6569*   FE 44          C      	CP	'D'
  656B*   C0             C      	RET	NZ
  656C*   21 323D        C      	LD	HL,UE.BWSA+23DH
  656F*   00             C      	NOP
  6570*   CD 65AC*       C      	CALL	KV.DRU1
  6573*   21 328D        C      	LD	HL,UE.BWSA+28DH
  6576*   CD 65AC*       C      	CALL	KV.DRU1
  6579*   CD 4040        C      	CALL	PRINT
  657C*   21 2B6E*       C      	LD	HL,UB.DTAB
  657F*   11 2B6F*       C      	LD	DE,UB.DTAB+1
  6582*   01 0028        C      	LD	BC,40
  6585*   36 20          C      	LD	(HL),20H
  6587*   ED B0          C      	LDIR
  6589*   3A EC85        C      	LD	A,(BC.VTABE+3)
  658C*   47             C      	LD	B,A
  658D*   05             C      	DEC	B
  658E*   21 EC82        C      	LD	HL,BC.VTABE
  6591*   11 0020        C      	LD	DE,32
  6594*                  C      KV.P1:
  6594*   C5             C      	PUSH	BC
  6595*   19             C      	ADD	HL,DE
  6596*   E5             C      	PUSH	HL
  6597*   D5             C      	PUSH	DE
  6598*   11 2B6E*       C      	LD	DE,UB.DTAB
  659B*   CD 65C6*       C      	CALL	KV.BSTR
  659E*   21 2B6E*       C      	LD	HL,UB.DTAB
  65A1*   06 28          C      	LD	B,40
  65A3*   CD 65AE*       C      	CALL	KV.DRU
  65A6*   D1             C      	POP	DE
  65A7*   E1             C      	POP	HL
  65A8*   C1             C      	POP	BC
  65A9*   10 E9          C      	DJNZ	KV.P1
  65AB*   C9             C      	RET
                         C
  65AC*                  C      KV.DRU1:
  65AC*   06 1E          C      	LD	B,30
  65AE*                  C      KV.DRU:
  65AE*   7E             C      	LD	A,(HL)
  65AF*   23             C      	INC	HL
  65B0*   CD 65BB*       C      	CALL	KV.KO02
  65B3*   10 F9          C      	DJNZ	KV.DRU
  65B5*   3E 1E          C      	LD	A,1EH
  65B7*   CD 4040        C      	CALL	PRINT
  65BA*   C9             C      	RET
                         C      ;
  65BB*                  C      KV.KO02:
  65BB*   CB BF          C      	RES	7,A	;FUER KV17 (DRUCKERAUSGABE)
  65BD*   FE 20          C      	CP	20H
  65BF*   30 02          C      	JR	NC,$+4
  65C1*   3E 2A          C      	LD	A,2AH
  65C3*   C3 4040        C      	JP	PRINT
                         C      ;---------------------------------------------------------------------
  65C6*                  C      KV.BSTR:
  65C6*   01 0006        C      	LD	BC,6	;Aufbereitung des Verz.Satzes
  65C9*   C5             C      	PUSH	BC
  65CA*   ED B0          C      	LDIR		;Transport VTABE--->UB.SATZ
  65CC*   13             C      	INC	DE
  65CD*   13             C      	INC	DE
  65CE*   13             C      	INC	DE
  65CF*   01 0002        C      	LD	BC,2
  65D2*   ED B0          C      	LDIR
  65D4*   13             C      	INC	DE
  65D5*   13             C      	INC	DE
  65D6*   13             C      	INC	DE
  65D7*   C1             C      	POP	BC
'Anzeigen und Aendern des MRES-Verzeichnisses'	MACRO-80 3.44	09-Dec-81	PAGE	1-53


  65D8*   C5             C      	PUSH	BC
  65D9*   ED B0          C      	LDIR
  65DB*   13             C      	INC	DE
  65DC*   13             C      	INC	DE
  65DD*   13             C      	INC	DE
  65DE*   C1             C      	POP	BC
  65DF*   ED B0          C      	LDIR
  65E1*   13             C      	INC	DE
  65E2*   13             C      	INC	DE
  65E3*   13             C      	INC	DE
  65E4*   01 0003        C      	LD	BC,3
  65E7*   ED B0          C      	LDIR
  65E9*   13             C      	INC	DE
  65EA*   13             C      	INC	DE
  65EB*   13             C      	INC	DE
  65EC*   6E             C      	LD	L,(HL)	;Konvertierung Labelnummer
  65ED*   26 00          C      	LD	H,0
  65EF*   CD 571C*       C      	CALL	UC.CVBD2
  65F2*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  65F3*                  C      KV.SPTR:
  65F3*   7E             C      	LD	A,(HL)
  65F4*   FE 09          C      	CP	09H	;Soll Satz geloescht werden?
  65F6*   20 02          C      	JR	NZ,$+4
  65F8*   AF             C      	XOR	A
  65F9*   77             C      	LD	(HL),A
  65FA*   01 0006        C      	LD	BC,6
  65FD*   C5             C      	PUSH	BC
  65FE*   ED B0          C      	LDIR		;Ruecktransport BWSA--->VTABE
  6600*   23             C      	INC	HL
  6601*   23             C      	INC	HL
  6602*   23             C      	INC	HL
  6603*   01 0002        C      	LD	BC,2
  6606*   ED B0          C      	LDIR
  6608*   23             C      	INC	HL
  6609*   23             C      	INC	HL
  660A*   23             C      	INC	HL
  660B*   C1             C      	POP	BC
  660C*   C5             C      	PUSH	BC
  660D*   ED B0          C      	LDIR
  660F*   23             C      	INC	HL
  6610*   23             C      	INC	HL
  6611*   23             C      	INC	HL
  6612*   C1             C      	POP	BC
  6613*   ED B0          C      	LDIR
  6615*   23             C      	INC	HL
  6616*   23             C      	INC	HL
  6617*   23             C      	INC	HL
  6618*   01 0003        C      	LD	BC,3
  661B*   ED B0          C      	LDIR
  661D*   23             C      	INC	HL
  661E*   23             C      	INC	HL
  661F*   23             C      	INC	HL
  6620*   D5             C      	PUSH	DE
  6621*   EB             C      	EX	DE,HL
  6622*   CD 6629*       C      	CALL	KV.DBCVM
  6625*   7D             C      	LD	A,L
  6626*   E1             C      	POP	HL
  6627*   77             C      	LD	(HL),A
  6628*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  6629*                  C      KV.DBCVM:
  6629*   06 02          C      	LD	B,2	;FELDLAENGE
  662B*   CD 5761*       C      	CALL	UC.CVDB	;KONVERTIER. DEZI-->BINAER
  662E*   D0             C      	RET	NC		;OHNE FEHLER
  662F*   C0             C      	RET	NZ
  6630*   13             C      	INC	DE	;1.ZEICHEN WAR KEINE DEZ.ZAHL
  6631*   10 F8          C      	DJNZ	$-6
  6633*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  6634*                  C      KV.SBC:
  6634*   01 0020        C      	LD	BC,32
  6637*   B7             C      	OR	A
  6638*   ED 42          C      	SBC	HL,BC
  663A*   7E             C      	LD	A,(HL)
  663B*   FE 00          C      	CP	00H
  663D*   C9             C      	RET
                         C      ;---------------------------------------------------------------------
  663E*                  C      KV.ANZ:
  663E*   C5             C      	PUSH	BC
  663F*   68             C      	LD	L,B
  6640*   26 00          C      	LD	H,0
  6642*   11 3332        C      	LD	DE,3332H
'Anzeigen und Aendern des MRES-Verzeichnisses'	MACRO-80 3.44	09-Dec-81	PAGE	1-54


  6645*   CD 5718*       C      	CALL	UC.CVBD3
  6648*   13             C      	INC	DE
  6649*   13             C      	INC	DE
  664A*   21 6654*       C      	LD	HL,KV.AVZS
  664D*   01 0011        C      	LD	BC,17
  6650*   ED B0          C      	LDIR
  6652*   C1             C      	POP	BC
  6653*   C9             C      	RET
                         C      ;-----------------------------------------------------------------------
  6654*                  C      KV.AVZS:
  6654*   56 65 72 7A    C      	DB	'Verzeichnissaetze'
  6658*   65 69 63 68    C
  665C*   6E 69 73 73    C
  6660*   61 65 74 7A    C
  6664*   65             C
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Kommandos: KRDx und KWRx'
                         C      	PAGE
'Kommandos: KRDx und KWRx'	MACRO-80 3.44	09-Dec-81	PAGE	1-55


                         C
                         C      ;	PN	KH
                         C      ;**********************************************************************
                         C      ;
                         C      ;   Kommando:
                         C      ;        KRDx...Block einlesen und anzeigen
                         C      ;               zusaetlich werden die entsprechenden Puffer-
                         C      ;               adressen angezeigt.
                         C      ;        KWRx...Block schreiben, standardmaessig nach 'KRDx'
                         C      ;               Ansonsten muessen Blockadresse und Blocklaenge in der
                         C      ;               Verstaendigungstabelle eingetragen werden.
                         C      ;
                         C      ;**********************************************************************
  6665*   6665*          C      	DW	$
  6667*   4B 52 57 31    C      	DB	'KRW1'
  666B*   18 06          C      	JR	KH.RDSTA
                         C      ;
  666D*   666D*          C      	DW	$
  666F*   4B 52 57 32    C      	DB	'KRW2'
  6673*                  C      KH.RDSTA:
  6673*   CD 54E2*       C      	CALL	U1.KTINI	;Initialisierung E/A-Tab.
  6676*   3A 3325        C      	LD	A,(UE.BWSA + 10*80 + 5)	;325H i von KRDi
  6679*   E6 0F          C      	AND	0FH
  667B*   DD 77 03       C      	LD	(IX+3),A	;Subadresse eintragen
  667E*                  C      KH.RES:
  667E*                  C      KH.KSRE:
  667E*   CD 60A4*       C      	CALL	UR.KRE	;Reservieren
  6681*                  C      KH.RD1:
  6681*                  C      KH.KSRW:
  6681*   DD 36 04 21    C      	LD	(IX+4),021H	;umspulen (rewind)
  6685*   CD 5D34*       C      	CALL	UF.EXEC
  6688*   C3 670D*       C      	JP		KH.RDBA
                         C      ;
                         C      ;	Z Y K L U S  C<ber Tastatureingaben
  668B*                  C      KH.RD3:	;Zyklus
  668B*   DD 36 0A 00    C      	LD	(IX+10),0	;Anzahl Bandmarken
  668F*   CD 5A88*       C      	CALL	UR.TAREP	;Tastaturabfrage
  6692*   FE 80          C      	CP	080H
  6694*   28 E8          C      	JR	Z,KH.KSRE	;---> P 01	Reservieren EIN
  6696*   FE 82          C      	CP	082H
  6698*   28 2A          C      	JR	Z,KH.KSRA	;---> P 03	Reservieren AUS
  669A*   FE 81          C      	CP	081H
  669C*   28 E3          C      	JR	Z,KH.KSRW	;---> P 02	Rewind
                         C
  669E*   FE 83          C      	CP	083H
  66A0*   28 31          C      	JR	Z,KH.KSRP	;---> P 04	        read; display
  66A2*   FE 85          C      	CP	085H
  66A4*   28 2A          C      	JR	Z,KH.KSRM	;---> P 06	R-; R-; read; display
                         C
  66A6*   DD 36 0A 01    C      	LD	(IX+10),1	;Anzahl Bandmarken
  66AA*   FE 86          C      	CP	086H
  66AC*   28 3C          C      	JR	Z,KH.BMP	;---> P07	BM+
  66AE*   FE 88          C      	CP	088H
  66B0*   28 40          C      	JR	Z,KH.BMM	;---> P09	BM-
                         C
  66B2*   FE 89          C      	CP	089H
  66B4*   28 41          C      	JR	Z,KH.WREC	;---> P10	write Record
  66B6*   FE 8A          C      	CP	08AH
  66B8*   28 49          C      	JR	Z,KH.WBM	;---> P11	write BM
  66BA*   FE 8B          C      	CP	08BH
  66BC*   28 47          C      	JR	Z,KH.WSL	;---> P11	write SL
                         C
  66BE*   FE CD          C      	CP	0CDH
  66C0*   28 45          C      	JR	Z,KH.SYSRT	;---> SYS
                         C
  66C2*   18 C7          C      	JR	KH.RD3
                         C
                         C      ;	P 03	Reservieren AUS
  66C4*                  C      KH.KSRA:
  66C4*   DD 36 04 21    C      	LD	(IX+4),021H	;umspulen (rewind)
  66C8*   CD 5D34*       C      	CALL	UF.EXEC
  66CB*   CD 60B6*       C      	CALL	UR.KRA
  66CE*   18 3D          C      	JR		KH.RDBA
                         C
                         C      ;	P 06	R-; R-; read; display
  66D0*                  C      KH.KSRM:
  66D0*   CD 676F*       C      	CALL	KH.RD2
                         C      ;	P 04	        read; display
  66D3*                  C      KH.KSRP:
  66D3*   DD 36 04 02    C       	LD	(IX+4),002H	;naechst Record lesen
  66D7*   CD 5D34*       C      	CALL	UF.EXEC
  66DA*   DD 7E 1C       C      	LD	A,(IX+28)	;Lade die Laenge des Blockes
'Kommandos: KRDx und KWRx'	MACRO-80 3.44	09-Dec-81	PAGE	1-56


  66DD*   FE 01          C      	CP	1	;Laenge = 1, dann BandMarke
  66DF*   28 3D          C      	JR	Z,KH.RDBM
  66E1*   FE 02          C      	CP	2	;Laenge = 2, dann Schlussluecke
  66E3*   28 4A          C      	JR	Z,KH.RDSL
  66E5*   CD 6740*       C      	CALL	KH.ANZBL	;Block anzeigen
  66E8*   18 A1          C      	JR	KH.RD3
                         C
                         C      ;	P 07	BM+
  66EA*                  C      KH.BMP:
  66EA*   CD 60BC*       C      	CALL	UR.KLV	;Bandmarke vorsetzen
  66ED*   CD 60DA*       C      	CALL	UR.KBR	;Record    zuruecksetzen
  66F0*   18 E1          C      	JR	KH.KSRP
                         C      ;	P 09	BM-
  66F2*                  C      KH.BMM:
  66F2*   CD 60C2*       C      	CALL	UR.KLR	;Bandmarke zurC<cksetzen
  66F5*   18 DC          C      	JR	KH.KSRP
                         C
                         C      ;	P 10	write Record
  66F7*                  C      KH.WREC:
  66F7*   DD 36 04 08    C      	LD	(IX+4),08H
  66FB*   CD 5D34*       C      	CALL	UF.EXEC
  66FE*   CD 60DA*       C      	CALL	UR.KBR
  6701*   18 88          C      	JR	KH.RD3
                         C
                         C      ;	P 11	write BM
  6703*                  C      KH.WBM:
  6703*   18 86          C      	JR	KH.RD3
                         C
                         C      ;	P 12	write SL
  6705*                  C      KH.WSL:
  6705*   18 84          C      	JR	KH.RD3
                         C
                         C      ;	SYS		Systemruecksprung
  6707*                  C      KH.SYSRT:
  6707*   CD 67E9*       C      	CALL	KH.BILO
  670A*   C3 000B        C      	JP	SY.SYSTB
                         C
  670D*                  C      KH.RDBA:
  670D*   CD 67E9*       C      	CALL	KH.BILO
  6710*   21 6020*       C      	LD	HL,UA.ZKBA	;"Bandanfang"
  6713*   11 3000        C      	LD	DE,UE.BWSA
  6716*   01 000A        C      	LD	BC,UA.ZKBM-UA.ZKBA
  6719*   ED B0          C      	LDIR
  671B*   C3 668B*       C      	JP	KH.RD3
                         C
  671E*                  C      KH.RDBM:
  671E*   CD 67E9*       C      	CALL	KH.BILO
  6721*   21 602A*       C      	LD	HL,UA.ZKBM	;"Bandmarke"
  6724*   11 3000        C      	LD	DE,UE.BWSA
  6727*   01 0009        C      	LD	BC,UA.ZKSL-UA.ZKBM
  672A*   ED B0          C      	LDIR
  672C*   C3 668B*       C      	JP	KH.RD3
                         C
  672F*                  C      KH.RDSL:
  672F*   CD 67E9*       C      	CALL	KH.BILO
  6732*   21 6033*       C      	LD	HL,UA.ZKSL	;"Schlussluecke"
  6735*   11 3000        C      	LD	DE,UE.BWSA
  6738*   01 000D        C      	LD	BC,UA.ZKEE-UA.ZKSL
  673B*   ED B0          C      	LDIR
  673D*   C3 668B*       C      	JP	KH.RD3
                         C
  6740*                  C      KH.ANZBL:
  6740*   CD 67E9*       C      	CALL	KH.BILO
  6743*                  C      KH.ANZB1:
  6743*   21 0E65        C      	LD	HL,UE.PUF
  6746*   FE 20          C      	CP	020H
  6748*   20 04          C      	JR	NZ,KH.ANZB2
  674A*   06 02          C      	LD	B,2	; 2 Zeilen anzeigen
  674C*   18 0A          C      	JR	KH.ANZB4
  674E*                  C      KH.ANZB2:
  674E*   FE 80          C      	CP	080H
  6750*   20 04          C      	JR	NZ,KH.ANZB3
  6752*   06 08          C      	LD	B,8	; 8 Zeilen anzeigen
  6754*   18 02          C      	JR	KH.ANZB4
  6756*                  C      KH.ANZB3:
  6756*   06 18          C      	LD	B,24	; 24 Zeilen anzeigen
  6758*                  C      KH.ANZB4:
  6758*   CD 675C*       C      	CALL	KH.AZBLD	;Bild anzeigen (24 Zeilen)
  675B*   C9             C      	RET		; IN...HL:=akt. Pufferadresse
                         C
  675C*                  C      KH.AZBLD:
  675C*   11 3000        C      	LD	DE,UE.BWSA
  675F*                  C      KH.AZBL1:
'Kommandos: KRDx und KWRx'	MACRO-80 3.44	09-Dec-81	PAGE	1-57


  675F*   C5             C      	PUSH	BC
  6760*   CD 6778*       C      	CALL	KH.AZ1Z	; 1 Zeile anzeigen
  6763*   C1             C      	POP	BC
  6764*   E5             C      	PUSH	HL	;akt. Pufferadresse retten
  6765*   EB             C      	EX	DE,HL
  6766*   11 0050        C      	LD	DE,80
  6769*   19             C      	ADD	HL,DE	;neuen Zeilenanfang berechnen
  676A*   EB             C      	EX	DE,HL
  676B*   E1             C      	POP	HL
  676C*   10 F1          C      	DJNZ	KH.AZBL1
  676E*   C9             C      	RET
                         C
  676F*                  C      KH.RD2:
  676F*   F5             C      	PUSH	AF	;Flags retten
  6770*   CD 60DA*       C      	CALL	UR.KBR	;Block ruecksetzen
  6773*   CD 60DA*       C      	CALL	UR.KBR
  6776*   F1             C      	POP	AF
  6777*   C9             C      	RET
                         C      ;                                IN...HL:= Pufferadresse
                         C      ;                                     DE:= Zeilenanfang
  6778*                  C      KH.AZ1Z:
  6778*   D5             C      	PUSH	DE	;eine Zeile anzeigen
  6779*   E5             C      	PUSH	HL
  677A*   D5             C      	PUSH	DE
  677B*   E1             C      	POP	HL
  677C*   01 0040        C      	LD	BC,64
  677F*   09             C      	ADD	HL,BC
  6780*   E5             C      	PUSH	HL
  6781*   C1             C      	POP	BC	;BC:= Anfang ASCII-Darstellung
  6782*   E1             C      	POP	HL
  6783*   CD 679C*       C      	CALL	KH.AZADR	;Adresse anzeigen
  6786*   13             C      	INC	DE
  6787*   13             C      	INC	DE
  6788*   CD 67A5*       C      	CALL	KH.AZ4BY	;1. Vierergruppe
  678B*   13             C      	INC	DE
  678C*   13             C      	INC	DE
  678D*   CD 67A5*       C      	CALL	KH.AZ4BY	;2.      ''
  6790*   13             C      	INC	DE
  6791*   13             C      	INC	DE
  6792*   CD 67A5*       C      	CALL	KH.AZ4BY	;3.      ''
  6795*   13             C      	INC	DE
  6796*   13             C      	INC	DE
  6797*   CD 67A5*       C      	CALL	KH.AZ4BY	;4.      ''
  679A*   D1             C      	POP	DE
  679B*   C9             C      	RET
  679C*                  C      KH.AZADR:
  679C*   7C             C      	LD	A,H	;Anzeige der Adresse
  679D*   CD 56A5*       C      	CALL	UC.CVBX+2
  67A0*   7D             C      	LD	A,L
  67A1*   CD 56A5*       C      	CALL	UC.CVBX+2
  67A4*   C9             C      	RET
  67A5*                  C      KH.AZ4BY:
  67A5*   AF             C      	XOR	A	;Anzeige einer Vierergruppe
  67A6*   32 2B26*       C      	LD	(UB.PAR1),A
  67A9*                  C      KH.AZ4B0:
  67A9*   7E             C      	LD	A,(HL)
  67AA*   F5             C      	PUSH	AF
  67AB*   CD 56A5*       C      	CALL	UC.CVBX+2	;Code als Hexadezimalzahl
  67AE*   F1             C      	POP	AF
  67AF*   13             C      	INC	DE
  67B0*   23             C      	INC	HL
  67B1*   FE 20          C      	CP	20H
  67B3*   38 15          C      	JR	C,KH.AZ4B1	;nicht darstellbar
  67B5*   FE 7F          C      	CP	7FH
  67B7*   30 11          C      	JR	NC,KH.AZ4B1	;nicht darstellbar
  67B9*                  C      KH.AZ4B3:
  67B9*   02             C      	LD	(BC),A	;Code als ASCII-Zeichen
  67BA*   03             C      	INC	BC
  67BB*   CD 67CE*       C      	CALL	KH.BLEVG	;Test auf Blockende
  67BE*   3A 2B26*       C      	LD	A,(UB.PAR1)
  67C1*   3C             C      	INC	A
  67C2*   FE 04          C      	CP	4
  67C4*   C8             C      	RET	Z
  67C5*   32 2B26*       C      	LD	(UB.PAR1),A
  67C8*   18 DF          C      	JR	KH.AZ4B0
  67CA*                  C      KH.AZ4B1:
  67CA*   3E 7F          C      	LD	A,07FH
  67CC*   18 EB          C      	JR	KH.AZ4B3
  67CE*                  C      KH.BLEVG:
  67CE*   D5             C      	PUSH	DE	;Blockendetest
  67CF*   E5             C      	PUSH	HL
  67D0*   11 0E65        C      	LD	DE,UE.PUF	;DE:= Pufferanfang
  67D3*   B7             C      	OR	A
'Kommandos: KRDx und KWRx'	MACRO-80 3.44	09-Dec-81	PAGE	1-58


  67D4*   ED 52          C      	SBC	HL,DE	;HL:= Anzahl der angezeigten
  67D6*   EB             C      	EX	DE,HL
  67D7*   CD 5611*       C      	CALL	XY.LIDX
  67DA*   09             C      	DB	9
  67DB*   B7             C      	OR	A
  67DC*   ED 52          C      	SBC	HL,DE
  67DE*   E1             C      	POP	HL
  67DF*   D1             C      	POP	DE
  67E0*   28 01          C      	JR	Z,KH.BLEV1
  67E2*   C9             C      	RET
  67E3*                  C      KH.BLEV1:
  67E3*   06 0C          C      	LD	B,12
  67E5*                  C      KH.BLEV2:
  67E5*   33             C      	INC	SP
  67E6*   10 FD          C      	DJNZ	KH.BLEV2
  67E8*   C9             C      	RET		;---> Anzeige beendet
                         C
                         C      ;----------------------------------------------------
  67E9*                  C      KH.BILO:
  67E9*   21 3000        C      	LD	HL,UE.BWSA
  67EC*   01 077F        C      	LD	BC,24*80 -1	;800H
  67EF*   36 20          C      	LD	(HL),20H
  67F1*   E5             C      	PUSH	HL
  67F2*   D1             C      	POP	DE
  67F3*   13             C      	INC	DE
  67F4*   ED B0          C      	LDIR
  67F6*   C9             C      	RET
                         C      ;------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Ein-/Ausgabe im freien Format'
                         C      	PAGE
'Ein-/Ausgabe im freien Format'	MACRO-80 3.44	09-Dec-81	PAGE	1-59


                         C
                         C      ;	PN	FD
                         C      ;**********************************************************************
                         C      ;
                         C      ;      Ein-/Ausgabe von Dateien im freien Format in bzw. aus demEditor-
                         C      ;      raum von bzw. auf MRES-Kassetten
                         C      ;
                         C      ;**********************************************************************
                         C      ;      Positionieren auf Datei, IN: <C>:= Labelnummer
                         C      ;
  67F7*                  C      FD.POSK:
  67F7*   C5             C      	PUSH	BC
  67F8*   41             C      	LD	B,C
  67F9*   04             C      	INC	B
  67FA*   CD 60E9*       C      	CALL	UR.POSIK
  67FD*   CD 680F*       C      	CALL	FD.KO01
  6800*   3A 0E65        C      	LD	A,(UE.PUF)
  6803*   B9             C      	CP	C
  6804*   C1             C      	POP	BC
  6805*   20 01          C      	JR	NZ,$+3
  6807*   C9             C      	RET
  6808*   D1             C      	POP	DE
  6809*   3E 94          C      	LD	A,94H
  680B*   CD 5D64*       C      	CALL	UF.ERANZ
  680E*   C9             C      	RET
                         C      ;
  680F*                  C      FD.KO01:
  680F*   DD 36 04 02    C      	LD	(IX+4),002H	;FUER FD19
  6813*   C3 5D34*       C      	JP	UF.EXEC
                         C      ;----------------------------------------------------------------------
                         C      ;      Datei im Verzeichnis suchen
                         C      ;      HL:= Dateiname, <B>:= Anzahl Verzeichniseintragungen + 1
                         C      ;      <D>:= Dateityp
                         C      ;      O:  CY:= 0 Datei nicht vorhanden, <C> unveraendert
                         C      ;          CY:= 1 <C>:= Labelnummer
                         C      ;      K:  B
  6816*                  C      FD.DASU:
  6816*   D5             C      	PUSH	DE
  6817*   05             C      	DEC	B
  6818*   28 0A          C      	JR	Z,$+12
  681A*   CD 680F*       C      	CALL	FD.KO01
  681D*   CD 54C7*       C      	CALL	U1.NMVGL
  6820*   38 05          C      	JR	C,$+7
  6822*   10 F6          C      	DJNZ	$-8
  6824*   B7             C      	OR	A
  6825*   D1             C      	POP	DE
  6826*   C9             C      	RET
  6827*   5F             C      	LD	E,A
  6828*   3A 0E6B        C      	LD	A,(UE.PUF+6)
  682B*   BA             C      	CP	D
  682C*   20 F4          C      	JR	NZ,$-10
  682E*   4B             C      	LD	C,E
  682F*   37             C      	SCF
  6830*   18 F3          C      	JR	$-11
                         C      ;----------------------------------------------------------------------
                         C      ;      Reservebloecke schreiben
                         C      ;
  6832*                  C      FD.WRRES:
  6832*   C5             C      	PUSH	BC
  6833*   D5             C      	PUSH	DE
  6834*   E5             C      	PUSH	HL
  6835*   21 5FD2*       C      	LD	HL,UA.ZKRES
  6838*   CD 595C*       C      	CALL	UR.MIMO
  683B*   EB             C      	EX	DE,HL
  683C*   CD 5761*       C      	CALL	UC.CVDB
  683F*   7C             C      	LD	A,H
  6840*   B5             C      	OR	L
  6841*   20 04          C      	JR	NZ,$+6
  6843*   E1             C      	POP	HL
  6844*   D1             C      	POP	DE
  6845*   C1             C      	POP	BC
  6846*   C9             C      	RET
  6847*   E5             C      	PUSH	HL
  6848*   21 0E65        C      	LD	HL,UE.PUF
  684B*   01 0090        C      	LD	BC,90H
  684E*   CD 5411*       C      	CALL	U1.CLRB
  6851*   21 0080        C      	LD	HL,80H
  6854*   CD 5631*       C      	CALL	XY.STIDX
  6857*   09             C      	DB	9
  6858*   E1             C      	POP	HL
  6859*   CD 6239*       C      	CALL	UK.KBA
  685C*   2B             C      	DEC	HL
'Ein-/Ausgabe im freien Format'	MACRO-80 3.44	09-Dec-81	PAGE	1-60


  685D*   7C             C      	LD	A,H
  685E*   B5             C      	OR	L
  685F*   20 E6          C      	JR	NZ,$-24
  6861*   18 E0          C      	JR	$-30
                         C      ;----------------------------------------------------------------------
                         C      ;      F/S - Datei in den Editorraum einlesen
                         C      ;
  6863*                  C      FD.FDINP:
  6863*   21 0000        C      	LD	HL,0
  6866*   CD 5621*       C      	CALL	XY.STDX
  6869*   11             C      	DB	17
  686A*   CD 6189*       C      	CALL	UK.KLPFB	;Pufferbereitstellung
  686D*   21 3328        C      	LD	HL,UE.BWSA+328H
  6870*   06 05          C      	LD	B,5
  6872*   7E             C      	LD	A,(HL)
  6873*   FE 45          C      	CP	'E'
  6875*   28 05          C      	JR	Z,$+7
  6877*   23             C      	INC	HL
  6878*   10 F8          C      	DJNZ	$-6
  687A*   18 05          C      	JR	$+7
  687C*   2A 0DC6        C      	LD	HL,(UE.EDEND)
  687F*   18 03          C      	JR	$+5
  6881*   21 8830        C      	LD	HL,UE.TEXAN
  6884*   D9             C      	EXX
  6885*   CD 5956*       C      	CALL	DC.INIT	;Dekomprimierung initialisieren
  6888*   D9             C      	EXX
  6889*   3A 2B28*       C      	LD	A,(UB.PAR2)	;Dateitypmerker
  688C*   FE 53          C      	CP	'S'
  688E*   F5             C      	PUSH	AF
  688F*   CC 68AA*       C      	CALL	Z,FD.SDIN	;Zeicheneingabe S- Datei
  6892*   77             C      	LD	(HL),A
  6893*   B7             C      	OR	A
  6894*   28 12          C      	JR	Z,$+20
  6896*   F1             C      	POP	AF
  6897*   28 07          C      	JR	Z,$+9
  6899*   C4 614C*       C      	CALL	NZ,UK.GETK	;Zeicheneingabe F- Datei
  689C*   77             C      	LD	(HL),A	;Zeichen in Speicher eintragen
  689D*   BE             C      	CP	(HL)	;Echolesen
  689E*   20 10          C      	JR	NZ,$+18
  68A0*   B7             C      	OR	A	;<A>:= 0, Z:= 1
  68A1*   C8             C      	RET	Z
  68A2*   23             C      	INC	HL	;HL:= HL + 1
  68A3*   22 0DC6        C      	LD	(UE.EDEND),HL	;Textende
  68A6*   18 E1          C      	JR	$-29
  68A8*   F1             C      	POP	AF
  68A9*   C9             C      	RET
  68AA*                  C      FD.SDIN:
  68AA*   D9             C      	EXX
  68AB*   CD 591B*       C      	CALL	DC.DCMPR
  68AE*   D9             C      	EXX
  68AF*   C9             C      	RET
  68B0*   3E 93          C      	LD	A,93H	;Fehlerschluessel
  68B2*   CD 5D64*       C      	CALL	UF.ERANZ
  68B5*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;      Ausgabe einer F/S - Datei (neuer Bestand)
                         C      ;
  68B6*                  C      FD.FDOUT:
  68B6*   21 0000        C      	LD	HL,0                   ;Blockzaehler loeschen
  68B9*   CD 5621*       C      	CALL	XY.STDX
  68BC*   11             C      	DB	17
  68BD*   21 0080        C      	LD	HL,80H                 ;Blocklaenge eintragen
  68C0*   CD 5631*       C      	CALL	XY.STIDX
  68C3*   09             C      	DB	9
  68C4*   CD 6214*       C      	CALL	UK.KSPFB               ;Pufferbereitstellung
  68C7*   21 8830        C      	LD	HL,UE.TEXAN            ;HL:= Textanfang
  68CA*   ED 5B 0DC6     C      	LD	DE,(UE.EDEND)          ;BC:= Textende
  68CE*   D9             C      	EXX
  68CF*   CD 5915*       C      	CALL	CP.INIT
  68D2*   D9             C      	EXX
  68D3*   B7             C      	OR	A                      ;CY:= 0
  68D4*   E5             C      	PUSH	HL
  68D5*   ED 52          C      	SBC	HL,DE
  68D7*   30 13          C      	JR	NC,$+21
  68D9*   E1             C      	POP	HL
  68DA*   3A 2B28*       C      	LD	A,(UB.PAR2)
  68DD*   FE 53          C      	CP	'S'
  68DF*   F5             C      	PUSH	AF
  68E0*   7E             C      	LD	A,(HL)
  68E1*   CC 6904*       C      	CALL	Z,FD.SDOUT
  68E4*   F1             C      	POP	AF
  68E5*   7E             C      	LD	A,(HL)
  68E6*   C4 61F0*       C      	CALL	NZ,UK.PUTK
'Ein-/Ausgabe im freien Format'	MACRO-80 3.44	09-Dec-81	PAGE	1-61


  68E9*   23             C      	INC	HL
  68EA*   18 E7          C      	JR	$-23
  68EC*   E1             C      	POP	HL                     ;Endebehandlung
  68ED*   01 0120        C      	LD	BC,288
  68F0*   AF             C      	XOR	A
  68F1*   CD 61F0*       C      	CALL	UK.PUTK
  68F4*   0B             C      	DEC	BC
  68F5*   78             C      	LD	A,B
  68F6*   B1             C      	OR	C
  68F7*   20 F7          C      	JR	NZ,$-7
  68F9*   CD 6AC7*       C      	CALL	FD.DSPBB
  68FC*   CD 6832*       C      	CALL	FD.WRRES               ;Reservebloecke schreiben
  68FF*   CD 5601*       C      	CALL	XY.LDDX                ;HL:= Blockzaehler
  6902*   11             C      	DB	17
  6903*   C9             C      	RET
  6904*                  C      FD.SDOUT:
  6904*   D9             C      	EXX
  6905*   CD 58B2*       C      	CALL	CP.COMPR
  6908*   D9             C      	EXX
  6909*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;      Ausgabe einer F/S - Datei (alter Bestand)
                         C      ;
  690A*                  C      FD.FDOWR:
  690A*   21 0000        C      	LD	HL,0
  690D*   CD 5621*       C      	CALL	XY.STDX
  6910*   11             C      	DB	17
  6911*   21 8830        C      	LD	HL,UE.TEXAN
  6914*   D9             C      	EXX
  6915*   CD 5915*       C      	CALL	CP.INIT
  6918*   D9             C      	EXX
  6919*   E5             C      	PUSH	HL
  691A*                  C      FD.FDOW1:
  691A*   CD 695A*       C      	CALL	FD.FDUP
  691D*   E1             C      	POP	HL
  691E*                  C      FD.FDOW2:
  691E*   E5             C      	PUSH	HL
  691F*   ED 5B 0DC6     C      	LD	DE,(UE.EDEND)
  6923*   B7             C      	OR	A
  6924*   ED 52          C      	SBC	HL,DE
  6926*   30 1B          C      	JR	NC,FD.FDOW3
  6928*   E1             C      	POP	HL
  6929*   3A 2B28*       C      	LD	A,(UB.PAR2)
  692C*   FE 53          C      	CP	'S'
  692E*   7E             C      	LD	A,(HL)
  692F*   28 41          C      	JR	Z,FD.SDOW
  6931*   CD 61F0*       C      	CALL	UK.PUTK
  6934*   0B             C      	DEC	BC
  6935*                  C      FD.FDOW4:
  6935*   23             C      	INC	HL
  6936*   78             C      	LD	A,B
  6937*   B1             C      	OR	C
  6938*   20 E4          C      	JR	NZ,FD.FDOW2
  693A*   CD 6239*       C      	CALL	UK.KBA	;Block schreiben
  693D*   E5             C      	PUSH	HL
  693E*   CD 6950*       C      	CALL	FD.DECBZ
  6941*   18 D7          C      	JR	FD.FDOW1
  6943*                  C      FD.FDOW3:
  6943*   E1             C      	POP	HL
  6944*   AF             C      	XOR	A	;Endekennzeichen 00H
  6945*   CD 61F0*       C      	CALL	UK.PUTK
  6948*   CD 6239*       C      	CALL	UK.KBA
  694B*   CD 6950*       C      	CALL	FD.DECBZ
  694E*   B7             C      	OR	A
  694F*   C9             C      	RET
  6950*                  C      FD.DECBZ:
  6950*   CD 5601*       C      	CALL	XY.LDDX
  6953*   11             C      	DB	17
  6954*   2B             C      	DEC	HL
  6955*   CD 5621*       C      	CALL	XY.STDX
  6958*   11             C      	DB	17
  6959*   C9             C      	RET
  695A*                  C      FD.FDUP:
  695A*   CD 61AC*       C      	CALL	UK.KBW
  695D*   DD 7E 0A       C      	LD	A,(IX+10)	;Laenge = 1, dann BM
  6960*   FE 01          C      	CP	1
  6962*   CA 6AEC*       C      	JP	Z,FD.BMGF
  6965*   CD 60DA*       C      	CALL	UR.KBR
  6968*   CD 5611*       C      	CALL	XY.LIDX
  696B*   09             C      	DB	9
  696C*   E5             C      	PUSH	HL
  696D*   C1             C      	POP	BC
  696E*   CD 6214*       C      	CALL	UK.KSPFB
'Ein-/Ausgabe im freien Format'	MACRO-80 3.44	09-Dec-81	PAGE	1-62


  6971*   C9             C      	RET
  6972*                  C      FD.SDOW:
  6972*   CD 6904*       C      	CALL	FD.SDOUT
  6975*   78             C      	LD	A,B
  6976*   A1             C      	AND	C
  6977*   FE FF          C      	CP	0FFH
  6979*   28 1B          C      	JR	Z,FD.SDK1
  697B*   FE FE          C      	CP	0FEH
  697D*   28 03          C      	JR	Z,FD.SDK2
  697F*   C3 6935*       C      	JP	FD.FDOW4
  6982*                  C      FD.SDK2:
  6982*   EB             C      	EX	DE,HL
  6983*   CD 695A*       C      	CALL	FD.FDUP
  6986*   3E 09          C      	LD	A,09H
  6988*   CD 61F0*       C      	CALL	UK.PUTK
  698B*   0B             C      	DEC	BC
  698C*                  C      FD.SDK0:
  698C*   3E 3B          C      	LD	A,';'
  698E*   CD 61F0*       C      	CALL	UK.PUTK
  6991*   0B             C      	DEC	BC
  6992*   EB             C      	EX	DE,HL
  6993*   C3 6935*       C      	JP	FD.FDOW4
  6996*                  C      FD.SDK1:
  6996*   EB             C      	EX	DE,HL
  6997*   CD 695A*       C      	CALL	FD.FDUP
  699A*   18 F0          C      	JR	FD.SDK0
                         C      ;--------------------------------------------------------------
                         C      ;        Startroutine Ein-/Ausgabe
                         C      ;
  699C*                  C      FD.FSTRT:
  699C*   CD 55B1*       C      	CALL	U1.BILO
  699F*   CD 54E2*       C      	CALL	U1.KTINI
  69A2*   3A 3326        C      	LD	A,(UE.BWSA + 10*80 +6)	;326H
  69A5*   CD 55C5*       C      	CALL	U1.TST
  69A8*   DA 69D4*       C      	JP	C,FD.STRT1
  69AB*   DD 77 03       C      	LD	(IX+3),A
  69AE*   CD 60A4*       C      	CALL	UR.KRE
  69B1*   CD 60B2*       C      	CALL	UR.KRWW
  69B4*   CD 5496*       C      	CALL	U1.DSVG
  69B7*   3E 0E          C      	LD	A,14
  69B9*   32 2B00*       C      	LD	(UB.ZN),A
  69BC*   3A 3328        C      	LD	A,(UE.BWSA+328H)
  69BF*   FE 53          C      	CP	'S'
  69C1*   28 02          C      	JR	Z,$+4
  69C3*   3E 46          C      	LD	A,'F'
  69C5*   57             C      	LD	D,A
  69C6*   32 2B28*       C      	LD	(UB.PAR2),A
  69C9*   21 5FE5*       C      	LD	HL,UA.ZKSDT
  69CC*   28 03          C      	JR	Z,$+5
  69CE*   21 5F55*       C      	LD	HL,UA.ZKDAT
  69D1*   CD 595C*       C      	CALL	UR.MIMO
  69D4*                  C      FD.STRT1:
  69D4*   FD E1          C      	POP	IY
  69D6*   D8             C      	RET	C
  69D7*   FD E5          C      	PUSH	IY
  69D9*   3E 53          C      	LD	A,'S'
  69DB*   BA             C      	CP	D
  69DC*   CC 6A07*       C      	CALL	Z,FD.DECHL
  69DF*   CD 6816*       C      	CALL	FD.DASU
  69E2*   DC 69E9*       C      	CALL	C,FD.SETJ
  69E5*   D4 6A01*       C      	CALL	NC,FD.SETN
  69E8*   C9             C      	RET
  69E9*                  C      FD.SETJ:
  69E9*   C5             C      	PUSH	BC
  69EA*   D5             C      	PUSH	DE
  69EB*   E5             C      	PUSH	HL
  69EC*   EB             C      	EX	DE,HL
  69ED*   06 08          C      	LD	B,8
  69EF*   13             C      	INC	DE
  69F0*   10 FD          C      	DJNZ	$-1
  69F2*   21 0E6D        C      	LD	HL,UE.PUF+8
  69F5*   01 0006        C      	LD	BC,6
  69F8*   ED B0          C      	LDIR
  69FA*   E1             C      	POP	HL
  69FB*   D1             C      	POP	DE
  69FC*   C1             C      	POP	BC
  69FD*   3E 4A          C      	LD	A,'J'
  69FF*   18 02          C      	JR	$+4
  6A01*                  C      FD.SETN:
  6A01*   3E 4E          C      	LD	A,'N'
  6A03*   32 2B26*       C      	LD	(UB.PAR1),A
  6A06*   C9             C      	RET
  6A07*                  C      FD.DECHL:
'Ein-/Ausgabe im freien Format'	MACRO-80 3.44	09-Dec-81	PAGE	1-63


  6A07*   2B             C      	DEC	HL
  6A08*   2B             C      	DEC	HL
  6A09*   C9             C      	RET
                         C      ;****************************************************************
                         C      ;        Ausgabeprogramm
                         C      ;****************************************************************
  6A0A*   6A0A*          C      	DW	$
  6A0C*   41 55 53 20    C      	DB	'AUS '
  6A10*                  C      FD.FOUT1:
  6A10*   CD 699C*       C      	CALL	FD.FSTRT
  6A13*   3A 2B26*       C      	LD	A,(UB.PAR1)
  6A16*   FE 4A          C      	CP	'J'	;DATEI SCHON VORHANDEN ?
  6A18*   CA 6A83*       C      	JP	Z,FD.FOLWR	;JA
                         C      ;-------------------------------NEIN--> NEUE ERSTELLEN-----------------
  6A1B*   79             C      	LD	A,C	;NEXT RECORD
  6A1C*   32 2B26*       C      	LD	(UB.PAR1),A
  6A1F*   3E 7F          C      	LD	A,7FH
  6A21*   32 2B2A*       C      	LD	(UB.PAR3),A	;PARAMETER KOMMENTARABFRAGE JA
  6A24*   CD 554E*       C      	CALL	U1.VZS	;NEUEN VERZ.SATZ SCHREIBEN
  6A27*   CD 67F7*       C      	CALL	FD.POSK
  6A2A*   C5             C      	PUSH	BC
  6A2B*   CD 68B6*       C      	CALL	FD.FDOUT
  6A2E*   E5             C      	PUSH	HL	;BLOCKZAEHLER
  6A2F*   CD 60C8*       C      	CALL	UR.KBM
  6A32*   21 0020        C      	LD	HL,32
  6A35*   CD 5631*       C      	CALL	XY.STIDX
  6A38*   09             C      	DB	9
  6A39*   CD 5486*       C      	CALL	U1.VSX
  6A3C*   E1             C      	POP	HL
  6A3D*   C1             C      	POP	BC
  6A3E*   E5             C      	PUSH	HL
  6A3F*   79             C      	LD	A,C
  6A40*   3C             C      	INC	A
  6A41*   32 0E65        C      	LD	(UE.PUF),A
  6A44*   F5             C      	PUSH	AF
  6A45*   DD 36 04 08    C      	LD	(IX+4),08H
  6A49*   CD 5D34*       C      	CALL	UF.EXEC
  6A4C*   CD 60B2*       C      	CALL	UR.KRWW
  6A4F*   CD 5496*       C      	CALL	U1.DSVG
  6A52*   CD 60DA*       C      	CALL	UR.KBR
  6A55*   F1             C      	POP	AF
  6A56*   32 0E66        C      	LD	(UE.PUF+1),A
  6A59*   78             C      	LD	A,B
  6A5A*   3C             C      	INC	A
  6A5B*   32 0E68        C      	LD	(UE.PUF+3),A
  6A5E*   DD 36 04 08    C      	LD	(IX+4),08H
  6A62*   CD 5D34*       C      	CALL	UF.EXEC
  6A65*   DD 36 04 02    C      	LD	(IX+4),02H
  6A69*   CD 5D34*       C      	CALL	UF.EXEC
  6A6C*   10 FB          C      	DJNZ	$-3
  6A6E*   CD 60DA*       C      	CALL	UR.KBR
  6A71*   E1             C      	POP	HL
  6A72*   22 0E7E        C      	LD	(UE.PUF+25),HL
  6A75*   DD 36 04 08    C      	LD	(IX+4),08H
  6A79*   CD 5D34*       C      	CALL	UF.EXEC
  6A7C*                  C      FD.END:
  6A7C*   CD 60AC*       C      	CALL	UR.KRW
  6A7F*   CD 60B6*       C      	CALL	UR.KRA
  6A82*   C9             C      	RET
  6A83*                  C      FD.FOLWR:
  6A83*   21 5FB4*       C      	LD	HL,UA.ZKDL	;DATEI UEBERSCHREIBEN?
  6A86*   CD 595C*       C      	CALL	UR.MIMO
  6A89*   D8             C      	RET	C
  6A8A*   7E             C      	LD	A,(HL)
  6A8B*   FE 4A          C      	CP	'J'
  6A8D*   C0             C      	RET	NZ
  6A8E*   CD 67F7*       C      	CALL	FD.POSK
  6A91*   CD 690A*       C      	CALL	FD.FDOWR
  6A94*   CD 6AC7*       C      	CALL	FD.DSPBB
  6A97*   CD 6AE1*       C      	CALL	FD.RDEND
  6A9A*   CD 6AD7*       C      	CALL	FD.DSPBG
  6A9D*   18 DD          C      	JR	$-33
                         C      ;**********************************************************************
                         C      ;      Eingabeprogramm
                         C      ;**********************************************************************
  6A9F*   6A9F*          C      	DW	$
  6AA1*   45 49 4E 20    C      	DB	'EIN '
  6AA5*                  C      FD.FDIN2:
  6AA5*   CD 699C*       C      	CALL	FD.FSTRT
  6AA8*   3A 2B26*       C      	LD	A,(UB.PAR1)
  6AAB*   FE 4A          C      	CP	'J'
  6AAD*   28 07          C      	JR	Z,$+9
  6AAF*   3E 91          C      	LD	A,91H
'Ein-/Ausgabe im freien Format'	MACRO-80 3.44	09-Dec-81	PAGE	1-64


  6AB1*   CD 5D64*       C      	CALL	UF.ERANZ
  6AB4*   18 C6          C      	JR	FD.END
  6AB6*   CD 67F7*       C      	CALL	FD.POSK
  6AB9*   CD 6863*       C      	CALL	FD.FDINP
  6ABC*   CD 6AC7*       C      	CALL	FD.DSPBB
  6ABF*   CD 6AE1*       C      	CALL	FD.RDEND
  6AC2*   CD 6AD7*       C      	CALL	FD.DSPBG
  6AC5*   18 B5          C      	JR	FD.END
                         C      ;----------------------------------------------------------------------
  6AC7*                  C      FD.DSPBB:
  6AC7*   CD 5601*       C      	CALL	XY.LDDX
  6ACA*   11             C      	DB	17
  6ACB*   EB             C      	EX	DE,HL
  6ACC*   21 5FFA*       C      	LD	HL,UA.ZKBEL
  6ACF*   CD 595C*       C      	CALL	UR.MIMO
  6AD2*   EB             C      	EX	DE,HL
  6AD3*   CD 5718*       C      	CALL	UC.CVBD3
  6AD6*   C9             C      	RET
  6AD7*                  C      FD.DSPBG:
  6AD7*   CD 5601*       C      	CALL	XY.LDDX
  6ADA*   11             C      	DB	17
  6ADB*   EB             C      	EX	DE,HL
  6ADC*   21 600D*       C      	LD	HL,UA.ZKBLG
  6ADF*   18 EE          C      	JR	$-16
  6AE1*                  C      FD.RDEND:
  6AE1*   CD 61AC*       C      	CALL	UK.KBW
  6AE4*   DD 7E 0A       C      	LD	A,(IX+10)	;Laenge = 1, dann BM
  6AE7*   FE 01          C      	CP	1
  6AE9*   C8             C      	RET	Z
  6AEA*   18 F5          C      	JR	FD.RDEND
  6AEC*                  C      FD.BMGF:
  6AEC*   3E 95          C      	LD	A,95H
  6AEE*   CD 5D64*       C      	CALL	UF.ERANZ
  6AF1*   D1             C      	POP	DE
  6AF2*   D1             C      	POP	DE
  6AF3*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Laden von MRES-P-Dateien'
                         C      	PAGE
'Laden von MRES-P-Dateien'	MACRO-80 3.44	09-Dec-81	PAGE	1-65


                         C
                         C      ;	PN	LD
                         C      ;***********************************************************
                         C      ;
                         C      ;        Laden von MRES-P-Dateien
                         C      ;
                         C      ;***********************************************************
  6AF4*   6AF4*          C      	DW	$
  6AF6*   4C 4F 41 44    C      	DB	'LOAD'
  6AFA*   3A 3327        C      	LD	A,(UE.BWSA + 10*80 +7)	;327H
  6AFD*   CD 55C5*       C      	CALL	U1.TST
  6B00*   D8             C      	RET	C
  6B01*   CD 54E2*       C      	CALL	U1.KTINI
  6B04*   DD 77 03       C      	LD	(IX+3),A
  6B07*   CD 55B1*       C      	CALL	U1.BILO
  6B0A*   3E 0D          C      	LD	A,13
  6B0C*   32 2B00*       C      	LD	(UB.ZN),A
  6B0F*                  C      LD.DATN:
  6B0F*   21 5F55*       C      	LD	HL,UA.ZKDAT	;Dateiname ?
  6B12*   CD 595C*       C      	CALL	UR.MIMO
  6B15*   D8             C      	RET	C
  6B16*   CD 60A4*       C      	CALL	UR.KRE
  6B19*   CD 60B2*       C      	CALL	UR.KRWW
  6B1C*   CD 5496*       C      	CALL	U1.DSVG
  6B1F*   3E 01          C      	LD	A,01H
  6B21*   B8             C      	CP	B
  6B22*   28 0A          C      	JR	Z,LD.LD21	;NEU INITIALISIERTE KASSETTE
  6B24*                  C      LD.LD2:
  6B24*   CD 61AC*       C      	CALL	UK.KBW
  6B27*   CD 54C7*       C      	CALL	U1.NMVGL	;Dateiname vergleichen
  6B2A*   38 08          C      	JR	C,LD.DATFU	;---> Datei gefunden
  6B2C*   10 F6          C      	DJNZ	LD.LD2
  6B2E*                  C      LD.LD21:
  6B2E*   3E 91          C      	LD	A,91H	;Datei nicht vorhanden
  6B30*   CD 5D64*       C      	CALL	UF.ERANZ	;FEHLERANZEIGE
  6B33*   C9             C      	RET
  6B34*                  C      LD.DATFU:
  6B34*   3A 0E6B        C      	LD	A,(UE.PUF+6)	;TYP
  6B37*   FE 4F          C      	CP	'O'
  6B39*   F5             C      	PUSH	AF
  6B3A*   21 0E7C        C      	LD	HL,UE.PUF+23
  6B3D*   7E             C      	LD	A,(HL)
  6B3E*   F5             C      	PUSH	AF
  6B3F*   47             C      	LD	B,A
  6B40*   04             C      	INC	B
  6B41*   CD 60E9*       C      	CALL	UR.POSIK	;Positionieren
  6B44*   CD 61AC*       C      	CALL	UK.KBW
  6B47*   F1             C      	POP	AF
  6B48*   21 0E65        C      	LD	HL,UE.PUF
  6B4B*   BE             C      	CP	(HL)
  6B4C*   28 07          C      	JR	Z,LD.DATPO	;Datei richtig positioniert
  6B4E*   F1             C      	POP	AF
  6B4F*   3E 94          C      	LD	A,94H
  6B51*   CD 5D64*       C      	CALL	UF.ERANZ
  6B54*   C9             C      	RET
  6B55*                  C      LD.DATPO:
  6B55*   F1             C      	POP	AF
  6B56*   CA 6BEB*       C      	JP	Z,RL.BEG
  6B59*   3A 3329        C      	LD	A,(UE.BWSA+329H)
  6B5C*   FE 56          C      	CP	'V'
  6B5E*   20 57          C      	JR	NZ,LD.LD3
  6B60*   21 5F68*       C      	LD	HL,UA.ZKLAD	;Ladeadresse ?
  6B63*   CD 595C*       C      	CALL	UR.MIMO
  6B66*   DA 6B0F*       C      	JP	C,LD.DATN
  6B69*   CD 55CF*       C      	CALL	U1.PRADR	;ADRESSE EINGEGEBEN
  6B6C*   38 F2          C      	JR	C,$-12
  6B6E*   EB             C      	EX	DE,HL
  6B6F*   21 2B26*       C      	LD	HL,UB.PAR1
  6B72*   CD 5705*       C      	CALL	UC.CVXA
  6B75*                  C      LD.LD4:
  6B75*   CD 6189*       C      	CALL	UK.KLPFB
  6B78*   CD 614C*       C      	CALL	UK.GETK
  6B7B*   CD 614C*       C      	CALL	UK.GETK
  6B7E*   67             C      	LD	H,A
  6B7F*   CD 614C*       C      	CALL	UK.GETK
  6B82*   6F             C      	LD	L,A
  6B83*   7A             C      	LD	A,D
  6B84*   B3             C      	OR	E
  6B85*   28 09          C      	JR	Z,LD.LD5
  6B87*   ED 5B 2B26*    C      	LD	DE,(UB.PAR1)
  6B8B*   EB             C      	EX	DE,HL
  6B8C*   B7             C      	OR	A
'Laden von MRES-P-Dateien'	MACRO-80 3.44	09-Dec-81	PAGE	1-66


  6B8D*   ED 52          C      	SBC	HL,DE
  6B8F*   EB             C      	EX	DE,HL	;DE:= Verschiebung zur ersten
  6B90*                  C      LD.LD5:
  6B90*   CD 60DA*       C      	CALL	UR.KBR
  6B93*   CD 6BBC*       C      	CALL	LD.LADER
  6B96*   22 2B28*       C      	LD	(UB.PAR2),HL
  6B99*   21 3329        C      	LD	HL,UE.BWSA+329H
  6B9C*   06 04          C      	LD	B,4
  6B9E*   7E             C      	LD	A,(HL)
  6B9F*   FE 53          C      	CP	'S'
  6BA1*   28 0A          C      	JR	Z,LD.START
  6BA3*   23             C      	INC	HL
  6BA4*   10 F8          C      	DJNZ	$-6
  6BA6*   CD 60AC*       C      	CALL	UR.KRW
  6BA9*   CD 60B6*       C      	CALL	UR.KRA
  6BAC*   C9             C      	RET
  6BAD*                  C      LD.START:
  6BAD*   CD 60AC*       C      	CALL	UR.KRW
  6BB0*   CD 60B6*       C      	CALL	UR.KRA
  6BB3*   2A 2B28*       C      	LD	HL,(UB.PAR2)
  6BB6*   E9             C      	JP	(HL)
  6BB7*                  C      LD.LD3:
  6BB7*   11 0000        C      	LD	DE,0
  6BBA*   18 B9          C      	JR	LD.LD4
                         C      ;--------------------------------------------------------------
  6BBC*                  C      LD.LADER:
  6BBC*   CD 6189*       C      	CALL	UK.KLPFB
  6BBF*                  C      LD.LAD2:
  6BBF*   CD 614C*       C      	CALL	UK.GETK
  6BC2*   FE 00          C      	CP	0
  6BC4*   28 16          C      	JR	Z,LD.LDEND
  6BC6*   47             C      	LD	B,A
  6BC7*   CD 614C*       C      	CALL	UK.GETK
  6BCA*   67             C      	LD	H,A
  6BCB*   CD 614C*       C      	CALL	UK.GETK
  6BCE*   6F             C      	LD	L,A
  6BCF*   19             C      	ADD	HL,DE
  6BD0*                  C      LD.LAD1:
  6BD0*   CD 614C*       C      	CALL	UK.GETK
  6BD3*   77             C      	LD	(HL),A
  6BD4*   BE             C      	CP	(HL)
  6BD5*   20 0E          C      	JR	NZ,LD.LADF
  6BD7*   23             C      	INC	HL
  6BD8*   10 F6          C      	DJNZ	LD.LAD1
  6BDA*   18 E3          C      	JR	LD.LAD2
  6BDC*                  C      LD.LDEND:
  6BDC*   CD 614C*       C      	CALL	UK.GETK
  6BDF*   67             C      	LD	H,A
  6BE0*   CD 614C*       C      	CALL	UK.GETK
  6BE3*   6F             C      	LD	L,A
  6BE4*   C9             C      	RET
  6BE5*                  C      LD.LADF:
  6BE5*   3E 93          C      	LD	A,93H
  6BE7*   CD 5D64*       C      	CALL	UF.ERANZ
  6BEA*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Relativloader fuer O-Dateien'
                         C      	PAGE
'Relativloader fuer O-Dateien'	MACRO-80 3.44	09-Dec-81	PAGE	1-67


                         C
                         C      ;	PN	RL
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;     RELATIVLOADER FUER O-DATEIEN
                         C      ;
                         C      ;----------------------------------------------------------------------
  6BEB*                  C      RL.BEG:
  6BEB*   21 5F7B*       C      	LD	HL,UA.ZKBEG	;BEGINN ?
  6BEE*   CD 595C*       C      	CALL	UR.MIMO
  6BF1*   DA 6B0F*       C      	JP	C,LD.DATN
  6BF4*   CD 55CF*       C      	CALL	U1.PRADR
  6BF7*   38 F2          C      	JR	C,RL.BEG
  6BF9*   EB             C      	EX	DE,HL
  6BFA*   21 2B30*       C      	LD	HL,UB.PATAB
  6BFD*   CD 5705*       C      	CALL	UC.CVXA
  6C00*                  C      RL.UG:
  6C00*   CD 61AC*       C      	CALL	UK.KBW
  6C03*   2A 2B30*       C      	LD	HL,(UB.PATAB)	;BGADR---->HL
  6C06*   0E 01          C      	LD	C,001H	;LADEN BLOCKZAEHLER MIT
                         C      			;ANFANGSWERT
  6C08*   CD 6C93*       C      	CALL	RL.UP6	; AUFRUF EINGABE-UP
                         C      ;********** TEST BEFEHLSKENNZEICHENBYTE *******************************
  6C0B*                  C      RL.M16:
  6C0B*   CB 5A          C      	BIT	3,D	;TEST ORG-BEFEHL
  6C0D*   C2 6CE7*       C      	JP	NZ,RL.OB	;JA--->FEHLER
  6C10*   CB 62          C      	BIT	4,D	;TEST BER -BEFEHL
  6C12*   C2 6C7C*       C      	JP	NZ,RL.M10
  6C15*   3E 07          C      	LD	A,007H
  6C17*   A2             C      	AND	D	;TEST BEFEHLS LAENGE=0 ?
  6C18*   CA 6C8D*       C      	JP	Z,RL.M11
  6C1B*   47             C      	LD	B,A	;BEFEHLSLAENGE-->B
  6C1C*                  C      RL.M12:
  6C1C*   CD 6C93*       C      	CALL	RL.UP6
  6C1F*   72             C      	LD	(HL),D
  6C20*   23             C      	INC	HL
  6C21*   10 F9          C      	DJNZ	RL.M12	;EINGABE BEFEHL
  6C23*   CD 6C93*       C      	CALL	RL.UP6
  6C26*   CB 7A          C      	BIT	7,D	;TEST BEFEHLSKENNZEICHENBYTE ?
  6C28*   20 E1          C      	JR	NZ,RL.M16	; JA
                         C      ;******* TEST ADRESSKENNZEICHENBYTE ***********************************
  6C2A*   CB 6A          C      	BIT	5,D	;TEST OB REL.ADR. FOLGT
  6C2C*   CA 6CEB*       C      	JP	Z,RL.RA	;NEIN-->FEHLER
  6C2F*   CB 72          C      	BIT	6,D	;FOLGT BEZUGNAHME AUF
                         C      			;SYMBOLVERZEICHNIS
  6C31*   C2 6CEF*       C      	JP	NZ,RL.SV	;JA--->FEHLER
  6C34*   CB 52          C      	BIT	2,D	;MINUS ?
  6C36*   C2 6CF3*       C      	JP	NZ,RL.MN
  6C39*                  C      RL.M17:
  6C39*   3E 03          C      	LD	A,003H
  6C3B*   A2             C      	AND	D	;TEST ADRESSLAENGE
  6C3C*   F5             C      	PUSH	AF
  6C3D*   E5             C      	PUSH	HL
  6C3E*   CD 6C93*       C      	CALL	RL.UP6
  6C41*   62             C      	LD	H,D	;ADRESSE ---->HL
  6C42*   CD 6C93*       C      	CALL	RL.UP6
  6C45*   6A             C      	LD	L,D
  6C46*   C5             C      	PUSH	BC
  6C47*   E5             C      	PUSH	HL
  6C48*   21 2B30*       C      	LD	HL,UB.PATAB
  6C4B*   4E             C      	LD	C,(HL)	;BEGINN(LADE)ADRESSE--->BC
  6C4C*   23             C      	INC	HL
  6C4D*   46             C      	LD	B,(HL)
  6C4E*   E1             C      	POP	HL
  6C4F*   09             C      	ADD	HL,BC	;ERMITTELN SPEICHERADRESSE
  6C50*   EB             C      	EX	DE,HL	;SP.ADR.--->DE
  6C51*   C1             C      	POP	BC
  6C52*   E1             C      	POP	HL
  6C53*   F1             C      	POP	AF
  6C54*   28 04          C      	JR	Z,RL.M13
  6C56*   CB 47          C      	BIT	0,A	;NUR L-TEIL DER ADRESSE ?
  6C58*   28 10          C      	JR	Z,RL.M14	; JA
                         C      ;********** ADRESSE IN SPEICHER EINTRAGEN *****************************
  6C5A*                  C      RL.M13:
  6C5A*   73             C      	LD	(HL),E
  6C5B*   F5             C      	PUSH	AF
  6C5C*   7B             C      	LD	A,E
  6C5D*   BE             C      	CP	(HL)
  6C5E*   C2 6CDE*       C      	JP	NZ,RL.ECHO
  6C61*   F1             C      	POP	AF
  6C62*   23             C      	INC	HL
  6C63*   FE 03          C      	CP	003H
'Relativloader fuer O-Dateien'	MACRO-80 3.44	09-Dec-81	PAGE	1-68


  6C65*   28 03          C      	JR	Z,RL.M14
  6C67*   B7             C      	OR	A	;NUR H-TEIL DER ADRESSE ?
  6C68*   20 08          C      	JR	NZ,RL.M15	; JA
  6C6A*                  C      RL.M14:
  6C6A*   72             C      	LD	(HL),D
  6C6B*   F5             C      	PUSH	AF
  6C6C*   7A             C      	LD	A,D
  6C6D*   BE             C      	CP	(HL)
  6C6E*   20 6E          C      	JR	NZ,RL.ECHO
  6C70*   F1             C      	POP	AF
  6C71*   23             C      	INC	HL
  6C72*                  C      RL.M15:
  6C72*   CD 6C93*       C      	CALL	RL.UP6
  6C75*   CB 7A          C      	BIT	7,D	; TEST BEFEHLSKENNZEICHENBYTE
  6C77*   20 92          C      	JR	NZ,RL.M16
  6C79*   C3 6CF7*       C      	JP	RL.BF	; NEIN--->FEHLER
                         C      ;----------------------------------------------------------------------
  6C7C*                  C      RL.M10:
  6C7C*   CD 6C93*       C      	CALL	RL.UP6	;BEI BER-BEFEHL ADDIEREN DER
  6C7F*   D5             C      	PUSH	DE	;DEF. BEREICHSLAENGE ZU
  6C80*   CD 6C93*       C      	CALL	RL.UP6	;ADRESSE
  6C83*   7A             C      	LD	A,D
  6C84*   D1             C      	POP	DE
  6C85*   5F             C      	LD	E,A
  6C86*   19             C      	ADD	HL,DE
  6C87*   CD 6C93*       C      	CALL	RL.UP6
  6C8A*   C3 6C0B*       C      	JP	RL.M16
  6C8D*                  C      RL.M11:
  6C8D*   CD 6C93*       C      	CALL	RL.UP6	;BEI BFL=0 SPRUNG ZUM TEST
  6C90*   C3 6C39*       C      	JP	RL.M17	;ADRESSKENNZEICHENBYTE
                         C      ;******* UP ZUR ZEICHENWEISE EINGABE DER O-DATEI **********************
  6C93*                  C      RL.UP6:
  6C93*   CD 614C*       C      	CALL	UK.GETK
  6C96*   57             C      	LD	D,A
  6C97*   0D             C      	DEC	C	;REDUZIEREN BLOCKLAENGE
  6C98*   C0             C      	RET	NZ		;RET BEI UNGLEICH NULL
  6C99*   A7             C      	AND	A	;IST NAECHSTE BLOCKLAENGE NULL ?
  6C9A*   28 04          C      	JR	Z,RL.M21	;JA-->VERZWEIGUNG ENDEBEH
  6C9C*   4F             C      	LD	C,A	;NEIN-->EINTRAGEN BLKLAENGE
  6C9D*   0C             C      	INC	C
  6C9E*   18 F3          C      	JR	RL.UP6
                         C      ;*********** ENDEBEHANDLUNG *******************************************
  6CA0*                  C      RL.M21:
  6CA0*   D1             C      	POP	DE
  6CA1*   E5             C      	PUSH	HL
  6CA2*   3E 0F          C      	LD	A,15
  6CA4*   32 2B00*       C      	LD	(UB.ZN),A
  6CA7*   21 5F91*       C      	LD	HL,UA.ZKEND+3
  6CAA*   11 3460        C      	LD	DE,3460H
  6CAD*   01 0010        C      	LD	BC,16
  6CB0*   ED B0          C      	LDIR
  6CB2*   21 2B00*       C      	LD	HL,UB.ZN
  6CB5*   34             C      	INC	(HL)
  6CB6*   E1             C      	POP	HL
  6CB7*   2B             C      	DEC	HL
  6CB8*   11 3470        C      	LD	DE,3470H	;HINTER AUSSCHRIFT ENDE
  6CBB*   CD 56BF*       C      	CALL	UC.CVHLX
  6CBE*   21 5FA1*       C      	LD	HL,UA.STADR	;STARTADRESSE ?
  6CC1*   CD 595C*       C      	CALL	UR.MIMO
  6CC4*   D8             C      	RET	C
  6CC5*   EB             C      	EX	DE,HL
  6CC6*   21 2B32*       C      	LD	HL,UB.PATAB+2
  6CC9*   CD 5705*       C      	CALL	UC.CVXA	;STARTADR.-->BINAER
  6CCC*   3A 3329        C      	LD	A,(UE.BWSA+329H)
  6CCF*   FE 53          C      	CP	'S'
  6CD1*   20 04          C      	JR	NZ,$+6
  6CD3*   2A 2B32*       C      	LD	HL,(UB.PATAB+2)
  6CD6*   E9             C      	JP	(HL)
  6CD7*   CD 60AC*       C      	CALL	UR.KRW
  6CDA*   CD 60B6*       C      	CALL	UR.KRA
  6CDD*   C9             C      	RET
                         C      ;---------------------------------------------------------------------
  6CDE*                  C      RL.ECHO:
  6CDE*   D1             C      	POP	DE
  6CDF*   3E 93          C      	LD	A,93H
  6CE1*   18 16          C      	JR	RL.FMELD
  6CE3*                  C      RL.DATNV:
  6CE3*   3E 91          C      	LD	A,91H
  6CE5*   18 12          C      	JR	RL.FMELD
  6CE7*                  C      RL.OB:
  6CE7*   3E 96          C      	LD	A,96H
  6CE9*   18 0E          C      	JR	RL.FMELD
  6CEB*                  C      RL.RA:
'Relativloader fuer O-Dateien'	MACRO-80 3.44	09-Dec-81	PAGE	1-69


  6CEB*   3E 97          C      	LD	A,97H
  6CED*   18 0A          C      	JR	RL.FMELD
  6CEF*                  C      RL.SV:
  6CEF*   3E 98          C      	LD	A,98H
  6CF1*   18 06          C      	JR	RL.FMELD
  6CF3*                  C      RL.MN:
  6CF3*   3E 99          C      	LD	A,99H
  6CF5*   18 02          C      	JR	RL.FMELD
  6CF7*                  C      RL.BF:
  6CF7*   3E 9A          C      	LD	A,9AH
  6CF9*                  C      RL.FMELD:
  6CF9*   CD 5D64*       C      	CALL	UF.ERANZ
  6CFC*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Retten von Maschinencodeprogrammen als MRES - P-Datei'
                         C      	PAGE
'Retten von Maschinencodeprogrammen als MRES - P-Datei'	MACRO-80 3.44	09-Dec-81	PAGE	1-70


                         C
                         C      ;	PN	SV
                         C      ;**********************************************************************
                         C      ;
                         C      ;      Retten von Maschinencodeprogrammen als MRES - P-Datei
                         C      ;
                         C      ;**********************************************************************
  6CFD*   6CFD*          C      	DW	$
  6CFF*   53 41 56 45    C      	DB	'SAVE'
  6D03*   3A 3327        C      	LD	A,(UE.BWSA+ 10*80 +7)	;327H
  6D06*   CD 55C5*       C      	CALL	U1.TST
  6D09*   D8             C      	RET	C
  6D0A*   CD 54E2*       C      	CALL	U1.KTINI
  6D0D*   DD 77 03       C      	LD	(IX+3),A
  6D10*   AF             C      	XOR	A
  6D11*   32 2B27*       C      	LD	(UB.PAR1+1),A
  6D14*   CD 55B1*       C      	CALL	U1.BILO	;BS LOESCHEN
  6D17*   CD 60A4*       C      	CALL	UR.KRE
  6D1A*   DD CB 00 56    C      	BIT	2,(IX)
  6D1E*   28 05          C      	JR	Z,$+7
  6D20*   3E 19          C      	LD	A,19H
  6D22*   CD 5D64*       C      	CALL	UF.ERANZ
  6D25*   CD 60B2*       C      	CALL	UR.KRWW
  6D28*                  C      SV.SV20:
  6D28*   CD 5496*       C      	CALL	U1.DSVG
  6D2B*   C5             C      	PUSH	BC
  6D2C*   79             C      	LD	A,C
  6D2D*   32 2B26*       C      	LD	(UB.PAR1),A	;NEXT RECORD
  6D30*   3E 0D          C      	LD	A,13
  6D32*   32 2B00*       C      	LD	(UB.ZN),A
  6D35*                  C      SV.DATN:
  6D35*   21 5F55*       C      	LD	HL,UA.ZKDAT	;Dateiname ?
  6D38*   CD 595C*       C      	CALL	UR.MIMO
  6D3B*   D8             C      	RET	C
  6D3C*   C1             C      	POP	BC
  6D3D*   05             C      	DEC	B
  6D3E*   28 1A          C      	JR	Z,SV.SV30	;NEUE KASSETTE
  6D40*                  C      SV.SV21:
  6D40*   CD 61AC*       C      	CALL	UK.KBW
  6D43*   CD 54C7*       C      	CALL	U1.NMVGL
  6D46*   38 04          C      	JR	C,SV.DATV1	;Dateiname bereits vorhanden
  6D48*   10 F6          C      	DJNZ	SV.SV21
  6D4A*   18 0E          C      	JR	SV.SV30
  6D4C*                  C      SV.DATV1:
  6D4C*   3E 01          C      	LD	A,01H
  6D4E*   B8             C      	CP	B
  6D4F*   CC 6E98*       C      	CALL	Z,SV.DALO1
  6D52*   28 0E          C      	JR	Z,SV.SV37
  6D54*                  C      SV.DATVO:
  6D54*   3E 92          C      	LD	A,92H
  6D56*   CD 5D64*       C      	CALL	UF.ERANZ
  6D59*   C9             C      	RET
  6D5A*                  C      SV.SV30:
  6D5A*   3E 50          C      	LD	A,'P'
  6D5C*   32 2B28*       C      	LD	(UB.PAR2),A
  6D5F*   CD 554E*       C      	CALL	U1.VZS
  6D62*                  C      SV.SV37:
  6D62*   3A 2B27*       C      	LD	A,(UB.PAR1+1)
  6D65*   FE 4C          C      	CP	'L'
  6D67*   20 0B          C      	JR	NZ,SV.SV31
  6D69*   21 5FB4*       C      	LD	HL,UA.ZKDL
  6D6C*   CD 595C*       C      	CALL	UR.MIMO
  6D6F*   7E             C      	LD	A,(HL)
  6D70*   FE 4A          C      	CP	'J'
  6D72*   20 E0          C      	JR	NZ,SV.DATVO
  6D74*                  C      SV.SV31:
  6D74*   3A 2B26*       C      	LD	A,(UB.PAR1)	;NEXT RECORD
  6D77*   47             C      	LD	B,A
  6D78*   C5             C      	PUSH	BC
  6D79*   04             C      	INC	B
  6D7A*   CD 60E9*       C      	CALL	UR.POSIK
  6D7D*   CD 61AC*       C      	CALL	UK.KBW
  6D80*   21 0E65        C      	LD	HL,UE.PUF
  6D83*   C1             C      	POP	BC
  6D84*   7E             C      	LD	A,(HL)
  6D85*   B8             C      	CP	B
  6D86*   28 06          C      	JR	Z,SV.SAVE3
  6D88*   3E 94          C      	LD	A,94H
  6D8A*   CD 5D64*       C      	CALL	UF.ERANZ
  6D8D*   C9             C      	RET
  6D8E*                  C      SV.SAVE3:
  6D8E*   21 5F7B*       C      	LD	HL,UA.ZKBEG	;Beginn ?
'Retten von Maschinencodeprogrammen als MRES - P-Datei'	MACRO-80 3.44	09-Dec-81	PAGE	1-71


  6D91*   CD 595C*       C      	CALL	UR.MIMO
  6D94*   DA 6D35*       C      	JP	C,SV.DATN
  6D97*   CD 55CF*       C      	CALL	U1.PRADR
  6D9A*   38 F2          C      	JR	C,SV.SAVE3
  6D9C*   EB             C      	EX	DE,HL
  6D9D*   21 2B28*       C      	LD	HL,UB.PAR2
  6DA0*   CD 5705*       C      	CALL	UC.CVXA
  6DA3*                  C      SV.SAVE4:
  6DA3*   21 5F8E*       C      	LD	HL,UA.ZKEND	;Ende ?
  6DA6*   CD 595C*       C      	CALL	UR.MIMO
  6DA9*   38 E3          C      	JR	C,SV.SAVE3
  6DAB*   CD 55CF*       C      	CALL	U1.PRADR
  6DAE*   38 F3          C      	JR	C,SV.SAVE4
  6DB0*   EB             C      	EX	DE,HL
  6DB1*   21 2B2A*       C      	LD	HL,UB.PAR3
  6DB4*   CD 5705*       C      	CALL	UC.CVXA
  6DB7*   CD 6E07*       C      	CALL	SV.BYANZ
  6DBA*   38 D2          C      	JR	C,SV.SAVE3
  6DBC*   28 D0          C      	JR	Z,SV.SAVE3
  6DBE*   CD 6E2C*       C      	CALL	SV.SAVE
  6DC1*   CD 60C8*       C      	CALL	UR.KBM
  6DC4*   CD 6E12*       C      	CALL	SV.DATS1	;1.DATEISATZ SCHREIBEN
  6DC7*   CD 60CE*       C      	CALL	UR.KSL
  6DCA*   CD 60B2*       C      	CALL	UR.KRWW
  6DCD*   CD 5496*       C      	CALL	U1.DSVG
  6DD0*   05             C      	DEC	B
  6DD1*   3A 2B27*       C      	LD	A,(UB.PAR1+1)
  6DD4*   FE 4C          C      	CP	'L'
  6DD6*   28 13          C      	JR	Z,SV.SAVE5
  6DD8*   21 0E66        C      	LD	HL,UE.PUF+1
  6DDB*   34             C      	INC	(HL)	;NEXT RECORD+1
  6DDC*   21 0E68        C      	LD	HL,UE.PUF+3
  6DDF*   46             C      	LD	B,(HL)
  6DE0*   34             C      	INC	(HL)	;ANZ.VERZ.EINTR.+1
  6DE1*                  C      SV.SAVE6:
  6DE1*   CD 60DA*       C      	CALL	UR.KBR
  6DE4*   DD 36 04 08    C      	LD	(IX+4),08H	;NEUEN DS-SATZ AUSGEBEN
  6DE8*   CD 5D34*       C      	CALL	UF.EXEC
  6DEB*                  C      SV.SAVE5:
  6DEB*   CD 61AC*       C      	CALL	UK.KBW
  6DEE*   10 FB          C      	DJNZ	SV.SAVE5
  6DF0*   CD 60DA*       C      	CALL	UR.KBR
  6DF3*   2A 2B2E*       C      	LD	HL,(UB.PAR5)
  6DF6*   22 0E7E        C      	LD	(UE.PUF+25),HL	;DATEILAENGE EINTRAGEN
  6DF9*   DD 36 04 08    C      	LD	(IX+4),08H
  6DFD*   CD 5D34*       C      	CALL	UF.EXEC
  6E00*   CD 60AC*       C      	CALL	UR.KRW
  6E03*   CD 60B6*       C      	CALL	UR.KRA
  6E06*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  6E07*                  C      SV.BYANZ:
  6E07*   2A 2B2A*       C      	LD	HL,(UB.PAR3)	;Byteanzahl berechnen
  6E0A*   ED 5B 2B28*    C      	LD	DE,(UB.PAR2)
  6E0E*   B7             C      	OR	A
  6E0F*   ED 52          C      	SBC	HL,DE
  6E11*   C9             C      	RET
  6E12*                  C      SV.DATS1:
  6E12*   21 0020        C      	LD	HL,32	;1. Dateisatz schreiben
  6E15*   CD 5631*       C      	CALL	XY.STIDX
  6E18*   09             C      	DB	9
  6E19*   CD 5486*       C      	CALL	U1.VSX
  6E1C*   21 0E65        C      	LD	HL,UE.PUF
  6E1F*   3A 2B26*       C      	LD	A,(UB.PAR1)	;NEXT RECORD
  6E22*   3C             C      	INC	A
  6E23*   77             C      	LD	(HL),A
  6E24*   DD 36 04 08    C      	LD	(IX+4),08H
  6E28*   CD 5D34*       C      	CALL	UF.EXEC
  6E2B*   C9             C      	RET
  6E2C*                  C      SV.SAVE:
  6E2C*   21 0000        C      	LD	HL,0
  6E2F*   CD 5621*       C      	CALL	XY.STDX
  6E32*   11             C      	DB	17
  6E33*   21 0080        C      	LD	HL,80H	;Blocklaenge
  6E36*   CD 5631*       C      	CALL	XY.STIDX
  6E39*   09             C      	DB	9
  6E3A*   CD 6214*       C      	CALL	UK.KSPFB	;Pufferbereitstellung
  6E3D*                  C      SV.SAVE1:
  6E3D*   CD 6E07*       C      	CALL	SV.BYANZ	;Byteanzahl berechnen
  6E40*   23             C      	INC	HL
  6E41*   E5             C      	PUSH	HL
  6E42*   7C             C      	LD	A,H
  6E43*   B5             C      	OR	L
  6E44*   E1             C      	POP	HL
'Retten von Maschinencodeprogrammen als MRES - P-Datei'	MACRO-80 3.44	09-Dec-81	PAGE	1-72


  6E45*   28 13          C      	JR	Z,SV.SVLS2	;---> 0 Byte
  6E47*   01 007D        C      	LD	BC,UE.SVL	;Satzlaenge
  6E4A*   B7             C      	OR	A
  6E4B*   ED 42          C      	SBC	HL,BC
  6E4D*   38 05          C      	JR	C,SV.SVLS	;---> letzter Satz
  6E4F*   CD 6EA3*       C      	CALL	SV.SVSZ
  6E52*   18 E9          C      	JR	SV.SAVE1
  6E54*                  C      SV.SVLS:
  6E54*   7D             C      	LD	A,L
  6E55*   C6 7D          C      	ADD	A,UE.SVL	;A:= Laenge des letzten Satzes
  6E57*   CD 6EA5*       C      	CALL	SV.SVSZ2
  6E5A*                  C      SV.SVLS2:
  6E5A*   AF             C      	XOR	A
  6E5B*   CD 61F0*       C      	CALL	UK.PUTK
  6E5E*   21 5FA1*       C      	LD	HL,UA.STADR	;Startadresse
  6E61*   CD 595C*       C      	CALL	UR.MIMO
  6E64*   7E             C      	LD	A,(HL)
  6E65*   FE 20          C      	CP	' '
  6E67*   28 27          C      	JR	Z,SV.STAD0	;KEINE EINGABE (0000)
  6E69*   EB             C      	EX	DE,HL
  6E6A*   21 2B2C*       C      	LD	HL,UB.PAR4
  6E6D*   CD 5705*       C      	CALL	UC.CVXA
  6E70*                  C      SV.SVLS1:
  6E70*   2A 2B2C*       C      	LD	HL,(UB.PAR4)
  6E73*   7C             C      	LD	A,H	;Startadresse ausgeben
  6E74*   CD 61F0*       C      	CALL	UK.PUTK
  6E77*   7D             C      	LD	A,L
  6E78*   CD 61F0*       C      	CALL	UK.PUTK
  6E7B*   0E 03          C      	LD	C,3
  6E7D*                  C      SV.SVEN2:
  6E7D*   06 80          C      	LD	B,80H
  6E7F*   AF             C      	XOR	A
  6E80*                  C      SV.SVEN1:
  6E80*   CD 61F0*       C      	CALL	UK.PUTK
  6E83*   10 FB          C      	DJNZ	SV.SVEN1
  6E85*   0D             C      	DEC	C
  6E86*   20 F5          C      	JR	NZ,SV.SVEN2
  6E88*   CD 5601*       C      	CALL	XY.LDDX
  6E8B*   11             C      	DB	17
  6E8C*   22 2B2E*       C      	LD	(UB.PAR5),HL
  6E8F*   C9             C      	RET
  6E90*                  C      SV.STAD0:
  6E90*   21 0000        C      	LD	HL,0
  6E93*   22 2B2C*       C      	LD	(UB.PAR4),HL
  6E96*   18 D8          C      	JR	SV.SVLS1
  6E98*                  C      SV.DALO1:
  6E98*   F5             C      	PUSH	AF
  6E99*   21 2B26*       C      	LD	HL,UB.PAR1
  6E9C*   35             C      	DEC	(HL)
  6E9D*   23             C      	INC	HL
  6E9E*   3E 4C          C      	LD	A,'L'
  6EA0*   77             C      	LD	(HL),A
  6EA1*   F1             C      	POP	AF
  6EA2*   C9             C      	RET
  6EA3*                  C      SV.SVSZ:
  6EA3*   3E 7D          C      	LD	A,UE.SVL
  6EA5*                  C      SV.SVSZ2:
  6EA5*   F5             C      	PUSH	AF
  6EA6*   CD 61F0*       C      	CALL	UK.PUTK
  6EA9*   ED 5B 2B28*    C      	LD	DE,(UB.PAR2)
  6EAD*   7A             C      	LD	A,D
  6EAE*   CD 61F0*       C      	CALL	UK.PUTK
  6EB1*   7B             C      	LD	A,E
  6EB2*   CD 61F0*       C      	CALL	UK.PUTK
  6EB5*   F1             C      	POP	AF
  6EB6*   47             C      	LD	B,A
  6EB7*                  C      SV.SVSZ1:
  6EB7*   1A             C      	LD	A,(DE)
  6EB8*   CD 61F0*       C      	CALL	UK.PUTK
  6EBB*   13             C      	INC	DE
  6EBC*   10 F9          C      	DJNZ	SV.SVSZ1
  6EBE*   ED 53 2B28*    C      	LD	(UB.PAR2),DE
  6EC2*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                                ;
                                ;	INCLUDE	KX.MAC	;Kopieren von MRES-Kassetten Teil 1
                                ;	INCLUDE	KY.MAC	;Kopieren von MRES-Kassetten Teil 2
                                ;	INCLUDE	KU.MAC	;Unterprogramme fuer KOPI
                         C      	INCLUDE K4.MAC	;Kopieren MRES
                         C      	TITLE	'Kopieren von MRES-Kassetten Teil 1'
                         C      	PAGE
'Kopieren von MRES-Kassetten Teil 1'	MACRO-80 3.44	09-Dec-81	PAGE	1-73


                         C
                         C      ;	PN	KX
                         C      ;------------------------------------------------------------------
                         C      ;
                         C      ;          KOPIEREN VON MRES-KASSETTEN       TEIL1
                         C      ;
                         C      ;----------------------------------------------------------------
  6EC3*   6EC3*          C      	DW	$
  6EC5*   4B 4F 50 49    C      	DB	'KOPI'
  6EC9*   CD 54E2*       C      	CALL	U1.KTINI
  6ECC*   11 E000        C      	LD	DE,BC.TAB1
  6ECF*   21 3327        C      	LD	HL,UE.BWSA + 10*80 +7	;327H
  6ED2*   7E             C      	LD	A,(HL)
  6ED3*   CD 55C5*       C      	CALL	U1.TST
  6ED6*   D8             C      	RET	C
  6ED7*   12             C      	LD	(DE),A
  6ED8*   23             C      	INC	HL
  6ED9*   EE 33          C      	XOR	33H
  6EDB*   BE             C      	CP	(HL)
  6EDC*   C0             C      	RET	NZ
  6EDD*   EE 30          C      	XOR	30H
  6EDF*   13             C      	INC	DE
  6EE0*   12             C      	LD	(DE),A
  6EE1*   3A 3326        C      	LD	A,(UE.BWSA + 10*80 +6)	;326H
  6EE4*   FE 4A          C      	CP	'J'
  6EE6*   28 05          C      	JR	Z,$+7	;BEI KOPIJ WERDEN WEITERE PARAMETER
  6EE8*   23             C      	INC	HL	;IGNORIERT
  6EE9*   23             C      	INC	HL
  6EEA*   7E             C      	LD	A,(HL)
  6EEB*   FE 20          C      	CP	20H
  6EED*   F5             C      	PUSH	AF
  6EEE*   20 0C          C      	JR	NZ,$+14
  6EF0*   CD 546D*       C      	CALL	U1.EIN
  6EF3*   CD 55E6*       C      	CALL	U1.KRWE
  6EF6*   CD 5476*       C      	CALL	U1.AUS
  6EF9*   CD 55E6*       C      	CALL	U1.KRWE
  6EFC*   CD 7037*       C      	CALL	KX.UPA
  6EFF*   F1             C      	POP	AF
  6F00*   28 13          C      	JR	Z,$+21
  6F02*   FE 41          C      	CP	'A'
  6F04*   28 0A          C      	JR	Z,$+12
  6F06*   FE 4C          C      	CP	'L'
  6F08*   20 0B          C      	JR	NZ,$+13
  6F0A*   CD 5445*       C      	CALL	U1.COPB
  6F0D*   C3 6FDD*       C      	JP	KX.RSPFR
  6F10*   CD 5441*       C      	CALL	U1.COPB2
  6F13*   18 FB          C      	JR	$-3
                         C      ;-------------------------------------------------------------------
  6F15*   CD 546D*       C      	CALL	U1.EIN
  6F18*   CD 5496*       C      	CALL	U1.DSVG
  6F1B*   CD 5420*       C      	CALL	U1.KBR4
  6F1E*   CD 542B*       C      	CALL	U1.BREAD
  6F21*   21 5E67*       C      	LD	HL,UA.Z7E
  6F24*   11 3163        C      	LD	DE,SD.BWSA +  4*80 + 35	;3163H
  6F27*   01 001F        C      	LD	BC,31
  6F2A*   ED B0          C      	LDIR
  6F2C*   21 5E86*       C      	LD	HL,UA.GER
  6F2F*   11 31EA        C      	LD	DE,SD.BWSA +  6*80 + 10	;31EAH
  6F32*   CD 55AB*       C      	CALL	U1.INFO
  6F35*   21 5E31*       C      	LD	HL,UA.KNAME+3
  6F38*   11 323A        C      	LD	DE,SD.BWSA +  7*80 + 10	;323AH
  6F3B*   CD 55AB*       C      	CALL	U1.INFO
  6F3E*   21 5E44*       C      	LD	HL,UA.NR+3
  6F41*   11 328A        C      	LD	DE,SD.BWSA +  8*80 + 10	;328AH
  6F44*   CD 55AB*       C      	CALL	U1.INFO
  6F47*   21 5E57*       C      	LD	HL,UA.KOMMT+3
  6F4A*   11 32DA        C      	LD	DE,SD.BWSA +  9*80 + 10	;32DAH
  6F4D*   CD 55AB*       C      	CALL	U1.INFO
  6F50*   11 3203        C      	LD	DE,SD.BWSA +  6*80 + 35	;3203H
  6F53*   3A E000        C      	LD	A,(BC.TAB1)
  6F56*   CD 56A5*       C      	CALL	UC.CVBX+2
  6F59*   11 321B        C      	LD	DE,SD.BWSA +  6*80 + 59	;321BH
  6F5C*   3A E001        C      	LD	A,(BC.TAB1+1)
  6F5F*   CD 56A5*       C      	CALL	UC.CVBX+2
  6F62*   21 0E69        C      	LD	HL,UE.PUF+4
  6F65*   11 3253        C      	LD	DE,SD.BWSA +  7*80 + 35	;3253H
  6F68*   06 06          C      	LD	B,6
  6F6A*   CD 57B0*       C      	CALL	UC.DKONV
  6F6D*   21 0E8A        C      	LD	HL,UE.PUF+37
  6F70*   11 32A3        C      	LD	DE,SD.BWSA +  8*80 + 35	;32A3H
  6F73*   06 03          C      	LD	B,3
  6F75*   CD 57B0*       C      	CALL	UC.DKONV
'Kopieren von MRES-Kassetten Teil 1'	MACRO-80 3.44	09-Dec-81	PAGE	1-74


  6F78*   11 32F3        C      	LD	DE,SD.BWSA +  9*80 + 35	;32F3H
  6F7B*   06 0B          C      	LD	B,11
  6F7D*   CD 57B0*       C      	CALL	UC.DKONV
  6F80*   CD 60D4*       C      	CALL	UR.KBV
  6F83*   CD 60D4*       C      	CALL	UR.KBV
  6F86*   CD 542B*       C      	CALL	U1.BREAD
  6F89*   3A 0E68        C      	LD	A,(UE.PUF+3)
  6F8C*   3D             C      	DEC	A
  6F8D*   CA 6FE8*       C      	JP	Z,KX.ENDR
  6F90*   CD 5518*       C      	CALL	U1.VERIN
  6F93*   CD 5476*       C      	CALL	U1.AUS
  6F96*   CD 5496*       C      	CALL	U1.DSVG
  6F99*   CD 5420*       C      	CALL	U1.KBR4
  6F9C*   DD 36 04 02    C      	LD	(IX+4),02H
  6FA0*   CD 5D34*       C      	CALL	UF.EXEC
  6FA3*   21 0E69        C      	LD	HL,UE.PUF+4
  6FA6*   11 326B        C      	LD	DE,SD.BWSA +  7*80 + 59	;326BH
  6FA9*   06 06          C      	LD	B,6
  6FAB*   CD 57B0*       C      	CALL	UC.DKONV
  6FAE*   21 0E8A        C      	LD	HL,UE.PUF+37
  6FB1*   11 32BB        C      	LD	DE,SD.BWSA +  8*80 + 59	;32BBH
  6FB4*   06 03          C      	LD	B,3
  6FB6*   CD 57B0*       C      	CALL	UC.DKONV
  6FB9*   11 330B        C      	LD	DE,SD.BWSA +  9*80 + 59	;330BH
  6FBC*   06 0B          C      	LD	B,11
  6FBE*   CD 57B0*       C      	CALL	UC.DKONV
  6FC1*   CD 60D4*       C      	CALL	UR.KBV
  6FC4*   CD 60D4*       C      	CALL	UR.KBV
  6FC7*   DD 36 04 02    C      	LD	(IX+4),02H
  6FCB*   CD 5D34*       C      	CALL	UF.EXEC
  6FCE*   CD 55B1*       C      	CALL	U1.BILO
  6FD1*   11 E002        C      	LD	DE,BC.VTABA
  6FD4*   CD 5520*       C      	CALL	U1.VERNI
  6FD7*   CD 553A*       C      	CALL	U1.VORST
  6FDA*   C3 7054*       C      	JP	KY.MD
  6FDD*                  C      KX.RSPFR:
  6FDD*   F5             C      	PUSH	AF
  6FDE*   23             C      	INC	HL
  6FDF*   23             C      	INC	HL
  6FE0*   7E             C      	LD	A,(HL)
  6FE1*   B7             C      	OR	A
  6FE2*   FE 52          C      	CP	'R'
  6FE4*   20 06          C      	JR	NZ,$+8
  6FE6*   18 01          C      	JR	$+3
  6FE8*                  C      KX.ENDR:
  6FE8*   F5             C      	PUSH	AF
  6FE9*   37             C      	SCF
  6FEA*   18 04          C      	JR	$+6
  6FEC*   FE 46          C      	CP	'F'
  6FEE*   20 15          C      	JR	NZ,$+23
  6FF0*   CD 546D*       C      	CALL	U1.EIN
  6FF3*   DC 60AC*       C      	CALL	C,UR.KRW
  6FF6*   CD 60B6*       C      	CALL	UR.KRA
  6FF9*   CD 5476*       C      	CALL	U1.AUS
  6FFC*   CD 60A4*       C      	CALL	UR.KRE
  6FFF*   DC 60B2*       C      	CALL	C,UR.KRWW
  7002*   CD 60B6*       C      	CALL	UR.KRA
  7005*   F1             C      	POP	AF
  7006*   C9             C      	RET
  7007*                  C      KX.EXEC2:
  7007*   F5             C      	PUSH	AF
  7008*   DD CB 00 BE    C      	RES	7,(IX+0)
  700C*   DD 36 01 00    C      	LD	(IX+1),0
  7010*   CD 5CA1*       C      	CALL	KR.KARO
  7013*   DD CB 00 7E    C      	BIT	7,(IX+0)
  7017*   28 0A          C      	JR	Z,$+12
  7019*   DD 7E 01       C      	LD	A,(IX+1)
  701C*   FE 14          C      	CP	14H
  701E*   28 05          C      	JR	Z,$+7
  7020*   CD 5D64*       C      	CALL	UF.ERANZ
  7023*   F1             C      	POP	AF
  7024*   C9             C      	RET
  7025*   DD CB 00 BE    C      	RES	7,(IX)
  7029*   CD 5476*       C      	CALL	U1.AUS
  702C*   CD 60CE*       C      	CALL	UR.KSL
  702F*   F1             C      	POP	AF
  7030*   06 06          C      	LD	B,6
  7032*   33             C      	INC	SP
  7033*   10 FD          C      	DJNZ	$-1	;STACK BERICHTIGEN
  7035*   18 A6          C      	JR	KX.RSPFR
  7037*                  C      KX.UPA:
  7037*   CD 546D*       C      	CALL	U1.EIN
  703A*   CD 60A4*       C      	CALL	UR.KRE
'Kopieren von MRES-Kassetten Teil 1'	MACRO-80 3.44	09-Dec-81	PAGE	1-75


  703D*   DD 36 00 00    C      	LD	(IX+0),0
  7041*   CD 5476*       C      	CALL	U1.AUS
  7044*   CD 60A4*       C      	CALL	UR.KRE
  7047*   DD CB 00 56    C      	BIT	2,(IX+0)
  704B*   28 05          C      	JR	Z,$+7
  704D*   D1             C      	POP	DE
  704E*   3E 19          C      	LD	A,19H
  7050*   CD 5D64*       C      	CALL	UF.ERANZ
  7053*   C9             C      	RET
                         C      ;	END
                         C      	TITLE	'Kopieren von MRES-Kassetten Teil 2'
                         C      	PAGE
'Kopieren von MRES-Kassetten Teil 2'	MACRO-80 3.44	09-Dec-81	PAGE	1-76


                         C
                         C      ;	PN	KY
                         C      ;---------------------------------------------------------------------
                         C      ;
                         C      ;          KOPIEREN VON MRES-KASSETTEN           TEIL 2
                         C      ;
                         C      ;--------------------------------------------------------------------
  7054*                  C      KY.MD:
  7054*   CD 55B1*       C      	CALL	U1.BILO
  7057*   21 5E95*       C      	LD	HL,UA.KOPFR
  705A*   CD 72AD*       C      	CALL	KY.SATR
  705D*   3E 0D          C      	LD	A,13
  705F*   32 2B00*       C      	LD	(UB.ZN),A
  7062*   21 ECA2        C      	LD	HL,BC.VTABE+32
  7065*   FD 21 F902     C      	LD	IY,BC.TAB2
  7069*   FD 36 00 FF    C      	LD	(IY+0),0FFH
  706D*   3A EC85        C      	LD	A,(BC.VTABE+3)
  7070*   47             C      	LD	B,A
  7071*   05             C      	DEC	B
                         C      ;--------------------------------ABFRAGEZYKLUS------------------------
  7072*                  C      KY.DFR:
  7072*   C5             C      	PUSH	BC
  7073*   11 2B4E*       C      	LD	DE,UB.SATZ+26
  7076*   01 0006        C      	LD	BC,6
  7079*   ED B0          C      	LDIR
  707B*   13             C      	INC	DE
  707C*   13             C      	INC	DE
  707D*   01 0002        C      	LD	BC,2
  7080*   ED B0          C      	LDIR
  7082*   01 0018        C      	LD	BC,24
  7085*   09             C      	ADD	HL,BC
  7086*   E5             C      	PUSH	HL
  7087*   21 2B34*       C      	LD	HL,UB.SATZ
  708A*   CD 595C*       C      	CALL	UR.MIMO
  708D*   DC 7309*       C      	CALL	C,KU.ZEIR
  7090*   CD 72A4*       C      	CALL	KY.JHL	;BEI KOPIJ WIRD J GESETZT
  7093*   7E             C      	LD	A,(HL)
  7094*   FE 4A          C      	CP	'J'
  7096*   C4 72D1*       C      	CALL	NZ,KU.TAB2L
  7099*   E1             C      	POP	HL
  709A*   01 0009        C      	LD	BC,9
  709D*   B7             C      	OR	A
  709E*   ED 42          C      	SBC	HL,BC
  70A0*   7E             C      	LD	A,(HL)
  70A1*   FD 77 00       C      	LD	(IY+0),A
  70A4*   FD 23          C      	INC	IY
  70A6*   FD 36 00 FF    C      	LD	(IY+0),0FFH
  70AA*   09             C      	ADD	HL,BC
  70AB*   3A E005        C      	LD	A,(BC.VTABA+3)
  70AE*   FE 01          C      	CP	01H
  70B0*   28 2E          C      	JR	Z,KY.EZYK1
  70B2*   E5             C      	PUSH	HL
  70B3*   01 0020        C      	LD	BC,32
  70B6*   B7             C      	OR	A
  70B7*   ED 42          C      	SBC	HL,BC
  70B9*   EB             C      	EX	DE,HL
  70BA*   E1             C      	POP	HL
  70BB*   DD 21 E002     C      	LD	IX,BC.VTABA
  70BF*   47             C      	LD	B,A
  70C0*   05             C      	DEC	B
  70C1*                  C      KY.VZVGL:
  70C1*   C5             C      	PUSH	BC
  70C2*   01 0020        C      	LD	BC,32
  70C5*   DD 09          C      	ADD	IX,BC
  70C7*   DD E5          C      	PUSH	IX
  70C9*   06 07          C      	LD	B,7
  70CB*   D5             C      	PUSH	DE
  70CC*                  C      KY.SVGL:
  70CC*   1A             C      	LD	A,(DE)
  70CD*   DD BE 00       C      	CP	(IX+0)
  70D0*   20 08          C      	JR	NZ,KY.NDA
  70D2*   DD 23          C      	INC	IX
  70D4*   13             C      	INC	DE
  70D5*   10 F5          C      	DJNZ	KY.SVGL
  70D7*   CD 7339*       C      	CALL	KU.DD	;DATEI SCHON VORHANDEN
  70DA*                  C      KY.NDA:
  70DA*   D1             C      	POP	DE
  70DB*   DD E1          C      	POP	IX
  70DD*   C1             C      	POP	BC
  70DE*   10 E1          C      	DJNZ	KY.VZVGL
  70E0*                  C      KY.EZYK1:
  70E0*   C1             C      	POP	BC
'Kopieren von MRES-Kassetten Teil 2'	MACRO-80 3.44	09-Dec-81	PAGE	1-77


  70E1*   10 8F          C      	DJNZ	KY.DFR
                         C      ;---------------------------------------------------------------------
  70E3*                  C      KY.ATAA:
  70E3*   06 03          C      	LD	B,3	;WARTESCHLEIFE FUER
  70E5*   21 FFFF        C      	LD	HL,0FFFFH
  70E8*   2B             C      	DEC	HL
  70E9*   7C             C      	LD	A,H
  70EA*   B5             C      	OR	L
  70EB*   20 FB          C      	JR	NZ,$-3
  70ED*   10 F6          C      	DJNZ	$-8
  70EF*   21 5ECB*       C      	LD	HL,UA.EABFR
  70F2*   CD 72AD*       C      	CALL	KY.SATR
  70F5*   21 2B34*       C      	LD	HL,UB.SATZ
  70F8*   CD 595C*       C      	CALL	UR.MIMO
  70FB*   38 F8          C      	JR	C,$-6
  70FD*   CD 72A4*       C      	CALL	KY.JHL
  7100*   7E             C      	LD	A,(HL)
  7101*   FE 4A          C      	CP	'J'
  7103*   C2 7054*       C      	JP	NZ,KY.MD
                         C      ;--------------------------------Labelnummern fuer Ausgabe ---------
  7106*                  C      KY.ATAB:
  7106*   06 00          C      	LD	B,0
  7108*   21 F902        C      	LD	HL,BC.TAB2
  710B*   11 F9D2        C      	LD	DE,BC.TAB3
  710E*   7E             C      	LD	A,(HL)
  710F*   FE FF          C      	CP	0FFH	;KEINE DATEI KOPIEREN
  7111*   CA 6FE8*       C      	JP	Z,KX.ENDR
  7114*   3A E003        C      	LD	A,(BC.VTABA+1)
  7117*                  C      KY.ATABE:
  7117*   12             C      	LD	(DE),A
  7118*   23             C      	INC	HL
  7119*   13             C      	INC	DE
  711A*   04             C      	INC	B
  711B*   F5             C      	PUSH	AF
  711C*   7E             C      	LD	A,(HL)
  711D*   FE FF          C      	CP	0FFH
  711F*   28 04          C      	JR	Z,KY.WEI
  7121*   F1             C      	POP	AF
  7122*   3C             C      	INC	A
  7123*   18 F2          C      	JR	KY.ATABE
                         C      ;------------------------------TAB:NR DER VERZ.EINTRAGUNGEN (EING.)------
  7125*                  C      KY.WEI:
  7125*   F1             C      	POP	AF
  7126*   C5             C      	PUSH	BC
  7127*   AF             C      	XOR	A
  7128*   57             C      	LD	D,A
  7129*   3A EC85        C      	LD	A,(BC.VTABE+3)
  712C*   47             C      	LD	B,A
  712D*   05             C      	DEC	B
  712E*   21 F902        C      	LD	HL,BC.TAB2
  7131*   FD 21 F96A     C      	LD	IY,BC.TAB2A
  7135*   DD 21 ECA2     C      	LD	IX,BC.VTABE+32	;???
  7139*                  C      KY.ZYK:
  7139*   14             C      	INC	D
  713A*   7E             C      	LD	A,(HL)
  713B*   DD BE 17       C      	CP	(IX+23)
  713E*   20 0B          C      	JR	NZ,KY.NE
  7140*   7A             C      	LD	A,D
  7141*   FD 77 00       C      	LD	(IY+0),A
  7144*   FD 36 01 FF    C      	LD	(IY+1),0FFH
  7148*   23             C      	INC	HL
  7149*   FD 23          C      	INC	IY
  714B*                  C      KY.NE:
  714B*   C5             C      	PUSH	BC
  714C*   01 0020        C      	LD	BC,32
  714F*   DD 09          C      	ADD	IX,BC
  7151*   C1             C      	POP	BC
  7152*   10 E5          C      	DJNZ	KY.ZYK
                         C      ;------------------------------------AUFBAU AUSGABEVERZ.-----
  7154*   3A E005        C      	LD	A,(BC.VTABA+3)
  7157*   47             C      	LD	B,A
  7158*   FE 01          C      	CP	01H
  715A*   28 08          C      	JR	Z,KY.EVZ
  715C*   21 E002        C      	LD	HL,BC.VTABA
  715F*   CD 72C8*       C      	CALL	KU.VVOR
  7162*   18 03          C      	JR	KY.EVZ1
  7164*                  C      KY.EVZ:
  7164*   21 E022        C      	LD	HL,BC.VTABA+32
  7167*                  C      KY.EVZ1:
  7167*   DD 21 F96A     C      	LD	IX,BC.TAB2A
  716B*   FD 21 F9D2     C      	LD	IY,BC.TAB3
  716F*   EB             C      	EX	DE,HL
  7170*   21 ECA2        C      	LD	HL,BC.VTABE+32
'Kopieren von MRES-Kassetten Teil 2'	MACRO-80 3.44	09-Dec-81	PAGE	1-78


  7173*   DD 7E 00       C      	LD	A,(IX+0)
  7176*   FE 01          C      	CP	01H
  7178*   28 05          C      	JR	Z,KY.VSTR
  717A*   3D             C      	DEC	A
  717B*   47             C      	LD	B,A
  717C*   CD 72C8*       C      	CALL	KU.VVOR
  717F*                  C      KY.VSTR:
  717F*   01 0020        C      	LD	BC,32
  7182*   ED B0          C      	LDIR
  7184*   FD 7E 00       C      	LD	A,(IY+0)
  7187*   EB             C      	EX	DE,HL
  7188*   01 0009        C      	LD	BC,9
  718B*   B7             C      	OR	A
  718C*   ED 42          C      	SBC	HL,BC
  718E*   77             C      	LD	(HL),A
  718F*   09             C      	ADD	HL,BC
  7190*   EB             C      	EX	DE,HL
  7191*   DD 7E 01       C      	LD	A,(IX+1)
  7194*   FE FF          C      	CP	0FFH
  7196*   28 10          C      	JR	Z,KY.COPY
  7198*   DD 96 00       C      	SUB	(IX+0)
  719B*   3D             C      	DEC	A
  719C*   47             C      	LD	B,A
  719D*   FE 00          C      	CP	00H
  719F*   C4 72C8*       C      	CALL	NZ,KU.VVOR
  71A2*   FD 23          C      	INC	IY
  71A4*   DD 23          C      	INC	IX
  71A6*   18 D7          C      	JR	KY.VSTR
                         C      ;------------------------------------VERZ.SCHREIBEN (NUR NEUE SAETZE)---
  71A8*                  C      KY.COPY:
  71A8*   DD 21 2B03*    C      	LD	IX,UB.KTAB
  71AC*   CD 54FB*       C      	CALL	U1.KTIN1
  71AF*   DD 36 0A 20    C      	LD	(IX+10),20H
  71B3*   CD 5476*       C      	CALL	U1.AUS
  71B6*   3A E005        C      	LD	A,(BC.VTABA+3)
  71B9*   47             C      	LD	B,A
  71BA*   CD 60D4*       C      	CALL	UR.KBV	;AUSGABEKASSETTE
  71BD*   3D             C      	DEC	A
  71BE*   20 FA          C      	JR	NZ,$-4	;VORSTELLEN BIS HINTER LETZTEN ALTEN
  71C0*   21 E002        C      	LD	HL,BC.VTABA	;VERZ.SATZ
  71C3*   11 0020        C      	LD	DE,32
  71C6*   19             C      	ADD	HL,DE
  71C7*   10 FA          C      	DJNZ	$-4	;AUSGABEVERZ.ZEIGER
  71C9*   C1             C      	POP	BC
  71CA*   78             C      	LD	A,B
  71CB*   F5             C      	PUSH	AF
  71CC*                  C      KY.VSCHR:
  71CC*   11 0E65        C      	LD	DE,UE.PUF
  71CF*   01 0020        C      	LD	BC,32
  71D2*   ED B0          C      	LDIR
  71D4*   CD 60D4*       C      	CALL	UR.KBV
  71D7*   CD 60DA*       C      	CALL	UR.KBR
  71DA*   DD 36 04 08    C      	LD	(IX+4),08H
  71DE*   CD 5D34*       C      	CALL	UF.EXEC
  71E1*   3D             C      	DEC	A
  71E2*   20 E8          C      	JR	NZ,KY.VSCHR
                         C      ;----------------------------------------------------------------
  71E4*   11 33FA        C      	LD	DE,SD.BWSA + 12*80 + 58	;33FAH	;''ES WIRD KOPIERT''
  71E7*   21 7294*       C      	LD	HL,KY.EWK
  71EA*   01 0010        C      	LD	BC,16
  71ED*   ED B0          C      	LDIR
                         C      ;------------------------------KOPIEREN--------------------------
  71EF*   21 F902        C      	LD	HL,BC.TAB2
  71F2*   11 F9D2        C      	LD	DE,BC.TAB3
  71F5*   FD 21 F96A     C      	LD	IY,BC.TAB2A
  71F9*   1A             C      	LD	A,(DE)
  71FA*   47             C      	LD	B,A
  71FB*   04             C      	INC	B
  71FC*   CD 60E9*       C      	CALL	UR.POSIK
  71FF*   7E             C      	LD	A,(HL)
  7200*   47             C      	LD	B,A
  7201*   04             C      	INC	B
  7202*                  C      KY.KOPV:
  7202*   CD 546D*       C      	CALL	U1.EIN
  7205*   CD 60E9*       C      	CALL	UR.POSIK
  7208*                  C      KY.KOP:
  7208*   CD 542B*       C      	CALL	U1.BREAD
  720B*   7E             C      	LD	A,(HL)
  720C*   FE 01          C      	CP	01H
  720E*   CC 5486*       C      	CALL	Z,U1.VSX
                         C      ;------------------------ANZEIGE WELCHE DATEI KOPIERT WIRD-------------
  7211*   E5             C      	PUSH	HL
  7212*   D5             C      	PUSH	DE
'Kopieren von MRES-Kassetten Teil 2'	MACRO-80 3.44	09-Dec-81	PAGE	1-79


  7213*   FD 7E 00       C      	LD	A,(IY+0)
  7216*   47             C      	LD	B,A
  7217*   05             C      	DEC	B
  7218*   21 ECA2        C      	LD	HL,BC.VTABE+32
  721B*   FE 01          C      	CP	01H
  721D*   28 03          C      	JR	Z,KY.KOPAN
  721F*   CD 72C8*       C      	CALL	KU.VVOR
  7222*                  C      KY.KOPAN:
  7222*   11 34F0        C      	LD	DE,SD.BWSA + 15*80 + 64	;34F0H
  7225*   01 0006        C      	LD	BC,6
  7228*   ED B0          C      	LDIR
  722A*   13             C      	INC	DE
  722B*   13             C      	INC	DE
  722C*   01 0002        C      	LD	BC,2
  722F*   ED B0          C      	LDIR
  7231*   FD 23          C      	INC	IY
  7233*   D1             C      	POP	DE
  7234*   E1             C      	POP	HL
                         C      ;--------------------------------------------------------------------
  7235*   1A             C      	LD	A,(DE)
  7236*   FE 01          C      	CP	01H
  7238*   CC 547F*       C      	CALL	Z,U1.VS1
  723B*   32 0E65        C      	LD	(UE.PUF),A
  723E*   CD 5436*       C      	CALL	U1.BWRIT
  7241*   CD 5445*       C      	CALL	U1.COPB
  7244*   23             C      	INC	HL
  7245*   7E             C      	LD	A,(HL)
  7246*   FE FF          C      	CP	0FFH
  7248*   28 0B          C      	JR	Z,KY.EOV
  724A*   2B             C      	DEC	HL
  724B*   96             C      	SUB	(HL)
  724C*   23             C      	INC	HL
  724D*   13             C      	INC	DE
  724E*   47             C      	LD	B,A
  724F*   FE 01          C      	CP	01H
  7251*   20 AF          C      	JR	NZ,KY.KOPV
  7253*   18 B3          C      	JR	KY.KOP
                         C      ;-------------------------------------------------------------
  7255*                  C      KY.EOV:
  7255*   CD 5486*       C      	CALL	U1.VSX
  7258*   3A E003        C      	LD	A,(BC.VTABA+1)
  725B*   47             C      	LD	B,A
  725C*   F1             C      	POP	AF
  725D*   F5             C      	PUSH	AF
  725E*   80             C      	ADD	A,B
  725F*   32 0E65        C      	LD	(UE.PUF),A
  7262*   CD 54FB*       C      	CALL	U1.KTIN1
  7265*   DD 36 0A 20    C      	LD	(IX+10),20H
  7269*   CD 5436*       C      	CALL	U1.BWRIT
  726C*   CD 60CE*       C      	CALL	UR.KSL
  726F*   CD 6FE8*       C      	CALL	KX.ENDR
  7272*   CD 60A4*       C      	CALL	UR.KRE
  7275*   CD 5496*       C      	CALL	U1.DSVG
  7278*   F1             C      	POP	AF
  7279*   F5             C      	PUSH	AF
  727A*   81             C      	ADD	A,C	;NEXT RECORD UND
  727B*   32 0E66        C      	LD	(UE.PUF+1),A
  727E*   F1             C      	POP	AF
  727F*   80             C      	ADD	A,B	;ANZAHL VERZ.EINTR. KORRIGIEREN
  7280*   32 0E68        C      	LD	(UE.PUF+3),A
  7283*   CD 60DA*       C      	CALL	UR.KBR
  7286*   DD 36 04 08    C      	LD	(IX+4),08H
  728A*   CD 5D34*       C      	CALL	UF.EXEC	;NEUEN DS-SATZ SCHREIBEN
  728D*   CD 60AC*       C      	CALL	UR.KRW
  7290*   CD 60B6*       C      	CALL	UR.KRA
  7293*   C9             C      	RET
                         C      ;---------------------------------------------------------------
  7294*                  C      KY.EWK:
  7294*   45 73 20 77    C      	DB	'Es wird kopiert:'
  7298*   69 72 64 20    C
  729C*   6B 6F 70 69    C
  72A0*   65 72 74 3A    C
                         C      ;---------------------------------------------------------------
  72A4*                  C      KY.JHL:
  72A4*   3A 2B28*       C      	LD	A,(UB.PAR2)
  72A7*   FE 4A          C      	CP	'J'
  72A9*   20 01          C      	JR	NZ,$+3
  72AB*   77             C      	LD	(HL),A
  72AC*   C9             C      	RET
                         C      ;--------------------------------------------------------------
  72AD*                  C      KY.SATR:
  72AD*   11 2B34*       C      	LD	DE,UB.SATZ
  72B0*   01 0036        C      	LD	BC,54
'Kopieren von MRES-Kassetten Teil 2'	MACRO-80 3.44	09-Dec-81	PAGE	1-80


  72B3*   ED B0          C      	LDIR
  72B5*   3A 3326        C      	LD	A,(UE.BWSA + 10*80 +6)	;326H
  72B8*   FE 4A          C      	CP	'J'
  72BA*   CC 72C1*       C      	CALL	Z,KY.AJ
  72BD*   32 2B28*       C      	LD	(UB.PAR2),A
  72C0*   C9             C      	RET
  72C1*                  C      KY.AJ:
  72C1*   F5             C      	PUSH	AF
  72C2*   AF             C      	XOR	A
  72C3*   32 2B34*       C      	LD	(UB.SATZ),A
  72C6*   F1             C      	POP	AF
  72C7*   C9             C      	RET
                         C      ;--------------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Unterprogramme fuer KOPI'
                         C      	PAGE
'Unterprogramme fuer KOPI'	MACRO-80 3.44	09-Dec-81	PAGE	1-81


                         C
                         C      ;	PN	KU
                         C      ;------------------------------------------------------------------
                         C      ;
                         C      ;          UNTERPROGRAMME FUER KOPI
                         C      ;
                         C      ;--------------------------------------------------------
  72C8*                  C      KU.VVOR:
  72C8*   C5             C      	PUSH	BC
  72C9*   01 0020        C      	LD	BC,32
  72CC*   09             C      	ADD	HL,BC
  72CD*   C1             C      	POP	BC
  72CE*   10 F8          C      	DJNZ	KU.VVOR
  72D0*   C9             C      	RET
  72D1*                  C      KU.TAB2L:
  72D1*   D1             C      	POP	DE
  72D2*   E1             C      	POP	HL
  72D3*   FD 7E 00       C      	LD	A,(IY+0)
  72D6*   FE FF          C      	CP	0FFH
  72D8*   28 22          C      	JR	Z,$+36
  72DA*   FD E5          C      	PUSH	IY
  72DC*   06 00          C      	LD	B,00H
  72DE*   FD 7E 00       C      	LD	A,(IY+0)
  72E1*   FE FF          C      	CP	0FFH
  72E3*   20 02          C      	JR	NZ,$+4
  72E5*   18 05          C      	JR	$+7
  72E7*   FD 23          C      	INC	IY
  72E9*   04             C      	INC	B
  72EA*   18 F2          C      	JR	$-12
  72EC*   FD E1          C      	POP	IY
  72EE*   FD E5          C      	PUSH	IY
  72F0*   FD 7E 01       C      	LD	A,(IY+1)
  72F3*   FD 77 00       C      	LD	(IY+0),A
  72F6*   FD 23          C      	INC	IY
  72F8*   10 F6          C      	DJNZ	$-8
  72FA*   FD E1          C      	POP	IY
  72FC*   C1             C      	POP	BC
  72FD*   05             C      	DEC	B
  72FE*   78             C      	LD	A,B
  72FF*   FE 00          C      	CP	00H
  7301*   28 03          C      	JR	Z,$+5
  7303*   C3 7072*       C      	JP	KY.DFR
  7306*   C3 70E3*       C      	JP	KY.ATAA
  7309*                  C      KU.ZEIR:
  7309*   D1             C      	POP	DE
  730A*   E1             C      	POP	HL
  730B*   3A 2B00*       C      	LD	A,(UB.ZN)
  730E*   D6 02          C      	SUB	2
  7310*   FE 0D          C      	CP	13
  7312*   30 04          C      	JR	NC,$+6
  7314*   C1             C      	POP	BC
  7315*   C3 7054*       C      	JP	KY.MD
  7318*   32 2B00*       C      	LD	(UB.ZN),A
  731B*   01 0029        C      	LD	BC,41
  731E*   B7             C      	OR	A
  731F*   ED 42          C      	SBC	HL,BC
  7321*   FD 2B          C      	DEC	IY
  7323*   7E             C      	LD	A,(HL)
  7324*   FD BE 00       C      	CP	(IY+0)
  7327*   CC 7336*       C      	CALL	Z,KU.DECIY
  732A*   FD 23          C      	INC	IY
  732C*   01 0017        C      	LD	BC,23
  732F*   B7             C      	OR	A
  7330*   ED 42          C      	SBC	HL,BC
  7332*   C1             C      	POP	BC
  7333*   04             C      	INC	B
  7334*   18 CA          C      	JR	$-52
  7336*                  C      KU.DECIY:
  7336*   FD 2B          C      	DEC	IY
  7338*   C9             C      	RET
  7339*                  C      KU.DD:
  7339*   E5             C      	PUSH	HL
  733A*   21 5F01*       C      	LD	HL,UA.VORH
  733D*   CD 595C*       C      	CALL	UR.MIMO
  7340*   38 17          C      	JR	C,$+25
  7342*   7E             C      	LD	A,(HL)
  7343*   FE 4A          C      	CP	'J'
  7345*   28 0C          C      	JR	Z,$+14
  7347*   FD 2B          C      	DEC	IY
  7349*   FD 36 00 FF    C      	LD	(IY+0),0FFH
  734D*   11 0050        C      	LD	DE,80
  7350*   B7             C      	OR	A
'Unterprogramme fuer KOPI'	MACRO-80 3.44	09-Dec-81	PAGE	1-82


  7351*   ED 52          C      	SBC	HL,DE
  7353*   36 20          C      	LD	(HL),20H
  7355*   21 2B00*       C      	LD	HL,UB.ZN
  7358*   35             C      	DEC	(HL)
  7359*   E1             C      	POP	HL
  735A*   C9             C      	RET
  735B*   E1             C      	POP	HL
  735C*   D1             C      	POP	DE
  735D*   DD 21 2B03*    C      	LD	IX,UB.KTAB
  7361*   C3 6FE8*       C      	JP	KX.ENDR
                         C      ;	END
                                ;
                         C      	INCLUDE KM.MAC
                         C      	TITLE	'Kmbg'
                         C      	PAGE
'Kmbg'	MACRO-80 3.44	09-Dec-81	PAGE	1-83


                         C
                         C      ;	PN	KM01
                         C      ;****************************************************************
                         C      ;*                  DEG2000   V.1.2   ---   Programm:   K m b g *
                         C      ;*  Version         --------------------------------------------*
                         C      ;*                  Programmierer: R. Sieber   A d W            *
                         C      ;*  V 1 . 2         --------------------------------------------*
                         C      ;*                  Stand        : 25.Februar 1985              *
                         C      ;****************************************************************
                         C
  0002                   C      SM.FNL      EQU   02
  0003                   C      SM.FDOWN    EQU   03
  0005                   C      SM.FLEFT    EQU   05
  0006                   C      SM.FPOS1    EQU   06
  0007                   C      SM.FRIGHT   EQU   07
  0008                   C      SM.FLTAB    EQU   08
  0009                   C      SM.FUP      EQU   09
  000A                   C      SM.FRTAB    EQU   10
  000C                   C      SM.FDEL     EQU   12
  001C                   C      SM.FABS     EQU   28
                         C
  7364*                  C      KM.ANF:
  7364*   7364*          C      	DW	$
  7366*   4B 6D 62 67    C      	DB	'Kmbg'
  736A*   21 7559*       C      	LD	HL,KM.DEL	;Taste:   D E L
  736D*   22 0CF8        C      	LD	(SM.FKTAB+(2*SM.FDEL)),HL
  7370*   21 7517*       C      	LD	HL,KM.ABS	;Taste:   A B S
  7373*   22 0D18        C      	LD	(SM.FKTAB+(2*SM.FABS)),HL
  7376*   21 73C2*       C      	LD	HL,KM.HOME	;Taste:   H O M E
  7379*   22 0CEC        C      	LD	(SM.FKTAB+(2*SM.FPOS1)),HL
  737C*   21 73CC*       C      	LD	HL,KM.SL	;Taste:   SCH_LINKS
  737F*   22 0CF0        C      	LD	(SM.FKTAB+(2*SM.FLTAB)),HL
  7382*   21 73D9*       C      	LD	HL,KM.SR	;Taste:   SCH_RECHTS
  7385*   22 0CF4        C      	LD	(SM.FKTAB+(2*SM.FRTAB)),HL
  7388*   21 73B6*       C      	LD	HL,KM.CO	;Taste:   C_HOCH
  738B*   22 0CF2        C      	LD	(SM.FKTAB+(2*SM.FUP)),HL
  738E*   21 73DE*       C      	LD	HL,KM.CR	;Taste:   C_RECHTS
  7391*   22 0CEE        C      	LD	(SM.FKTAB+(2*SM.FRIGHT)),HL
  7394*   21 73C7*       C      	LD	HL,KM.CU	;Taste:   C_RUNTER
  7397*   22 0CE6        C      	LD	(SM.FKTAB+(2*SM.FDOWN)),HL
  739A*   21 73D4*       C      	LD	HL,KM.CL	;Taste:   C_LINKS
  739D*   22 0CEA        C      	LD	(SM.FKTAB+(2*SM.FLEFT)),HL
  73A0*   21 73E3*       C      	LD	HL,KM.CNZA	;Taste:   C N Z A
  73A3*   22 0CE4        C      	LD	(SM.FKTAB+(2*SM.FNL)),HL
  73A6*   21 7413*       C      	LD	HL,KM.NEWL	;Taste:   E T 1
  73A9*   22 0DAE        C      	LD	(KM.TNEWL),HL
  73AC*   21 7438*       C      	LD	HL,KM.EINA	;alphanum. Tasten
  73AF*   22 0DB0        C      	LD	(KM.TEINA),HL
                         C
                         C      	; LD	HL,KM.UP13
                         C      	; LD	DE,KM.RAM
                         C      	; LD	BC,KM.UPEND-KM.UP13
                         C      	; LDIR
                         C
  73B2*   DD 21 2B03*    C      	LD	IX,KM.KMTAB
  73B6*                  C      KM.CO:
  73B6*   DD CB 00 7E    C      	BIT	7,(IX)
  73BA*   C2 7601*       C      	JP	NZ,KM.UP4-KM.UP13+KM.RAM
  73BD*   CD 7567*       C      	CALL	KM.UP2	;KMBG Reservieren EIN
  73C0*   31             C      	DB	31H
  73C1*   C9             C      	RET
                         C
                         C      	PAGE
'Kmbg'	MACRO-80 3.44	09-Dec-81	PAGE	1-84


                         C
                         C      ;****************************************************************
                         C      ;*                  Auswertung der Cursor-Tasten                *
                         C      ;****************************************************************
  73C2*                  C      KM.HOME:
  73C2*   CD 7564*       C      	CALL	KM.UP1	;KMBG Kassette zurueckspulen
  73C5*   21             C      	DB	21H
  73C6*   C9             C      	RET
                         C
  73C7*                  C      KM.CU:
  73C7*   CD 7567*       C      	CALL	KM.UP2	;KMBG Reservieren AUS
  73CA*   41             C      	DB	41H
  73CB*   C9             C      	RET
                         C
  73CC*                  C      KM.SL:
  73CC*   CD 7567*       C      	CALL	KM.UP2	;KMBG vorh.  Datensatz anzeigen
  73CF*   15             C      	DB	15H
  73D0*   CD 7564*       C      	CALL	KM.UP1
  73D3*   02             C      	DB	2
  73D4*                  C      KM.CL:
  73D4*   CD 7567*       C      	CALL	KM.UP2	;KMBG einen  Datensatz zuruecksetzen
  73D7*   15             C      	DB	15H
  73D8*   C9             C      	RET
                         C
  73D9*                  C      KM.SR:
  73D9*   CD 7564*       C      	CALL	KM.UP1	;KMBG nachf. Datensatz anzeigen
  73DC*   02             C      	DB	2
  73DD*   C9             C      	RET
                         C
  73DE*                  C      KM.CR:
  73DE*   CD 7567*       C      	CALL	KM.UP2	;KMBG einen  Datensatz vorsetzen
  73E1*   11             C      	DB	11H
  73E2*   C9             C      	RET
                         C
  73E3*                  C      KM.CNZA:
  73E3*   DD CB 00 7E    C      	BIT	7,(IX)
  73E7*   C0             C      	RET	NZ
  73E8*   3A 7613*       C      	LD	A,(KM.TX2-KM.UP13+KM.RAM)
  73EB*   FE 6C          C      	CP	'l'
  73ED*   28 08          C      	JR	Z,KM.CNZA1
  73EF*   DD 36 09 00    C      	LD	(IX+9),0
  73F3*   DD 36 0A 01    C      	LD	(IX+10),1
  73F7*                  C      KM.CNZA1:
  73F7*   3E 71          C      	LD	A,71H
  73F9*   DD B6 04       C      	OR	(IX+4)
  73FC*   DD 77 04       C      	LD	(IX+4),A
  73FF*   CD 7578*       C      	CALL	KM.UP5
  7402*   DD 7E 04       C      	LD	A,(IX+4)
  7405*   CD 7564*       C      	CALL	KM.UP1
  7408*   02             C      	DB	2
  7409*   CD 7567*       C      	CALL	KM.UP2
  740C*   15             C      	DB	15H
  740D*   DD 77 04       C      	LD	(IX+4),A
  7410*   C3 7601*       C      	JP	KM.UP4-KM.UP13+KM.RAM
                         C      ;****************************************************************
                         C      ;*                  Routine fuer die Taste   E T 1              *
                         C      ;****************************************************************
  7413*                  C      KM.NEWL:
  7413*   DD CB 00 7E    C      	BIT	7,(IX)
  7417*   C0             C      	RET	NZ
  7418*   21 0E66        C      	LD	HL,KM.PUFF
  741B*   22 2BE2*       C      	LD	(KM.KMTAB+0DFH),HL	;2BE0
  741E*   DD 7E 0A       C      	LD	A,(IX+10)
  7421*   3D             C      	DEC	A
  7422*   E6 F0          C      	AND	0F0H
  7424*   07             C      	RLCA
  7425*   07             C      	RLCA
  7426*   07             C      	RLCA
  7427*   07             C      	RLCA
  7428*   3C             C      	INC	A
  7429*   32 2BED*       C      	LD	(KM.KMTAB+0EAH),A	;2BEB
  742C*   CD 2060        C      	CALL	KM.MHOME
  742F*   CD 23BA        C      	CALL	KM.MINSL
  7432*   CD 225C        C      	CALL	ATACO
  7435*   C3 7601*       C      	JP	KM.UP4-KM.UP13+KM.RAM
                         C
                         C      	PAGE
'Kmbg'	MACRO-80 3.44	09-Dec-81	PAGE	1-85


                         C
                         C      ;****************************************************************
                         C      ;*                  Auswertung der alphanumerischen Tasten      *
                         C      ;****************************************************************
  7438*                  C      KM.EINA:
  7438*   79             C      	LD	A,C
  7439*   21 0000        C      	LD	HL,0
  743C*   FE 72          C      	CP	'r'
  743E*   20 03          C      	JR	NZ,KM.EINA1
  7440*   21 74A2*       C      	LD	HL,KM.EINAB
  7443*                  C      KM.EINA1:
  7443*   FE 7A          C      	CP	'z'
  7445*   20 03          C      	JR	NZ,KM.EINA2
  7447*   21 74AD*       C      	LD	HL,KM.EINAC
  744A*                  C      KM.EINA2:
  744A*   FE 70          C      	CP	'p'
  744C*   20 03          C      	JR	NZ,KM.EINA3
  744E*   21 0000        C      	LD	HL,0
  7451*                  C      KM.EINA3:
  7451*   FE 63          C      	CP	'c'
  7453*   20 03          C      	JR	NZ,KM.EINA4
  7455*   21 0000        C      	LD	HL,0
  7458*                  C      KM.EINA4:
  7458*   22 0DA8        C      	LD	(KM.TTABU),HL
  745B*   FE 30          C      	CP	'0'
  745D*   38 04          C      	JR	C,KM.EINA5
  745F*   FE 47          C      	CP	'G'
  7461*   38 06          C      	JR	C,KM.EINA7
  7463*                  C      KM.EINA5:
  7463*   32 7613*       C      	LD	(KM.TX2-KM.UP13+KM.RAM),A
  7466*                  C      KM.EINA6:
  7466*   C3 7601*       C      	JP	KM.UP4-KM.UP13+KM.RAM
                         C
  7469*                  C      KM.EINA7:
  7469*   3A 7613*       C      	LD	A,(KM.TX2-KM.UP13+KM.RAM)
  746C*   FE 67          C      	CP	'g'
  746E*   20 10          C      	JR	NZ,KM.EINA8
  7470*   79             C      	LD	A,C
  7471*   D6 30          C      	SUB	30H
  7473*   D8             C      	RET	C
  7474*   C8             C      	RET	Z
  7475*   FE 03          C      	CP	3
  7477*   D0             C      	RET	NC
  7478*   DD 77 03       C      	LD	(IX+3),A
  747B*   CD 74D8*       C      	CALL	KM.UP20
  747E*   18 E6          C      	JR	KM.EINA6
                         C
  7480*                  C      KM.EINA8:
  7480*   FE 6C          C      	CP	'l'
  7482*   20 1D          C      	JR	NZ,KM.EINAA
  7484*   79             C      	LD	A,C
  7485*   D6 30          C      	SUB	30H
  7487*   FE 0A          C      	CP	00AH
  7489*   38 02          C      	JR	C,KM.EINA9
  748B*   D6 07          C      	SUB	7
  748D*                  C      KM.EINA9:
  748D*   5F             C      	LD	E,A
  748E*   16 00          C      	LD	D,0
  7490*   62             C      	LD	H,D
  7491*   DD 6E 0A       C      	LD	L,(IX+10)
  7494*   29             C      	ADD	HL,HL
  7495*   29             C      	ADD	HL,HL
  7496*   29             C      	ADD	HL,HL
  7497*   29             C      	ADD	HL,HL
  7498*   19             C      	ADD	HL,DE
  7499*   DD 74 09       C      	LD	(IX+9),H
  749C*   DD 75 0A       C      	LD	(IX+10),L
  749F*   18 C5          C      	JR	KM.EINA6
                         C
  74A1*                  C      KM.EINAA:
  74A1*   C9             C      	RET
                         C
  74A2*                  C      KM.EINAB:
  74A2*   CD 7567*       C      	CALL	KM.UP2
  74A5*   08             C      	DB	8
  74A6*   21 0000        C      	LD	HL,0
  74A9*   22 0DAA        C      	LD	(SM.TABU),HL	;00DA8H
  74AC*   C9             C      	RET
                         C
  74AD*                  C      KM.EINAC:
  74AD*   DD 36 0D 00    C      	LD	(IX+13),0
  74B1*   DD 36 0E 00    C      	LD	(IX+14),0
'Kmbg'	MACRO-80 3.44	09-Dec-81	PAGE	1-86


  74B5*                  C      KM.EINAD:
  74B5*   CD 7564*       C      	CALL	KM.UP1
  74B8*   02             C      	DB	2
  74B9*   DD 7E 09       C      	LD	A,(IX+9)
  74BC*   DD B6 0A       C      	OR	(IX+10)
  74BF*   28 08          C      	JR	Z,KM.EINAE
  74C1*   DD 34 0D       C      	INC	(IX+13)
  74C4*   CD 74C9*       C      	CALL	KM.EINAE
  74C7*   18 EC          C      	JR	KM.EINAD
                         C
  74C9*                  C      KM.EINAE:
  74C9*   CD 7601*       C      	CALL	KM.UP4-KM.UP13+KM.RAM
  74CC*   11 35E0        C      	LD	DE,SD.BWSA + 18*80 + 64	;5E0H
  74CF*   CD 759C*       C      	CALL	KM.UP10
  74D2*   62 7A 3A       C      	DB	'bz:'
  74D5*   0D             C      	DB	00DH
  74D6*   A0             C      	DB	20H+80H
  74D7*   C9             C      	RET
                         C
  74D8*                  C      KM.UP20:
  74D8*   DD 4E 02       C      	LD	C,(IX+2)
  74DB*   0C             C      	INC	C	;???
  74DC*   0C             C      	INC	C
  74DD*   0C             C      	INC	C
  74DE*   0C             C      	INC	C
  74DF*   ED 40          C      	IN	B,(C)
  74E1*   FE 01          C      	CP	1
  74E3*   20 04          C      	JR	NZ,KM.UP21
  74E5*   CB 48          C      	BIT	1,B
  74E7*   20 29          C      	JR	NZ,KM.UP25
  74E9*                  C      KM.UP21:
  74E9*   CB D8          C      	SET	3,B
  74EB*   18 06          C      	JR	KM.UP22
  74ED*   CB 40          C      	BIT	0,B
  74EF*   20 21          C      	JR	NZ,KM.UP25
  74F1*   CB D0          C      	SET	2,B
  74F3*                  C      KM.UP22:
  74F3*   ED 41          C      	OUT	(C),B
  74F5*   0C             C      	INC	C
  74F6*   ED 50          C      	IN	D,(C)
  74F8*   0D             C      	DEC	C
  74F9*   CB 90          C      	RES	2,B
  74FB*   CB 98          C      	RES	3,B
  74FD*   ED 41          C      	OUT	(C),B
  74FF*   FE 01          C      	CP	1
  7501*   20 04          C      	JR	NZ,KM.UP23
  7503*   CB 62          C      	BIT	4,D
  7505*   18 02          C      	JR	KM.UP24
                         C
  7507*                  C      KM.UP23:
  7507*   CB 5A          C      	BIT	3,D
  7509*                  C      KM.UP24:
  7509*   28 07          C      	JR	Z,KM.UP25
  750B*   DD 36 00 00    C      	LD	(IX+0),0
  750F*   C3 73B6*       C      	JP	KM.CO
                         C
  7512*                  C      KM.UP25:
  7512*   DD CB 00 FE    C      	SET	7,(IX+0)
  7516*   C9             C      	RET
                         C
                         C      	PAGE
'Kmbg'	MACRO-80 3.44	09-Dec-81	PAGE	1-87


                         C
  7517*                  C      KM.ABS:
  7517*   21 3000        C      	LD	HL,SD.BWSA
  751A*   06 11          C      	LD	B,17
  751C*                  C      KM.ABS1:
  751C*   C5             C      	PUSH	BC
  751D*   CD 7526*       C      	CALL	KM.UP30
  7520*   C1             C      	POP	BC
  7521*   10 F9          C      	DJNZ	KM.ABS1
  7523*   C3 7539*       C      	JP	KM.UP36
                         C
  7526*                  C      KM.UP30:
  7526*   CD 7545*       C      	CALL	KM.UP34
  7529*   A0             C      	DB	0A0H
  752A*   28 15          C      	JR	Z,KM.UP33
  752C*   CD 7545*       C      	CALL	KM.UP34
  752F*   50             C      	DB	050H
  7530*   28 0C          C      	JR	Z,KM.UP32
  7532*                  C      KM.UP31:
  7532*   7E             C      	LD	A,(HL)
  7533*   23             C      	INC	HL
  7534*   CD 4040        C      	CALL	PRINT
  7537*   10 F9          C      	DJNZ	KM.UP31
  7539*                  C      KM.UP36:
  7539*   3E 1E          C      	LD	A,1EH
  753B*   C3 4040        C      	JP	PRINT
                         C
  753E*                  C      KM.UP32:
  753E*   CD 7539*       C      	CALL	KM.UP36
  7541*                  C      KM.UP33:
  7541*   23             C      	INC	HL
  7542*   10 FD          C      	DJNZ	KM.UP33
  7544*   C9             C      	RET
                         C
  7545*                  C      KM.UP34:
  7545*   E3             C      	EX	(SP),HL
  7546*   46             C      	LD	B,(HL)
  7547*   23             C      	INC	HL
  7548*   E3             C      	EX	(SP),HL
  7549*   E5             C      	PUSH	HL
  754A*   CD 7551*       C      	CALL	KM.UP35
  754D*   E1             C      	POP	HL
  754E*   06 50          C      	LD	B,80
  7550*   C9             C      	RET
                         C
  7551*                  C      KM.UP35:
  7551*   3E 20          C      	LD	A,' '
  7553*   BE             C      	CP	(HL)
  7554*   23             C      	INC	HL
  7555*   C0             C      	RET	NZ
  7556*   10 F9          C      	DJNZ	KM.UP35
  7558*   C9             C      	RET
                         C
  7559*                  C      KM.DEL:
  7559*   DD CB 00 BE    C      	RES	7,(IX+0)
  755D*   DD 36 01 00    C      	LD	(IX+1),0
  7561*   C3 7601*       C      	JP	KM.UP4-KM.UP13+KM.RAM
                         C
                         C      	PAGE
'Kmbg'	MACRO-80 3.44	09-Dec-81	PAGE	1-88


                         C
                         C      ;****************************************************************
                         C      ;*                  Unterprogramme                              *
                         C      ;****************************************************************
  7564*                  C      KM.UP1:
  7564*   CD 7584*       C      	CALL	KM.LOE1
  7567*                  C      KM.UP2:
  7567*   DD CB 00 7E    C      	BIT	7,(IX)
  756B*   28 02          C      	JR	Z,KM.UP3
  756D*   E1             C      	POP	HL
  756E*   C0             C      	RET	NZ
  756F*                  C      KM.UP3:
  756F*   E3             C      	EX	(SP),HL
  7570*   F5             C      	PUSH	AF
  7571*   7E             C      	LD	A,(HL)
  7572*   23             C      	INC	HL
  7573*   DD 77 04       C      	LD	(IX+4),A
  7576*   F1             C      	POP	AF
  7577*   E3             C      	EX	(SP),HL
  7578*                  C      KM.UP5:
  7578*   CD 5CA1*       C      	CALL	KM.KARO
  757B*   21 6816*       C      	LD	HL,FD.DASU	;05C01H
  757E*   22 0D6E        C      	LD	(SM.FKTAB+8EH),HL	;SM.ZSMER , SM.ZSTC
  7581*   C3 7601*       C      	JP	KM.UP4-KM.UP13+KM.RAM
                         C
  7584*                  C      KM.LOE1:
  7584*   21 0E65        C      	LD	HL,KM.PUFF-1
  7587*   36 00          C      	LD	(HL),0
  7589*   01 0103        C      	LD	BC,103H
  758C*   18 08          C      	JR	KM.LOE3
  758E*                  C      KM.LOE2:
  758E*   21 3000        C      	LD	HL,SD.BWSA
  7591*   01 077F        C      	LD	BC,24*80 -1 ;007FFH  (25*80-1 = 07CFH; 07FFH-07CFH=30H=48)
  7594*   36 20          C      	LD	(HL),' '
  7596*                  C      KM.LOE3:
  7596*   E5             C      	PUSH	HL
  7597*   D1             C      	POP	DE
  7598*   13             C      	INC	DE
  7599*   ED B0          C      	LDIR
  759B*   C9             C      	RET
                         C
  759C*                  C      KM.UP10:
  759C*   E3             C      	EX	(SP),HL
  759D*                  C      KM.UP11:
  759D*   7E             C      	LD	A,(HL)
  759E*   E6 7F          C      	AND	07FH
  75A0*   FE 20          C      	CP	' '
  75A2*   38 02          C      	JR	C,KM.UP12
  75A4*   12             C      	LD	(DE),A
  75A5*   13             C      	INC	DE
  75A6*                  C      KM.UP12:
  75A6*   DC 75E5*       C      	CALL	C,KM.UP13-KM.UP13+KM.RAM
  75A9*   CB 7E          C      	BIT	7,(HL)
  75AB*   23             C      	INC	HL
  75AC*   28 EF          C      	JR	Z,KM.UP11
  75AE*   E3             C      	EX	(SP),HL
  75AF*   C9             C      	RET
                         C
  75B0*                  C      KM.UP41:
  75B0*   11 3000        C      	LD	DE,SD.BWSA
  75B3*   DD 7E 0A       C      	LD	A,(IX+10)
  75B6*   B7             C      	OR	A
  75B7*   20 0C          C      	JR	NZ,KM.UP42
  75B9*   DD CB 09 46    C      	BIT	0,(IX+9)
  75BD*   C8             C      	RET	Z
  75BE*   F5             C      	PUSH	AF
  75BF*   CD 201D        C      	CALL	KM.MANZ
  75C2*   F1             C      	POP	AF
  75C3*   D6 10          C      	SUB	10H
  75C5*                  C      KM.UP42:
  75C5*   F5             C      	PUSH	AF
  75C6*   CD 201D        C      	CALL	KM.MANZ
  75C9*   F1             C      	POP	AF
  75CA*   D6 10          C      	SUB	10H
  75CC*   C8             C      	RET	Z
  75CD*   D8             C      	RET	C
  75CE*   18 F5          C      	JR	KM.UP42
                         C
  75D0*                  C      KM.UP43:
  75D0*   FE 1E          C      	CP	01EH
  75D2*   C8             C      	RET	Z
  75D3*   FE 0A          C      	CP	00AH
'Kmbg'	MACRO-80 3.44	09-Dec-81	PAGE	1-89


  75D5*   C8             C      	RET	Z
  75D6*   FE 0D          C      	CP	00DH
  75D8*   C8             C      	RET	Z
  75D9*   B7             C      	OR	A
  75DA*   C8             C      	RET	Z
  75DB*   FE 20          C      	CP	' '
  75DD*   38 03          C      	JR	C,KM.UP44
  75DF*   FE 80          C      	CP	080H
  75E1*   D8             C      	RET	C
  75E2*                  C      KM.UP44:
  75E2*   3E 7F          C      	LD	A,07FH
  75E4*   C9             C      	RET
                         C
                         C      	PAGE
'Kmbg'	MACRO-80 3.44	09-Dec-81	PAGE	1-90


                         C
                         C      ;	ORG	00300H
                         C
  75E5*                  C      KM.UP13:
  75E5*   32 75EA*       C      	LD	(KM.UP15-KM.UP13+KM.RAM-1),A	;???
  75E8*   DD 7E 01       C      	LD	A,(IX+1)	;<<<
  75EB*                  C      KM.UP15:
  75EB*   EB             C      	EX	DE,HL
  75EC*   77             C      	LD	(HL),A
  75ED*   3E 33          C      	LD	A,33H
  75EF*   ED 67          C      	RRD
  75F1*   EB             C      	EX	DE,HL
  75F2*   F5             C      	PUSH	AF
  75F3*   1A             C      	LD	A,(DE)
  75F4*   CD 75F8*       C      	CALL	KM.UP14-KM.UP13+KM.RAM
  75F7*   F1             C      	POP	AF
  75F8*                  C      KM.UP14:
  75F8*   FE 3A          C      	CP	03AH
  75FA*   38 02          C      	JR	C,$+4	;---!
  75FC*   C6 07          C      	ADD	A,7	;   !
  75FE*   12             C      	LD	(DE),A	;<--!
  75FF*   13             C      	INC	DE
  7600*   C9             C      	RET
                         C
  7601*                  C      KM.UP4:
  7601*   F5             C      	PUSH	AF
  7602*   CD 758E*       C      	CALL	KM.LOE2
  7605*   DD 7E 03       C      	LD	A,(IX+3)
  7608*   C6 30          C      	ADD	A,30H
  760A*   32 7617*       C      	LD	(KM.TX1-KM.UP13+KM.RAM),A
  760D*   11 35A0        C      	LD	DE,SD.BWSA + 18*80 ;5A0H
  7610*   CD 759C*       C      	CALL	KM.UP10
  7613*                  C      KM.TX2:
  7613*   67 20          C      	DB	'g '
  7615*   04             C      	DB	004H
  7616*   28             C      	DB	'('	;<<<
  7617*                  C      KM.TX1:
  7617*   32 29          C      	DB	'2)'	;<<<
  7619*   BA             C      	DB	3AH+80H	;":"
  761A*   11 35AE        C      	LD	DE,SD.BWSA + 18*80 + 14 ;5AEH	;18*80 +20	;5B4H
  761D*   CD 759C*       C      	CALL	KM.UP10
  7620*   6C 3A          C      	DB	'l:'
  7622*   09             C      	DB	9
  7623*   0A             C      	DB	10
  7624*   20 73 3A       C      	DB	' s:'
  7627*   00             C      	DB	0
  7628*   2F             C      	DB	'/'
  7629*   01             C      	DB	1
  762A*   20 20 20 20    C      	DB	'      '
  762E*   20 20          C
  7630*   AD             C      	DB	2DH+80H	;"-"
  7631*   1B             C      	DEC	DE
  7632*   1B             C      	DEC	DE
  7633*   1B             C      	DEC	DE
  7634*   21 0E65        C      	LD	HL,KM.PUFF-1
  7637*   7E             C      	LD	A,(HL)
  7638*   23             C      	INC	HL
  7639*   CD 75EB*       C      	CALL	KM.UP15-KM.UP13+KM.RAM
  763C*   13             C      	INC	DE
  763D*   DD 46 0A       C      	LD	B,(IX+10)
  7640*   E5             C      	PUSH	HL
  7641*   23             C      	INC	HL
  7642*   10 FD          C      	DJNZ	$-1
  7644*   7E             C      	LD	A,(HL)
  7645*   CD 75EB*       C      	CALL	KM.UP15-KM.UP13+KM.RAM
  7648*   23             C      	INC	HL
  7649*   7E             C      	LD	A,(HL)
  764A*   CD 75EB*       C      	CALL	KM.UP15-KM.UP13+KM.RAM
  764D*   E1             C      	POP	HL
  764E*   E5             C      	PUSH	HL
  764F*   11 3640        C      	LD	DE,SD.BWSA + 20*80	;640H
  7652*   06 00          C      	LD	B,0
  7654*   7E             C      	LD	A,(HL)
  7655*   CD 75D0*       C      	CALL	KM.UP43
  7658*   12             C      	LD	(DE),A
  7659*   23             C      	INC	HL
  765A*   13             C      	INC	DE
  765B*   10 F7          C      	DJNZ	$-7
  765D*   E1             C      	POP	HL
  765E*                  C      KM.UP40:
  765E*   CD 75B0*       C      	CALL	KM.UP41
  7661*   F1             C      	POP	AF
'Kmbg'	MACRO-80 3.44	09-Dec-81	PAGE	1-91


  7662*   C9             C      	RET
                         C
  7663*                  C      KM.UPEND	EQU	$
                         C
                         C      ;SM.FKTAB	EQU	00D00H
  0DA8                   C      KM.TTABU  EQU	00DA8H
  0DAE                   C      KM.TNEWL  EQU	00DAEH
  0DB0                   C      KM.TEINA  EQU	00DB0H
  0E66                   C      KM.PUFF   EQU	00E66H
                         C
  201D                   C      KM.MANZ   EQU	0201DH
  2060                   C      KM.MHOME  EQU	02060H
  23BA                   C      KM.MINSL  EQU	023BAH
                         C      ;ATACO    EQU	024F8H
                         C
  2B03*                  C      KM.KMTAB  EQU	UB.KTAB
                         C      ;         DEFS  17,0
                         C      ;SD.BWSA  EQU	03000H
                         C
  5CA1*                  C      KM.KARO   EQU	KR.KARO   ;05A93H
                         C
                         C      ;DRUZ     EQU	07C00H
                         C
  75E5*                  C      KM.RAM    EQU	KM.UP13   ;0FF80H
                         C
                         C      			;(C) Rainer Sieber     A d W
                         C
                         C
                         C      ;	END
                                ;
                                	TITLE 'Symbolliste S1b'
                                	END
'Symbolliste S1b'	MACRO-80 3.44	09-Dec-81	PAGE	S


Macros:

Symbols:
0030 	AKB             225C 	ATACO           0001 	BC.AGG
0000 	BC.EGG          FA3A 	BC.END          E000 	BC.TAB1
F902 	BC.TAB2         F96A 	BC.TAB2A        F9D2 	BC.TAB3
E002 	BC.VTABA        EC82 	BC.VTABE        58B2*	CP.COMPR
5915*	CP.INIT         58E5*	CP.KOM          58B7*	CP.NL
58E5*	CP.OUT          58C5*	CP.OUTT         58EC*	CP.SOKOM
5902*	CP.SOSTR        58CA*	CP.SPACE        58C1*	CP.STRNG
5907*	CP.TAB          58D5*	CP.TEXT         5BC3*	CRC0
5BC7*	CRC1            5BDA*	CRC2            591B*	DC.DCMPR
5951*	DC.EOSPC        5956*	DC.INIT         591D*	DC.NL
5941*	DC.SPACE        5937*	DC.TAB          5929*	DC.TEXT
6AEC*	FD.BMGF         6816*	FD.DASU         6950*	FD.DECBZ
6A07*	FD.DECHL        6AC7*	FD.DSPBB        6AD7*	FD.DSPBG
6A7C*	FD.END          6AA5*	FD.FDIN2        6863*	FD.FDINP
68B6*	FD.FDOUT        691A*	FD.FDOW1        691E*	FD.FDOW2
6943*	FD.FDOW3        6935*	FD.FDOW4        690A*	FD.FDOWR
695A*	FD.FDUP         6A83*	FD.FOLWR        6A10*	FD.FOUT1
699C*	FD.FSTRT        680F*	FD.KO01         67F7*	FD.POSK
6AE1*	FD.RDEND        68AA*	FD.SDIN         698C*	FD.SDK0
6996*	FD.SDK1         6982*	FD.SDK2         6904*	FD.SDOUT
6972*	FD.SDOW         69E9*	FD.SETJ         6A01*	FD.SETN
69D4*	FD.STRT1        6832*	FD.WRRES        2B01*	K0.HSB
2B02*	K0.LPD          5AB0*	K1.BRKMB        5BC0*	K1.CRC
5AF1*	K1.KERN         6743*	KH.ANZB1        674E*	KH.ANZB2
6756*	KH.ANZB3        6758*	KH.ANZB4        6740*	KH.ANZBL
6778*	KH.AZ1Z         67A9*	KH.AZ4B0        67CA*	KH.AZ4B1
67B9*	KH.AZ4B3        67A5*	KH.AZ4BY        679C*	KH.AZADR
675F*	KH.AZBL1        675C*	KH.AZBLD        67E9*	KH.BILO
67E3*	KH.BLEV1        67E5*	KH.BLEV2        67CE*	KH.BLEVG
66F2*	KH.BMM          66EA*	KH.BMP          66C4*	KH.KSRA
667E*	KH.KSRE         66D0*	KH.KSRM         66D3*	KH.KSRP
6681*	KH.KSRW         6681*	KH.RD1          676F*	KH.RD2
668B*	KH.RD3          670D*	KH.RDBA         671E*	KH.RDBM
672F*	KH.RDSL         6673*	KH.RDSTA        667E*	KH.RES
6707*	KH.SYSRT        6703*	KH.WBM          66F7*	KH.WREC
6705*	KH.WSL          6313*	KI.KM           62D4*	KI.KN
637A*	KI.KO03         62F7*	KI.NMR          6385*	KI.RENA
63A2*	KI.RENA9        635C*	KI.VERZ         7517*	KM.ABS
751C*	KM.ABS1         7364*	KM.ANF          73D4*	KM.CL
73E3*	KM.CNZA         73F7*	KM.CNZA1        73B6*	KM.CO
73DE*	KM.CR           73C7*	KM.CU           7559*	KM.DEL
7438*	KM.EINA         7443*	KM.EINA1        744A*	KM.EINA2
7451*	KM.EINA3        7458*	KM.EINA4        7463*	KM.EINA5
7466*	KM.EINA6        7469*	KM.EINA7        7480*	KM.EINA8
748D*	KM.EINA9        74A1*	KM.EINAA        74A2*	KM.EINAB
74AD*	KM.EINAC        74B5*	KM.EINAD        74C9*	KM.EINAE
73C2*	KM.HOME         5CA1*	KM.KARO         2B03*	KM.KMTAB
7584*	KM.LOE1         758E*	KM.LOE2         7596*	KM.LOE3
201D 	KM.MANZ         2060 	KM.MHOME        23BA 	KM.MINSL
7413*	KM.NEWL         0E66 	KM.PUFF         75E5*	KM.RAM
73CC*	KM.SL           73D9*	KM.SR           0DB0 	KM.TEINA
0DAE 	KM.TNEWL        0DA8 	KM.TTABU        7617*	KM.TX1
7613*	KM.TX2          7564*	KM.UP1          759C*	KM.UP10
759D*	KM.UP11         75A6*	KM.UP12         75E5*	KM.UP13
75F8*	KM.UP14         75EB*	KM.UP15         7567*	KM.UP2
74D8*	KM.UP20         74E9*	KM.UP21         74F3*	KM.UP22
7507*	KM.UP23         7509*	KM.UP24         7512*	KM.UP25
756F*	KM.UP3          7526*	KM.UP30         7532*	KM.UP31
753E*	KM.UP32         7541*	KM.UP33         7545*	KM.UP34
7551*	KM.UP35         7539*	KM.UP36         7601*	KM.UP4
765E*	KM.UP40         75B0*	KM.UP41         75C5*	KM.UP42
75D0*	KM.UP43         75E2*	KM.UP44         7578*	KM.UP5
7663*	KM.UPEND        5DED*	KO.KO04         5BB6*	KOMED
5C9D*	KR.CKRA         5BEC*	KR.GR1          5BF6*	KR.GR2
5BF8*	KR.GR3          5CA1*	KR.KARO         5D1A*	KR.KCL
5D29*	KR.TYPT         5CA5*	KR.VORSP        5CED*	KR.YKA1
5D02*	KR.YKA2         7339*	KU.DD           7336*	KU.DECIY
72D1*	KU.TAB2L        72C8*	KU.VVOR         7309*	KU.ZEIR
641B*	KV.ANF          663E*	KV.ANZ          64EB*	KV.AUSG
6654*	KV.AVZS         65C6*	KV.BSTR         6629*	KV.DBCVM
65AE*	KV.DRU          65AC*	KV.DRU1         65BB*	KV.KO02
6560*	KV.KRW          6594*	KV.P1           6634*	KV.SBC
65F3*	KV.SPTR         6484*	KV.TABTR        64CA*	KV.ZEIHO
644F*	KV.ZLTR         6FE8*	KX.ENDR         7007*	KX.EXEC2
6FDD*	KX.RSPFR        7037*	KX.UPA          72C1*	KY.AJ
70E3*	KY.ATAA         7106*	KY.ATAB         7117*	KY.ATABE
71A8*	KY.COPY         7072*	KY.DFR          7255*	KY.EOV
7164*	KY.EVZ          7167*	KY.EVZ1         7294*	KY.EWK
70E0*	KY.EZYK1        72A4*	KY.JHL          7208*	KY.KOP
'Symbolliste S1b'	MACRO-80 3.44	09-Dec-81	PAGE	S-1


7222*	KY.KOPAN        7202*	KY.KOPV         7054*	KY.MD
70DA*	KY.NDA          714B*	KY.NE           72AD*	KY.SATR
70CC*	KY.SVGL         71CC*	KY.VSCHR        717F*	KY.VSTR
70C1*	KY.VZVGL        7125*	KY.WEI          7139*	KY.ZYK
6B34*	LD.DATFU        6B0F*	LD.DATN         6B55*	LD.DATPO
6BD0*	LD.LAD1         6BBF*	LD.LAD2         6BBC*	LD.LADER
6BE5*	LD.LADF         6B24*	LD.LD2          6B2E*	LD.LD21
6BB7*	LD.LD3          6B75*	LD.LD4          6B90*	LD.LD5
6BDC*	LD.LDEND        6BAD*	LD.START        0080 	MAXBL
60EF*	POSIK1          4040 	PRINT           4070 	PUF.KASS
6BEB*	RL.BEG          6CF7*	RL.BF           6CE3*	RL.DATNV
6CDE*	RL.ECHO         6CF9*	RL.FMELD        6C7C*	RL.M10
6C8D*	RL.M11          6C1C*	RL.M12          6C5A*	RL.M13
6C6A*	RL.M14          6C72*	RL.M15          6C0B*	RL.M16
6C39*	RL.M17          6CA0*	RL.M21          6CF3*	RL.MN
6CE7*	RL.OB           6CEB*	RL.RA           6CEF*	RL.SV
6C00*	RL.UG           6C93*	RL.UP6          5BAE*	RLAD
5BA9*	RRET            3000 	SD.BWSA         8010 	SD.PFFI
8830 	SD.TPA          0DC6 	SM.END          001C 	SM.FABS
000C 	SM.FDEL         0003 	SM.FDOWN        0CE0 	SM.FKTAB
0005 	SM.FLEFT        0008 	SM.FLTAB        0002 	SM.FNL
0006 	SM.FPOS1        0007 	SM.FRIGHT       000A 	SM.FRTAB
0009 	SM.FUP          0E65 	SM.PUFFS        0CE0 	SM.STACK
0DAA 	SM.TABU         0E5A 	SM.ZEIN         5BA5*	STF07
5B9B*	STF99           5BA2*	STFRS           5B48*	STT02
5B66*	STT08           5B22*	STT11           5B22*	STT15
5B22*	STT21           5B22*	STT31           5B22*	STT41
5B39*	STT5            5B2E*	STT51           5B32*	STT61
5B36*	STT71           5B36*	STT75           6E07*	SV.BYANZ
6E98*	SV.DALO1        6D35*	SV.DATN         6E12*	SV.DATS1
6D4C*	SV.DATV1        6D54*	SV.DATVO        6E2C*	SV.SAVE
6E3D*	SV.SAVE1        6D8E*	SV.SAVE3        6DA3*	SV.SAVE4
6DEB*	SV.SAVE5        6DE1*	SV.SAVE6        6E90*	SV.STAD0
6D28*	SV.SV20         6D40*	SV.SV21         6D5A*	SV.SV30
6D74*	SV.SV31         6D62*	SV.SV37         6E80*	SV.SVEN1
6E7D*	SV.SVEN2        6E54*	SV.SVLS         6E70*	SV.SVLS1
6E5A*	SV.SVLS2        6EA3*	SV.SVSZ         6EB7*	SV.SVSZ1
6EA5*	SV.SVSZ2        4036 	SY.RESC         4033 	SY.SETCHL
000B 	SY.SYSTB        4026 	TA.ABFR1        5476*	U1.AUS
55B1*	U1.BILO         542B*	U1.BREAD        5436*	U1.BWRIT
5411*	U1.CLRB         5445*	U1.COPB         5441*	U1.COPB2
5496*	U1.DSVG         546D*	U1.EIN          55AB*	U1.INFO
5420*	U1.KBR4         55E6*	U1.KRWE         54FB*	U1.KTIN1
54E2*	U1.KTINI        54C7*	U1.NMVGL        55CF*	U1.PRADR
5408*	U1.RRST         5400*	U1.RSAVE        55A6*	U1.TR
55C5*	U1.TST          5518*	U1.VERIN        5520*	U1.VERNI
5542*	U1.VORS1        553A*	U1.VORST        547F*	U1.VS1
5486*	U1.VSX          554E*	U1.VZS          542A*	U1.WAIT
6084*	UA.ALTR         606B*	UA.ANZWD        5F3D*	UA.BMGF
5F4E*	UA.DF           5F47*	UA.DOK          5E0E*	UA.DS
5ECB*	UA.EABFR        5F37*	UA.FRZ          5E86*	UA.GER
5E2E*	UA.KNAME        5E54*	UA.KOMMT        5E95*	UA.KOPFR
6040*	UA.LD           5E41*	UA.NR           5FA1*	UA.STADR
5F01*	UA.VORH         5E67*	UA.Z7E          6020*	UA.ZKBA
5F7B*	UA.ZKBEG        5FFA*	UA.ZKBEL        600D*	UA.ZKBLG
602A*	UA.ZKBM         5F55*	UA.ZKDAT        5FB4*	UA.ZKDL
6040*	UA.ZKEE         5F8E*	UA.ZKEND        5FC7*	UA.ZKF
5F68*	UA.ZKLAD        5FD2*	UA.ZKRES        5FE5*	UA.ZKSDT
6033*	UA.ZKSL         6052*	UA.ZRSCH        2B6E*	UB.DTAB
2B97*	UB.END          2B03*	UB.KTAB         2B1E*	UB.KTABE
2B26*	UB.PAR1         2B28*	UB.PAR2         2B2A*	UB.PAR3
2B2C*	UB.PAR4         2B2E*	UB.PAR5         2B30*	UB.PATAB
2B34*	UB.SATZ         2B00*	UB.ZN           57F2*	UC.ASCCO
57CF*	UC.CKONV        5699*	UC.CVABX        56B4*	UC.CVAX
56C8*	UC.CVAXB        5792*	UC.CVBC         5722*	UC.CVBD
572D*	UC.CVBD0        5720*	UC.CVBD1        571C*	UC.CVBD2
5718*	UC.CVBD3        5714*	UC.CVBD4        5710*	UC.CVBD5
56A3*	UC.CVBX         57A3*	UC.CVCB         578A*	UC.CVD1B
5761*	UC.CVDB         56BF*	UC.CVHLX        56EA*	UC.CVX1B
5705*	UC.CVXA         56D9*	UC.CVXB         56F3*	UC.CVXER
568B*	UC.DIVR         57C4*	UC.DK1          57D8*	UC.DK2
5852*	UC.DKOI         57B0*	UC.DKONV        5672*	UC.HL10C
566B*	UC.HL10N        57BA*	UC.KONV         57EE*	UC.KONV2
5AB0*	UE.BRKMB        3000 	UE.BWSA         0060 	UE.COTAL
5BC0*	UE.CRC          0DC6 	UE.EDEND        0132 	UE.KMPUL
8010 	UE.KPUFF        0E65 	UE.PUF          0CE0 	UE.STANF
007D 	UE.SVL          000B 	UE.SYSTB        00F7 	UE.TACL
00F9 	UE.TACR         001E 	UE.TAQUI        00CD 	UE.TASYS
8830 	UE.TEXAN        0E5A 	UE.ZEIN         5DB0*	UF.AZVB
5DE5*	UF.BEHB         5DED*	UF.BEHB1        5D64*	UF.ERANZ
5D34*	UF.EXEC         5D5B*	UF.EXEC1        5D58*	UF.EXEC2
5E02*	UF.FL14         5E05*	UF.FL16         5DFF*	UF.FL17
5DF3*	UF.FL18         5D2F*	UF.RET          5DA0*	UF.SYS
'Symbolliste S1b'	MACRO-80 3.44	09-Dec-81	PAGE	S-2


5DAC*	UF.SYS1         614C*	UK.GETK         616D*	UK.GETK2
6175*	UK.GETK3        617B*	UK.GETK4        6171*	UK.GETK5
6239*	UK.KBA          61AC*	UK.KBW          61EA*	UK.KBW1
61E6*	UK.KBW2         6189*	UK.KLPFB        6214*	UK.KSPFB
61F0*	UK.PUTK         5A64*	UR.ALPH1        5A5B*	UR.ALPHA
5A6F*	UR.ALPNU        5996*	UR.BBSA1        598E*	UR.BBSAD
5AA0*	UR.BILR1        5A8E*	UR.BILRO        611B*	UR.BM
599E*	UR.DSPZK        5A79*	UR.HEXAZ        5A86*	UR.HEXZ1
60C8*	UR.KBM          60DA*	UR.KBR          60D4*	UR.KBV
60C2*	UR.KLR          60BC*	UR.KLV          60B6*	UR.KRA
60A4*	UR.KRE          60A8*	UR.KRE1         60AC*	UR.KRW
60B2*	UR.KRWW         60CE*	UR.KSL          60F4*	UR.LES
595C*	UR.MIMO         5978*	UR.MIMO1        5970*	UR.MIMO2
597F*	UR.MIMO3        5A66*	UR.NUM          6129*	UR.OK
60E9*	UR.POSIK        59EE*	UR.RET0         60E0*	UR.RPOS
6148*	UR.RSP          5A88*	UR.TAREP        59F8*	UR.TCL
5A0A*	UR.TCLN         5A0D*	UR.TCR          5A1E*	UR.TCRN
5A28*	UR.TQUIT        5A20*	UR.TSYS         59AB*	UR.ZINP
59B1*	UR.ZINP1        59B4*	UR.ZINP2        59E2*	UR.ZINP3
59E8*	UR.ZINP4        59D0*	UR.ZINP5        59F1*	UR.ZINP7
5A56*	UR.ZKON1        5A30*	UR.ZKONT        55ED*	XY.CALP1
55F6*	XY.CALPE        5641*	XY.INCDX        565A*	XY.JMPDX
5601*	XY.LDDX         5611*	XY.LIDX         5621*	XY.STDX
5631*	XY.STIDX



No Fatal error(s)
