'EQUAL - Anweisungen fuer Assembler'	MACRO-80 3.44	09-Dec-81	PAGE	1


                                	TITLE 'EQUAL - Anweisungen fuer Assembler'
                                	PAGE	87
'EQUAL - Anweisungen fuer Assembler'	MACRO-80 3.44	09-Dec-81	PAGE	1-1


                                
  000B                          SY.SYSTB  EQU	0000BH
  0CE0                          SM.FKTAB  EQU	00CE0H
  0DAA                          SM.TABU   EQU	00DAAH
  225C                          ATACO     EQU	0225CH
  3000                          SD.BWSA   EQU	03000H
  4026                          TA.ABFR1  EQU	04026H
  4033                          SY.SETCHL EQU	04033H
  4036                          SY.RESC   EQU	04036H
  4040                          PRINT     EQU	04040H
  4070                          PUF.KASS  EQU	04070H
                                
                         C      	INCLUDE K0.MAC	;EQUAL - Anweisungen fuer Assembler
                         C      ;         PN    UE01
                         C      ;****************************************************************
                         C      ;*                  EQUAL - Anweisungen fuer Assembler          *
                         C      ;****************************************************************
  0030                   C      AKB      EQU	030H    ;IO-Adresse der AKB
  0080                   C      MaxBL    EQU	080H    ;max. Blocklaenge
                         C      
  00F7                   C      UE.TACL  EQU	0F7H    ;Kursor nach links
  00F9                   C      UE.TACR  EQU	0F9H    ; ''    nach rechts
  00CD                   C      UE.TASYS EQU	0CDH    ;SYS-Taste
  001E                   C      UE.TAQUI EQU	01EH    ;ET1
  007D                   C      UE.SVL   EQU	07DH    ;Laenge der SAVE-Bloecke
  0060                   C      UE.COTAL EQU	060H    ;Laenge ASC/KOI Codetabelle
  0132                   C      UE.KMPUL EQU	132H    ;max. Laenge E/A-Puffer
                         C      
  000B                   C      UE.SYSTB EQU	0000BH   ;SY.SYSTB
  0CFE                   C      UE.STANF EQU	00CFEH   ;STACK
  0DC4                   C      UE.EDEND EQU	00DC4H   ;Speicherpl. fuer Adr. Editorende
  0E5A                   C      UE.ZEIN  EQU	00E5AH   ;Pufferzaehler Eingabe
  0E66                   C      UE.PUF   EQU	00E66H   ;System-Puffer
  3000                   C      UE.BWSA  EQU	03000H   ;Bildwiederholspeicher
  8010                   C      UE.KPUFF EQU	08010H   ;E/A Puffer
  8830                   C      UE.TEXAN EQU	08830H   ;Begin Editorraum
                         C      
  5AB0'                  C      UE.BRKMB EQU	K1.BRKMB ;04000H	;phys. Kass.Routine
  5BB1'                  C      UE.CRC   EQU	K1.CRC   ;04740H	;CRC-Berechnung
                         C      
                         C      ;         END
                         C      ;         PN    UB
                         C                ORG   2B00H
  2B00'                  C      UB.ZN:    DS	1,0
  2B01'                  C      K0.HSB:   DS	1,0   ;HS-Bereich
  2B02'                  C      K0.LPD:   DS	1,0   ;Laenge der Daten im Puffer
  2B03'                  C      UB.KTAB:  DS	27,0  ;Originale Tabelle nach Robotron
  2B1E'                  C      UB.KTABE: DS	8,0   ;Tabelle fuer Kassetten im DEG2000 Emulator
  2B26'   0000           C      UB.PAR1:  DW	0
  2B28'   0000           C      UB.PAR2:  DW	0
  2B2A'   0000           C      UB.PAR3:  DW	0
  2B2C'   0000           C      UB.PAR4:  DW	0
  2B2E'   0000           C      UB.PAR5:  DW	0
  2B30'                  C      UB.PATAB: DS	4,0
  2B34'   00             C      UB.SATZ:  DB	0
  2B35'   37             C                DB	55
  2B36'   80             C                DB	80H
  2B37'                  C                DS	55,' '
  2B6E'                  C      UB.DTAB:  DS	41,0
  2B97'                  C      UB.END    EQU	$
                         C      ;         END
                         C      ;         PN    BC
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;        BEREICHE FUER KASSETTENKOPIEREN
                         C      ;
                         C      ;----------------------------------------------------------------------
  0000                   C      BC.EGG     EQU	0	;EINGABEGERAET
  0001                   C      BC.AGG     EQU	1	;AUSGABEGERAET
                         C      
                         C      ;	ORG	0E000H
  E000                   C      BC.TAB1    EQU	0E000H               ;Subadresse fuer Input -Kassette
                         C      ;          EQU	0E001H               ;Subadresse fuer Output-Kassette
  E002                   C      BC.VTABA   EQU	BC.TAB1  +    2
  EC82                   C      BC.VTABE   EQU	BC.VTABA + 3200
  F902                   C      BC.TAB2    EQU	BC.VTABE + 3200
  F96A                   C      BC.TAB2A   EQU	BC.TAB2  +  104
  F9D2                   C      BC.TAB3    EQU	BC.TAB2A +  104
  FA3A                   C      BC.END     EQU	BC.TAB3  +  104
                         C      ;         END
                                ;
                                	ORG	05400H
'EQUAL - Anweisungen fuer Assembler'	MACRO-80 3.44	09-Dec-81	PAGE	1-2


                                ;
                                ;	INCLUDE	U1.MAC	;Allgemeine Unterprogramme
                                ;	INCLUDE	XY.MAC	;Handling f. IX/IY-adressierte Bereiche
                                ;	INCLUDE	UC.MAC	;Konvertierungen
                                ;	INCLUDE	CP.MAC	;Komprimierung
                                ;	INCLUDE	DC.MAC	;Dekomprimierung
                                ;	INCLUDE UR.MAC	;Routinen fuer Monitor UND Tastatur
                         C      	INCLUDE K1.MAC	;Allgemeine Unterprogramme
                         C      	TITLE	'Allgemeine Unterprogramme'
                         C      	PAGE
'Allgemeine Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-3


                         C      
                         C      ;	PN	U1
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;        Allgemeine Unterprogramme
                         C      ;
                         C      ;----------------------------------------------------------------------
  5400'                  C      U1.RSAVE:
  5400'   E3             C      	EX	(SP),HL	;Register retten (nicht AF)
  5401'   D5             C      	PUSH	DE
  5402'   C5             C      	PUSH	BC
  5403'   FD E5          C      	PUSH	IY
  5405'   DD E5          C      	PUSH	IX
  5407'   E9             C      	JP	(HL)
  5408'                  C      U1.RRST:
  5408'   E1             C      	POP	HL	;Register wieder herstellen
  5409'   DD E1          C      	POP	IX
  540B'   FD E1          C      	POP	IY
  540D'   C1             C      	POP	BC
  540E'   D1             C      	POP	DE
  540F'   E3             C      	EX	(SP),HL
  5410'   C9             C      	RET
  5411'                  C      U1.CLRB:
  5411'   E5             C      	PUSH	HL	;Bereich loeschen
  5412'   D5             C      	PUSH	DE
  5413'   C5             C      	PUSH	BC
  5414'   E5             C      	PUSH	HL	;IN:  HL= Bereichsanfang
  5415'   D1             C      	POP	DE	;     BC= Bereichslaenge
  5416'   13             C      	INC	DE
  5417'   AF             C      	XOR	A
  5418'   77             C      	LD	(HL),A
  5419'   0B             C      	DEC	BC
  541A'   ED B0          C      	LDIR
  541C'   C1             C      	POP	BC
  541D'   D1             C      	POP	DE
  541E'   E1             C      	POP	HL
  541F'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  5420'                  C      U1.KBR4:
  5420'   C5             C      	PUSH	BC
  5421'   06 04          C      	LD	B,4
  5423'   CD 60CB'       C      	CALL	UR.KBR
  5426'   10 FB          C      	DJNZ	$-3
  5428'   C1             C      	POP	BC
  5429'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  542A'                  C      U1.WAIT:
                         C      	; PUSH	AF
                         C      	; CALL	UE.BERT
                         C      	; JR	C,$-3
                         C      	; POP	AF
  542A'   C9             C      	RET
                         C      ;--------------------------------------------------------------------
  542B'                  C      U1.BREAD:
  542B'   CD 546D'       C      	CALL	U1.EIN	;BLOCK LESEN VON EINGABE
  542E'   DD 36 04 02    C      	LD	(IX+4),02H
  5432'   CD 5D25'       C      	CALL	UF.EXEC
  5435'   C9             C      	RET
  5436'                  C      U1.BWRIT:
  5436'   CD 5476'       C      	CALL	U1.AUS	;BLOCK SCHREIBEN AUF AUSGABE
  5439'   DD 36 04 08    C      	LD	(IX+4),08H
  543D'   CD 5D25'       C      	CALL	UF.EXEC
  5440'   C9             C      	RET
  5441'                  C      U1.COPB2:
  5441'   F5             C      	PUSH	AF
  5442'   37             C      	SCF
  5443'   18 02          C      	JR	$+4
  5445'                  C      U1.COPB:
  5445'   F5             C      	PUSH	AF
  5446'   B7             C      	OR	A
  5447'   CD 546D'       C      	CALL	U1.EIN
  544A'   DD 36 04 02    C      	LD	(IX+4),02H
  544E'   DC 6FF8'       C      	CALL	C,KX.EXEC2
  5451'   D4 5D25'       C      	CALL	NC,UF.EXEC
  5454'   F5             C      	PUSH	AF
  5455'   CD 5476'       C      	CALL	U1.AUS
                         C      	;LD	A,(IX+9)
                         C      	;OR	(IX+10)
  5458'   DD 7E 0A       C      	LD	A,(IX+10)	;Laenge = 1, dann BM
  545B'   FE 01          C      	CP	1
  545D'   28 08          C      	JR	Z,$+10
  545F'   CD 5436'       C      	CALL	U1.BWRIT
'Allgemeine Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-4


  5462'   F1             C      	POP	AF
  5463'   38 DC          C      	JR	C,$-34
  5465'   30 DE          C      	JR	NC,$-32
  5467'   CD 60B9'       C      	CALL	UR.KBM
  546A'   F1             C      	POP	AF
  546B'   F1             C      	POP	AF
  546C'   C9             C      	RET
  546D'                  C      U1.EIN:
  546D'   F5             C      	PUSH	AF
  546E'   3A E000        C      	LD	A,(BC.TAB1)
  5471'   DD 77 03       C      	LD	(IX+3),A
  5474'   F1             C      	POP	AF
  5475'   C9             C      	RET
  5476'                  C      U1.AUS:
  5476'   F5             C      	PUSH	AF
  5477'   3A E001        C      	LD	A,(BC.TAB1+1)
  547A'   DD 77 03       C      	LD	(IX+3),A
  547D'   F1             C      	POP	AF
  547E'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  547F'                  C      U1.VS1:
  547F'   E5             C      	PUSH	HL
  5480'   C5             C      	PUSH	BC
  5481'   F5             C      	PUSH	AF
  5482'   3E 01          C      	LD	A,01H	;1.DATEIVORSATZ IM PUFFER
  5484'   18 04          C      	JR	$+6
  5486'                  C      U1.VSX:
  5486'   E5             C      	PUSH	HL
  5487'   C5             C      	PUSH	BC
  5488'   F5             C      	PUSH	AF
  5489'   AF             C      	XOR	A	;00-DATEIVORSATZ IM PUFFER
  548A'   06 20          C      	LD	B,32
  548C'   21 0E66        C      	LD	HL,UE.PUF
  548F'   CD 55A6'       C      	CALL	U1.TR
  5492'   F1             C      	POP	AF
  5493'   C1             C      	POP	BC
  5494'   E1             C      	POP	HL
  5495'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  5496'                  C      U1.DSVG:
  5496'   E5             C      	PUSH	HL
  5497'   D5             C      	PUSH	DE
  5498'   F5             C      	PUSH	AF
  5499'   06 07          C      	LD	B,7	;MRES KASSETTE ?
  549B'   CD 5542'       C      	CALL	U1.VORS1
  549E'   11 0E6C        C      	LD	DE,UE.PUF+6
  54A1'   21 5E05'       C      	LD	HL,UA.DS+6
  54A4'   06 0E          C      	LD	B,14
  54A6'   1A             C      	LD	A,(DE)
  54A7'   BE             C      	CP	(HL)
  54A8'   20 10          C      	JR	NZ,$+18
  54AA'   13             C      	INC	DE
  54AB'   23             C      	INC	HL
  54AC'   10 F8          C      	DJNZ	$-6
  54AE'   3A 0E67        C      	LD	A,(UE.PUF+1)
  54B1'   4F             C      	LD	C,A	;C <-- NEXT RECORD
  54B2'   3A 0E69        C      	LD	A,(UE.PUF+3)
  54B5'   47             C      	LD	B,A	;B <-- ANZ.VERZ.EINTRAG.
  54B6'   F1             C      	POP	AF
  54B7'   D1             C      	POP	DE
  54B8'   E1             C      	POP	HL
  54B9'   C9             C      	RET
                         C      
  54BA'   F1             C      	POP	AF
  54BB'   D1             C      	POP	DE
  54BC'   E1             C      	POP	HL
  54BD'   FD E1          C      	POP	IY
  54BF'   3E 90          C      	LD	A,90H
  54C1'   CD 5D55'       C      	CALL	UF.ERANZ
  54C4'   C3 000B        C      	JP	UE.SYSTB
                         C      ;----------------------------------------------------------------------
  54C7'                  C      U1.NMVGL:
  54C7'   C5             C      	PUSH	BC
  54C8'   D5             C      	PUSH	DE
  54C9'   E5             C      	PUSH	HL
  54CA'   06 06          C      	LD	B,6
  54CC'   11 0E66        C      	LD	DE,UE.PUF
  54CF'   1A             C      	LD	A,(DE)
  54D0'   BE             C      	CP	(HL)	;HL:ZU SUCHENDER PROGR.NAME
  54D1'   20 0C          C      	JR	NZ,$+14
  54D3'   23             C      	INC	HL
  54D4'   13             C      	INC	DE
  54D5'   10 F8          C      	DJNZ	$-6
'Allgemeine Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-5


  54D7'   3A 0E7D        C      	LD	A,(UE.PUF+23)	;LABELNR. -->A
  54DA'   37             C      	SCF		;CY=1,WENN PROGR. GEFUNDEN
  54DB'   E1             C      	POP	HL
  54DC'   D1             C      	POP	DE
  54DD'   C1             C      	POP	BC
  54DE'   C9             C      	RET
                         C      
  54DF'   B7             C      	OR	A
  54E0'   18 F9          C      	JR	$-5
                         C      ;----------------------------------------------------------------------
  54E2'                  C      U1.KTINI:
  54E2'   E5             C      	PUSH	HL
  54E3'   C5             C      	PUSH	BC
  54E4'   F5             C      	PUSH	AF
  54E5'   CD 55B1'       C      	CALL	U1.BILO	;UNTERE HAELFTE BS LOESCHEN
  54E8'   DD 21 2B03'    C      	LD	IX,UB.KTAB	;ADR. STEUERTAB. F.KASS.ROUTINE
  54EC'   DD E5          C      	PUSH	IX
  54EE'   E1             C      	POP	HL
  54EF'   AF             C      	XOR	A
  54F0'   06 1B          C      	LD	B,27
  54F2'   CD 55A6'       C      	CALL	U1.TR	;TAB. AUF 00 LOESCHEN
  54F5'   DD 36 02 30    C      	LD	(IX+2),AKB
                         C      ;	CALL	UE.KINI
  54F9'   18 03          C      	JR	$+5
  54FB'                  C      U1.KTIN1:
  54FB'   E5             C      	PUSH	HL
  54FC'   C5             C      	PUSH	BC
  54FD'   F5             C      	PUSH	AF
  54FE'   DD 36 0B 07    C      	LD	(IX+11),7	;ANZAHL LESE/SCHREIBWDHLGNN
  5502'   DD 36 0C 04    C      	LD	(IX+12),4	;ANZAHL
  5506'   21 0E66        C      	LD	HL,UE.PUF
  5509'   CD 5631'       C      	CALL	XY.STIDX
  550C'   07             C      	DB	7	;SYSTEMPUFFERADR.-->TAB
  550D'   21 8010        C      	LD	HL,UE.KPUFF
  5510'   CD 5621'       C      	CALL	XY.STDX
  5513'   19             C      	DB	25	;E/A PUFFERADR.-->TAB
  5514'   F1             C      	POP	AF
  5515'   C1             C      	POP	BC
  5516'   E1             C      	POP	HL
  5517'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  5518'                  C      U1.VERIN:
  5518'   E5             C      	PUSH	HL
  5519'   C5             C      	PUSH	BC
  551A'   F5             C      	PUSH	AF
  551B'   11 EC82        C      	LD	DE,BC.VTABE	;VERZ. EINGABEGER. EINLESEN
  551E'   18 03          C      	JR	$+5
  5520'                  C      U1.VERNI:
  5520'   E5             C      	PUSH	HL
  5521'   C5             C      	PUSH	BC
  5522'   F5             C      	PUSH	AF
  5523'   3A 0E69        C      	LD	A,(UE.PUF+3)	;ANZ. DATEIEN-->B
  5526'   47             C      	LD	B,A
  5527'   C5             C      	PUSH	BC
  5528'   21 0E66        C      	LD	HL,UE.PUF
  552B'   01 0020        C      	LD	BC,32
  552E'   ED B0          C      	LDIR
  5530'   CD 5D25'       C      	CALL	UF.EXEC
  5533'   C1             C      	POP	BC
  5534'   10 F1          C      	DJNZ	$-13
  5536'   F1             C      	POP	AF
  5537'   C1             C      	POP	BC
  5538'   E1             C      	POP	HL
  5539'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  553A'                  C      U1.VORST:
  553A'   C5             C      	PUSH	BC
  553B'   CD 60A3'       C      	CALL	UR.KRWW
  553E'   06 06          C      	LD	B,6
  5540'   18 01          C      	JR	$+3
  5542'                  C      U1.VORS1:
  5542'   C5             C      	PUSH	BC
  5543'   DD 36 04 02    C      	LD	(IX+4),02H
  5547'   CD 5D25'       C      	CALL	UF.EXEC
  554A'   10 FB          C      	DJNZ	$-3
  554C'   C1             C      	POP	BC
  554D'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  554E'                  C      U1.VZS:
  554E'   D5             C      	PUSH	DE
  554F'   C5             C      	PUSH	BC
  5550'   E5             C      	PUSH	HL
  5551'   F5             C      	PUSH	AF
'Allgemeine Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-6


  5552'   CD 60C5'       C      	CALL	UR.KBV
  5555'   CD 60CB'       C      	CALL	UR.KBR
  5558'   11 0E66        C      	LD	DE,UE.PUF
  555B'   01 0006        C      	LD	BC,6
  555E'   ED B0          C      	LDIR		;PROGR.NAME --> PUFFER
  5560'   3A 2B28'       C      	LD	A,(UB.PAR2)	;DATEITYP
  5563'   12             C      	LD	(DE),A
  5564'   13             C      	INC	DE
  5565'   3E 44          C      	LD	A,'D'
  5567'   12             C      	LD	(DE),A
  5568'   13             C      	INC	DE
  5569'   3A 2B2A'       C      	LD	A,(UB.PAR3)
  556C'   FE 7F          C      	CP	7FH
  556E'   20 0F          C      	JR	NZ,$+17
  5570'   21 5E45'       C      	LD	HL,UA.KOMMT	;FRAGE KOMMENTAR WENN PAR3=7F
  5573'   CD 595C'       C      	CALL	UR.MIMO
  5576'   01 0006        C      	LD	BC,6
  5579'   ED B0          C      	LDIR
  557B'   06 09          C      	LD	B,9
  557D'   18 02          C      	JR	$+4
  557F'   06 0F          C      	LD	B,15
  5581'   3E 20          C      	LD	A,' '
  5583'   12             C      	LD	(DE),A
  5584'   13             C      	INC	DE
  5585'   10 FC          C      	DJNZ	$-2
  5587'   3A 2B26'       C      	LD	A,(UB.PAR1)
  558A'   12             C      	LD	(DE),A
  558B'   13             C      	INC	DE
  558C'   06 08          C      	LD	B,8
  558E'   AF             C      	XOR	A
  558F'   12             C      	LD	(DE),A
  5590'   13             C      	INC	DE
  5591'   10 FC          C      	DJNZ	$-2
  5593'   21 0020        C      	LD	HL,32
  5596'   CD 5631'       C      	CALL	XY.STIDX
  5599'   09             C      	DB	9
  559A'   DD 36 04 08    C      	LD	(IX+4),08H
  559E'   CD 5D25'       C      	CALL	UF.EXEC
  55A1'   F1             C      	POP	AF
  55A2'   E1             C      	POP	HL
  55A3'   C1             C      	POP	BC
  55A4'   D1             C      	POP	DE
  55A5'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  55A6'                  C      U1.TR:
  55A6'   77             C      	LD	(HL),A	;A=INHALT
  55A7'   23             C      	INC	HL
  55A8'   10 FC          C      	DJNZ	U1.TR	;B=ANZAHL
  55AA'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  55AB'                  C      U1.INFO:
  55AB'   01 000E        C      	LD	BC,14
  55AE'   ED B0          C      	LDIR
  55B0'   C9             C      	RET
  55B1'                  C      U1.BILO:
  55B1'   CD 5400'       C      	CALL	U1.RSAVE
  55B4'   21 3370        C      	LD	HL,SD.BWSA + 11*80	;3370H
  55B7'   01 040F        C      	LD	BC,13*80 - 1	;1120  ( -80 ... eine Zeile )
  55BA'   36 20          C      	LD	(HL),20H
  55BC'   54             C      	LD	D,H
  55BD'   5D             C      	LD	E,L
  55BE'   13             C      	INC	DE
  55BF'   ED B0          C      	LDIR
  55C1'   CD 5408'       C      	CALL	U1.RRST
  55C4'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  55C5'                  C      U1.TST:
  55C5'   B7             C      	OR	A
  55C6'   D6 30          C      	SUB	30H
  55C8'   47             C      	LD	B,A
  55C9'   05             C      	DEC	B
  55CA'   C8             C      	RET	Z
  55CB'   05             C      	DEC	B
  55CC'   C8             C      	RET	Z
  55CD'   37             C      	SCF
  55CE'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  55CF'                  C      U1.PRADR:
  55CF'   E5             C      	PUSH	HL
  55D0'   C5             C      	PUSH	BC
  55D1'   06 04          C      	LD	B,4
  55D3'   7E             C      	LD	A,(HL)
  55D4'   FE 20          C      	CP	' '
'Allgemeine Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-7


  55D6'   28 07          C      	JR	Z,$+9
  55D8'   23             C      	INC	HL
  55D9'   10 F8          C      	DJNZ	$-6
  55DB'   B7             C      	OR	A
  55DC'   C1             C      	POP	BC
  55DD'   E1             C      	POP	HL
  55DE'   C9             C      	RET
  55DF'   37             C      	SCF
  55E0'   21 2B00'       C      	LD	HL,UB.ZN
  55E3'   35             C      	DEC	(HL)
  55E4'   18 F6          C      	JR	$-8
                         C      ;---------------------------------------------------------------------
  55E6'                  C      U1.KRWE:
  55E6'   CD 6095'       C      	CALL	UR.KRE
  55E9'   CD 60A3'       C      	CALL	UR.KRWW
  55EC'   C9             C      	RET
                         C      ;---------------------------------------------------------------------
                         C      ;	END
                         C      	TITLE 'Handling f. IX/IY-adressierte Bereiche'
                         C      	PAGE
'Handling f. IX/IY-adressierte Bereiche'	MACRO-80 3.44	09-Dec-81	PAGE	1-8


                         C      
                         C      ;	PN	XY ; Unterprogramme
                         C      ;**********************************************************************
                         C      ;*                                                                    *
                         C      ;*       Handling f. IX/IY-adressierte Steuer-Bloecke bzw.            *
                         C      ;*                                     Arbeits-Bereiche               *
                         C      ;*                                                                    *
                         C      ;*--------------------------------------------------------------------*
                         C      ;*                                                                    *
                         C      ;*       Ausser den angegebenen Registern bzw. Flags wird nur noch    *
                         C      ;*       die angegebene Anzahl der ersten freien Stack-Plaetze (je    *
                         C      ;*       Byte) veraendert. Weiterer RAM-Platz wird nicht benoetigt.   *
                         C      ;*                                                                    *
                         C      ;**********************************************************************
                         C      ;*                                                                    *
                         C      ;*       Technische (Hilfs-) Unter-Programme                          *
                         C      ;*                                                                    *
                         C      ;**********************************************************************
                         C      			;
                         C      ;        Uebernahme von nach dem CALL stehenden Parameter
                         C      ;        ++++++++++++++++++++++++++++++++++++++++++++++++
                         C      ;        erwarten Stack:           Return-Adresse f.uebergeordnetes UP
                         C      ;                       (SP) -->   Return-Adresse f.CALPn
                         C      ;        geben Stack zurueck:      Return-Adresse f.uebergeordn.UP + n
                         C      ;                                  (DE)
                         C      ;                       (SP) -->   (HL)
                         C      ;        geben in Reg.zurueck:     (DE):  Wert    1.Parameter-Byte
                         C      ;                                  (HL):  Adresse 2.Parameter-Byte
                         C      ;        --------------------------------------------------------------
                         C      			;
  55ED'                  C      XY.CALP1	EQU	$	; 1 Byte-Parameter
                         C      			; ++++++++++++++++++++++++++++++
  55ED'   E5             C      	PUSH	HL	; Retten HL
  55EE'   E1             C      	POP	HL
                         C      			;
  55EF'   EB             C      	EX	DE,HL	; DE <--> RET-Adr.f.CALPn
  55F0'   E3             C      	EX	(SP),HL
  55F1'   EB             C      	EX	DE,HL
                         C      			;
  55F2'   E1             C      	POP	HL	; (SP) --> RET-Adr.f.ueberg.UP
                         C      			;
  55F3'   E1             C      	POP	HL	; Laden u. korrig. ...
  55F4'   23             C      	INC	HL
  55F5'   E5             C      	PUSH	HL
  55F6'                  C      XY.CALPE:
  55F6'   2B             C      	DEC	HL
                         C      			;
  55F7'   3B             C      	DEC	SP	; (SP) --> (DE)
  55F8'   3B             C      	DEC	SP
  55F9'   3B             C      	DEC	SP	; (SP) --> (HL)
  55FA'   3B             C      	DEC	SP
                         C      			;
  55FB'   D5             C      	PUSH	DE	; RET-Adr.f.CALPn
                         C      			;
  55FC'   5E             C      	LD	E,(HL)	; Laden DE, HL
  55FD'   16 00          C      	LD	D,0
  55FF'   23             C      	INC	HL
                         C      			;
  5600'   C9             C      	RET
                         C      			;
                         C      			;
                         C      ;**********************************************************************
                         C      ;*                                                                    *
                         C      ;*       Lade-, Speicher- und Transport-Unterprogramme                *
                         C      ;*                                                                    *
                         C      ;**********************************************************************
                         C      ;
                         C      ;    CALL  LDDX    'Load':              HL := (IX+d)
                         C      ;    DB    d                                              Stack: 4
                         C      ;    -----------   ----------------------------------------------------
                         C      			;
  5601'                  C      XY.LDDX:
  5601'   CD 55ED'       C      	CALL	XY.CALP1	; Uebernahme d
                         C      			;
  5604'   DD E5          C      	PUSH	IX	; HL := IX+d
  5606'   E1             C      	POP	HL	;               <--- LDDY
  5607'   F5             C      	PUSH	AF
  5608'   19             C      	ADD	HL,DE
  5609'   F1             C      	POP	AF
                         C      			;
  560A'   5E             C      	LD	E,(HL)	; HL := (IX+d)
  560B'   23             C      	INC	HL
'Handling f. IX/IY-adressierte Bereiche'	MACRO-80 3.44	09-Dec-81	PAGE	1-9


  560C'   56             C      	LD	D,(HL)
  560D'   EB             C      	EX	DE,HL
                         C      			;
  560E'   D1             C      	POP	DE	; Return
  560F'   D1             C      	POP	DE
  5610'   C9             C      	RET
                         C      			;
                         C      ;**********************************************************************
                         C      ;
                         C      ;    CALL  LIDX    'Load inverse':      LH := (IX+d)
                         C      ;    DB    d                                              Stack: 4
                         C      ;    -----------   ----------------------------------------------------
                         C      			;
  5611'                  C      XY.LIDX:
  5611'   CD 55ED'       C      	CALL	XY.CALP1	; Uebernahme d
                         C      			;
  5614'   DD E5          C      	PUSH	IX	; HL := IX+d
  5616'   E1             C      	POP	HL	;               <--- LIDY
  5617'   F5             C      	PUSH	AF
  5618'   19             C      	ADD	HL,DE
  5619'   F1             C      	POP	AF
                         C      			;
  561A'   56             C      	LD	D,(HL)	; LH := (IX+d)
  561B'   23             C      	INC	HL
  561C'   5E             C      	LD	E,(HL)
  561D'   EB             C      	EX	DE,HL
                         C      			;
  561E'   D1             C      	POP	DE	; Return
  561F'   D1             C      	POP	DE
  5620'   C9             C      	RET
                         C      			;
                         C      ;**********************************************************************
                         C      ;
                         C      ;    CALL  STDX    'Store':            (IX+d) := HL
                         C      ;    DB    d                                                  Stack: 4
                         C      ;    -----------   ----------------------------------------------------
                         C      			;
  5621'                  C      XY.STDX:
  5621'   CD 55ED'       C      	CALL	XY.CALP1	; Uebernahme d
                         C      			;
  5624'   DD E5          C      	PUSH	IX	; HL := IX+d
  5626'   E1             C      	POP	HL	;               <--- STDY
  5627'   F5             C      	PUSH	AF
  5628'   19             C      	ADD	HL,DE
  5629'   F1             C      	POP	AF
                         C      			;
  562A'   D1             C      	POP	DE
  562B'   73             C      	LD	(HL),E	; (IX+d) := HL
  562C'   23             C      	INC	HL
  562D'   72             C      	LD	(HL),D
  562E'   EB             C      	EX	DE,HL
                         C      			;
  562F'   D1             C      	POP	DE	; Return
  5630'   C9             C      	RET
                         C      			;
                         C      ;**********************************************************************
                         C      ;
                         C      ;    CALL  STIDX    'Store inverse':    (IX+d) := LH
                         C      ;    DB    d                                                  Stack: 4
                         C      ;    -----------   ----------------------------------------------------
                         C      			;
  5631'                  C      XY.STIDX:
  5631'   CD 55ED'       C      	CALL	XY.CALP1	; Uebernahme d
                         C      			;
  5634'   DD E5          C      	PUSH	IX	; HL := IX+d
  5636'   E1             C      	POP	HL	;               <--- STIDY
  5637'   F5             C      	PUSH	AF
  5638'   19             C      	ADD	HL,DE
  5639'   F1             C      	POP	AF
                         C      			;
  563A'   D1             C      	POP	DE
  563B'   72             C      	LD	(HL),D	; (IX+d) := LH
  563C'   23             C      	INC	HL
  563D'   73             C      	LD	(HL),E
  563E'   EB             C      	EX	DE,HL
                         C      			;
  563F'   D1             C      	POP	DE	; Return
  5640'   C9             C      	RET
                         C      			;
                         C      ;**********************************************************************
                         C      ;
                         C      ;    CALL  INCDX    'Increment':        (IX+d) := (IX+d) + 1
                         C      ;    DB    d                                    Flags wie ADC HL,...
'Handling f. IX/IY-adressierte Bereiche'	MACRO-80 3.44	09-Dec-81	PAGE	1-10


                         C      ;                                                             Stack: 4
                         C      ;    -----------   ----------------------------------------------------
                         C      			;
  5641'                  C      XY.INCDX:
  5641'   CD 55ED'       C      	CALL	XY.CALP1	; Uebernahme d
                         C      			;
  5644'   DD E5          C      	PUSH	IX	; HL := IX+d
  5646'   E1             C      	POP	HL	;               <--- INCDY
  5647'   19             C      	ADD	HL,DE
                         C      			;
  5648'   5E             C      	LD	E,(HL)	; DE := (IX+d)
  5649'   23             C      	INC	HL
  564A'   56             C      	LD	D,(HL)
                         C      			;
  564B'   E5             C      	PUSH	HL	; DE := (IX+d) + 1
  564C'   21 0001        C      	LD	HL,1
  564F'   B7             C      	OR	A
  5650'   ED 5A          C      	ADC	HL,DE
  5652'   EB             C      	EX	DE,HL
  5653'   E1             C      	POP	HL
  5654'   72             C      	LD	(HL),D
  5655'   2B             C      	DEC	HL
  5656'   73             C      	LD	(HL),E
                         C      			;
  5657'   E1             C      	POP	HL	; Return
  5658'   D1             C      	POP	DE
  5659'   C9             C      	RET
                         C      			;
                         C      ;**********************************************************************
                         C      ;*                                                                    *
                         C      ;*       Unterprogramm  'Unbedingter Sprung'                          *
                         C      ;*                                                                    *
                         C      ;**********************************************************************
                         C      ;
                         C      ;    CALL  JMPDX   'Jump':              JMP  (IX+d)
                         C      ;    DB    d                                              Stack: 4
                         C      ;                                       Achtung!
                         C      ;                                           Veraendert freie Stack-Pl.
                         C      ;    -----------   ----------------------------------------------------
                         C      			;
  565A'                  C      XY.JMPDX:
  565A'   CD 55ED'       C      	CALL	XY.CALP1	; Uebernahme d
                         C      			;
  565D'   DD E5          C      	PUSH	IX	; HL := IX+d
  565F'   E1             C      	POP	HL	;               <--- JMPDY
  5660'   F5             C      	PUSH	AF
  5661'   19             C      	ADD	HL,DE
  5662'   F1             C      	POP	AF
                         C      			;
  5663'   5E             C      	LD	E,(HL)	; HL := (IX+d)
  5664'   23             C      	INC	HL
  5665'   56             C      	LD	D,(HL)
  5666'   EB             C      	EX	DE,HL
                         C      			;
  5667'   D1             C      	POP	DE	; Return = Jump
  5668'   E3             C      	EX	(SP),HL
  5669'   EB             C      	EX	DE,HL
  566A'   C9             C      	RET
                         C      			;
                         C      ;**********************************************************************
                         C      ;	END
                         C      	TITLE 'Konvertierungen'
                         C      	PAGE
'Konvertierungen'	MACRO-80 3.44	09-Dec-81	PAGE	1-11


                         C      
                         C      ;	PN	UC
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;       KONVERTIERUNGEN
                         C      ;
                         C      ;----------------------------------------------------------------------
                         C      ;                            HL := HL * 10
                         C      ;                                      (ohne Kontrolle auf Uebertrag)
  566B'                  C      UC.HL10N:
  566B'   E5             C      	PUSH	HL
  566C'   D1             C      	POP	DE	; alter Wert in DE
  566D'   29             C      	ADD	HL,HL
  566E'   29             C      	ADD	HL,HL
  566F'   19             C      	ADD	HL,DE
  5670'   29             C      	ADD	HL,HL
  5671'   C9             C      	RET
                         C      ;                            HL := HL * 10
                         C      ;                                            -->  C: Uebertrag in A
  5672'                  C      UC.HL10C:
  5672'   E5             C      	PUSH	HL
  5673'   D1             C      	POP	DE	; alter Wert in DE
  5674'   AF             C      	XOR	A
  5675'   29             C      	ADD	HL,HL
  5676'   30 01          C      	JR	NC,$+3
  5678'   3C             C      	INC	A
  5679'   87             C      	ADD	A,A
  567A'   29             C      	ADD	HL,HL
  567B'   30 01          C      	JR	NC,$+3
  567D'   3C             C      	INC	A
  567E'   19             C      	ADD	HL,DE
  567F'   30 01          C      	JR	NC,$+3
  5681'   3C             C      	INC	A
  5682'   87             C      	ADD	A,A
  5683'   29             C      	ADD	HL,HL
  5684'   30 01          C      	JR	NC,$+3
  5686'   3C             C      	INC	A
  5687'   B7             C      	OR	A
  5688'   C8             C      	RET	Z
  5689'   37             C      	SCF
  568A'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      ;                            Division mit Rest:  A  := HL / DE
                         C      ;                                                HL := Rest
                         C      			;      Cy(A) --->  A=255
                         C      			;-------------------------------
  568B'                  C      UC.DIVR:
  568B'   AF             C      	XOR	A
  568C'   ED 52          C      	SBC	HL,DE
  568E'   3C             C      	INC	A
  568F'   20 03          C      	JR	NZ,$+5
  5691'   3D             C      	DEC	A
  5692'   38 03          C      	JR	C,$+5
  5694'   30 F6          C      	JR	NC,$-8
  5696'   3D             C      	DEC	A
  5697'   19             C      	ADD	HL,DE
  5698'   C9             C      	RET
                         C      			;
                         C      ;**********************************************************************
                         C      ;*                                                                    *
                         C      ;*       CV...               Konvertierungen     (convert ...)        *
                         C      ;*                                                                    *
                         C      ;*--------------------------------------------------------------------*
                         C      ;*       ..A..:              in A                                     *
                         C      ;*       ..?*.:              von Typ *                                *
                         C      ;*       ..?.*:              nach Typ *                               *
                         C      ;*                                                                    *
                         C      ;*       Typen:              B - binaer                               *
                         C      ;*                           X - hexadezimal ASCII                    *
                         C      ;*                           A - Adresse binaer (L,H)                 *
                         C      ;*                           D - dezimal ASCII                        *
                         C      ;*                                                                    *
                         C      ;**********************************************************************
                         C      			;
                         C      ;                            In A:      Binaer < 16 --> ASCII hexa
                         C      ;                            ------------------------------------------
  5699'                  C      UC.CVABX:
  5699'   E6 0F          C      	AND	0FH
  569B'   F6 30          C      	OR	30H
  569D'   FE 3A          C      	CP	3AH
  569F'   D8             C      	RET	C
'Konvertierungen'	MACRO-80 3.44	09-Dec-81	PAGE	1-12


  56A0'   C6 07          C      	ADD	A,7H
  56A2'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      ;                            Byte binaer (HL) --> 2 ASCII hexa (DE)
                         C      ;                                                            HL+1, DE+2
                         C      ;                            ------------------------------------------
  56A3'                  C      UC.CVBX:
  56A3'   7E             C      	LD	A,(HL)
  56A4'   23             C      	INC	HL	; benutzt: A, 2 Stack-P.
                         C      			;
  56A5'   F5             C      	PUSH	AF	;ENTRY,WENN ZEICHEN IN A
  56A6'   0F             C      	RRCA
  56A7'   0F             C      	RRCA
  56A8'   0F             C      	RRCA
  56A9'   0F             C      	RRCA
  56AA'   CD 56AE'       C      	CALL	$+4
  56AD'   F1             C      	POP	AF
                         C      			;
  56AE'   CD 5699'       C      	CALL	UC.CVABX
  56B1'   12             C      	LD	(DE),A
  56B2'   13             C      	INC	DE
  56B3'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      ;                       Adresse (L,H) binaer (HL) --> 4 ASCII hexa (DE)
                         C      ;                                                            HL+2, DE+4
                         C      ;                       -----------------------------------------------
  56B4'                  C      UC.CVAX:
  56B4'   23             C      	INC	HL
  56B5'   CD 56A3'       C      	CALL	UC.CVBX	; benutzt: A, 3 Stack-P.
  56B8'   2B             C      	DEC	HL
  56B9'   2B             C      	DEC	HL
  56BA'   CD 56A3'       C      	CALL	UC.CVBX
  56BD'   23             C      	INC	HL
  56BE'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      ;                       Adresse aus HL, binaer    --> 4 ASCII hexa (DE)
                         C      ;                                                                  DE+4
                         C      ;                       -----------------------------------------------
  56BF'                  C      UC.CVHLX:
  56BF'   7C             C      	LD	A,H
  56C0'   CD 56A5'       C      	CALL	UC.CVBX+2	; benutzt: A, 3 Stack-P.
  56C3'   7D             C      	LD	A,L
  56C4'   CD 56A5'       C      	CALL	UC.CVBX+2
  56C7'   C9             C      	RET
                         C      			;
                         C      			;
                         C      ;      ---------------------------------------------------------------
                         C      ;                            In A:     ASCII hexa --> binaer < 16
                         C      ;
                         C      ;                                       Datenfehler: Cy, A undefiniert
                         C      ;                            ------------------------------------------
  56C8'                  C      UC.CVAXB:
  56C8'   D6 30          C      	SUB	30H
  56CA'   D8             C      	RET	C		;       (A) < '0'
  56CB'   FE 0A          C      	CP	10
  56CD'   3F             C      	CCF
  56CE'   D0             C      	RET	NC
  56CF'   FE 11          C      	CP	11H
  56D1'   D8             C      	RET	C		; '9' < (A) < 'A'
  56D2'   FE 17          C      	CP	17H
  56D4'   3F             C      	CCF
  56D5'   D8             C      	RET	C		; 'F' < (A)
  56D6'   D6 07          C      	SUB	7H
  56D8'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      ;                            2 ASCII hexa (DE) --> Byte binaer (HL)
                         C      ;                                                            DE+2, HL+1
                         C      ;
                         C      ;                                       mit Datenfehler-Behandlung
                         C      ;                            ------------------------------------------
  56D9'                  C      UC.CVXB:
  56D9'   C5             C      	PUSH	BC
                         C      			; benutzt: A, 3 Stack-P.
  56DA'   CD 56EA'       C      	CALL	UC.CVX1B
  56DD'   87             C      	ADD	A,A
  56DE'   87             C      	ADD	A,A
  56DF'   87             C      	ADD	A,A
  56E0'   87             C      	ADD	A,A
  56E1'   4F             C      	LD	C,A
'Konvertierungen'	MACRO-80 3.44	09-Dec-81	PAGE	1-13


                         C      			;
  56E2'   CD 56EA'       C      	CALL	UC.CVX1B
  56E5'   81             C      	ADD	A,C
                         C      			;
  56E6'   77             C      	LD	(HL),A
  56E7'   23             C      	INC	HL
  56E8'   C1             C      	POP	BC
  56E9'   C9             C      	RET
                         C      			;
  56EA'                  C      UC.CVX1B:
  56EA'   1A             C      	LD	A,(DE)	; ASCII hexa (DE) --> A binaer,
  56EB'   CD 56C8'       C      	CALL	UC.CVAXB	;                           DE+1
  56EE'   DC 56F3'       C      	CALL	C,UC.CVXER
  56F1'   13             C      	INC	DE
  56F2'   C9             C      	RET
                         C      			;
  56F3'                  C      UC.CVXER:
  56F3'   EB             C      	EX	DE,HL       ; Datenfehler-Behandlung hexa
  56F4'   CD 4033        C      	CALL	SY.SETCHL      ;         set cursor
  56F7'   CD 5A88'       C          CALL  UR.TAREP  ; <-+     tast.request
  56FA'   77             C          LD    (HL),A    ;   |     write in conv.-area
  56FB'   CD 56C8'       C          CALL  UC.CVAXB  ;   |     conv.in A
  56FE'   38 F7          C          JR    C,$-7     ; --+     on error ...
  5700'   CD 4036        C          CALL	SY.RESC
  5703'   EB             C          EX    DE,HL
  5704'   C9             C          RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      ;                       4 ASCII hexa (DE) --> Adresse (L,H) binaer (HL)
                         C      ;                                                            DE+4, HL+2
                         C      ;
                         C      ;                                       mit Datenfehler-Behandlung
                         C      ;                       -----------------------------------------------
  5705'                  C      UC.CVXA:
  5705'   23             C      	INC	HL
  5706'   CD 56D9'       C      	CALL	UC.CVXB	; benutzt: A, 4 Stack-P.
  5709'   2B             C      	DEC	HL
  570A'   2B             C      	DEC	HL
  570B'   CD 56D9'       C      	CALL	UC.CVXB
  570E'   23             C      	INC	HL
  570F'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      ;                     2 Byte binaer in HL ---> 1...5-stellig dezi (DE),
                         C      ;                                                             DE+1...5
                         C      ;                                  mit Vor-Null-Unterdrueckung
                         C      ;                                                    (nach nicht-dezi),
                         C      ;                                  zu wenig Stellen -->
                         C      ;                                      '*' in der obersten angeg.Stelle
                         C      ;                      ------------------------------------------------
  5710'                  C      UC.CVBD5:
  5710'   3E 05          C      	LD	A,5	; benutzt: A, 7 Stack-P.
  5712'   18 0E          C      	JR	$+16
  5714'                  C      UC.CVBD4:
  5714'   3E 04          C      	LD	A,4
  5716'   18 0A          C      	JR	$+12
  5718'                  C      UC.CVBD3:
  5718'   3E 03          C      	LD	A,3
  571A'   18 06          C      	JR	$+8
  571C'                  C      UC.CVBD2:
  571C'   3E 02          C      	LD	A,2
  571E'   18 02          C      	JR	$+4
  5720'                  C      UC.CVBD1:
  5720'   3E 01          C      	LD	A,1
                         C      			;
  5722'   C5             C      UC.CVBD:	PUSH	BC	; Zeichenzahl in A
  5723'   E5             C      	PUSH	HL
  5724'   47             C      	LD	B,A
  5725'   CD 572D'       C      	CALL	UC.CVBD0
  5728'   10 FB          C      	DJNZ	$-3
  572A'   E1             C      	POP	HL
  572B'   C1             C      	POP	BC
  572C'   C9             C      	RET
                         C      			;
                         C      ;                          Abspaltung B-te Stelle dezi von HL nach (DE)
                         C      ;                                                                  DE+1
                         C      ;                          B-te nicht fuehrende Stelle: '*' nach (DE)
                         C      ;                          --------------------------------------------
  572D'                  C      UC.CVBD0:
  572D'   C5             C      	PUSH	BC	; benutzt: A, 5 Stack-P.
                         C      			; --------
  572E'   7D             C      	LD	A,L
  572F'   F6 30          C      	OR	'0'
'Konvertierungen'	MACRO-80 3.44	09-Dec-81	PAGE	1-14


  5731'   05             C      	DEC	B
  5732'   28 29          C          JR   Z,$+43	  ; -------+
                         C                        ;        |
  5734'   D5             C          PUSH DE       ;        |
  5735'   E5             C          PUSH HL       ; DE := (B-1)-te Zehner-Potenz
  5736'   21 0001        C          LD   HL,1     ;        |
  5739'   CD 566B'       C          CALL UC.HL10N ;        |
  573C'   10 FB          C          DJNZ $-3      ;        |
  573E'   EB             C          EX   DE,HL    ;        |
  573F'   E1             C          POP  HL       ;        |
                         C                        ;        |
  5740'   CD 568B'       C          CALL UC.DIVR  ; A := HL / B-te Zehner-Potenz
  5743'   D1             C          POP  DE       ;        |     HL := Rest
                         C                        ;        |
  5744'   FE 0A          C          CP   10       ; test to decimal
  5746'   38 04          C          JR   C,$+6    ; ---+   |
  5748'   3E 2A          C          LD   A,'*'    ;    |   |
  574A'   18 11          C          JR   $+19     ; -------+
                         C                        ; <--+   |
  574C'   F6 30          C          OR   '0'      ; conv.to decimal
                         C                        ;        |
  574E'   FE 30          C          CP   '0'      ; Vor-Null ?
  5750'   20 0B          C          JR   NZ,$+13  ; -------+
  5752'   1B             C          DEC  DE       ;        |
  5753'   4F             C          LD   C,A      ;        |
  5754'   CD 578A'       C          CALL UC.CVD1B ;        |
  5757'   79             C          LD   A,C      ;        |
  5758'   13             C          INC  DE       ;        |
  5759'   30 02          C          JR   NC,$+4   ;        |
  575B'   3E 20          C          LD   A,' '    ;        |
                         C                        ; <------+
  575D'   12             C      	LD	(DE),A
  575E'   13             C      	INC	DE
  575F'   C1             C      	POP	BC
  5760'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      ;                      Dezi von (DE) bis (-->DE) nicht-dezi
                         C      ;                                                --->      binaer in HL
                         C      ;
                         C      ;                         Fehler:
                         C      ;                         -------
                         C      ;                         Cy, NZ: Zahl zu gross, HL ohne letzte Ziffer
                         C      ;                         Cy, Z:  Leere Zahl (1.Position keine Ziffer),
                         C      ;                                        -->     HL = 0
                         C      ;                      ------------------------------------------------
  5761'                  C      UC.CVDB:
  5761'   26 00          C      	LD	H,0
  5763'   CD 578A'       C      	CALL	UC.CVD1B
  5766'   6F             C      	LD	L,A
  5767'   30 04          C      	JR	NC,$+6
  5769'   AF             C      	XOR	A
  576A'   6F             C      	LD	L,A
  576B'   37             C      	SCF
  576C'   C9             C      	RET		; ---> abend C, Z
                         C      			;
  576D'   13             C      	INC	DE
  576E'   CD 578A'       C      	CALL	UC.CVD1B
  5771'   3F             C      	CCF
  5772'   D0             C      	RET	NC		; ---> normal end
  5773'   D5             C          PUSH  DE
  5774'   F5             C          PUSH  AF
  5775'   CD 5672'       C          CALL  UC.HL10C
  5778'   38 0B          C          JR    C,$+13    ; ----------+
  577A'   F1             C          POP   AF        ;           |
  577B'   85             C          ADD   A,L       ;           |
  577C'   6F             C          LD    L,A       ;           |
  577D'   30 03          C          JR    NC,$+5	; --+       |
  577F'   24             C          INC   H         ;   |       |
  5780'   28 04          C          JR    Z,$+6     ;   |    ---|--+
  5782'   D1             C          POP   DE        ; <-+       |  |
  5783'   18 E8          C          JR    $-22      ;           |  |
                         C                          ;      <----+  !
  5785'   E1             C          POP   HL        ; abend Cy, NZ !
  5786'   25             C          DEC   H         ;              |
  5787'   EB             C          EX    DE,HL     ;        <-----+
  5788'   D1             C          POP   DE
  5789'   C9             C          RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      ;                            Ziffer dezi (DE) ---> binaer nach A, DE+1
                         C      ;                                                  Cy: nicht-dezi
                         C      ;                            ------------------------------------------
'Konvertierungen'	MACRO-80 3.44	09-Dec-81	PAGE	1-15


  578A'                  C      UC.CVD1B:
  578A'   1A             C      	LD	A,(DE)
  578B'   D6 30          C      	SUB	30H
  578D'   D8             C      	RET	C
  578E'   FE 0A          C      	CP	10
  5790'   3F             C      	CCF
  5791'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      ;                    Byte binaer (HL) --> Byte ASCII-Symbol (DE)
                         C      ;                                         (sonst: 7FH )
                         C      ;                                                     HL+1, DE+1
                         C      ;                    --------------------------------------------------
  5792'                  C      UC.CVBC:
  5792'   7E             C      	LD	A,(HL)	; benutzt: A, 0 Stack-P.
  5793'   23             C      	INC	HL	; --------
  5794'   FE 20          C      	CP	20H
  5796'   30 02          C      	JR	NC,$+4
  5798'   3E 7F          C      	LD	A,7FH
  579A'   FE 7F          C      	CP	7FH
  579C'   38 02          C      	JR	C,$+4
  579E'   3E 7F          C      	LD	A,7FH
  57A0'   12             C      	LD	(DE),A
  57A1'   13             C      	INC	DE
  57A2'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      ;                       Byte ASCII-Symbol (DE)   -->   Byte binaer (HL)
                         C      ;                                                      DE+1, HL+1
                         C      ;                       -----------------------------------------------
  57A3'                  C      UC.CVCB:
  57A3'   1A             C      	LD	A,(DE)	; benutzt: A, 0 Stack-P.
  57A4'   13             C      	INC	DE
  57A5'   FE 20          C      	CP	20H
  57A7'   38 05          C      	JR	C,$+7
  57A9'   FE 7E          C      	CP	7EH
  57AB'   30 01          C      	JR	NC,$+3
  57AD'   77             C      	LD	(HL),A
  57AE'   23             C      	INC	HL
  57AF'   C9             C      	RET
                         C      			;
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;      KONVERTIERUNGEN
                         C      ;
                         C      ;----------------------------------------------------------------------
  57B0'                  C      UC.DKONV:
  57B0'   7E             C      	LD	A,(HL)	;DKOI--->ASCII
  57B1'   CD 57C4'       C      	CALL	UC.DK1	;(HL)--->(DE)
  57B4'   12             C      	LD	(DE),A
  57B5'   23             C      	INC	HL
  57B6'   13             C      	INC	DE
  57B7'   10 F7          C      	DJNZ	UC.DKONV
  57B9'   C9             C      	RET
                         C      ;------------------------------------
  57BA'                  C      UC.KONV:
  57BA'   7E             C      	LD	A,(HL)	;ASCII--->DKOI
  57BB'   CD 57CF'       C      	CALL	UC.CKONV	;(HL) --->(DE)
  57BE'   12             C      	LD	(DE),A
  57BF'   23             C      	INC	HL
  57C0'   13             C      	INC	DE
  57C1'   10 F7          C      	DJNZ	UC.KONV
  57C3'   C9             C      	RET
                         C      ;-----------------------------
  57C4'                  C      UC.DK1:
  57C4'   E5             C      	PUSH	HL	;DKOI--->ASCII
  57C5'   D5             C      	PUSH	DE
  57C6'   C5             C      	PUSH	BC
  57C7'   21 57F2'       C      	LD	HL,UC.ASCCO
  57CA'   11 5852'       C      	LD	DE,UC.DKOI
  57CD'   18 09          C      	JR	UC.DK2
  57CF'                  C      UC.CKONV:
  57CF'   E5             C      	PUSH	HL	;ASCII ---> DKOI
  57D0'   D5             C      	PUSH	DE
  57D1'   C5             C      	PUSH	BC
  57D2'   21 5852'       C      	LD	HL,UC.DKOI	;HL:= Anfangsadresse
  57D5'   11 57F2'       C      	LD	DE,UC.ASCCO	;DE:= Anfangsadresse
  57D8'                  C      UC.DK2:
  57D8'   F5             C      	PUSH	AF	;Quellcodebyte retten
  57D9'   AF             C      	XOR	A	;CY = 0
  57DA'   ED 52          C      	SBC	HL,DE	;Tabellendistanz berechnen
  57DC'   2B             C      	DEC	HL
  57DD'   E5             C      	PUSH	HL
'Konvertierungen'	MACRO-80 3.44	09-Dec-81	PAGE	1-16


  57DE'   C1             C      	POP	BC	;BC:= Tabellendistanz - 1
  57DF'   EB             C      	EX	DE,HL	;HL:= Anfangsadresse
  57E0'   F1             C      	POP	AF	;Zeichen wieder herstellen
  57E1'   C5             C      	PUSH	BC	;Tabellendistanz retten
  57E2'   01 0060        C      	LD	BC,UE.COTAL	;BC:= Tabellenlaenge
  57E5'   ED B1          C      	CPIR		;Quellcodebyte suchen
  57E7'   37             C      	SCF		;CY = 1
  57E8'   C1             C      	POP	BC	;Tabellendistanz auskellern
  57E9'   20 03          C      	JR	NZ,UC.KONV2	;---> Quellcodebyte nicht
  57EB'   09             C      	ADD	HL,BC	;Zielcodeadresse berechnen
  57EC'   AF             C      	XOR	A	;CY = 0
  57ED'   7E             C      	LD	A,(HL)	;Zielcodebyte laden
  57EE'                  C      UC.KONV2:
  57EE'   C1             C      	POP	BC
  57EF'   D1             C      	POP	DE
  57F0'   E1             C      	POP	HL
  57F1'   C9             C      	RET
                         C      ;****************************************************************
                         C      ;         ASCII - Codetabelle
                         C      ;****************************************************************
  57F2'                  C      UC.ASCCO:
  57F2'   20 21 22 23    C      	DB	' !"#$%&'
  57F6'   24 25 26       C      
  57F9'   27             C      	DB	27H	;'
  57FA'   28 29 2A 2B    C      	DB	'()*+,-./'
  57FE'   2C 2D 2E 2F    C      
  5802'   30 31 32 33    C      	DB	'0123456789'
  5806'   34 35 36 37    C      
  580A'   38 39          C      
  580C'   3A 3B 3C 3D    C      	DB	':;<=>?@'
  5810'   3E 3F 40       C      
  5813'   41 42 43 44    C      	DB	'ABCDEFGHIJKLMNOPQRSTUVWXYZ'
  5817'   45 46 47 48    C      
  581B'   49 4A 4B 4C    C      
  581F'   4D 4E 4F 50    C      
  5823'   51 52 53 54    C      
  5827'   55 56 57 58    C      
  582B'   59 5A          C      
  582D'   5B 5C 5D 5E    C      	DB	'[\]^_`'
  5831'   5F 60          C      
  5833'   61 62 63 64    C      	DB	'abcdefghijklmnopqrstuvwxyz'
  5837'   65 66 67 68    C      
  583B'   69 6A 6B 6C    C      
  583F'   6D 6E 6F 70    C      
  5843'   71 72 73 74    C      
  5847'   75 76 77 78    C      
  584B'   79 7A          C      
  584D'   7B 7C 7D 7E    C      	DB	'{|}~'
  5851'   7F             C      	DB	7FH	;DEL
                         C      ;***************************************************************
                         C      ;         DKOI - Codetabelle
                         C      ;***************************************************************
  5852'                  C      UC.DKOI:
  5852'   40             C      	DB	40H	;blank
  5853'   4F             C      	DB	4FH	;!
  5854'   7F             C      	DB	7FH	;"
  5855'   7B             C      	DB	7BH	;#
  5856'   5B             C      	DB	5BH	;$
  5857'   6C             C      	DB	6CH	;%
  5858'   50             C      	DB	50H	;&
  5859'   7D             C      	DB	7DH	;'
  585A'   4D             C      	DB	4DH	;(
  585B'   5D             C      	DB	5DH	;)
  585C'   5C             C      	DB	5CH	;*
  585D'   4E             C      	DB	4EH	;+
  585E'   6B             C      	DB	6BH	;,
  585F'   60             C      	DB	60H	;-
  5860'   4B             C      	DB	4BH	;.
  5861'   61             C      	DB	61H	;/
  5862'   F0             C      	DB	0F0H	;0
  5863'   F1             C      	DB	0F1H	;1
  5864'   F2             C      	DB	0F2H	;2
  5865'   F3             C      	DB	0F3H	;3
  5866'   F4             C      	DB	0F4H	;4
  5867'   F5             C      	DB	0F5H	;5
  5868'   F6             C      	DB	0F6H	;6
  5869'   F7             C      	DB	0F7H	;7
  586A'   F8             C      	DB	0F8H	;8
  586B'   F9             C      	DB	0F9H	;9
  586C'   7A             C      	DB	7AH	;:
  586D'   5E             C      	DB	5EH	;;
  586E'   4C             C      	DB	4CH	;<
  586F'   7E             C      	DB	7EH	;=
'Konvertierungen'	MACRO-80 3.44	09-Dec-81	PAGE	1-17


  5870'   6E             C      	DB	6EH	;>
  5871'   6F             C      	DB	6FH	;?
  5872'   7C             C      	DB	7CH	;@
  5873'   C1             C      	DB	0C1H	;A
  5874'   C2             C      	DB	0C2H	;B
  5875'   C3             C      	DB	0C3H	;C
  5876'   C4             C      	DB	0C4H	;D
  5877'   C5             C      	DB	0C5H	;E
  5878'   C6             C      	DB	0C6H	;F
  5879'   C7             C      	DB	0C7H	;G
  587A'   C8             C      	DB	0C8H	;H
  587B'   C9             C      	DB	0C9H	;I
  587C'   D1             C      	DB	0D1H	;J
  587D'   D2             C      	DB	0D2H	;K
  587E'   D3             C      	DB	0D3H	;L
  587F'   D4             C      	DB	0D4H	;M
  5880'   D5             C      	DB	0D5H	;N
  5881'   D6             C      	DB	0D6H	;O
  5882'   D7             C      	DB	0D7H	;P
  5883'   D8             C      	DB	0D8H	;Q
  5884'   D9             C      	DB	0D9H	;R
  5885'   E2             C      	DB	0E2H	;S
  5886'   E3             C      	DB	0E3H	;T
  5887'   E4             C      	DB	0E4H	;U
  5888'   E5             C      	DB	0E5H	;V
  5889'   E6             C      	DB	0E6H	;W
  588A'   E7             C      	DB	0E7H	;X
  588B'   E8             C      	DB	0E8H	;Y
  588C'   E9             C      	DB	0E9H	;Z
  588D'   4A             C      	DB	4AH	;[
  588E'   E0             C      	DB	0E0H	;\
  588F'   5A             C      	DB	5AH	;]
  5890'   5F             C      	DB	5FH	;^
  5891'   6D             C      	DB	6DH	;_
  5892'   79             C      	DB	79H	;`
  5893'   81             C      	DB	81H	;a
  5894'   82             C      	DB	82H	;b
  5895'   83             C      	DB	83H	;c
  5896'   84             C      	DB	84H	;d
  5897'   85             C      	DB	85H	;e
  5898'   86             C      	DB	86H	;f
  5899'   87             C      	DB	87H	;g
  589A'   88             C      	DB	88H	;h
  589B'   89             C      	DB	89H	;i
  589C'   91             C      	DB	91H	;j
  589D'   92             C      	DB	92H	;k
  589E'   93             C      	DB	93H	;l
  589F'   94             C      	DB	94H	;m
  58A0'   95             C      	DB	95H	;n
  58A1'   96             C      	DB	96H	;o
  58A2'   97             C      	DB	97H	;p
  58A3'   98             C      	DB	98H	;q
  58A4'   99             C      	DB	99H	;r
  58A5'   A2             C      	DB	0A2H	;s
  58A6'   A3             C      	DB	0A3H	;t
  58A7'   A4             C      	DB	0A4H	;u
  58A8'   A5             C      	DB	0A5H	;v
  58A9'   A6             C      	DB	0A6H	;w
  58AA'   A7             C      	DB	0A7H	;x
  58AB'   A8             C      	DB	0A8H	;y
  58AC'   A9             C      	DB	0A9H	;z
  58AD'   C0             C      	DB	0C0H	;{
  58AE'   6A             C      	DB	6AH	;|
  58AF'   D0             C      	DB	0D0H	;}
  58B0'   A1             C      	DB	0A1H	;~
  58B1'   FF             C      	DB	0FFH	;DEL
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Komprimierung'
                         C      	PAGE
'Komprimierung'	MACRO-80 3.44	09-Dec-81	PAGE	1-18


                         C      
                         C      ;	PN	CP
                         C      ;**********************************************************************
                         C      ;*       COMPR:    Komprimierung                                      *
                         C      ;*                 EDIT - F/Q-Format   --->  MRES20 - Quelltextformat *
                         C      ;**********************************************************************
                         C      			;
  58B2'                  C      CP.COMPR	EQU	$	; A  Uebergabe/-nahme Zeichen
                         C      			; HL: Status von COMPR
                         C      			; B:  dekr. Tabulator-Zaehler
                         C      			;-------------------------------
                         C      			; OUTA: Einzelzeichen-Ausgabe
                         C      			;         (Zeichen in Reg. A)
                         C      ;----------------------------------------------------------------------
                         C      			;
  58B2'   FE 1E          C      	CP	1EH	; NL ?
  58B4'   28 01          C      	JR	Z,CP.NL
  58B6'   E9             C      	JP	(HL)
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      			; Status "New-Line"
                         C      			;-------------------------------
  58B7'                  C      CP.NL:
  58B7'   CD 5641'       C      	CALL	XY.INCDX	;         Satz-Zaehler + 1
  58BA'   13             C      	DB	19
  58BB'   06 03          C      	LD	B,3	;         noch 3 TAB erlaubt
  58BD'   3E 0A          C      	LD	A,0AH	;         MRES20-NL
  58BF'   18 04          C      	JR	CP.OUTT
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      			; Status "String"
                         C      			;-------------------------------
  58C1'                  C      CP.STRNG:
  58C1'   FE 27          C      	CP	27H	;         Apostroph
  58C3'   20 20          C      	JR	NZ,CP.OUT
                         C      			;
  58C5'                  C      CP.OUTT:
  58C5'   21 58D5'       C      	LD	HL,CP.TEXT	;         --> Status "Text"
  58C8'   18 1B          C      	JR	CP.OUT
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      			; Status "Space"
                         C      			;-------------------------------
  58CA'                  C      CP.SPACE:
  58CA'   FE 20          C      	CP	' '
  58CC'   C8             C      	RET	Z
  58CD'   FE 09          C      	CP	09H	;         Tabulator
  58CF'   C8             C      	RET	Z
  58D0'   21 58D5'       C      	LD	HL,CP.TEXT	;         ---> Status "Text"
  58D3'   18 08          C      	JR	CP.TEXT+8
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      			; Status "Text"
                         C      			;-------------------------------
  58D5'                  C      CP.TEXT:
  58D5'   FE 20          C      	CP	' '
  58D7'   28 2E          C      	JR	Z,CP.TAB
  58D9'   FE 09          C      	CP	09H	;         Tabulator
  58DB'   28 2A          C      	JR	Z,CP.TAB
  58DD'   FE 3B          C      	CP	';'
  58DF'   28 0B          C      	JR	Z,CP.SOKOM
  58E1'   FE 27          C      	CP	27H	;         Apostroph
  58E3'   28 1D          C      	JR	Z,CP.SOSTR
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      			; Status "Kom"
                         C      			;-------------------------------
  58E5'                  C      CP.KOM	EQU	$
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      			; Einzelzeichen-Ausgabe u. Ret.
                         C      			;-------------------------------
  58E5'                  C      CP.OUT:
  58E5'   CD 61E1'       C      	CALL	UK.PUTK
  58E8'   D9             C      	EXX
  58E9'   0B             C      	DEC	BC
  58EA'   D9             C      	EXX
  58EB'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      			; Start "Kommentar"
                         C      			;-------------------------------
'Komprimierung'	MACRO-80 3.44	09-Dec-81	PAGE	1-19


  58EC'                  C      CP.SOKOM:
  58EC'   78             C          LD	A,B	;         0 oder 3 TAB vorher
  58ED'   FE 03          C          CP   3
  58EF'   28 0A          C          JR   Z,$+12
  58F1'   B7             C          OR   A
  58F2'   28 07          C          JR   Z,$+9      ;         ---+
  58F4'   3E 09          C          LD   A,09H      ;         <-+|
  58F6'   CD 58E5'       C          CALL CP.OUT     ;           ||
  58F9'   10 F9          C          DJNZ $-5        ;         --+|
  58FB'   3E 3B          C          LD   A,';'      ;         <--+
  58FD'   21 58E5'       C          LD   HL,CP.KOM
  5900'   18 E3          C          JR   CP.OUT
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      			; Start "String"
                         C      			;-------------------------------
  5902'                  C      CP.SOSTR:
  5902'   21 58C1'       C      	LD	HL,CP.STRNG
  5905'   18 DE          C      	JR	CP.OUT
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      			; Tabulator-Behandlung
                         C      			;-------------------------------
  5907'                  C      CP.TAB:
  5907'   78             C      	LD	A,B
  5908'   B7             C      	OR	A
  5909'   3E 20          C      	LD	A,' '
  590B'   28 D8          C      	JR	Z,CP.OUT
  590D'   05             C      	DEC	B
  590E'   3E 09          C      	LD	A,09H	;         Tabulator MRES20
  5910'   21 58CA'       C      	LD	HL,CP.SPACE
  5913'   18 D0          C      	JR	CP.OUT
                         C      			;
                         C      ;**********************************************************************
                         C      			;
  5915'                  C      CP.INIT:
  5915'   06 03          C      	LD	B,3	; Initialisierung COMPR
  5917'   21 58D5'       C      	LD	HL,CP.TEXT
  591A'   C9             C      	RET
                         C      			;
                         C      ;**********************************************************************
                         C      ;	END
                         C      	TITLE	'Dekomprimierung'
                         C      	PAGE
'Dekomprimierung'	MACRO-80 3.44	09-Dec-81	PAGE	1-20


                         C      
                         C      ;	PN	DC
                         C      ;**********************************************************************
                         C      ;*       DCMPR:    Dekomprimierung                                    *
                         C      ;*                 MRES20-Quelltexte   --->   EDIT - Format F         *
                         C      ;**********************************************************************
                         C      			;
  591B'                  C      DC.DCMPR	EQU	$
                         C      			; A:  Uebergabe/-nahme Zeichen
                         C      			; HL: Status-Register DCMPR
                         C      			; B:  Position (Spalte)
                         C      			;-------------------------------
                         C      			; INA: Einzelzeichen-Eingabe
                         C      			;      nach Reg. A
                         C      ;        --------------------------------------------------------------
  591B'   04             C      	INC	B	;         Position + 1
  591C'   E9             C      	JP	(HL)
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      			; Status "Neue Zeile"
                         C      			;-------------------------------
  591D'                  C      DC.NL:
  591D'   CD 5641'       C      	CALL	XY.INCDX	;         Satzzaehler + 1
  5920'   13             C      	DB	19
  5921'   3E 1E          C      	LD	A,1EH	;         EDIT-New-Line
  5923'   06 01          C      	LD	B,1	;         Pos.=1
  5925'   21 5929'       C      	LD	HL,DC.TEXT	;         Status "TEXT"
  5928'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      			; Status "Text"
                         C      			;-------------------------------
  5929'                  C      DC.TEXT:
  5929'   CD 613D'       C      	CALL	UK.GETK	;         Einzelzeichen-Eingabe
  592C'   B7             C      	OR	A
  592D'   C8             C      	RET	Z
  592E'   FE 0A          C      	CP	0AH	;         NL ?
  5930'   28 EB          C      	JR	Z,DC.NL
  5932'   FE 09          C      	CP	09H	;         TAB ?
  5934'   28 01          C      	JR	Z,DC.TAB
  5936'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      			; Tabulator-Behandlung
                         C      			;-------------------------------
  5937'                  C      DC.TAB:
  5937'   78             C      	LD	A,B
  5938'   FE 28          C      	CP	40
  593A'   D0             C      	RET	NC
  593B'   21 5941'       C      	LD	HL,DC.SPACE	;         ---> Status "Space"
  593E'   3E 20          C      	LD	A,' '	;         anstelle TAB Space
  5940'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      			; Status "Space"
                         C      			;-------------------------------
  5941'                  C      DC.SPACE:
  5941'   78             C      	LD	A,B
  5942'   FE 0B          C      	CP	10+1
  5944'   28 0B          C      	JR	Z,DC.EOSPC
  5946'   FE 11          C      	CP	16+1
  5948'   28 07          C      	JR	Z,DC.EOSPC
  594A'   FE 24          C      	CP	35+1
  594C'   28 03          C      	JR	Z,DC.EOSPC
  594E'   3E 20          C      	LD	A,' '
  5950'   C9             C      	RET
                         C      			;
  5951'                  C      DC.EOSPC:
  5951'   21 5929'       C      	LD	HL,DC.TEXT	; TAB-Position erreicht
  5954'   18 D3          C      	JR	DC.TEXT
                         C      			;
                         C      			;
                         C      ;**********************************************************************
  5956'                  C      DC.INIT:
  5956'   21 5929'       C      	LD	HL,DC.TEXT	; Initialisierung
  5959'   06 01          C      	LD	B,1
  595B'   C9             C      	RET
                         C      			;
                         C      ;**********************************************************************
                         C      ;	END
                         C      	TITLE 'Routinen fuer Monitor UND Tastatur'
                         C      	PAGE
'Routinen fuer Monitor UND Tastatur'	MACRO-80 3.44	09-Dec-81	PAGE	1-21


                         C      
  595C'                  C      UR.MIMO:
  595C'   D5             C      	PUSH	DE	;Register DE, BC retten
  595D'   C5             C      	PUSH	BC
  595E'   46             C      	LD	B,(HL)	;Anzahl einzugebender Zeichen
  595F'   23             C      	INC	HL
  5960'   4E             C      	LD	C,(HL)	;Laenge der Zeichenkette
  5961'   23             C      	INC	HL
  5962'   5E             C      	LD	E,(HL)	;Zeichenschluessel
  5963'   23             C      	INC	HL
  5964'   3A 2B00'       C      	LD	A,(UB.ZN)	;Zeilennummer
  5967'   57             C      	LD	D,A	;D:= Zeilennummer
  5968'   AF             C      	XOR	A
  5969'   B9             C      	CP	C
  596A'   28 0C          C      	JR	Z,UR.MIMO1	;Anzeige entfaellt
  596C'   D5             C      	PUSH	DE
  596D'   CD 599E'       C      	CALL	UR.DSPZK	;Anzeige
  5970'                  C      UR.MIMO2:
  5970'   D1             C      	POP	DE
  5971'   CD 59AB'       C      	CALL	UR.ZINP	;Zeicheneingabe ueber Tastatur
  5974'   C1             C      	POP	BC
  5975'   D1             C      	POP	DE
  5976'   18 07          C      	JR	UR.MIMO3
  5978'                  C      UR.MIMO1:
  5978'   D5             C      	PUSH	DE
  5979'   CD 598E'       C      	CALL	UR.BBSAD	;BWS - Adresse berechnen
  597C'   EB             C      	EX	DE,HL	;HL:= akt. Bildschirmposition
  597D'   18 F1          C      	JR	UR.MIMO2
  597F'                  C      UR.MIMO3:
  597F'   F5             C      	PUSH	AF
  5980'   3A 2B00'       C      	LD	A,(UB.ZN)
  5983'   3C             C      	INC	A
  5984'   FE 18          C      	CP	24
  5986'   CC 5A8E'       C      	CALL	Z,UR.BILRO	;Zeile 24 ---> Bild rollen
  5989'   32 2B00'       C      	LD	(UB.ZN),A
  598C'   F1             C      	POP	AF
  598D'   C9             C      	RET
  598E'                  C      UR.BBSAD:
  598E'   E5             C      	PUSH	HL	;Berechnung der BWS-Adresse
  598F'   C5             C      	PUSH	BC	;IN:    D...Zeilennummer
  5990'   21 2FB0        C      	LD	HL,UE.BWSA-80	;OUT:   DE..BWS-Adresse
  5993'   01 0050        C      	LD	BC,80	;BC:= Zeichen/Zeile
  5996'                  C      UR.BBSA1:
  5996'   09             C      	ADD	HL,BC
  5997'   15             C      	DEC	D
  5998'   20 FC          C      	JR	NZ,UR.BBSA1
  599A'   EB             C      	EX	DE,HL
  599B'   C1             C      	POP	BC
  599C'   E1             C      	POP	HL
  599D'   C9             C      	RET
  599E'                  C      UR.DSPZK:
  599E'   D5             C      	PUSH	DE	;Anzeige
  599F'   C5             C      	PUSH	BC	;IN   HL...Anfangsadresse ZK
  59A0'   CD 598E'       C      	CALL	UR.BBSAD	;      D...Zeilennummer
  59A3'   06 00          C      	LD	B,0	;      C...Zeichenkettenlaenge
  59A5'   ED B0          C      	LDIR		;OUT  HL...akt. BWS-Adresse
  59A7'   EB             C      	EX	DE,HL
  59A8'   C1             C      	POP	BC
  59A9'   D1             C      	POP	DE
  59AA'   C9             C      	RET
  59AB'                  C      UR.ZINP:
  59AB'   E5             C      	PUSH	HL	;Zeicheneingabe ueber Tastatur
  59AC'   AF             C      	XOR	A	;IN    B...Zeichenanzahl (max.)
  59AD'   50             C      	LD	D,B	;     HL...akt. Adresse
  59AE'   B8             C      	CP	B	;      E...Zeichenschluessel
  59AF'   28 3D          C      	JR	Z,UR.RET0	;keine Zeicheneingabe
  59B1'                  C      UR.ZINP1:
  59B1'   CD 4033        C      	CALL	SY.SETCHL	;Kursor setzen
  59B4'                  C      UR.ZINP2:
  59B4'   CD 5A88'       C      	CALL	UR.TAREP	;Tastaturabfrage
  59B7'   CD 59F8'       C      	CALL	UR.TCL	; <---
  59BA'   CD 5A0D'       C      	CALL	UR.TCR	; --->
  59BD'   CD 5A20'       C      	CALL	UR.TSYS	; SYS
  59C0'   CD 5A28'       C      	CALL	UR.TQUIT	; POS.QUIT
  59C3'   CD 5A30'       C      	CALL	UR.ZKONT	;Zeichenkontrolle
  59C6'   CD 4036        C      	CALL	SY.RESC	;Kursor loeschen
  59C9'   77             C      	LD	(HL),A	;Zeichen anzeigen
  59CA'   23             C      	INC	HL	;akt. Adresse erhoehen
  59CB'   10 E4          C      	DJNZ	UR.ZINP1	;B > 0, naechstes Zeichen
  59CD'   CD 4033        C      	CALL	SY.SETCHL	;Kursor setzen
  59D0'                  C      UR.ZINP5:
  59D0'   CD 5A88'       C      	CALL	UR.TAREP
'Routinen fuer Monitor UND Tastatur'	MACRO-80 3.44	09-Dec-81	PAGE	1-22


  59D3'   FE F7          C      	CP	UE.TACL
  59D5'   CC 59F1'       C      	CALL	Z,UR.ZINP7
  59D8'   FE 1E          C      	CP	UE.TAQUI
  59DA'   28 06          C      	JR	Z,UR.ZINP3	;---> POS.QUIT
  59DC'   FE CD          C      	CP	UE.TASYS
  59DE'   28 08          C      	JR	Z,UR.ZINP4	;---> SYS
  59E0'   18 EE          C      	JR	UR.ZINP5
  59E2'                  C      UR.ZINP3:
  59E2'   CD 4036        C      	CALL	SY.RESC	;Kursor loeschen
  59E5'   E1             C      	POP	HL	;BWS - Adresse auskellern
  59E6'   AF             C      	XOR	A	;CY:= 0
  59E7'   C9             C      	RET
  59E8'                  C      UR.ZINP4:
  59E8'   CD 4036        C      	CALL	SY.RESC	;Kursor loeschen
  59EB'   E1             C      	POP	HL
  59EC'   37             C      	SCF		;CY:= 1
  59ED'   C9             C      	RET
  59EE'                  C      UR.RET0:
  59EE'   E1             C      	POP	HL	;keine Zeicheneingabe
  59EF'   AF             C      	XOR	A
  59F0'   C9             C      	RET
  59F1'                  C      UR.ZINP7:
  59F1'   CD 59F8'       C      	CALL	UR.TCL
  59F4'   33             C      	INC	SP
  59F5'   33             C      	INC	SP
  59F6'   18 BC          C      	JR	UR.ZINP2
  59F8'                  C      UR.TCL:
  59F8'   FE F7          C      	CP	UE.TACL	;   <---
  59FA'   C0             C      	RET	NZ		;Taste nicht gedrueckt
  59FB'   F5             C      	PUSH	AF	;Tastencode retten
  59FC'   04             C      	INC	B
  59FD'   7A             C      	LD	A,D
  59FE'   B8             C      	CP	B
  59FF'   38 09          C      	JR	C,UR.TCLN	;Linksbewegung nicht zulaessig
  5A01'   CD 4036        C      	CALL	SY.RESC	;Kursor loeschen
  5A04'   2B             C      	DEC	HL	;BWS - Adresse decrementieren
  5A05'   CD 4033        C      	CALL	SY.SETCHL	;Kursor setzen
  5A08'   F1             C      	POP	AF	;Code auskellern
  5A09'   C9             C      	RET
  5A0A'                  C      UR.TCLN:
  5A0A'   05             C      	DEC	B
  5A0B'   F1             C      	POP	AF
  5A0C'   C9             C      	RET
  5A0D'                  C      UR.TCR:
  5A0D'   FE F9          C      	CP	UE.TACR	;   --->
  5A0F'   C0             C      	RET	NZ
  5A10'   F5             C      	PUSH	AF
  5A11'   78             C      	LD	A,B
  5A12'   FE 02          C      	CP	2
  5A14'   38 08          C      	JR	C,UR.TCRN
  5A16'   05             C      	DEC	B
  5A17'   CD 4036        C      	CALL	SY.RESC
  5A1A'   23             C      	INC	HL
  5A1B'   CD 4033        C      	CALL	SY.SETCHL
  5A1E'                  C      UR.TCRN:
  5A1E'   F1             C      	POP	AF
  5A1F'   C9             C      	RET
  5A20'                  C      UR.TSYS:
  5A20'   FE CD          C      	CP	UE.TASYS	; SYS-Taste
  5A22'   C0             C      	RET	NZ
  5A23'   33             C      	INC	SP
  5A24'   33             C      	INC	SP	;Returnadresse uebergehen
  5A25'   C3 59E8'       C      	JP	UR.ZINP4
  5A28'                  C      UR.TQUIT:
  5A28'   FE 1E          C      	CP	UE.TAQUI	; POS.QUIT
  5A2A'   C0             C      	RET	NZ
  5A2B'   33             C      	INC	SP
  5A2C'   33             C      	INC	SP
  5A2D'   C3 59E2'       C      	JP	UR.ZINP3
  5A30'                  C      UR.ZKONT:
  5A30'   FE 7F          C      	CP	7FH
  5A32'   30 22          C      	JR	NC,UR.ZKON1
  5A34'   CB 7B          C      	BIT	7,E	;Zeichenschluesselauswertung
  5A36'   C0             C      	RET	NZ		;Bit 7 = L, alle Tasten erlaubt
  5A37'   FE 20          C      	CP	20H
  5A39'   C8             C      	RET	Z		;Leertaste
  5A3A'   CB 6B          C      	BIT	5,E
  5A3C'   37             C      	SCF
  5A3D'   C4 5A5B'       C      	CALL	NZ,UR.ALPHA
  5A40'   D0             C      	RET	NC		;Bit 5 = L, nur Buchstaben
  5A41'   CB 63          C      	BIT	4,E
  5A43'   37             C      	SCF
  5A44'   C4 5A66'       C      	CALL	NZ,UR.NUM
'Routinen fuer Monitor UND Tastatur'	MACRO-80 3.44	09-Dec-81	PAGE	1-23


  5A47'   D0             C      	RET	NC		;Bit 4 = L, nur Ziffern
  5A48'   CB 73          C      	BIT	6,E
  5A4A'   37             C      	SCF
  5A4B'   C4 5A6F'       C      	CALL	NZ,UR.ALPNU
  5A4E'   D0             C      	RET	NC		;Bit 6 = L, Buchstaben und
                         C      			;            Ziffern
  5A4F'   CB 5B          C      	BIT	3,E
  5A51'   37             C      	SCF
  5A52'   C4 5A79'       C      	CALL	NZ,UR.HEXAZ
  5A55'   D0             C      	RET	NC		;BIT 3 = L ,HEXAZEICHEN
  5A56'                  C      UR.ZKON1:
  5A56'   33             C      	INC	SP
  5A57'   33             C      	INC	SP
  5A58'   C3 59B4'       C      	JP	UR.ZINP2	;unerlaubter Tastencode
  5A5B'                  C      UR.ALPHA:
  5A5B'   FE 41          C      	CP	41H
  5A5D'   D8             C      	RET	C
  5A5E'   FE 5B          C      	CP	5BH
  5A60'   38 02          C      	JR	C,UR.ALPH1
  5A62'   37             C      	SCF
  5A63'   C9             C      	RET
  5A64'                  C      UR.ALPH1:
  5A64'   3F             C      	CCF
  5A65'   C9             C      	RET
  5A66'                  C      UR.NUM:
  5A66'   FE 30          C      	CP	30H
  5A68'   D8             C      	RET	C
  5A69'   FE 3A          C      	CP	3AH
  5A6B'   38 F7          C      	JR	C,UR.ALPH1
  5A6D'   37             C      	SCF
  5A6E'   C9             C      	RET
  5A6F'                  C      UR.ALPNU:
  5A6F'   CD 5A5B'       C      	CALL	UR.ALPHA
  5A72'   D0             C      	RET	NC
  5A73'   CD 5A66'       C      	CALL	UR.NUM
  5A76'   D0             C      	RET	NC
  5A77'   37             C      	SCF
  5A78'   C9             C      	RET
  5A79'                  C      UR.HEXAZ:
  5A79'   CD 5A66'       C      	CALL	UR.NUM
  5A7C'   D0             C      	RET	NC
  5A7D'   FE 41          C      	CP	'A'
  5A7F'   D8             C      	RET	C
  5A80'   FE 47          C      	CP	'G'
  5A82'   38 02          C      	JR	C,UR.HEXZ1
  5A84'   37             C      	SCF
  5A85'   C9             C      	RET
  5A86'                  C      UR.HEXZ1:
  5A86'   3F             C      	CCF
  5A87'   C9             C      	RET
                         C      
  5A88'                  C      UR.TAREP:
  5A88'   CD 4026        C      	CALL	TA.ABFR1	;TASTATURROUTINE FUER ATS
  5A8B'   28 FB          C      	JR	Z,$-3	;ES LIEGT KEIN ZEICHEN AN
  5A8D'   C9             C      	RET
                         C      
  5A8E'                  C      UR.BILRO:
  5A8E'   C5             C      	PUSH	BC
  5A8F'   D5             C      	PUSH	DE
  5A90'   E5             C      	PUSH	HL
  5A91'   01 03C0        C      	LD	BC,960
  5A94'   11 3370        C      	LD	DE,UE.BWSA+880
  5A97'   21 33C0        C      	LD	HL,UE.BWSA+960
  5A9A'   ED B0          C      	LDIR
  5A9C'   3E 20          C      	LD	A,20H	;letzte Zeile loeschen
  5A9E'   06 50          C      	LD	B,80
  5AA0'                  C      UR.BILR1:
  5AA0'   12             C      	LD	(DE),A
  5AA1'   10 FD          C      	DJNZ	UR.BILR1
  5AA3'   E1             C      	POP	HL
  5AA4'   AF             C      	XOR	A
  5AA5'   01 0050        C      	LD	BC,80
  5AA8'   ED 42          C      	SBC	HL,BC	;aktuelle BWS-Adresse nach  ROLL
  5AAA'   3A 2B00'       C      	LD	A,(UB.ZN)
  5AAD'   D1             C      	POP	DE
  5AAE'   C1             C      	POP	BC
  5AAF'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                                ;
                                ;	INCLUDE K1.MAC	;BAMOS/Emulator  ---  Kassettenmagnetband
                                ;	INCLUDE	KR.MAC	;Kassettengrundroutinen
                                ;	INCLUDE	UF.MAC	;Fehleranzeige und Behandlung
'Routinen fuer Monitor UND Tastatur'	MACRO-80 3.44	09-Dec-81	PAGE	1-24


                                ;	INCLUDE	UA.MAC	;Ausschriften
                                ;	INCLUDE UR.MAC	;Routinen fuer Kassette
                                ;	INCLUDE	UK.MAC	;Einzelzeicheneingabe fuer KMBG
                         C      	INCLUDE K2.MAC	;BAMOS/Emulator  ---  Kassettenmagnetband
                         C      	TITLE 'BAMOS/Emulator  ---  Kassettenmagnetband'
                         C      	PAGE
'BAMOS/Emulator  ---  Kassettenmagnetband'	MACRO-80 3.44	09-Dec-81	PAGE	1-25


                         C      
                         C      ;****************************************************************
                         C      ;*               BAMOS/Emulator  ---  Kassettenmagnetband       *
                         C      ;* OS - Version  -----------------------------------------------*
                         C      ;*               Programmierer: Marcus Herbote                  *
                         C      ;* V 1 . 2       -----------------------------------------------*
                         C      ;*               Stand        : 18.November 2022                *
                         C      ;****************************************************************
                         C      
                         C      ;****************************************************************
                         C      ;*               BAMOS/Robotron         Stand: 01.Januar 1981   *
                         C      ;*               -----------------------------------------------*
                         C      ;*               Geraetebedienroutine fuer Kassettenmagnetband  *
                         C      ;*               Anschluss von zwei Laufwerken K5200            *
                         C      ;*               an einer AKB K5020                             *
                         C      ;*               -----------------------------------------------*
                         C      ;*               E/A-Tabelle                                    *
                         C      ;*               Byte -2   HS-Bereich                           *
                         C      ;*               Byte -1   laenge der Daten im Puffer           *
                         C      ;*                         1, 10H, 20H, 80H                     *
                         C      ;*               -----------------------------------------------*
                         C      ;*               Byte  0   Status                               *
                         C      ;*               Byte  1   Fehlerschluessel                     *
                         C      ;*               Byte  2   Basisadresse der AKB                 *
                         C      ;*               Byte  3   Subadresse                           *
                         C      ;*               Byte  4   Kommando                             *
                         C      ;*               Byte  5   L-Teil Adresse Eintrittspunkt        *
                         C      ;*               Byte  6   H-Teil Adresse Eintrittspunkt        *
                         C      ;*               Byte  7   L-Teil Blockadresse                  *
                         C      ;*               Byte  8   H-Teil Blockadresse                  *
                         C      ;*               Byte  9   H-Teil Blocklaenge (Bit 15...Bit 8)  *
                         C      ;*               Byte 10   L-Teil Blocklaenge (Bit  7...Bit 0)  *
                         C      ;*                         n      bei suchen Bandmarke          *
                         C      ;*               Byte 11   Anzahl Lese-/Schreib wiederholen     *
                         C      ;*               Byte 12   Anzahl Blocklueckenverlaengerungen   *
                         C      ;****************************************************************
                         C      ;*               Bytes fuer die Uebergabe an den Z80-Emulator   *
                         C      ;*               -----------------------------------------------*
                         C      ;*               Byte 28 1 0F0H  Startbyte                      *
                         C      ;*               Byte 29 2       Kommando                       *
                         C      ;*               Byte 30 3       Subadresse                     *
                         C      ;*               Byte 31 4       Anzahl BM  bei 71, 75          *
                         C      ;*               Byte 31 4       'B'        bei 51              *
                         C      ;*               Byte 31 4       'S'        bei 61              *
                         C      ;*               Byte 31 4       HS-Bereich bei 02              *
                         C      ;*               Byte 31 4       Laenge     bei 08              *
                         C      ;*               Byte 31 4 0FFH             bei 31,41,21,11,15  *
                         C      ;*               Byte 32 5       H(Puffer)  bei 02              *
                         C      ;*               Byte 32 5       HS-Bereich bei 08              *
                         C      ;*               Byte 32 5 0FFH             bei 51,61,71,75     *
                         C      ;*               Byte 33 6       L(Puffer)  bei 02              *
                         C      ;*               Byte 33 6       H(Puffer)  bei 08              *
                         C      ;*               Byte 34 7       L(Puffer)  bei 08              *
                         C      ;*               Byte 34 7 0FFH             bei 02              *
                         C      ;*               Byte 35 8 0FFH             bei 08              *
                         C      ;****************************************************************
                         C      ;*               Kommandos:                                     *
                         C      ;*                 Hex   Kommando                               *
                         C      ;*                 02    naechsten Record einlesen              *
                         C      ;*                 08    naechsten Record schreiben             *
                         C      ;*                 11    einen Block vorsetzen                  *
                         C      ;*                 15    einen Block ruecksetzen                *
                         C      ;*                 21    umspulen                               *
                         C      ;*                 31    reservieren ein                        *
                         C      ;*                 41    reservieren aus                        *
                         C      ;*                 51    schreiben einer Bandmarke              *
                         C      ;*                 61    schreiben Schlussluecke                *
                         C      ;*                 71    suche n-te Bandmarke vorwaerts         *
                         C      ;*                 75    suche n-te Bandmarke rueckwaerts       *
                         C      ;****************************************************************
                         C      	PAGE
'BAMOS/Emulator  ---  Kassettenmagnetband'	MACRO-80 3.44	09-Dec-81	PAGE	1-26


                         C      
                         C      ;****************************************************************
                         C      ;*               Status                                         *
                         C      ;*               Bit 0     0 Geraet frei                        *
                         C      ;*                         1 Geraet besetzt                     *
                         C      ;*               Bit 1     0                                    *
                         C      ;*                         1 Datentraegerende                   *
                         C      ;*               Bit 2     0 Aufzeichnen erlaubt                *
                         C      ;*                         1 Aufzeichnen verboten               *
                         C      ;*               Bit 3     0 Kassettenseite A                   *
                         C      ;*                         1 Kassettenseite B                   *
                         C      ;*               Bit 4     0 Geraet       bereit                *
                         C      ;*                         1 Geraet nicht bereit                *
                         C      ;*               Bit 5     0 Geraet nicht reserviert            *
                         C      ;*                         1 Geraet       reserviert            *
                         C      ;*               Bit 6     0 Aufzeichnungsverf.  38 CM*S**-1    *
                         C      ;*                         1 Aufzeichnungsverf.  19 CM*S**-1    *
                         C      ;*               Bit 7     0 Kommando fehlerfrei ausgefuehrt    *
                         C      ;*                         1 Fehler (siehe Fehlerschluessel)    *
                         C      ;*               -----------------------------------------------*
                         C      ;*               Fehlerschluessel                               *
                         C      ;*                 Hex   Fehler                                 *
                         C      ;*                 10    falsches Kommando                      *
                         C      ;*                 11    angewaehltes Geraet nicht reserviert   *
                         C      ;*                 12    Subadresse falsch                      *
                         C      ;*                 13    Pufferl. kleiner 12 oder groesser 256  *
                         C      ;*                 14    Ende der Aufzeichnungen auf dieser     *
                         C      ;*                       Kassettenseite (Lesen)                 *
                         C      ;*                 15    angewaehltes Geraet besetzt            *
                         C      ;*                 16    Ende/Anfang der Aufzeichnungen         *
                         C      ;*                       (Bandmarke suchen)                     *
                         C      ;*                 17    gelesener Block laenger 260 Byte       *
                         C      ;*                 18    Bandmarke nicht gefunden               *
                         C      ;*                 19    Aufzeichnen verboten                   *
                         C      ;*                       (mit Kommando: Aufzeichnen)            *
                         C      ;*               -----------------------------------------------*
                         C      ;*               nachfolgende Codes nicht bei DEG2000-Emulator  *
                         C      ;*                 21    Fehler nach festgelegter Anzahl        *
                         C      ;*                       Lesewiederholungen                     *
                         C      ;*                 22    Fehler nach festgelegter Anzahl        *
                         C      ;*                       Schreibwiederholungen                  *
                         C      ;*                 23    kein Echosignal vom Eingabekanal       *
                         C      ;*                       bei  RAW                               *
                         C      ;****************************************************************
                         C      ;*               Hinweise zur Arbeit mit der Geraetebedienr.    *
                         C      ;*                - E/A-Tabelle laden (Basisadresse AKB)        *
                         C      ;*                - Adresse E/A-Tabelle in IX laden             *
                         C      ;*                - laden Schluessel fuer Kommando , Subadresse *
                         C      ;*                    Adresse Eintrittspunkt                    *
                         C      ;*                - Aufruf Geraetebedienroutine immer mit       *
                         C      ;*                    CALL   KR.BRKMB                           *
                         C      ;*                - wird keine Parallelarbeit mit anderen       *
                         C      ;*                  Programmen gewuenscht , kann wie in         *
                         C      ;*                  folgendem Beispiel verfahren werden:        *
                         C      ;*                        ...                                   *
                         C      ;*                        CALL KR.BRKMB ;Aufruf                 *
                         C      ;*                  MARKE:HALT                                  *
                         C      ;*                        JR   MARKE-#                          *
                         C      ;*                  ADREP:............  ;Adresse Eintrittspunkt *
                         C      ;*                        ...                                   *
                         C      ;*                - bei Rueckkehr der Bedienroutine zum Ein-    *
                         C      ;*                  trittspunkt ist die Adresse des folgenden   *
                         C      ;*                  Befehls , bei dem der letzte Interrupt      *
                         C      ;*                  angenommen wurde , noch im SP .             *
                         C      ;*                  Wird , wie im obigen Beispiel , diese       *
                         C      ;*                  Adresse nicht mehr benoetigt , so ist der   *
                         C      ;*                  SP  um 2 zu erhoehen.                       *
                         C      ;****************************************************************
                         C      	TITLE	'Steuerteil Geraetebedienroutine'
                         C      	PAGE
'Steuerteil Geraetebedienroutine'	MACRO-80 3.44	09-Dec-81	PAGE	1-27


                         C      
                         C      ;****************************************************************
                         C      ;*               Steuerteil der Geraetebedienroutine            *
                         C      ;****************************************************************
  5AB0'                  C      K1.BRKMB:
  5AB0'   F3             C          DI
  5AB1'   CD 5B9A'       C          CALL    RRET
                         C      
                         C      ;****************************************************************
                         C      ;*               Analyse Kommando                               *
                         C      ;****************************************************************
  5AB4'   DD 7E 04       C          LD  A,(IX+4)
  5AB7'   FE 02          C          CP  002H    ;naechsten Record einlesen
  5AB9'   CA 5B4A'       C          JP  Z,STT02
  5ABC'   FE 08          C          CP  008H    ;naechsten Record schreiben
  5ABE'   CA 5B68'       C          JP  Z,STT08
  5AC1'   FE 11          C          CP  011H    ;einen Block vorsetzen
  5AC3'   CA 5B22'       C          JP  Z,STT11
  5AC6'   FE 15          C          CP  015H    ;einen Block ruecksetzen
  5AC8'   CA 5B22'       C          JP  Z,STT15
  5ACB'   FE 21          C          CP  021H    ;umspulen
  5ACD'   CA 5B22'       C          JP  Z,STT21
  5AD0'   FE 31          C          CP  031H    ;reservieren ein
  5AD2'   CA 5B22'       C          JP  Z,STT31
  5AD5'   FE 41          C          CP  041H    ;reservieren aus
  5AD7'   CA 5B22'       C          JP  Z,STT41
  5ADA'   FE 51          C          CP  051H    ;schreiben einer Bandmarke
  5ADC'   CA 5B2E'       C          JP  Z,STT51
  5ADF'   FE 61          C          CP  061H    ;schreiben Schlussluecke
  5AE1'   CA 5B32'       C          JP  Z,STT61
  5AE4'   FE 71          C          CP  071H    ;suche n-te Bandmarke vorwaerts
  5AE6'   CA 5B36'       C          JP  Z,STT71
  5AE9'   FE 75          C          CP  075H    ;suche n-te Bandmarke rueckwaerts
  5AEB'   CA 5B36'       C          JP  Z,STT75
  5AEE'   C3 5B96'       C          JP  STF07   ;falsches Kommando
                         C      
                         C      ;****************************************************************
                         C      ;*               Kernroutine MB                                 *
                         C      ;*               -----------------------------------------------*
                         C      ;*               Schnittstelle zum DEG2000 - Emulator           *
                         C      ;****************************************************************
  5AF1'                  C      K1.KERN:
  5AF1'   DD 36 1C F0    C          LD  (IX+28),0F0H
  5AF5'   DD 7E 04       C          LD  A,(IX+4)    ;Kommando
  5AF8'   DD 77 1D       C          LD  (IX+29),A
  5AFB'   DD 7E 03       C          LD  A,(IX+3)    ;Subadresse
  5AFE'   DD 77 1E       C          LD  (IX+30),A
                         C      
  5B01'   DD 4E 02       C          LD  C,(IX+2)    ;Basisadresse der AKB
  5B04'   DD E5          C          PUSH    IX
  5B06'   E1             C          POP HL
  5B07'   11 001C        C          LD  DE,28
  5B0A'   19             C          ADD  HL,DE
  5B0B'   ED B3          C          OTIR            ;KM - Routine aufrufen
  5B0D'   DD E5          C          PUSH    IX
  5B0F'   E1             C          POP HL
  5B10'   2B             C          DEC HL
  5B11'   2B             C          DEC HL
  5B12'   06 04          C          LD  B,4
  5B14'   ED B2          C          INIR            ;Status und Fehler holen
  5B16'   2B             C          DEC HL          ;Laenge der Daten im Puffer holen
  5B17'   2B             C          DEC HL
  5B18'   2B             C          DEC HL
  5B19'   DD 36 09 00    C          LD  (IX+9),0
  5B1D'   7E             C          LD  A,(HL)
  5B1E'   DD 77 0A       C          LD  (IX+10),A
  5B21'   C9             C          RET
                         C          TITLE   '4-/5-Byte IO-Kommandos'
                         C          PAGE
'4-/5-Byte IO-Kommandos'	MACRO-80 3.44	09-Dec-81	PAGE	1-28


                         C      
                         C      ;****************************************************************
                         C      ;*               reservieren ein / aus                          *
                         C      ;****************************************************************
  5B22'                  C      STT31:
  5B22'                  C      STT41:
                         C      ;****************************************************************
                         C      ;*               umspulen                                       *
                         C      ;****************************************************************
  5B22'                  C      STT21:
                         C      ;****************************************************************
                         C      ;*               vor-/ruecksetzen um einen Block                *
                         C      ;****************************************************************
  5B22'                  C      STT11:
  5B22'                  C      STT15:
  5B22'   DD 36 1F FF    C          LD  (IX+31),0FFH
                         C      
  5B26'   06 04          C          LD  B,4
  5B28'   CD 5AF1'       C          CALL K1.KERN
  5B2B'   C3 5BA7'       C          JP	KOMED	;Kommandoende
                         C      
                         C      ;****************************************************************
                         C      ;*               schreiben einer Bandmarke                      *
                         C      ;****************************************************************
  5B2E'                  C      STT51:
  5B2E'   3E 42          C          LD  A,'B'
  5B30'   18 09          C          JR  STT5
                         C      ;****************************************************************
                         C      ;*               schreiben einer Schlussluecke                  *
                         C      ;****************************************************************
  5B32'                  C      STT61:
  5B32'   3E 53          C          LD  A,'S'
  5B34'   18 05          C          JR  STT5
                         C      ;****************************************************************
                         C      ;*               suche Bandmarke vorwaerts / rueckwaerts        *
                         C      ;****************************************************************
  5B36'                  C      STT71:
  5B36'                  C      STT75:
  5B36'   DD 7E 0A       C          LD  A,(IX+10)
  5B39'   18 00          C          JR  STT5
  5B3B'                  C      STT5:
  5B3B'   DD 77 1F       C          LD  (IX+31),A
  5B3E'   DD 36 20 FF    C          LD  (IX+32),0FFH
                         C      
  5B42'   06 05          C          LD  B,5
  5B44'   CD 5AF1'       C          CALL K1.KERN
  5B47'   C3 5BA7'       C          JP	KOMED	;Kommandoende
                         C      
                         C          TITLE   '7-/8-Byte IO-Kommandos'
                         C          PAGE
'7-/8-Byte IO-Kommandos'	MACRO-80 3.44	09-Dec-81	PAGE	1-29


                         C      
                         C      ;****************************************************************
                         C      ;*               Eingabezweig                                   *
                         C      ;****************************************************************
  5B4A'                  C      STT02:
  5B4A'   3A 2B01'       C          LD  A,(K0.HSB)   ;HS-Bereich
  5B4D'   DD 77 1F       C          LD  (IX+31),A
                         C      
  5B50'   DD 7E 07       C          LD  A,(IX+7)
  5B53'   DD 77 20       C          LD  (IX+32),A
  5B56'   DD 7E 08       C          LD  A,(IX+8)
  5B59'   DD 77 21       C          LD  (IX+33),A
                         C      
  5B5C'   DD 36 22 FF    C          LD  (IX+34),0FFH
                         C      
  5B60'   06 07          C          LD  B,7
  5B62'   CD 5AF1'       C          CALL K1.KERN
  5B65'   C3 5BA7'       C          JP	KOMED	;Kommandoende
                         C      
                         C      ;****************************************************************
                         C      ;*               Aufzeichnungszweig                             *
                         C      ;****************************************************************
  5B68'                  C      STT08:
  5B68'   DD 7E 0A       C          LD  A,(IX+10)   ;Laenge der Daten im Puffer
  5B6B'   DD 77 1F       C          LD  (IX+31),A
                         C      
  5B6E'   3A 2B01'       C          LD  A,(K0.HSB)   ;HS-Bereich
  5B71'   DD 77 20       C          LD  (IX+32),A
                         C      
  5B74'   DD 7E 07       C          LD  A,(IX+7)
  5B77'   DD 77 21       C          LD  (IX+33),A
  5B7A'   DD 7E 08       C          LD  A,(IX+8)
  5B7D'   DD 77 22       C          LD  (IX+34),A
                         C      
  5B80'   DD 36 23 FF    C          LD  (IX+35),0FFH
                         C      
  5B84'   06 08          C          LD  B,8
  5B86'   CD 5AF1'       C          CALL K1.KERN
  5B89'   C3 5BA7'       C          JP	KOMED	;Kommandoende
                         C      
                         C          PAGE
'7-/8-Byte IO-Kommandos'	MACRO-80 3.44	09-Dec-81	PAGE	1-30


                         C      
                         C      ;****************************************************************
                         C      ;*               Fehler                                         *
                         C      ;****************************************************************
  5B8C'                  C      STF99:
  5B8C'   DD 75 01       C      	LD	(IX+1),L	;Fehlerschluessel laden
  5B8F'   DD CB 00 FE    C      	SET	7,(IX+0)	;Fehlerbit setzen
  5B93'                  C      STFRS:
  5B93'   C3 5BA7'       C      	JP	KOMED	;Kommandoende
                         C      
  5B96'                  C      STF07:
  5B96'   2E 10          C      	LD	L,10H	;falsches Kommando
  5B98'   18 F2          C      	JR	STF99
                         C      
                         C          PAGE
'7-/8-Byte IO-Kommandos'	MACRO-80 3.44	09-Dec-81	PAGE	1-31


                         C      
                         C      ;****************************************************************
                         C      ;*               Register AF , BC , DE , HL retten in SP        *
                         C      ;****************************************************************
  5B9A'                  C      RRET:
  5B9A'   E3             C          EX  (SP),HL
  5B9B'   D5             C      	PUSH	DE
  5B9C'   C5             C      	PUSH	BC
  5B9D'   F5             C      	PUSH	AF
  5B9E'   E9             C          JP  (HL)
                         C      ;****************************************************************
                         C      ;*               Register AF , BC , DE , HL laden aus SP        *
                         C      ;****************************************************************
  5B9F'                  C      RLAD:
  5B9F'   E3             C          EX  (SP),HL
  5BA0'   33             C          INC SP
  5BA1'   33             C          INC SP
  5BA2'   F1             C      	POP	AF
  5BA3'   C1             C      	POP	BC
  5BA4'   D1             C      	POP	DE
  5BA5'   E3             C          EX  (SP),HL
  5BA6'   C9             C      	RET
                         C      
                         C      ;****************************************************************
                         C      ;*               Verzweigung aus Steuerteil zum Eintrittspunkt  *
                         C      ;*               des Steuerprogrammes                           *
                         C      ;****************************************************************
  5BA7'                  C      KOMED:
  5BA7'   F3             C      	DI
  5BA8'   DD CB 00 86    C      	RES 0,(IX)
  5BAC'   CD 5B9F'       C      	CALL	RLAD
  5BAF'   FB             C      	EI
  5BB0'   C9             C      	RET
                         C      
                         C          PAGE
'7-/8-Byte IO-Kommandos'	MACRO-80 3.44	09-Dec-81	PAGE	1-32


                         C      
                         C      ;****************************************************************
                         C      ;*               CRC-Zeichen berechnen                          *
                         C      ;*               <B>  = Blocklaenge , 0 = 256                   *
                         C      ;*               <HL> = Pufferadresse                           *
                         C      ;*               in  DE  nach Aufruf CRC-Zeichen                *
                         C      ;*                <D> = 1.Byte , wird zuerst gesendet           *
                         C      ;*                <E> = 2.Byte , wird danach gesendet           *
                         C      ;****************************************************************
  5BB1'                  C      K1.CRC:
  5BB1'   11 0000        C      	LD	DE,0
  5BB4'                  C      CRC0:
  5BB4'   C5             C      	PUSH	BC	;Bytelaenge
  5BB5'   06 08          C      	LD	B,8
  5BB7'   4E             C      	LD	C,(HL)
  5BB8'                  C      CRC1:
  5BB8'   79             C      	LD	A,C
  5BB9'   AA             C      	XOR	D
  5BBA'   0F             C      	RRCA		;Ergebnis Antivalenz Wort-Byte/CRC-Byte,Bit 0
  5BBB'   F5             C      	PUSH	AF
  5BBC'   CB 1B          C      	RR	E	;Verschiebung von DE um 1 Bit nach rechts
  5BBE'   CB 1A          C      	RR	D
  5BC0'   F1             C      	POP	AF	;Rueckretten F
  5BC1'   30 08          C      	JR	NC,CRC2	;Sprung wenn Antivalenz 0 + 0 = 0
  5BC3'   7A             C      	LD	A,D	;Korrektur = Umkehr Bit 13/Bit 0
  5BC4'   EE 01          C      	XOR	1	;Maske fuer D
  5BC6'   57             C      	LD	D,A	;Korrektur  D
  5BC7'   7B             C      	LD	A,E
  5BC8'   EE 20          C      	XOR	20H	;Maske fuer E
  5BCA'   5F             C      	LD	E,A	;Korrektur  E
  5BCB'                  C      CRC2:
  5BCB'   CB 09          C      	RRC	C	;Schieben Datenbyte
  5BCD'   10 E9          C      	DJNZ	CRC1
  5BCF'   C1             C      	POP	BC	;Byte abgearbeitet
  5BD0'   0B             C      	DEC	BC
  5BD1'   79             C      	LD	A,C
  5BD2'   B0             C      	OR	B
  5BD3'   C8             C      	RET	Z
  5BD4'   23             C      	INC	HL
  5BD5'   18 DD          C      	JR	CRC0
                         C      
                         C      ;	END
                         C      	TITLE	'Kassettengrundroutinen'
                         C      	PAGE
'Kassettengrundroutinen'	MACRO-80 3.44	09-Dec-81	PAGE	1-33


                         C      
                         C      ;****************************************************************
                         C      ;*               Anschlussroutinen fuer BAMOS/Emulator          *
                         C      ;* OS - Version  -----------------------------------------------*
                         C      ;*               Programmierer: Marcus Herbote                  *
                         C      ;* V 1 . 2       -----------------------------------------------*
                         C      ;*               Stand        : 18.November 2022                *
                         C      ;****************************************************************
                         C      ;	PN	KR
                         C      ;---------------------------------------------------------------------
                         C      ;        Kassettengrundroutinen
                         C      ;---------------------------------------------------------------------
  5BD7'   5BD7'          C      	DW	$
  5BD9'   4B 31 52 45    C      	DB	'K1RE'
  5BDD'                  C      KR.GR1:
  5BDD'   3E 01          C      	LD	A,01H
  5BDF'   18 08          C      	JR	KR.GR3
                         C      ;
  5BE1'   5BE1'          C      	DW	$
  5BE3'   4B 32 52 45    C      	DB	'K2RE'
  5BE7'                  C      KR.GR2:
  5BE7'   3E 02          C      	LD	A,02H
  5BE9'                  C      KR.GR3:
  5BE9'   CD 54E2'       C      	CALL	U1.KTINI
  5BEC'   DD 77 03       C      	LD	(IX+3),A
  5BEF'   CD 6095'       C      	CALL	UR.KRE
  5BF2'   C9             C      	RET
                         C      ;-------------------------------------------------------------------
  5BF3'   5BF3'          C      	DW	$
  5BF5'   4B 31 4C 2B    C      	DB	'K1L+'
  5BF9'   CD 5BDD'       C      	CALL	KR.GR1
  5BFC'   18 09          C      	JR	$+11
                         C      ;
  5BFE'   5BFE'          C      	DW	$
  5C00'   4B 32 4C 2B    C      	DB	'K2L+'
  5C04'   CD 5BE7'       C      	CALL	KR.GR2
  5C07'   21 0001        C      	LD	HL,1	; IX + 10 := 1 / Anzahl BM
  5C0A'   CD 5621'       C      	CALL	XY.STDX
  5C0D'   09             C      	DB	9
  5C0E'   CD 60AD'       C      	CALL	UR.KLV
  5C11'   C9             C      	RET
                         C      ;---------------------------------------------------------------------
  5C12'   5C12'          C      	DW	$
  5C14'   4B 31 4C 2D    C      	DB	'K1L-'
  5C18'   CD 5BDD'       C      	CALL	KR.GR1
  5C1B'   18 09          C      	JR	$+11
                         C      ;
  5C1D'   5C1D'          C      	DW	$
  5C1F'   4B 32 4C 2D    C      	DB	'K2L-'
  5C23'   CD 5BE7'       C      	CALL	KR.GR2
  5C26'   21 0001        C      	LD	HL,1	; IX + 10 := 1 / Anzahl BM
  5C29'   CD 5621'       C      	CALL	XY.STDX
  5C2C'   09             C      	DB	9
  5C2D'   CD 60B3'       C      	CALL	UR.KLR
  5C30'   C9             C      	RET
                         C      ;---------------------------------------------------------------------
  5C31'   5C31'          C      	DW	$
  5C33'   4B 31 52 2B    C      	DB	'K1R+'
  5C37'   CD 5BDD'       C      	CALL	KR.GR1
  5C3A'   18 09          C      	JR	$+11
                         C      ;
  5C3C'   5C3C'          C      	DW	$
  5C3E'   4B 32 52 2B    C      	DB	'K2R+'
  5C42'   CD 5BE7'       C      	CALL	KR.GR2
  5C45'   CD 60C5'       C      	CALL	UR.KBV
  5C48'   C9             C      	RET
                         C      ;--------------------------------------------------------------------
  5C49'   5C49'          C      	DW	$
  5C4B'   4B 31 52 2D    C      	DB	'K1R-'
  5C4F'   CD 5BDD'       C      	CALL	KR.GR1
  5C52'   18 09          C      	JR	$+11
                         C      ;
  5C54'   5C54'          C      	DW	$
  5C56'   4B 32 52 2D    C      	DB	'K2R-'
  5C5A'   CD 5BE7'       C      	CALL	KR.GR2
  5C5D'   CD 60CB'       C      	CALL	UR.KBR
  5C60'   C9             C      	RET
                         C      ;--------------------------------------------------------------------
  5C61'   5C61'          C      	DW	$
  5C63'   4B 31 52 57    C      	DB	'K1RW'
  5C67'   CD 5BDD'       C      	CALL	KR.GR1
  5C6A'   18 09          C      	JR	$+11
'Kassettengrundroutinen'	MACRO-80 3.44	09-Dec-81	PAGE	1-34


                         C      ;
  5C6C'   5C6C'          C      	DW	$
  5C6E'   4B 32 52 57    C      	DB	'K2RW'
  5C72'   CD 5BE7'       C      	CALL	KR.GR2
  5C75'   CD 609D'       C      	CALL	UR.KRW
  5C78'   18 14          C      	JR	KR.CKRA
                         C      ;---------------------------------------------------------------------
  5C7A'   5C7A'          C      	DW	$
  5C7C'   4B 31 52 41    C      	DB	'K1RA'
  5C80'   CD 5BDD'       C      	CALL	KR.GR1
  5C83'   18 09          C      	JR	$+11
                         C      ;
  5C85'   5C85'          C      	DW	$
  5C87'   4B 32 52 41    C      	DB	'K2RA'
  5C8B'   CD 5BE7'       C      	CALL	KR.GR2
  5C8E'                  C      KR.CKRA:
  5C8E'   CD 60A7'       C      	CALL	UR.KRA
  5C91'   C9             C      	RET
                         C      ;---------------------------------------------------------------------
  5C92'                  C      KR.KARO:
  5C92'   CD 5AB0'       C      	CALL	UE.BRKMB	;AUFRUF PHYS.KASS.ROUTINE
  5C95'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  5C96'                  C      KR.VORSP:
  5C96'   11 3327        C      	LD	DE,UE.BWSA+327H
  5C99'   CD 5761'       C      	CALL	UC.CVDB
  5C9C'   45             C      	LD	B,L
  5C9D'   3E 46          C      	LD	A,'F'
  5C9F'   32 2B28'       C      	LD	(UB.PAR2),A
  5CA2'   CD 6095'       C      	CALL	UR.KRE
  5CA5'   CD 60DA'       C      	CALL	UR.POSIK
  5CA8'   C9             C      	RET
                         C      ;---------------------------------------------------------------------
  5CA9'   5CA9'          C      	DW	$
  5CAB'   58 4B 41 31    C      	DB	'XKA1'
  5CAF'   CD 5BDD'       C      	CALL	KR.GR1
  5CB2'   18 09          C      	JR	$+11
                         C      ;
  5CB4'   5CB4'          C      	DW	$
  5CB6'   58 4B 41 32    C      	DB	'XKA2'
  5CBA'   CD 5BE7'       C      	CALL	KR.GR2
  5CBD'   CD 5C96'       C      	CALL	KR.VORSP
  5CC0'   CD 6854'       C      	CALL	FD.FDINP
  5CC3'   CD 609D'       C      	CALL	UR.KRW
  5CC6'   CD 60A7'       C      	CALL	UR.KRA
  5CC9'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  5CCA'   5CCA'          C      	DW	$
  5CCC'   59 4B 41 31    C      	DB	'YKA1'
  5CD0'   CD 5BDD'       C      	CALL	KR.GR1
  5CD3'   18 09          C      	JR	KR.YKA1	;$+11
                         C      ;
  5CD5'   5CD5'          C      	DW	$
  5CD7'   59 4B 41 32    C      	DB	'YKA2'
  5CDB'   CD 5BE7'       C      	CALL	KR.GR2
  5CDE'                  C      KR.YKA1:
  5CDE'   CD 6095'       C      	CALL	UR.KRE
  5CE1'   11 3327        C      	LD	DE,UE.BWSA+327H
  5CE4'   CD 5761'       C      	CALL	UC.CVDB
  5CE7'   2D             C      	DEC	L
  5CE8'   28 09          C      	JR	Z,KR.YKA2	;$+11
  5CEA'   DD 75 0A       C      	LD	(IX+10),L
  5CED'   CD 5D1A'       C      	CALL	KR.TYPT
  5CF0'   CD 60AD'       C      	CALL	UR.KLV
  5CF3'                  C      KR.YKA2:
  5CF3'   CD 68A7'       C      	CALL	FD.FDOUT
  5CF6'   C9             C      	RET
                         C      ;---------------------------------------------------------------------------
  5CF7'   5CF7'          C      	DW	$
  5CF9'   4B 31 43 4C    C      	DB	'K1CL'
  5CFD'   CD 5BDD'       C      	CALL	KR.GR1
  5D00'   18 09          C      	JR	KR.KCL	;$+11
                         C      ;
  5D02'   5D02'          C      	DW	$
  5D04'   4B 32 43 4C    C      	DB	'K2CL'
  5D08'   CD 5BE7'       C      	CALL	KR.GR2
  5D0B'                  C      KR.KCL:
  5D0B'   CD 60B9'       C      	CALL	UR.KBM
  5D0E'   CD 60BF'       C      	CALL	UR.KSL
  5D11'   CD 609D'       C      	CALL	UR.KRW
  5D14'   CD 60A7'       C      	CALL	UR.KRA
  5D17'   C3 000B        C      	JP	UE.SYSTB
                         C      ;--------------------------------------------------------------------
'Kassettengrundroutinen'	MACRO-80 3.44	09-Dec-81	PAGE	1-35


  5D1A'                  C      KR.TYPT:
  5D1A'   13             C      	INC	DE
  5D1B'   1A             C      	LD	A,(DE)
  5D1C'   32 2B28'       C      	LD	(UB.PAR2),A
  5D1F'   C9             C      	RET
                         C      ;--------------------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Fehleranzeige und Behandlung'
                         C      	PAGE
'Fehleranzeige und Behandlung'	MACRO-80 3.44	09-Dec-81	PAGE	1-36


                         C      
                         C      ;	PN	UF
                         C      ;***************************************************************
                         C      ;
                         C      ;      Fehleranzeige  UND  BEHANDLUNG
                         C      ;
                         C      ;***************************************************************
  5D20'                  C      UF.RET:
  5D20'   F1             C      	POP	AF
  5D21'   C1             C      	POP	BC
  5D22'   D1             C      	POP	DE
  5D23'   E1             C      	POP	HL
  5D24'   C9             C      	RET
                         C      ;---------------------Ausfhr. Kass.kommando lt.Steuerblock-------------
  5D25'                  C      UF.EXEC:
  5D25'   E5             C      	PUSH	HL
  5D26'   D5             C      	PUSH	DE
  5D27'   C5             C      	PUSH	BC
  5D28'   F5             C      	PUSH	AF
  5D29'   DD CB 00 BE    C      	RES	7,(IX)
  5D2D'   DD 36 01 00    C      	LD	(IX+1),0
                         C      	;JP	KO.KO05
                         C      
  5D31'   3E 01          C      	LD	A,1
  5D33'   32 2B01'       C      	LD	(K0.HSB),A	;HS-Bereich
  5D36'   DD 7E 04       C      	LD	A,(IX+4)	;Kommando
  5D39'   FE 71          C      	CP	071H
  5D3B'   28 0C          C      	JR	Z,UF.EXEC2
  5D3D'   FE 75          C      	CP	075H
  5D3F'   28 08          C      	JR	Z,UF.EXEC2
  5D41'   DD 36 07 0E    C      	LD	(IX+7),HIGH(UE.PUF)
  5D45'   DD 36 08 66    C      	LD	(IX+8),LOW(UE.PUF)
  5D49'                  C      UF.EXEC2:
  5D49'   CD 5C92'       C      	CALL	KR.KARO
  5D4C'                  C      UF.EXEC1:
  5D4C'   DD CB 00 7E    C      	BIT	7,(IX)	;Status
  5D50'   28 CE          C      	JR	Z,UF.RET
  5D52'   DD 7E 01       C      	LD	A,(IX+1)	;FehlerschlC<ssel
                         C      ;-------------------------Fehlerbehandlung---------------
  5D55'                  C      UF.ERANZ:
  5D55'   E5             C      	PUSH	HL
  5D56'   D5             C      	PUSH	DE
  5D57'   C5             C      	PUSH	BC
  5D58'   F5             C      	PUSH	AF
  5D59'   F5             C      	PUSH	AF
  5D5A'   3E 13          C      	LD	A,19
  5D5C'   32 2B00'       C      	LD	(UB.ZN),A
  5D5F'   21 5FB8'       C      	LD	HL,UA.ZKF	;IN: <A> Fehlerschluessel
  5D62'   CD 595C'       C      	CALL	UR.MIMO
  5D65'   F1             C      	POP	AF
  5D66'   F5             C      	PUSH	AF
  5D67'   EB             C      	EX	DE,HL
  5D68'   CD 56A5'       C      	CALL	UC.CVBX+2
  5D6B'   F1             C      	POP	AF
  5D6C'   FE 17          C      	CP	17H
  5D6E'   CA 5DF0'       C      	JP	Z,UF.FL17
  5D71'   FE 18          C      	CP	18H
  5D73'   CA 5DE4'       C      	JP	Z,UF.FL18
  5D76'   FE 00          C      	CP	00H
  5D78'   CA 5DD6'       C      	JP	Z,UF.BEHB
  5D7B'   FE 11          C      	CP	11H
  5D7D'   CA 5DD6'       C      	JP	Z,UF.BEHB
  5D80'   FE 19          C      	CP	19H
  5D82'   28 1D          C      	JR	Z,UF.AZVB
  5D84'   FE 14          C      	CP	14H
  5D86'   CA 5DF3'       C      	JP	Z,UF.FL14
  5D89'   FE 16          C      	CP	16H
  5D8B'   CA 5DF6'       C      	JP	Z,UF.FL16
  5D8E'   C3 5D20'       C      	JP	UF.RET
                         C      ;----------------------------------------------------------------------
  5D91'                  C      UF.SYS:
  5D91'   DD 7E 01       C      	LD	A,(IX+1)
  5D94'   11 35A8        C      	LD	DE,UE.BWSA+5A8H
  5D97'   CD 56A5'       C      	CALL	UC.CVBX+2
  5D9A'   00             C      	NOP
  5D9B'   00             C      	NOP
  5D9C'   00             C      	NOP
  5D9D'                  C      UF.SYS1:
  5D9D'   31 0CFE        C      	LD	SP,UE.STANF
  5DA0'   C9             C      	RET
                         C      ;----------------------------------------------------------
  5DA1'                  C      UF.AZVB:
'Fehleranzeige und Behandlung'	MACRO-80 3.44	09-Dec-81	PAGE	1-37


  5DA1'   DD CB 00 96    C      	RES	2,(IX)	;Aufzeichnen verboten
  5DA5'   DD 36 04 41    C      	LD	(IX+4),41H
  5DA9'   CD 5C92'       C      	CALL	KR.KARO
  5DAC'   DD CB 00 7E    C      	BIT	7,(IX)
  5DB0'   20 DF          C      	JR	NZ,UF.SYS
  5DB2'   21 5F28'       C      	LD	HL,UA.FRZ
  5DB5'   CD 595C'       C      	CALL	UR.MIMO
  5DB8'   38 E3          C      	JR	C,UF.SYS1
  5DBA'   DD 36 04 31    C      	LD	(IX+4),31H
  5DBE'   CD 5C92'       C      	CALL	KR.KARO
  5DC1'   DD CB 00 66    C      	BIT	4,(IX+0)
  5DC5'   20 CA          C      	JR	NZ,UF.SYS
  5DC7'   DD CB 00 7E    C      	BIT	7,(IX+0)
  5DCB'   20 C4          C      	JR	NZ,UF.SYS
  5DCD'   DD CB 00 56    C      	BIT	2,(IX+0)
  5DD1'   20 BE          C      	JR	NZ,UF.SYS
  5DD3'   C3 5DDE'       C      	JP	UF.BEHB1
                         C      ;----------------------------------------------------------
  5DD6'                  C      UF.BEHB:
  5DD6'   21 5F28'       C      	LD	HL,UA.FRZ
  5DD9'   CD 595C'       C      	CALL	UR.MIMO
  5DDC'   38 BF          C      	JR	C,UF.SYS1
                         C      
  5DDE'                  C      UF.BEHB1:
  5DDE'                  C      KO.KO04:
  5DDE'   DD 71 04       C      	LD	(IX+4),C	;FUER UF19
  5DE1'   C3 5D29'       C      	JP	UF.EXEC+4
                         C      ;---------------------------------------
  5DE4'                  C      UF.FL18:
  5DE4'   21 5F2E'       C      	LD	HL,UA.BMGF
  5DE7'   CD 595C'       C      	CALL	UR.MIMO
  5DEA'   DA 5D9D'       C      	JP	C,UF.SYS1
  5DED'   C3 5D20'       C      	JP	UF.RET
                         C      ;------------------------------------------
  5DF0'                  C      UF.FL17:
  5DF0'   C3 5D20'       C      	JP	UF.RET
                         C      ;-------------------------------------
  5DF3'                  C      UF.FL14:
  5DF3'   C3 5D20'       C      	JP	UF.RET
                         C      
  5DF6'                  C      UF.FL16:
  5DF6'   21 5F28'       C      	LD	HL,UA.FRZ
  5DF9'   CD 595C'       C      	CALL	UR.MIMO
  5DFC'   C3 5D20'       C      	JP	UF.RET
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Ausschriften'
                         C      	PAGE
'Ausschriften'	MACRO-80 3.44	09-Dec-81	PAGE	1-38


                         C      
                         C      ;	PN	UA01
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;     AUSSCHRIFTEN
                         C      ;
                         C      ;----------------------------------------------------------------------
  5DFF'                  C      UA.DS:
  5DFF'   00             C      	DB	0
  5E00'   01             C      	DB	1
  5E01'   00             C      	DB	0
  5E02'   01             C      	DB	1
  5E03'   20 20 44 53    C      	DB	'  DS************   '
  5E07'   2A 2A 2A 2A    C      
  5E0B'   2A 2A 2A 2A    C      
  5E0F'   2A 2A 2A 2A    C      
  5E13'   20 20 20       C      
  5E16'   01             C      	DB	1
  5E17'   00             C      	DB	0
  5E18'   00             C      	DB	0
  5E19'   00             C      	DB	0
  5E1A'   00             C      	DB	0
  5E1B'   00             C      	DB	0
  5E1C'   00             C      	DB	0
  5E1D'   00             C      	DB	0
  5E1E'   00             C      	DB	0
                         C      ;----------------------------------------------------------------------
  5E1F'                  C      UA.KNAME:
  5E1F'   06             C      	DB	06H
  5E20'   10             C      	DB	16
  5E21'   40             C      	DB	40H
  5E22'   20 4B 61 73    C      	DB	' KassettenName: '
  5E26'   73 65 74 74    C      
  5E2A'   65 6E 4E 61    C      
  5E2E'   6D 65 3A 20    C      
  5E32'                  C      UA.NR:
  5E32'   03             C      	DB	03H
  5E33'   10             C      	DB	16
  5E34'   40             C      	DB	40H
  5E35'   20 4B 61 73    C      	DB	' Kassetten-Nr.: '
  5E39'   73 65 74 74    C      
  5E3D'   65 6E 2D 4E    C      
  5E41'   72 2E 3A 20    C      
  5E45'                  C      UA.KOMMT:
  5E45'   0B             C      	DB	0BH
  5E46'   10             C      	DB	16
  5E47'   80             C      	DB	80H
  5E48'   20 20 20 20    C      	DB	'     Kommentar: '
  5E4C'   20 4B 6F 6D    C      
  5E50'   6D 65 6E 74    C      
  5E54'   61 72 3A 20    C      
                         C      ;----------------------------------------------------------------------
  5E58'                  C      UA.Z7E:
  5E58'   45 69 6E 67    C      	DB	'Eingabe      =====>     Ausgabe'
  5E5C'   61 62 65 20    C      
  5E60'   20 20 20 20    C      
  5E64'   20 3D 3D 3D    C      
  5E68'   3D 3D 3E 20    C      
  5E6C'   20 20 20 20    C      
  5E70'   41 75 73 67    C      
  5E74'   61 62 65       C      
  5E77'                  C      UA.GER:
  5E77'   20 20 20 20    C      	DB	'       Geraet: '
  5E7B'   20 20 20 47    C      
  5E7F'   65 72 61 65    C      
  5E83'   74 3A 20       C      
                         C      ;----------------------------------------------------------------------
  5E86'                  C      UA.KOPFR:
  5E86'   01             C      	DB	01H
  5E87'   33             C      	DB	51
  5E88'   80             C      	DB	80H
  5E89'   20 20 20 20    C      	DB	'                Datei               kopieren J/N ? '
  5E8D'   20 20 20 20    C      
  5E91'   20 20 20 20    C      
  5E95'   20 20 20 20    C      
  5E99'   44 61 74 65    C      
  5E9D'   69 20 20 20    C      
  5EA1'   20 20 20 20    C      
  5EA5'   20 20 20 20    C      
  5EA9'   20 20 20 20    C      
  5EAD'   6B 6F 70 69    C      
  5EB1'   65 72 65 6E    C      
'Ausschriften'	MACRO-80 3.44	09-Dec-81	PAGE	1-39


  5EB5'   20 4A 2F 4E    C      
  5EB9'   20 3F 20       C      
  5EBC'                  C      UA.EABFR:
  5EBC'   01             C      	DB	01H
  5EBD'   33             C      	DB	51
  5EBE'   80             C      	DB	80H
  5EBF'   20 20 20 20    C      	DB	'                Eingaben in Ordnung  ---->   J/N ? '
  5EC3'   20 20 20 20    C      
  5EC7'   20 20 20 20    C      
  5ECB'   20 20 20 20    C      
  5ECF'   45 69 6E 67    C      
  5ED3'   61 62 65 6E    C      
  5ED7'   20 69 6E 20    C      
  5EDB'   4F 72 64 6E    C      
  5EDF'   75 6E 67 20    C      
  5EE3'   20 2D 2D 2D    C      
  5EE7'   2D 3E 20 20    C      
  5EEB'   20 4A 2F 4E    C      
  5EEF'   20 3F 20       C      
  5EF2'                  C      UA.VORH:
  5EF2'   01             C      	DB	1
  5EF3'   33             C      	DB	51
  5EF4'   80             C      	DB	80H
  5EF5'   2A 2A 2A 2A    C      	DB	'************* Datei vorh.;SYS-Ende,kopieren  J/N ? '
  5EF9'   2A 2A 2A 2A    C      
  5EFD'   2A 2A 2A 2A    C      
  5F01'   2A 20 44 61    C      
  5F05'   74 65 69 20    C      
  5F09'   76 6F 72 68    C      
  5F0D'   2E 3B 53 59    C      
  5F11'   53 2D 45 6E    C      
  5F15'   64 65 2C 6B    C      
  5F19'   6F 70 69 65    C      
  5F1D'   72 65 6E 20    C      
  5F21'   20 4A 2F 4E    C      
  5F25'   20 3F 20       C      
                         C      ;----------------------------------------------------------------------
  5F28'                  C      UA.FRZ:
  5F28'   02             C      	DB	2
  5F29'   03             C      	DB	3
  5F2A'   80             C      	DB	80H
  5F2B'   3F 3F 20       C      	DB	'?? '
  5F2E'                  C      UA.BMGF:
  5F2E'   01             C      	DB	01H
  5F2F'   07             C      	DB	7
  5F30'   80             C      	DB	80H
  5F31'   42 4D 20 21    C      	DB	'BM ! ??'
  5F35'   20 3F 3F       C      
  5F38'                  C      UA.DOK:
  5F38'   00             C      	DB	0
  5F39'   04             C      	DB	4
  5F3A'   80             C      	DB	80H
  5F3B'   69 2E 4F 2E    C      	DB	'i.O.'
  5F3F'                  C      UA.DF:
  5F3F'   00             C      	DB	0
  5F40'   04             C      	DB	4
  5F41'   80             C      	DB	80H
  5F42'   46 68 6C 2E    C      	DB	'Fhl.'
                         C      ;----------------------------------------------------------------------
  5F46'                  C      UA.ZKDAT:
  5F46'   06             C      	DB	6
  5F47'   10             C      	DB	16
  5F48'   40             C      	DB	40H
  5F49'   20 20 20 20    C      	DB	'     Dateiname: '
  5F4D'   20 44 61 74    C      
  5F51'   65 69 6E 61    C      
  5F55'   6D 65 3A 20    C      
  5F59'                  C      UA.ZKLAD:
  5F59'   04             C      	DB	4
  5F5A'   10             C      	DB	16
  5F5B'   08             C      	DB	08H
  5F5C'   20 20 20 4C    C      	DB	'   Ladeadresse: '
  5F60'   61 64 65 61    C      
  5F64'   64 72 65 73    C      
  5F68'   73 65 3A 20    C      
                         C      ;------------------------------------------------------------------
  5F6C'                  C      UA.ZKBEG:
  5F6C'   04             C      	DB	4
  5F6D'   10             C      	DB	16
  5F6E'   08             C      	DB	08H
  5F6F'   20 20 20 20    C      	DB	'        Beginn: '
  5F73'   20 20 20 20    C      
  5F77'   42 65 67 69    C      
'Ausschriften'	MACRO-80 3.44	09-Dec-81	PAGE	1-40


  5F7B'   6E 6E 3A 20    C      
  5F7F'                  C      UA.ZKEND:
  5F7F'   04             C      	DB	4
  5F80'   10             C      	DB	16
  5F81'   08             C      	DB	08H
  5F82'   20 20 20 20    C      	DB	'          Ende: '
  5F86'   20 20 20 20    C      
  5F8A'   20 20 45 6E    C      
  5F8E'   64 65 3A 20    C      
  5F92'                  C      UA.STADR:
  5F92'   04             C      	DB	4
  5F93'   10             C      	DB	16
  5F94'   08             C      	DB	08H
  5F95'   20 20 53 74    C      	DB	'  Startadresse: '
  5F99'   61 72 74 61    C      
  5F9D'   64 72 65 73    C      
  5FA1'   73 65 3A 20    C      
  5FA5'                  C      UA.ZKDL:
  5FA5'   01             C      	DB	1
  5FA6'   10             C      	DB	16
  5FA7'   20             C      	DB	20H
  5FA8'   20 4C 6F 65    C      	DB	' Loeschen J/N : '
  5FAC'   73 63 68 65    C      
  5FB0'   6E 20 4A 2F    C      
  5FB4'   4E 20 3A 20    C      
  5FB8'                  C      UA.ZKF:
  5FB8'   00             C      	DB	0
  5FB9'   08             C      	DB	8
  5FBA'   00             C      	DB	0
  5FBB'   46 65 68 6C    C      	DB	'Fehler: '
  5FBF'   65 72 3A 20    C      
                         C      ;----------------------------------------------------------------------
  5FC3'                  C      UA.ZKRES:
  5FC3'   03             C      	DB	3
  5FC4'   10             C      	DB	16
  5FC5'   10             C      	DB	10H
  5FC6'   52 65 73 65    C      	DB	'Reservebloecke: '
  5FCA'   72 76 65 62    C      
  5FCE'   6C 6F 65 63    C      
  5FD2'   6B 65 3A 20    C      
  5FD6'                  C      UA.ZKSDT:
  5FD6'   04             C      	DB	4
  5FD7'   12             C      	DB	18
  5FD8'   40             C      	DB	40H
  5FD9'   20 20 20 20    C      	DB	'     Dateiname:   '
  5FDD'   20 44 61 74    C      
  5FE1'   65 69 6E 61    C      
  5FE5'   6D 65 3A 20    C      
  5FE9'   20 20          C      
  5FEB'                  C      UA.ZKBEL:
  5FEB'   00             C      	DB	0
  5FEC'   10             C      	DB	16
  5FED'   00             C      	DB	0
  5FEE'   42 6C 6F 65    C      	DB	'Bloecke belegt: '
  5FF2'   63 6B 65 20    C      
  5FF6'   62 65 6C 65    C      
  5FFA'   67 74 3A 20    C      
  5FFE'                  C      UA.ZKBLG:
  5FFE'   00             C      	DB	0
  5FFF'   10             C      	DB	16
  6000'   00             C      	DB	0
  6001'   42 6C 6F 65    C      	DB	'Bloecke gesamt: '
  6005'   63 6B 65 20    C      
  6009'   67 65 73 61    C      
  600D'   6D 74 3A 20    C      
                         C      ;----------------------------------------------------------------------
  6011'                  C      UA.ZKBA:
  6011'   42 61 6E 64    C      	DB	'Bandanfang'
  6015'   61 6E 66 61    C      
  6019'   6E 67          C      
  601B'                  C      UA.ZKBM:
  601B'   42 61 6E 64    C      	DB	'Bandmarke'
  601F'   6D 61 72 6B    C      
  6023'   65             C      
  6024'                  C      UA.ZKSL:
  6024'   53 63 68 6C    C      	DB	'Schlussluecke'
  6028'   75 73 73 6C    C      
  602C'   75 65 63 6B    C      
  6030'   65             C      
  6031'                  C      UA.ZKEE:
                         C      ;----------------------------------------------------------------------
  6031'                  C      UA.LD:
  6031'   26             C      	DB	38
'Ausschriften'	MACRO-80 3.44	09-Dec-81	PAGE	1-41


  6032'   0F             C      	DB	15
  6033'   80             C      	DB	80H
  6034'   20 20 20 20    C      	DB	'               '
  6038'   20 20 20 20    C      
  603C'   20 20 20 20    C      
  6040'   20 20 20       C      
  6043'                  C      UA.ZRSCH:
  6043'   01             C      	DB	1
  6044'   16             C      	DB	22
  6045'   80             C      	DB	80H
  6046'   56 65 72 7A    C      	DB	'Verz. schreiben J/N ? '
  604A'   2E 20 73 63    C      
  604E'   68 72 65 69    C      
  6052'   62 65 6E 20    C      
  6056'   4A 2F 4E 20    C      
  605A'   3F 20          C      
  605C'                  C      UA.ANZWD:
  605C'   01             C      	DB	1
  605D'   16             C      	DB	22
  605E'   80             C      	DB	80H
  605F'   41 6E 7A 65    C      	DB	'Anzeige wdhln.  J/N ? '
  6063'   69 67 65 20    C      
  6067'   77 64 68 6C    C      
  606B'   6E 2E 20 20    C      
  606F'   4A 2F 4E 20    C      
  6073'   3F 20          C      
                         C      ;----------------------------------------------------------------------
  6075'                  C      UA.ALTR:
  6075'   20 41 55 53    C      	DB	' AUSGLEICH LAUFWERKSTOLERANZEN  '
  6079'   47 4C 45 49    C      
  607D'   43 48 20 4C    C      
  6081'   41 55 46 57    C      
  6085'   45 52 4B 53    C      
  6089'   54 4F 4C 45    C      
  608D'   52 41 4E 5A    C      
  6091'   45 4E 20 20    C      
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                         C      	TITLE 'Routinen fuer Kassette'
                         C      	PAGE
'Routinen fuer Kassette'	MACRO-80 3.44	09-Dec-81	PAGE	1-42


                         C      
                         C      ;----------------------------------------------------------------------
                         C      ;   Routinen fuer KASSETTE
                         C      ;----------------------------------------------------------------------
  6095'                  C      UR.KRE:
  6095'   DD 36 04 31    C      	LD	(IX+4),31H
  6099'                  C      UR.KRE1:
  6099'   CD 5D25'       C      	CALL	UF.EXEC
  609C'   C9             C      	RET
  609D'                  C      UR.KRW:
  609D'   DD 36 04 21    C      	LD	(IX+4),21H
  60A1'   18 F6          C      	JR	UR.KRE1	;Umspulen
  60A3'                  C      UR.KRWW:
  60A3'   CD 609D'       C      	CALL	UR.KRW
  60A6'   C9             C      	RET
  60A7'                  C      UR.KRA:
  60A7'   DD 36 04 41    C      	LD	(IX+4),41H
  60AB'   18 EC          C      	JR	UR.KRE1	;Reservieren aus
  60AD'                  C      UR.KLV:
  60AD'   DD 36 04 71    C      	LD	(IX+4),71H
  60B1'   18 E6          C      	JR	UR.KRE1	;Label vorsetzen
  60B3'                  C      UR.KLR:
  60B3'   DD 36 04 75    C      	LD	(IX+4),75H
  60B7'   18 E0          C      	JR	UR.KRE1	;LABEL RUECKSETZEN
  60B9'                  C      UR.KBM:
  60B9'   DD 36 04 51    C      	LD	(IX+4),51H
  60BD'   18 DA          C      	JR	UR.KRE1	;BANDMARKE SCHREIBEN
  60BF'                  C      UR.KSL:
  60BF'   DD 36 04 61    C      	LD	(IX+4),61H
  60C3'   18 D4          C      	JR	UR.KRE1	;SCHLUSSLUECKE SCHREIBEN
  60C5'                  C      UR.KBV:
  60C5'   DD 36 04 11    C      	LD	(IX+4),11H
  60C9'   18 CE          C      	JR	UR.KRE1	;Block vorsetzen
  60CB'                  C      UR.KBR:
  60CB'   DD 36 04 15    C      	LD	(IX+4),15H
  60CF'   18 C8          C      	JR	UR.KRE1
                         C      ;--------------------------------------------------------------------
  60D1'                  C      UR.RPOS:
  60D1'   E5             C      	PUSH	HL
  60D2'   D5             C      	PUSH	DE
  60D3'   F5             C      	PUSH	AF
  60D4'   C5             C      	PUSH	BC
  60D5'   AF             C      	XOR	A
  60D6'   3D             C      	DEC	A
  60D7'   4F             C      	LD	C,A
  60D8'   18 06          C      	JR	POSIK1
  60DA'                  C      UR.POSIK:
  60DA'   E5             C      	PUSH	HL
  60DB'   D5             C      	PUSH	DE
  60DC'   F5             C      	PUSH	AF
  60DD'   C5             C      	PUSH	BC	;Positionieren
  60DE'   AF             C      	XOR	A
  60DF'   4F             C      	LD	C,A
  60E0'                  C      POSIK1:
  60E0'   06 00          C      	LD	B,0
  60E2'   11 0000        C      	LD	DE,0
  60E5'                  C      UR.LES:
  60E5'   DD 36 04 02    C      	LD	(IX+4),02H
  60E9'   CD 5D25'       C      	CALL	UF.EXEC	;BLOCK LESEN
  60EC'   DD 7E 0A       C      	LD	A,(IX+10)
  60EF'   FE 01          C      	CP	1	;BANDMARKE?
  60F1'   28 19          C      	JR	Z,UR.BM
  60F3'   04             C      	INC	B	;ANZAHL BLOECKE
  60F4'   78             C      	LD	A,B
  60F5'   FE 04          C      	CP	4
  60F7'   28 21          C      	JR	Z,UR.OK
  60F9'   21 0000        C      	LD	HL,0
  60FC'   CD 5611'       C      	CALL	XY.LIDX
  60FF'   09             C      	DB	9	;HL<--BLOCKLAENGE
  6100'   19             C      	ADD	HL,DE
  6101'   EB             C      	EX	DE,HL
  6102'   21 012C        C      	LD	HL,300
  6105'   B7             C      	OR	A
  6106'   ED 52          C      	SBC	HL,DE
  6108'   38 10          C      	JR	C,UR.OK
  610A'   18 D9          C      	JR	UR.LES
  610C'                  C      UR.BM:
  610C'   AF             C      	XOR	A
  610D'   B1             C      	OR	C
  610E'   28 04          C      	JR	Z,$+6
  6110'   C1             C      	POP	BC
  6111'   04             C      	INC	B
'Routinen fuer Kassette'	MACRO-80 3.44	09-Dec-81	PAGE	1-43


  6112'   18 C9          C      	JR	UR.POSIK+3
  6114'   C1             C      	POP	BC
  6115'   05             C      	DEC	B
  6116'   28 21          C      	JR	Z,UR.RSP
  6118'   18 C3          C      	JR	UR.POSIK+3
  611A'                  C      UR.OK:
  611A'   AF             C      	XOR	A
  611B'   B1             C      	OR	C
  611C'   28 08          C      	JR	Z,$+10
  611E'   DD 70 0A       C      	LD	(IX+10),B
  6121'   CD 60B3'       C      	CALL	UR.KLR
  6124'   18 13          C      	JR	UR.RSP
  6126'   DD 36 04 15    C      	LD	(IX+4),15H
  612A'   CD 5D25'       C      	CALL	UF.EXEC
  612D'   10 F7          C      	DJNZ	$-7
  612F'   C1             C      	POP	BC
  6130'   05             C      	DEC	B
  6131'   28 06          C      	JR	Z,UR.RSP
  6133'   DD 70 0A       C      	LD	(IX+10),B
  6136'   CD 60AD'       C      	CALL	UR.KLV
  6139'                  C      UR.RSP:
  6139'   F1             C      	POP	AF
  613A'   D1             C      	POP	DE
  613B'   E1             C      	POP	HL
  613C'   C9             C      	RET
                         C      	TITLE	'Einzelzeicheneingabe fuer KMBG'
                         C      	PAGE
'Einzelzeicheneingabe fuer KMBG'	MACRO-80 3.44	09-Dec-81	PAGE	1-44


                         C      
                         C      ;	PN	UK
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;        Einzelzeicheneingabe fuer KMBG
                         C      ;
                         C      ;----------------------------------------------------------------------
  613D'                  C      UK.GETK:
  613D'   CD 5400'       C      	CALL	U1.RSAVE
  6140'   CD 5611'       C      	CALL	XY.LIDX	;HL:= Blocklaenge
  6143'   09             C      	DB	9
  6144'   E5             C      	PUSH	HL
  6145'   CD 5601'       C      	CALL	XY.LDDX
  6148'   17             C      	DB	23
  6149'   EB             C      	EX	DE,HL	;DE:= Pufferzaehler
  614A'   AF             C      	XOR	A
  614B'   E1             C      	POP	HL	;HL:= Blocklaenge
  614C'   ED 52          C      	SBC	HL,DE
  614E'   E5             C      	PUSH	HL	;Restbyteanzahl retten
  614F'   7C             C      	LD	A,H
  6150'   B5             C      	OR	L
  6151'   CC 619D'       C      	CALL	Z,UK.KBW	;Block lesen
  6154'   E1             C      	POP	HL
  6155'   AF             C      	XOR	A
  6156'   BC             C      	CP	H
  6157'   20 05          C      	JR	NZ,UK.GETK2
  6159'   7D             C      	LD	A,L
  615A'   FE 01          C      	CP	1
  615C'   28 08          C      	JR	Z,UK.GETK3	;---> letztes Datenbyte des
  615E'                  C      UK.GETK2:
  615E'   CD 616C'       C      	CALL	UK.GETK4
  6161'   B7             C      	OR	A
  6162'                  C      UK.GETK5:
  6162'   CD 5408'       C      	CALL	U1.RRST
  6165'   C9             C      	RET
                         C      ;
                         C      ;
  6166'                  C      UK.GETK3:
  6166'   CD 616C'       C      	CALL	UK.GETK4
  6169'   37             C      	SCF
  616A'   18 F6          C      	JR	UK.GETK5
                         C      ;
  616C'                  C      UK.GETK4:
  616C'   CD 5601'       C      	CALL	XY.LDDX	;HL:= aktuelle Pufferadresse
  616F'   15             C      	DB	21
  6170'   7E             C      	LD	A,(HL)	;Datenbyte laden
  6171'   CD 5641'       C      	CALL	XY.INCDX	;Pufferzeiger erhoehen
  6174'   15             C      	DB	21
  6175'   CD 5641'       C      	CALL	XY.INCDX	;Pufferzaehler erhoehen
  6178'   17             C      	DB	23
  6179'   C9             C      	RET
                         C      
                         C      ;******************************************************************
                         C      ;
                         C      ;        KMBG  Eingabepuffer bereitstellen
                         C      ;
                         C      ;*******************************************************************
  617A'                  C      UK.KLPFB:
  617A'   CD 5400'       C      	CALL	U1.RSAVE
  617D'   CD 54FB'       C      	CALL	U1.KTIN1
  6180'   21 0080        C      	LD	HL,MaxBL	;max. Blocklaenge Kassette (100H)
  6183'   CD 5631'       C      	CALL	XY.STIDX	;max. Blocklaenge initialisieren
  6186'   09             C      	DB	9
  6187'   E5             C      	PUSH	HL
  6188'   C1             C      	POP	BC	;BC:= Blocklaenge
  6189'   CD 5621'       C      	CALL	XY.STDX	;Pufferzaehler "Leer"
  618C'   17             C      	DB	23
  618D'   21 0E66        C      	LD	HL,UE.PUF	;Systempuffer Kassette
  6190'   CD 5411'       C      	CALL	U1.CLRB	;Systempuffer loeschen
  6193'   21 8010        C      	LD	HL,UE.KPUFF
  6196'   CD 5411'       C      	CALL	U1.CLRB
  6199'   CD 5408'       C      	CALL	U1.RRST
  619C'   C9             C      	RET
                         C      
                         C      ;******************************************************************
                         C      ;
                         C      ;        Einlesen eines Blockes von Kassette
                         C      ;
                         C      ;         - Besonderheit gegenueber MBW: Blockinhalt wird vom
                         C      ;           Systempuffer in den E/A-Puffer uebertragen
                         C      ;
                         C      ;*******************************************************************
'Einzelzeicheneingabe fuer KMBG'	MACRO-80 3.44	09-Dec-81	PAGE	1-45


  619D'                  C      UK.KBW:
  619D'   CD 5400'       C      	CALL	U1.RSAVE
  61A0'   CD 617A'       C      	CALL	UK.KLPFB
  61A3'   DD 36 04 02    C      	LD	(IX+4),02H
  61A7'   CD 5D25'       C      	CALL	UF.EXEC
                         C      	;LD	A,(IX+9)
                         C      	;OR	(IX+10)
  61AA'   DD 7E 0A       C      	LD	A,(IX+10)	;Laenge = 1, dann BM
  61AD'   FE 01          C      	CP	1
  61AF'   28 2A          C      	JR	Z,UK.KBW1	;EOF
  61B1'   CD 5601'       C      	CALL	XY.LDDX	;HL:= Blockadresse
  61B4'   07             C      	DB	7
  61B5'   DD 46 09       C      	LD	B,(IX+9)	;BC:= Blocklaenge
  61B8'   DD 4E 0A       C      	LD	C,(IX+10)
  61BB'   E5             C      	PUSH	HL	;E/A-Puffer
  61BC'   CD 5601'       C      	CALL	XY.LDDX
  61BF'   19             C      	DB	25
  61C0'   EB             C      	EX	DE,HL
  61C1'   E1             C      	POP	HL
  61C2'   ED B0          C      	LDIR		;Transport in E/A-Puffer
  61C4'   CD 5601'       C      	CALL	XY.LDDX
  61C7'   19             C      	DB	25
  61C8'   CD 5621'       C      	CALL	XY.STDX	;Pufferzeiger auf Anfang
  61CB'   15             C      	DB	21
  61CC'   21 0000        C      	LD	HL,0
  61CF'   CD 5621'       C      	CALL	XY.STDX	;Pufferzaehler rueckstellen
  61D2'   17             C      	DB	23
  61D3'   CD 5641'       C      	CALL	XY.INCDX	;Blockzaehler incrementieren
  61D6'   11             C      	DB	17
  61D7'                  C      UK.KBW2:
  61D7'   CD 5408'       C      	CALL	U1.RRST
  61DA'   C9             C      	RET
                         C      ;
  61DB'                  C      UK.KBW1:
  61DB'   CD 5641'       C      	CALL	XY.INCDX	;Labelzaehler incrementieren
  61DE'   11             C      	DB	17
  61DF'   18 F6          C      	JR	UK.KBW2
                         C      
                         C      ;********************************************************************
                         C      ;
                         C      ;        Einzelzeichenausgabe fuer KMBG
                         C      ;
                         C      ;*********************************************************************
  61E1'                  C      UK.PUTK:
  61E1'   CD 5400'       C      	CALL	U1.RSAVE
  61E4'   F5             C      	PUSH	AF	;Zeichen retten
  61E5'   CD 5601'       C      	CALL	XY.LDDX	;HL:= Pufferzaehler
  61E8'   17             C      	DB	23
  61E9'   01 0132        C      	LD	BC,UE.KMPUL	;BC:= max. Pufferlaenge
  61EC'   B7             C      	OR	A
  61ED'   ED 42          C      	SBC	HL,BC
  61EF'   3F             C      	CCF
  61F0'   CC 622A'       C      	CALL	Z,UK.KBA	;---> Puffer voll
  61F3'   F1             C      	POP	AF	;Zeichen auskellern
  61F4'   CD 5601'       C      	CALL	XY.LDDX
  61F7'   15             C      	DB	21
  61F8'   77             C      	LD	(HL),A	;Zeichen in Puffer eintragen
  61F9'   CD 5641'       C      	CALL	XY.INCDX	;Pufferzeiger erhoehen
  61FC'   15             C      	DB	21
  61FD'   CD 5641'       C      	CALL	XY.INCDX	;Pufferzaehler erhoehen
  6200'   17             C      	DB	23
  6201'   CD 5408'       C      	CALL	U1.RRST
  6204'   C9             C      	RET
                         C      
                         C      ;******************************************************************
                         C      ;
                         C      ;        Ausgabepufferbereitstellung fuer KMBG
                         C      ;
                         C      ;*******************************************************************
  6205'                  C      UK.KSPFB:
  6205'   CD 5400'       C      	CALL	U1.RSAVE
  6208'   CD 54FB'       C      	CALL	U1.KTIN1
  620B'   CD 5611'       C      	CALL	XY.LIDX
  620E'   09             C      	DB	9
  620F'   E5             C      	PUSH	HL
  6210'   C1             C      	POP	BC	;BC:= Blocklaenge
  6211'   21 0000        C      	LD	HL,0
  6214'   CD 5621'       C      	CALL	XY.STDX	;Pufferzaehler = 0
  6217'   17             C      	DB	23
  6218'   CD 5601'       C      	CALL	XY.LDDX
  621B'   19             C      	DB	25
  621C'   CD 5621'       C      	CALL	XY.STDX	;Pufferzeiger setzen
  621F'   15             C      	DB	21
'Einzelzeicheneingabe fuer KMBG'	MACRO-80 3.44	09-Dec-81	PAGE	1-46


  6220'   21 0E66        C      	LD	HL,UE.PUF
  6223'   CD 5411'       C      	CALL	U1.CLRB
  6226'   CD 5408'       C      	CALL	U1.RRST
  6229'   C9             C      	RET
                         C      
                         C      ;*******************************************************************
                         C      ;
                         C      ;        Ausgabe eines Blockes auf KMBG
                         C      ;
                         C      ;*******************************************************************
  622A'                  C      UK.KBA:
  622A'   CD 5400'       C      	CALL	U1.RSAVE
  622D'   CD 6205'       C      	CALL	UK.KSPFB
  6230'   CD 5601'       C      	CALL	XY.LDDX
  6233'   07             C      	DB	7
  6234'   EB             C      	EX	DE,HL	;DE:= Blockadresse
  6235'   D5             C      	PUSH	DE	;Blockadresse retten
  6236'   CD 5611'       C      	CALL	XY.LIDX
  6239'   09             C      	DB	9
  623A'   E5             C      	PUSH	HL
  623B'   C1             C      	POP	BC	;BC:= Blocklaenge
  623C'   D1             C      	POP	DE	;DE:= Blockadresse
  623D'   C5             C      	PUSH	BC	;Blocklaenge retten
  623E'   CD 5601'       C      	CALL	XY.LDDX	;HL:= E/A-Pufferanfang
  6241'   19             C      	DB	25
  6242'   ED B0          C      	LDIR		;Block in Systempuffer
  6244'   C1             C      	POP	BC	;BC:= Blocklaenge
  6245'   E5             C      	PUSH	HL	;aktuelle Pufferadresse retten
  6246'   21 0132        C      	LD	HL,UE.KMPUL	;HL:= max. Laenge
  6249'   B7             C      	OR	A
  624A'   ED 42          C      	SBC	HL,BC	;HL:= Restbyteanzahl
  624C'   CD 5621'       C      	CALL	XY.STDX	;Pufferzaehler setzen
  624F'   17             C      	DB	23
  6250'   E5             C      	PUSH	HL
  6251'   C1             C      	POP	BC	;BC:= Restbyteanzahl
  6252'   CD 5601'       C      	CALL	XY.LDDX	;HL:= aktuelle Pufferadresse
  6255'   19             C      	DB	25
  6256'   EB             C      	EX	DE,HL	;DE:= Pufferanfang
  6257'   E1             C      	POP	HL
  6258'   ED B0          C      	LDIR
  625A'   EB             C      	EX	DE,HL	;HL:= aktuelle Pufferadresse
  625B'   CD 5621'       C      	CALL	XY.STDX	;Pufferzeiger setzen
  625E'   15             C      	DB	21
  625F'   DD 36 04 08    C      	LD	(IX+4),08H
  6263'   CD 5D25'       C      	CALL	UF.EXEC	;physische Blockausgabe
  6266'   F5             C      	PUSH	AF
  6267'   CD 5641'       C      	CALL	XY.INCDX	;Blockzaehler erhoehen
  626A'   11             C      	DB	17
  626B'   F1             C      	POP	AF
  626C'   CD 5408'       C      	CALL	U1.RRST
  626F'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                                ;
                                ;	INCLUDE	KI.MAC	;Initialisieren von MRES Kassetten
                                ;	INCLUDE	KV.MAC	;Anzeigen und Aendern des MRES-Verzeichnisses
                                ;	INCLUDE	KH.MAC	;Kommandos: KRDx und KWRx
                                ;	INCLUDE	FD.MAC	;Ein-/Ausgabe im freien Format
                                ;	INCLUDE LD.MAC	;Laden von MRES-P-Dateien
                                ;	INCLUDE RL.MAC	;Relativloader fuer O-Dateien
                                ;	INCLUDE SV.MAC	;Retten von Maschinencodeprogrammen als MRES - P-Datei
                         C      	INCLUDE K3.MAC	;MRES Routinen
                         C      	TITLE	'Initialisieren von MRES Kassetten'
                         C      	PAGE
'Initialisieren von MRES Kassetten'	MACRO-80 3.44	09-Dec-81	PAGE	1-47


                         C      
                         C      ;	PN	KI
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;      INITIALISIEREN VON MRES KASSETTEN
                         C      ;
                         C      ;----------------------------------------------------------------------
  6270'   6270'          C      	DW	$
  6272'   49 4E 49 54    C      	DB	'INIT'
  6276'   21 4070        C      	LD	HL,PUF.KASS	;Puffer fuer Umbenennung Kassette loeschen
  6279'   11 4071        C      	LD	DE,PUF.KASS+1
  627C'   01 000F        C      	LD	BC,15
  627F'   36 20          C      	LD	(HL),020H
  6281'   ED B0          C      	LDIR
  6283'   3A 3327        C      	LD	A,(UE.BWSA+327H)
  6286'   CD 55C5'       C      	CALL	U1.TST
  6289'   D8             C      	RET	C
  628A'   F5             C      	PUSH	AF
  628B'   CD 54E2'       C      	CALL	U1.KTINI
  628E'   F1             C      	POP	AF
  628F'   DD 77 03       C      	LD	(IX+3),A	;GERAETEADR. -->TAB
  6292'   CD 6095'       C      	CALL	UR.KRE	;RES. EIN
  6295'   DD CB 00 56    C      	BIT	2,(IX+0)
  6299'   28 05          C      	JR	Z,$+7
  629B'   3E 19          C      	LD	A,19H
  629D'   CD 5D55'       C      	CALL	UF.ERANZ
  62A0'   CD 60A3'       C      	CALL	UR.KRWW	;RUECKSPULEN MIT WARTEN
  62A3'   CD 60B9'       C      	CALL	UR.KBM	;BM SCHREIBEN
  62A6'   21 0E66        C      	LD	HL,UE.PUF	;AUFBAU 1.BLOCK
  62A9'   3E 40          C      	LD	A,40H
  62AB'   06 50          C      	LD	B,80
  62AD'   CD 55A6'       C      	CALL	U1.TR
  62B0'   3E 00          C      	LD	A,00H
  62B2'   06 30          C      	LD	B,48
  62B4'   CD 55A6'       C      	CALL	U1.TR
  62B7'   DD 36 0A 80    C      	LD	(IX+10),80H	;Blocklaenge
  62BB'   DD 36 04 08    C      	LD	(IX+4),08H	;CMD SCHREIBEN
  62BF'   CD 5D25'       C      	CALL	UF.EXEC
  62C2'   CD 636B'       C      	CALL	KI.KO03
  62C5'                  C      KI.KN:
  62C5'   CD 55B1'       C      	CALL	U1.BILO
  62C8'   3E 0D          C      	LD	A,13
  62CA'   32 2B00'       C      	LD	(UB.ZN),A	;ZEILENNR. 15
  62CD'   21 5E1F'       C      	LD	HL,UA.KNAME	;ABFRAGE KASS.NAME
  62D0'   CD 595C'       C      	CALL	UR.MIMO
  62D3'   D8             C      	RET	C
                         C      ;---\
  62D4'   E5             C      	PUSH	HL
  62D5'   C5             C      	PUSH	BC
  62D6'   11 4070        C      	LD	DE,PUF.KASS
  62D9'   01 0006        C      	LD	BC,6
  62DC'   ED B0          C      	LDIR
  62DE'   C1             C      	POP	BC
  62DF'   E1             C      	POP	HL
                         C      ;---/
  62E0'   06 06          C      	LD	B,6
  62E2'   11 0E6A        C      	LD	DE,UE.PUF+4	;NAME IN PUFFER
  62E5'   CD 57BA'       C      	CALL	UC.KONV	;MIT KONVERTIERUNG IN DKOI-CODE
  62E8'                  C      KI.NMR:
  62E8'   21 5E32'       C      	LD	HL,UA.NR	;ABFR. KASS.NUMMER
  62EB'   CD 595C'       C      	CALL	UR.MIMO
  62EE'   38 D5          C      	JR	C,KI.KN	;BEI SYS-TASTE ZU VORHERIGER
                         C      ;---\
  62F0'   E5             C      	PUSH	HL
  62F1'   C5             C      	PUSH	BC
  62F2'   11 4076        C      	LD	DE,PUF.KASS+6
  62F5'   01 0003        C      	LD	BC,3
  62F8'   ED B0          C      	LDIR
  62FA'   C1             C      	POP	BC
  62FB'   E1             C      	POP	HL
                         C      ;---/
  62FC'   06 03          C      	LD	B,3
  62FE'   11 0E8B        C      	LD	DE,UE.PUF+37
  6301'   CD 57BA'       C      	CALL	UC.KONV
  6304'                  C      KI.KM:
  6304'   21 5E45'       C      	LD	HL,UA.KOMMT	;ABFR. KOMMENTAR
  6307'   CD 595C'       C      	CALL	UR.MIMO
  630A'   38 B9          C      	JR	C,KI.KN
  630C'   06 0B          C      	LD	B,11
  630E'   11 0E8E        C      	LD	DE,UE.PUF+40
  6311'   CD 57BA'       C      	CALL	UC.KONV
  6314'   CD 5D25'       C      	CALL	UF.EXEC	;3.BLOCK SCHREIBEN
'Initialisieren von MRES Kassetten'	MACRO-80 3.44	09-Dec-81	PAGE	1-48


  6317'   CD 6376'       C      	CALL	KI.RENA	;Kassette umbenennen
  631A'   CD 60B9'       C      	CALL	UR.KBM	;BM , 1.LABEL BEENDET
  631D'   21 6075'       C      	LD	HL,UA.ALTR
  6320'   11 0E66        C      	LD	DE,UE.PUF
  6323'   01 0020        C      	LD	BC,20H
  6326'   ED B0          C      	LDIR		;AUSGLEICH LFWSTLNZ->PUFFER
  6328'   DD 36 0A 20    C      	LD	(IX+10),20H	;NEUE BLOCKLAENGE
  632C'   DD 36 04 08    C      	LD	(IX+4),08H
  6330'   CD 5D25'       C      	CALL	UF.EXEC	;SCHREIBEN
  6333'   21 5DFF'       C      	LD	HL,UA.DS
  6336'   11 0E66        C      	LD	DE,UE.PUF
  6339'   01 0020        C      	LD	BC,32
  633C'   ED B0          C      	LDIR		;DS-SATZ --> PUFFER
  633E'   CD 5D25'       C      	CALL	UF.EXEC
  6341'   3E A5          C      	LD	A,0A5H
  6343'   06 20          C      	LD	B,32
  6345'   21 0E66        C      	LD	HL,UE.PUF
  6348'   CD 55A6'       C      	CALL	U1.TR
  634B'   06 68          C      	LD	B,68H	;103 VERZ.SAETZE
  634D'                  C      KI.VERZ:
  634D'   C5             C      	PUSH	BC
  634E'   CD 5D25'       C      	CALL	UF.EXEC
  6351'   C1             C      	POP	BC
  6352'   10 F9          C      	DJNZ	KI.VERZ
  6354'   CD 60B9'       C      	CALL	UR.KBM
  6357'   CD 547F'       C      	CALL	U1.VS1	;1.DATEIVORSATZ -->PUFFER
  635A'   DD 36 04 08    C      	LD	(IX+4),08H
  635E'   CD 5D25'       C      	CALL	UF.EXEC
  6361'   CD 60BF'       C      	CALL	UR.KSL	;SCHLUSSLUECKE SCHREIBEN
  6364'   CD 609D'       C      	CALL	UR.KRW
  6367'   CD 60A7'       C      	CALL	UR.KRA
  636A'   C9             C      	RET
                         C      ;
  636B'                  C      KI.KO03:
  636B'   CD 5D25'       C      	CALL	UF.EXEC	;FUER KI14
  636E'   06 31          C      	LD	B,49
  6370'   2B             C      	DEC	HL
  6371'   10 FD          C      	DJNZ	$-1
  6373'   36 D9          C      	LD	(HL),0D9H
  6375'   C9             C      	RET
                         C      ;
  6376'                  C      KI.RENA:	;Kassettendateiname umbenennen
  6376'   E5             C      	PUSH	HL
  6377'   D5             C      	PUSH	DE
  6378'   C5             C      	PUSH	BC
  6379'   F5             C      	PUSH	AF
  637A'   21 407A        C      	LD	HL,PUF.KASS+10
  637D'   36 00          C      	LD	(HL),0          ;Abschluss neuer Name
  637F'   21 6395'       C      	LD	HL,KI.RENA9+2
  6382'   DD 7E 03       C      	LD	A,(IX+3)        ;SubAdresse
  6385'   77             C      	LD	(HL),A
  6386'   21 6393'       C      	LD	HL,KI.RENA9
  6389'   01 0730        C      	LD	BC,00700H + AKB ;AKB-Adresse + Laenge Parameterbereich
  638C'   ED B3          C      	OTIR
  638E'   F1             C      	POP	AF
  638F'   C1             C      	POP	BC
  6390'   D1             C      	POP	DE
  6391'   E1             C      	POP	HL
  6392'   C9             C      	RET
  6393'                  C      KI.RENA9:
  6393'   F0             C      	DB	0F0H
  6394'   44             C      	DB	044H            ;Kommando
  6395'   00             C      	DB	0               ;SubAdresse
  6396'   01             C      	DB	1               ;HSbereich
  6397'   40             C      	DB	HIGH(PUF.KASS)
  6398'   70             C      	DB	LOW(PUF.KASS)
  6399'   FF             C      	DB	0FFH
                         C      ;---------------------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Anzeigen und Aendern des MRES-Verzeichnisses'
                         C      	PAGE
'Anzeigen und Aendern des MRES-Verzeichnisses'	MACRO-80 3.44	09-Dec-81	PAGE	1-49


                         C      
                         C      ;	PN	KV
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;    ANZEIGEN UND AENDERN DES VERZEICHNISSES VON MRES KASSETTEN
                         C      ;
                         C      ;----------------------------------------------------------------------
  639A'   639A'          C      	DW	$
  639C'   44 49 52 20    C      	DB	'DIR '
  63A0'   3A 3326        C      	LD	A,(UE.BWSA+326H)
  63A3'   CD 55C5'       C      	CALL	U1.TST
  63A6'   D8             C      	RET	C
  63A7'   CD 54E2'       C      	CALL	U1.KTINI
  63AA'   DD 77 03       C      	LD	(IX+3),A
  63AD'   CD 55B1'       C      	CALL	U1.BILO
  63B0'   CD 6095'       C      	CALL	UR.KRE
  63B3'   CD 60A3'       C      	CALL	UR.KRWW
  63B6'   CD 5496'       C      	CALL	U1.DSVG
  63B9'   C5             C      	PUSH	BC
                         C      ;----------------------------------------------------------------------
  63BA'   CD 5420'       C      	CALL	U1.KBR4	;KASS.NAME,NR.,KOMMENTAR ANZEIGEN
  63BD'   DD 36 04 02    C      	LD	(IX+4),02H
  63C1'   CD 5D25'       C      	CALL	UF.EXEC
  63C4'   21 0E6A        C      	LD	HL,UE.PUF+4
  63C7'   11 3240        C      	LD	DE,UE.BWSA + 7*80 + 16	;3240H	;=8.ZEILE,16.SPALTE
  63CA'   06 06          C      	LD	B,6
  63CC'   CD 57B0'       C      	CALL	UC.DKONV
  63CF'   21 0E8B        C      	LD	HL,UE.PUF+37
  63D2'   13             C      	INC	DE
  63D3'   13             C      	INC	DE
  63D4'   06 03          C      	LD	B,3
  63D6'   CD 57B0'       C      	CALL	UC.DKONV
  63D9'   13             C      	INC	DE
  63DA'   13             C      	INC	DE
  63DB'   06 0B          C      	LD	B,11
  63DD'   CD 57B0'       C      	CALL	UC.DKONV
  63E0'   21 3290        C      	LD	HL,UE.BWSA + 8*80 + 16	;3290H
  63E3'   3E 3D          C      	LD	A,'='
  63E5'   77             C      	LD	(HL),A
  63E6'   E5             C      	PUSH	HL
  63E7'   D1             C      	POP	DE
  63E8'   13             C      	INC	DE
  63E9'   01 0017        C      	LD	BC,23
  63EC'   ED B0          C      	LDIR
                         C      ;----------------------------------------------------------------------
  63EE'   06 03          C      	LD	B,3	;POSITIONIEREN VOR DS-SATZ
  63F0'   CD 5D25'       C      	CALL	UF.EXEC
  63F3'   10 FB          C      	DJNZ	$-3
  63F5'   CD 5518'       C      	CALL	U1.VERIN
  63F8'   CD 60A3'       C      	CALL	UR.KRWW
  63FB'   06 07          C      	LD	B,7
  63FD'   CD 5542'       C      	CALL	U1.VORS1
  6400'   C1             C      	POP	BC
  6401'   05             C      	DEC	B
  6402'   CD 662F'       C      	CALL	KV.ANZ
  6405'   04             C      	INC	B
  6406'   05             C      	DEC	B
  6407'   CA 6551'       C      	JP	Z,KV.KRW
  640A'   04             C      	INC	B
  640B'   C5             C      	PUSH	BC
                         C      ;----------------------------------------------------------------------
  640C'                  C      KV.ANF:
  640C'   05             C      	DEC	B
  640D'   78             C      	LD	A,B
  640E'   58             C      	LD	E,B
  640F'   D6 09          C      	SUB	9
  6411'   38 05          C      	JR	C,$+7
  6413'   0E 09          C      	LD	C,9
  6415'   41             C      	LD	B,C
  6416'   18 03          C      	JR	$+5
  6418'   43             C      	LD	B,E
  6419'   48             C      	LD	C,B
  641A'   AF             C      	XOR	A
  641B'   F5             C      	PUSH	AF	;A=RESTL.ANZAHL ODER 0
  641C'   C5             C      	PUSH	BC
  641D'   21 2B34'       C      	LD	HL,UB.SATZ
  6420'   36 00          C      	LD	(HL),00H
  6422'   23             C      	INC	HL
  6423'   36 37          C      	LD	(HL),55
  6425'   23             C      	INC	HL
  6426'   36 80          C      	LD	(HL),80H
  6428'   23             C      	INC	HL
'Anzeigen und Aendern des MRES-Verzeichnisses'	MACRO-80 3.44	09-Dec-81	PAGE	1-50


  6429'   06 37          C      	LD	B,55
  642B'   3E 20          C      	LD	A,20H
  642D'   CD 55A6'       C      	CALL	U1.TR	;AUSGABESATZ LOESCHEN
  6430'   3E 0D          C      	LD	A,13
  6432'   32 2B00'       C      	LD	(UB.ZN),A
  6435'   CD 55B1'       C      	CALL	U1.BILO
  6438'   11 2B46'       C      	LD	DE,UB.SATZ+18
  643B'   D5             C      	PUSH	DE
  643C'   21 ECA2        C      	LD	HL,BC.VTABE+32	;ADR. VERZ.TABELLE
  643F'   E5             C      	PUSH	HL
                         C      ;---------------------------MAX 9 SAETZE ANZEIGEN----------------------
  6440'                  C      KV.ZLTR:
  6440'   CD 65B7'       C      	CALL	KV.BSTR	;VTABE-->UB.SATZ
  6443'   D1             C      	POP	DE	;VERZ.ADR.
  6444'   E1             C      	POP	HL	;ADR.AUSGABESATZ
  6445'   E5             C      	PUSH	HL
  6446'   D5             C      	PUSH	DE
  6447'   01 0012        C      	LD	BC,18
  644A'   B7             C      	OR	A
  644B'   ED 42          C      	SBC	HL,BC
  644D'   CD 595C'       C      	CALL	UR.MIMO	;ANZEIGE EINE ZEILE
  6450'   E1             C      	POP	HL	;VERZ.ADR
  6451'   D1             C      	POP	DE
  6452'   01 0020        C      	LD	BC,32
  6455'   09             C      	ADD	HL,BC
  6456'   C1             C      	POP	BC
  6457'   05             C      	DEC	B
  6458'   28 05          C      	JR	Z,$+7
  645A'   C5             C      	PUSH	BC
  645B'   D5             C      	PUSH	DE
  645C'   E5             C      	PUSH	HL	;NEUE VERZ.TAB ADR
  645D'   18 E1          C      	JR	KV.ZLTR
                         C      ;----------------------------------------------------------------------
  645F'   41             C      	LD	B,C	;ANZAHL DER ANGEZEIGTEN ZEILEN
  6460'   3A 2B00'       C      	LD	A,(UB.ZN)
  6463'   90             C      	SUB	B
  6464'   32 2B00'       C      	LD	(UB.ZN),A	;KURSOR AUF ANFANG 12.ZEILE
  6467'   C5             C      	PUSH	BC
  6468'   D5             C      	PUSH	DE
  6469'   E5             C      	PUSH	HL
                         C      ;------------------------VERZ. ZEIGER AUF 1.ANGEZEIGTE EINTR.
  646A'   C5             C      	PUSH	BC
  646B'   01 0020        C      	LD	BC,32
  646E'   B7             C      	OR	A
  646F'   ED 42          C      	SBC	HL,BC
  6471'   C1             C      	POP	BC
  6472'   10 F6          C      	DJNZ	$-8
  6474'   E5             C      	PUSH	HL
                         C      ;----------------------------------------------------------------------
  6475'                  C      KV.TABTR:
  6475'   21 6031'       C      	LD	HL,UA.LD
  6478'   CD 595C'       C      	CALL	UR.MIMO	;KURSOR AUF ANF.12.ZEILE
  647B'   DA 64BB'       C      	JP	C,KV.ZEIHO
  647E'   D1             C      	POP	DE
  647F'   D5             C      	PUSH	DE	;ZIELADR.IN VTAB
  6480'   CD 65E4'       C      	CALL	KV.SPTR	;ZEILE WIEDER IN SPEICHER
  6483'   E1             C      	POP	HL	;ZIELADR.IN VTAB
  6484'   01 0020        C      	LD	BC,32
  6487'   09             C      	ADD	HL,BC
  6488'   FD E1          C      	POP	IY
  648A'   D1             C      	POP	DE
  648B'   C1             C      	POP	BC
  648C'   05             C      	DEC	B
  648D'   28 07          C      	JR	Z,$+9
  648F'   C5             C      	PUSH	BC
  6490'   D5             C      	PUSH	DE
  6491'   FD E5          C      	PUSH	IY
  6493'   E5             C      	PUSH	HL
  6494'   18 DF          C      	JR	KV.TABTR
                         C      ;--------------------WEITERBLAETTERN ODER AUSGABE----------------------
  6496'   F1             C      	POP	AF
  6497'   B7             C      	OR	A
  6498'   28 42          C      	JR	Z,KV.AUSG	;KEINE WEITEREN ANZEIGEN
  649A'   D6 09          C      	SUB	9
  649C'   38 05          C      	JR	C,$+7
  649E'   06 09          C      	LD	B,9
  64A0'   48             C      	LD	C,B
  64A1'   18 05          C      	JR	$+7
  64A3'   C6 09          C      	ADD	A,9
  64A5'   47             C      	LD	B,A
  64A6'   48             C      	LD	C,B
  64A7'   AF             C      	XOR	A
  64A8'   F5             C      	PUSH	AF
'Anzeigen und Aendern des MRES-Verzeichnisses'	MACRO-80 3.44	09-Dec-81	PAGE	1-51


  64A9'   C5             C      	PUSH	BC
  64AA'   D5             C      	PUSH	DE
  64AB'   E5             C      	PUSH	HL
  64AC'   3E 0D          C      	LD	A,13
  64AE'   32 2B00'       C      	LD	(UB.ZN),A
  64B1'   CD 55B1'       C      	CALL	U1.BILO
  64B4'   E1             C      	POP	HL
  64B5'   D1             C      	POP	DE
  64B6'   D5             C      	PUSH	DE
  64B7'   E5             C      	PUSH	HL
  64B8'   C3 6440'       C      	JP	KV.ZLTR
                         C      ;----------------------------------------------------------------------
  64BB'                  C      KV.ZEIHO:
  64BB'   21 2B00'       C      	LD	HL,UB.ZN
  64BE'   7E             C      	LD	A,(HL)
  64BF'   D6 0F          C      	SUB	15
  64C1'   38 15          C      	JR	C,$+23	;WENN IN 12. ZEILE SYS GEDRUECKT
  64C3'   35             C      	DEC	(HL)
  64C4'   35             C      	DEC	(HL)	;ZEILENNR.-2
  64C5'   E1             C      	POP	HL
  64C6'   01 0020        C      	LD	BC,32
  64C9'   B7             C      	OR	A
  64CA'   ED 42          C      	SBC	HL,BC	;VERZ.ZEIGER RUECKSETZEN
  64CC'   FD E1          C      	POP	IY
  64CE'   D1             C      	POP	DE
  64CF'   C1             C      	POP	BC
  64D0'   04             C      	INC	B
  64D1'   C5             C      	PUSH	BC
  64D2'   D5             C      	PUSH	DE
  64D3'   FD E5          C      	PUSH	IY
  64D5'   E5             C      	PUSH	HL
  64D6'   18 01          C      	JR	$+3
  64D8'   35             C      	DEC	(HL)
  64D9'   C3 6475'       C      	JP	KV.TABTR
                         C      ;----------------------------------------------------------------------
  64DC'                  C      KV.AUSG:
  64DC'   E5             C      	PUSH	HL
  64DD'   21 6043'       C      	LD	HL,UA.ZRSCH
  64E0'   CD 595C'       C      	CALL	UR.MIMO
  64E3'   7E             C      	LD	A,(HL)
  64E4'   E1             C      	POP	HL
  64E5'   FE 4A          C      	CP	'J'
  64E7'   28 11          C      	JR	Z,$+19
  64E9'   21 605C'       C      	LD	HL,UA.ANZWD
  64EC'   CD 595C'       C      	CALL	UR.MIMO
  64EF'   7E             C      	LD	A,(HL)
  64F0'   FE 4A          C      	CP	'J'
  64F2'   C1             C      	POP	BC
  64F3'   C2 6551'       C      	JP	NZ,KV.KRW
  64F6'   C5             C      	PUSH	BC
  64F7'   C3 640C'       C      	JP	KV.ANF
                         C      ;--------------------------------Dateien am Ende loeschen ? ---------
  64FA'   CD 6625'       C      	CALL	KV.SBC
  64FD'   20 34          C      	JR	NZ,$+54
  64FF'   3A EC85        C      	LD	A,(BC.VTABE+3)
  6502'   3D             C      	DEC	A
  6503'   5F             C      	LD	E,A
  6504'   16 00          C      	LD	D,0
  6506'   3E 01          C      	LD	A,1
  6508'   82             C      	ADD	A,D
  6509'   57             C      	LD	D,A
  650A'   1D             C      	DEC	E
  650B'   28 05          C      	JR	Z,$+7
  650D'   CD 6625'       C      	CALL	KV.SBC
  6510'   28 F4          C      	JR	Z,$-10
  6512'   C1             C      	POP	BC	;D: Anzahl zu loeschender Dateien
  6513'   79             C      	LD	A,C
  6514'   92             C      	SUB	D
  6515'   32 0E67        C      	LD	(UE.PUF+1),A	;DS-Satz korrigieren
  6518'   78             C      	LD	A,B
  6519'   92             C      	SUB	D
  651A'   32 0E69        C      	LD	(UE.PUF+3),A
  651D'   CD 60CB'       C      	CALL	UR.KBR
  6520'   CD 60CB'       C      	CALL	UR.KBR
  6523'   CD 60C5'       C      	CALL	UR.KBV
  6526'   DD 36 04 08    C      	LD	(IX+4),08H
  652A'   CD 5D25'       C      	CALL	UF.EXEC	;und schreiben
  652D'   47             C      	LD	B,A
  652E'   05             C      	DEC	B
  652F'   28 20          C      	JR	Z,$+34
  6531'   04             C      	INC	B
  6532'   C5             C      	PUSH	BC
                         C      ;-------------------------------------Verzeichnis schreiben -----------
'Anzeigen und Aendern des MRES-Verzeichnisses'	MACRO-80 3.44	09-Dec-81	PAGE	1-52


  6533'   C1             C      	POP	BC
  6534'   05             C      	DEC	B
  6535'   21 ECA2        C      	LD	HL,BC.VTABE+32
  6538'   C5             C      	PUSH	BC
  6539'   11 0E66        C      	LD	DE,UE.PUF
  653C'   01 0020        C      	LD	BC,32
  653F'   ED B0          C      	LDIR
  6541'   CD 60C5'       C      	CALL	UR.KBV
  6544'   CD 60CB'       C      	CALL	UR.KBR
  6547'   DD 36 04 08    C      	LD	(IX+4),08H	;OHNE RAW
  654B'   CD 5D25'       C      	CALL	UF.EXEC
  654E'   C1             C      	POP	BC
  654F'   10 E7          C      	DJNZ	$-23
                         C      ;---------------------------------------------------------------------
  6551'                  C      KV.KRW:
  6551'   CD 609D'       C      	CALL	UR.KRW
  6554'   CD 60A7'       C      	CALL	UR.KRA
  6557'   3A 3328        C      	LD	A,(UE.BWSA+328H)
  655A'   FE 44          C      	CP	'D'
  655C'   C0             C      	RET	NZ
  655D'   21 323D        C      	LD	HL,UE.BWSA+23DH
  6560'   00             C      	NOP
  6561'   CD 659D'       C      	CALL	KV.DRU1
  6564'   21 328D        C      	LD	HL,UE.BWSA+28DH
  6567'   CD 659D'       C      	CALL	KV.DRU1
  656A'   CD 4040        C      	CALL	PRINT
  656D'   21 2B6E'       C      	LD	HL,UB.DTAB
  6570'   11 2B6F'       C      	LD	DE,UB.DTAB+1
  6573'   01 0028        C      	LD	BC,40
  6576'   36 20          C      	LD	(HL),20H
  6578'   ED B0          C      	LDIR
  657A'   3A EC85        C      	LD	A,(BC.VTABE+3)
  657D'   47             C      	LD	B,A
  657E'   05             C      	DEC	B
  657F'   21 EC82        C      	LD	HL,BC.VTABE
  6582'   11 0020        C      	LD	DE,32
  6585'                  C      KV.P1:
  6585'   C5             C      	PUSH	BC
  6586'   19             C      	ADD	HL,DE
  6587'   E5             C      	PUSH	HL
  6588'   D5             C      	PUSH	DE
  6589'   11 2B6E'       C      	LD	DE,UB.DTAB
  658C'   CD 65B7'       C      	CALL	KV.BSTR
  658F'   21 2B6E'       C      	LD	HL,UB.DTAB
  6592'   06 28          C      	LD	B,40
  6594'   CD 659F'       C      	CALL	KV.DRU
  6597'   D1             C      	POP	DE
  6598'   E1             C      	POP	HL
  6599'   C1             C      	POP	BC
  659A'   10 E9          C      	DJNZ	KV.P1
  659C'   C9             C      	RET
                         C      
  659D'                  C      KV.DRU1:
  659D'   06 1E          C      	LD	B,30
  659F'                  C      KV.DRU:
  659F'   7E             C      	LD	A,(HL)
  65A0'   23             C      	INC	HL
  65A1'   CD 65AC'       C      	CALL	KV.KO02
  65A4'   10 F9          C      	DJNZ	KV.DRU
  65A6'   3E 1E          C      	LD	A,1EH
  65A8'   CD 4040        C      	CALL	PRINT
  65AB'   C9             C      	RET
                         C      ;
  65AC'                  C      KV.KO02:
  65AC'   CB BF          C      	RES	7,A	;FUER KV17 (DRUCKERAUSGABE)
  65AE'   FE 20          C      	CP	20H
  65B0'   30 02          C      	JR	NC,$+4
  65B2'   3E 2A          C      	LD	A,2AH
  65B4'   C3 4040        C      	JP	PRINT
                         C      ;---------------------------------------------------------------------
  65B7'                  C      KV.BSTR:
  65B7'   01 0006        C      	LD	BC,6	;Aufbereitung des Verz.Satzes
  65BA'   C5             C      	PUSH	BC
  65BB'   ED B0          C      	LDIR		;Transport VTABE--->UB.SATZ
  65BD'   13             C      	INC	DE
  65BE'   13             C      	INC	DE
  65BF'   13             C      	INC	DE
  65C0'   01 0002        C      	LD	BC,2
  65C3'   ED B0          C      	LDIR
  65C5'   13             C      	INC	DE
  65C6'   13             C      	INC	DE
  65C7'   13             C      	INC	DE
  65C8'   C1             C      	POP	BC
'Anzeigen und Aendern des MRES-Verzeichnisses'	MACRO-80 3.44	09-Dec-81	PAGE	1-53


  65C9'   C5             C      	PUSH	BC
  65CA'   ED B0          C      	LDIR
  65CC'   13             C      	INC	DE
  65CD'   13             C      	INC	DE
  65CE'   13             C      	INC	DE
  65CF'   C1             C      	POP	BC
  65D0'   ED B0          C      	LDIR
  65D2'   13             C      	INC	DE
  65D3'   13             C      	INC	DE
  65D4'   13             C      	INC	DE
  65D5'   01 0003        C      	LD	BC,3
  65D8'   ED B0          C      	LDIR
  65DA'   13             C      	INC	DE
  65DB'   13             C      	INC	DE
  65DC'   13             C      	INC	DE
  65DD'   6E             C      	LD	L,(HL)	;Konvertierung Labelnummer
  65DE'   26 00          C      	LD	H,0
  65E0'   CD 571C'       C      	CALL	UC.CVBD2
  65E3'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  65E4'                  C      KV.SPTR:
  65E4'   7E             C      	LD	A,(HL)
  65E5'   FE 09          C      	CP	09H	;Soll Satz geloescht werden?
  65E7'   20 02          C      	JR	NZ,$+4
  65E9'   AF             C      	XOR	A
  65EA'   77             C      	LD	(HL),A
  65EB'   01 0006        C      	LD	BC,6
  65EE'   C5             C      	PUSH	BC
  65EF'   ED B0          C      	LDIR		;Ruecktransport BWSA--->VTABE
  65F1'   23             C      	INC	HL
  65F2'   23             C      	INC	HL
  65F3'   23             C      	INC	HL
  65F4'   01 0002        C      	LD	BC,2
  65F7'   ED B0          C      	LDIR
  65F9'   23             C      	INC	HL
  65FA'   23             C      	INC	HL
  65FB'   23             C      	INC	HL
  65FC'   C1             C      	POP	BC
  65FD'   C5             C      	PUSH	BC
  65FE'   ED B0          C      	LDIR
  6600'   23             C      	INC	HL
  6601'   23             C      	INC	HL
  6602'   23             C      	INC	HL
  6603'   C1             C      	POP	BC
  6604'   ED B0          C      	LDIR
  6606'   23             C      	INC	HL
  6607'   23             C      	INC	HL
  6608'   23             C      	INC	HL
  6609'   01 0003        C      	LD	BC,3
  660C'   ED B0          C      	LDIR
  660E'   23             C      	INC	HL
  660F'   23             C      	INC	HL
  6610'   23             C      	INC	HL
  6611'   D5             C      	PUSH	DE
  6612'   EB             C      	EX	DE,HL
  6613'   CD 661A'       C      	CALL	KV.DBCVM
  6616'   7D             C      	LD	A,L
  6617'   E1             C      	POP	HL
  6618'   77             C      	LD	(HL),A
  6619'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  661A'                  C      KV.DBCVM:
  661A'   06 02          C      	LD	B,2	;FELDLAENGE
  661C'   CD 5761'       C      	CALL	UC.CVDB	;KONVERTIER. DEZI-->BINAER
  661F'   D0             C      	RET	NC		;OHNE FEHLER
  6620'   C0             C      	RET	NZ
  6621'   13             C      	INC	DE	;1.ZEICHEN WAR KEINE DEZ.ZAHL
  6622'   10 F8          C      	DJNZ	$-6
  6624'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  6625'                  C      KV.SBC:
  6625'   01 0020        C      	LD	BC,32
  6628'   B7             C      	OR	A
  6629'   ED 42          C      	SBC	HL,BC
  662B'   7E             C      	LD	A,(HL)
  662C'   FE 00          C      	CP	00H
  662E'   C9             C      	RET
                         C      ;---------------------------------------------------------------------
  662F'                  C      KV.ANZ:
  662F'   C5             C      	PUSH	BC
  6630'   68             C      	LD	L,B
  6631'   26 00          C      	LD	H,0
  6633'   11 3332        C      	LD	DE,3332H
'Anzeigen und Aendern des MRES-Verzeichnisses'	MACRO-80 3.44	09-Dec-81	PAGE	1-54


  6636'   CD 5718'       C      	CALL	UC.CVBD3
  6639'   13             C      	INC	DE
  663A'   13             C      	INC	DE
  663B'   21 6645'       C      	LD	HL,KV.AVZS
  663E'   01 0011        C      	LD	BC,17
  6641'   ED B0          C      	LDIR
  6643'   C1             C      	POP	BC
  6644'   C9             C      	RET
                         C      ;-----------------------------------------------------------------------
  6645'                  C      KV.AVZS:
  6645'   56 65 72 7A    C      	DB	'Verzeichnissaetze'
  6649'   65 69 63 68    C      
  664D'   6E 69 73 73    C      
  6651'   61 65 74 7A    C      
  6655'   65             C      
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Kommandos: KRDx und KWRx'
                         C      	PAGE
'Kommandos: KRDx und KWRx'	MACRO-80 3.44	09-Dec-81	PAGE	1-55


                         C      
                         C      ;	PN	KH
                         C      ;**********************************************************************
                         C      ;
                         C      ;   Kommando:
                         C      ;        KRDx...Block einlesen und anzeigen
                         C      ;               zusaetlich werden die entsprechenden Puffer-
                         C      ;               adressen angezeigt.
                         C      ;        KWRx...Block schreiben, standardmaessig nach 'KRDx'
                         C      ;               Ansonsten muessen Blockadresse und Blocklaenge in der
                         C      ;               Verstaendigungstabelle eingetragen werden.
                         C      ;
                         C      ;**********************************************************************
  6656'   6656'          C      	DW	$
  6658'   4B 52 57 31    C      	DB	'KRW1'
  665C'   18 06          C      	JR	KH.RDSTA
                         C      ;
  665E'   665E'          C      	DW	$
  6660'   4B 52 57 32    C      	DB	'KRW2'
  6664'                  C      KH.RDSTA:
  6664'   CD 54E2'       C      	CALL	U1.KTINI	;Initialisierung E/A-Tab.
  6667'   3A 3325        C      	LD	A,(UE.BWSA + 10*80 + 5)	;325H i von KRDi
  666A'   E6 0F          C      	AND	0FH
  666C'   DD 77 03       C      	LD	(IX+3),A	;Subadresse eintragen
  666F'                  C      KH.RES:
  666F'                  C      KH.KSRE:
  666F'   CD 6095'       C      	CALL	UR.KRE	;Reservieren
  6672'                  C      KH.RD1:
  6672'                  C      KH.KSRW:
  6672'   DD 36 04 21    C      	LD	(IX+4),021H	;umspulen (rewind)
  6676'   CD 5D25'       C      	CALL	UF.EXEC
  6679'   C3 66FE'       C      	JP		KH.RDBA
                         C      ;
                         C      ;	Z Y K L U S  C<ber Tastatureingaben
  667C'                  C      KH.RD3:	;Zyklus
  667C'   DD 36 0A 00    C      	LD	(IX+10),0	;Anzahl Bandmarken
  6680'   CD 5A88'       C      	CALL	UR.TAREP	;Tastaturabfrage
  6683'   FE 80          C      	CP	080H
  6685'   28 E8          C      	JR	Z,KH.KSRE	;---> P 01	Reservieren EIN
  6687'   FE 82          C      	CP	082H
  6689'   28 2A          C      	JR	Z,KH.KSRA	;---> P 03	Reservieren AUS
  668B'   FE 81          C      	CP	081H
  668D'   28 E3          C      	JR	Z,KH.KSRW	;---> P 02	Rewind
                         C      
  668F'   FE 83          C      	CP	083H
  6691'   28 31          C      	JR	Z,KH.KSRP	;---> P 04	        read; display
  6693'   FE 85          C      	CP	085H
  6695'   28 2A          C      	JR	Z,KH.KSRM	;---> P 06	R-; R-; read; display
                         C      
  6697'   DD 36 0A 01    C      	LD	(IX+10),1	;Anzahl Bandmarken
  669B'   FE 86          C      	CP	086H
  669D'   28 3C          C      	JR	Z,KH.BMP	;---> P07	BM+
  669F'   FE 88          C      	CP	088H
  66A1'   28 40          C      	JR	Z,KH.BMM	;---> P09	BM-
                         C      
  66A3'   FE 89          C      	CP	089H
  66A5'   28 41          C      	JR	Z,KH.WREC	;---> P10	write Record
  66A7'   FE 8A          C      	CP	08AH
  66A9'   28 49          C      	JR	Z,KH.WBM	;---> P11	write BM
  66AB'   FE 8B          C      	CP	08BH
  66AD'   28 47          C      	JR	Z,KH.WSL	;---> P11	write SL
                         C      
  66AF'   FE CD          C      	CP	0CDH
  66B1'   28 45          C      	JR	Z,KH.SYSRT	;---> SYS
                         C      
  66B3'   18 C7          C      	JR	KH.RD3
                         C      
                         C      ;	P 03	Reservieren AUS
  66B5'                  C      KH.KSRA:
  66B5'   DD 36 04 21    C      	LD	(IX+4),021H	;umspulen (rewind)
  66B9'   CD 5D25'       C      	CALL	UF.EXEC
  66BC'   CD 60A7'       C      	CALL	UR.KRA
  66BF'   18 3D          C      	JR		KH.RDBA
                         C      
                         C      ;	P 06	R-; R-; read; display
  66C1'                  C      KH.KSRM:
  66C1'   CD 6760'       C      	CALL	KH.RD2
                         C      ;	P 04	        read; display
  66C4'                  C      KH.KSRP:
  66C4'   DD 36 04 02    C       	LD	(IX+4),002H	;naechst Record lesen
  66C8'   CD 5D25'       C      	CALL	UF.EXEC
  66CB'   DD 7E 1C       C      	LD	A,(IX+28)	;Lade die Laenge des Blockes
'Kommandos: KRDx und KWRx'	MACRO-80 3.44	09-Dec-81	PAGE	1-56


  66CE'   FE 01          C      	CP	1	;Laenge = 1, dann BandMarke
  66D0'   28 3D          C      	JR	Z,KH.RDBM
  66D2'   FE 02          C      	CP	2	;Laenge = 2, dann Schlussluecke
  66D4'   28 4A          C      	JR	Z,KH.RDSL
  66D6'   CD 6731'       C      	CALL	KH.ANZBL	;Block anzeigen
  66D9'   18 A1          C      	JR	KH.RD3
                         C      
                         C      ;	P 07	BM+
  66DB'                  C      KH.BMP:
  66DB'   CD 60AD'       C      	CALL	UR.KLV	;Bandmarke vorsetzen
  66DE'   CD 60CB'       C      	CALL	UR.KBR	;Record    zuruecksetzen
  66E1'   18 E1          C      	JR	KH.KSRP
                         C      ;	P 09	BM-
  66E3'                  C      KH.BMM:
  66E3'   CD 60B3'       C      	CALL	UR.KLR	;Bandmarke zurC<cksetzen
  66E6'   18 DC          C      	JR	KH.KSRP
                         C      
                         C      ;	P 10	write Record
  66E8'                  C      KH.WREC:
  66E8'   DD 36 04 08    C      	LD	(IX+4),08H
  66EC'   CD 5D25'       C      	CALL	UF.EXEC
  66EF'   CD 60CB'       C      	CALL	UR.KBR
  66F2'   18 88          C      	JR	KH.RD3
                         C      
                         C      ;	P 11	write BM
  66F4'                  C      KH.WBM:
  66F4'   18 86          C      	JR	KH.RD3
                         C      
                         C      ;	P 12	write SL
  66F6'                  C      KH.WSL:
  66F6'   18 84          C      	JR	KH.RD3
                         C      
                         C      ;	SYS		Systemruecksprung
  66F8'                  C      KH.SYSRT:
  66F8'   CD 67DA'       C      	CALL	KH.BILO
  66FB'   C3 000B        C      	JP	SY.SYSTB
                         C      
  66FE'                  C      KH.RDBA:
  66FE'   CD 67DA'       C      	CALL	KH.BILO
  6701'   21 6011'       C      	LD	HL,UA.ZKBA	;"Bandanfang"
  6704'   11 3000        C      	LD	DE,UE.BWSA
  6707'   01 000A        C      	LD	BC,UA.ZKBM-UA.ZKBA
  670A'   ED B0          C      	LDIR
  670C'   C3 667C'       C      	JP	KH.RD3
                         C      
  670F'                  C      KH.RDBM:
  670F'   CD 67DA'       C      	CALL	KH.BILO
  6712'   21 601B'       C      	LD	HL,UA.ZKBM	;"Bandmarke"
  6715'   11 3000        C      	LD	DE,UE.BWSA
  6718'   01 0009        C      	LD	BC,UA.ZKSL-UA.ZKBM
  671B'   ED B0          C      	LDIR
  671D'   C3 667C'       C      	JP	KH.RD3
                         C      
  6720'                  C      KH.RDSL:
  6720'   CD 67DA'       C      	CALL	KH.BILO
  6723'   21 6024'       C      	LD	HL,UA.ZKSL	;"Schlussluecke"
  6726'   11 3000        C      	LD	DE,UE.BWSA
  6729'   01 000D        C      	LD	BC,UA.ZKEE-UA.ZKSL
  672C'   ED B0          C      	LDIR
  672E'   C3 667C'       C      	JP	KH.RD3
                         C      
  6731'                  C      KH.ANZBL:
  6731'   CD 67DA'       C      	CALL	KH.BILO
  6734'                  C      KH.ANZB1:
  6734'   21 0E66        C      	LD	HL,UE.PUF
  6737'   FE 20          C      	CP	020H
  6739'   20 04          C      	JR	NZ,KH.ANZB2
  673B'   06 02          C      	LD	B,2	; 2 Zeilen anzeigen
  673D'   18 0A          C      	JR	KH.ANZB4
  673F'                  C      KH.ANZB2:
  673F'   FE 80          C      	CP	080H
  6741'   20 04          C      	JR	NZ,KH.ANZB3
  6743'   06 08          C      	LD	B,8	; 8 Zeilen anzeigen
  6745'   18 02          C      	JR	KH.ANZB4
  6747'                  C      KH.ANZB3:
  6747'   06 18          C      	LD	B,24	; 24 Zeilen anzeigen
  6749'                  C      KH.ANZB4:
  6749'   CD 674D'       C      	CALL	KH.AZBLD	;Bild anzeigen (24 Zeilen)
  674C'   C9             C      	RET		; IN...HL:=akt. Pufferadresse
                         C      
  674D'                  C      KH.AZBLD:
  674D'   11 3000        C      	LD	DE,UE.BWSA
  6750'                  C      KH.AZBL1:
'Kommandos: KRDx und KWRx'	MACRO-80 3.44	09-Dec-81	PAGE	1-57


  6750'   C5             C      	PUSH	BC
  6751'   CD 6769'       C      	CALL	KH.AZ1Z	; 1 Zeile anzeigen
  6754'   C1             C      	POP	BC
  6755'   E5             C      	PUSH	HL	;akt. Pufferadresse retten
  6756'   EB             C      	EX	DE,HL
  6757'   11 0050        C      	LD	DE,80
  675A'   19             C      	ADD	HL,DE	;neuen Zeilenanfang berechnen
  675B'   EB             C      	EX	DE,HL
  675C'   E1             C      	POP	HL
  675D'   10 F1          C      	DJNZ	KH.AZBL1
  675F'   C9             C      	RET
                         C      
  6760'                  C      KH.RD2:
  6760'   F5             C      	PUSH	AF	;Flags retten
  6761'   CD 60CB'       C      	CALL	UR.KBR	;Block ruecksetzen
  6764'   CD 60CB'       C      	CALL	UR.KBR
  6767'   F1             C      	POP	AF
  6768'   C9             C      	RET
                         C      ;                                IN...HL:= Pufferadresse
                         C      ;                                     DE:= Zeilenanfang
  6769'                  C      KH.AZ1Z:
  6769'   D5             C      	PUSH	DE	;eine Zeile anzeigen
  676A'   E5             C      	PUSH	HL
  676B'   D5             C      	PUSH	DE
  676C'   E1             C      	POP	HL
  676D'   01 0040        C      	LD	BC,64
  6770'   09             C      	ADD	HL,BC
  6771'   E5             C      	PUSH	HL
  6772'   C1             C      	POP	BC	;BC:= Anfang ASCII-Darstellung
  6773'   E1             C      	POP	HL
  6774'   CD 678D'       C      	CALL	KH.AZADR	;Adresse anzeigen
  6777'   13             C      	INC	DE
  6778'   13             C      	INC	DE
  6779'   CD 6796'       C      	CALL	KH.AZ4BY	;1. Vierergruppe
  677C'   13             C      	INC	DE
  677D'   13             C      	INC	DE
  677E'   CD 6796'       C      	CALL	KH.AZ4BY	;2.      ''
  6781'   13             C      	INC	DE
  6782'   13             C      	INC	DE
  6783'   CD 6796'       C      	CALL	KH.AZ4BY	;3.      ''
  6786'   13             C      	INC	DE
  6787'   13             C      	INC	DE
  6788'   CD 6796'       C      	CALL	KH.AZ4BY	;4.      ''
  678B'   D1             C      	POP	DE
  678C'   C9             C      	RET
  678D'                  C      KH.AZADR:
  678D'   7C             C      	LD	A,H	;Anzeige der Adresse
  678E'   CD 56A5'       C      	CALL	UC.CVBX+2
  6791'   7D             C      	LD	A,L
  6792'   CD 56A5'       C      	CALL	UC.CVBX+2
  6795'   C9             C      	RET
  6796'                  C      KH.AZ4BY:
  6796'   AF             C      	XOR	A	;Anzeige einer Vierergruppe
  6797'   32 2B26'       C      	LD	(UB.PAR1),A
  679A'                  C      KH.AZ4B0:
  679A'   7E             C      	LD	A,(HL)
  679B'   F5             C      	PUSH	AF
  679C'   CD 56A5'       C      	CALL	UC.CVBX+2	;Code als Hexadezimalzahl
  679F'   F1             C      	POP	AF
  67A0'   13             C      	INC	DE
  67A1'   23             C      	INC	HL
  67A2'   FE 20          C      	CP	20H
  67A4'   38 15          C      	JR	C,KH.AZ4B1	;nicht darstellbar
  67A6'   FE 7F          C      	CP	7FH
  67A8'   30 11          C      	JR	NC,KH.AZ4B1	;nicht darstellbar
  67AA'                  C      KH.AZ4B3:
  67AA'   02             C      	LD	(BC),A	;Code als ASCII-Zeichen
  67AB'   03             C      	INC	BC
  67AC'   CD 67BF'       C      	CALL	KH.BLEVG	;Test auf Blockende
  67AF'   3A 2B26'       C      	LD	A,(UB.PAR1)
  67B2'   3C             C      	INC	A
  67B3'   FE 04          C      	CP	4
  67B5'   C8             C      	RET	Z
  67B6'   32 2B26'       C      	LD	(UB.PAR1),A
  67B9'   18 DF          C      	JR	KH.AZ4B0
  67BB'                  C      KH.AZ4B1:
  67BB'   3E 7F          C      	LD	A,07FH
  67BD'   18 EB          C      	JR	KH.AZ4B3
  67BF'                  C      KH.BLEVG:
  67BF'   D5             C      	PUSH	DE	;Blockendetest
  67C0'   E5             C      	PUSH	HL
  67C1'   11 0E66        C      	LD	DE,UE.PUF	;DE:= Pufferanfang
  67C4'   B7             C      	OR	A
'Kommandos: KRDx und KWRx'	MACRO-80 3.44	09-Dec-81	PAGE	1-58


  67C5'   ED 52          C      	SBC	HL,DE	;HL:= Anzahl der angezeigten
  67C7'   EB             C      	EX	DE,HL
  67C8'   CD 5611'       C      	CALL	XY.LIDX
  67CB'   09             C      	DB	9
  67CC'   B7             C      	OR	A
  67CD'   ED 52          C      	SBC	HL,DE
  67CF'   E1             C      	POP	HL
  67D0'   D1             C      	POP	DE
  67D1'   28 01          C      	JR	Z,KH.BLEV1
  67D3'   C9             C      	RET
  67D4'                  C      KH.BLEV1:
  67D4'   06 0C          C      	LD	B,12
  67D6'                  C      KH.BLEV2:
  67D6'   33             C      	INC	SP
  67D7'   10 FD          C      	DJNZ	KH.BLEV2
  67D9'   C9             C      	RET		;---> Anzeige beendet
                         C      
                         C      ;----------------------------------------------------
  67DA'                  C      KH.BILO:
  67DA'   21 3000        C      	LD	HL,UE.BWSA
  67DD'   01 077F        C      	LD	BC,24*80 -1	;800H
  67E0'   36 20          C      	LD	(HL),20H
  67E2'   E5             C      	PUSH	HL
  67E3'   D1             C      	POP	DE
  67E4'   13             C      	INC	DE
  67E5'   ED B0          C      	LDIR
  67E7'   C9             C      	RET
                         C      ;------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Ein-/Ausgabe im freien Format'
                         C      	PAGE
'Ein-/Ausgabe im freien Format'	MACRO-80 3.44	09-Dec-81	PAGE	1-59


                         C      
                         C      ;	PN	FD
                         C      ;**********************************************************************
                         C      ;
                         C      ;      Ein-/Ausgabe von Dateien im freien Format in bzw. aus demEditor-
                         C      ;      raum von bzw. auf MRES-Kassetten
                         C      ;
                         C      ;**********************************************************************
                         C      ;      Positionieren auf Datei, IN: <C>:= Labelnummer
                         C      ;
  67E8'                  C      FD.POSK:
  67E8'   C5             C      	PUSH	BC
  67E9'   41             C      	LD	B,C
  67EA'   04             C      	INC	B
  67EB'   CD 60DA'       C      	CALL	UR.POSIK
  67EE'   CD 6800'       C      	CALL	FD.KO01
  67F1'   3A 0E66        C      	LD	A,(UE.PUF)
  67F4'   B9             C      	CP	C
  67F5'   C1             C      	POP	BC
  67F6'   20 01          C      	JR	NZ,$+3
  67F8'   C9             C      	RET
  67F9'   D1             C      	POP	DE
  67FA'   3E 94          C      	LD	A,94H
  67FC'   CD 5D55'       C      	CALL	UF.ERANZ
  67FF'   C9             C      	RET
                         C      ;
  6800'                  C      FD.KO01:
  6800'   DD 36 04 02    C      	LD	(IX+4),002H	;FUER FD19
  6804'   C3 5D25'       C      	JP	UF.EXEC
                         C      ;----------------------------------------------------------------------
                         C      ;      Datei im Verzeichnis suchen
                         C      ;      HL:= Dateiname, <B>:= Anzahl Verzeichniseintragungen + 1
                         C      ;      <D>:= Dateityp
                         C      ;      O:  CY:= 0 Datei nicht vorhanden, <C> unveraendert
                         C      ;          CY:= 1 <C>:= Labelnummer
                         C      ;      K:  B
  6807'                  C      FD.DASU:
  6807'   D5             C      	PUSH	DE
  6808'   05             C      	DEC	B
  6809'   28 0A          C      	JR	Z,$+12
  680B'   CD 6800'       C      	CALL	FD.KO01
  680E'   CD 54C7'       C      	CALL	U1.NMVGL
  6811'   38 05          C      	JR	C,$+7
  6813'   10 F6          C      	DJNZ	$-8
  6815'   B7             C      	OR	A
  6816'   D1             C      	POP	DE
  6817'   C9             C      	RET
  6818'   5F             C      	LD	E,A
  6819'   3A 0E6C        C      	LD	A,(UE.PUF+6)
  681C'   BA             C      	CP	D
  681D'   20 F4          C      	JR	NZ,$-10
  681F'   4B             C      	LD	C,E
  6820'   37             C      	SCF
  6821'   18 F3          C      	JR	$-11
                         C      ;----------------------------------------------------------------------
                         C      ;      Reservebloecke schreiben
                         C      ;
  6823'                  C      FD.WRRES:
  6823'   C5             C      	PUSH	BC
  6824'   D5             C      	PUSH	DE
  6825'   E5             C      	PUSH	HL
  6826'   21 5FC3'       C      	LD	HL,UA.ZKRES
  6829'   CD 595C'       C      	CALL	UR.MIMO
  682C'   EB             C      	EX	DE,HL
  682D'   CD 5761'       C      	CALL	UC.CVDB
  6830'   7C             C      	LD	A,H
  6831'   B5             C      	OR	L
  6832'   20 04          C      	JR	NZ,$+6
  6834'   E1             C      	POP	HL
  6835'   D1             C      	POP	DE
  6836'   C1             C      	POP	BC
  6837'   C9             C      	RET
  6838'   E5             C      	PUSH	HL
  6839'   21 0E66        C      	LD	HL,UE.PUF
  683C'   01 0090        C      	LD	BC,90H
  683F'   CD 5411'       C      	CALL	U1.CLRB
  6842'   21 0080        C      	LD	HL,80H
  6845'   CD 5631'       C      	CALL	XY.STIDX
  6848'   09             C      	DB	9
  6849'   E1             C      	POP	HL
  684A'   CD 622A'       C      	CALL	UK.KBA
  684D'   2B             C      	DEC	HL
'Ein-/Ausgabe im freien Format'	MACRO-80 3.44	09-Dec-81	PAGE	1-60


  684E'   7C             C      	LD	A,H
  684F'   B5             C      	OR	L
  6850'   20 E6          C      	JR	NZ,$-24
  6852'   18 E0          C      	JR	$-30
                         C      ;----------------------------------------------------------------------
                         C      ;      F/S - Datei in den Editorraum einlesen
                         C      ;
  6854'                  C      FD.FDINP:
  6854'   21 0000        C      	LD	HL,0
  6857'   CD 5621'       C      	CALL	XY.STDX
  685A'   11             C      	DB	17
  685B'   CD 617A'       C      	CALL	UK.KLPFB	;Pufferbereitstellung
  685E'   21 3328        C      	LD	HL,UE.BWSA+328H
  6861'   06 05          C      	LD	B,5
  6863'   7E             C      	LD	A,(HL)
  6864'   FE 45          C      	CP	'E'
  6866'   28 05          C      	JR	Z,$+7
  6868'   23             C      	INC	HL
  6869'   10 F8          C      	DJNZ	$-6
  686B'   18 05          C      	JR	$+7
  686D'   2A 0DC4        C      	LD	HL,(UE.EDEND)
  6870'   18 03          C      	JR	$+5
  6872'   21 8830        C      	LD	HL,UE.TEXAN
  6875'   D9             C      	EXX
  6876'   CD 5956'       C      	CALL	DC.INIT	;Dekomprimierung initialisieren
  6879'   D9             C      	EXX
  687A'   3A 2B28'       C      	LD	A,(UB.PAR2)	;Dateitypmerker
  687D'   FE 53          C      	CP	'S'
  687F'   F5             C      	PUSH	AF
  6880'   CC 689B'       C      	CALL	Z,FD.SDIN	;Zeicheneingabe S- Datei
  6883'   77             C      	LD	(HL),A
  6884'   B7             C      	OR	A
  6885'   28 12          C      	JR	Z,$+20
  6887'   F1             C      	POP	AF
  6888'   28 07          C      	JR	Z,$+9
  688A'   C4 613D'       C      	CALL	NZ,UK.GETK	;Zeicheneingabe F- Datei
  688D'   77             C      	LD	(HL),A	;Zeichen in Speicher eintragen
  688E'   BE             C      	CP	(HL)	;Echolesen
  688F'   20 10          C      	JR	NZ,$+18
  6891'   B7             C      	OR	A	;<A>:= 0, Z:= 1
  6892'   C8             C      	RET	Z
  6893'   23             C      	INC	HL	;HL:= HL + 1
  6894'   22 0DC4        C      	LD	(UE.EDEND),HL	;Textende
  6897'   18 E1          C      	JR	$-29
  6899'   F1             C      	POP	AF
  689A'   C9             C      	RET
  689B'                  C      FD.SDIN:
  689B'   D9             C      	EXX
  689C'   CD 591B'       C      	CALL	DC.DCMPR
  689F'   D9             C      	EXX
  68A0'   C9             C      	RET
  68A1'   3E 93          C      	LD	A,93H	;Fehlerschluessel
  68A3'   CD 5D55'       C      	CALL	UF.ERANZ
  68A6'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;      Ausgabe einer F/S - Datei (neuer Bestand)
                         C      ;
  68A7'                  C      FD.FDOUT:
  68A7'   21 0000        C      	LD	HL,0	;Blockzaehler loeschen
  68AA'   CD 5621'       C      	CALL	XY.STDX
  68AD'   11             C      	DB	17
  68AE'   21 0080        C      	LD	HL,80H	;Blocklaenge eintragen
  68B1'   CD 5631'       C      	CALL	XY.STIDX
  68B4'   09             C      	DB	9
  68B5'   CD 6205'       C      	CALL	UK.KSPFB	;Pufferbereitstellung
  68B8'   21 8830        C      	LD	HL,UE.TEXAN	;HL:= Textanfang
  68BB'   ED 5B 0DC4     C      	LD	DE,(UE.EDEND)	;BC:= Textende
  68BF'   D9             C      	EXX
  68C0'   CD 5915'       C      	CALL	CP.INIT
  68C3'   D9             C      	EXX
  68C4'   B7             C      	OR	A	;CY:= 0
  68C5'   E5             C      	PUSH	HL
  68C6'   ED 52          C      	SBC	HL,DE
  68C8'   30 13          C      	JR	NC,$+21
  68CA'   E1             C      	POP	HL
  68CB'   3A 2B28'       C      	LD	A,(UB.PAR2)
  68CE'   FE 53          C      	CP	'S'
  68D0'   F5             C      	PUSH	AF
  68D1'   7E             C      	LD	A,(HL)
  68D2'   CC 68F5'       C      	CALL	Z,FD.SDOUT
  68D5'   F1             C      	POP	AF
  68D6'   7E             C      	LD	A,(HL)
  68D7'   C4 61E1'       C      	CALL	NZ,UK.PUTK
'Ein-/Ausgabe im freien Format'	MACRO-80 3.44	09-Dec-81	PAGE	1-61


  68DA'   23             C      	INC	HL
  68DB'   18 E7          C      	JR	$-23
  68DD'   E1             C      	POP	HL	;Endebehandlung
  68DE'   01 0120        C      	LD	BC,288
  68E1'   AF             C      	XOR	A
  68E2'   CD 61E1'       C      	CALL	UK.PUTK
  68E5'   0B             C      	DEC	BC
  68E6'   78             C      	LD	A,B
  68E7'   B1             C      	OR	C
  68E8'   20 F7          C      	JR	NZ,$-7
  68EA'   CD 6AB8'       C      	CALL	FD.DSPBB
  68ED'   CD 6823'       C      	CALL	FD.WRRES	;Reservebloecke schreiben
  68F0'   CD 5601'       C      	CALL	XY.LDDX	;HL:= Blockzaehler
  68F3'   11             C      	DB	17
  68F4'   C9             C      	RET
  68F5'                  C      FD.SDOUT:
  68F5'   D9             C      	EXX
  68F6'   CD 58B2'       C      	CALL	CP.COMPR
  68F9'   D9             C      	EXX
  68FA'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;      Ausgabe einer F/S - Datei (alter Bestand)
                         C      ;
  68FB'                  C      FD.FDOWR:
  68FB'   21 0000        C      	LD	HL,0
  68FE'   CD 5621'       C      	CALL	XY.STDX
  6901'   11             C      	DB	17
  6902'   21 8830        C      	LD	HL,UE.TEXAN
  6905'   D9             C      	EXX
  6906'   CD 5915'       C      	CALL	CP.INIT
  6909'   D9             C      	EXX
  690A'   E5             C      	PUSH	HL
  690B'                  C      FD.FDOW1:
  690B'   CD 694B'       C      	CALL	FD.FDUP
  690E'   E1             C      	POP	HL
  690F'                  C      FD.FDOW2:
  690F'   E5             C      	PUSH	HL
  6910'   ED 5B 0DC4     C      	LD	DE,(UE.EDEND)
  6914'   B7             C      	OR	A
  6915'   ED 52          C      	SBC	HL,DE
  6917'   30 1B          C      	JR	NC,FD.FDOW3
  6919'   E1             C      	POP	HL
  691A'   3A 2B28'       C      	LD	A,(UB.PAR2)
  691D'   FE 53          C      	CP	'S'
  691F'   7E             C      	LD	A,(HL)
  6920'   28 41          C      	JR	Z,FD.SDOW
  6922'   CD 61E1'       C      	CALL	UK.PUTK
  6925'   0B             C      	DEC	BC
  6926'                  C      FD.FDOW4:
  6926'   23             C      	INC	HL
  6927'   78             C      	LD	A,B
  6928'   B1             C      	OR	C
  6929'   20 E4          C      	JR	NZ,FD.FDOW2
  692B'   CD 622A'       C      	CALL	UK.KBA	;Block schreiben
  692E'   E5             C      	PUSH	HL
  692F'   CD 6941'       C      	CALL	FD.DECBZ
  6932'   18 D7          C      	JR	FD.FDOW1
  6934'                  C      FD.FDOW3:
  6934'   E1             C      	POP	HL
  6935'   AF             C      	XOR	A	;Endekennzeichen 00H
  6936'   CD 61E1'       C      	CALL	UK.PUTK
  6939'   CD 622A'       C      	CALL	UK.KBA
  693C'   CD 6941'       C      	CALL	FD.DECBZ
  693F'   B7             C      	OR	A
  6940'   C9             C      	RET
  6941'                  C      FD.DECBZ:
  6941'   CD 5601'       C      	CALL	XY.LDDX
  6944'   11             C      	DB	17
  6945'   2B             C      	DEC	HL
  6946'   CD 5621'       C      	CALL	XY.STDX
  6949'   11             C      	DB	17
  694A'   C9             C      	RET
  694B'                  C      FD.FDUP:
  694B'   CD 619D'       C      	CALL	UK.KBW
  694E'   DD 7E 0A       C      	LD	A,(IX+10)	;Laenge = 1, dann BM
  6951'   FE 01          C      	CP	1
  6953'   CA 6ADD'       C      	JP	Z,FD.BMGF
  6956'   CD 60CB'       C      	CALL	UR.KBR
  6959'   CD 5611'       C      	CALL	XY.LIDX
  695C'   09             C      	DB	9
  695D'   E5             C      	PUSH	HL
  695E'   C1             C      	POP	BC
  695F'   CD 6205'       C      	CALL	UK.KSPFB
'Ein-/Ausgabe im freien Format'	MACRO-80 3.44	09-Dec-81	PAGE	1-62


  6962'   C9             C      	RET
  6963'                  C      FD.SDOW:
  6963'   CD 68F5'       C      	CALL	FD.SDOUT
  6966'   78             C      	LD	A,B
  6967'   A1             C      	AND	C
  6968'   FE FF          C      	CP	0FFH
  696A'   28 1B          C      	JR	Z,FD.SDK1
  696C'   FE FE          C      	CP	0FEH
  696E'   28 03          C      	JR	Z,FD.SDK2
  6970'   C3 6926'       C      	JP	FD.FDOW4
  6973'                  C      FD.SDK2:
  6973'   EB             C      	EX	DE,HL
  6974'   CD 694B'       C      	CALL	FD.FDUP
  6977'   3E 09          C      	LD	A,09H
  6979'   CD 61E1'       C      	CALL	UK.PUTK
  697C'   0B             C      	DEC	BC
  697D'                  C      FD.SDK0:
  697D'   3E 3B          C      	LD	A,';'
  697F'   CD 61E1'       C      	CALL	UK.PUTK
  6982'   0B             C      	DEC	BC
  6983'   EB             C      	EX	DE,HL
  6984'   C3 6926'       C      	JP	FD.FDOW4
  6987'                  C      FD.SDK1:
  6987'   EB             C      	EX	DE,HL
  6988'   CD 694B'       C      	CALL	FD.FDUP
  698B'   18 F0          C      	JR	FD.SDK0
                         C      ;--------------------------------------------------------------
                         C      ;        Startroutine Ein-/Ausgabe
                         C      ;
  698D'                  C      FD.FSTRT:
  698D'   CD 55B1'       C      	CALL	U1.BILO
  6990'   CD 54E2'       C      	CALL	U1.KTINI
  6993'   3A 3326        C      	LD	A,(UE.BWSA+326H)
  6996'   CD 55C5'       C      	CALL	U1.TST
  6999'   DA 69C5'       C      	JP	C,FD.STRT1
  699C'   DD 77 03       C      	LD	(IX+3),A
  699F'   CD 6095'       C      	CALL	UR.KRE
  69A2'   CD 60A3'       C      	CALL	UR.KRWW
  69A5'   CD 5496'       C      	CALL	U1.DSVG
  69A8'   3E 0E          C      	LD	A,14
  69AA'   32 2B00'       C      	LD	(UB.ZN),A
  69AD'   3A 3328        C      	LD	A,(UE.BWSA+328H)
  69B0'   FE 53          C      	CP	'S'
  69B2'   28 02          C      	JR	Z,$+4
  69B4'   3E 46          C      	LD	A,'F'
  69B6'   57             C      	LD	D,A
  69B7'   32 2B28'       C      	LD	(UB.PAR2),A
  69BA'   21 5FD6'       C      	LD	HL,UA.ZKSDT
  69BD'   28 03          C      	JR	Z,$+5
  69BF'   21 5F46'       C      	LD	HL,UA.ZKDAT
  69C2'   CD 595C'       C      	CALL	UR.MIMO
  69C5'                  C      FD.STRT1:
  69C5'   FD E1          C      	POP	IY
  69C7'   D8             C      	RET	C
  69C8'   FD E5          C      	PUSH	IY
  69CA'   3E 53          C      	LD	A,'S'
  69CC'   BA             C      	CP	D
  69CD'   CC 69F8'       C      	CALL	Z,FD.DECHL
  69D0'   CD 6807'       C      	CALL	FD.DASU
  69D3'   DC 69DA'       C      	CALL	C,FD.SETJ
  69D6'   D4 69F2'       C      	CALL	NC,FD.SETN
  69D9'   C9             C      	RET
  69DA'                  C      FD.SETJ:
  69DA'   C5             C      	PUSH	BC
  69DB'   D5             C      	PUSH	DE
  69DC'   E5             C      	PUSH	HL
  69DD'   EB             C      	EX	DE,HL
  69DE'   06 08          C      	LD	B,8
  69E0'   13             C      	INC	DE
  69E1'   10 FD          C      	DJNZ	$-1
  69E3'   21 0E6E        C      	LD	HL,UE.PUF+8
  69E6'   01 0006        C      	LD	BC,6
  69E9'   ED B0          C      	LDIR
  69EB'   E1             C      	POP	HL
  69EC'   D1             C      	POP	DE
  69ED'   C1             C      	POP	BC
  69EE'   3E 4A          C      	LD	A,'J'
  69F0'   18 02          C      	JR	$+4
  69F2'                  C      FD.SETN:
  69F2'   3E 4E          C      	LD	A,'N'
  69F4'   32 2B26'       C      	LD	(UB.PAR1),A
  69F7'   C9             C      	RET
  69F8'                  C      FD.DECHL:
'Ein-/Ausgabe im freien Format'	MACRO-80 3.44	09-Dec-81	PAGE	1-63


  69F8'   2B             C      	DEC	HL
  69F9'   2B             C      	DEC	HL
  69FA'   C9             C      	RET
                         C      ;****************************************************************
                         C      ;        Ausgabeprogramm
                         C      ;****************************************************************
  69FB'   69FB'          C      	DW	$
  69FD'   41 55 53 20    C      	DB	'AUS '
  6A01'                  C      FD.FOUT1:
  6A01'   CD 698D'       C      	CALL	FD.FSTRT
  6A04'   3A 2B26'       C      	LD	A,(UB.PAR1)
  6A07'   FE 4A          C      	CP	'J'	;DATEI SCHON VORHANDEN ?
  6A09'   CA 6A74'       C      	JP	Z,FD.FOLWR	;JA
                         C      ;-------------------------------NEIN--> NEUE ERSTELLEN-----------------
  6A0C'   79             C      	LD	A,C	;NEXT RECORD
  6A0D'   32 2B26'       C      	LD	(UB.PAR1),A
  6A10'   3E 7F          C      	LD	A,7FH
  6A12'   32 2B2A'       C      	LD	(UB.PAR3),A	;PARAMETER KOMMENTARABFRAGE JA
  6A15'   CD 554E'       C      	CALL	U1.VZS	;NEUEN VERZ.SATZ SCHREIBEN
  6A18'   CD 67E8'       C      	CALL	FD.POSK
  6A1B'   C5             C      	PUSH	BC
  6A1C'   CD 68A7'       C      	CALL	FD.FDOUT
  6A1F'   E5             C      	PUSH	HL	;BLOCKZAEHLER
  6A20'   CD 60B9'       C      	CALL	UR.KBM
  6A23'   21 0020        C      	LD	HL,32
  6A26'   CD 5631'       C      	CALL	XY.STIDX
  6A29'   09             C      	DB	9
  6A2A'   CD 5486'       C      	CALL	U1.VSX
  6A2D'   E1             C      	POP	HL
  6A2E'   C1             C      	POP	BC
  6A2F'   E5             C      	PUSH	HL
  6A30'   79             C      	LD	A,C
  6A31'   3C             C      	INC	A
  6A32'   32 0E66        C      	LD	(UE.PUF),A
  6A35'   F5             C      	PUSH	AF
  6A36'   DD 36 04 08    C      	LD	(IX+4),08H
  6A3A'   CD 5D25'       C      	CALL	UF.EXEC
  6A3D'   CD 60A3'       C      	CALL	UR.KRWW
  6A40'   CD 5496'       C      	CALL	U1.DSVG
  6A43'   CD 60CB'       C      	CALL	UR.KBR
  6A46'   F1             C      	POP	AF
  6A47'   32 0E67        C      	LD	(UE.PUF+1),A
  6A4A'   78             C      	LD	A,B
  6A4B'   3C             C      	INC	A
  6A4C'   32 0E69        C      	LD	(UE.PUF+3),A
  6A4F'   DD 36 04 08    C      	LD	(IX+4),08H
  6A53'   CD 5D25'       C      	CALL	UF.EXEC
  6A56'   DD 36 04 02    C      	LD	(IX+4),02H
  6A5A'   CD 5D25'       C      	CALL	UF.EXEC
  6A5D'   10 FB          C      	DJNZ	$-3
  6A5F'   CD 60CB'       C      	CALL	UR.KBR
  6A62'   E1             C      	POP	HL
  6A63'   22 0E7F        C      	LD	(UE.PUF+25),HL
  6A66'   DD 36 04 08    C      	LD	(IX+4),08H
  6A6A'   CD 5D25'       C      	CALL	UF.EXEC
  6A6D'                  C      FD.END:
  6A6D'   CD 609D'       C      	CALL	UR.KRW
  6A70'   CD 60A7'       C      	CALL	UR.KRA
  6A73'   C9             C      	RET
  6A74'                  C      FD.FOLWR:
  6A74'   21 5FA5'       C      	LD	HL,UA.ZKDL	;DATEI UEBERSCHREIBEN?
  6A77'   CD 595C'       C      	CALL	UR.MIMO
  6A7A'   D8             C      	RET	C
  6A7B'   7E             C      	LD	A,(HL)
  6A7C'   FE 4A          C      	CP	'J'
  6A7E'   C0             C      	RET	NZ
  6A7F'   CD 67E8'       C      	CALL	FD.POSK
  6A82'   CD 68FB'       C      	CALL	FD.FDOWR
  6A85'   CD 6AB8'       C      	CALL	FD.DSPBB
  6A88'   CD 6AD2'       C      	CALL	FD.RDEND
  6A8B'   CD 6AC8'       C      	CALL	FD.DSPBG
  6A8E'   18 DD          C      	JR	$-33
                         C      ;**********************************************************************
                         C      ;      Eingabeprogramm
                         C      ;**********************************************************************
  6A90'   6A90'          C      	DW	$
  6A92'   45 49 4E 20    C      	DB	'EIN '
  6A96'                  C      FD.FDIN2:
  6A96'   CD 698D'       C      	CALL	FD.FSTRT
  6A99'   3A 2B26'       C      	LD	A,(UB.PAR1)
  6A9C'   FE 4A          C      	CP	'J'
  6A9E'   28 07          C      	JR	Z,$+9
  6AA0'   3E 91          C      	LD	A,91H
'Ein-/Ausgabe im freien Format'	MACRO-80 3.44	09-Dec-81	PAGE	1-64


  6AA2'   CD 5D55'       C      	CALL	UF.ERANZ
  6AA5'   18 C6          C      	JR	FD.END
  6AA7'   CD 67E8'       C      	CALL	FD.POSK
  6AAA'   CD 6854'       C      	CALL	FD.FDINP
  6AAD'   CD 6AB8'       C      	CALL	FD.DSPBB
  6AB0'   CD 6AD2'       C      	CALL	FD.RDEND
  6AB3'   CD 6AC8'       C      	CALL	FD.DSPBG
  6AB6'   18 B5          C      	JR	FD.END
                         C      ;----------------------------------------------------------------------
  6AB8'                  C      FD.DSPBB:
  6AB8'   CD 5601'       C      	CALL	XY.LDDX
  6ABB'   11             C      	DB	17
  6ABC'   EB             C      	EX	DE,HL
  6ABD'   21 5FEB'       C      	LD	HL,UA.ZKBEL
  6AC0'   CD 595C'       C      	CALL	UR.MIMO
  6AC3'   EB             C      	EX	DE,HL
  6AC4'   CD 5718'       C      	CALL	UC.CVBD3
  6AC7'   C9             C      	RET
  6AC8'                  C      FD.DSPBG:
  6AC8'   CD 5601'       C      	CALL	XY.LDDX
  6ACB'   11             C      	DB	17
  6ACC'   EB             C      	EX	DE,HL
  6ACD'   21 5FFE'       C      	LD	HL,UA.ZKBLG
  6AD0'   18 EE          C      	JR	$-16
  6AD2'                  C      FD.RDEND:
  6AD2'   CD 619D'       C      	CALL	UK.KBW
  6AD5'   DD 7E 0A       C      	LD	A,(IX+10)	;Laenge = 1, dann BM
  6AD8'   FE 01          C      	CP	1
  6ADA'   C8             C      	RET	Z
  6ADB'   18 F5          C      	JR	FD.RDEND
  6ADD'                  C      FD.BMGF:
  6ADD'   3E 95          C      	LD	A,95H
  6ADF'   CD 5D55'       C      	CALL	UF.ERANZ
  6AE2'   D1             C      	POP	DE
  6AE3'   D1             C      	POP	DE
  6AE4'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Laden von MRES-P-Dateien'
                         C      	PAGE
'Laden von MRES-P-Dateien'	MACRO-80 3.44	09-Dec-81	PAGE	1-65


                         C      
                         C      ;	PN	LD
                         C      ;***********************************************************
                         C      ;
                         C      ;        Laden von MRES-P-Dateien
                         C      ;
                         C      ;***********************************************************
  6AE5'   6AE5'          C      	DW	$
  6AE7'   4C 4F 41 44    C      	DB	'LOAD'
  6AEB'   3A 3327        C      	LD	A,(UE.BWSA+327H)
  6AEE'   CD 55C5'       C      	CALL	U1.TST
  6AF1'   D8             C      	RET	C
  6AF2'   CD 54E2'       C      	CALL	U1.KTINI
  6AF5'   DD 77 03       C      	LD	(IX+3),A
  6AF8'   CD 55B1'       C      	CALL	U1.BILO
  6AFB'   3E 0D          C      	LD	A,13
  6AFD'   32 2B00'       C      	LD	(UB.ZN),A
  6B00'                  C      LD.DATN:
  6B00'   21 5F46'       C      	LD	HL,UA.ZKDAT	;Dateiname ?
  6B03'   CD 595C'       C      	CALL	UR.MIMO
  6B06'   D8             C      	RET	C
  6B07'   CD 6095'       C      	CALL	UR.KRE
  6B0A'   CD 60A3'       C      	CALL	UR.KRWW
  6B0D'   CD 5496'       C      	CALL	U1.DSVG
  6B10'   3E 01          C      	LD	A,01H
  6B12'   B8             C      	CP	B
  6B13'   28 0A          C      	JR	Z,LD.LD21	;NEU INITIALISIERTE KASSETTE
  6B15'                  C      LD.LD2:
  6B15'   CD 619D'       C      	CALL	UK.KBW
  6B18'   CD 54C7'       C      	CALL	U1.NMVGL	;Dateiname vergleichen
  6B1B'   38 08          C      	JR	C,LD.DATFU	;---> Datei gefunden
  6B1D'   10 F6          C      	DJNZ	LD.LD2
  6B1F'                  C      LD.LD21:
  6B1F'   3E 91          C      	LD	A,91H	;Datei nicht vorhanden
  6B21'   CD 5D55'       C      	CALL	UF.ERANZ	;FEHLERANZEIGE
  6B24'   C9             C      	RET
  6B25'                  C      LD.DATFU:
  6B25'   3A 0E6C        C      	LD	A,(UE.PUF+6)	;TYP
  6B28'   FE 4F          C      	CP	'O'
  6B2A'   F5             C      	PUSH	AF
  6B2B'   21 0E7D        C      	LD	HL,UE.PUF+23
  6B2E'   7E             C      	LD	A,(HL)
  6B2F'   F5             C      	PUSH	AF
  6B30'   47             C      	LD	B,A
  6B31'   04             C      	INC	B
  6B32'   CD 60DA'       C      	CALL	UR.POSIK	;Positionieren
  6B35'   CD 619D'       C      	CALL	UK.KBW
  6B38'   F1             C      	POP	AF
  6B39'   21 0E66        C      	LD	HL,UE.PUF
  6B3C'   BE             C      	CP	(HL)
  6B3D'   28 07          C      	JR	Z,LD.DATPO	;Datei richtig positioniert
  6B3F'   F1             C      	POP	AF
  6B40'   3E 94          C      	LD	A,94H
  6B42'   CD 5D55'       C      	CALL	UF.ERANZ
  6B45'   C9             C      	RET
  6B46'                  C      LD.DATPO:
  6B46'   F1             C      	POP	AF
  6B47'   CA 6BDC'       C      	JP	Z,RL.BEG
  6B4A'   3A 3329        C      	LD	A,(UE.BWSA+329H)
  6B4D'   FE 56          C      	CP	'V'
  6B4F'   20 57          C      	JR	NZ,LD.LD3
  6B51'   21 5F59'       C      	LD	HL,UA.ZKLAD	;Ladeadresse ?
  6B54'   CD 595C'       C      	CALL	UR.MIMO
  6B57'   DA 6B00'       C      	JP	C,LD.DATN
  6B5A'   CD 55CF'       C      	CALL	U1.PRADR	;ADRESSE EINGEGEBEN
  6B5D'   38 F2          C      	JR	C,$-12
  6B5F'   EB             C      	EX	DE,HL
  6B60'   21 2B26'       C      	LD	HL,UB.PAR1
  6B63'   CD 5705'       C      	CALL	UC.CVXA
  6B66'                  C      LD.LD4:
  6B66'   CD 617A'       C      	CALL	UK.KLPFB
  6B69'   CD 613D'       C      	CALL	UK.GETK
  6B6C'   CD 613D'       C      	CALL	UK.GETK
  6B6F'   67             C      	LD	H,A
  6B70'   CD 613D'       C      	CALL	UK.GETK
  6B73'   6F             C      	LD	L,A
  6B74'   7A             C      	LD	A,D
  6B75'   B3             C      	OR	E
  6B76'   28 09          C      	JR	Z,LD.LD5
  6B78'   ED 5B 2B26'    C      	LD	DE,(UB.PAR1)
  6B7C'   EB             C      	EX	DE,HL
  6B7D'   B7             C      	OR	A
'Laden von MRES-P-Dateien'	MACRO-80 3.44	09-Dec-81	PAGE	1-66


  6B7E'   ED 52          C      	SBC	HL,DE
  6B80'   EB             C      	EX	DE,HL	;DE:= Verschiebung zur ersten
  6B81'                  C      LD.LD5:
  6B81'   CD 60CB'       C      	CALL	UR.KBR
  6B84'   CD 6BAD'       C      	CALL	LD.LADER
  6B87'   22 2B28'       C      	LD	(UB.PAR2),HL
  6B8A'   21 3329        C      	LD	HL,UE.BWSA+329H
  6B8D'   06 04          C      	LD	B,4
  6B8F'   7E             C      	LD	A,(HL)
  6B90'   FE 53          C      	CP	'S'
  6B92'   28 0A          C      	JR	Z,LD.START
  6B94'   23             C      	INC	HL
  6B95'   10 F8          C      	DJNZ	$-6
  6B97'   CD 609D'       C      	CALL	UR.KRW
  6B9A'   CD 60A7'       C      	CALL	UR.KRA
  6B9D'   C9             C      	RET
  6B9E'                  C      LD.START:
  6B9E'   CD 609D'       C      	CALL	UR.KRW
  6BA1'   CD 60A7'       C      	CALL	UR.KRA
  6BA4'   2A 2B28'       C      	LD	HL,(UB.PAR2)
  6BA7'   E9             C      	JP	(HL)
  6BA8'                  C      LD.LD3:
  6BA8'   11 0000        C      	LD	DE,0
  6BAB'   18 B9          C      	JR	LD.LD4
                         C      ;--------------------------------------------------------------
  6BAD'                  C      LD.LADER:
  6BAD'   CD 617A'       C      	CALL	UK.KLPFB
  6BB0'                  C      LD.LAD2:
  6BB0'   CD 613D'       C      	CALL	UK.GETK
  6BB3'   FE 00          C      	CP	0
  6BB5'   28 16          C      	JR	Z,LD.LDEND
  6BB7'   47             C      	LD	B,A
  6BB8'   CD 613D'       C      	CALL	UK.GETK
  6BBB'   67             C      	LD	H,A
  6BBC'   CD 613D'       C      	CALL	UK.GETK
  6BBF'   6F             C      	LD	L,A
  6BC0'   19             C      	ADD	HL,DE
  6BC1'                  C      LD.LAD1:
  6BC1'   CD 613D'       C      	CALL	UK.GETK
  6BC4'   77             C      	LD	(HL),A
  6BC5'   BE             C      	CP	(HL)
  6BC6'   20 0E          C      	JR	NZ,LD.LADF
  6BC8'   23             C      	INC	HL
  6BC9'   10 F6          C      	DJNZ	LD.LAD1
  6BCB'   18 E3          C      	JR	LD.LAD2
  6BCD'                  C      LD.LDEND:
  6BCD'   CD 613D'       C      	CALL	UK.GETK
  6BD0'   67             C      	LD	H,A
  6BD1'   CD 613D'       C      	CALL	UK.GETK
  6BD4'   6F             C      	LD	L,A
  6BD5'   C9             C      	RET
  6BD6'                  C      LD.LADF:
  6BD6'   3E 93          C      	LD	A,93H
  6BD8'   CD 5D55'       C      	CALL	UF.ERANZ
  6BDB'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Relativloader fuer O-Dateien'
                         C      	PAGE
'Relativloader fuer O-Dateien'	MACRO-80 3.44	09-Dec-81	PAGE	1-67


                         C      
                         C      ;	PN	RL
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;     RELATIVLOADER FUER O-DATEIEN
                         C      ;
                         C      ;----------------------------------------------------------------------
  6BDC'                  C      RL.BEG:
  6BDC'   21 5F6C'       C      	LD	HL,UA.ZKBEG	;BEGINN ?
  6BDF'   CD 595C'       C      	CALL	UR.MIMO
  6BE2'   DA 6B00'       C      	JP	C,LD.DATN
  6BE5'   CD 55CF'       C      	CALL	U1.PRADR
  6BE8'   38 F2          C      	JR	C,RL.BEG
  6BEA'   EB             C      	EX	DE,HL
  6BEB'   21 2B30'       C      	LD	HL,UB.PATAB
  6BEE'   CD 5705'       C      	CALL	UC.CVXA
  6BF1'                  C      RL.UG:
  6BF1'   CD 619D'       C      	CALL	UK.KBW
  6BF4'   2A 2B30'       C      	LD	HL,(UB.PATAB)	;BGADR---->HL
  6BF7'   0E 01          C      	LD	C,001H	;LADEN BLOCKZAEHLER MIT
                         C      			;ANFANGSWERT
  6BF9'   CD 6C84'       C      	CALL	RL.UP6	; AUFRUF EINGABE-UP
                         C      ;********** TEST BEFEHLSKENNZEICHENBYTE *******************************
  6BFC'                  C      RL.M16:
  6BFC'   CB 5A          C      	BIT	3,D	;TEST ORG-BEFEHL
  6BFE'   C2 6CD8'       C      	JP	NZ,RL.OB	;JA--->FEHLER
  6C01'   CB 62          C      	BIT	4,D	;TEST BER -BEFEHL
  6C03'   C2 6C6D'       C      	JP	NZ,RL.M10
  6C06'   3E 07          C      	LD	A,007H
  6C08'   A2             C      	AND	D	;TEST BEFEHLS LAENGE=0 ?
  6C09'   CA 6C7E'       C      	JP	Z,RL.M11
  6C0C'   47             C      	LD	B,A	;BEFEHLSLAENGE-->B
  6C0D'                  C      RL.M12:
  6C0D'   CD 6C84'       C      	CALL	RL.UP6
  6C10'   72             C      	LD	(HL),D
  6C11'   23             C      	INC	HL
  6C12'   10 F9          C      	DJNZ	RL.M12	;EINGABE BEFEHL
  6C14'   CD 6C84'       C      	CALL	RL.UP6
  6C17'   CB 7A          C      	BIT	7,D	;TEST BEFEHLSKENNZEICHENBYTE ?
  6C19'   20 E1          C      	JR	NZ,RL.M16	; JA
                         C      ;******* TEST ADRESSKENNZEICHENBYTE ***********************************
  6C1B'   CB 6A          C      	BIT	5,D	;TEST OB REL.ADR. FOLGT
  6C1D'   CA 6CDC'       C      	JP	Z,RL.RA	;NEIN-->FEHLER
  6C20'   CB 72          C      	BIT	6,D	;FOLGT BEZUGNAHME AUF
                         C      			;SYMBOLVERZEICHNIS
  6C22'   C2 6CE0'       C      	JP	NZ,RL.SV	;JA--->FEHLER
  6C25'   CB 52          C      	BIT	2,D	;MINUS ?
  6C27'   C2 6CE4'       C      	JP	NZ,RL.MN
  6C2A'                  C      RL.M17:
  6C2A'   3E 03          C      	LD	A,003H
  6C2C'   A2             C      	AND	D	;TEST ADRESSLAENGE
  6C2D'   F5             C      	PUSH	AF
  6C2E'   E5             C      	PUSH	HL
  6C2F'   CD 6C84'       C      	CALL	RL.UP6
  6C32'   62             C      	LD	H,D	;ADRESSE ---->HL
  6C33'   CD 6C84'       C      	CALL	RL.UP6
  6C36'   6A             C      	LD	L,D
  6C37'   C5             C      	PUSH	BC
  6C38'   E5             C      	PUSH	HL
  6C39'   21 2B30'       C      	LD	HL,UB.PATAB
  6C3C'   4E             C      	LD	C,(HL)	;BEGINN(LADE)ADRESSE--->BC
  6C3D'   23             C      	INC	HL
  6C3E'   46             C      	LD	B,(HL)
  6C3F'   E1             C      	POP	HL
  6C40'   09             C      	ADD	HL,BC	;ERMITTELN SPEICHERADRESSE
  6C41'   EB             C      	EX	DE,HL	;SP.ADR.--->DE
  6C42'   C1             C      	POP	BC
  6C43'   E1             C      	POP	HL
  6C44'   F1             C      	POP	AF
  6C45'   28 04          C      	JR	Z,RL.M13
  6C47'   CB 47          C      	BIT	0,A	;NUR L-TEIL DER ADRESSE ?
  6C49'   28 10          C      	JR	Z,RL.M14	; JA
                         C      ;********** ADRESSE IN SPEICHER EINTRAGEN *****************************
  6C4B'                  C      RL.M13:
  6C4B'   73             C      	LD	(HL),E
  6C4C'   F5             C      	PUSH	AF
  6C4D'   7B             C      	LD	A,E
  6C4E'   BE             C      	CP	(HL)
  6C4F'   C2 6CCF'       C      	JP	NZ,RL.ECHO
  6C52'   F1             C      	POP	AF
  6C53'   23             C      	INC	HL
  6C54'   FE 03          C      	CP	003H
'Relativloader fuer O-Dateien'	MACRO-80 3.44	09-Dec-81	PAGE	1-68


  6C56'   28 03          C      	JR	Z,RL.M14
  6C58'   B7             C      	OR	A	;NUR H-TEIL DER ADRESSE ?
  6C59'   20 08          C      	JR	NZ,RL.M15	; JA
  6C5B'                  C      RL.M14:
  6C5B'   72             C      	LD	(HL),D
  6C5C'   F5             C      	PUSH	AF
  6C5D'   7A             C      	LD	A,D
  6C5E'   BE             C      	CP	(HL)
  6C5F'   20 6E          C      	JR	NZ,RL.ECHO
  6C61'   F1             C      	POP	AF
  6C62'   23             C      	INC	HL
  6C63'                  C      RL.M15:
  6C63'   CD 6C84'       C      	CALL	RL.UP6
  6C66'   CB 7A          C      	BIT	7,D	; TEST BEFEHLSKENNZEICHENBYTE
  6C68'   20 92          C      	JR	NZ,RL.M16
  6C6A'   C3 6CE8'       C      	JP	RL.BF	; NEIN--->FEHLER
                         C      ;----------------------------------------------------------------------
  6C6D'                  C      RL.M10:
  6C6D'   CD 6C84'       C      	CALL	RL.UP6	;BEI BER-BEFEHL ADDIEREN DER
  6C70'   D5             C      	PUSH	DE	;DEF. BEREICHSLAENGE ZU
  6C71'   CD 6C84'       C      	CALL	RL.UP6	;ADRESSE
  6C74'   7A             C      	LD	A,D
  6C75'   D1             C      	POP	DE
  6C76'   5F             C      	LD	E,A
  6C77'   19             C      	ADD	HL,DE
  6C78'   CD 6C84'       C      	CALL	RL.UP6
  6C7B'   C3 6BFC'       C      	JP	RL.M16
  6C7E'                  C      RL.M11:
  6C7E'   CD 6C84'       C      	CALL	RL.UP6	;BEI BFL=0 SPRUNG ZUM TEST
  6C81'   C3 6C2A'       C      	JP	RL.M17	;ADRESSKENNZEICHENBYTE
                         C      ;******* UP ZUR ZEICHENWEISE EINGABE DER O-DATEI **********************
  6C84'                  C      RL.UP6:
  6C84'   CD 613D'       C      	CALL	UK.GETK
  6C87'   57             C      	LD	D,A
  6C88'   0D             C      	DEC	C	;REDUZIEREN BLOCKLAENGE
  6C89'   C0             C      	RET	NZ		;RET BEI UNGLEICH NULL
  6C8A'   A7             C      	AND	A	;IST NAECHSTE BLOCKLAENGE NULL ?
  6C8B'   28 04          C      	JR	Z,RL.M21	;JA-->VERZWEIGUNG ENDEBEH
  6C8D'   4F             C      	LD	C,A	;NEIN-->EINTRAGEN BLKLAENGE
  6C8E'   0C             C      	INC	C
  6C8F'   18 F3          C      	JR	RL.UP6
                         C      ;*********** ENDEBEHANDLUNG *******************************************
  6C91'                  C      RL.M21:
  6C91'   D1             C      	POP	DE
  6C92'   E5             C      	PUSH	HL
  6C93'   3E 0F          C      	LD	A,15
  6C95'   32 2B00'       C      	LD	(UB.ZN),A
  6C98'   21 5F82'       C      	LD	HL,UA.ZKEND+3
  6C9B'   11 3460        C      	LD	DE,3460H
  6C9E'   01 0010        C      	LD	BC,16
  6CA1'   ED B0          C      	LDIR
  6CA3'   21 2B00'       C      	LD	HL,UB.ZN
  6CA6'   34             C      	INC	(HL)
  6CA7'   E1             C      	POP	HL
  6CA8'   2B             C      	DEC	HL
  6CA9'   11 3470        C      	LD	DE,3470H	;HINTER AUSSCHRIFT ENDE
  6CAC'   CD 56BF'       C      	CALL	UC.CVHLX
  6CAF'   21 5F92'       C      	LD	HL,UA.STADR	;STARTADRESSE ?
  6CB2'   CD 595C'       C      	CALL	UR.MIMO
  6CB5'   D8             C      	RET	C
  6CB6'   EB             C      	EX	DE,HL
  6CB7'   21 2B32'       C      	LD	HL,UB.PATAB+2
  6CBA'   CD 5705'       C      	CALL	UC.CVXA	;STARTADR.-->BINAER
  6CBD'   3A 3329        C      	LD	A,(UE.BWSA+329H)
  6CC0'   FE 53          C      	CP	'S'
  6CC2'   20 04          C      	JR	NZ,$+6
  6CC4'   2A 2B32'       C      	LD	HL,(UB.PATAB+2)
  6CC7'   E9             C      	JP	(HL)
  6CC8'   CD 609D'       C      	CALL	UR.KRW
  6CCB'   CD 60A7'       C      	CALL	UR.KRA
  6CCE'   C9             C      	RET
                         C      ;---------------------------------------------------------------------
  6CCF'                  C      RL.ECHO:
  6CCF'   D1             C      	POP	DE
  6CD0'   3E 93          C      	LD	A,93H
  6CD2'   18 16          C      	JR	RL.FMELD
  6CD4'                  C      RL.DATNV:
  6CD4'   3E 91          C      	LD	A,91H
  6CD6'   18 12          C      	JR	RL.FMELD
  6CD8'                  C      RL.OB:
  6CD8'   3E 96          C      	LD	A,96H
  6CDA'   18 0E          C      	JR	RL.FMELD
  6CDC'                  C      RL.RA:
'Relativloader fuer O-Dateien'	MACRO-80 3.44	09-Dec-81	PAGE	1-69


  6CDC'   3E 97          C      	LD	A,97H
  6CDE'   18 0A          C      	JR	RL.FMELD
  6CE0'                  C      RL.SV:
  6CE0'   3E 98          C      	LD	A,98H
  6CE2'   18 06          C      	JR	RL.FMELD
  6CE4'                  C      RL.MN:
  6CE4'   3E 99          C      	LD	A,99H
  6CE6'   18 02          C      	JR	RL.FMELD
  6CE8'                  C      RL.BF:
  6CE8'   3E 9A          C      	LD	A,9AH
  6CEA'                  C      RL.FMELD:
  6CEA'   CD 5D55'       C      	CALL	UF.ERANZ
  6CED'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Retten von Maschinencodeprogrammen als MRES - P-Datei'
                         C      	PAGE
'Retten von Maschinencodeprogrammen als MRES - P-Datei'	MACRO-80 3.44	09-Dec-81	PAGE	1-70


                         C      
                         C      ;	PN	SV
                         C      ;**********************************************************************
                         C      ;
                         C      ;      Retten von Maschinencodeprogrammen als MRES - P-Datei
                         C      ;
                         C      ;**********************************************************************
  6CEE'   6CEE'          C      	DW	$
  6CF0'   53 41 56 45    C      	DB	'SAVE'
  6CF4'   3A 3327        C      	LD	A,(UE.BWSA+327H)
  6CF7'   CD 55C5'       C      	CALL	U1.TST
  6CFA'   D8             C      	RET	C
  6CFB'   CD 54E2'       C      	CALL	U1.KTINI
  6CFE'   DD 77 03       C      	LD	(IX+3),A
  6D01'   AF             C      	XOR	A
  6D02'   32 2B27'       C      	LD	(UB.PAR1+1),A
  6D05'   CD 55B1'       C      	CALL	U1.BILO	;BS LOESCHEN
  6D08'   CD 6095'       C      	CALL	UR.KRE
  6D0B'   DD CB 00 56    C      	BIT	2,(IX)
  6D0F'   28 05          C      	JR	Z,$+7
  6D11'   3E 19          C      	LD	A,19H
  6D13'   CD 5D55'       C      	CALL	UF.ERANZ
  6D16'   CD 60A3'       C      	CALL	UR.KRWW
  6D19'                  C      SV.SV20:
  6D19'   CD 5496'       C      	CALL	U1.DSVG
  6D1C'   C5             C      	PUSH	BC
  6D1D'   79             C      	LD	A,C
  6D1E'   32 2B26'       C      	LD	(UB.PAR1),A	;NEXT RECORD
  6D21'   3E 0D          C      	LD	A,13
  6D23'   32 2B00'       C      	LD	(UB.ZN),A
  6D26'                  C      SV.DATN:
  6D26'   21 5F46'       C      	LD	HL,UA.ZKDAT	;Dateiname ?
  6D29'   CD 595C'       C      	CALL	UR.MIMO
  6D2C'   D8             C      	RET	C
  6D2D'   C1             C      	POP	BC
  6D2E'   05             C      	DEC	B
  6D2F'   28 1A          C      	JR	Z,SV.SV30	;NEUE KASSETTE
  6D31'                  C      SV.SV21:
  6D31'   CD 619D'       C      	CALL	UK.KBW
  6D34'   CD 54C7'       C      	CALL	U1.NMVGL
  6D37'   38 04          C      	JR	C,SV.DATV1	;Dateiname bereits vorhanden
  6D39'   10 F6          C      	DJNZ	SV.SV21
  6D3B'   18 0E          C      	JR	SV.SV30
  6D3D'                  C      SV.DATV1:
  6D3D'   3E 01          C      	LD	A,01H
  6D3F'   B8             C      	CP	B
  6D40'   CC 6E89'       C      	CALL	Z,SV.DALO1
  6D43'   28 0E          C      	JR	Z,SV.SV37
  6D45'                  C      SV.DATVO:
  6D45'   3E 92          C      	LD	A,92H
  6D47'   CD 5D55'       C      	CALL	UF.ERANZ
  6D4A'   C9             C      	RET
  6D4B'                  C      SV.SV30:
  6D4B'   3E 50          C      	LD	A,'P'
  6D4D'   32 2B28'       C      	LD	(UB.PAR2),A
  6D50'   CD 554E'       C      	CALL	U1.VZS
  6D53'                  C      SV.SV37:
  6D53'   3A 2B27'       C      	LD	A,(UB.PAR1+1)
  6D56'   FE 4C          C      	CP	'L'
  6D58'   20 0B          C      	JR	NZ,SV.SV31
  6D5A'   21 5FA5'       C      	LD	HL,UA.ZKDL
  6D5D'   CD 595C'       C      	CALL	UR.MIMO
  6D60'   7E             C      	LD	A,(HL)
  6D61'   FE 4A          C      	CP	'J'
  6D63'   20 E0          C      	JR	NZ,SV.DATVO
  6D65'                  C      SV.SV31:
  6D65'   3A 2B26'       C      	LD	A,(UB.PAR1)	;NEXT RECORD
  6D68'   47             C      	LD	B,A
  6D69'   C5             C      	PUSH	BC
  6D6A'   04             C      	INC	B
  6D6B'   CD 60DA'       C      	CALL	UR.POSIK
  6D6E'   CD 619D'       C      	CALL	UK.KBW
  6D71'   21 0E66        C      	LD	HL,UE.PUF
  6D74'   C1             C      	POP	BC
  6D75'   7E             C      	LD	A,(HL)
  6D76'   B8             C      	CP	B
  6D77'   28 06          C      	JR	Z,SV.SAVE3
  6D79'   3E 94          C      	LD	A,94H
  6D7B'   CD 5D55'       C      	CALL	UF.ERANZ
  6D7E'   C9             C      	RET
  6D7F'                  C      SV.SAVE3:
  6D7F'   21 5F6C'       C      	LD	HL,UA.ZKBEG	;Beginn ?
'Retten von Maschinencodeprogrammen als MRES - P-Datei'	MACRO-80 3.44	09-Dec-81	PAGE	1-71


  6D82'   CD 595C'       C      	CALL	UR.MIMO
  6D85'   DA 6D26'       C      	JP	C,SV.DATN
  6D88'   CD 55CF'       C      	CALL	U1.PRADR
  6D8B'   38 F2          C      	JR	C,SV.SAVE3
  6D8D'   EB             C      	EX	DE,HL
  6D8E'   21 2B28'       C      	LD	HL,UB.PAR2
  6D91'   CD 5705'       C      	CALL	UC.CVXA
  6D94'                  C      SV.SAVE4:
  6D94'   21 5F7F'       C      	LD	HL,UA.ZKEND	;Ende ?
  6D97'   CD 595C'       C      	CALL	UR.MIMO
  6D9A'   38 E3          C      	JR	C,SV.SAVE3
  6D9C'   CD 55CF'       C      	CALL	U1.PRADR
  6D9F'   38 F3          C      	JR	C,SV.SAVE4
  6DA1'   EB             C      	EX	DE,HL
  6DA2'   21 2B2A'       C      	LD	HL,UB.PAR3
  6DA5'   CD 5705'       C      	CALL	UC.CVXA
  6DA8'   CD 6DF8'       C      	CALL	SV.BYANZ
  6DAB'   38 D2          C      	JR	C,SV.SAVE3
  6DAD'   28 D0          C      	JR	Z,SV.SAVE3
  6DAF'   CD 6E1D'       C      	CALL	SV.SAVE
  6DB2'   CD 60B9'       C      	CALL	UR.KBM
  6DB5'   CD 6E03'       C      	CALL	SV.DATS1	;1.DATEISATZ SCHREIBEN
  6DB8'   CD 60BF'       C      	CALL	UR.KSL
  6DBB'   CD 60A3'       C      	CALL	UR.KRWW
  6DBE'   CD 5496'       C      	CALL	U1.DSVG
  6DC1'   05             C      	DEC	B
  6DC2'   3A 2B27'       C      	LD	A,(UB.PAR1+1)
  6DC5'   FE 4C          C      	CP	'L'
  6DC7'   28 13          C      	JR	Z,SV.SAVE5
  6DC9'   21 0E67        C      	LD	HL,UE.PUF+1
  6DCC'   34             C      	INC	(HL)	;NEXT RECORD+1
  6DCD'   21 0E69        C      	LD	HL,UE.PUF+3
  6DD0'   46             C      	LD	B,(HL)
  6DD1'   34             C      	INC	(HL)	;ANZ.VERZ.EINTR.+1
  6DD2'                  C      SV.SAVE6:
  6DD2'   CD 60CB'       C      	CALL	UR.KBR
  6DD5'   DD 36 04 08    C      	LD	(IX+4),08H	;NEUEN DS-SATZ AUSGEBEN
  6DD9'   CD 5D25'       C      	CALL	UF.EXEC
  6DDC'                  C      SV.SAVE5:
  6DDC'   CD 619D'       C      	CALL	UK.KBW
  6DDF'   10 FB          C      	DJNZ	SV.SAVE5
  6DE1'   CD 60CB'       C      	CALL	UR.KBR
  6DE4'   2A 2B2E'       C      	LD	HL,(UB.PAR5)
  6DE7'   22 0E7F        C      	LD	(UE.PUF+25),HL	;DATEILAENGE EINTRAGEN
  6DEA'   DD 36 04 08    C      	LD	(IX+4),08H
  6DEE'   CD 5D25'       C      	CALL	UF.EXEC
  6DF1'   CD 609D'       C      	CALL	UR.KRW
  6DF4'   CD 60A7'       C      	CALL	UR.KRA
  6DF7'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  6DF8'                  C      SV.BYANZ:
  6DF8'   2A 2B2A'       C      	LD	HL,(UB.PAR3)	;Byteanzahl berechnen
  6DFB'   ED 5B 2B28'    C      	LD	DE,(UB.PAR2)
  6DFF'   B7             C      	OR	A
  6E00'   ED 52          C      	SBC	HL,DE
  6E02'   C9             C      	RET
  6E03'                  C      SV.DATS1:
  6E03'   21 0020        C      	LD	HL,32	;1. Dateisatz schreiben
  6E06'   CD 5631'       C      	CALL	XY.STIDX
  6E09'   09             C      	DB	9
  6E0A'   CD 5486'       C      	CALL	U1.VSX
  6E0D'   21 0E66        C      	LD	HL,UE.PUF
  6E10'   3A 2B26'       C      	LD	A,(UB.PAR1)	;NEXT RECORD
  6E13'   3C             C      	INC	A
  6E14'   77             C      	LD	(HL),A
  6E15'   DD 36 04 08    C      	LD	(IX+4),08H
  6E19'   CD 5D25'       C      	CALL	UF.EXEC
  6E1C'   C9             C      	RET
  6E1D'                  C      SV.SAVE:
  6E1D'   21 0000        C      	LD	HL,0
  6E20'   CD 5621'       C      	CALL	XY.STDX
  6E23'   11             C      	DB	17
  6E24'   21 0080        C      	LD	HL,80H	;Blocklaenge
  6E27'   CD 5631'       C      	CALL	XY.STIDX
  6E2A'   09             C      	DB	9
  6E2B'   CD 6205'       C      	CALL	UK.KSPFB	;Pufferbereitstellung
  6E2E'                  C      SV.SAVE1:
  6E2E'   CD 6DF8'       C      	CALL	SV.BYANZ	;Byteanzahl berechnen
  6E31'   23             C      	INC	HL
  6E32'   E5             C      	PUSH	HL
  6E33'   7C             C      	LD	A,H
  6E34'   B5             C      	OR	L
  6E35'   E1             C      	POP	HL
'Retten von Maschinencodeprogrammen als MRES - P-Datei'	MACRO-80 3.44	09-Dec-81	PAGE	1-72


  6E36'   28 13          C      	JR	Z,SV.SVLS2	;---> 0 Byte
  6E38'   01 007D        C      	LD	BC,UE.SVL	;Satzlaenge
  6E3B'   B7             C      	OR	A
  6E3C'   ED 42          C      	SBC	HL,BC
  6E3E'   38 05          C      	JR	C,SV.SVLS	;---> letzter Satz
  6E40'   CD 6E94'       C      	CALL	SV.SVSZ
  6E43'   18 E9          C      	JR	SV.SAVE1
  6E45'                  C      SV.SVLS:
  6E45'   7D             C      	LD	A,L
  6E46'   C6 7D          C      	ADD	A,UE.SVL	;A:= Laenge des letzten Satzes
  6E48'   CD 6E96'       C      	CALL	SV.SVSZ2
  6E4B'                  C      SV.SVLS2:
  6E4B'   AF             C      	XOR	A
  6E4C'   CD 61E1'       C      	CALL	UK.PUTK
  6E4F'   21 5F92'       C      	LD	HL,UA.STADR	;Startadresse
  6E52'   CD 595C'       C      	CALL	UR.MIMO
  6E55'   7E             C      	LD	A,(HL)
  6E56'   FE 20          C      	CP	' '
  6E58'   28 27          C      	JR	Z,SV.STAD0	;KEINE EINGABE (0000)
  6E5A'   EB             C      	EX	DE,HL
  6E5B'   21 2B2C'       C      	LD	HL,UB.PAR4
  6E5E'   CD 5705'       C      	CALL	UC.CVXA
  6E61'                  C      SV.SVLS1:
  6E61'   2A 2B2C'       C      	LD	HL,(UB.PAR4)
  6E64'   7C             C      	LD	A,H	;Startadresse ausgeben
  6E65'   CD 61E1'       C      	CALL	UK.PUTK
  6E68'   7D             C      	LD	A,L
  6E69'   CD 61E1'       C      	CALL	UK.PUTK
  6E6C'   0E 03          C      	LD	C,3
  6E6E'                  C      SV.SVEN2:
  6E6E'   06 80          C      	LD	B,80H
  6E70'   AF             C      	XOR	A
  6E71'                  C      SV.SVEN1:
  6E71'   CD 61E1'       C      	CALL	UK.PUTK
  6E74'   10 FB          C      	DJNZ	SV.SVEN1
  6E76'   0D             C      	DEC	C
  6E77'   20 F5          C      	JR	NZ,SV.SVEN2
  6E79'   CD 5601'       C      	CALL	XY.LDDX
  6E7C'   11             C      	DB	17
  6E7D'   22 2B2E'       C      	LD	(UB.PAR5),HL
  6E80'   C9             C      	RET
  6E81'                  C      SV.STAD0:
  6E81'   21 0000        C      	LD	HL,0
  6E84'   22 2B2C'       C      	LD	(UB.PAR4),HL
  6E87'   18 D8          C      	JR	SV.SVLS1
  6E89'                  C      SV.DALO1:
  6E89'   F5             C      	PUSH	AF
  6E8A'   21 2B26'       C      	LD	HL,UB.PAR1
  6E8D'   35             C      	DEC	(HL)
  6E8E'   23             C      	INC	HL
  6E8F'   3E 4C          C      	LD	A,'L'
  6E91'   77             C      	LD	(HL),A
  6E92'   F1             C      	POP	AF
  6E93'   C9             C      	RET
  6E94'                  C      SV.SVSZ:
  6E94'   3E 7D          C      	LD	A,UE.SVL
  6E96'                  C      SV.SVSZ2:
  6E96'   F5             C      	PUSH	AF
  6E97'   CD 61E1'       C      	CALL	UK.PUTK
  6E9A'   ED 5B 2B28'    C      	LD	DE,(UB.PAR2)
  6E9E'   7A             C      	LD	A,D
  6E9F'   CD 61E1'       C      	CALL	UK.PUTK
  6EA2'   7B             C      	LD	A,E
  6EA3'   CD 61E1'       C      	CALL	UK.PUTK
  6EA6'   F1             C      	POP	AF
  6EA7'   47             C      	LD	B,A
  6EA8'                  C      SV.SVSZ1:
  6EA8'   1A             C      	LD	A,(DE)
  6EA9'   CD 61E1'       C      	CALL	UK.PUTK
  6EAC'   13             C      	INC	DE
  6EAD'   10 F9          C      	DJNZ	SV.SVSZ1
  6EAF'   ED 53 2B28'    C      	LD	(UB.PAR2),DE
  6EB3'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                                ;
                                ;	INCLUDE	KX.MAC	;Kopieren von MRES-Kassetten Teil 1
                                ;	INCLUDE	KY.MAC	;Kopieren von MRES-Kassetten Teil 2
                                ;	INCLUDE	KU.MAC	;Unterprogramme fuer KOPI
                         C      	INCLUDE K4.MAC	;Kopieren MRES
                         C      	TITLE	'Kopieren von MRES-Kassetten Teil 1'
                         C      	PAGE
'Kopieren von MRES-Kassetten Teil 1'	MACRO-80 3.44	09-Dec-81	PAGE	1-73


                         C      
                         C      ;	PN	KX
                         C      ;------------------------------------------------------------------
                         C      ;
                         C      ;          KOPIEREN VON MRES-KASSETTEN       TEIL1
                         C      ;
                         C      ;----------------------------------------------------------------
  6EB4'   6EB4'          C      	DW	$
  6EB6'   4B 4F 50 49    C      	DB	'KOPI'
  6EBA'   CD 54E2'       C      	CALL	U1.KTINI
  6EBD'   11 E000        C      	LD	DE,BC.TAB1
  6EC0'   21 3327        C      	LD	HL,UE.BWSA+327H
  6EC3'   7E             C      	LD	A,(HL)
  6EC4'   CD 55C5'       C      	CALL	U1.TST
  6EC7'   D8             C      	RET	C
  6EC8'   12             C      	LD	(DE),A
  6EC9'   23             C      	INC	HL
  6ECA'   EE 33          C      	XOR	33H
  6ECC'   BE             C      	CP	(HL)
  6ECD'   C0             C      	RET	NZ
  6ECE'   EE 30          C      	XOR	30H
  6ED0'   13             C      	INC	DE
  6ED1'   12             C      	LD	(DE),A
  6ED2'   3A 3326        C      	LD	A,(UE.BWSA+326H)
  6ED5'   FE 4A          C      	CP	'J'
  6ED7'   28 05          C      	JR	Z,$+7	;BEI KOPIJ WERDEN WEITERE PARAMETER
  6ED9'   23             C      	INC	HL	;IGNORIERT
  6EDA'   23             C      	INC	HL
  6EDB'   7E             C      	LD	A,(HL)
  6EDC'   FE 20          C      	CP	20H
  6EDE'   F5             C      	PUSH	AF
  6EDF'   20 0C          C      	JR	NZ,$+14
  6EE1'   CD 546D'       C      	CALL	U1.EIN
  6EE4'   CD 55E6'       C      	CALL	U1.KRWE
  6EE7'   CD 5476'       C      	CALL	U1.AUS
  6EEA'   CD 55E6'       C      	CALL	U1.KRWE
  6EED'   CD 7028'       C      	CALL	KX.UPA
  6EF0'   F1             C      	POP	AF
  6EF1'   28 13          C      	JR	Z,$+21
  6EF3'   FE 41          C      	CP	'A'
  6EF5'   28 0A          C      	JR	Z,$+12
  6EF7'   FE 4C          C      	CP	'L'
  6EF9'   20 0B          C      	JR	NZ,$+13
  6EFB'   CD 5445'       C      	CALL	U1.COPB
  6EFE'   C3 6FCE'       C      	JP	KX.RSPFR
  6F01'   CD 5441'       C      	CALL	U1.COPB2
  6F04'   18 FB          C      	JR	$-3
                         C      ;-------------------------------------------------------------------
  6F06'   CD 546D'       C      	CALL	U1.EIN
  6F09'   CD 5496'       C      	CALL	U1.DSVG
  6F0C'   CD 5420'       C      	CALL	U1.KBR4
  6F0F'   CD 542B'       C      	CALL	U1.BREAD
  6F12'   21 5E58'       C      	LD	HL,UA.Z7E
  6F15'   11 3163        C      	LD	DE,SD.BWSA +  4*80 + 35	;3163H
  6F18'   01 001F        C      	LD	BC,31
  6F1B'   ED B0          C      	LDIR
  6F1D'   21 5E77'       C      	LD	HL,UA.GER
  6F20'   11 31EA        C      	LD	DE,SD.BWSA +  6*80 + 10	;31EAH
  6F23'   CD 55AB'       C      	CALL	U1.INFO
  6F26'   21 5E22'       C      	LD	HL,UA.KNAME+3
  6F29'   11 323A        C      	LD	DE,SD.BWSA +  7*80 + 10	;323AH
  6F2C'   CD 55AB'       C      	CALL	U1.INFO
  6F2F'   21 5E35'       C      	LD	HL,UA.NR+3
  6F32'   11 328A        C      	LD	DE,SD.BWSA +  8*80 + 10	;328AH
  6F35'   CD 55AB'       C      	CALL	U1.INFO
  6F38'   21 5E48'       C      	LD	HL,UA.KOMMT+3
  6F3B'   11 32DA        C      	LD	DE,SD.BWSA +  9*80 + 10	;32DAH
  6F3E'   CD 55AB'       C      	CALL	U1.INFO
  6F41'   11 3203        C      	LD	DE,SD.BWSA +  6*80 + 35	;3203H
  6F44'   3A E000        C      	LD	A,(BC.TAB1)
  6F47'   CD 56A5'       C      	CALL	UC.CVBX+2
  6F4A'   11 321B        C      	LD	DE,SD.BWSA +  6*80 + 59	;321BH
  6F4D'   3A E001        C      	LD	A,(BC.TAB1+1)
  6F50'   CD 56A5'       C      	CALL	UC.CVBX+2
  6F53'   21 0E6A        C      	LD	HL,UE.PUF+4
  6F56'   11 3253        C      	LD	DE,SD.BWSA +  7*80 + 35	;3253H
  6F59'   06 06          C      	LD	B,6
  6F5B'   CD 57B0'       C      	CALL	UC.DKONV
  6F5E'   21 0E8B        C      	LD	HL,UE.PUF+37
  6F61'   11 32A3        C      	LD	DE,SD.BWSA +  8*80 + 35	;32A3H
  6F64'   06 03          C      	LD	B,3
  6F66'   CD 57B0'       C      	CALL	UC.DKONV
'Kopieren von MRES-Kassetten Teil 1'	MACRO-80 3.44	09-Dec-81	PAGE	1-74


  6F69'   11 32F3        C      	LD	DE,SD.BWSA +  9*80 + 35	;32F3H
  6F6C'   06 0B          C      	LD	B,11
  6F6E'   CD 57B0'       C      	CALL	UC.DKONV
  6F71'   CD 60C5'       C      	CALL	UR.KBV
  6F74'   CD 60C5'       C      	CALL	UR.KBV
  6F77'   CD 542B'       C      	CALL	U1.BREAD
  6F7A'   3A 0E69        C      	LD	A,(UE.PUF+3)
  6F7D'   3D             C      	DEC	A
  6F7E'   CA 6FD9'       C      	JP	Z,KX.ENDR
  6F81'   CD 5518'       C      	CALL	U1.VERIN
  6F84'   CD 5476'       C      	CALL	U1.AUS
  6F87'   CD 5496'       C      	CALL	U1.DSVG
  6F8A'   CD 5420'       C      	CALL	U1.KBR4
  6F8D'   DD 36 04 02    C      	LD	(IX+4),02H
  6F91'   CD 5D25'       C      	CALL	UF.EXEC
  6F94'   21 0E6A        C      	LD	HL,UE.PUF+4
  6F97'   11 326B        C      	LD	DE,SD.BWSA +  7*80 + 59	;326BH
  6F9A'   06 06          C      	LD	B,6
  6F9C'   CD 57B0'       C      	CALL	UC.DKONV
  6F9F'   21 0E8B        C      	LD	HL,UE.PUF+37
  6FA2'   11 32BB        C      	LD	DE,SD.BWSA +  8*80 + 59	;32BBH
  6FA5'   06 03          C      	LD	B,3
  6FA7'   CD 57B0'       C      	CALL	UC.DKONV
  6FAA'   11 330B        C      	LD	DE,SD.BWSA +  9*80 + 59	;330BH
  6FAD'   06 0B          C      	LD	B,11
  6FAF'   CD 57B0'       C      	CALL	UC.DKONV
  6FB2'   CD 60C5'       C      	CALL	UR.KBV
  6FB5'   CD 60C5'       C      	CALL	UR.KBV
  6FB8'   DD 36 04 02    C      	LD	(IX+4),02H
  6FBC'   CD 5D25'       C      	CALL	UF.EXEC
  6FBF'   CD 55B1'       C      	CALL	U1.BILO
  6FC2'   11 E002        C      	LD	DE,BC.VTABA
  6FC5'   CD 5520'       C      	CALL	U1.VERNI
  6FC8'   CD 553A'       C      	CALL	U1.VORST
  6FCB'   C3 7045'       C      	JP	KY.MD
  6FCE'                  C      KX.RSPFR:
  6FCE'   F5             C      	PUSH	AF
  6FCF'   23             C      	INC	HL
  6FD0'   23             C      	INC	HL
  6FD1'   7E             C      	LD	A,(HL)
  6FD2'   B7             C      	OR	A
  6FD3'   FE 52          C      	CP	'R'
  6FD5'   20 06          C      	JR	NZ,$+8
  6FD7'   18 01          C      	JR	$+3
  6FD9'                  C      KX.ENDR:
  6FD9'   F5             C      	PUSH	AF
  6FDA'   37             C      	SCF
  6FDB'   18 04          C      	JR	$+6
  6FDD'   FE 46          C      	CP	'F'
  6FDF'   20 15          C      	JR	NZ,$+23
  6FE1'   CD 546D'       C      	CALL	U1.EIN
  6FE4'   DC 609D'       C      	CALL	C,UR.KRW
  6FE7'   CD 60A7'       C      	CALL	UR.KRA
  6FEA'   CD 5476'       C      	CALL	U1.AUS
  6FED'   CD 6095'       C      	CALL	UR.KRE
  6FF0'   DC 60A3'       C      	CALL	C,UR.KRWW
  6FF3'   CD 60A7'       C      	CALL	UR.KRA
  6FF6'   F1             C      	POP	AF
  6FF7'   C9             C      	RET
  6FF8'                  C      KX.EXEC2:
  6FF8'   F5             C      	PUSH	AF
  6FF9'   DD CB 00 BE    C      	RES	7,(IX+0)
  6FFD'   DD 36 01 00    C      	LD	(IX+1),0
  7001'   CD 5C92'       C      	CALL	KR.KARO
  7004'   DD CB 00 7E    C      	BIT	7,(IX+0)
  7008'   28 0A          C      	JR	Z,$+12
  700A'   DD 7E 01       C      	LD	A,(IX+1)
  700D'   FE 14          C      	CP	14H
  700F'   28 05          C      	JR	Z,$+7
  7011'   CD 5D55'       C      	CALL	UF.ERANZ
  7014'   F1             C      	POP	AF
  7015'   C9             C      	RET
  7016'   DD CB 00 BE    C      	RES	7,(IX)
  701A'   CD 5476'       C      	CALL	U1.AUS
  701D'   CD 60BF'       C      	CALL	UR.KSL
  7020'   F1             C      	POP	AF
  7021'   06 06          C      	LD	B,6
  7023'   33             C      	INC	SP
  7024'   10 FD          C      	DJNZ	$-1	;STACK BERICHTIGEN
  7026'   18 A6          C      	JR	KX.RSPFR
  7028'                  C      KX.UPA:
  7028'   CD 546D'       C      	CALL	U1.EIN
  702B'   CD 6095'       C      	CALL	UR.KRE
'Kopieren von MRES-Kassetten Teil 1'	MACRO-80 3.44	09-Dec-81	PAGE	1-75


  702E'   DD 36 00 00    C      	LD	(IX+0),0
  7032'   CD 5476'       C      	CALL	U1.AUS
  7035'   CD 6095'       C      	CALL	UR.KRE
  7038'   DD CB 00 56    C      	BIT	2,(IX+0)
  703C'   28 05          C      	JR	Z,$+7
  703E'   D1             C      	POP	DE
  703F'   3E 19          C      	LD	A,19H
  7041'   CD 5D55'       C      	CALL	UF.ERANZ
  7044'   C9             C      	RET
                         C      ;	END
                         C      	TITLE	'Kopieren von MRES-Kassetten Teil 2'
                         C      	PAGE
'Kopieren von MRES-Kassetten Teil 2'	MACRO-80 3.44	09-Dec-81	PAGE	1-76


                         C      
                         C      ;	PN	KY
                         C      ;---------------------------------------------------------------------
                         C      ;
                         C      ;          KOPIEREN VON MRES-KASSETTEN           TEIL 2
                         C      ;
                         C      ;--------------------------------------------------------------------
  7045'                  C      KY.MD:
  7045'   CD 55B1'       C      	CALL	U1.BILO
  7048'   21 5E86'       C      	LD	HL,UA.KOPFR
  704B'   CD 729E'       C      	CALL	KY.SATR
  704E'   3E 0D          C      	LD	A,13
  7050'   32 2B00'       C      	LD	(UB.ZN),A
  7053'   21 ECA2        C      	LD	HL,BC.VTABE+32
  7056'   FD 21 F902     C      	LD	IY,BC.TAB2
  705A'   FD 36 00 FF    C      	LD	(IY+0),0FFH
  705E'   3A EC85        C      	LD	A,(BC.VTABE+3)
  7061'   47             C      	LD	B,A
  7062'   05             C      	DEC	B
                         C      ;--------------------------------ABFRAGEZYKLUS------------------------
  7063'                  C      KY.DFR:
  7063'   C5             C      	PUSH	BC
  7064'   11 2B4E'       C      	LD	DE,UB.SATZ+26
  7067'   01 0006        C      	LD	BC,6
  706A'   ED B0          C      	LDIR
  706C'   13             C      	INC	DE
  706D'   13             C      	INC	DE
  706E'   01 0002        C      	LD	BC,2
  7071'   ED B0          C      	LDIR
  7073'   01 0018        C      	LD	BC,24
  7076'   09             C      	ADD	HL,BC
  7077'   E5             C      	PUSH	HL
  7078'   21 2B34'       C      	LD	HL,UB.SATZ
  707B'   CD 595C'       C      	CALL	UR.MIMO
  707E'   DC 72FA'       C      	CALL	C,KU.ZEIR
  7081'   CD 7295'       C      	CALL	KY.JHL	;BEI KOPIJ WIRD J GESETZT
  7084'   7E             C      	LD	A,(HL)
  7085'   FE 4A          C      	CP	'J'
  7087'   C4 72C2'       C      	CALL	NZ,KU.TAB2L
  708A'   E1             C      	POP	HL
  708B'   01 0009        C      	LD	BC,9
  708E'   B7             C      	OR	A
  708F'   ED 42          C      	SBC	HL,BC
  7091'   7E             C      	LD	A,(HL)
  7092'   FD 77 00       C      	LD	(IY+0),A
  7095'   FD 23          C      	INC	IY
  7097'   FD 36 00 FF    C      	LD	(IY+0),0FFH
  709B'   09             C      	ADD	HL,BC
  709C'   3A E005        C      	LD	A,(BC.VTABA+3)
  709F'   FE 01          C      	CP	01H
  70A1'   28 2E          C      	JR	Z,KY.EZYK1
  70A3'   E5             C      	PUSH	HL
  70A4'   01 0020        C      	LD	BC,32
  70A7'   B7             C      	OR	A
  70A8'   ED 42          C      	SBC	HL,BC
  70AA'   EB             C      	EX	DE,HL
  70AB'   E1             C      	POP	HL
  70AC'   DD 21 E002     C      	LD	IX,BC.VTABA
  70B0'   47             C      	LD	B,A
  70B1'   05             C      	DEC	B
  70B2'                  C      KY.VZVGL:
  70B2'   C5             C      	PUSH	BC
  70B3'   01 0020        C      	LD	BC,32
  70B6'   DD 09          C      	ADD	IX,BC
  70B8'   DD E5          C      	PUSH	IX
  70BA'   06 07          C      	LD	B,7
  70BC'   D5             C      	PUSH	DE
  70BD'                  C      KY.SVGL:
  70BD'   1A             C      	LD	A,(DE)
  70BE'   DD BE 00       C      	CP	(IX+0)
  70C1'   20 08          C      	JR	NZ,KY.NDA
  70C3'   DD 23          C      	INC	IX
  70C5'   13             C      	INC	DE
  70C6'   10 F5          C      	DJNZ	KY.SVGL
  70C8'   CD 732A'       C      	CALL	KU.DD	;DATEI SCHON VORHANDEN
  70CB'                  C      KY.NDA:
  70CB'   D1             C      	POP	DE
  70CC'   DD E1          C      	POP	IX
  70CE'   C1             C      	POP	BC
  70CF'   10 E1          C      	DJNZ	KY.VZVGL
  70D1'                  C      KY.EZYK1:
  70D1'   C1             C      	POP	BC
'Kopieren von MRES-Kassetten Teil 2'	MACRO-80 3.44	09-Dec-81	PAGE	1-77


  70D2'   10 8F          C      	DJNZ	KY.DFR
                         C      ;---------------------------------------------------------------------
  70D4'                  C      KY.ATAA:
  70D4'   06 03          C      	LD	B,3	;WARTESCHLEIFE FUER
  70D6'   21 FFFF        C      	LD	HL,0FFFFH
  70D9'   2B             C      	DEC	HL
  70DA'   7C             C      	LD	A,H
  70DB'   B5             C      	OR	L
  70DC'   20 FB          C      	JR	NZ,$-3
  70DE'   10 F6          C      	DJNZ	$-8
  70E0'   21 5EBC'       C      	LD	HL,UA.EABFR
  70E3'   CD 729E'       C      	CALL	KY.SATR
  70E6'   21 2B34'       C      	LD	HL,UB.SATZ
  70E9'   CD 595C'       C      	CALL	UR.MIMO
  70EC'   38 F8          C      	JR	C,$-6
  70EE'   CD 7295'       C      	CALL	KY.JHL
  70F1'   7E             C      	LD	A,(HL)
  70F2'   FE 4A          C      	CP	'J'
  70F4'   C2 7045'       C      	JP	NZ,KY.MD
                         C      ;--------------------------------Labelnummern fuer Ausgabe ---------
  70F7'                  C      KY.ATAB:
  70F7'   06 00          C      	LD	B,0
  70F9'   21 F902        C      	LD	HL,BC.TAB2
  70FC'   11 F9D2        C      	LD	DE,BC.TAB3
  70FF'   7E             C      	LD	A,(HL)
  7100'   FE FF          C      	CP	0FFH	;KEINE DATEI KOPIEREN
  7102'   CA 6FD9'       C      	JP	Z,KX.ENDR
  7105'   3A E003        C      	LD	A,(BC.VTABA+1)
  7108'                  C      KY.ATABE:
  7108'   12             C      	LD	(DE),A
  7109'   23             C      	INC	HL
  710A'   13             C      	INC	DE
  710B'   04             C      	INC	B
  710C'   F5             C      	PUSH	AF
  710D'   7E             C      	LD	A,(HL)
  710E'   FE FF          C      	CP	0FFH
  7110'   28 04          C      	JR	Z,KY.WEI
  7112'   F1             C      	POP	AF
  7113'   3C             C      	INC	A
  7114'   18 F2          C      	JR	KY.ATABE
                         C      ;------------------------------TAB:NR DER VERZ.EINTRAGUNGEN (EING.)------
  7116'                  C      KY.WEI:
  7116'   F1             C      	POP	AF
  7117'   C5             C      	PUSH	BC
  7118'   AF             C      	XOR	A
  7119'   57             C      	LD	D,A
  711A'   3A EC85        C      	LD	A,(BC.VTABE+3)
  711D'   47             C      	LD	B,A
  711E'   05             C      	DEC	B
  711F'   21 F902        C      	LD	HL,BC.TAB2
  7122'   FD 21 F96A     C      	LD	IY,BC.TAB2A
  7126'   DD 21 ECA2     C      	LD	IX,BC.VTABE+32	;???
  712A'                  C      KY.ZYK:
  712A'   14             C      	INC	D
  712B'   7E             C      	LD	A,(HL)
  712C'   DD BE 17       C      	CP	(IX+23)
  712F'   20 0B          C      	JR	NZ,KY.NE
  7131'   7A             C      	LD	A,D
  7132'   FD 77 00       C      	LD	(IY+0),A
  7135'   FD 36 01 FF    C      	LD	(IY+1),0FFH
  7139'   23             C      	INC	HL
  713A'   FD 23          C      	INC	IY
  713C'                  C      KY.NE:
  713C'   C5             C      	PUSH	BC
  713D'   01 0020        C      	LD	BC,32
  7140'   DD 09          C      	ADD	IX,BC
  7142'   C1             C      	POP	BC
  7143'   10 E5          C      	DJNZ	KY.ZYK
                         C      ;------------------------------------AUFBAU AUSGABEVERZ.-----
  7145'   3A E005        C      	LD	A,(BC.VTABA+3)
  7148'   47             C      	LD	B,A
  7149'   FE 01          C      	CP	01H
  714B'   28 08          C      	JR	Z,KY.EVZ
  714D'   21 E002        C      	LD	HL,BC.VTABA
  7150'   CD 72B9'       C      	CALL	KU.VVOR
  7153'   18 03          C      	JR	KY.EVZ1
  7155'                  C      KY.EVZ:
  7155'   21 E022        C      	LD	HL,BC.VTABA+32
  7158'                  C      KY.EVZ1:
  7158'   DD 21 F96A     C      	LD	IX,BC.TAB2A
  715C'   FD 21 F9D2     C      	LD	IY,BC.TAB3
  7160'   EB             C      	EX	DE,HL
  7161'   21 ECA2        C      	LD	HL,BC.VTABE+32
'Kopieren von MRES-Kassetten Teil 2'	MACRO-80 3.44	09-Dec-81	PAGE	1-78


  7164'   DD 7E 00       C      	LD	A,(IX+0)
  7167'   FE 01          C      	CP	01H
  7169'   28 05          C      	JR	Z,KY.VSTR
  716B'   3D             C      	DEC	A
  716C'   47             C      	LD	B,A
  716D'   CD 72B9'       C      	CALL	KU.VVOR
  7170'                  C      KY.VSTR:
  7170'   01 0020        C      	LD	BC,32
  7173'   ED B0          C      	LDIR
  7175'   FD 7E 00       C      	LD	A,(IY+0)
  7178'   EB             C      	EX	DE,HL
  7179'   01 0009        C      	LD	BC,9
  717C'   B7             C      	OR	A
  717D'   ED 42          C      	SBC	HL,BC
  717F'   77             C      	LD	(HL),A
  7180'   09             C      	ADD	HL,BC
  7181'   EB             C      	EX	DE,HL
  7182'   DD 7E 01       C      	LD	A,(IX+1)
  7185'   FE FF          C      	CP	0FFH
  7187'   28 10          C      	JR	Z,KY.COPY
  7189'   DD 96 00       C      	SUB	(IX+0)
  718C'   3D             C      	DEC	A
  718D'   47             C      	LD	B,A
  718E'   FE 00          C      	CP	00H
  7190'   C4 72B9'       C      	CALL	NZ,KU.VVOR
  7193'   FD 23          C      	INC	IY
  7195'   DD 23          C      	INC	IX
  7197'   18 D7          C      	JR	KY.VSTR
                         C      ;------------------------------------VERZ.SCHREIBEN (NUR NEUE SAETZE)---
  7199'                  C      KY.COPY:
  7199'   DD 21 2B03'    C      	LD	IX,UB.KTAB
  719D'   CD 54FB'       C      	CALL	U1.KTIN1
  71A0'   DD 36 0A 20    C      	LD	(IX+10),20H
  71A4'   CD 5476'       C      	CALL	U1.AUS
  71A7'   3A E005        C      	LD	A,(BC.VTABA+3)
  71AA'   47             C      	LD	B,A
  71AB'   CD 60C5'       C      	CALL	UR.KBV	;AUSGABEKASSETTE
  71AE'   3D             C      	DEC	A
  71AF'   20 FA          C      	JR	NZ,$-4	;VORSTELLEN BIS HINTER LETZTEN ALTEN
  71B1'   21 E002        C      	LD	HL,BC.VTABA	;VERZ.SATZ
  71B4'   11 0020        C      	LD	DE,32
  71B7'   19             C      	ADD	HL,DE
  71B8'   10 FA          C      	DJNZ	$-4	;AUSGABEVERZ.ZEIGER
  71BA'   C1             C      	POP	BC
  71BB'   78             C      	LD	A,B
  71BC'   F5             C      	PUSH	AF
  71BD'                  C      KY.VSCHR:
  71BD'   11 0E66        C      	LD	DE,UE.PUF
  71C0'   01 0020        C      	LD	BC,32
  71C3'   ED B0          C      	LDIR
  71C5'   CD 60C5'       C      	CALL	UR.KBV
  71C8'   CD 60CB'       C      	CALL	UR.KBR
  71CB'   DD 36 04 08    C      	LD	(IX+4),08H
  71CF'   CD 5D25'       C      	CALL	UF.EXEC
  71D2'   3D             C      	DEC	A
  71D3'   20 E8          C      	JR	NZ,KY.VSCHR
                         C      ;----------------------------------------------------------------
  71D5'   11 33FA        C      	LD	DE,SD.BWSA + 12*80 + 58	;33FAH	;''ES WIRD KOPIERT''
  71D8'   21 7285'       C      	LD	HL,KY.EWK
  71DB'   01 0010        C      	LD	BC,16
  71DE'   ED B0          C      	LDIR
                         C      ;------------------------------KOPIEREN--------------------------
  71E0'   21 F902        C      	LD	HL,BC.TAB2
  71E3'   11 F9D2        C      	LD	DE,BC.TAB3
  71E6'   FD 21 F96A     C      	LD	IY,BC.TAB2A
  71EA'   1A             C      	LD	A,(DE)
  71EB'   47             C      	LD	B,A
  71EC'   04             C      	INC	B
  71ED'   CD 60DA'       C      	CALL	UR.POSIK
  71F0'   7E             C      	LD	A,(HL)
  71F1'   47             C      	LD	B,A
  71F2'   04             C      	INC	B
  71F3'                  C      KY.KOPV:
  71F3'   CD 546D'       C      	CALL	U1.EIN
  71F6'   CD 60DA'       C      	CALL	UR.POSIK
  71F9'                  C      KY.KOP:
  71F9'   CD 542B'       C      	CALL	U1.BREAD
  71FC'   7E             C      	LD	A,(HL)
  71FD'   FE 01          C      	CP	01H
  71FF'   CC 5486'       C      	CALL	Z,U1.VSX
                         C      ;------------------------ANZEIGE WELCHE DATEI KOPIERT WIRD-------------
  7202'   E5             C      	PUSH	HL
  7203'   D5             C      	PUSH	DE
'Kopieren von MRES-Kassetten Teil 2'	MACRO-80 3.44	09-Dec-81	PAGE	1-79


  7204'   FD 7E 00       C      	LD	A,(IY+0)
  7207'   47             C      	LD	B,A
  7208'   05             C      	DEC	B
  7209'   21 ECA2        C      	LD	HL,BC.VTABE+32
  720C'   FE 01          C      	CP	01H
  720E'   28 03          C      	JR	Z,KY.KOPAN
  7210'   CD 72B9'       C      	CALL	KU.VVOR
  7213'                  C      KY.KOPAN:
  7213'   11 34F0        C      	LD	DE,SD.BWSA + 15*80 + 64	;34F0H
  7216'   01 0006        C      	LD	BC,6
  7219'   ED B0          C      	LDIR
  721B'   13             C      	INC	DE
  721C'   13             C      	INC	DE
  721D'   01 0002        C      	LD	BC,2
  7220'   ED B0          C      	LDIR
  7222'   FD 23          C      	INC	IY
  7224'   D1             C      	POP	DE
  7225'   E1             C      	POP	HL
                         C      ;--------------------------------------------------------------------
  7226'   1A             C      	LD	A,(DE)
  7227'   FE 01          C      	CP	01H
  7229'   CC 547F'       C      	CALL	Z,U1.VS1
  722C'   32 0E66        C      	LD	(UE.PUF),A
  722F'   CD 5436'       C      	CALL	U1.BWRIT
  7232'   CD 5445'       C      	CALL	U1.COPB
  7235'   23             C      	INC	HL
  7236'   7E             C      	LD	A,(HL)
  7237'   FE FF          C      	CP	0FFH
  7239'   28 0B          C      	JR	Z,KY.EOV
  723B'   2B             C      	DEC	HL
  723C'   96             C      	SUB	(HL)
  723D'   23             C      	INC	HL
  723E'   13             C      	INC	DE
  723F'   47             C      	LD	B,A
  7240'   FE 01          C      	CP	01H
  7242'   20 AF          C      	JR	NZ,KY.KOPV
  7244'   18 B3          C      	JR	KY.KOP
                         C      ;-------------------------------------------------------------
  7246'                  C      KY.EOV:
  7246'   CD 5486'       C      	CALL	U1.VSX
  7249'   3A E003        C      	LD	A,(BC.VTABA+1)
  724C'   47             C      	LD	B,A
  724D'   F1             C      	POP	AF
  724E'   F5             C      	PUSH	AF
  724F'   80             C      	ADD	A,B
  7250'   32 0E66        C      	LD	(UE.PUF),A
  7253'   CD 54FB'       C      	CALL	U1.KTIN1
  7256'   DD 36 0A 20    C      	LD	(IX+10),20H
  725A'   CD 5436'       C      	CALL	U1.BWRIT
  725D'   CD 60BF'       C      	CALL	UR.KSL
  7260'   CD 6FD9'       C      	CALL	KX.ENDR
  7263'   CD 6095'       C      	CALL	UR.KRE
  7266'   CD 5496'       C      	CALL	U1.DSVG
  7269'   F1             C      	POP	AF
  726A'   F5             C      	PUSH	AF
  726B'   81             C      	ADD	A,C	;NEXT RECORD UND
  726C'   32 0E67        C      	LD	(UE.PUF+1),A
  726F'   F1             C      	POP	AF
  7270'   80             C      	ADD	A,B	;ANZAHL VERZ.EINTR. KORRIGIEREN
  7271'   32 0E69        C      	LD	(UE.PUF+3),A
  7274'   CD 60CB'       C      	CALL	UR.KBR
  7277'   DD 36 04 08    C      	LD	(IX+4),08H
  727B'   CD 5D25'       C      	CALL	UF.EXEC	;NEUEN DS-SATZ SCHREIBEN
  727E'   CD 609D'       C      	CALL	UR.KRW
  7281'   CD 60A7'       C      	CALL	UR.KRA
  7284'   C9             C      	RET
                         C      ;---------------------------------------------------------------
  7285'                  C      KY.EWK:
  7285'   45 73 20 77    C      	DB	'Es wird kopiert:'
  7289'   69 72 64 20    C      
  728D'   6B 6F 70 69    C      
  7291'   65 72 74 3A    C      
                         C      ;---------------------------------------------------------------
  7295'                  C      KY.JHL:
  7295'   3A 2B28'       C      	LD	A,(UB.PAR2)
  7298'   FE 4A          C      	CP	'J'
  729A'   20 01          C      	JR	NZ,$+3
  729C'   77             C      	LD	(HL),A
  729D'   C9             C      	RET
                         C      ;--------------------------------------------------------------
  729E'                  C      KY.SATR:
  729E'   11 2B34'       C      	LD	DE,UB.SATZ
  72A1'   01 0036        C      	LD	BC,54
'Kopieren von MRES-Kassetten Teil 2'	MACRO-80 3.44	09-Dec-81	PAGE	1-80


  72A4'   ED B0          C      	LDIR
  72A6'   3A 3326        C      	LD	A,(UE.BWSA+326H)
  72A9'   FE 4A          C      	CP	'J'
  72AB'   CC 72B2'       C      	CALL	Z,KY.AJ
  72AE'   32 2B28'       C      	LD	(UB.PAR2),A
  72B1'   C9             C      	RET
  72B2'                  C      KY.AJ:
  72B2'   F5             C      	PUSH	AF
  72B3'   AF             C      	XOR	A
  72B4'   32 2B34'       C      	LD	(UB.SATZ),A
  72B7'   F1             C      	POP	AF
  72B8'   C9             C      	RET
                         C      ;--------------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Unterprogramme fuer KOPI'
                         C      	PAGE
'Unterprogramme fuer KOPI'	MACRO-80 3.44	09-Dec-81	PAGE	1-81


                         C      
                         C      ;	PN	KU
                         C      ;------------------------------------------------------------------
                         C      ;
                         C      ;          UNTERPROGRAMME FUER KOPI
                         C      ;
                         C      ;--------------------------------------------------------
  72B9'                  C      KU.VVOR:
  72B9'   C5             C      	PUSH	BC
  72BA'   01 0020        C      	LD	BC,32
  72BD'   09             C      	ADD	HL,BC
  72BE'   C1             C      	POP	BC
  72BF'   10 F8          C      	DJNZ	KU.VVOR
  72C1'   C9             C      	RET
  72C2'                  C      KU.TAB2L:
  72C2'   D1             C      	POP	DE
  72C3'   E1             C      	POP	HL
  72C4'   FD 7E 00       C      	LD	A,(IY+0)
  72C7'   FE FF          C      	CP	0FFH
  72C9'   28 22          C      	JR	Z,$+36
  72CB'   FD E5          C      	PUSH	IY
  72CD'   06 00          C      	LD	B,00H
  72CF'   FD 7E 00       C      	LD	A,(IY+0)
  72D2'   FE FF          C      	CP	0FFH
  72D4'   20 02          C      	JR	NZ,$+4
  72D6'   18 05          C      	JR	$+7
  72D8'   FD 23          C      	INC	IY
  72DA'   04             C      	INC	B
  72DB'   18 F2          C      	JR	$-12
  72DD'   FD E1          C      	POP	IY
  72DF'   FD E5          C      	PUSH	IY
  72E1'   FD 7E 01       C      	LD	A,(IY+1)
  72E4'   FD 77 00       C      	LD	(IY+0),A
  72E7'   FD 23          C      	INC	IY
  72E9'   10 F6          C      	DJNZ	$-8
  72EB'   FD E1          C      	POP	IY
  72ED'   C1             C      	POP	BC
  72EE'   05             C      	DEC	B
  72EF'   78             C      	LD	A,B
  72F0'   FE 00          C      	CP	00H
  72F2'   28 03          C      	JR	Z,$+5
  72F4'   C3 7063'       C      	JP	KY.DFR
  72F7'   C3 70D4'       C      	JP	KY.ATAA
  72FA'                  C      KU.ZEIR:
  72FA'   D1             C      	POP	DE
  72FB'   E1             C      	POP	HL
  72FC'   3A 2B00'       C      	LD	A,(UB.ZN)
  72FF'   D6 02          C      	SUB	2
  7301'   FE 0D          C      	CP	13
  7303'   30 04          C      	JR	NC,$+6
  7305'   C1             C      	POP	BC
  7306'   C3 7045'       C      	JP	KY.MD
  7309'   32 2B00'       C      	LD	(UB.ZN),A
  730C'   01 0029        C      	LD	BC,41
  730F'   B7             C      	OR	A
  7310'   ED 42          C      	SBC	HL,BC
  7312'   FD 2B          C      	DEC	IY
  7314'   7E             C      	LD	A,(HL)
  7315'   FD BE 00       C      	CP	(IY+0)
  7318'   CC 7327'       C      	CALL	Z,KU.DECIY
  731B'   FD 23          C      	INC	IY
  731D'   01 0017        C      	LD	BC,23
  7320'   B7             C      	OR	A
  7321'   ED 42          C      	SBC	HL,BC
  7323'   C1             C      	POP	BC
  7324'   04             C      	INC	B
  7325'   18 CA          C      	JR	$-52
  7327'                  C      KU.DECIY:
  7327'   FD 2B          C      	DEC	IY
  7329'   C9             C      	RET
  732A'                  C      KU.DD:
  732A'   E5             C      	PUSH	HL
  732B'   21 5EF2'       C      	LD	HL,UA.VORH
  732E'   CD 595C'       C      	CALL	UR.MIMO
  7331'   38 17          C      	JR	C,$+25
  7333'   7E             C      	LD	A,(HL)
  7334'   FE 4A          C      	CP	'J'
  7336'   28 0C          C      	JR	Z,$+14
  7338'   FD 2B          C      	DEC	IY
  733A'   FD 36 00 FF    C      	LD	(IY+0),0FFH
  733E'   11 0050        C      	LD	DE,80
  7341'   B7             C      	OR	A
'Unterprogramme fuer KOPI'	MACRO-80 3.44	09-Dec-81	PAGE	1-82


  7342'   ED 52          C      	SBC	HL,DE
  7344'   36 20          C      	LD	(HL),20H
  7346'   21 2B00'       C      	LD	HL,UB.ZN
  7349'   35             C      	DEC	(HL)
  734A'   E1             C      	POP	HL
  734B'   C9             C      	RET
  734C'   E1             C      	POP	HL
  734D'   D1             C      	POP	DE
  734E'   DD 21 2B03'    C      	LD	IX,UB.KTAB
  7352'   C3 6FD9'       C      	JP	KX.ENDR
                         C      ;	END
                                ;
                         C      	INCLUDE KM.MAC
                         C      	TITLE	'Kmbg'
                         C      	PAGE
'Kmbg'	MACRO-80 3.44	09-Dec-81	PAGE	1-83


                         C      
                         C      ;	PN	KM01
                         C      ;****************************************************************
                         C      ;*                  DEG2000   V.1.2   ---   Programm:   K m b g *
                         C      ;*  Version         --------------------------------------------*
                         C      ;*                  Programmierer: R. Sieber   A d W            *
                         C      ;*  V 1 . 2         --------------------------------------------*
                         C      ;*                  Stand        : 25.Februar 1985              *
                         C      ;****************************************************************
                         C      
  0002                   C      SM.FNL      EQU   02
  0003                   C      SM.FDOWN    EQU   03
  0005                   C      SM.FLEFT    EQU   05
  0006                   C      SM.FPOS1    EQU   06
  0007                   C      SM.FRIGHT   EQU   07
  0008                   C      SM.FLTAB    EQU   08
  0009                   C      SM.FUP      EQU   09
  000A                   C      SM.FRTAB    EQU   10
  000C                   C      SM.FDEL     EQU   12
  001C                   C      SM.FABS     EQU   28
                         C      
  7355'                  C      KM.ANF:
  7355'   7355'          C      	DW	$
  7357'   4B 6D 62 67    C      	DB	'Kmbg'
  735B'   21 754A'       C      	LD	HL,KM.DEL	;Taste:   D E L
  735E'   22 0CF8        C      	LD	(SM.FKTAB+(2*SM.FDEL)),HL
  7361'   21 7508'       C      	LD	HL,KM.ABS	;Taste:   A B S
  7364'   22 0D18        C      	LD	(SM.FKTAB+(2*SM.FABS)),HL
  7367'   21 73B3'       C      	LD	HL,KM.HOME	;Taste:   H O M E
  736A'   22 0CEC        C      	LD	(SM.FKTAB+(2*SM.FPOS1)),HL
  736D'   21 73BD'       C      	LD	HL,KM.SL	;Taste:   SCH_LINKS
  7370'   22 0CF0        C      	LD	(SM.FKTAB+(2*SM.FLTAB)),HL
  7373'   21 73CA'       C      	LD	HL,KM.SR	;Taste:   SCH_RECHTS
  7376'   22 0CF4        C      	LD	(SM.FKTAB+(2*SM.FRTAB)),HL
  7379'   21 73A7'       C      	LD	HL,KM.CO	;Taste:   C_HOCH
  737C'   22 0CF2        C      	LD	(SM.FKTAB+(2*SM.FUP)),HL
  737F'   21 73CF'       C      	LD	HL,KM.CR	;Taste:   C_RECHTS
  7382'   22 0CEE        C      	LD	(SM.FKTAB+(2*SM.FRIGHT)),HL
  7385'   21 73B8'       C      	LD	HL,KM.CU	;Taste:   C_RUNTER
  7388'   22 0CE6        C      	LD	(SM.FKTAB+(2*SM.FDOWN)),HL
  738B'   21 73C5'       C      	LD	HL,KM.CL	;Taste:   C_LINKS
  738E'   22 0CEA        C      	LD	(SM.FKTAB+(2*SM.FLEFT)),HL
  7391'   21 73D4'       C      	LD	HL,KM.CNZA	;Taste:   C N Z A
  7394'   22 0CE4        C      	LD	(SM.FKTAB+(2*SM.FNL)),HL
  7397'   21 7404'       C      	LD	HL,KM.NEWL	;Taste:   E T 1
  739A'   22 0DAE        C      	LD	(KM.TNEWL),HL
  739D'   21 7429'       C      	LD	HL,KM.EINA	;alphanum. Tasten
  73A0'   22 0DB0        C      	LD	(KM.TEINA),HL
                         C      
                         C      	; LD	HL,KM.UP13
                         C      	; LD	DE,KM.RAM
                         C      	; LD	BC,KM.UPEND-KM.UP13
                         C      	; LDIR
                         C      
  73A3'   DD 21 2B03'    C      	LD	IX,KM.KMTAB
  73A7'                  C      KM.CO:
  73A7'   DD CB 00 7E    C      	BIT	7,(IX)
  73AB'   C2 75F2'       C      	JP	NZ,KM.UP4-KM.UP13+KM.RAM
  73AE'   CD 7558'       C      	CALL	KM.UP2	;KMBG Reservieren EIN
  73B1'   31             C      	DB	31H
  73B2'   C9             C      	RET
                         C      
                         C      	PAGE
'Kmbg'	MACRO-80 3.44	09-Dec-81	PAGE	1-84


                         C      
                         C      ;****************************************************************
                         C      ;*                  Auswertung der Cursor-Tasten                *
                         C      ;****************************************************************
  73B3'                  C      KM.HOME:
  73B3'   CD 7555'       C      	CALL	KM.UP1	;KMBG Kassette zurueckspulen
  73B6'   21             C      	DB	21H
  73B7'   C9             C      	RET
                         C      
  73B8'                  C      KM.CU:
  73B8'   CD 7558'       C      	CALL	KM.UP2	;KMBG Reservieren AUS
  73BB'   41             C      	DB	41H
  73BC'   C9             C      	RET
                         C      
  73BD'                  C      KM.SL:
  73BD'   CD 7558'       C      	CALL	KM.UP2	;KMBG vorh.  Datensatz anzeigen
  73C0'   15             C      	DB	15H
  73C1'   CD 7555'       C      	CALL	KM.UP1
  73C4'   02             C      	DB	2
  73C5'                  C      KM.CL:
  73C5'   CD 7558'       C      	CALL	KM.UP2	;KMBG einen  Datensatz zuruecksetzen
  73C8'   15             C      	DB	15H
  73C9'   C9             C      	RET
                         C      
  73CA'                  C      KM.SR:
  73CA'   CD 7555'       C      	CALL	KM.UP1	;KMBG nachf. Datensatz anzeigen
  73CD'   02             C      	DB	2
  73CE'   C9             C      	RET
                         C      
  73CF'                  C      KM.CR:
  73CF'   CD 7558'       C      	CALL	KM.UP2	;KMBG einen  Datensatz vorsetzen
  73D2'   11             C      	DB	11H
  73D3'   C9             C      	RET
                         C      
  73D4'                  C      KM.CNZA:
  73D4'   DD CB 00 7E    C      	BIT	7,(IX)
  73D8'   C0             C      	RET	NZ
  73D9'   3A 7604'       C      	LD	A,(KM.TX2-KM.UP13+KM.RAM)
  73DC'   FE 6C          C      	CP	'l'
  73DE'   28 08          C      	JR	Z,KM.CNZA1
  73E0'   DD 36 09 00    C      	LD	(IX+9),0
  73E4'   DD 36 0A 01    C      	LD	(IX+10),1
  73E8'                  C      KM.CNZA1:
  73E8'   3E 71          C      	LD	A,71H
  73EA'   DD B6 04       C      	OR	(IX+4)
  73ED'   DD 77 04       C      	LD	(IX+4),A
  73F0'   CD 7569'       C      	CALL	KM.UP5
  73F3'   DD 7E 04       C      	LD	A,(IX+4)
  73F6'   CD 7555'       C      	CALL	KM.UP1
  73F9'   02             C      	DB	2
  73FA'   CD 7558'       C      	CALL	KM.UP2
  73FD'   15             C      	DB	15H
  73FE'   DD 77 04       C      	LD	(IX+4),A
  7401'   C3 75F2'       C      	JP	KM.UP4-KM.UP13+KM.RAM
                         C      ;****************************************************************
                         C      ;*                  Routine fuer die Taste   E T 1              *
                         C      ;****************************************************************
  7404'                  C      KM.NEWL:
  7404'   DD CB 00 7E    C      	BIT	7,(IX)
  7408'   C0             C      	RET	NZ
  7409'   21 0E66        C      	LD	HL,KM.PUFF
  740C'   22 2BE2'       C      	LD	(KM.KMTAB+0DFH),HL	;2BE0
  740F'   DD 7E 0A       C      	LD	A,(IX+10)
  7412'   3D             C      	DEC	A
  7413'   E6 F0          C      	AND	0F0H
  7415'   07             C      	RLCA
  7416'   07             C      	RLCA
  7417'   07             C      	RLCA
  7418'   07             C      	RLCA
  7419'   3C             C      	INC	A
  741A'   32 2BED'       C      	LD	(KM.KMTAB+0EAH),A	;2BEB
  741D'   CD 2060        C      	CALL	KM.MHOME
  7420'   CD 23BA        C      	CALL	KM.MINSL
  7423'   CD 225C        C      	CALL	ATACO
  7426'   C3 75F2'       C      	JP	KM.UP4-KM.UP13+KM.RAM
                         C      
                         C      	PAGE
'Kmbg'	MACRO-80 3.44	09-Dec-81	PAGE	1-85


                         C      
                         C      ;****************************************************************
                         C      ;*                  Auswertung der alphanumerischen Tasten      *
                         C      ;****************************************************************
  7429'                  C      KM.EINA:
  7429'   79             C      	LD	A,C
  742A'   21 0000        C      	LD	HL,0
  742D'   FE 72          C      	CP	'r'
  742F'   20 03          C      	JR	NZ,KM.EINA1
  7431'   21 7493'       C      	LD	HL,KM.EINAB
  7434'                  C      KM.EINA1:
  7434'   FE 7A          C      	CP	'z'
  7436'   20 03          C      	JR	NZ,KM.EINA2
  7438'   21 749E'       C      	LD	HL,KM.EINAC
  743B'                  C      KM.EINA2:
  743B'   FE 70          C      	CP	'p'
  743D'   20 03          C      	JR	NZ,KM.EINA3
  743F'   21 0000        C      	LD	HL,0
  7442'                  C      KM.EINA3:
  7442'   FE 63          C      	CP	'c'
  7444'   20 03          C      	JR	NZ,KM.EINA4
  7446'   21 0000        C      	LD	HL,0
  7449'                  C      KM.EINA4:
  7449'   22 0DA8        C      	LD	(KM.TTABU),HL
  744C'   FE 30          C      	CP	'0'
  744E'   38 04          C      	JR	C,KM.EINA5
  7450'   FE 47          C      	CP	'G'
  7452'   38 06          C      	JR	C,KM.EINA7
  7454'                  C      KM.EINA5:
  7454'   32 7604'       C      	LD	(KM.TX2-KM.UP13+KM.RAM),A
  7457'                  C      KM.EINA6:
  7457'   C3 75F2'       C      	JP	KM.UP4-KM.UP13+KM.RAM
                         C      
  745A'                  C      KM.EINA7:
  745A'   3A 7604'       C      	LD	A,(KM.TX2-KM.UP13+KM.RAM)
  745D'   FE 67          C      	CP	'g'
  745F'   20 10          C      	JR	NZ,KM.EINA8
  7461'   79             C      	LD	A,C
  7462'   D6 30          C      	SUB	30H
  7464'   D8             C      	RET	C
  7465'   C8             C      	RET	Z
  7466'   FE 03          C      	CP	3
  7468'   D0             C      	RET	NC
  7469'   DD 77 03       C      	LD	(IX+3),A
  746C'   CD 74C9'       C      	CALL	KM.UP20
  746F'   18 E6          C      	JR	KM.EINA6
                         C      
  7471'                  C      KM.EINA8:
  7471'   FE 6C          C      	CP	'l'
  7473'   20 1D          C      	JR	NZ,KM.EINAA
  7475'   79             C      	LD	A,C
  7476'   D6 30          C      	SUB	30H
  7478'   FE 0A          C      	CP	00AH
  747A'   38 02          C      	JR	C,KM.EINA9
  747C'   D6 07          C      	SUB	7
  747E'                  C      KM.EINA9:
  747E'   5F             C      	LD	E,A
  747F'   16 00          C      	LD	D,0
  7481'   62             C      	LD	H,D
  7482'   DD 6E 0A       C      	LD	L,(IX+10)
  7485'   29             C      	ADD	HL,HL
  7486'   29             C      	ADD	HL,HL
  7487'   29             C      	ADD	HL,HL
  7488'   29             C      	ADD	HL,HL
  7489'   19             C      	ADD	HL,DE
  748A'   DD 74 09       C      	LD	(IX+9),H
  748D'   DD 75 0A       C      	LD	(IX+10),L
  7490'   18 C5          C      	JR	KM.EINA6
                         C      
  7492'                  C      KM.EINAA:
  7492'   C9             C      	RET
                         C      
  7493'                  C      KM.EINAB:
  7493'   CD 7558'       C      	CALL	KM.UP2
  7496'   08             C      	DB	8
  7497'   21 0000        C      	LD	HL,0
  749A'   22 0DAA        C      	LD	(SM.TABU),HL	;00DA8H
  749D'   C9             C      	RET
                         C      
  749E'                  C      KM.EINAC:
  749E'   DD 36 0D 00    C      	LD	(IX+13),0
  74A2'   DD 36 0E 00    C      	LD	(IX+14),0
'Kmbg'	MACRO-80 3.44	09-Dec-81	PAGE	1-86


  74A6'                  C      KM.EINAD:
  74A6'   CD 7555'       C      	CALL	KM.UP1
  74A9'   02             C      	DB	2
  74AA'   DD 7E 09       C      	LD	A,(IX+9)
  74AD'   DD B6 0A       C      	OR	(IX+10)
  74B0'   28 08          C      	JR	Z,KM.EINAE
  74B2'   DD 34 0D       C      	INC	(IX+13)
  74B5'   CD 74BA'       C      	CALL	KM.EINAE
  74B8'   18 EC          C      	JR	KM.EINAD
                         C      
  74BA'                  C      KM.EINAE:
  74BA'   CD 75F2'       C      	CALL	KM.UP4-KM.UP13+KM.RAM
  74BD'   11 35E0        C      	LD	DE,SD.BWSA + 18*80 + 64	;5E0H
  74C0'   CD 758D'       C      	CALL	KM.UP10
  74C3'   62 7A 3A       C      	DB	'bz:'
  74C6'   0D             C      	DB	00DH
  74C7'   A0             C      	DB	20H+80H
  74C8'   C9             C      	RET
                         C      
  74C9'                  C      KM.UP20:
  74C9'   DD 4E 02       C      	LD	C,(IX+2)
  74CC'   0C             C      	INC	C	;???
  74CD'   0C             C      	INC	C
  74CE'   0C             C      	INC	C
  74CF'   0C             C      	INC	C
  74D0'   ED 40          C      	IN	B,(C)
  74D2'   FE 01          C      	CP	1
  74D4'   20 04          C      	JR	NZ,KM.UP21
  74D6'   CB 48          C      	BIT	1,B
  74D8'   20 29          C      	JR	NZ,KM.UP25
  74DA'                  C      KM.UP21:
  74DA'   CB D8          C      	SET	3,B
  74DC'   18 06          C      	JR	KM.UP22
  74DE'   CB 40          C      	BIT	0,B
  74E0'   20 21          C      	JR	NZ,KM.UP25
  74E2'   CB D0          C      	SET	2,B
  74E4'                  C      KM.UP22:
  74E4'   ED 41          C      	OUT	(C),B
  74E6'   0C             C      	INC	C
  74E7'   ED 50          C      	IN	D,(C)
  74E9'   0D             C      	DEC	C
  74EA'   CB 90          C      	RES	2,B
  74EC'   CB 98          C      	RES	3,B
  74EE'   ED 41          C      	OUT	(C),B
  74F0'   FE 01          C      	CP	1
  74F2'   20 04          C      	JR	NZ,KM.UP23
  74F4'   CB 62          C      	BIT	4,D
  74F6'   18 02          C      	JR	KM.UP24
                         C      
  74F8'                  C      KM.UP23:
  74F8'   CB 5A          C      	BIT	3,D
  74FA'                  C      KM.UP24:
  74FA'   28 07          C      	JR	Z,KM.UP25
  74FC'   DD 36 00 00    C      	LD	(IX+0),0
  7500'   C3 73A7'       C      	JP	KM.CO
                         C      
  7503'                  C      KM.UP25:
  7503'   DD CB 00 FE    C      	SET	7,(IX+0)
  7507'   C9             C      	RET
                         C      
                         C      	PAGE
'Kmbg'	MACRO-80 3.44	09-Dec-81	PAGE	1-87


                         C      
  7508'                  C      KM.ABS:
  7508'   21 3000        C      	LD	HL,SD.BWSA
  750B'   06 11          C      	LD	B,17
  750D'                  C      KM.ABS1:
  750D'   C5             C      	PUSH	BC
  750E'   CD 7517'       C      	CALL	KM.UP30
  7511'   C1             C      	POP	BC
  7512'   10 F9          C      	DJNZ	KM.ABS1
  7514'   C3 752A'       C      	JP	KM.UP36
                         C      
  7517'                  C      KM.UP30:
  7517'   CD 7536'       C      	CALL	KM.UP34
  751A'   A0             C      	DB	0A0H
  751B'   28 15          C      	JR	Z,KM.UP33
  751D'   CD 7536'       C      	CALL	KM.UP34
  7520'   50             C      	DB	050H
  7521'   28 0C          C      	JR	Z,KM.UP32
  7523'                  C      KM.UP31:
  7523'   7E             C      	LD	A,(HL)
  7524'   23             C      	INC	HL
  7525'   CD 4040        C      	CALL	PRINT
  7528'   10 F9          C      	DJNZ	KM.UP31
  752A'                  C      KM.UP36:
  752A'   3E 1E          C      	LD	A,1EH
  752C'   C3 4040        C      	JP	PRINT
                         C      
  752F'                  C      KM.UP32:
  752F'   CD 752A'       C      	CALL	KM.UP36
  7532'                  C      KM.UP33:
  7532'   23             C      	INC	HL
  7533'   10 FD          C      	DJNZ	KM.UP33
  7535'   C9             C      	RET
                         C      
  7536'                  C      KM.UP34:
  7536'   E3             C      	EX	(SP),HL
  7537'   46             C      	LD	B,(HL)
  7538'   23             C      	INC	HL
  7539'   E3             C      	EX	(SP),HL
  753A'   E5             C      	PUSH	HL
  753B'   CD 7542'       C      	CALL	KM.UP35
  753E'   E1             C      	POP	HL
  753F'   06 50          C      	LD	B,80
  7541'   C9             C      	RET
                         C      
  7542'                  C      KM.UP35:
  7542'   3E 20          C      	LD	A,' '
  7544'   BE             C      	CP	(HL)
  7545'   23             C      	INC	HL
  7546'   C0             C      	RET	NZ
  7547'   10 F9          C      	DJNZ	KM.UP35
  7549'   C9             C      	RET
                         C      
  754A'                  C      KM.DEL:
  754A'   DD CB 00 BE    C      	RES	7,(IX+0)
  754E'   DD 36 01 00    C      	LD	(IX+1),0
  7552'   C3 75F2'       C      	JP	KM.UP4-KM.UP13+KM.RAM
                         C      
                         C      	PAGE
'Kmbg'	MACRO-80 3.44	09-Dec-81	PAGE	1-88


                         C      
                         C      ;****************************************************************
                         C      ;*                  Unterprogramme                              *
                         C      ;****************************************************************
  7555'                  C      KM.UP1:
  7555'   CD 7575'       C      	CALL	KM.LOE1
  7558'                  C      KM.UP2:
  7558'   DD CB 00 7E    C      	BIT	7,(IX)
  755C'   28 02          C      	JR	Z,KM.UP3
  755E'   E1             C      	POP	HL
  755F'   C0             C      	RET	NZ
  7560'                  C      KM.UP3:
  7560'   E3             C      	EX	(SP),HL
  7561'   F5             C      	PUSH	AF
  7562'   7E             C      	LD	A,(HL)
  7563'   23             C      	INC	HL
  7564'   DD 77 04       C      	LD	(IX+4),A
  7567'   F1             C      	POP	AF
  7568'   E3             C      	EX	(SP),HL
  7569'                  C      KM.UP5:
  7569'   CD 5C92'       C      	CALL	KM.KARO
  756C'   21 6807'       C      	LD	HL,FD.DASU	;05C01H
  756F'   22 0D6E        C      	LD	(SM.FKTAB+8EH),HL	;SM.ZSMER , SM.ZSTC
  7572'   C3 75F2'       C      	JP	KM.UP4-KM.UP13+KM.RAM
                         C      
  7575'                  C      KM.LOE1:
  7575'   21 0E65        C      	LD	HL,KM.PUFF-1
  7578'   36 00          C      	LD	(HL),0
  757A'   01 0103        C      	LD	BC,103H
  757D'   18 08          C      	JR	KM.LOE3
  757F'                  C      KM.LOE2:
  757F'   21 3000        C      	LD	HL,SD.BWSA
  7582'   01 077F        C      	LD	BC,24*80 -1 ;007FFH  (25*80-1 = 07CFH; 07FFH-07CFH=30H=48)
  7585'   36 20          C      	LD	(HL),' '
  7587'                  C      KM.LOE3:
  7587'   E5             C      	PUSH	HL
  7588'   D1             C      	POP	DE
  7589'   13             C      	INC	DE
  758A'   ED B0          C      	LDIR
  758C'   C9             C      	RET
                         C      
  758D'                  C      KM.UP10:
  758D'   E3             C      	EX	(SP),HL
  758E'                  C      KM.UP11:
  758E'   7E             C      	LD	A,(HL)
  758F'   E6 7F          C      	AND	07FH
  7591'   FE 20          C      	CP	' '
  7593'   38 02          C      	JR	C,KM.UP12
  7595'   12             C      	LD	(DE),A
  7596'   13             C      	INC	DE
  7597'                  C      KM.UP12:
  7597'   DC 75D6'       C      	CALL	C,KM.UP13-KM.UP13+KM.RAM
  759A'   CB 7E          C      	BIT	7,(HL)
  759C'   23             C      	INC	HL
  759D'   28 EF          C      	JR	Z,KM.UP11
  759F'   E3             C      	EX	(SP),HL
  75A0'   C9             C      	RET
                         C      
  75A1'                  C      KM.UP41:
  75A1'   11 3000        C      	LD	DE,SD.BWSA
  75A4'   DD 7E 0A       C      	LD	A,(IX+10)
  75A7'   B7             C      	OR	A
  75A8'   20 0C          C      	JR	NZ,KM.UP42
  75AA'   DD CB 09 46    C      	BIT	0,(IX+9)
  75AE'   C8             C      	RET	Z
  75AF'   F5             C      	PUSH	AF
  75B0'   CD 201D        C      	CALL	KM.MANZ
  75B3'   F1             C      	POP	AF
  75B4'   D6 10          C      	SUB	10H
  75B6'                  C      KM.UP42:
  75B6'   F5             C      	PUSH	AF
  75B7'   CD 201D        C      	CALL	KM.MANZ
  75BA'   F1             C      	POP	AF
  75BB'   D6 10          C      	SUB	10H
  75BD'   C8             C      	RET	Z
  75BE'   D8             C      	RET	C
  75BF'   18 F5          C      	JR	KM.UP42
                         C      
  75C1'                  C      KM.UP43:
  75C1'   FE 1E          C      	CP	01EH
  75C3'   C8             C      	RET	Z
  75C4'   FE 0A          C      	CP	00AH
'Kmbg'	MACRO-80 3.44	09-Dec-81	PAGE	1-89


  75C6'   C8             C      	RET	Z
  75C7'   FE 0D          C      	CP	00DH
  75C9'   C8             C      	RET	Z
  75CA'   B7             C      	OR	A
  75CB'   C8             C      	RET	Z
  75CC'   FE 20          C      	CP	' '
  75CE'   38 03          C      	JR	C,KM.UP44
  75D0'   FE 80          C      	CP	080H
  75D2'   D8             C      	RET	C
  75D3'                  C      KM.UP44:
  75D3'   3E 7F          C      	LD	A,07FH
  75D5'   C9             C      	RET
                         C      
                         C      	PAGE
'Kmbg'	MACRO-80 3.44	09-Dec-81	PAGE	1-90


                         C      
                         C      ;	ORG	00300H
                         C      
  75D6'                  C      KM.UP13:
  75D6'   32 75DB'       C      	LD	(KM.UP15-KM.UP13+KM.RAM-1),A	;???
  75D9'   DD 7E 01       C      	LD	A,(IX+1)	;<<<
  75DC'                  C      KM.UP15:
  75DC'   EB             C      	EX	DE,HL
  75DD'   77             C      	LD	(HL),A
  75DE'   3E 33          C      	LD	A,33H
  75E0'   ED 67          C      	RRD
  75E2'   EB             C      	EX	DE,HL
  75E3'   F5             C      	PUSH	AF
  75E4'   1A             C      	LD	A,(DE)
  75E5'   CD 75E9'       C      	CALL	KM.UP14-KM.UP13+KM.RAM
  75E8'   F1             C      	POP	AF
  75E9'                  C      KM.UP14:
  75E9'   FE 3A          C      	CP	03AH
  75EB'   38 02          C      	JR	C,$+4	;---!
  75ED'   C6 07          C      	ADD	A,7	;   !
  75EF'   12             C      	LD	(DE),A	;<--!
  75F0'   13             C      	INC	DE
  75F1'   C9             C      	RET
                         C      
  75F2'                  C      KM.UP4:
  75F2'   F5             C      	PUSH	AF
  75F3'   CD 757F'       C      	CALL	KM.LOE2
  75F6'   DD 7E 03       C      	LD	A,(IX+3)
  75F9'   C6 30          C      	ADD	A,30H
  75FB'   32 7608'       C      	LD	(KM.TX1-KM.UP13+KM.RAM),A
  75FE'   11 35A0        C      	LD	DE,SD.BWSA + 18*80 ;5A0H
  7601'   CD 758D'       C      	CALL	KM.UP10
  7604'                  C      KM.TX2:
  7604'   67 20          C      	DB	'g '
  7606'   04             C      	DB	004H
  7607'   28             C      	DB	'('	;<<<
  7608'                  C      KM.TX1:
  7608'   32 29          C      	DB	'2)'	;<<<
  760A'   BA             C      	DB	3AH+80H	;":"
  760B'   11 35AE        C      	LD	DE,SD.BWSA + 18*80 + 14 ;5AEH	;18*80 +20	;5B4H
  760E'   CD 758D'       C      	CALL	KM.UP10
  7611'   6C 3A          C      	DB	'l:'
  7613'   09             C      	DB	9
  7614'   0A             C      	DB	10
  7615'   20 73 3A       C      	DB	' s:'
  7618'   00             C      	DB	0
  7619'   2F             C      	DB	'/'
  761A'   01             C      	DB	1
  761B'   20 20 20 20    C      	DB	'      '
  761F'   20 20          C      
  7621'   AD             C      	DB	2DH+80H	;"-"
  7622'   1B             C      	DEC	DE
  7623'   1B             C      	DEC	DE
  7624'   1B             C      	DEC	DE
  7625'   21 0E65        C      	LD	HL,KM.PUFF-1
  7628'   7E             C      	LD	A,(HL)
  7629'   23             C      	INC	HL
  762A'   CD 75DC'       C      	CALL	KM.UP15-KM.UP13+KM.RAM
  762D'   13             C      	INC	DE
  762E'   DD 46 0A       C      	LD	B,(IX+10)
  7631'   E5             C      	PUSH	HL
  7632'   23             C      	INC	HL
  7633'   10 FD          C      	DJNZ	$-1
  7635'   7E             C      	LD	A,(HL)
  7636'   CD 75DC'       C      	CALL	KM.UP15-KM.UP13+KM.RAM
  7639'   23             C      	INC	HL
  763A'   7E             C      	LD	A,(HL)
  763B'   CD 75DC'       C      	CALL	KM.UP15-KM.UP13+KM.RAM
  763E'   E1             C      	POP	HL
  763F'   E5             C      	PUSH	HL
  7640'   11 3640        C      	LD	DE,SD.BWSA + 20*80	;640H
  7643'   06 00          C      	LD	B,0
  7645'   7E             C      	LD	A,(HL)
  7646'   CD 75C1'       C      	CALL	KM.UP43
  7649'   12             C      	LD	(DE),A
  764A'   23             C      	INC	HL
  764B'   13             C      	INC	DE
  764C'   10 F7          C      	DJNZ	$-7
  764E'   E1             C      	POP	HL
  764F'                  C      KM.UP40:
  764F'   CD 75A1'       C      	CALL	KM.UP41
  7652'   F1             C      	POP	AF
'Kmbg'	MACRO-80 3.44	09-Dec-81	PAGE	1-91


  7653'   C9             C      	RET
                         C      
  7654'                  C      KM.UPEND	EQU	$
                         C      
                         C      ;SM.FKTAB	EQU	00D00H
  0DA8                   C      KM.TTABU  EQU	00DA8H
  0DAE                   C      KM.TNEWL  EQU	00DAEH
  0DB0                   C      KM.TEINA  EQU	00DB0H
  0E66                   C      KM.PUFF   EQU	00E66H
                         C      
  201D                   C      KM.MANZ   EQU	0201DH
  2060                   C      KM.MHOME  EQU	02060H
  23BA                   C      KM.MINSL  EQU	023BAH
                         C      ;ATACO    EQU	024F8H
                         C      
  2B03'                  C      KM.KMTAB  EQU	UB.KTAB
                         C      ;         DEFS  17,0
                         C      ;SD.BWSA  EQU	03000H
                         C      
  5C92'                  C      KM.KARO   EQU	KR.KARO   ;05A93H
                         C      
                         C      ;DRUZ     EQU	07C00H
                         C      
  75D6'                  C      KM.RAM    EQU	KM.UP13   ;0FF80H
                         C      
                         C      			;(C) Rainer Sieber     A d W
                         C      
                         C      
                         C      ;	END
                                ;
                                	TITLE 'Symbolliste S1b'
                                	END
'Symbolliste S1b'	MACRO-80 3.44	09-Dec-81	PAGE	S


Macros:

Symbols:
0030 	AKB             225C 	ATACO           0001 	BC.AGG          
0000 	BC.EGG          FA3A 	BC.END          E000 	BC.TAB1         
F902 	BC.TAB2         F96A 	BC.TAB2A        F9D2 	BC.TAB3         
E002 	BC.VTABA        EC82 	BC.VTABE        58B2'	CP.COMPR        
5915'	CP.INIT         58E5'	CP.KOM          58B7'	CP.NL           
58E5'	CP.OUT          58C5'	CP.OUTT         58EC'	CP.SOKOM        
5902'	CP.SOSTR        58CA'	CP.SPACE        58C1'	CP.STRNG        
5907'	CP.TAB          58D5'	CP.TEXT         5BB4'	CRC0            
5BB8'	CRC1            5BCB'	CRC2            591B'	DC.DCMPR        
5951'	DC.EOSPC        5956'	DC.INIT         591D'	DC.NL           
5941'	DC.SPACE        5937'	DC.TAB          5929'	DC.TEXT         
6ADD'	FD.BMGF         6807'	FD.DASU         6941'	FD.DECBZ        
69F8'	FD.DECHL        6AB8'	FD.DSPBB        6AC8'	FD.DSPBG        
6A6D'	FD.END          6A96'	FD.FDIN2        6854'	FD.FDINP        
68A7'	FD.FDOUT        690B'	FD.FDOW1        690F'	FD.FDOW2        
6934'	FD.FDOW3        6926'	FD.FDOW4        68FB'	FD.FDOWR        
694B'	FD.FDUP         6A74'	FD.FOLWR        6A01'	FD.FOUT1        
698D'	FD.FSTRT        6800'	FD.KO01         67E8'	FD.POSK         
6AD2'	FD.RDEND        689B'	FD.SDIN         697D'	FD.SDK0         
6987'	FD.SDK1         6973'	FD.SDK2         68F5'	FD.SDOUT        
6963'	FD.SDOW         69DA'	FD.SETJ         69F2'	FD.SETN         
69C5'	FD.STRT1        6823'	FD.WRRES        2B01'	K0.HSB          
2B02'	K0.LPD          5AB0'	K1.BRKMB        5BB1'	K1.CRC          
5AF1'	K1.KERN         6734'	KH.ANZB1        673F'	KH.ANZB2        
6747'	KH.ANZB3        6749'	KH.ANZB4        6731'	KH.ANZBL        
6769'	KH.AZ1Z         679A'	KH.AZ4B0        67BB'	KH.AZ4B1        
67AA'	KH.AZ4B3        6796'	KH.AZ4BY        678D'	KH.AZADR        
6750'	KH.AZBL1        674D'	KH.AZBLD        67DA'	KH.BILO         
67D4'	KH.BLEV1        67D6'	KH.BLEV2        67BF'	KH.BLEVG        
66E3'	KH.BMM          66DB'	KH.BMP          66B5'	KH.KSRA         
666F'	KH.KSRE         66C1'	KH.KSRM         66C4'	KH.KSRP         
6672'	KH.KSRW         6672'	KH.RD1          6760'	KH.RD2          
667C'	KH.RD3          66FE'	KH.RDBA         670F'	KH.RDBM         
6720'	KH.RDSL         6664'	KH.RDSTA        666F'	KH.RES          
66F8'	KH.SYSRT        66F4'	KH.WBM          66E8'	KH.WREC         
66F6'	KH.WSL          6304'	KI.KM           62C5'	KI.KN           
636B'	KI.KO03         62E8'	KI.NMR          6376'	KI.RENA         
6393'	KI.RENA9        634D'	KI.VERZ         7508'	KM.ABS          
750D'	KM.ABS1         7355'	KM.ANF          73C5'	KM.CL           
73D4'	KM.CNZA         73E8'	KM.CNZA1        73A7'	KM.CO           
73CF'	KM.CR           73B8'	KM.CU           754A'	KM.DEL          
7429'	KM.EINA         7434'	KM.EINA1        743B'	KM.EINA2        
7442'	KM.EINA3        7449'	KM.EINA4        7454'	KM.EINA5        
7457'	KM.EINA6        745A'	KM.EINA7        7471'	KM.EINA8        
747E'	KM.EINA9        7492'	KM.EINAA        7493'	KM.EINAB        
749E'	KM.EINAC        74A6'	KM.EINAD        74BA'	KM.EINAE        
73B3'	KM.HOME         5C92'	KM.KARO         2B03'	KM.KMTAB        
7575'	KM.LOE1         757F'	KM.LOE2         7587'	KM.LOE3         
201D 	KM.MANZ         2060 	KM.MHOME        23BA 	KM.MINSL        
7404'	KM.NEWL         0E66 	KM.PUFF         75D6'	KM.RAM          
73BD'	KM.SL           73CA'	KM.SR           0DB0 	KM.TEINA        
0DAE 	KM.TNEWL        0DA8 	KM.TTABU        7608'	KM.TX1          
7604'	KM.TX2          7555'	KM.UP1          758D'	KM.UP10         
758E'	KM.UP11         7597'	KM.UP12         75D6'	KM.UP13         
75E9'	KM.UP14         75DC'	KM.UP15         7558'	KM.UP2          
74C9'	KM.UP20         74DA'	KM.UP21         74E4'	KM.UP22         
74F8'	KM.UP23         74FA'	KM.UP24         7503'	KM.UP25         
7560'	KM.UP3          7517'	KM.UP30         7523'	KM.UP31         
752F'	KM.UP32         7532'	KM.UP33         7536'	KM.UP34         
7542'	KM.UP35         752A'	KM.UP36         75F2'	KM.UP4          
764F'	KM.UP40         75A1'	KM.UP41         75B6'	KM.UP42         
75C1'	KM.UP43         75D3'	KM.UP44         7569'	KM.UP5          
7654'	KM.UPEND        5DDE'	KO.KO04         5BA7'	KOMED           
5C8E'	KR.CKRA         5BDD'	KR.GR1          5BE7'	KR.GR2          
5BE9'	KR.GR3          5C92'	KR.KARO         5D0B'	KR.KCL          
5D1A'	KR.TYPT         5C96'	KR.VORSP        5CDE'	KR.YKA1         
5CF3'	KR.YKA2         732A'	KU.DD           7327'	KU.DECIY        
72C2'	KU.TAB2L        72B9'	KU.VVOR         72FA'	KU.ZEIR         
640C'	KV.ANF          662F'	KV.ANZ          64DC'	KV.AUSG         
6645'	KV.AVZS         65B7'	KV.BSTR         661A'	KV.DBCVM        
659F'	KV.DRU          659D'	KV.DRU1         65AC'	KV.KO02         
6551'	KV.KRW          6585'	KV.P1           6625'	KV.SBC          
65E4'	KV.SPTR         6475'	KV.TABTR        64BB'	KV.ZEIHO        
6440'	KV.ZLTR         6FD9'	KX.ENDR         6FF8'	KX.EXEC2        
6FCE'	KX.RSPFR        7028'	KX.UPA          72B2'	KY.AJ           
70D4'	KY.ATAA         70F7'	KY.ATAB         7108'	KY.ATABE        
7199'	KY.COPY         7063'	KY.DFR          7246'	KY.EOV          
7155'	KY.EVZ          7158'	KY.EVZ1         7285'	KY.EWK          
70D1'	KY.EZYK1        7295'	KY.JHL          71F9'	KY.KOP          
'Symbolliste S1b'	MACRO-80 3.44	09-Dec-81	PAGE	S-1


7213'	KY.KOPAN        71F3'	KY.KOPV         7045'	KY.MD           
70CB'	KY.NDA          713C'	KY.NE           729E'	KY.SATR         
70BD'	KY.SVGL         71BD'	KY.VSCHR        7170'	KY.VSTR         
70B2'	KY.VZVGL        7116'	KY.WEI          712A'	KY.ZYK          
6B25'	LD.DATFU        6B00'	LD.DATN         6B46'	LD.DATPO        
6BC1'	LD.LAD1         6BB0'	LD.LAD2         6BAD'	LD.LADER        
6BD6'	LD.LADF         6B15'	LD.LD2          6B1F'	LD.LD21         
6BA8'	LD.LD3          6B66'	LD.LD4          6B81'	LD.LD5          
6BCD'	LD.LDEND        6B9E'	LD.START        0080 	MAXBL           
60E0'	POSIK1          4040 	PRINT           4070 	PUF.KASS        
6BDC'	RL.BEG          6CE8'	RL.BF           6CD4'	RL.DATNV        
6CCF'	RL.ECHO         6CEA'	RL.FMELD        6C6D'	RL.M10          
6C7E'	RL.M11          6C0D'	RL.M12          6C4B'	RL.M13          
6C5B'	RL.M14          6C63'	RL.M15          6BFC'	RL.M16          
6C2A'	RL.M17          6C91'	RL.M21          6CE4'	RL.MN           
6CD8'	RL.OB           6CDC'	RL.RA           6CE0'	RL.SV           
6BF1'	RL.UG           6C84'	RL.UP6          5B9F'	RLAD            
5B9A'	RRET            3000 	SD.BWSA         001C 	SM.FABS         
000C 	SM.FDEL         0003 	SM.FDOWN        0CE0 	SM.FKTAB        
0005 	SM.FLEFT        0008 	SM.FLTAB        0002 	SM.FNL          
0006 	SM.FPOS1        0007 	SM.FRIGHT       000A 	SM.FRTAB        
0009 	SM.FUP          0DAA 	SM.TABU         5B96'	STF07           
5B8C'	STF99           5B93'	STFRS           5B4A'	STT02           
5B68'	STT08           5B22'	STT11           5B22'	STT15           
5B22'	STT21           5B22'	STT31           5B22'	STT41           
5B3B'	STT5            5B2E'	STT51           5B32'	STT61           
5B36'	STT71           5B36'	STT75           6DF8'	SV.BYANZ        
6E89'	SV.DALO1        6D26'	SV.DATN         6E03'	SV.DATS1        
6D3D'	SV.DATV1        6D45'	SV.DATVO        6E1D'	SV.SAVE         
6E2E'	SV.SAVE1        6D7F'	SV.SAVE3        6D94'	SV.SAVE4        
6DDC'	SV.SAVE5        6DD2'	SV.SAVE6        6E81'	SV.STAD0        
6D19'	SV.SV20         6D31'	SV.SV21         6D4B'	SV.SV30         
6D65'	SV.SV31         6D53'	SV.SV37         6E71'	SV.SVEN1        
6E6E'	SV.SVEN2        6E45'	SV.SVLS         6E61'	SV.SVLS1        
6E4B'	SV.SVLS2        6E94'	SV.SVSZ         6EA8'	SV.SVSZ1        
6E96'	SV.SVSZ2        4036 	SY.RESC         4033 	SY.SETCHL       
000B 	SY.SYSTB        4026 	TA.ABFR1        5476'	U1.AUS          
55B1'	U1.BILO         542B'	U1.BREAD        5436'	U1.BWRIT        
5411'	U1.CLRB         5445'	U1.COPB         5441'	U1.COPB2        
5496'	U1.DSVG         546D'	U1.EIN          55AB'	U1.INFO         
5420'	U1.KBR4         55E6'	U1.KRWE         54FB'	U1.KTIN1        
54E2'	U1.KTINI        54C7'	U1.NMVGL        55CF'	U1.PRADR        
5408'	U1.RRST         5400'	U1.RSAVE        55A6'	U1.TR           
55C5'	U1.TST          5518'	U1.VERIN        5520'	U1.VERNI        
5542'	U1.VORS1        553A'	U1.VORST        547F'	U1.VS1          
5486'	U1.VSX          554E'	U1.VZS          542A'	U1.WAIT         
6075'	UA.ALTR         605C'	UA.ANZWD        5F2E'	UA.BMGF         
5F3F'	UA.DF           5F38'	UA.DOK          5DFF'	UA.DS           
5EBC'	UA.EABFR        5F28'	UA.FRZ          5E77'	UA.GER          
5E1F'	UA.KNAME        5E45'	UA.KOMMT        5E86'	UA.KOPFR        
6031'	UA.LD           5E32'	UA.NR           5F92'	UA.STADR        
5EF2'	UA.VORH         5E58'	UA.Z7E          6011'	UA.ZKBA         
5F6C'	UA.ZKBEG        5FEB'	UA.ZKBEL        5FFE'	UA.ZKBLG        
601B'	UA.ZKBM         5F46'	UA.ZKDAT        5FA5'	UA.ZKDL         
6031'	UA.ZKEE         5F7F'	UA.ZKEND        5FB8'	UA.ZKF          
5F59'	UA.ZKLAD        5FC3'	UA.ZKRES        5FD6'	UA.ZKSDT        
6024'	UA.ZKSL         6043'	UA.ZRSCH        2B6E'	UB.DTAB         
2B97'	UB.END          2B03'	UB.KTAB         2B1E'	UB.KTABE        
2B26'	UB.PAR1         2B28'	UB.PAR2         2B2A'	UB.PAR3         
2B2C'	UB.PAR4         2B2E'	UB.PAR5         2B30'	UB.PATAB        
2B34'	UB.SATZ         2B00'	UB.ZN           57F2'	UC.ASCCO        
57CF'	UC.CKONV        5699'	UC.CVABX        56B4'	UC.CVAX         
56C8'	UC.CVAXB        5792'	UC.CVBC         5722'	UC.CVBD         
572D'	UC.CVBD0        5720'	UC.CVBD1        571C'	UC.CVBD2        
5718'	UC.CVBD3        5714'	UC.CVBD4        5710'	UC.CVBD5        
56A3'	UC.CVBX         57A3'	UC.CVCB         578A'	UC.CVD1B        
5761'	UC.CVDB         56BF'	UC.CVHLX        56EA'	UC.CVX1B        
5705'	UC.CVXA         56D9'	UC.CVXB         56F3'	UC.CVXER        
568B'	UC.DIVR         57C4'	UC.DK1          57D8'	UC.DK2          
5852'	UC.DKOI         57B0'	UC.DKONV        5672'	UC.HL10C        
566B'	UC.HL10N        57BA'	UC.KONV         57EE'	UC.KONV2        
5AB0'	UE.BRKMB        3000 	UE.BWSA         0060 	UE.COTAL        
5BB1'	UE.CRC          0DC4 	UE.EDEND        0132 	UE.KMPUL        
8010 	UE.KPUFF        0E66 	UE.PUF          0CFE 	UE.STANF        
007D 	UE.SVL          000B 	UE.SYSTB        00F7 	UE.TACL         
00F9 	UE.TACR         001E 	UE.TAQUI        00CD 	UE.TASYS        
8830 	UE.TEXAN        0E5A 	UE.ZEIN         5DA1'	UF.AZVB         
5DD6'	UF.BEHB         5DDE'	UF.BEHB1        5D55'	UF.ERANZ        
5D25'	UF.EXEC         5D4C'	UF.EXEC1        5D49'	UF.EXEC2        
5DF3'	UF.FL14         5DF6'	UF.FL16         5DF0'	UF.FL17         
5DE4'	UF.FL18         5D20'	UF.RET          5D91'	UF.SYS          
5D9D'	UF.SYS1         613D'	UK.GETK         615E'	UK.GETK2        
6166'	UK.GETK3        616C'	UK.GETK4        6162'	UK.GETK5        
'Symbolliste S1b'	MACRO-80 3.44	09-Dec-81	PAGE	S-2


622A'	UK.KBA          619D'	UK.KBW          61DB'	UK.KBW1         
61D7'	UK.KBW2         617A'	UK.KLPFB        6205'	UK.KSPFB        
61E1'	UK.PUTK         5A64'	UR.ALPH1        5A5B'	UR.ALPHA        
5A6F'	UR.ALPNU        5996'	UR.BBSA1        598E'	UR.BBSAD        
5AA0'	UR.BILR1        5A8E'	UR.BILRO        610C'	UR.BM           
599E'	UR.DSPZK        5A79'	UR.HEXAZ        5A86'	UR.HEXZ1        
60B9'	UR.KBM          60CB'	UR.KBR          60C5'	UR.KBV          
60B3'	UR.KLR          60AD'	UR.KLV          60A7'	UR.KRA          
6095'	UR.KRE          6099'	UR.KRE1         609D'	UR.KRW          
60A3'	UR.KRWW         60BF'	UR.KSL          60E5'	UR.LES          
595C'	UR.MIMO         5978'	UR.MIMO1        5970'	UR.MIMO2        
597F'	UR.MIMO3        5A66'	UR.NUM          611A'	UR.OK           
60DA'	UR.POSIK        59EE'	UR.RET0         60D1'	UR.RPOS         
6139'	UR.RSP          5A88'	UR.TAREP        59F8'	UR.TCL          
5A0A'	UR.TCLN         5A0D'	UR.TCR          5A1E'	UR.TCRN         
5A28'	UR.TQUIT        5A20'	UR.TSYS         59AB'	UR.ZINP         
59B1'	UR.ZINP1        59B4'	UR.ZINP2        59E2'	UR.ZINP3        
59E8'	UR.ZINP4        59D0'	UR.ZINP5        59F1'	UR.ZINP7        
5A56'	UR.ZKON1        5A30'	UR.ZKONT        55ED'	XY.CALP1        
55F6'	XY.CALPE        5641'	XY.INCDX        565A'	XY.JMPDX        
5601'	XY.LDDX         5611'	XY.LIDX         5621'	XY.STDX         
5631'	XY.STIDX        



No Fatal error(s)


    5A0D'	UR.TCR          5A1E'	UR.TCRN         
5A28'	UR.TQUIT        5A20'	UR.TSYS