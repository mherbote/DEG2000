'EQUAL - Anweisungen fuer Assembler'	MACRO-80 3.44	09-Dec-81	PAGE	1


                                	TITLE 'EQUAL - Anweisungen fuer Assembler'
                                	PAGE	87
'EQUAL - Anweisungen fuer Assembler'	MACRO-80 3.44	09-Dec-81	PAGE	1-1


                                
  000B                          SY.SYSTB  EQU	0000BH
  0CE0                          SM.STACK  EQU	00CE0H
  0CE0                          SM.FKTAB  EQU	00CE0H
  0DAA                          SM.TABU   EQU	00DAAH
  0DC6                          SM.END    EQU	00DC6H  ;Position Textende
  0E5A                          SM.ZEIN   EQU	00E5AH  ;Zaehler Eingabe
  0E65                          SM.PUFFS  EQU	00E65H  ;Eingabepuffer
  8010                          SD.PFFI   EQU	08010H  ;Eingabepuffer
  8830                          SD.TPA    EQU	08830H  ;Anf.adr. Textpuffer
  225C                          ATACO     EQU	0225CH
  3000                          SD.BWSA   EQU	03000H
  4026                          TA.ABFR1  EQU	04026H
  4033                          SY.SETCHL EQU	04033H
  4036                          SY.RESC   EQU	04036H
  4040                          PRINT     EQU	04040H
  4070                          PUF.KASS  EQU	04070H
                                
                                	ORG	00000H
  0000*                         	DEFS	05400H,0
                         C      	INCLUDE K0.MAC	;EQUAL - Anweisungen fuer Assembler
                         C      ;         PN    UE01
                         C      ;****************************************************************
                         C      ;*                  EQUAL - Anweisungen fuer Assembler          *
                         C      ;****************************************************************
  0030                   C      AKB      EQU	030H    ;IO-Adresse der AKB
  0080                   C      MaxBL    EQU	080H    ;max. Blocklaenge
                         C      
  00F7                   C      UE.TACL  EQU	0F7H    ;Kursor nach links
  00F9                   C      UE.TACR  EQU	0F9H    ; ''    nach rechts
  00CD                   C      UE.TASYS EQU	0CDH    ;SYS-Taste
  001E                   C      UE.TAQUI EQU	01EH    ;ET1
  007D                   C      UE.SVL   EQU	07DH    ;Laenge der SAVE-Bloecke
  0060                   C      UE.COTAL EQU	060H    ;Laenge ASC/KOI Codetabelle
  0132                   C      UE.KMPUL EQU	132H    ;max. Laenge E/A-Puffer
                         C      
  000B                   C      UE.SYSTB EQU	SY.SYSTB
  0CE0                   C      UE.STANF EQU	SM.STACK
  0DC6                   C      UE.EDEND EQU	SM.END   ;Speicherpl. fuer Adr. Editorende
  0E5A                   C      UE.ZEIN  EQU	SM.ZEIN  ;Pufferzaehler Eingabe
  0E65                   C      UE.PUF   EQU	SM.PUFFS ;System-Puffer
  3000                   C      UE.BWSA  EQU	SD.BWSA  ;Bildwiederholspeicher
  8010                   C      UE.KPUFF EQU	SD.PFFI  ;E/A Puffer
  8830                   C      UE.TEXAN EQU	SD.TPA   ;Begin Editorraum
                         C      
  5AB0*                  C      UE.BRKMB EQU	K1.BRKMB ;04000H	;phys. Kass.Routine
  5BB4*                  C      UE.CRC   EQU	K1.CRC   ;04740H	;CRC-Berechnung
                         C      
                         C      ;         END
                         C      ;         PN    UB
                         C                ORG   2B00H
  2B00*                  C      UB.ZN:    DS	1,0
  2B01*                  C      K0.HSB:   DS	1,0   ;HS-Bereich
  2B02*                  C      K0.LPD:   DS	1,0   ;Laenge der Daten im Puffer
  2B03*                  C      UB.KTAB:  DS	27,0  ;Originale Tabelle nach Robotron
  2B1E*                  C      UB.KTABE: DS	8,0   ;Tabelle fuer Kassetten im DEG2000 Emulator
  2B26*   0000           C      UB.PAR1:  DW	0
  2B28*   0000           C      UB.PAR2:  DW	0
  2B2A*   0000           C      UB.PAR3:  DW	0
  2B2C*   0000           C      UB.PAR4:  DW	0
  2B2E*   0000           C      UB.PAR5:  DW	0
  2B30*                  C      UB.PATAB: DS	4,0
  2B34*   00             C      UB.SATZ:  DB	0
  2B35*   37             C                DB	55
  2B36*   80             C                DB	80H
  2B37*                  C                DS	55,' '
  2B6E*                  C      UB.DTAB:  DS	41,0
  2B97*                  C      UB.END    EQU	$
                         C      ;         END
                         C      ;         PN    BC
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;        BEREICHE FUER KASSETTENKOPIEREN
                         C      ;
                         C      ;----------------------------------------------------------------------
  0000                   C      BC.EGG     EQU	0	;EINGABEGERAET
  0001                   C      BC.AGG     EQU	1	;AUSGABEGERAET
                         C      
                         C      ;	ORG	0E000H
  E000                   C      BC.TAB1    EQU	0E000H               ;Subadresse fuer Input -Kassette
                         C      ;          EQU	0E001H               ;Subadresse fuer Output-Kassette
  E002                   C      BC.VTABA   EQU	BC.TAB1  +    2
'EQUAL - Anweisungen fuer Assembler'	MACRO-80 3.44	09-Dec-81	PAGE	1-2


  EC82                   C      BC.VTABE   EQU	BC.VTABA + 3200
  F902                   C      BC.TAB2    EQU	BC.VTABE + 3200
  F96A                   C      BC.TAB2A   EQU	BC.TAB2  +  104
  F9D2                   C      BC.TAB3    EQU	BC.TAB2A +  104
  FA3A                   C      BC.END     EQU	BC.TAB3  +  104
                         C      ;         END
                                ;
                                	ORG	05400H
                                ;
                                ;	INCLUDE	U1.MAC	;Allgemeine Unterprogramme
                                ;	INCLUDE	XY.MAC	;Handling f. IX/IY-adressierte Bereiche
                                ;	INCLUDE	UC.MAC	;Konvertierungen
                                ;	INCLUDE	CP.MAC	;Komprimierung
                                ;	INCLUDE	DC.MAC	;Dekomprimierung
                                ;	INCLUDE UR.MAC	;Routinen fuer Monitor UND Tastatur
                         C      	INCLUDE K1.MAC	;Allgemeine Unterprogramme
                         C      	TITLE	'Allgemeine Unterprogramme'
                         C      	PAGE
'Allgemeine Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-3


                         C      
                         C      ;	PN	U1
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;        Allgemeine Unterprogramme
                         C      ;
                         C      ;----------------------------------------------------------------------
  5400*                  C      U1.RSAVE:
  5400*   E3             C      	EX	(SP),HL      ;Register retten (nicht AF)
  5401*   D5             C      	PUSH	DE
  5402*   C5             C      	PUSH	BC
  5403*   FD E5          C      	PUSH	IY
  5405*   DD E5          C      	PUSH	IX
  5407*   E9             C      	JP	(HL)
  5408*                  C      U1.RRST:
  5408*   E1             C      	POP	HL           ;Register wieder herstellen
  5409*   DD E1          C      	POP	IX
  540B*   FD E1          C      	POP	IY
  540D*   C1             C      	POP	BC
  540E*   D1             C      	POP	DE
  540F*   E3             C      	EX	(SP),HL
  5410*   C9             C      	RET
  5411*                  C      U1.CLRB:
  5411*   E5             C      	PUSH	HL           ;Bereich loeschen
  5412*   D5             C      	PUSH	DE
  5413*   C5             C      	PUSH	BC
  5414*   E5             C      	PUSH	HL          ;IN:  HL= Bereichsanfang
  5415*   D1             C      	POP	DE          ;     BC= Bereichslaenge
  5416*   13             C      	INC	DE
  5417*   AF             C      	XOR	A
  5418*   77             C      	LD	(HL),A
  5419*   0B             C      	DEC	BC
  541A*   ED B0          C      	LDIR
  541C*   C1             C      	POP	BC
  541D*   D1             C      	POP	DE
  541E*   E1             C      	POP	HL
  541F*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  5420*                  C      U1.KBR4:
  5420*   C5             C      	PUSH	BC
  5421*   06 04          C      	LD	B,4
  5423*   CD 60D5*       C      	CALL	UR.KBR
  5426*   10 FB          C      	DJNZ	$-3
  5428*   C1             C      	POP	BC
  5429*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  542A*                  C      U1.WAIT:
                         C      	; PUSH	AF
                         C      	; CALL	UE.BERT
                         C      	; JR	C,$-3
                         C      	; POP	AF
  542A*   C9             C      	RET
                         C      ;--------------------------------------------------------------------
  542B*                  C      U1.BREAD:
  542B*   CD 546D*       C      	CALL	U1.EIN       ;BLOCK LESEN VON EINGABE
  542E*   DD 36 04 02    C      	LD	(IX+4),02H
  5432*   CD 5D2F*       C      	CALL	UF.EXEC
  5435*   C9             C      	RET
  5436*                  C      U1.BWRIT:
  5436*   CD 5476*       C      	CALL	U1.AUS       ;BLOCK SCHREIBEN AUF AUSGABE
  5439*   DD 36 04 08    C      	LD	(IX+4),08H
  543D*   CD 5D2F*       C      	CALL	UF.EXEC
  5440*   C9             C      	RET
  5441*                  C      U1.COPB2:
  5441*   F5             C      	PUSH	AF
  5442*   37             C      	SCF
  5443*   18 02          C      	JR	$+4
  5445*                  C      U1.COPB:
  5445*   F5             C      	PUSH	AF
  5446*   B7             C      	OR	A
  5447*   CD 546D*       C      	CALL	U1.EIN
  544A*   DD 36 04 02    C      	LD	(IX+4),02H
  544E*   DC 7009*       C      	CALL	C,KX.EXEC2
  5451*   D4 5D2F*       C      	CALL	NC,UF.EXEC
  5454*   F5             C      	PUSH	AF
  5455*   CD 5476*       C      	CALL	U1.AUS
                         C      	;LD	A,(IX+9)
                         C      	;OR	(IX+10)
  5458*   DD 7E 0A       C      	LD	A,(IX+10)    ;Laenge = 1, dann BM
  545B*   FE 01          C      	CP	1
  545D*   28 08          C      	JR	Z,$+10
  545F*   CD 5436*       C      	CALL	U1.BWRIT
'Allgemeine Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-4


  5462*   F1             C      	POP	AF
  5463*   38 DC          C      	JR	C,$-34
  5465*   30 DE          C      	JR	NC,$-32
  5467*   CD 60C3*       C      	CALL	UR.KBM
  546A*   F1             C      	POP	AF
  546B*   F1             C      	POP	AF
  546C*   C9             C      	RET
  546D*                  C      U1.EIN:
  546D*   F5             C      	PUSH	AF
  546E*   3A E000        C      	LD	A,(BC.TAB1)
  5471*   DD 77 03       C      	LD	(IX+3),A
  5474*   F1             C      	POP	AF
  5475*   C9             C      	RET
  5476*                  C      U1.AUS:
  5476*   F5             C      	PUSH	AF
  5477*   3A E001        C      	LD	A,(BC.TAB1+1)
  547A*   DD 77 03       C      	LD	(IX+3),A
  547D*   F1             C      	POP	AF
  547E*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  547F*                  C      U1.VS1:
  547F*   E5             C      	PUSH	HL
  5480*   C5             C      	PUSH	BC
  5481*   F5             C      	PUSH	AF
  5482*   3E 01          C      	LD	A,01H        ;1.DATEIVORSATZ IM PUFFER
  5484*   18 04          C      	JR	$+6
  5486*                  C      U1.VSX:
  5486*   E5             C      	PUSH	HL
  5487*   C5             C      	PUSH	BC
  5488*   F5             C      	PUSH	AF
  5489*   AF             C      	XOR	A            ;00-DATEIVORSATZ IM PUFFER
  548A*   06 20          C      	LD	B,32
  548C*   21 0E65        C      	LD	HL,UE.PUF
  548F*   CD 55A6*       C      	CALL	U1.TR
  5492*   F1             C      	POP	AF
  5493*   C1             C      	POP	BC
  5494*   E1             C      	POP	HL
  5495*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  5496*                  C      U1.DSVG:
  5496*   E5             C      	PUSH	HL
  5497*   D5             C      	PUSH	DE
  5498*   F5             C      	PUSH	AF
  5499*   06 07          C      	LD	B,7          ;MRES KASSETTE ?
  549B*   CD 5542*       C      	CALL	U1.VORS1
  549E*   11 0E6B        C      	LD	DE,UE.PUF+6
  54A1*   21 5E0F*       C      	LD	HL,UA.DS+6
  54A4*   06 0E          C      	LD	B,14
  54A6*   1A             C      	LD	A,(DE)
  54A7*   BE             C      	CP	(HL)
  54A8*   20 10          C      	JR	NZ,$+18
  54AA*   13             C      	INC	DE
  54AB*   23             C      	INC	HL
  54AC*   10 F8          C      	DJNZ	$-6
  54AE*   3A 0E66        C      	LD	A,(UE.PUF+1)
  54B1*   4F             C      	LD	C,A          ;C <-- NEXT RECORD
  54B2*   3A 0E68        C      	LD	A,(UE.PUF+3)
  54B5*   47             C      	LD	B,A          ;B <-- ANZ.VERZ.EINTRAG.
  54B6*   F1             C      	POP	AF
  54B7*   D1             C      	POP	DE
  54B8*   E1             C      	POP	HL
  54B9*   C9             C      	RET
                         C      
  54BA*   F1             C      	POP	AF
  54BB*   D1             C      	POP	DE
  54BC*   E1             C      	POP	HL
  54BD*   FD E1          C      	POP	IY
  54BF*   3E 90          C      	LD	A,90H
  54C1*   CD 5D5F*       C      	CALL	UF.ERANZ
  54C4*   C3 000B        C      	JP	UE.SYSTB
                         C      ;----------------------------------------------------------------------
  54C7*                  C      U1.NMVGL:
  54C7*   C5             C      	PUSH	BC
  54C8*   D5             C      	PUSH	DE
  54C9*   E5             C      	PUSH	HL
  54CA*   06 06          C      	LD	B,6
  54CC*   11 0E65        C      	LD	DE,UE.PUF
  54CF*   1A             C      	LD	A,(DE)
  54D0*   BE             C      	CP	(HL)         ;HL:ZU SUCHENDER PROGR.NAME
  54D1*   20 0C          C      	JR	NZ,$+14
  54D3*   23             C      	INC	HL
  54D4*   13             C      	INC	DE
  54D5*   10 F8          C      	DJNZ	$-6
'Allgemeine Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-5


  54D7*   3A 0E7C        C      	LD	A,(UE.PUF+23);LABELNR. -->A
  54DA*   37             C      	SCF	             ;CY=1,WENN PROGR. GEFUNDEN
  54DB*   E1             C      	POP	HL
  54DC*   D1             C      	POP	DE
  54DD*   C1             C      	POP	BC
  54DE*   C9             C      	RET
                         C      
  54DF*   B7             C      	OR	A
  54E0*   18 F9          C      	JR	$-5
                         C      ;----------------------------------------------------------------------
  54E2*                  C      U1.KTINI:
  54E2*   E5             C      	PUSH	HL
  54E3*   C5             C      	PUSH	BC
  54E4*   F5             C      	PUSH	AF
  54E5*   CD 55B1*       C      	CALL	U1.BILO      ;UNTERE HAELFTE BS LOESCHEN
  54E8*   DD 21 2B03*    C      	LD	IX,UB.KTAB   ;ADR. STEUERTAB. F.KASS.ROUTINE
  54EC*   DD E5          C      	PUSH	IX
  54EE*   E1             C      	POP	HL
  54EF*   AF             C      	XOR	A
  54F0*   06 1B          C      	LD	B,27
  54F2*   CD 55A6*       C      	CALL	U1.TR        ;TAB. AUF 00 LOESCHEN
  54F5*   DD 36 02 30    C      	LD	(IX+2),AKB
                         C      ;	CALL	UE.KINI
  54F9*   18 03          C      	JR	$+5
                         C      ;----------------------------------------------------------------------
  54FB*                  C      U1.KTIN1:
  54FB*   E5             C      	PUSH	HL
  54FC*   C5             C      	PUSH	BC
  54FD*   F5             C      	PUSH	AF
  54FE*   DD 36 0B 07    C      	LD	(IX+11),7    ;ANZAHL LESE/SCHREIBWDHLGNN
  5502*   DD 36 0C 04    C      	LD	(IX+12),4    ;ANZAHL
  5506*   21 0E65        C      	LD	HL,UE.PUF
  5509*   CD 5621*       C      	CALL	XY.STDX
  550C*   07             C      	DB	7            ;SYSTEMPUFFERADR.-->TAB
  550D*   21 8010        C      	LD	HL,UE.KPUFF
  5510*   CD 5621*       C      	CALL	XY.STDX
  5513*   19             C      	DB	25           ;E/A PUFFERADR.-->TAB
  5514*   F1             C      	POP	AF
  5515*   C1             C      	POP	BC
  5516*   E1             C      	POP	HL
  5517*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  5518*                  C      U1.VERIN:
  5518*   E5             C      	PUSH	HL
  5519*   C5             C      	PUSH	BC
  551A*   F5             C      	PUSH	AF
  551B*   11 EC82        C      	LD	DE,BC.VTABE  ;VERZ. EINGABEGER. EINLESEN
  551E*   18 03          C      	JR	$+5
  5520*                  C      U1.VERNI:
  5520*   E5             C      	PUSH	HL
  5521*   C5             C      	PUSH	BC
  5522*   F5             C      	PUSH	AF
  5523*   3A 0E68        C      	LD	A,(UE.PUF+3) ;ANZ. DATEIEN-->B
  5526*   47             C      	LD	B,A
  5527*   C5             C      	PUSH	BC
  5528*   21 0E65        C      	LD	HL,UE.PUF
  552B*   01 0020        C      	LD	BC,32
  552E*   ED B0          C      	LDIR
  5530*   CD 5D2F*       C      	CALL	UF.EXEC
  5533*   C1             C      	POP	BC
  5534*   10 F1          C      	DJNZ	$-13
  5536*   F1             C      	POP	AF
  5537*   C1             C      	POP	BC
  5538*   E1             C      	POP	HL
  5539*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  553A*                  C      U1.VORST:
  553A*   C5             C      	PUSH	BC
  553B*   CD 60AD*       C      	CALL	UR.KRWW
  553E*   06 06          C      	LD	B,6
  5540*   18 01          C      	JR	$+3
  5542*                  C      U1.VORS1:
  5542*   C5             C      	PUSH	BC
  5543*   DD 36 04 02    C      	LD	(IX+4),02H
  5547*   CD 5D2F*       C      	CALL	UF.EXEC
  554A*   10 FB          C      	DJNZ	$-3
  554C*   C1             C      	POP	BC
  554D*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  554E*                  C      U1.VZS:
  554E*   D5             C      	PUSH	DE
  554F*   C5             C      	PUSH	BC
  5550*   E5             C      	PUSH	HL
'Allgemeine Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-6


  5551*   F5             C      	PUSH	AF
  5552*   CD 60CF*       C      	CALL	UR.KBV
  5555*   CD 60D5*       C      	CALL	UR.KBR
  5558*   11 0E65        C      	LD	DE,UE.PUF
  555B*   01 0006        C      	LD	BC,6
  555E*   ED B0          C      	LDIR	             ;PROGR.NAME --> PUFFER
  5560*   3A 2B28*       C      	LD	A,(UB.PAR2)  ;DATEITYP
  5563*   12             C      	LD	(DE),A
  5564*   13             C      	INC	DE
  5565*   3E 44          C      	LD	A,'D'
  5567*   12             C      	LD	(DE),A
  5568*   13             C      	INC	DE
  5569*   3A 2B2A*       C      	LD	A,(UB.PAR3)
  556C*   FE 7F          C      	CP	7FH
  556E*   20 0F          C      	JR	NZ,$+17
  5570*   21 5E4F*       C      	LD	HL,UA.KOMMT  ;FRAGE KOMMENTAR WENN PAR3=7F
  5573*   CD 595C*       C      	CALL	UR.MIMO
  5576*   01 0006        C      	LD	BC,6
  5579*   ED B0          C      	LDIR
  557B*   06 09          C      	LD	B,9
  557D*   18 02          C      	JR	$+4
  557F*   06 0F          C      	LD	B,15
  5581*   3E 20          C      	LD	A,' '
  5583*   12             C      	LD	(DE),A
  5584*   13             C      	INC	DE
  5585*   10 FC          C      	DJNZ	$-2
  5587*   3A 2B26*       C      	LD	A,(UB.PAR1)
  558A*   12             C      	LD	(DE),A
  558B*   13             C      	INC	DE
  558C*   06 08          C      	LD	B,8
  558E*   AF             C      	XOR	A
  558F*   12             C      	LD	(DE),A
  5590*   13             C      	INC	DE
  5591*   10 FC          C      	DJNZ	$-2
  5593*   21 0020        C      	LD	HL,32
  5596*   CD 5631*       C      	CALL	XY.STIDX
  5599*   09             C      	DB	9
  559A*   DD 36 04 08    C      	LD	(IX+4),08H
  559E*   CD 5D2F*       C      	CALL	UF.EXEC
  55A1*   F1             C      	POP	AF
  55A2*   E1             C      	POP	HL
  55A3*   C1             C      	POP	BC
  55A4*   D1             C      	POP	DE
  55A5*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  55A6*                  C      U1.TR:
  55A6*   77             C      	LD	(HL),A       ;A=INHALT
  55A7*   23             C      	INC	HL
  55A8*   10 FC          C      	DJNZ	U1.TR        ;B=ANZAHL
  55AA*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  55AB*                  C      U1.INFO:
  55AB*   01 000E        C      	LD	BC,14
  55AE*   ED B0          C      	LDIR
  55B0*   C9             C      	RET
  55B1*                  C      U1.BILO:
  55B1*   CD 5400*       C      	CALL	U1.RSAVE
  55B4*   21 3370        C      	LD	HL,SD.BWSA + 11*80 ;3370H
  55B7*   01 040F        C      	LD	BC,13*80 - 1       ;1120  ( -80 ... eine Zeile )
  55BA*   36 20          C      	LD	(HL),20H
  55BC*   54             C      	LD	D,H
  55BD*   5D             C      	LD	E,L
  55BE*   13             C      	INC	DE
  55BF*   ED B0          C      	LDIR
  55C1*   CD 5408*       C      	CALL	U1.RRST
  55C4*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  55C5*                  C      U1.TST:
  55C5*   B7             C      	OR	A
  55C6*   D6 30          C      	SUB	30H
  55C8*   47             C      	LD	B,A
  55C9*   05             C      	DEC	B
  55CA*   C8             C      	RET	Z
  55CB*   05             C      	DEC	B
  55CC*   C8             C      	RET	Z
  55CD*   37             C      	SCF
  55CE*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  55CF*                  C      U1.PRADR:
  55CF*   E5             C      	PUSH	HL
  55D0*   C5             C      	PUSH	BC
  55D1*   06 04          C      	LD	B,4
  55D3*   7E             C      	LD	A,(HL)
'Allgemeine Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-7


  55D4*   FE 20          C      	CP	' '
  55D6*   28 07          C      	JR	Z,$+9
  55D8*   23             C      	INC	HL
  55D9*   10 F8          C      	DJNZ	$-6
  55DB*   B7             C      	OR	A
  55DC*   C1             C      	POP	BC
  55DD*   E1             C      	POP	HL
  55DE*   C9             C      	RET
  55DF*   37             C      	SCF
  55E0*   21 2B00*       C      	LD	HL,UB.ZN
  55E3*   35             C      	DEC	(HL)
  55E4*   18 F6          C      	JR	$-8
                         C      ;---------------------------------------------------------------------
  55E6*                  C      U1.KRWE:
  55E6*   CD 609F*       C      	CALL	UR.KRE
  55E9*   CD 60AD*       C      	CALL	UR.KRWW
  55EC*   C9             C      	RET
                         C      ;---------------------------------------------------------------------
                         C      ;	END
                         C      	TITLE 'Handling f. IX/IY-adressierte Bereiche'
                         C      	PAGE
'Handling f. IX/IY-adressierte Bereiche'	MACRO-80 3.44	09-Dec-81	PAGE	1-8


                         C      
                         C      ;	PN	XY ; Unterprogramme
                         C      ;**********************************************************************
                         C      ;*                                                                    *
                         C      ;*       Handling f. IX/IY-adressierte Steuer-Bloecke bzw.            *
                         C      ;*                                     Arbeits-Bereiche               *
                         C      ;*                                                                    *
                         C      ;*--------------------------------------------------------------------*
                         C      ;*                                                                    *
                         C      ;*       Ausser den angegebenen Registern bzw. Flags wird nur noch    *
                         C      ;*       die angegebene Anzahl der ersten freien Stack-Plaetze (je    *
                         C      ;*       Byte) veraendert. Weiterer RAM-Platz wird nicht benoetigt.   *
                         C      ;*                                                                    *
                         C      ;**********************************************************************
                         C      ;*                                                                    *
                         C      ;*       Technische (Hilfs-) Unter-Programme                          *
                         C      ;*                                                                    *
                         C      ;**********************************************************************
                         C      			;
                         C      ;        Uebernahme von nach dem CALL stehenden Parameter
                         C      ;        ++++++++++++++++++++++++++++++++++++++++++++++++
                         C      ;        erwarten Stack:           Return-Adresse f.uebergeordnetes UP
                         C      ;                       (SP) -->   Return-Adresse f.CALPn
                         C      ;        geben Stack zurueck:      Return-Adresse f.uebergeordn.UP + n
                         C      ;                                  (DE)
                         C      ;                       (SP) -->   (HL)
                         C      ;        geben in Reg.zurueck:     (DE):  Wert    1.Parameter-Byte
                         C      ;                                  (HL):  Adresse 2.Parameter-Byte
                         C      ;        --------------------------------------------------------------
                         C      		             ;
  55ED*                  C      XY.CALP1	EQU	$    ; 1 Byte-Parameter
                         C      		             ; ++++++++++++++++++++++++++++++
  55ED*   E5             C      	PUSH	HL           ; Retten HL
  55EE*   E1             C      	POP	HL
                         C      		             ;
  55EF*   EB             C      	EX	DE,HL        ; DE <--> RET-Adr.f.CALPn
  55F0*   E3             C      	EX	(SP),HL
  55F1*   EB             C      	EX	DE,HL
                         C      		             ;
  55F2*   E1             C      	POP	HL           ; (SP) --> RET-Adr.f.ueberg.UP
                         C      		             ;
  55F3*   E1             C      	POP	HL           ; Laden u. korrig. ...
  55F4*   23             C      	INC	HL
  55F5*   E5             C      	PUSH	HL
  55F6*                  C      XY.CALPE:
  55F6*   2B             C      	DEC	HL
                         C      		             ;
  55F7*   3B             C      	DEC	SP           ; (SP) --> (DE)
  55F8*   3B             C      	DEC	SP
  55F9*   3B             C      	DEC	SP           ; (SP) --> (HL)
  55FA*   3B             C      	DEC	SP
                         C      		             ;
  55FB*   D5             C      	PUSH	DE           ; RET-Adr.f.CALPn
                         C      		             ;
  55FC*   5E             C      	LD	E,(HL)       ; Laden DE, HL
  55FD*   16 00          C      	LD	D,0
  55FF*   23             C      	INC	HL
                         C      		             ;
  5600*   C9             C      	RET
                         C      ;**********************************************************************
                         C      ;*                                                                    *
                         C      ;*       Lade-, Speicher- und Transport-Unterprogramme                *
                         C      ;*                                                                    *
                         C      ;**********************************************************************
                         C      ;
                         C      ;    CALL  LDDX    'Load':              HL := (IX+d)
                         C      ;    DB    d                                              Stack: 4
                         C      ;    -----------   ----------------------------------------------------
                         C      		             ;
  5601*                  C      XY.LDDX:
  5601*   CD 55ED*       C      	CALL	XY.CALP1     ; Uebernahme d
                         C      		             ;
  5604*   DD E5          C      	PUSH	IX           ; HL := IX+d
  5606*   E1             C      	POP	HL           ;               <--- LDDY
  5607*   F5             C      	PUSH	AF
  5608*   19             C      	ADD	HL,DE
  5609*   F1             C      	POP	AF
                         C      		             ;
  560A*   5E             C      	LD	E,(HL)       ; HL := (IX+d)
  560B*   23             C      	INC	HL
  560C*   56             C      	LD	D,(HL)
  560D*   EB             C      	EX	DE,HL
'Handling f. IX/IY-adressierte Bereiche'	MACRO-80 3.44	09-Dec-81	PAGE	1-9


                         C      		             ;
  560E*   D1             C      	POP	DE           ; Return
  560F*   D1             C      	POP	DE
  5610*   C9             C      	RET
                         C      		             ;
                         C      ;**********************************************************************
                         C      ;
                         C      ;    CALL  LIDX    'Load inverse':      LH := (IX+d)
                         C      ;    DB    d                                              Stack: 4
                         C      ;    -----------   ----------------------------------------------------
                         C      		             ;
  5611*                  C      XY.LIDX:
  5611*   CD 55ED*       C      	CALL	XY.CALP1     ; Uebernahme d
                         C      		             ;
  5614*   DD E5          C      	PUSH	IX           ; HL := IX+d
  5616*   E1             C      	POP	HL           ;               <--- LIDY
  5617*   F5             C      	PUSH	AF
  5618*   19             C      	ADD	HL,DE
  5619*   F1             C      	POP	AF
                         C      		             ;
  561A*   56             C      	LD	D,(HL)       ; LH := (IX+d)
  561B*   23             C      	INC	HL
  561C*   5E             C      	LD	E,(HL)
  561D*   EB             C      	EX	DE,HL
                         C      		             ;
  561E*   D1             C      	POP	DE           ; Return
  561F*   D1             C      	POP	DE
  5620*   C9             C      	RET
                         C      		             ;
                         C      ;**********************************************************************
                         C      ;
                         C      ;    CALL  STDX    'Store':            (IX+d) := HL
                         C      ;    DB    d                                                  Stack: 4
                         C      ;    -----------   ----------------------------------------------------
                         C      		             ;
  5621*                  C      XY.STDX:
  5621*   CD 55ED*       C      	CALL	XY.CALP1     ; Uebernahme d
                         C      		             ;
  5624*   DD E5          C      	PUSH	IX           ; HL := IX+d
  5626*   E1             C      	POP	HL           ;               <--- STDY
  5627*   F5             C      	PUSH	AF
  5628*   19             C      	ADD	HL,DE
  5629*   F1             C      	POP	AF
                         C      		             ;
  562A*   D1             C      	POP	DE
  562B*   73             C      	LD	(HL),E       ; (IX+d) := HL
  562C*   23             C      	INC	HL
  562D*   72             C      	LD	(HL),D
  562E*   EB             C      	EX	DE,HL
                         C      		             ;
  562F*   D1             C      	POP	DE           ; Return
  5630*   C9             C      	RET
                         C      		             ;
                         C      ;**********************************************************************
                         C      ;
                         C      ;    CALL  STIDX    'Store inverse':    (IX+d) := LH
                         C      ;    DB    d                                                  Stack: 4
                         C      ;    -----------   ----------------------------------------------------
                         C      		             ;
  5631*                  C      XY.STIDX:
  5631*   CD 55ED*       C      	CALL	XY.CALP1     ; Uebernahme d
                         C      		             ;
  5634*   DD E5          C      	PUSH	IX           ; HL := IX+d
  5636*   E1             C      	POP	HL           ;               <--- STIDY
  5637*   F5             C      	PUSH	AF
  5638*   19             C      	ADD	HL,DE
  5639*   F1             C      	POP	AF
                         C      		             ;
  563A*   D1             C      	POP	DE
  563B*   72             C      	LD	(HL),D       ; (IX+d) := LH
  563C*   23             C      	INC	HL
  563D*   73             C      	LD	(HL),E
  563E*   EB             C      	EX	DE,HL
                         C      		             ;
  563F*   D1             C      	POP	DE           ; Return
  5640*   C9             C      	RET
                         C      		             ;
                         C      ;**********************************************************************
                         C      ;
                         C      ;    CALL  INCDX    'Increment':        (IX+d) := (IX+d) + 1
                         C      ;    DB    d                                    Flags wie ADC HL,...
                         C      ;                                                             Stack: 4
                         C      ;    -----------   ----------------------------------------------------
'Handling f. IX/IY-adressierte Bereiche'	MACRO-80 3.44	09-Dec-81	PAGE	1-10


                         C      		             ;
  5641*                  C      XY.INCDX:
  5641*   CD 55ED*       C      	CALL	XY.CALP1     ; Uebernahme d
                         C      		             ;
  5644*   DD E5          C      	PUSH	IX           ; HL := IX+d
  5646*   E1             C      	POP	HL           ;               <--- INCDY
  5647*   19             C      	ADD	HL,DE
                         C      		             ;
  5648*   5E             C      	LD	E,(HL)       ; DE := (IX+d)
  5649*   23             C      	INC	HL
  564A*   56             C      	LD	D,(HL)
                         C      		             ;
  564B*   E5             C      	PUSH	HL           ; DE := (IX+d) + 1
  564C*   21 0001        C      	LD	HL,1
  564F*   B7             C      	OR	A
  5650*   ED 5A          C      	ADC	HL,DE
  5652*   EB             C      	EX	DE,HL
  5653*   E1             C      	POP	HL
  5654*   72             C      	LD	(HL),D
  5655*   2B             C      	DEC	HL
  5656*   73             C      	LD	(HL),E
                         C      		             ;
  5657*   E1             C      	POP	HL           ; Return
  5658*   D1             C      	POP	DE
  5659*   C9             C      	RET
                         C      		             ;
                         C      ;**********************************************************************
                         C      ;*                                                                    *
                         C      ;*       Unterprogramm  'Unbedingter Sprung'                          *
                         C      ;*                                                                    *
                         C      ;**********************************************************************
                         C      ;
                         C      ;    CALL  JMPDX   'Jump':              JMP  (IX+d)
                         C      ;    DB    d                                              Stack: 4
                         C      ;                                       Achtung!
                         C      ;                                           Veraendert freie Stack-Pl.
                         C      ;    -----------   ----------------------------------------------------
                         C      		             ;
  565A*                  C      XY.JMPDX:
  565A*   CD 55ED*       C      	CALL	XY.CALP1     ; Uebernahme d
                         C      		             ;
  565D*   DD E5          C      	PUSH	IX           ; HL := IX+d
  565F*   E1             C      	POP	HL           ;               <--- JMPDY
  5660*   F5             C      	PUSH	AF
  5661*   19             C      	ADD	HL,DE
  5662*   F1             C      	POP	AF
                         C      		             ;
  5663*   5E             C      	LD	E,(HL)       ; HL := (IX+d)
  5664*   23             C      	INC	HL
  5665*   56             C      	LD	D,(HL)
  5666*   EB             C      	EX	DE,HL
                         C      		             ;
  5667*   D1             C      	POP	DE           ; Return = Jump
  5668*   E3             C      	EX	(SP),HL
  5669*   EB             C      	EX	DE,HL
  566A*   C9             C      	RET
                         C      		             ;
                         C      ;**********************************************************************
                         C      ;	END
                         C      	TITLE 'Konvertierungen'
                         C      	PAGE
'Konvertierungen'	MACRO-80 3.44	09-Dec-81	PAGE	1-11


                         C      
                         C      ;	PN	UC
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;       KONVERTIERUNGEN
                         C      ;
                         C      ;----------------------------------------------------------------------
                         C      ;                            HL := HL * 10
                         C      ;                                      (ohne Kontrolle auf Uebertrag)
  566B*                  C      UC.HL10N:
  566B*   E5             C      	PUSH	HL
  566C*   D1             C      	POP	DE           ; alter Wert in DE
  566D*   29             C      	ADD	HL,HL
  566E*   29             C      	ADD	HL,HL
  566F*   19             C      	ADD	HL,DE
  5670*   29             C      	ADD	HL,HL
  5671*   C9             C      	RET
                         C      ;                            HL := HL * 10
                         C      ;                                            -->  C: Uebertrag in A
  5672*                  C      UC.HL10C:
  5672*   E5             C      	PUSH	HL
  5673*   D1             C      	POP	DE           ; alter Wert in DE
  5674*   AF             C      	XOR	A
  5675*   29             C      	ADD	HL,HL
  5676*   30 01          C      	JR	NC,$+3
  5678*   3C             C      	INC	A
  5679*   87             C      	ADD	A,A
  567A*   29             C      	ADD	HL,HL
  567B*   30 01          C      	JR	NC,$+3
  567D*   3C             C      	INC	A
  567E*   19             C      	ADD	HL,DE
  567F*   30 01          C      	JR	NC,$+3
  5681*   3C             C      	INC	A
  5682*   87             C      	ADD	A,A
  5683*   29             C      	ADD	HL,HL
  5684*   30 01          C      	JR	NC,$+3
  5686*   3C             C      	INC	A
  5687*   B7             C      	OR	A
  5688*   C8             C      	RET	Z
  5689*   37             C      	SCF
  568A*   C9             C      	RET
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      ;                            Division mit Rest:  A  := HL / DE
                         C      ;                                                HL := Rest
                         C      		             ;      Cy(A) --->  A=255
                         C      		             ;-------------------------------
  568B*                  C      UC.DIVR:
  568B*   AF             C      	XOR	A
  568C*   ED 52          C      	SBC	HL,DE
  568E*   3C             C      	INC	A
  568F*   20 03          C      	JR	NZ,$+5
  5691*   3D             C      	DEC	A
  5692*   38 03          C      	JR	C,$+5
  5694*   30 F6          C      	JR	NC,$-8
  5696*   3D             C      	DEC	A
  5697*   19             C      	ADD	HL,DE
  5698*   C9             C      	RET
                         C      		             ;
                         C      ;**********************************************************************
                         C      ;*                                                                    *
                         C      ;*       CV...               Konvertierungen     (convert ...)        *
                         C      ;*                                                                    *
                         C      ;*--------------------------------------------------------------------*
                         C      ;*       ..A..:              in A                                     *
                         C      ;*       ..?*.:              von Typ *                                *
                         C      ;*       ..?.*:              nach Typ *                               *
                         C      ;*                                                                    *
                         C      ;*       Typen:              B - binaer                               *
                         C      ;*                           X - hexadezimal ASCII                    *
                         C      ;*                           A - Adresse binaer (L,H)                 *
                         C      ;*                           D - dezimal ASCII                        *
                         C      ;*                                                                    *
                         C      ;**********************************************************************
                         C      		             ;
                         C      ;                            In A:      Binaer < 16 --> ASCII hexa
                         C      ;                            ------------------------------------------
  5699*                  C      UC.CVABX:
  5699*   E6 0F          C      	AND	0FH
  569B*   F6 30          C      	OR	30H
  569D*   FE 3A          C      	CP	3AH
  569F*   D8             C      	RET	C
'Konvertierungen'	MACRO-80 3.44	09-Dec-81	PAGE	1-12


  56A0*   C6 07          C      	ADD	A,7H
  56A2*   C9             C      	RET
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      ;                            Byte binaer (HL) --> 2 ASCII hexa (DE)
                         C      ;                                                            HL+1, DE+2
                         C      ;                            ------------------------------------------
  56A3*                  C      UC.CVBX:
  56A3*   7E             C      	LD	A,(HL)
  56A4*   23             C      	INC	HL           ; benutzt: A, 2 Stack-P.
                         C      		             ;
  56A5*   F5             C      	PUSH	AF           ;ENTRY,WENN ZEICHEN IN A
  56A6*   0F             C      	RRCA
  56A7*   0F             C      	RRCA
  56A8*   0F             C      	RRCA
  56A9*   0F             C      	RRCA
  56AA*   CD 56AE*       C      	CALL	$+4
  56AD*   F1             C      	POP	AF
                         C      		             ;
  56AE*   CD 5699*       C      	CALL	UC.CVABX
  56B1*   12             C      	LD	(DE),A
  56B2*   13             C      	INC	DE
  56B3*   C9             C      	RET
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      ;                       Adresse (L,H) binaer (HL) --> 4 ASCII hexa (DE)
                         C      ;                                                            HL+2, DE+4
                         C      ;                       -----------------------------------------------
  56B4*                  C      UC.CVAX:
  56B4*   23             C      	INC	HL
  56B5*   CD 56A3*       C      	CALL	UC.CVBX      ; benutzt: A, 3 Stack-P.
  56B8*   2B             C      	DEC	HL
  56B9*   2B             C      	DEC	HL
  56BA*   CD 56A3*       C      	CALL	UC.CVBX
  56BD*   23             C      	INC	HL
  56BE*   C9             C      	RET
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      ;                       Adresse aus HL, binaer    --> 4 ASCII hexa (DE)
                         C      ;                                                                  DE+4
                         C      ;                       -----------------------------------------------
  56BF*                  C      UC.CVHLX:
  56BF*   7C             C      	LD	A,H
  56C0*   CD 56A5*       C      	CALL	UC.CVBX+2    ; benutzt: A, 3 Stack-P.
  56C3*   7D             C      	LD	A,L
  56C4*   CD 56A5*       C      	CALL	UC.CVBX+2
  56C7*   C9             C      	RET
                         C      		             ;
                         C      		             ;
                         C      ;      ---------------------------------------------------------------
                         C      ;                            In A:     ASCII hexa --> binaer < 16
                         C      ;
                         C      ;                                       Datenfehler: Cy, A undefiniert
                         C      ;                            ------------------------------------------
  56C8*                  C      UC.CVAXB:
  56C8*   D6 30          C      	SUB	30H
  56CA*   D8             C      	RET	C            ;       (A) < '0'
  56CB*   FE 0A          C      	CP	10
  56CD*   3F             C      	CCF
  56CE*   D0             C      	RET	NC
  56CF*   FE 11          C      	CP	11H
  56D1*   D8             C      	RET	C            ; '9' < (A) < 'A'
  56D2*   FE 17          C      	CP	17H
  56D4*   3F             C      	CCF
  56D5*   D8             C      	RET	C            ; 'F' < (A)
  56D6*   D6 07          C      	SUB	7H
  56D8*   C9             C      	RET
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      ;                            2 ASCII hexa (DE) --> Byte binaer (HL)
                         C      ;                                                            DE+2, HL+1
                         C      ;
                         C      ;                                       mit Datenfehler-Behandlung
                         C      ;                            ------------------------------------------
  56D9*                  C      UC.CVXB:
  56D9*   C5             C      	PUSH	BC
                         C      		             ; benutzt: A, 3 Stack-P.
  56DA*   CD 56EA*       C      	CALL	UC.CVX1B
  56DD*   87             C      	ADD	A,A
  56DE*   87             C      	ADD	A,A
  56DF*   87             C      	ADD	A,A
  56E0*   87             C      	ADD	A,A
  56E1*   4F             C      	LD	C,A
'Konvertierungen'	MACRO-80 3.44	09-Dec-81	PAGE	1-13


                         C      		             ;
  56E2*   CD 56EA*       C      	CALL	UC.CVX1B
  56E5*   81             C      	ADD	A,C
                         C      		             ;
  56E6*   77             C      	LD	(HL),A
  56E7*   23             C      	INC	HL
  56E8*   C1             C      	POP	BC
  56E9*   C9             C      	RET
                         C      		             ;
  56EA*                  C      UC.CVX1B:
  56EA*   1A             C      	LD	A,(DE)       ; ASCII hexa (DE) --> A binaer,
  56EB*   CD 56C8*       C      	CALL	UC.CVAXB     ;                           DE+1
  56EE*   DC 56F3*       C      	CALL	C,UC.CVXER
  56F1*   13             C      	INC	DE
  56F2*   C9             C      	RET
                         C      		             ;
  56F3*                  C      UC.CVXER:
  56F3*   EB             C      	EX	DE,HL        ; Datenfehler-Behandlung hexa
  56F4*   CD 4033        C      	CALL	SY.SETCHL    ;         set cursor
  56F7*   CD 5A88*       C      	CALL 	UR.TAREP     ; <-+     tast.request
  56FA*   77             C      	LD   	(HL),A       ;   |     write in conv.-area
  56FB*   CD 56C8*       C      	CALL 	UC.CVAXB     ;   |     conv.in A
  56FE*   38 F7          C      	JR   	C,$-7        ; --+     on error ...
  5700*   CD 4036        C      	CALL	SY.RESC
  5703*   EB             C      	EX   	DE,HL
  5704*   C9             C      	RET
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      ;                       4 ASCII hexa (DE) --> Adresse (L,H) binaer (HL)
                         C      ;                                                            DE+4, HL+2
                         C      ;
                         C      ;                                       mit Datenfehler-Behandlung
                         C      ;                       -----------------------------------------------
  5705*                  C      UC.CVXA:
  5705*   23             C      	INC	HL
  5706*   CD 56D9*       C      	CALL	UC.CVXB      ; benutzt: A, 4 Stack-P.
  5709*   2B             C      	DEC	HL
  570A*   2B             C      	DEC	HL
  570B*   CD 56D9*       C      	CALL	UC.CVXB
  570E*   23             C      	INC	HL
  570F*   C9             C      	RET
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      ;                     2 Byte binaer in HL ---> 1...5-stellig dezi (DE),
                         C      ;                                                             DE+1...5
                         C      ;                                  mit Vor-Null-Unterdrueckung
                         C      ;                                                    (nach nicht-dezi),
                         C      ;                                  zu wenig Stellen -->
                         C      ;                                      '*' in der obersten angeg.Stelle
                         C      ;                      ------------------------------------------------
  5710*                  C      UC.CVBD5:
  5710*   3E 05          C      	LD	A,5          ; benutzt: A, 7 Stack-P.
  5712*   18 0E          C      	JR	$+16
  5714*                  C      UC.CVBD4:
  5714*   3E 04          C      	LD	A,4
  5716*   18 0A          C      	JR	$+12
  5718*                  C      UC.CVBD3:
  5718*   3E 03          C      	LD	A,3
  571A*   18 06          C      	JR	$+8
  571C*                  C      UC.CVBD2:
  571C*   3E 02          C      	LD	A,2
  571E*   18 02          C      	JR	$+4
  5720*                  C      UC.CVBD1:
  5720*   3E 01          C      	LD	A,1
                         C      		             ;
  5722*                  C      UC.CVBD:
  5722*   C5             C      	PUSH	BC           ; Zeichenzahl in A
  5723*   E5             C      	PUSH	HL
  5724*   47             C      	LD	B,A
  5725*   CD 572D*       C      	CALL	UC.CVBD0
  5728*   10 FB          C      	DJNZ	$-3
  572A*   E1             C      	POP	HL
  572B*   C1             C      	POP	BC
  572C*   C9             C      	RET
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      ;                          Abspaltung B-te Stelle dezi von HL nach (DE)
                         C      ;                                                                  DE+1
                         C      ;                          B-te nicht fuehrende Stelle: '*' nach (DE)
                         C      ;                          --------------------------------------------
  572D*                  C      UC.CVBD0:
  572D*   C5             C      	PUSH	BC           ; benutzt: A, 5 Stack-P.
                         C      		             ; --------
'Konvertierungen'	MACRO-80 3.44	09-Dec-81	PAGE	1-14


  572E*   7D             C      	LD	A,L
  572F*   F6 30          C      	OR	'0'
  5731*   05             C      	DEC	B
  5732*   28 29          C              JR      Z,$+43       ; -------+
                         C                                   ;        |
  5734*   D5             C              PUSH    DE           ;        |
  5735*   E5             C              PUSH    HL           ; DE := (B-1)-te Zehner-Potenz
  5736*   21 0001        C              LD      HL,1         ;        |
  5739*   CD 566B*       C              CALL    UC.HL10N     ;        |
  573C*   10 FB          C              DJNZ    $-3          ;        |
  573E*   EB             C              EX      DE,HL        ;        |
  573F*   E1             C              POP     HL           ;        |
                         C                                   ;        |
  5740*   CD 568B*       C              CALL    UC.DIVR      ; A := HL / B-te Zehner-Potenz
  5743*   D1             C              POP     DE           ;        |     HL := Rest
                         C                                   ;        |
  5744*   FE 0A          C              CP      10           ; test to decimal
  5746*   38 04          C              JR      C,$+6        ; ---+   |
  5748*   3E 2A          C              LD      A,'*'        ;    |   |
  574A*   18 11          C              JR      $+19         ; -------+
                         C                                   ; <--+   |
  574C*   F6 30          C              OR      '0'          ; conv.to decimal
                         C                                   ;        |
  574E*   FE 30          C              CP      '0'          ; Vor-Null ?
  5750*   20 0B          C              JR      NZ,$+13      ; -------+
  5752*   1B             C              DEC     DE           ;        |
  5753*   4F             C              LD      C,A          ;        |
  5754*   CD 578A*       C              CALL    UC.CVD1B     ;        |
  5757*   79             C              LD      A,C          ;        |
  5758*   13             C              INC     DE           ;        |
  5759*   30 02          C              JR      NC,$+4       ;        |
  575B*   3E 20          C              LD      A,' '        ;        |
                         C                                   ; <------+
  575D*   12             C      	LD	(DE),A
  575E*   13             C      	INC	DE
  575F*   C1             C      	POP	BC
  5760*   C9             C      	RET
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      ;                      Dezi von (DE) bis (-->DE) nicht-dezi
                         C      ;                                                --->      binaer in HL
                         C      ;
                         C      ;                         Fehler:
                         C      ;                         -------
                         C      ;                         Cy, NZ: Zahl zu gross, HL ohne letzte Ziffer
                         C      ;                         Cy, Z:  Leere Zahl (1.Position keine Ziffer),
                         C      ;                                        -->     HL = 0
                         C      ;                      ------------------------------------------------
  5761*                  C      UC.CVDB:
  5761*   26 00          C      	LD	H,0
  5763*   CD 578A*       C      	CALL	UC.CVD1B
  5766*   6F             C      	LD	L,A
  5767*   30 04          C      	JR	NC,$+6
  5769*   AF             C      	XOR	A
  576A*   6F             C      	LD	L,A
  576B*   37             C      	SCF
  576C*   C9             C      	RET                  ; ---> abend C, Z
                         C                                   ;
  576D*   13             C      	INC	DE
  576E*   CD 578A*       C      	CALL	UC.CVD1B
  5771*   3F             C      	CCF
  5772*   D0             C      	RET	NC           ; ---> normal end
  5773*   D5             C      	PUSH	DE
  5774*   F5             C      	PUSH	AF
  5775*   CD 5672*       C      	CALL	UC.HL10C
  5778*   38 0B          C      	JR	C,$+13       ; ----------+
  577A*   F1             C      	POP	AF           ;           |
  577B*   85             C      	ADD	A,L          ;           |
  577C*   6F             C      	LD	L,A          ;           |
  577D*   30 03          C      	JR	NC,$+5       ; --+       |
  577F*   24             C      	INC	H            ;   |       |
  5780*   28 04          C      	JR	Z,$+6        ;   |    ---|--+
  5782*   D1             C      	POP	DE           ; <-+       |  |
  5783*   18 E8          C      	JR	$-22         ;           |  |
                         C                         ;      <----+  !
  5785*   E1             C      	POP	HL           ; abend Cy, NZ !
  5786*   25             C      	DEC	H            ;              |
  5787*   EB             C      	EX	DE,HL        ;        <-----+
  5788*   D1             C      	POP	DE
  5789*   C9             C      	RET
                         C                                   ;
                         C      ;        --------------------------------------------------------------
                         C      ;                            Ziffer dezi (DE) ---> binaer nach A, DE+1
'Konvertierungen'	MACRO-80 3.44	09-Dec-81	PAGE	1-15


                         C      ;                                                  Cy: nicht-dezi
                         C      ;                            ------------------------------------------
  578A*                  C      UC.CVD1B:
  578A*   1A             C      	LD	A,(DE)
  578B*   D6 30          C      	SUB	30H
  578D*   D8             C      	RET	C
  578E*   FE 0A          C      	CP	10
  5790*   3F             C      	CCF
  5791*   C9             C      	RET
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      ;                    Byte binaer (HL) --> Byte ASCII-Symbol (DE)
                         C      ;                                         (sonst: 7FH )
                         C      ;                                                     HL+1, DE+1
                         C      ;                    --------------------------------------------------
  5792*                  C      UC.CVBC:
  5792*   7E             C      	LD	A,(HL)       ; benutzt: A, 0 Stack-P.
  5793*   23             C      	INC	HL           ; --------
  5794*   FE 20          C      	CP	20H
  5796*   30 02          C      	JR	NC,$+4
  5798*   3E 7F          C      	LD	A,7FH
  579A*   FE 7F          C      	CP	7FH
  579C*   38 02          C      	JR	C,$+4
  579E*   3E 7F          C      	LD	A,7FH
  57A0*   12             C      	LD	(DE),A
  57A1*   13             C      	INC	DE
  57A2*   C9             C      	RET
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      ;                       Byte ASCII-Symbol (DE)   -->   Byte binaer (HL)
                         C      ;                                                      DE+1, HL+1
                         C      ;                       -----------------------------------------------
  57A3*                  C      UC.CVCB:
  57A3*   1A             C      	LD	A,(DE)       ; benutzt: A, 0 Stack-P.
  57A4*   13             C      	INC	DE
  57A5*   FE 20          C      	CP	20H
  57A7*   38 05          C      	JR	C,$+7
  57A9*   FE 7E          C      	CP	7EH
  57AB*   30 01          C      	JR	NC,$+3
  57AD*   77             C      	LD	(HL),A
  57AE*   23             C      	INC	HL
  57AF*   C9             C      	RET
                         C      		             ;
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;      KONVERTIERUNGEN
                         C      ;
                         C      ;----------------------------------------------------------------------
  57B0*                  C      UC.DKONV:
  57B0*   7E             C      	LD	A,(HL)       ;DKOI--->ASCII
  57B1*   CD 57C4*       C      	CALL	UC.DK1       ;(HL)--->(DE)
  57B4*   12             C      	LD	(DE),A
  57B5*   23             C      	INC	HL
  57B6*   13             C      	INC	DE
  57B7*   10 F7          C      	DJNZ	UC.DKONV
  57B9*   C9             C      	RET
                         C      ;------------------------------------
  57BA*                  C      UC.KONV:
  57BA*   7E             C      	LD	A,(HL)       ;ASCII--->DKOI
  57BB*   CD 57CF*       C      	CALL	UC.CKONV     ;(HL) --->(DE)
  57BE*   12             C      	LD	(DE),A
  57BF*   23             C      	INC	HL
  57C0*   13             C      	INC	DE
  57C1*   10 F7          C      	DJNZ	UC.KONV
  57C3*   C9             C      	RET
                         C      ;-----------------------------
  57C4*                  C      UC.DK1:
  57C4*   E5             C      	PUSH	HL           ;DKOI--->ASCII
  57C5*   D5             C      	PUSH	DE
  57C6*   C5             C      	PUSH	BC
  57C7*   21 57F2*       C      	LD	HL,UC.ASCCO
  57CA*   11 5852*       C      	LD	DE,UC.DKOI
  57CD*   18 09          C      	JR	UC.DK2
  57CF*                  C      UC.CKONV:
  57CF*   E5             C      	PUSH	HL           ;ASCII ---> DKOI
  57D0*   D5             C      	PUSH	DE
  57D1*   C5             C      	PUSH	BC
  57D2*   21 5852*       C      	LD	HL,UC.DKOI   ;HL:= Anfangsadresse
  57D5*   11 57F2*       C      	LD	DE,UC.ASCCO  ;DE:= Anfangsadresse
  57D8*                  C      UC.DK2:
  57D8*   F5             C      	PUSH	AF           ;Quellcodebyte retten
  57D9*   AF             C      	XOR	A            ;CY = 0
  57DA*   ED 52          C      	SBC	HL,DE        ;Tabellendistanz berechnen
'Konvertierungen'	MACRO-80 3.44	09-Dec-81	PAGE	1-16


  57DC*   2B             C      	DEC	HL
  57DD*   E5             C      	PUSH	HL
  57DE*   C1             C      	POP	BC           ;BC:= Tabellendistanz - 1
  57DF*   EB             C      	EX	DE,HL        ;HL:= Anfangsadresse
  57E0*   F1             C      	POP	AF           ;Zeichen wieder herstellen
  57E1*   C5             C      	PUSH	BC           ;Tabellendistanz retten
  57E2*   01 0060        C      	LD	BC,UE.COTAL  ;BC:= Tabellenlaenge
  57E5*   ED B1          C      	CPIR	             ;Quellcodebyte suchen
  57E7*   37             C      	SCF                  ;CY = 1
  57E8*   C1             C      	POP	BC           ;Tabellendistanz auskellern
  57E9*   20 03          C      	JR	NZ,UC.KONV2  ;---> Quellcodebyte nicht
  57EB*   09             C      	ADD	HL,BC        ;Zielcodeadresse berechnen
  57EC*   AF             C      	XOR	A            ;CY = 0
  57ED*   7E             C      	LD	A,(HL)       ;Zielcodebyte laden
  57EE*                  C      UC.KONV2:
  57EE*   C1             C      	POP	BC
  57EF*   D1             C      	POP	DE
  57F0*   E1             C      	POP	HL
  57F1*   C9             C      	RET
                         C      ;****************************************************************
                         C      ;         ASCII - Codetabelle
                         C      ;****************************************************************
  57F2*                  C      UC.ASCCO:
  57F2*   20 21 22 23    C      	DB	' !"#$%&'
  57F6*   24 25 26       C      
  57F9*   27             C      	DB	27H	;'
  57FA*   28 29 2A 2B    C      	DB	'()*+,-./'
  57FE*   2C 2D 2E 2F    C      
  5802*   30 31 32 33    C      	DB	'0123456789'
  5806*   34 35 36 37    C      
  580A*   38 39          C      
  580C*   3A 3B 3C 3D    C      	DB	':;<=>?@'
  5810*   3E 3F 40       C      
  5813*   41 42 43 44    C      	DB	'ABCDEFGHIJKLMNOPQRSTUVWXYZ'
  5817*   45 46 47 48    C      
  581B*   49 4A 4B 4C    C      
  581F*   4D 4E 4F 50    C      
  5823*   51 52 53 54    C      
  5827*   55 56 57 58    C      
  582B*   59 5A          C      
  582D*   5B 5C 5D 5E    C      	DB	'[\]^_`'
  5831*   5F 60          C      
  5833*   61 62 63 64    C      	DB	'abcdefghijklmnopqrstuvwxyz'
  5837*   65 66 67 68    C      
  583B*   69 6A 6B 6C    C      
  583F*   6D 6E 6F 70    C      
  5843*   71 72 73 74    C      
  5847*   75 76 77 78    C      
  584B*   79 7A          C      
  584D*   7B 7C 7D 7E    C      	DB	'{|}~'
  5851*   7F             C      	DB	7FH	;DEL
                         C      ;***************************************************************
                         C      ;         DKOI - Codetabelle
                         C      ;***************************************************************
  5852*                  C      UC.DKOI:
  5852*   40             C      	DB	40H	;blank
  5853*   4F             C      	DB	4FH	;!
  5854*   7F             C      	DB	7FH	;"
  5855*   7B             C      	DB	7BH	;#
  5856*   5B             C      	DB	5BH	;$
  5857*   6C             C      	DB	6CH	;%
  5858*   50             C      	DB	50H	;&
  5859*   7D             C      	DB	7DH	;'
  585A*   4D             C      	DB	4DH	;(
  585B*   5D             C      	DB	5DH	;)
  585C*   5C             C      	DB	5CH	;*
  585D*   4E             C      	DB	4EH	;+
  585E*   6B             C      	DB	6BH	;,
  585F*   60             C      	DB	60H	;-
  5860*   4B             C      	DB	4BH	;.
  5861*   61             C      	DB	61H	;/
  5862*   F0             C      	DB	0F0H	;0
  5863*   F1             C      	DB	0F1H	;1
  5864*   F2             C      	DB	0F2H	;2
  5865*   F3             C      	DB	0F3H	;3
  5866*   F4             C      	DB	0F4H	;4
  5867*   F5             C      	DB	0F5H	;5
  5868*   F6             C      	DB	0F6H	;6
  5869*   F7             C      	DB	0F7H	;7
  586A*   F8             C      	DB	0F8H	;8
  586B*   F9             C      	DB	0F9H	;9
  586C*   7A             C      	DB	7AH	;:
  586D*   5E             C      	DB	5EH	;;
'Konvertierungen'	MACRO-80 3.44	09-Dec-81	PAGE	1-17


  586E*   4C             C      	DB	4CH	;<
  586F*   7E             C      	DB	7EH	;=
  5870*   6E             C      	DB	6EH	;>
  5871*   6F             C      	DB	6FH	;?
  5872*   7C             C      	DB	7CH	;@
  5873*   C1             C      	DB	0C1H	;A
  5874*   C2             C      	DB	0C2H	;B
  5875*   C3             C      	DB	0C3H	;C
  5876*   C4             C      	DB	0C4H	;D
  5877*   C5             C      	DB	0C5H	;E
  5878*   C6             C      	DB	0C6H	;F
  5879*   C7             C      	DB	0C7H	;G
  587A*   C8             C      	DB	0C8H	;H
  587B*   C9             C      	DB	0C9H	;I
  587C*   D1             C      	DB	0D1H	;J
  587D*   D2             C      	DB	0D2H	;K
  587E*   D3             C      	DB	0D3H	;L
  587F*   D4             C      	DB	0D4H	;M
  5880*   D5             C      	DB	0D5H	;N
  5881*   D6             C      	DB	0D6H	;O
  5882*   D7             C      	DB	0D7H	;P
  5883*   D8             C      	DB	0D8H	;Q
  5884*   D9             C      	DB	0D9H	;R
  5885*   E2             C      	DB	0E2H	;S
  5886*   E3             C      	DB	0E3H	;T
  5887*   E4             C      	DB	0E4H	;U
  5888*   E5             C      	DB	0E5H	;V
  5889*   E6             C      	DB	0E6H	;W
  588A*   E7             C      	DB	0E7H	;X
  588B*   E8             C      	DB	0E8H	;Y
  588C*   E9             C      	DB	0E9H	;Z
  588D*   4A             C      	DB	4AH	;[
  588E*   E0             C      	DB	0E0H	;\
  588F*   5A             C      	DB	5AH	;]
  5890*   5F             C      	DB	5FH	;^
  5891*   6D             C      	DB	6DH	;_
  5892*   79             C      	DB	79H	;`
  5893*   81             C      	DB	81H	;a
  5894*   82             C      	DB	82H	;b
  5895*   83             C      	DB	83H	;c
  5896*   84             C      	DB	84H	;d
  5897*   85             C      	DB	85H	;e
  5898*   86             C      	DB	86H	;f
  5899*   87             C      	DB	87H	;g
  589A*   88             C      	DB	88H	;h
  589B*   89             C      	DB	89H	;i
  589C*   91             C      	DB	91H	;j
  589D*   92             C      	DB	92H	;k
  589E*   93             C      	DB	93H	;l
  589F*   94             C      	DB	94H	;m
  58A0*   95             C      	DB	95H	;n
  58A1*   96             C      	DB	96H	;o
  58A2*   97             C      	DB	97H	;p
  58A3*   98             C      	DB	98H	;q
  58A4*   99             C      	DB	99H	;r
  58A5*   A2             C      	DB	0A2H	;s
  58A6*   A3             C      	DB	0A3H	;t
  58A7*   A4             C      	DB	0A4H	;u
  58A8*   A5             C      	DB	0A5H	;v
  58A9*   A6             C      	DB	0A6H	;w
  58AA*   A7             C      	DB	0A7H	;x
  58AB*   A8             C      	DB	0A8H	;y
  58AC*   A9             C      	DB	0A9H	;z
  58AD*   C0             C      	DB	0C0H	;{
  58AE*   6A             C      	DB	6AH	;|
  58AF*   D0             C      	DB	0D0H	;}
  58B0*   A1             C      	DB	0A1H	;~
  58B1*   FF             C      	DB	0FFH	;DEL
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Komprimierung'
                         C      	PAGE
'Komprimierung'	MACRO-80 3.44	09-Dec-81	PAGE	1-18


                         C      
                         C      ;	PN	CP
                         C      ;**********************************************************************
                         C      ;*       COMPR:    Komprimierung                                      *
                         C      ;*                 EDIT - F/Q-Format   --->  MRES20 - Quelltextformat *
                         C      ;**********************************************************************
                         C      		             ;
  58B2*                  C      CP.COMPR	EQU	$    ; A  Uebergabe/-nahme Zeichen
                         C      		             ; HL: Status von COMPR
                         C      		             ; B:  dekr. Tabulator-Zaehler
                         C      		             ;-------------------------------
                         C      		             ; OUTA: Einzelzeichen-Ausgabe
                         C      		             ;         (Zeichen in Reg. A)
                         C      ;----------------------------------------------------------------------
                         C      		             ;
  58B2*   FE 1E          C      	CP	1EH          ; NL ?
  58B4*   28 01          C      	JR	Z,CP.NL
  58B6*   E9             C      	JP	(HL)
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      		             ; Status "New-Line"
                         C      		             ;-------------------------------
  58B7*                  C      CP.NL:
  58B7*   CD 5641*       C      	CALL	XY.INCDX     ;         Satz-Zaehler + 1
  58BA*   13             C      	DB	19
  58BB*   06 03          C      	LD	B,3          ;         noch 3 TAB erlaubt
  58BD*   3E 0A          C      	LD	A,0AH        ;         MRES20-NL
  58BF*   18 04          C      	JR	CP.OUTT
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      		             ; Status "String"
                         C      		             ;-------------------------------
  58C1*                  C      CP.STRNG:
  58C1*   FE 27          C      	CP	27H          ;         Apostroph
  58C3*   20 20          C      	JR	NZ,CP.OUT
                         C      		             ;
  58C5*                  C      CP.OUTT:
  58C5*   21 58D5*       C      	LD	HL,CP.TEXT   ;         --> Status "Text"
  58C8*   18 1B          C      	JR	CP.OUT
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      		             ; Status "Space"
                         C      		             ;-------------------------------
  58CA*                  C      CP.SPACE:
  58CA*   FE 20          C      	CP	' '
  58CC*   C8             C      	RET	Z
  58CD*   FE 09          C      	CP	09H          ;         Tabulator
  58CF*   C8             C      	RET	Z
  58D0*   21 58D5*       C      	LD	HL,CP.TEXT   ;         ---> Status "Text"
  58D3*   18 08          C      	JR	CP.TEXT+8
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      		             ; Status "Text"
                         C      		             ;-------------------------------
  58D5*                  C      CP.TEXT:
  58D5*   FE 20          C      	CP	' '
  58D7*   28 2E          C      	JR	Z,CP.TAB
  58D9*   FE 09          C      	CP	09H          ;         Tabulator
  58DB*   28 2A          C      	JR	Z,CP.TAB
  58DD*   FE 3B          C      	CP	';'
  58DF*   28 0B          C      	JR	Z,CP.SOKOM
  58E1*   FE 27          C      	CP	27H          ;         Apostroph
  58E3*   28 1D          C      	JR	Z,CP.SOSTR
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      		             ; Status "Kom"
                         C      		             ;-------------------------------
  58E5*                  C      CP.KOM	EQU	$
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      		             ; Einzelzeichen-Ausgabe u. Ret.
                         C      		             ;-------------------------------
  58E5*                  C      CP.OUT:
  58E5*   CD 61EB*       C      	CALL	UK.PUTK
  58E8*   D9             C      	EXX
  58E9*   0B             C      	DEC	BC
  58EA*   D9             C      	EXX
  58EB*   C9             C      	RET
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      		             ; Start "Kommentar"
                         C      		             ;-------------------------------
'Komprimierung'	MACRO-80 3.44	09-Dec-81	PAGE	1-19


  58EC*                  C      CP.SOKOM:
  58EC*   78             C      	LD	A,B          ;         0 oder 3 TAB vorher
  58ED*   FE 03          C      	CP	3
  58EF*   28 0A          C      	JR	Z,$+12
  58F1*   B7             C      	OR	A
  58F2*   28 07          C      	JR	Z,$+9        ;         ---+
  58F4*   3E 09          C      	LD	A,09H        ;         <-+|
  58F6*   CD 58E5*       C      	CALL	CP.OUT       ;           ||
  58F9*   10 F9          C      	DJNZ	$-5          ;         --+|
  58FB*   3E 3B          C      	LD	A,';'        ;         <--+
  58FD*   21 58E5*       C      	LD	HL,CP.KOM
  5900*   18 E3          C      	JR	CP.OUT
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      		             ; Start "String"
                         C      		             ;-------------------------------
  5902*                  C      CP.SOSTR:
  5902*   21 58C1*       C      	LD	HL,CP.STRNG
  5905*   18 DE          C      	JR	CP.OUT
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      		             ; Tabulator-Behandlung
                         C      		             ;-------------------------------
  5907*                  C      CP.TAB:
  5907*   78             C      	LD	A,B
  5908*   B7             C      	OR	A
  5909*   3E 20          C      	LD	A,' '
  590B*   28 D8          C      	JR	Z,CP.OUT
  590D*   05             C      	DEC	B
  590E*   3E 09          C      	LD	A,09H        ;         Tabulator MRES20
  5910*   21 58CA*       C      	LD	HL,CP.SPACE
  5913*   18 D0          C      	JR	CP.OUT
                         C      		             ;
                         C      ;**********************************************************************
                         C      		             ;
  5915*                  C      CP.INIT:
  5915*   06 03          C      	LD	B,3          ; Initialisierung COMPR
  5917*   21 58D5*       C      	LD	HL,CP.TEXT
  591A*   C9             C      	RET
                         C      		             ;
                         C      ;**********************************************************************
                         C      ;	END
                         C      	TITLE	'Dekomprimierung'
                         C      	PAGE
'Dekomprimierung'	MACRO-80 3.44	09-Dec-81	PAGE	1-20


                         C      
                         C      ;	PN	DC
                         C      ;**********************************************************************
                         C      ;*       DCMPR:    Dekomprimierung                                    *
                         C      ;*                 MRES20-Quelltexte   --->   EDIT - Format F         *
                         C      ;**********************************************************************
                         C      		             ;
  591B*                  C      DC.DCMPR	EQU	$
                         C      		             ; A:  Uebergabe/-nahme Zeichen
                         C      		             ; HL: Status-Register DCMPR
                         C      		             ; B:  Position (Spalte)
                         C      		             ;-------------------------------
                         C      		             ; INA: Einzelzeichen-Eingabe
                         C      		             ;      nach Reg. A
                         C      ;        --------------------------------------------------------------
  591B*   04             C      	INC	B            ;         Position + 1
  591C*   E9             C      	JP	(HL)
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      		             ; Status "Neue Zeile"
                         C      		             ;-------------------------------
  591D*                  C      DC.NL:
  591D*   CD 5641*       C      	CALL	XY.INCDX     ;         Satzzaehler + 1
  5920*   13             C      	DB	19
  5921*   3E 1E          C      	LD	A,1EH        ;         EDIT-New-Line
  5923*   06 01          C      	LD	B,1          ;         Pos.=1
  5925*   21 5929*       C      	LD	HL,DC.TEXT   ;         Status "TEXT"
  5928*   C9             C      	RET
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      		             ; Status "Text"
                         C      		             ;-------------------------------
  5929*                  C      DC.TEXT:
  5929*   CD 6147*       C      	CALL	UK.GETK      ;         Einzelzeichen-Eingabe
  592C*   B7             C      	OR	A
  592D*   C8             C      	RET	Z
  592E*   FE 0A          C      	CP	0AH          ;         NL ?
  5930*   28 EB          C      	JR	Z,DC.NL
  5932*   FE 09          C      	CP	09H          ;         TAB ?
  5934*   28 01          C      	JR	Z,DC.TAB
  5936*   C9             C      	RET
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      		             ; Tabulator-Behandlung
                         C      		             ;-------------------------------
  5937*                  C      DC.TAB:
  5937*   78             C      	LD	A,B
  5938*   FE 28          C      	CP	40
  593A*   D0             C      	RET	NC
  593B*   21 5941*       C      	LD	HL,DC.SPACE  ;         ---> Status "Space"
  593E*   3E 20          C      	LD	A,' '        ;         anstelle TAB Space
  5940*   C9             C      	RET
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      		             ; Status "Space"
                         C      		             ;-------------------------------
  5941*                  C      DC.SPACE:
  5941*   78             C      	LD	A,B
  5942*   FE 0B          C      	CP	10+1
  5944*   28 0B          C      	JR	Z,DC.EOSPC
  5946*   FE 11          C      	CP	16+1
  5948*   28 07          C      	JR	Z,DC.EOSPC
  594A*   FE 24          C      	CP	35+1
  594C*   28 03          C      	JR	Z,DC.EOSPC
  594E*   3E 20          C      	LD	A,' '
  5950*   C9             C      	RET
                         C      		             ;
  5951*                  C      DC.EOSPC:
  5951*   21 5929*       C      	LD	HL,DC.TEXT   ; TAB-Position erreicht
  5954*   18 D3          C      	JR	DC.TEXT
                         C      		             ;
                         C      		             ;
                         C      ;**********************************************************************
  5956*                  C      DC.INIT:
  5956*   21 5929*       C      	LD	HL,DC.TEXT   ; Initialisierung
  5959*   06 01          C      	LD	B,1
  595B*   C9             C      	RET
                         C      		             ;
                         C      ;**********************************************************************
                         C      ;	END
                         C      	TITLE 'Routinen fuer Monitor UND Tastatur'
                         C      	PAGE
'Routinen fuer Monitor UND Tastatur'	MACRO-80 3.44	09-Dec-81	PAGE	1-21


                         C      
  595C*                  C      UR.MIMO:
  595C*   D5             C      	PUSH	DE           ;Register DE, BC retten
  595D*   C5             C      	PUSH	BC
  595E*   46             C      	LD	B,(HL)       ;Anzahl einzugebender Zeichen
  595F*   23             C      	INC	HL
  5960*   4E             C      	LD	C,(HL)       ;Laenge der Zeichenkette
  5961*   23             C      	INC	HL
  5962*   5E             C      	LD	E,(HL)       ;Zeichenschluessel
  5963*   23             C      	INC	HL
  5964*   3A 2B00*       C      	LD	A,(UB.ZN)    ;Zeilennummer
  5967*   57             C      	LD	D,A          ;D:= Zeilennummer
  5968*   AF             C      	XOR	A
  5969*   B9             C      	CP	C
  596A*   28 0C          C      	JR	Z,UR.MIMO1   ;Anzeige entfaellt
  596C*   D5             C      	PUSH	DE
  596D*   CD 599E*       C      	CALL	UR.DSPZK     ;Anzeige
  5970*                  C      UR.MIMO2:
  5970*   D1             C      	POP	DE
  5971*   CD 59AB*       C      	CALL	UR.ZINP	     ;Zeicheneingabe ueber Tastatur
  5974*   C1             C      	POP	BC
  5975*   D1             C      	POP	DE
  5976*   18 07          C      	JR	UR.MIMO3
  5978*                  C      UR.MIMO1:
  5978*   D5             C      	PUSH	DE
  5979*   CD 598E*       C      	CALL	UR.BBSAD     ;BWS - Adresse berechnen
  597C*   EB             C      	EX	DE,HL        ;HL:= akt. Bildschirmposition
  597D*   18 F1          C      	JR	UR.MIMO2
  597F*                  C      UR.MIMO3:
  597F*   F5             C      	PUSH	AF
  5980*   3A 2B00*       C      	LD	A,(UB.ZN)
  5983*   3C             C      	INC	A
  5984*   FE 18          C      	CP	24
  5986*   CC 5A8E*       C      	CALL	Z,UR.BILRO   ;Zeile 24 ---> Bild rollen
  5989*   32 2B00*       C      	LD	(UB.ZN),A
  598C*   F1             C      	POP	AF
  598D*   C9             C      	RET
  598E*                  C      UR.BBSAD:
  598E*   E5             C      	PUSH	HL           ;Berechnung der BWS-Adresse
  598F*   C5             C      	PUSH	BC           ;IN:    D...Zeilennummer
  5990*   21 2FB0        C      	LD	HL,UE.BWSA-80;OUT:   DE..BWS-Adresse
  5993*   01 0050        C      	LD	BC,80        ;BC:= Zeichen/Zeile
  5996*                  C      UR.BBSA1:
  5996*   09             C      	ADD	HL,BC
  5997*   15             C      	DEC	D
  5998*   20 FC          C      	JR	NZ,UR.BBSA1
  599A*   EB             C      	EX	DE,HL
  599B*   C1             C      	POP	BC
  599C*   E1             C      	POP	HL
  599D*   C9             C      	RET
  599E*                  C      UR.DSPZK:
  599E*   D5             C      	PUSH	DE           ;Anzeige
  599F*   C5             C      	PUSH	BC           ;IN   HL...Anfangsadresse ZK
  59A0*   CD 598E*       C      	CALL	UR.BBSAD     ;      D...Zeilennummer
  59A3*   06 00          C      	LD	B,0          ;      C...Zeichenkettenlaenge
  59A5*   ED B0          C      	LDIR	             ;OUT  HL...akt. BWS-Adresse
  59A7*   EB             C      	EX	DE,HL
  59A8*   C1             C      	POP	BC
  59A9*   D1             C      	POP	DE
  59AA*   C9             C      	RET
  59AB*                  C      UR.ZINP:
  59AB*   E5             C      	PUSH	HL           ;Zeicheneingabe ueber Tastatur
  59AC*   AF             C      	XOR	A            ;IN    B...Zeichenanzahl (max.)
  59AD*   50             C      	LD	D,B          ;     HL...akt. Adresse
  59AE*   B8             C      	CP	B            ;      E...Zeichenschluessel
  59AF*   28 3D          C      	JR	Z,UR.RET0    ;keine Zeicheneingabe
  59B1*                  C      UR.ZINP1:
  59B1*   CD 4033        C      	CALL	SY.SETCHL    ;Kursor setzen
  59B4*                  C      UR.ZINP2:
  59B4*   CD 5A88*       C      	CALL	UR.TAREP     ;Tastaturabfrage
  59B7*   CD 59F8*       C      	CALL	UR.TCL       ; <---
  59BA*   CD 5A0D*       C      	CALL	UR.TCR       ; --->
  59BD*   CD 5A20*       C      	CALL	UR.TSYS      ; SYS
  59C0*   CD 5A28*       C      	CALL	UR.TQUIT     ; POS.QUIT
  59C3*   CD 5A30*       C      	CALL	UR.ZKONT     ;Zeichenkontrolle
  59C6*   CD 4036        C      	CALL	SY.RESC      ;Kursor loeschen
  59C9*   77             C      	LD	(HL),A       ;Zeichen anzeigen
  59CA*   23             C      	INC	HL           ;akt. Adresse erhoehen
  59CB*   10 E4          C      	DJNZ	UR.ZINP1     ;B > 0, naechstes Zeichen
  59CD*   CD 4033        C      	CALL	SY.SETCHL    ;Kursor setzen
  59D0*                  C      UR.ZINP5:
  59D0*   CD 5A88*       C      	CALL	UR.TAREP
'Routinen fuer Monitor UND Tastatur'	MACRO-80 3.44	09-Dec-81	PAGE	1-22


  59D3*   FE F7          C      	CP	UE.TACL
  59D5*   CC 59F1*       C      	CALL	Z,UR.ZINP7
  59D8*   FE 1E          C      	CP	UE.TAQUI
  59DA*   28 06          C      	JR	Z,UR.ZINP3   ;---> POS.QUIT
  59DC*   FE CD          C      	CP	UE.TASYS
  59DE*   28 08          C      	JR	Z,UR.ZINP4   ;---> SYS
  59E0*   18 EE          C      	JR	UR.ZINP5
  59E2*                  C      UR.ZINP3:
  59E2*   CD 4036        C      	CALL	SY.RESC      ;Kursor loeschen
  59E5*   E1             C      	POP	HL           ;BWS - Adresse auskellern
  59E6*   AF             C      	XOR	A            ;CY:= 0
  59E7*   C9             C      	RET
  59E8*                  C      UR.ZINP4:
  59E8*   CD 4036        C      	CALL	SY.RESC      ;Kursor loeschen
  59EB*   E1             C      	POP	HL
  59EC*   37             C      	SCF	             ;CY:= 1
  59ED*   C9             C      	RET
  59EE*                  C      UR.RET0:
  59EE*   E1             C      	POP	HL           ;keine Zeicheneingabe
  59EF*   AF             C      	XOR	A
  59F0*   C9             C      	RET
  59F1*                  C      UR.ZINP7:
  59F1*   CD 59F8*       C      	CALL	UR.TCL
  59F4*   33             C      	INC	SP
  59F5*   33             C      	INC	SP
  59F6*   18 BC          C      	JR	UR.ZINP2
  59F8*                  C      UR.TCL:
  59F8*   FE F7          C      	CP	UE.TACL      ;   <---
  59FA*   C0             C      	RET	NZ           ;Taste nicht gedrueckt
  59FB*   F5             C      	PUSH	AF           ;Tastencode retten
  59FC*   04             C      	INC	B
  59FD*   7A             C      	LD	A,D
  59FE*   B8             C      	CP	B
  59FF*   38 09          C      	JR	C,UR.TCLN    ;Linksbewegung nicht zulaessig
  5A01*   CD 4036        C      	CALL	SY.RESC      ;Kursor loeschen
  5A04*   2B             C      	DEC	HL           ;BWS - Adresse decrementieren
  5A05*   CD 4033        C      	CALL	SY.SETCHL    ;Kursor setzen
  5A08*   F1             C      	POP	AF           ;Code auskellern
  5A09*   C9             C      	RET
  5A0A*                  C      UR.TCLN:
  5A0A*   05             C      	DEC	B
  5A0B*   F1             C      	POP	AF
  5A0C*   C9             C      	RET
  5A0D*                  C      UR.TCR:
  5A0D*   FE F9          C      	CP	UE.TACR      ;   --->
  5A0F*   C0             C      	RET	NZ
  5A10*   F5             C      	PUSH	AF
  5A11*   78             C      	LD	A,B
  5A12*   FE 02          C      	CP	2
  5A14*   38 08          C      	JR	C,UR.TCRN
  5A16*   05             C      	DEC	B
  5A17*   CD 4036        C      	CALL	SY.RESC
  5A1A*   23             C      	INC	HL
  5A1B*   CD 4033        C      	CALL	SY.SETCHL
  5A1E*                  C      UR.TCRN:
  5A1E*   F1             C      	POP	AF
  5A1F*   C9             C      	RET
  5A20*                  C      UR.TSYS:
  5A20*   FE CD          C      	CP	UE.TASYS     ; SYS-Taste
  5A22*   C0             C      	RET	NZ
  5A23*   33             C      	INC	SP
  5A24*   33             C      	INC	SP           ;Returnadresse uebergehen
  5A25*   C3 59E8*       C      	JP	UR.ZINP4
  5A28*                  C      UR.TQUIT:
  5A28*   FE 1E          C      	CP	UE.TAQUI     ; POS.QUIT
  5A2A*   C0             C      	RET	NZ
  5A2B*   33             C      	INC	SP
  5A2C*   33             C      	INC	SP
  5A2D*   C3 59E2*       C      	JP	UR.ZINP3
  5A30*                  C      UR.ZKONT:
  5A30*   FE 7F          C      	CP	7FH
  5A32*   30 22          C      	JR	NC,UR.ZKON1
  5A34*   CB 7B          C      	BIT	7,E          ;Zeichenschluesselauswertung
  5A36*   C0             C      	RET	NZ           ;Bit 7 = L, alle Tasten erlaubt
  5A37*   FE 20          C      	CP	20H
  5A39*   C8             C      	RET	Z            ;Leertaste
  5A3A*   CB 6B          C      	BIT	5,E
  5A3C*   37             C      	SCF
  5A3D*   C4 5A5B*       C      	CALL	NZ,UR.ALPHA
  5A40*   D0             C      	RET	NC           ;Bit 5 = L, nur Buchstaben
  5A41*   CB 63          C      	BIT	4,E
  5A43*   37             C      	SCF
  5A44*   C4 5A66*       C      	CALL	NZ,UR.NUM
'Routinen fuer Monitor UND Tastatur'	MACRO-80 3.44	09-Dec-81	PAGE	1-23


  5A47*   D0             C      	RET	NC           ;Bit 4 = L, nur Ziffern
  5A48*   CB 73          C      	BIT	6,E
  5A4A*   37             C      	SCF
  5A4B*   C4 5A6F*       C      	CALL	NZ,UR.ALPNU
  5A4E*   D0             C      	RET	NC           ;Bit 6 = L, Buchstaben und
                         C      		             ;            Ziffern
  5A4F*   CB 5B          C      	BIT	3,E
  5A51*   37             C      	SCF
  5A52*   C4 5A79*       C      	CALL	NZ,UR.HEXAZ
  5A55*   D0             C      	RET	NC           ;BIT 3 = L ,HEXAZEICHEN
  5A56*                  C      UR.ZKON1:
  5A56*   33             C      	INC	SP
  5A57*   33             C      	INC	SP
  5A58*   C3 59B4*       C      	JP	UR.ZINP2     ;unerlaubter Tastencode
  5A5B*                  C      UR.ALPHA:
  5A5B*   FE 41          C      	CP	41H
  5A5D*   D8             C      	RET	C
  5A5E*   FE 5B          C      	CP	5BH
  5A60*   38 02          C      	JR	C,UR.ALPH1
  5A62*   37             C      	SCF
  5A63*   C9             C      	RET
  5A64*                  C      UR.ALPH1:
  5A64*   3F             C      	CCF
  5A65*   C9             C      	RET
  5A66*                  C      UR.NUM:
  5A66*   FE 30          C      	CP	30H
  5A68*   D8             C      	RET	C
  5A69*   FE 3A          C      	CP	3AH
  5A6B*   38 F7          C      	JR	C,UR.ALPH1
  5A6D*   37             C      	SCF
  5A6E*   C9             C      	RET
  5A6F*                  C      UR.ALPNU:
  5A6F*   CD 5A5B*       C      	CALL	UR.ALPHA
  5A72*   D0             C      	RET	NC
  5A73*   CD 5A66*       C      	CALL	UR.NUM
  5A76*   D0             C      	RET	NC
  5A77*   37             C      	SCF
  5A78*   C9             C      	RET
  5A79*                  C      UR.HEXAZ:
  5A79*   CD 5A66*       C      	CALL	UR.NUM
  5A7C*   D0             C      	RET	NC
  5A7D*   FE 41          C      	CP	'A'
  5A7F*   D8             C      	RET	C
  5A80*   FE 47          C      	CP	'G'
  5A82*   38 02          C      	JR	C,UR.HEXZ1
  5A84*   37             C      	SCF
  5A85*   C9             C      	RET
  5A86*                  C      UR.HEXZ1:
  5A86*   3F             C      	CCF
  5A87*   C9             C      	RET
                         C      
  5A88*                  C      UR.TAREP:
  5A88*   CD 4026        C      	CALL	TA.ABFR1     ;TASTATURROUTINE FUER ATS
  5A8B*   28 FB          C      	JR	Z,$-3        ;ES LIEGT KEIN ZEICHEN AN
  5A8D*   C9             C      	RET
                         C      
  5A8E*                  C      UR.BILRO:
  5A8E*   C5             C      	PUSH	BC
  5A8F*   D5             C      	PUSH	DE
  5A90*   E5             C      	PUSH	HL
  5A91*   01 03C0        C      	LD	BC,960
  5A94*   11 3370        C      	LD	DE,UE.BWSA+880
  5A97*   21 33C0        C      	LD	HL,UE.BWSA+960
  5A9A*   ED B0          C      	LDIR
  5A9C*   3E 20          C      	LD	A,20H        ;letzte Zeile loeschen
  5A9E*   06 50          C      	LD	B,80
  5AA0*                  C      UR.BILR1:
  5AA0*   12             C      	LD	(DE),A
  5AA1*   10 FD          C      	DJNZ	UR.BILR1
  5AA3*   E1             C      	POP	HL
  5AA4*   AF             C      	XOR	A
  5AA5*   01 0050        C      	LD	BC,80
  5AA8*   ED 42          C      	SBC	HL,BC        ;aktuelle BWS-Adresse nach  ROLL
  5AAA*   3A 2B00*       C      	LD	A,(UB.ZN)
  5AAD*   D1             C      	POP	DE
  5AAE*   C1             C      	POP	BC
  5AAF*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                                ;
                                ;	INCLUDE K1.MAC	;BAMOS/Emulator  ---  Kassettenmagnetband
                                ;	INCLUDE	KR.MAC	;Kassettengrundroutinen
                                ;	INCLUDE	UF.MAC	;Fehleranzeige und Behandlung
'Routinen fuer Monitor UND Tastatur'	MACRO-80 3.44	09-Dec-81	PAGE	1-24


                                ;	INCLUDE	UA.MAC	;Ausschriften
                                ;	INCLUDE UR.MAC	;Routinen fuer Kassette
                                ;	INCLUDE	UK.MAC	;Einzelzeicheneingabe fuer KMBG
                         C      	INCLUDE K2.MAC	;BAMOS/Emulator  ---  Kassettenmagnetband
                         C      	TITLE 'BAMOS/Emulator  ---  Kassettenmagnetband'
                         C      	PAGE
'BAMOS/Emulator  ---  Kassettenmagnetband'	MACRO-80 3.44	09-Dec-81	PAGE	1-25


                         C      
                         C      ;****************************************************************
                         C      ;*               BAMOS/Emulator  ---  Kassettenmagnetband       *
                         C      ;* OS - Version  -----------------------------------------------*
                         C      ;*               Programmierer: Marcus Herbote                  *
                         C      ;* V 1 . 2       -----------------------------------------------*
                         C      ;*               Stand        : 18.November 2022                *
                         C      ;****************************************************************
                         C      
                         C      ;****************************************************************
                         C      ;*               BAMOS/Robotron         Stand: 01.Januar 1981   *
                         C      ;*               -----------------------------------------------*
                         C      ;*               Geraetebedienroutine fuer Kassettenmagnetband  *
                         C      ;*               Anschluss von zwei Laufwerken K5200            *
                         C      ;*               an einer AKB K5020                             *
                         C      ;*               -----------------------------------------------*
                         C      ;*               E/A-Tabelle                                    *
                         C      ;*               Byte -2   HS-Bereich                           *
                         C      ;*               Byte -1   laenge der Daten im Puffer           *
                         C      ;*                         1, 10H, 20H, 80H                     *
                         C      ;*               -----------------------------------------------*
                         C      ;*               Byte  0   Status                               *
                         C      ;*               Byte  1   Fehlerschluessel                     *
                         C      ;*               Byte  2   Basisadresse der AKB                 *
                         C      ;*               Byte  3   Subadresse                           *
                         C      ;*               Byte  4   Kommando                             *
                         C      ;*               Byte  5   L-Teil Adresse Eintrittspunkt        *
                         C      ;*               Byte  6   H-Teil Adresse Eintrittspunkt        *
                         C      ;*               Byte  7   L-Teil Blockadresse                  *
                         C      ;*               Byte  8   H-Teil Blockadresse                  *
                         C      ;*               Byte  9   H-Teil Blocklaenge (Bit 15...Bit 8)  *
                         C      ;*               Byte 10   L-Teil Blocklaenge (Bit  7...Bit 0)  *
                         C      ;*                         n      bei suchen Bandmarke          *
                         C      ;*               Byte 11   Anzahl Lese-/Schreib wiederholen     *
                         C      ;*               Byte 12   Anzahl Blocklueckenverlaengerungen   *
                         C      ;****************************************************************
                         C      ;*               Bytes fuer die Uebergabe an den Z80-Emulator   *
                         C      ;*               -----------------------------------------------*
                         C      ;*               Byte 28 1 0F0H  Startbyte                      *
                         C      ;*               Byte 29 2       Kommando                       *
                         C      ;*               Byte 30 3       Subadresse                     *
                         C      ;*               Byte 31 4       Anzahl BM  bei 71, 75          *
                         C      ;*               Byte 31 4       'B'        bei 51              *
                         C      ;*               Byte 31 4       'S'        bei 61              *
                         C      ;*               Byte 31 4       HS-Bereich bei 02              *
                         C      ;*               Byte 31 4       Laenge     bei 08              *
                         C      ;*               Byte 31 4 0FFH             bei 31,41,21,11,15  *
                         C      ;*               Byte 32 5       H(Puffer)  bei 02              *
                         C      ;*               Byte 32 5       HS-Bereich bei 08              *
                         C      ;*               Byte 32 5 0FFH             bei 51,61,71,75     *
                         C      ;*               Byte 33 6       L(Puffer)  bei 02              *
                         C      ;*               Byte 33 6       H(Puffer)  bei 08              *
                         C      ;*               Byte 34 7       L(Puffer)  bei 08              *
                         C      ;*               Byte 34 7 0FFH             bei 02              *
                         C      ;*               Byte 35 8 0FFH             bei 08              *
                         C      ;****************************************************************
                         C      ;*               Kommandos:                                     *
                         C      ;*                 Hex   Kommando                               *
                         C      ;*                 02    naechsten Record einlesen              *
                         C      ;*                 08    naechsten Record schreiben             *
                         C      ;*                 18    MRES-Verzeichniseintrag schreiben      *
                         C      ;*                 11    einen Block vorsetzen                  *
                         C      ;*                 15    einen Block ruecksetzen                *
                         C      ;*                 21    umspulen                               *
                         C      ;*                 31    reservieren ein                        *
                         C      ;*                 41    reservieren aus                        *
                         C      ;*                 51    schreiben einer Bandmarke              *
                         C      ;*                 61    schreiben Schlussluecke                *
                         C      ;*                 71    suche n-te Bandmarke vorwaerts         *
                         C      ;*                 75    suche n-te Bandmarke rueckwaerts       *
                         C      ;****************************************************************
                         C      	PAGE
'BAMOS/Emulator  ---  Kassettenmagnetband'	MACRO-80 3.44	09-Dec-81	PAGE	1-26


                         C      
                         C      ;****************************************************************
                         C      ;*               Status                                         *
                         C      ;*               Bit 0     0 Geraet frei                        *
                         C      ;*                         1 Geraet besetzt                     *
                         C      ;*               Bit 1     0                                    *
                         C      ;*                         1 Datentraegerende                   *
                         C      ;*               Bit 2     0 Aufzeichnen erlaubt                *
                         C      ;*                         1 Aufzeichnen verboten               *
                         C      ;*               Bit 3     0 Kassettenseite A                   *
                         C      ;*                         1 Kassettenseite B                   *
                         C      ;*               Bit 4     0 Geraet       bereit                *
                         C      ;*                         1 Geraet nicht bereit                *
                         C      ;*               Bit 5     0 Geraet nicht reserviert            *
                         C      ;*                         1 Geraet       reserviert            *
                         C      ;*               Bit 6     0 Aufzeichnungsverf.  38 CM*S**-1    *
                         C      ;*                         1 Aufzeichnungsverf.  19 CM*S**-1    *
                         C      ;*               Bit 7     0 Kommando fehlerfrei ausgefuehrt    *
                         C      ;*                         1 Fehler (siehe Fehlerschluessel)    *
                         C      ;*               -----------------------------------------------*
                         C      ;*               Fehlerschluessel                               *
                         C      ;*                 Hex   Fehler                                 *
                         C      ;*                 10    falsches Kommando                      *
                         C      ;*                 11    angewaehltes Geraet nicht reserviert   *
                         C      ;*                 12    Subadresse falsch                      *
                         C      ;*                 13    Pufferl. kleiner 12 oder groesser 256  *
                         C      ;*                 14    Ende der Aufzeichnungen auf dieser     *
                         C      ;*                       Kassettenseite (Lesen)                 *
                         C      ;*                 15    angewaehltes Geraet besetzt            *
                         C      ;*                 16    Ende/Anfang der Aufzeichnungen         *
                         C      ;*                       (Bandmarke suchen)                     *
                         C      ;*                 17    gelesener Block laenger 260 Byte       *
                         C      ;*                 18    Bandmarke nicht gefunden               *
                         C      ;*                 19    Aufzeichnen verboten                   *
                         C      ;*                       (mit Kommando: Aufzeichnen)            *
                         C      ;*               -----------------------------------------------*
                         C      ;*               nachfolgende Codes nicht bei DEG2000-Emulator  *
                         C      ;*                 21    Fehler nach festgelegter Anzahl        *
                         C      ;*                       Lesewiederholungen                     *
                         C      ;*                 22    Fehler nach festgelegter Anzahl        *
                         C      ;*                       Schreibwiederholungen                  *
                         C      ;*                 23    kein Echosignal vom Eingabekanal       *
                         C      ;*                       bei  RAW                               *
                         C      ;****************************************************************
                         C      ;*               Hinweise zur Arbeit mit der Geraetebedienr.    *
                         C      ;*                - E/A-Tabelle laden (Basisadresse AKB)        *
                         C      ;*                - Adresse E/A-Tabelle in IX laden             *
                         C      ;*                - laden Schluessel fuer Kommando , Subadresse *
                         C      ;*                    Adresse Eintrittspunkt                    *
                         C      ;*                - Aufruf Geraetebedienroutine immer mit       *
                         C      ;*                    CALL   KR.BRKMB                           *
                         C      ;*                - wird keine Parallelarbeit mit anderen       *
                         C      ;*                  Programmen gewuenscht , kann wie in         *
                         C      ;*                  folgendem Beispiel verfahren werden:        *
                         C      ;*                        ...                                   *
                         C      ;*                        CALL KR.BRKMB ;Aufruf                 *
                         C      ;*                  MARKE:HALT                                  *
                         C      ;*                        JR   MARKE-#                          *
                         C      ;*                  ADREP:............  ;Adresse Eintrittspunkt *
                         C      ;*                        ...                                   *
                         C      ;*                - bei Rueckkehr der Bedienroutine zum Ein-    *
                         C      ;*                  trittspunkt ist die Adresse des folgenden   *
                         C      ;*                  Befehls , bei dem der letzte Interrupt      *
                         C      ;*                  angenommen wurde , noch im SP .             *
                         C      ;*                  Wird , wie im obigen Beispiel , diese       *
                         C      ;*                  Adresse nicht mehr benoetigt , so ist der   *
                         C      ;*                  SP  um 2 zu erhoehen.                       *
                         C      ;****************************************************************
                         C      	TITLE	'Steuerteil Geraetebedienroutine'
                         C      	PAGE
'Steuerteil Geraetebedienroutine'	MACRO-80 3.44	09-Dec-81	PAGE	1-27


                         C      
                         C      ;****************************************************************
                         C      ;*               Steuerteil der Geraetebedienroutine            *
                         C      ;****************************************************************
  5AB0*                  C      K1.BRKMB:
  5AB0*   F3             C          DI
  5AB1*   CD 5B9D*       C          CALL    RRET
                         C      
                         C      ;****************************************************************
                         C      ;*               Analyse Kommando                               *
                         C      ;****************************************************************
  5AB4*   DD 7E 04       C          LD  A,(IX+4)
  5AB7*   FE 02          C          CP  002H    ;naechsten Record einlesen
  5AB9*   CA 5B4D*       C          JP  Z,STT02
  5ABC*   FE 08          C          CP  008H    ;naechsten Record schreiben
  5ABE*   CA 5B6B*       C          JP  Z,STT08
  5AC1*   FE 18          C          CP  018H    ;MRES-Verzeichniseintrag schreiben
  5AC3*   CA 5B6B*       C          JP  Z,STT08
  5AC6*   FE 11          C          CP  011H    ;einen Block vorsetzen
  5AC8*   CA 5B27*       C          JP  Z,STT11
  5ACB*   FE 15          C          CP  015H    ;einen Block ruecksetzen
  5ACD*   CA 5B27*       C          JP  Z,STT15
  5AD0*   FE 21          C          CP  021H    ;umspulen
  5AD2*   CA 5B27*       C          JP  Z,STT21
  5AD5*   FE 31          C          CP  031H    ;reservieren ein
  5AD7*   CA 5B27*       C          JP  Z,STT31
  5ADA*   FE 41          C          CP  041H    ;reservieren aus
  5ADC*   CA 5B27*       C          JP  Z,STT41
  5ADF*   FE 51          C          CP  051H    ;schreiben einer Bandmarke
  5AE1*   CA 5B33*       C          JP  Z,STT51
  5AE4*   FE 61          C          CP  061H    ;schreiben Schlussluecke
  5AE6*   CA 5B37*       C          JP  Z,STT61
  5AE9*   FE 71          C          CP  071H    ;suche n-te Bandmarke vorwaerts
  5AEB*   CA 5B3B*       C          JP  Z,STT71
  5AEE*   FE 75          C          CP  075H    ;suche n-te Bandmarke rueckwaerts
  5AF0*   CA 5B3B*       C          JP  Z,STT75
  5AF3*   C3 5B99*       C          JP  STF07   ;falsches Kommando
                         C      
                         C      ;****************************************************************
                         C      ;*               Kernroutine MB                                 *
                         C      ;*               -----------------------------------------------*
                         C      ;*               Schnittstelle zum DEG2000 - Emulator           *
                         C      ;****************************************************************
  5AF6*                  C      K1.KERN:
  5AF6*   DD 36 1C F0    C          LD  (IX+28),0F0H
  5AFA*   DD 7E 04       C          LD  A,(IX+4)    ;Kommando
  5AFD*   DD 77 1D       C          LD  (IX+29),A
  5B00*   DD 7E 03       C          LD  A,(IX+3)    ;Subadresse
  5B03*   DD 77 1E       C          LD  (IX+30),A
                         C      
  5B06*   DD 4E 02       C          LD  C,(IX+2)    ;Basisadresse der AKB
  5B09*   DD E5          C          PUSH    IX
  5B0B*   E1             C          POP HL
  5B0C*   11 001C        C          LD  DE,28
  5B0F*   19             C          ADD  HL,DE
  5B10*   ED B3          C          OTIR            ;KM - Routine aufrufen
  5B12*   DD E5          C          PUSH    IX
  5B14*   E1             C          POP HL
  5B15*   2B             C          DEC HL
  5B16*   2B             C          DEC HL
  5B17*   06 04          C          LD  B,4
  5B19*   ED B2          C          INIR            ;Status und Fehler holen
  5B1B*   2B             C          DEC HL          ;Laenge der Daten im Puffer holen
  5B1C*   2B             C          DEC HL
  5B1D*   2B             C          DEC HL
  5B1E*   DD 36 09 00    C          LD  (IX+9),0
  5B22*   7E             C          LD  A,(HL)
  5B23*   DD 77 0A       C          LD  (IX+10),A
  5B26*   C9             C          RET
                         C          TITLE   '4-/5-Byte IO-Kommandos'
                         C          PAGE
'4-/5-Byte IO-Kommandos'	MACRO-80 3.44	09-Dec-81	PAGE	1-28


                         C      
                         C      ;****************************************************************
                         C      ;*               reservieren ein / aus                          *
                         C      ;****************************************************************
  5B27*                  C      STT31:
  5B27*                  C      STT41:
                         C      ;****************************************************************
                         C      ;*               umspulen                                       *
                         C      ;****************************************************************
  5B27*                  C      STT21:
                         C      ;****************************************************************
                         C      ;*               vor-/ruecksetzen um einen Block                *
                         C      ;****************************************************************
  5B27*                  C      STT11:
  5B27*                  C      STT15:
  5B27*   DD 36 1F FF    C          LD  (IX+31),0FFH
                         C      
  5B2B*   06 04          C          LD  B,4
  5B2D*   CD 5AF6*       C          CALL K1.KERN
  5B30*   C3 5BAA*       C          JP	KOMED	;Kommandoende
                         C      
                         C      ;****************************************************************
                         C      ;*               schreiben einer Bandmarke                      *
                         C      ;****************************************************************
  5B33*                  C      STT51:
  5B33*   3E 42          C          LD  A,'B'
  5B35*   18 07          C          JR  STT5
                         C      ;****************************************************************
                         C      ;*               schreiben einer Schlussluecke                  *
                         C      ;****************************************************************
  5B37*                  C      STT61:
  5B37*   3E 53          C          LD  A,'S'
  5B39*   18 03          C          JR  STT5
                         C      ;****************************************************************
                         C      ;*               suche Bandmarke vorwaerts / rueckwaerts        *
                         C      ;****************************************************************
  5B3B*                  C      STT71:
  5B3B*                  C      STT75:
  5B3B*   DD 7E 0A       C          LD  A,(IX+10)	;Anzahl Bandmarken
                         C      
  5B3E*                  C      STT5:
  5B3E*   DD 77 1F       C          LD  (IX+31),A
  5B41*   DD 36 20 FF    C          LD  (IX+32),0FFH
                         C      
  5B45*   06 05          C          LD  B,5
  5B47*   CD 5AF6*       C          CALL K1.KERN
  5B4A*   C3 5BAA*       C          JP	KOMED	;Kommandoende
                         C      
                         C          TITLE   '7-/8-Byte IO-Kommandos'
                         C          PAGE
'7-/8-Byte IO-Kommandos'	MACRO-80 3.44	09-Dec-81	PAGE	1-29


                         C      
                         C      ;****************************************************************
                         C      ;*               Eingabezweig                                   *
                         C      ;****************************************************************
  5B4D*                  C      STT02:
  5B4D*   3A 2B01*       C          LD  A,(K0.HSB)   ;HS-Bereich
  5B50*   DD 77 1F       C          LD  (IX+31),A
                         C      
  5B53*   DD 7E 08       C          LD  A,(IX+8)
  5B56*   DD 77 20       C          LD  (IX+32),A
  5B59*   DD 7E 07       C          LD  A,(IX+7)
  5B5C*   DD 77 21       C          LD  (IX+33),A
                         C      
  5B5F*   DD 36 22 FF    C          LD  (IX+34),0FFH
                         C      
  5B63*   06 07          C          LD  B,7
  5B65*   CD 5AF6*       C          CALL K1.KERN
  5B68*   C3 5BAA*       C          JP	KOMED	;Kommandoende
                         C      
                         C      ;****************************************************************
                         C      ;*               Aufzeichnungszweig                             *
                         C      ;****************************************************************
  5B6B*                  C      STT08:
  5B6B*   DD 7E 0A       C          LD  A,(IX+10)            ;Laenge der Daten im Puffer
  5B6E*   DD 77 1F       C          LD  (IX+31),A
                         C      
  5B71*   3A 2B01*       C          LD  A,(K0.HSB)           ;HS-Bereich
  5B74*   DD 77 20       C          LD  (IX+32),A
                         C      
  5B77*   DD 7E 08       C          LD  A,(IX+8)
  5B7A*   DD 77 21       C          LD  (IX+33),A
  5B7D*   DD 7E 07       C          LD  A,(IX+7)
  5B80*   DD 77 22       C          LD  (IX+34),A
                         C      
  5B83*   DD 36 23 FF    C          LD  (IX+35),0FFH
                         C      
                         C      ;     LD  DE,UE.PUF            ;Kassettenpuffer
                         C      ;     LD  H,(IX+26)
                         C      ;     LD  L,(IX+25)
                         C      ;     LD  B,(IX+9)
                         C      ;     LD  C,(IX+10)
                         C      ;     LDIR
                         C      
  5B87*   06 08          C          LD  B,8
  5B89*   CD 5AF6*       C          CALL K1.KERN
  5B8C*   C3 5BAA*       C          JP	KOMED	;Kommandoende
                         C      
                         C          PAGE
'7-/8-Byte IO-Kommandos'	MACRO-80 3.44	09-Dec-81	PAGE	1-30


                         C      
                         C      ;****************************************************************
                         C      ;*               Fehler                                         *
                         C      ;****************************************************************
  5B8F*                  C      STF99:
  5B8F*   DD 75 01       C      	LD	(IX+1),L	;Fehlerschluessel laden
  5B92*   DD CB 00 FE    C      	SET	7,(IX+0)	;Fehlerbit setzen
  5B96*                  C      STFRS:
  5B96*   C3 5BAA*       C      	JP	KOMED	;Kommandoende
                         C      
  5B99*                  C      STF07:
  5B99*   2E 10          C      	LD	L,10H	;falsches Kommando
  5B9B*   18 F2          C      	JR	STF99
                         C      
                         C          PAGE
'7-/8-Byte IO-Kommandos'	MACRO-80 3.44	09-Dec-81	PAGE	1-31


                         C      
                         C      ;****************************************************************
                         C      ;*               Register AF , BC , DE , HL retten in SP        *
                         C      ;****************************************************************
  5B9D*                  C      RRET:
  5B9D*   E3             C          EX  (SP),HL
  5B9E*   D5             C      	PUSH	DE
  5B9F*   C5             C      	PUSH	BC
  5BA0*   F5             C      	PUSH	AF
  5BA1*   E9             C          JP  (HL)
                         C      ;****************************************************************
                         C      ;*               Register AF , BC , DE , HL laden aus SP        *
                         C      ;****************************************************************
  5BA2*                  C      RLAD:
  5BA2*   E3             C          EX  (SP),HL
  5BA3*   33             C          INC SP
  5BA4*   33             C          INC SP
  5BA5*   F1             C      	POP	AF
  5BA6*   C1             C      	POP	BC
  5BA7*   D1             C      	POP	DE
  5BA8*   E3             C          EX  (SP),HL
  5BA9*   C9             C      	RET
                         C      
                         C      ;****************************************************************
                         C      ;*               Verzweigung aus Steuerteil zum Eintrittspunkt  *
                         C      ;*               des Steuerprogrammes                           *
                         C      ;****************************************************************
  5BAA*                  C      KOMED:
  5BAA*   F3             C      	DI
  5BAB*   DD CB 00 86    C      	RES 0,(IX)
  5BAF*   CD 5BA2*       C      	CALL	RLAD
  5BB2*   FB             C      	EI
  5BB3*   C9             C      	RET
                         C      
                         C          PAGE
'7-/8-Byte IO-Kommandos'	MACRO-80 3.44	09-Dec-81	PAGE	1-32


                         C      
                         C      ;****************************************************************
                         C      ;*               CRC-Zeichen berechnen                          *
                         C      ;*               <B>  = Blocklaenge , 0 = 256                   *
                         C      ;*               <HL> = Pufferadresse                           *
                         C      ;*               in  DE  nach Aufruf CRC-Zeichen                *
                         C      ;*                <D> = 1.Byte , wird zuerst gesendet           *
                         C      ;*                <E> = 2.Byte , wird danach gesendet           *
                         C      ;****************************************************************
  5BB4*                  C      K1.CRC:
  5BB4*   11 0000        C      	LD	DE,0
  5BB7*                  C      CRC0:
  5BB7*   C5             C      	PUSH	BC	;Bytelaenge
  5BB8*   06 08          C      	LD	B,8
  5BBA*   4E             C      	LD	C,(HL)
  5BBB*                  C      CRC1:
  5BBB*   79             C      	LD	A,C
  5BBC*   AA             C      	XOR	D
  5BBD*   0F             C      	RRCA		;Ergebnis Antivalenz Wort-Byte/CRC-Byte,Bit 0
  5BBE*   F5             C      	PUSH	AF
  5BBF*   CB 1B          C      	RR	E	;Verschiebung von DE um 1 Bit nach rechts
  5BC1*   CB 1A          C      	RR	D
  5BC3*   F1             C      	POP	AF	;Rueckretten F
  5BC4*   30 08          C      	JR	NC,CRC2	;Sprung wenn Antivalenz 0 + 0 = 0
  5BC6*   7A             C      	LD	A,D	;Korrektur = Umkehr Bit 13/Bit 0
  5BC7*   EE 01          C      	XOR	1	;Maske fuer D
  5BC9*   57             C      	LD	D,A	;Korrektur  D
  5BCA*   7B             C      	LD	A,E
  5BCB*   EE 20          C      	XOR	20H	;Maske fuer E
  5BCD*   5F             C      	LD	E,A	;Korrektur  E
  5BCE*                  C      CRC2:
  5BCE*   CB 09          C      	RRC	C	;Schieben Datenbyte
  5BD0*   10 E9          C      	DJNZ	CRC1
  5BD2*   C1             C      	POP	BC	;Byte abgearbeitet
  5BD3*   0B             C      	DEC	BC
  5BD4*   79             C      	LD	A,C
  5BD5*   B0             C      	OR	B
  5BD6*   C8             C      	RET	Z
  5BD7*   23             C      	INC	HL
  5BD8*   18 DD          C      	JR	CRC0
                         C      
                         C      ;	END
                         C      	TITLE	'Kassettengrundroutinen'
                         C      	PAGE
'Kassettengrundroutinen'	MACRO-80 3.44	09-Dec-81	PAGE	1-33


                         C      
                         C      ;****************************************************************
                         C      ;*               Anschlussroutinen fuer BAMOS/Emulator          *
                         C      ;* OS - Version  -----------------------------------------------*
                         C      ;*               Programmierer: Marcus Herbote                  *
                         C      ;* V 1 . 2       -----------------------------------------------*
                         C      ;*               Stand        : 18.November 2022                *
                         C      ;****************************************************************
                         C      ;	PN	KR
                         C      ;---------------------------------------------------------------------
                         C      ;        Kassettengrundroutinen
                         C      ;---------------------------------------------------------------------
  5BDA*   5BDA*          C      	DW	$
  5BDC*   4B 31 52 45    C      	DB	'K1RE'
  5BE0*                  C      KR.GR1:
  5BE0*   3E 01          C      	LD	A,01H
  5BE2*   18 08          C      	JR	KR.GR3
                         C      ;
  5BE4*   5BE4*          C      	DW	$
  5BE6*   4B 32 52 45    C      	DB	'K2RE'
  5BEA*                  C      KR.GR2:
  5BEA*   3E 02          C      	LD	A,02H
  5BEC*                  C      KR.GR3:
  5BEC*   CD 54E2*       C      	CALL	U1.KTINI
  5BEF*   DD 77 03       C      	LD	(IX+3),A
  5BF2*   CD 609F*       C      	CALL	UR.KRE
  5BF5*   C9             C      	RET
                         C      ;-------------------------------------------------------------------
  5BF6*   5BF6*          C      	DW	$
  5BF8*   4B 31 4C 2B    C      	DB	'K1L+'
  5BFC*   CD 5BE0*       C      	CALL	KR.GR1
  5BFF*   18 09          C      	JR	$+11
                         C      ;
  5C01*   5C01*          C      	DW	$
  5C03*   4B 32 4C 2B    C      	DB	'K2L+'
  5C07*   CD 5BEA*       C      	CALL	KR.GR2
  5C0A*   21 0001        C      	LD	HL,1	; IX + 10 := 1 / Anzahl BM
  5C0D*   CD 5621*       C      	CALL	XY.STDX
  5C10*   0A             C      	DB	10
  5C11*   CD 60B7*       C      	CALL	UR.KLV
  5C14*   C9             C      	RET
                         C      ;---------------------------------------------------------------------
  5C15*   5C15*          C      	DW	$
  5C17*   4B 31 4C 2D    C      	DB	'K1L-'
  5C1B*   CD 5BE0*       C      	CALL	KR.GR1
  5C1E*   18 09          C      	JR	$+11
                         C      ;
  5C20*   5C20*          C      	DW	$
  5C22*   4B 32 4C 2D    C      	DB	'K2L-'
  5C26*   CD 5BEA*       C      	CALL	KR.GR2
  5C29*   21 0001        C      	LD	HL,1	; IX + 10 := 1 / Anzahl BM
  5C2C*   CD 5621*       C      	CALL	XY.STDX
  5C2F*   0A             C      	DB	10
  5C30*   CD 60BD*       C      	CALL	UR.KLR
  5C33*   C9             C      	RET
                         C      ;---------------------------------------------------------------------
  5C34*   5C34*          C      	DW	$
  5C36*   4B 31 52 2B    C      	DB	'K1R+'
  5C3A*   CD 5BE0*       C      	CALL	KR.GR1
  5C3D*   18 09          C      	JR	$+11
                         C      ;
  5C3F*   5C3F*          C      	DW	$
  5C41*   4B 32 52 2B    C      	DB	'K2R+'
  5C45*   CD 5BEA*       C      	CALL	KR.GR2
  5C48*   CD 60CF*       C      	CALL	UR.KBV
  5C4B*   C9             C      	RET
                         C      ;--------------------------------------------------------------------
  5C4C*   5C4C*          C      	DW	$
  5C4E*   4B 31 52 2D    C      	DB	'K1R-'
  5C52*   CD 5BE0*       C      	CALL	KR.GR1
  5C55*   18 09          C      	JR	$+11
                         C      ;
  5C57*   5C57*          C      	DW	$
  5C59*   4B 32 52 2D    C      	DB	'K2R-'
  5C5D*   CD 5BEA*       C      	CALL	KR.GR2
  5C60*   CD 60D5*       C      	CALL	UR.KBR
  5C63*   C9             C      	RET
                         C      ;--------------------------------------------------------------------
  5C64*   5C64*          C      	DW	$
  5C66*   4B 31 52 57    C      	DB	'K1RW'
  5C6A*   CD 5BE0*       C      	CALL	KR.GR1
  5C6D*   18 09          C      	JR	$+11
'Kassettengrundroutinen'	MACRO-80 3.44	09-Dec-81	PAGE	1-34


                         C      ;
  5C6F*   5C6F*          C      	DW	$
  5C71*   4B 32 52 57    C      	DB	'K2RW'
  5C75*   CD 5BEA*       C      	CALL	KR.GR2
  5C78*   CD 60A7*       C      	CALL	UR.KRW
  5C7B*   C9             C      	RET		;JR	KR.CKRA
                         C      ;---------------------------------------------------------------------
  5C7C*   5C7C*          C      	DW	$
  5C7E*   4B 31 52 41    C      	DB	'K1RA'
  5C82*   CD 5BE0*       C      	CALL	KR.GR1
  5C85*   18 09          C      	JR	$+11
                         C      ;
  5C87*   5C87*          C      	DW	$
  5C89*   4B 32 52 41    C      	DB	'K2RA'
  5C8D*   CD 5BEA*       C      	CALL	KR.GR2
  5C90*                  C      KR.CKRA:
  5C90*   CD 60A7*       C      	CALL	UR.KRW
  5C93*   CD 60B1*       C      	CALL	UR.KRA
  5C96*   C9             C      	RET
                         C      ;---------------------------------------------------------------------
  5C97*                  C      KR.KARO:
  5C97*   CD 5AB0*       C      	CALL	UE.BRKMB	;AUFRUF PHYS.KASS.ROUTINE
  5C9A*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  5C9B*                  C      KR.VORSP:
  5C9B*   11 3327        C      	LD	DE,UE.BWSA + 10*80 +7	;327H
  5C9E*   CD 5761*       C      	CALL	UC.CVDB
  5CA1*   45             C      	LD	B,L
  5CA2*   3E 46          C      	LD	A,'F'
  5CA4*   32 2B28*       C      	LD	(UB.PAR2),A
  5CA7*   CD 609F*       C      	CALL	UR.KRE
  5CAA*   CD 60E4*       C      	CALL	UR.POSIK
  5CAD*   C9             C      	RET
                         C      ;---------------------------------------------------------------------
  5CAE*   5CAE*          C      	DW	$
  5CB0*   58 4B 41 31    C      	DB	'XKA1'
  5CB4*   CD 5BE0*       C      	CALL	KR.GR1
  5CB7*   18 09          C      	JR	KR.XKA1
                         C      ;
  5CB9*   5CB9*          C      	DW	$
  5CBB*   58 4B 41 32    C      	DB	'XKA2'
  5CBF*   CD 5BEA*       C      	CALL	KR.GR2
  5CC2*                  C      KR.XKA1:
  5CC2*   CD 609F*       C      	CALL	UR.KRE
  5CC5*   CD 5C9B*       C      	CALL	KR.VORSP
  5CC8*   CD 6862*       C      	CALL	FD.FDINP
  5CCB*   CD 60A7*       C      	CALL	UR.KRW
  5CCE*   CD 60B1*       C      	CALL	UR.KRA
  5CD1*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  5CD2*   5CD2*          C      	DW	$
  5CD4*   59 4B 41 31    C      	DB	'YKA1'
  5CD8*   CD 5BE0*       C      	CALL	KR.GR1
  5CDB*   18 09          C      	JR	KR.YKA1	;$+11
                         C      ;
  5CDD*   5CDD*          C      	DW	$
  5CDF*   59 4B 41 32    C      	DB	'YKA2'
  5CE3*   CD 5BEA*       C      	CALL	KR.GR2
  5CE6*                  C      KR.YKA1:
  5CE6*   CD 609F*       C      	CALL	UR.KRE
  5CE9*   11 3327        C      	LD	DE,UE.BWSA + 10*80 +7	;327H
  5CEC*   CD 5761*       C      	CALL	UC.CVDB
  5CEF*   2D             C      	DEC	L
  5CF0*   28 09          C      	JR	Z,KR.YKA2	;$+11
  5CF2*   DD 75 0A       C      	LD	(IX+10),L
  5CF5*   CD 5D24*       C      	CALL	KR.TYPT
  5CF8*   CD 60B7*       C      	CALL	UR.KLV
  5CFB*                  C      KR.YKA2:
  5CFB*   CD 68B5*       C      	CALL	FD.FDOUT
  5CFE*   18 15          C      	JR	KR.KCL	;BM und SL schreiben; Rewind; RA
  5D00*   C9             C      	RET
                         C      ;---------------------------------------------------------------------------
  5D01*   5D01*          C      	DW	$
  5D03*   4B 31 43 4C    C      	DB	'K1CL'
  5D07*   CD 5BE0*       C      	CALL	KR.GR1
  5D0A*   18 09          C      	JR	KR.KCL	;$+11
                         C      ;
  5D0C*   5D0C*          C      	DW	$
  5D0E*   4B 32 43 4C    C      	DB	'K2CL'
  5D12*   CD 5BEA*       C      	CALL	KR.GR2
  5D15*                  C      KR.KCL:
  5D15*   CD 60C3*       C      	CALL	UR.KBM
  5D18*   CD 60C9*       C      	CALL	UR.KSL
'Kassettengrundroutinen'	MACRO-80 3.44	09-Dec-81	PAGE	1-35


  5D1B*   CD 60A7*       C      	CALL	UR.KRW
  5D1E*   CD 60B1*       C      	CALL	UR.KRA
  5D21*   C3 000B        C      	JP	UE.SYSTB
                         C      ;--------------------------------------------------------------------
  5D24*                  C      KR.TYPT:
  5D24*   13             C      	INC	DE
  5D25*   1A             C      	LD	A,(DE)
  5D26*   32 2B28*       C      	LD	(UB.PAR2),A
  5D29*   C9             C      	RET
                         C      ;--------------------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Fehleranzeige und Behandlung'
                         C      	PAGE
'Fehleranzeige und Behandlung'	MACRO-80 3.44	09-Dec-81	PAGE	1-36


                         C      
                         C      ;	PN	UF
                         C      ;***************************************************************
                         C      ;
                         C      ;      Fehleranzeige  UND  BEHANDLUNG
                         C      ;
                         C      ;***************************************************************
  5D2A*                  C      UF.RET:
  5D2A*   F1             C      	POP	AF
  5D2B*   C1             C      	POP	BC
  5D2C*   D1             C      	POP	DE
  5D2D*   E1             C      	POP	HL
  5D2E*   C9             C      	RET
                         C      ;---------------------Ausfhr. Kass.kommando lt.Steuerblock-------------
  5D2F*                  C      UF.EXEC:
  5D2F*   E5             C      	PUSH	HL
  5D30*   D5             C      	PUSH	DE
  5D31*   C5             C      	PUSH	BC
  5D32*   F5             C      	PUSH	AF
  5D33*   DD CB 00 BE    C      	RES	7,(IX)
  5D37*   DD 36 01 00    C      	LD	(IX+1),0
                         C      	;JP	KO.KO05
                         C      
  5D3B*   3E 01          C      	LD	A,1
  5D3D*   32 2B01*       C      	LD	(K0.HSB),A	;HS-Bereich
  5D40*   DD 7E 04       C      	LD	A,(IX+4)	;Kommando
  5D43*   FE 71          C      	CP	071H
  5D45*   28 0C          C      	JR	Z,UF.EXEC2
  5D47*   FE 75          C      	CP	075H
  5D49*   28 08          C      	JR	Z,UF.EXEC2
  5D4B*   DD 36 07 65    C      	LD	(IX+7),LOW(UE.PUF)
  5D4F*   DD 36 08 0E    C      	LD	(IX+8),HIGH(UE.PUF)
  5D53*                  C      UF.EXEC2:
  5D53*   CD 5C97*       C      	CALL	KR.KARO
  5D56*                  C      UF.EXEC1:
  5D56*   DD CB 00 7E    C      	BIT	7,(IX)	;Status
  5D5A*   28 CE          C      	JR	Z,UF.RET
  5D5C*   DD 7E 01       C      	LD	A,(IX+1)	;Fehlerschluessel
                         C      ;-------------------------Fehlerbehandlung---------------
  5D5F*                  C      UF.ERANZ:
  5D5F*   E5             C      	PUSH	HL
  5D60*   D5             C      	PUSH	DE
  5D61*   C5             C      	PUSH	BC
  5D62*   F5             C      	PUSH	AF
  5D63*   F5             C      	PUSH	AF
  5D64*   3E 13          C      	LD	A,19
  5D66*   32 2B00*       C      	LD	(UB.ZN),A
  5D69*   21 5FC2*       C      	LD	HL,UA.ZKF	;IN: <A> Fehlerschluessel
  5D6C*   CD 595C*       C      	CALL	UR.MIMO
  5D6F*   F1             C      	POP	AF
  5D70*   F5             C      	PUSH	AF
  5D71*   EB             C      	EX	DE,HL
  5D72*   CD 56A5*       C      	CALL	UC.CVBX+2
  5D75*   F1             C      	POP	AF
  5D76*   FE 17          C      	CP	17H
  5D78*   CA 5DFA*       C      	JP	Z,UF.FL17
  5D7B*   FE 18          C      	CP	18H
  5D7D*   CA 5DEE*       C      	JP	Z,UF.FL18
  5D80*   FE 00          C      	CP	00H
  5D82*   CA 5DE0*       C      	JP	Z,UF.BEHB
  5D85*   FE 11          C      	CP	11H
  5D87*   CA 5DE0*       C      	JP	Z,UF.BEHB
  5D8A*   FE 19          C      	CP	19H
  5D8C*   28 1D          C      	JR	Z,UF.AZVB
  5D8E*   FE 14          C      	CP	14H
  5D90*   CA 5DFD*       C      	JP	Z,UF.FL14
  5D93*   FE 16          C      	CP	16H
  5D95*   CA 5E00*       C      	JP	Z,UF.FL16
  5D98*   C3 5D2A*       C      	JP	UF.RET
                         C      ;----------------------------------------------------------------------
  5D9B*                  C      UF.SYS:
  5D9B*   DD 7E 01       C      	LD	A,(IX+1)
  5D9E*   11 35A8        C      	LD	DE,UE.BWSA+5A8H
  5DA1*   CD 56A5*       C      	CALL	UC.CVBX+2
  5DA4*   00             C      	NOP
  5DA5*   00             C      	NOP
  5DA6*   00             C      	NOP
  5DA7*                  C      UF.SYS1:
  5DA7*   31 0CE0        C      	LD	SP,UE.STANF
  5DAA*   C9             C      	RET
                         C      ;----------------------------------------------------------
  5DAB*                  C      UF.AZVB:
'Fehleranzeige und Behandlung'	MACRO-80 3.44	09-Dec-81	PAGE	1-37


  5DAB*   DD CB 00 96    C      	RES	2,(IX)	;Aufzeichnen verboten
  5DAF*   DD 36 04 41    C      	LD	(IX+4),41H
  5DB3*   CD 5C97*       C      	CALL	KR.KARO
  5DB6*   DD CB 00 7E    C      	BIT	7,(IX)
  5DBA*   20 DF          C      	JR	NZ,UF.SYS
  5DBC*   21 5F32*       C      	LD	HL,UA.FRZ
  5DBF*   CD 595C*       C      	CALL	UR.MIMO
  5DC2*   38 E3          C      	JR	C,UF.SYS1
  5DC4*   DD 36 04 31    C      	LD	(IX+4),31H
  5DC8*   CD 5C97*       C      	CALL	KR.KARO
  5DCB*   DD CB 00 66    C      	BIT	4,(IX+0)
  5DCF*   20 CA          C      	JR	NZ,UF.SYS
  5DD1*   DD CB 00 7E    C      	BIT	7,(IX+0)
  5DD5*   20 C4          C      	JR	NZ,UF.SYS
  5DD7*   DD CB 00 56    C      	BIT	2,(IX+0)
  5DDB*   20 BE          C      	JR	NZ,UF.SYS
  5DDD*   C3 5DE8*       C      	JP	UF.BEHB1
                         C      ;----------------------------------------------------------
  5DE0*                  C      UF.BEHB:
  5DE0*   21 5F32*       C      	LD	HL,UA.FRZ
  5DE3*   CD 595C*       C      	CALL	UR.MIMO
  5DE6*   38 BF          C      	JR	C,UF.SYS1
                         C      
  5DE8*                  C      UF.BEHB1:
  5DE8*                  C      KO.KO04:
  5DE8*   DD 71 04       C      	LD	(IX+4),C	;FUER UF19
  5DEB*   C3 5D33*       C      	JP	UF.EXEC+4
                         C      ;---------------------------------------
  5DEE*                  C      UF.FL18:
  5DEE*   21 5F38*       C      	LD	HL,UA.BMGF
  5DF1*   CD 595C*       C      	CALL	UR.MIMO
  5DF4*   DA 5DA7*       C      	JP	C,UF.SYS1
  5DF7*   C3 5D2A*       C      	JP	UF.RET
                         C      ;------------------------------------------
  5DFA*                  C      UF.FL17:
  5DFA*   C3 5D2A*       C      	JP	UF.RET
                         C      ;-------------------------------------
  5DFD*                  C      UF.FL14:
  5DFD*   C3 5D2A*       C      	JP	UF.RET
                         C      
  5E00*                  C      UF.FL16:
  5E00*   21 5F32*       C      	LD	HL,UA.FRZ
  5E03*   CD 595C*       C      	CALL	UR.MIMO
  5E06*   C3 5D2A*       C      	JP	UF.RET
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Ausschriften'
                         C      	PAGE
'Ausschriften'	MACRO-80 3.44	09-Dec-81	PAGE	1-38


                         C      
                         C      ;	PN	UA01
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;     AUSSCHRIFTEN
                         C      ;
                         C      ;----------------------------------------------------------------------
  5E09*                  C      UA.DS:
  5E09*   00             C      	DB	0
  5E0A*   01             C      	DB	1
  5E0B*   00             C      	DB	0
  5E0C*   01             C      	DB	1
  5E0D*   20 20 44 53    C      	DB	'  DS************   '
  5E11*   2A 2A 2A 2A    C      
  5E15*   2A 2A 2A 2A    C      
  5E19*   2A 2A 2A 2A    C      
  5E1D*   20 20 20       C      
  5E20*   01             C      	DB	1
  5E21*   00             C      	DB	0
  5E22*   00             C      	DB	0
  5E23*   00             C      	DB	0
  5E24*   00             C      	DB	0
  5E25*   00             C      	DB	0
  5E26*   00             C      	DB	0
  5E27*   00             C      	DB	0
  5E28*   00             C      	DB	0
                         C      ;----------------------------------------------------------------------
  5E29*                  C      UA.KNAME:
  5E29*   06             C      	DB	06H
  5E2A*   10             C      	DB	16
  5E2B*   40             C      	DB	40H
  5E2C*   20 4B 61 73    C      	DB	' KassettenName: '
  5E30*   73 65 74 74    C      
  5E34*   65 6E 4E 61    C      
  5E38*   6D 65 3A 20    C      
  5E3C*                  C      UA.NR:
  5E3C*   03             C      	DB	03H
  5E3D*   10             C      	DB	16
  5E3E*   40             C      	DB	40H
  5E3F*   20 4B 61 73    C      	DB	' Kassetten-Nr.: '
  5E43*   73 65 74 74    C      
  5E47*   65 6E 2D 4E    C      
  5E4B*   72 2E 3A 20    C      
  5E4F*                  C      UA.KOMMT:
  5E4F*   0B             C      	DB	0BH
  5E50*   10             C      	DB	16
  5E51*   80             C      	DB	80H
  5E52*   20 20 20 20    C      	DB	'     Kommentar: '
  5E56*   20 4B 6F 6D    C      
  5E5A*   6D 65 6E 74    C      
  5E5E*   61 72 3A 20    C      
                         C      ;----------------------------------------------------------------------
  5E62*                  C      UA.Z7E:
  5E62*   45 69 6E 67    C      	DB	'Eingabe      =====>     Ausgabe'
  5E66*   61 62 65 20    C      
  5E6A*   20 20 20 20    C      
  5E6E*   20 3D 3D 3D    C      
  5E72*   3D 3D 3E 20    C      
  5E76*   20 20 20 20    C      
  5E7A*   41 75 73 67    C      
  5E7E*   61 62 65       C      
  5E81*                  C      UA.GER:
  5E81*   20 20 20 20    C      	DB	'       Geraet: '
  5E85*   20 20 20 47    C      
  5E89*   65 72 61 65    C      
  5E8D*   74 3A 20       C      
                         C      ;----------------------------------------------------------------------
  5E90*                  C      UA.KOPFR:
  5E90*   01             C      	DB	01H
  5E91*   33             C      	DB	51
  5E92*   80             C      	DB	80H
  5E93*   20 20 20 20    C      	DB	'                Datei               kopieren J/N ? '
  5E97*   20 20 20 20    C      
  5E9B*   20 20 20 20    C      
  5E9F*   20 20 20 20    C      
  5EA3*   44 61 74 65    C      
  5EA7*   69 20 20 20    C      
  5EAB*   20 20 20 20    C      
  5EAF*   20 20 20 20    C      
  5EB3*   20 20 20 20    C      
  5EB7*   6B 6F 70 69    C      
  5EBB*   65 72 65 6E    C      
'Ausschriften'	MACRO-80 3.44	09-Dec-81	PAGE	1-39


  5EBF*   20 4A 2F 4E    C      
  5EC3*   20 3F 20       C      
  5EC6*                  C      UA.EABFR:
  5EC6*   01             C      	DB	01H
  5EC7*   33             C      	DB	51
  5EC8*   80             C      	DB	80H
  5EC9*   20 20 20 20    C      	DB	'                Eingaben in Ordnung  ---->   J/N ? '
  5ECD*   20 20 20 20    C      
  5ED1*   20 20 20 20    C      
  5ED5*   20 20 20 20    C      
  5ED9*   45 69 6E 67    C      
  5EDD*   61 62 65 6E    C      
  5EE1*   20 69 6E 20    C      
  5EE5*   4F 72 64 6E    C      
  5EE9*   75 6E 67 20    C      
  5EED*   20 2D 2D 2D    C      
  5EF1*   2D 3E 20 20    C      
  5EF5*   20 4A 2F 4E    C      
  5EF9*   20 3F 20       C      
  5EFC*                  C      UA.VORH:
  5EFC*   01             C      	DB	1
  5EFD*   33             C      	DB	51
  5EFE*   80             C      	DB	80H
  5EFF*   2A 2A 2A 2A    C      	DB	'************* Datei vorh.;SYS-Ende,kopieren  J/N ? '
  5F03*   2A 2A 2A 2A    C      
  5F07*   2A 2A 2A 2A    C      
  5F0B*   2A 20 44 61    C      
  5F0F*   74 65 69 20    C      
  5F13*   76 6F 72 68    C      
  5F17*   2E 3B 53 59    C      
  5F1B*   53 2D 45 6E    C      
  5F1F*   64 65 2C 6B    C      
  5F23*   6F 70 69 65    C      
  5F27*   72 65 6E 20    C      
  5F2B*   20 4A 2F 4E    C      
  5F2F*   20 3F 20       C      
                         C      ;----------------------------------------------------------------------
  5F32*                  C      UA.FRZ:
  5F32*   02             C      	DB	2
  5F33*   03             C      	DB	3
  5F34*   80             C      	DB	80H
  5F35*   3F 3F 20       C      	DB	'?? '
  5F38*                  C      UA.BMGF:
  5F38*   01             C      	DB	01H
  5F39*   07             C      	DB	7
  5F3A*   80             C      	DB	80H
  5F3B*   42 4D 20 21    C      	DB	'BM ! ??'
  5F3F*   20 3F 3F       C      
  5F42*                  C      UA.DOK:
  5F42*   00             C      	DB	0
  5F43*   04             C      	DB	4
  5F44*   80             C      	DB	80H
  5F45*   69 2E 4F 2E    C      	DB	'i.O.'
  5F49*                  C      UA.DF:
  5F49*   00             C      	DB	0
  5F4A*   04             C      	DB	4
  5F4B*   80             C      	DB	80H
  5F4C*   46 68 6C 2E    C      	DB	'Fhl.'
                         C      ;----------------------------------------------------------------------
  5F50*                  C      UA.ZKDAT:
  5F50*   06             C      	DB	6
  5F51*   10             C      	DB	16
  5F52*   40             C      	DB	40H
  5F53*   20 20 20 20    C      	DB	'     Dateiname: '
  5F57*   20 44 61 74    C      
  5F5B*   65 69 6E 61    C      
  5F5F*   6D 65 3A 20    C      
  5F63*                  C      UA.ZKLAD:
  5F63*   04             C      	DB	4
  5F64*   10             C      	DB	16
  5F65*   08             C      	DB	08H
  5F66*   20 20 20 4C    C      	DB	'   Ladeadresse: '
  5F6A*   61 64 65 61    C      
  5F6E*   64 72 65 73    C      
  5F72*   73 65 3A 20    C      
                         C      ;------------------------------------------------------------------
  5F76*                  C      UA.ZKBEG:
  5F76*   04             C      	DB	4
  5F77*   10             C      	DB	16
  5F78*   08             C      	DB	08H
  5F79*   20 20 20 20    C      	DB	'        Beginn: '
  5F7D*   20 20 20 20    C      
  5F81*   42 65 67 69    C      
'Ausschriften'	MACRO-80 3.44	09-Dec-81	PAGE	1-40


  5F85*   6E 6E 3A 20    C      
  5F89*                  C      UA.ZKEND:
  5F89*   04             C      	DB	4
  5F8A*   10             C      	DB	16
  5F8B*   08             C      	DB	08H
  5F8C*   20 20 20 20    C      	DB	'          Ende: '
  5F90*   20 20 20 20    C      
  5F94*   20 20 45 6E    C      
  5F98*   64 65 3A 20    C      
  5F9C*                  C      UA.STADR:
  5F9C*   04             C      	DB	4
  5F9D*   10             C      	DB	16
  5F9E*   08             C      	DB	08H
  5F9F*   20 20 53 74    C      	DB	'  Startadresse: '
  5FA3*   61 72 74 61    C      
  5FA7*   64 72 65 73    C      
  5FAB*   73 65 3A 20    C      
  5FAF*                  C      UA.ZKDL:
  5FAF*   01             C      	DB	1
  5FB0*   10             C      	DB	16
  5FB1*   20             C      	DB	20H
  5FB2*   20 4C 6F 65    C      	DB	' Loeschen J/N : '
  5FB6*   73 63 68 65    C      
  5FBA*   6E 20 4A 2F    C      
  5FBE*   4E 20 3A 20    C      
  5FC2*                  C      UA.ZKF:
  5FC2*   00             C      	DB	0
  5FC3*   08             C      	DB	8
  5FC4*   00             C      	DB	0
  5FC5*   46 65 68 6C    C      	DB	'Fehler: '
  5FC9*   65 72 3A 20    C      
                         C      ;----------------------------------------------------------------------
  5FCD*                  C      UA.ZKRES:
  5FCD*   03             C      	DB	3
  5FCE*   10             C      	DB	16
  5FCF*   10             C      	DB	10H
  5FD0*   52 65 73 65    C      	DB	'Reservebloecke: '
  5FD4*   72 76 65 62    C      
  5FD8*   6C 6F 65 63    C      
  5FDC*   6B 65 3A 20    C      
  5FE0*                  C      UA.ZKSDT:
  5FE0*   04             C      	DB	4
  5FE1*   12             C      	DB	18
  5FE2*   40             C      	DB	40H
  5FE3*   20 20 20 20    C      	DB	'     Dateiname:   '
  5FE7*   20 44 61 74    C      
  5FEB*   65 69 6E 61    C      
  5FEF*   6D 65 3A 20    C      
  5FF3*   20 20          C      
  5FF5*                  C      UA.ZKBEL:
  5FF5*   00             C      	DB	0
  5FF6*   10             C      	DB	16
  5FF7*   00             C      	DB	0
  5FF8*   42 6C 6F 65    C      	DB	'Bloecke belegt: '
  5FFC*   63 6B 65 20    C      
  6000*   62 65 6C 65    C      
  6004*   67 74 3A 20    C      
  6008*                  C      UA.ZKBLG:
  6008*   00             C      	DB	0
  6009*   10             C      	DB	16
  600A*   00             C      	DB	0
  600B*   42 6C 6F 65    C      	DB	'Bloecke gesamt: '
  600F*   63 6B 65 20    C      
  6013*   67 65 73 61    C      
  6017*   6D 74 3A 20    C      
                         C      ;----------------------------------------------------------------------
  601B*                  C      UA.ZKBA:
  601B*   42 61 6E 64    C      	DB	'Bandanfang'
  601F*   61 6E 66 61    C      
  6023*   6E 67          C      
  6025*                  C      UA.ZKBM:
  6025*   42 61 6E 64    C      	DB	'Bandmarke'
  6029*   6D 61 72 6B    C      
  602D*   65             C      
  602E*                  C      UA.ZKSL:
  602E*   53 63 68 6C    C      	DB	'Schlussluecke'
  6032*   75 73 73 6C    C      
  6036*   75 65 63 6B    C      
  603A*   65             C      
  603B*                  C      UA.ZKEE:
                         C      ;----------------------------------------------------------------------
  603B*                  C      UA.LD:
  603B*   26             C      	DB	38
'Ausschriften'	MACRO-80 3.44	09-Dec-81	PAGE	1-41


  603C*   0F             C      	DB	15
  603D*   80             C      	DB	80H
  603E*   20 20 20 20    C      	DB	'               '
  6042*   20 20 20 20    C      
  6046*   20 20 20 20    C      
  604A*   20 20 20       C      
  604D*                  C      UA.ZRSCH:
  604D*   01             C      	DB	1
  604E*   16             C      	DB	22
  604F*   80             C      	DB	80H
  6050*   56 65 72 7A    C      	DB	'Verz. schreiben J/N ? '
  6054*   2E 20 73 63    C      
  6058*   68 72 65 69    C      
  605C*   62 65 6E 20    C      
  6060*   4A 2F 4E 20    C      
  6064*   3F 20          C      
  6066*                  C      UA.ANZWD:
  6066*   01             C      	DB	1
  6067*   16             C      	DB	22
  6068*   80             C      	DB	80H
  6069*   41 6E 7A 65    C      	DB	'Anzeige wdhln.  J/N ? '
  606D*   69 67 65 20    C      
  6071*   77 64 68 6C    C      
  6075*   6E 2E 20 20    C      
  6079*   4A 2F 4E 20    C      
  607D*   3F 20          C      
                         C      ;----------------------------------------------------------------------
  607F*                  C      UA.ALTR:
  607F*   20 41 55 53    C      	DB	' AUSGLEICH LAUFWERKSTOLERANZEN  '
  6083*   47 4C 45 49    C      
  6087*   43 48 20 4C    C      
  608B*   41 55 46 57    C      
  608F*   45 52 4B 53    C      
  6093*   54 4F 4C 45    C      
  6097*   52 41 4E 5A    C      
  609B*   45 4E 20 20    C      
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                         C      	TITLE 'Routinen fuer Kassette'
                         C      	PAGE
'Routinen fuer Kassette'	MACRO-80 3.44	09-Dec-81	PAGE	1-42


                         C      
                         C      ;----------------------------------------------------------------------
                         C      ;   Routinen fuer KASSETTE
                         C      ;----------------------------------------------------------------------
  609F*                  C      UR.KRE:
  609F*   DD 36 04 31    C      	LD	(IX+4),31H
  60A3*                  C      UR.KRE1:
  60A3*   CD 5D2F*       C      	CALL	UF.EXEC
  60A6*   C9             C      	RET
  60A7*                  C      UR.KRW:
  60A7*   DD 36 04 21    C      	LD	(IX+4),21H
  60AB*   18 F6          C      	JR	UR.KRE1	;Umspulen
  60AD*                  C      UR.KRWW:
  60AD*   CD 60A7*       C      	CALL	UR.KRW
  60B0*   C9             C      	RET
  60B1*                  C      UR.KRA:
  60B1*   DD 36 04 41    C      	LD	(IX+4),41H
  60B5*   18 EC          C      	JR	UR.KRE1	;Reservieren aus
  60B7*                  C      UR.KLV:
  60B7*   DD 36 04 71    C      	LD	(IX+4),71H
  60BB*   18 E6          C      	JR	UR.KRE1	;Label vorsetzen
  60BD*                  C      UR.KLR:
  60BD*   DD 36 04 75    C      	LD	(IX+4),75H
  60C1*   18 E0          C      	JR	UR.KRE1	;LABEL RUECKSETZEN
  60C3*                  C      UR.KBM:
  60C3*   DD 36 04 51    C      	LD	(IX+4),51H
  60C7*   18 DA          C      	JR	UR.KRE1	;BANDMARKE SCHREIBEN
  60C9*                  C      UR.KSL:
  60C9*   DD 36 04 61    C      	LD	(IX+4),61H
  60CD*   18 D4          C      	JR	UR.KRE1	;SCHLUSSLUECKE SCHREIBEN
  60CF*                  C      UR.KBV:
  60CF*   DD 36 04 11    C      	LD	(IX+4),11H
  60D3*   18 CE          C      	JR	UR.KRE1	;Block vorsetzen
  60D5*                  C      UR.KBR:
  60D5*   DD 36 04 15    C      	LD	(IX+4),15H
  60D9*   18 C8          C      	JR	UR.KRE1
                         C      ;--------------------------------------------------------------------
  60DB*                  C      UR.RPOS:
  60DB*   E5             C      	PUSH	HL
  60DC*   D5             C      	PUSH	DE
  60DD*   F5             C      	PUSH	AF
  60DE*   C5             C      	PUSH	BC
  60DF*   AF             C      	XOR	A
  60E0*   3D             C      	DEC	A
  60E1*   4F             C      	LD	C,A
  60E2*   18 06          C      	JR	POSIK1
  60E4*                  C      UR.POSIK:
  60E4*   E5             C      	PUSH	HL
  60E5*   D5             C      	PUSH	DE
  60E6*   F5             C      	PUSH	AF
  60E7*   C5             C      	PUSH	BC	;Positionieren
  60E8*   AF             C      	XOR	A
  60E9*   4F             C      	LD	C,A
  60EA*                  C      POSIK1:
  60EA*   06 00          C      	LD	B,0
  60EC*   11 0000        C      	LD	DE,0
  60EF*                  C      UR.LES:
  60EF*   DD 36 04 02    C      	LD	(IX+4),02H
  60F3*   CD 5D2F*       C      	CALL	UF.EXEC	;BLOCK LESEN
  60F6*   DD 7E 0A       C      	LD	A,(IX+10)
  60F9*   FE 01          C      	CP	1	;BANDMARKE?
  60FB*   28 19          C      	JR	Z,UR.BM
  60FD*   04             C      	INC	B	;ANZAHL BLOECKE
  60FE*   78             C      	LD	A,B
  60FF*   FE 04          C      	CP	4
  6101*   28 21          C      	JR	Z,UR.OK
  6103*   21 0000        C      	LD	HL,0
  6106*   CD 5611*       C      	CALL	XY.LIDX
  6109*   09             C      	DB	9	;HL<--BLOCKLAENGE
  610A*   19             C      	ADD	HL,DE
  610B*   EB             C      	EX	DE,HL
  610C*   21 012C        C      	LD	HL,300
  610F*   B7             C      	OR	A
  6110*   ED 52          C      	SBC	HL,DE
  6112*   38 10          C      	JR	C,UR.OK
  6114*   18 D9          C      	JR	UR.LES
  6116*                  C      UR.BM:
  6116*   AF             C      	XOR	A
  6117*   B1             C      	OR	C
  6118*   28 04          C      	JR	Z,$+6
  611A*   C1             C      	POP	BC
  611B*   04             C      	INC	B
'Routinen fuer Kassette'	MACRO-80 3.44	09-Dec-81	PAGE	1-43


  611C*   18 C9          C      	JR	UR.POSIK+3
  611E*   C1             C      	POP	BC
  611F*   05             C      	DEC	B
  6120*   28 21          C      	JR	Z,UR.RSP
  6122*   18 C3          C      	JR	UR.POSIK+3
  6124*                  C      UR.OK:
  6124*   AF             C      	XOR	A
  6125*   B1             C      	OR	C
  6126*   28 08          C      	JR	Z,$+10
  6128*   DD 70 0A       C      	LD	(IX+10),B
  612B*   CD 60BD*       C      	CALL	UR.KLR
  612E*   18 13          C      	JR	UR.RSP
  6130*   DD 36 04 15    C      	LD	(IX+4),15H
  6134*   CD 5D2F*       C      	CALL	UF.EXEC
  6137*   10 F7          C      	DJNZ	$-7
  6139*   C1             C      	POP	BC
  613A*   05             C      	DEC	B
  613B*   28 06          C      	JR	Z,UR.RSP
  613D*   DD 70 0A       C      	LD	(IX+10),B
  6140*   CD 60B7*       C      	CALL	UR.KLV
  6143*                  C      UR.RSP:
  6143*   F1             C      	POP	AF
  6144*   D1             C      	POP	DE
  6145*   E1             C      	POP	HL
  6146*   C9             C      	RET
                         C      	TITLE	'Einzelzeicheneingabe fuer KMBG'
                         C      	PAGE
'Einzelzeicheneingabe fuer KMBG'	MACRO-80 3.44	09-Dec-81	PAGE	1-44


                         C      
                         C      ;	PN	UK
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;        Einzelzeicheneingabe fuer KMBG
                         C      ;
                         C      ;----------------------------------------------------------------------
  6147*                  C      UK.GETK:
  6147*   CD 5400*       C      	CALL	U1.RSAVE
  614A*   CD 5611*       C      	CALL	XY.LIDX	;HL:= Blocklaenge
  614D*   09             C      	DB	9
  614E*   E5             C      	PUSH	HL
  614F*   CD 5601*       C      	CALL	XY.LDDX
  6152*   17             C      	DB	23
  6153*   EB             C      	EX	DE,HL	;DE:= Pufferzaehler
  6154*   AF             C      	XOR	A
  6155*   E1             C      	POP	HL	;HL:= Blocklaenge
  6156*   ED 52          C      	SBC	HL,DE
  6158*   E5             C      	PUSH	HL	;Restbyteanzahl retten
  6159*   7C             C      	LD	A,H
  615A*   B5             C      	OR	L
  615B*   CC 61A7*       C      	CALL	Z,UK.KBW	;Block lesen
  615E*   E1             C      	POP	HL
  615F*   AF             C      	XOR	A
  6160*   BC             C      	CP	H
  6161*   20 05          C      	JR	NZ,UK.GETK2
  6163*   7D             C      	LD	A,L
  6164*   FE 01          C      	CP	1
  6166*   28 08          C      	JR	Z,UK.GETK3	;---> letztes Datenbyte des
  6168*                  C      UK.GETK2:
  6168*   CD 6176*       C      	CALL	UK.GETK4
  616B*   B7             C      	OR	A
  616C*                  C      UK.GETK5:
  616C*   CD 5408*       C      	CALL	U1.RRST
  616F*   C9             C      	RET
                         C      ;
                         C      ;
  6170*                  C      UK.GETK3:
  6170*   CD 6176*       C      	CALL	UK.GETK4
  6173*   37             C      	SCF
  6174*   18 F6          C      	JR	UK.GETK5
                         C      ;
  6176*                  C      UK.GETK4:
  6176*   CD 5601*       C      	CALL	XY.LDDX	;HL:= aktuelle Pufferadresse
  6179*   15             C      	DB	21
  617A*   7E             C      	LD	A,(HL)	;Datenbyte laden
  617B*   CD 5641*       C      	CALL	XY.INCDX	;Pufferzeiger erhoehen
  617E*   15             C      	DB	21
  617F*   CD 5641*       C      	CALL	XY.INCDX	;Pufferzaehler erhoehen
  6182*   17             C      	DB	23
  6183*   C9             C      	RET
                         C      
                         C      ;******************************************************************
                         C      ;
                         C      ;        KMBG  Eingabepuffer bereitstellen
                         C      ;
                         C      ;*******************************************************************
  6184*                  C      UK.KLPFB:
  6184*   CD 5400*       C      	CALL	U1.RSAVE
  6187*   CD 54FB*       C      	CALL	U1.KTIN1
  618A*   21 0080        C      	LD	HL,MaxBL     ;max. Blocklaenge Kassette (100H)
  618D*   CD 5631*       C      	CALL	XY.STIDX     ;max. Blocklaenge initialisieren
  6190*   09             C      	DB	9
  6191*   E5             C      	PUSH	HL
  6192*   C1             C      	POP	BC           ;BC:= Blocklaenge
  6193*   CD 5621*       C      	CALL	XY.STDX      ;Pufferzaehler "Leer"
  6196*   17             C      	DB	23
  6197*   21 0E65        C      	LD	HL,UE.PUF    ;Systempuffer Kassette
  619A*   CD 5411*       C      	CALL	U1.CLRB      ;Systempuffer loeschen
  619D*   21 8010        C      	LD	HL,UE.KPUFF
  61A0*   CD 5411*       C      	CALL	U1.CLRB
  61A3*   CD 5408*       C      	CALL	U1.RRST
  61A6*   C9             C      	RET
                         C      
                         C      ;******************************************************************
                         C      ;
                         C      ;        Einlesen eines Blockes von Kassette
                         C      ;
                         C      ;         - Besonderheit gegenueber MBW: Blockinhalt wird vom
                         C      ;           Systempuffer in den E/A-Puffer uebertragen
                         C      ;
                         C      ;*******************************************************************
'Einzelzeicheneingabe fuer KMBG'	MACRO-80 3.44	09-Dec-81	PAGE	1-45


  61A7*                  C      UK.KBW:
  61A7*   CD 5400*       C      	CALL	U1.RSAVE
  61AA*   CD 6184*       C      	CALL	UK.KLPFB
  61AD*   DD 36 04 02    C      	LD	(IX+4),02H
  61B1*   CD 5D2F*       C      	CALL	UF.EXEC
                         C      	;LD	A,(IX+9)
                         C      	;OR	(IX+10)
  61B4*   DD 7E 0A       C      	LD	A,(IX+10)	;Laenge = 1, dann BM
  61B7*   FE 01          C      	CP	1
  61B9*   28 2A          C      	JR	Z,UK.KBW1	;EOF
  61BB*   CD 5601*       C      	CALL	XY.LDDX	;HL:= Blockadresse
  61BE*   07             C      	DB	7
  61BF*   DD 46 09       C      	LD	B,(IX+9)	;BC:= Blocklaenge
  61C2*   DD 4E 0A       C      	LD	C,(IX+10)
  61C5*   E5             C      	PUSH	HL	;E/A-Puffer
  61C6*   CD 5601*       C      	CALL	XY.LDDX
  61C9*   19             C      	DB	25
  61CA*   EB             C      	EX	DE,HL
  61CB*   E1             C      	POP	HL
  61CC*   ED B0          C      	LDIR		;Transport in E/A-Puffer
  61CE*   CD 5601*       C      	CALL	XY.LDDX
  61D1*   19             C      	DB	25
  61D2*   CD 5621*       C      	CALL	XY.STDX	;Pufferzeiger auf Anfang
  61D5*   15             C      	DB	21
  61D6*   21 0000        C      	LD	HL,0
  61D9*   CD 5621*       C      	CALL	XY.STDX	;Pufferzaehler rueckstellen
  61DC*   17             C      	DB	23
  61DD*   CD 5641*       C      	CALL	XY.INCDX	;Blockzaehler incrementieren
  61E0*   11             C      	DB	17
  61E1*                  C      UK.KBW2:
  61E1*   CD 5408*       C      	CALL	U1.RRST
  61E4*   C9             C      	RET
                         C      ;
  61E5*                  C      UK.KBW1:
  61E5*   CD 5641*       C      	CALL	XY.INCDX	;Labelzaehler incrementieren
  61E8*   11             C      	DB	17
  61E9*   18 F6          C      	JR	UK.KBW2
                         C      
                         C      ;********************************************************************
                         C      ;
                         C      ;        Einzelzeichenausgabe fuer KMBG
                         C      ;
                         C      ;*********************************************************************
  61EB*                  C      UK.PUTK:
  61EB*   CD 5400*       C      	CALL	U1.RSAVE
  61EE*   F5             C      	PUSH	AF	;Zeichen retten
  61EF*   CD 5601*       C      	CALL	XY.LDDX	;HL:= Pufferzaehler
  61F2*   17             C      	DB	23
  61F3*   01 0132        C      	LD	BC,UE.KMPUL	;BC:= max. Pufferlaenge
  61F6*   B7             C      	OR	A
  61F7*   ED 42          C      	SBC	HL,BC
  61F9*   3F             C      	CCF
  61FA*   CC 6234*       C      	CALL	Z,UK.KBA	;---> Puffer voll
  61FD*   F1             C      	POP	AF	;Zeichen auskellern
  61FE*   CD 5601*       C      	CALL	XY.LDDX
  6201*   15             C      	DB	21
  6202*   77             C      	LD	(HL),A	;Zeichen in Puffer eintragen
  6203*   CD 5641*       C      	CALL	XY.INCDX	;Pufferzeiger erhoehen
  6206*   15             C      	DB	21
  6207*   CD 5641*       C      	CALL	XY.INCDX	;Pufferzaehler erhoehen
  620A*   17             C      	DB	23
  620B*   CD 5408*       C      	CALL	U1.RRST
  620E*   C9             C      	RET
                         C      
                         C      ;******************************************************************
                         C      ;
                         C      ;        Ausgabepufferbereitstellung fuer KMBG
                         C      ;
                         C      ;*******************************************************************
  620F*                  C      UK.KSPFB:
  620F*   CD 5400*       C      	CALL	U1.RSAVE
  6212*   CD 54FB*       C      	CALL	U1.KTIN1
  6215*   CD 5611*       C      	CALL	XY.LIDX
  6218*   09             C      	DB	9
  6219*   E5             C      	PUSH	HL
  621A*   C1             C      	POP	BC	;BC:= Blocklaenge
  621B*   21 0000        C      	LD	HL,0
  621E*   CD 5621*       C      	CALL	XY.STDX	;Pufferzaehler = 0
  6221*   17             C      	DB	23
  6222*   CD 5601*       C      	CALL	XY.LDDX
  6225*   19             C      	DB	25
  6226*   CD 5621*       C      	CALL	XY.STDX	;Pufferzeiger setzen
  6229*   15             C      	DB	21
'Einzelzeicheneingabe fuer KMBG'	MACRO-80 3.44	09-Dec-81	PAGE	1-46


  622A*   21 0E65        C      	LD	HL,UE.PUF
  622D*   CD 5411*       C      	CALL	U1.CLRB
  6230*   CD 5408*       C      	CALL	U1.RRST
  6233*   C9             C      	RET
                         C      
                         C      ;*******************************************************************
                         C      ;
                         C      ;        Ausgabe eines Blockes auf KMBG
                         C      ;
                         C      ;*******************************************************************
  6234*                  C      UK.KBA:
  6234*   CD 5400*       C      	CALL	U1.RSAVE
  6237*   CD 620F*       C      	CALL	UK.KSPFB
  623A*   CD 5601*       C      	CALL	XY.LDDX
  623D*   07             C      	DB	7
  623E*   EB             C      	EX	DE,HL	;DE:= Blockadresse
  623F*   D5             C      	PUSH	DE	;Blockadresse retten
  6240*   CD 5611*       C      	CALL	XY.LIDX
  6243*   09             C      	DB	9
  6244*   E5             C      	PUSH	HL
  6245*   C1             C      	POP	BC	;BC:= Blocklaenge
  6246*   D1             C      	POP	DE	;DE:= Blockadresse
  6247*   C5             C      	PUSH	BC	;Blocklaenge retten
  6248*   CD 5601*       C      	CALL	XY.LDDX	;HL:= E/A-Pufferanfang
  624B*   19             C      	DB	25
  624C*   ED B0          C      	LDIR		;Block in Systempuffer
  624E*   C1             C      	POP	BC	;BC:= Blocklaenge
  624F*   E5             C      	PUSH	HL	;aktuelle Pufferadresse retten
  6250*   21 0132        C      	LD	HL,UE.KMPUL	;HL:= max. Laenge
  6253*   B7             C      	OR	A
  6254*   ED 42          C      	SBC	HL,BC	;HL:= Restbyteanzahl
  6256*   CD 5621*       C      	CALL	XY.STDX	;Pufferzaehler setzen
  6259*   17             C      	DB	23
  625A*   E5             C      	PUSH	HL
  625B*   C1             C      	POP	BC	;BC:= Restbyteanzahl
  625C*   CD 5601*       C      	CALL	XY.LDDX	;HL:= aktuelle Pufferadresse
  625F*   19             C      	DB	25
  6260*   EB             C      	EX	DE,HL	;DE:= Pufferanfang
  6261*   E1             C      	POP	HL
  6262*   ED B0          C      	LDIR
  6264*   EB             C      	EX	DE,HL	;HL:= aktuelle Pufferadresse
  6265*   CD 5621*       C      	CALL	XY.STDX	;Pufferzeiger setzen
  6268*   15             C      	DB	21
  6269*   DD 36 04 08    C      	LD	(IX+4),08H
  626D*   CD 5D2F*       C      	CALL	UF.EXEC	;physische Blockausgabe
  6270*   F5             C      	PUSH	AF
  6271*   CD 5641*       C      	CALL	XY.INCDX	;Blockzaehler erhoehen
  6274*   11             C      	DB	17
  6275*   F1             C      	POP	AF
  6276*   CD 5408*       C      	CALL	U1.RRST
  6279*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                                ;
                                ;	INCLUDE	KI.MAC	;Initialisieren von MRES Kassetten
                                ;	INCLUDE	KV.MAC	;Anzeigen und Aendern des MRES-Verzeichnisses
                                ;	INCLUDE	KH.MAC	;Kommandos: KRDx und KWRx
                                ;	INCLUDE	FD.MAC	;Ein-/Ausgabe im freien Format
                                ;	INCLUDE LD.MAC	;Laden von MRES-P-Dateien
                                ;	INCLUDE RL.MAC	;Relativloader fuer O-Dateien
                                ;	INCLUDE SV.MAC	;Retten von Maschinencodeprogrammen als MRES - P-Datei
                         C      	INCLUDE K3.MAC	;MRES Routinen
                         C      	TITLE	'Initialisieren von MRES Kassetten'
                         C      	PAGE
'Initialisieren von MRES Kassetten'	MACRO-80 3.44	09-Dec-81	PAGE	1-47


                         C      
                         C      ;	PN	KI
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;      INITIALISIEREN VON MRES KASSETTEN
                         C      ;
                         C      ;----------------------------------------------------------------------
  627A*   627A*          C      	DW	$
  627C*   49 4E 49 54    C      	DB	'INIT'
  6280*   21 4070        C      	LD	HL,PUF.KASS	;Puffer fuer Umbenennung Kassette loeschen
  6283*   11 4071        C      	LD	DE,PUF.KASS+1
  6286*   01 000F        C      	LD	BC,15
  6289*   36 20          C      	LD	(HL),020H
  628B*   ED B0          C      	LDIR
  628D*   3A 3327        C      	LD	A,(UE.BWSA + 10*80 +7)	;327H
  6290*   CD 55C5*       C      	CALL	U1.TST
  6293*   D8             C      	RET	C
  6294*   F5             C      	PUSH	AF
  6295*   CD 54E2*       C      	CALL	U1.KTINI
  6298*   F1             C      	POP	AF
  6299*   DD 77 03       C      	LD	(IX+3),A	;GERAETEADR. -->TAB
  629C*   CD 609F*       C      	CALL	UR.KRE	;RES. EIN
  629F*   DD CB 00 56    C      	BIT	2,(IX+0)
  62A3*   28 05          C      	JR	Z,$+7
  62A5*   3E 19          C      	LD	A,19H
  62A7*   CD 5D5F*       C      	CALL	UF.ERANZ
  62AA*   CD 60AD*       C      	CALL	UR.KRWW	;RUECKSPULEN MIT WARTEN
  62AD*   CD 60C3*       C      	CALL	UR.KBM	;BM SCHREIBEN
  62B0*   21 0E65        C      	LD	HL,UE.PUF	;AUFBAU 1.BLOCK
  62B3*   3E 40          C      	LD	A,40H
  62B5*   06 50          C      	LD	B,80
  62B7*   CD 55A6*       C      	CALL	U1.TR
  62BA*   3E 00          C      	LD	A,00H
  62BC*   06 30          C      	LD	B,48
  62BE*   CD 55A6*       C      	CALL	U1.TR
  62C1*   DD 36 0A 80    C      	LD	(IX+10),80H	;Blocklaenge
  62C5*   DD 36 04 08    C      	LD	(IX+4),08H	;CMD SCHREIBEN
  62C9*   CD 5D2F*       C      	CALL	UF.EXEC
  62CC*   CD 6379*       C      	CALL	KI.KO03
  62CF*                  C      KI.KN:
  62CF*   CD 55B1*       C      	CALL	U1.BILO
  62D2*   3E 0D          C      	LD	A,13
  62D4*   32 2B00*       C      	LD	(UB.ZN),A	;ZEILENNR. 15
  62D7*   21 5E29*       C      	LD	HL,UA.KNAME	;ABFRAGE KASS.NAME
  62DA*   CD 595C*       C      	CALL	UR.MIMO
  62DD*   D8             C      	RET	C
                         C      ;---\
  62DE*   E5             C      	PUSH	HL	;KassettenName fuer Umbenenung im Emulator merken
  62DF*   C5             C      	PUSH	BC
  62E0*   11 4070        C      	LD	DE,PUF.KASS
  62E3*   01 0006        C      	LD	BC,6
  62E6*   ED B0          C      	LDIR
  62E8*   C1             C      	POP	BC
  62E9*   E1             C      	POP	HL
                         C      ;---/
  62EA*   06 06          C      	LD	B,6
  62EC*   11 0E69        C      	LD	DE,UE.PUF+4	;NAME IN PUFFER
  62EF*   CD 57BA*       C      	CALL	UC.KONV	;MIT KONVERTIERUNG IN DKOI-CODE
  62F2*                  C      KI.NMR:
  62F2*   21 5E3C*       C      	LD	HL,UA.NR	;ABFR. KASS.NUMMER
  62F5*   CD 595C*       C      	CALL	UR.MIMO
  62F8*   38 D5          C      	JR	C,KI.KN	;BEI SYS-TASTE ZU VORHERIGER
                         C      ;---\
  62FA*   E5             C      	PUSH	HL	;Kassetten-Nr fuer Umbenenung im Emulator merken
  62FB*   C5             C      	PUSH	BC
  62FC*   11 4076        C      	LD	DE,PUF.KASS+6
  62FF*   01 0003        C      	LD	BC,3
  6302*   ED B0          C      	LDIR
  6304*   C1             C      	POP	BC
  6305*   E1             C      	POP	HL
                         C      ;---/
  6306*   06 03          C      	LD	B,3
  6308*   11 0E8A        C      	LD	DE,UE.PUF+37
  630B*   CD 57BA*       C      	CALL	UC.KONV
  630E*                  C      KI.KM:
  630E*   21 5E4F*       C      	LD	HL,UA.KOMMT	;ABFR. KOMMENTAR
  6311*   CD 595C*       C      	CALL	UR.MIMO
  6314*   38 B9          C      	JR	C,KI.KN
  6316*   06 0B          C      	LD	B,11
  6318*   11 0E8D        C      	LD	DE,UE.PUF+40
  631B*   CD 57BA*       C      	CALL	UC.KONV
  631E*   CD 5D2F*       C      	CALL	UF.EXEC	;3.BLOCK SCHREIBEN
'Initialisieren von MRES Kassetten'	MACRO-80 3.44	09-Dec-81	PAGE	1-48


  6321*   CD 6384*       C      	CALL	KI.RENA	;Kassette umbenennen
  6324*   CD 60C3*       C      	CALL	UR.KBM	;BM , 1.LABEL BEENDET
  6327*   21 607F*       C      	LD	HL,UA.ALTR
  632A*   11 0E65        C      	LD	DE,UE.PUF
  632D*   01 0020        C      	LD	BC,20H
  6330*   ED B0          C      	LDIR		;AUSGLEICH LFWSTLNZ->PUFFER
  6332*   DD 36 0A 20    C      	LD	(IX+10),20H	;NEUE BLOCKLAENGE
  6336*   DD 36 04 08    C      	LD	(IX+4),08H
  633A*   CD 5D2F*       C      	CALL	UF.EXEC	;SCHREIBEN
  633D*   21 5E09*       C      	LD	HL,UA.DS
  6340*   11 0E65        C      	LD	DE,UE.PUF
  6343*   01 0020        C      	LD	BC,32
  6346*   ED B0          C      	LDIR		;DS-SATZ --> PUFFER
  6348*   CD 5D2F*       C      	CALL	UF.EXEC
  634B*   3E A5          C      	LD	A,0A5H
  634D*   06 20          C      	LD	B,32
  634F*   21 0E65        C      	LD	HL,UE.PUF
  6352*   CD 55A6*       C      	CALL	U1.TR
  6355*   06 68          C      	LD	B,68H	;103 VERZ.SAETZE
  6357*                  C      KI.VERZ:
  6357*   C5             C      	PUSH	BC
  6358*   CD 5D2F*       C      	CALL	UF.EXEC
  635B*   C1             C      	POP	BC
  635C*   10 F9          C      	DJNZ	KI.VERZ
  635E*   CD 60C3*       C      	CALL	UR.KBM
  6361*   CD 547F*       C      	CALL	U1.VS1	;1.DATEIVORSATZ -->PUFFER
  6364*   DD 36 0A 20    C      	LD	(IX+10),020H
  6368*   DD 36 04 08    C      	LD	(IX+4),08H
  636C*   CD 5D2F*       C      	CALL	UF.EXEC
  636F*   CD 60C9*       C      	CALL	UR.KSL	;SCHLUSSLUECKE SCHREIBEN
  6372*   CD 60A7*       C      	CALL	UR.KRW
  6375*   CD 60B1*       C      	CALL	UR.KRA
  6378*   C9             C      	RET
                         C      ;
  6379*                  C      KI.KO03:
  6379*   CD 5D2F*       C      	CALL	UF.EXEC	;FUER KI14
  637C*   06 31          C      	LD	B,49
  637E*   2B             C      	DEC	HL
  637F*   10 FD          C      	DJNZ	$-1
  6381*   36 D9          C      	LD	(HL),0D9H
  6383*   C9             C      	RET
                         C      ;
  6384*                  C      KI.RENA:	;Kassettendateiname umbenennen
  6384*   E5             C      	PUSH	HL
  6385*   D5             C      	PUSH	DE
  6386*   C5             C      	PUSH	BC
  6387*   F5             C      	PUSH	AF
  6388*   21 407A        C      	LD	HL,PUF.KASS+10
  638B*   36 00          C      	LD	(HL),0          ;Abschluss neuer Name
  638D*   21 63A3*       C      	LD	HL,KI.RENA9+2
  6390*   DD 7E 03       C      	LD	A,(IX+3)        ;SubAdresse
  6393*   77             C      	LD	(HL),A
  6394*   21 63A1*       C      	LD	HL,KI.RENA9
  6397*   01 0730        C      	LD	BC,00700H + AKB ;AKB-Adresse + Laenge Parameterbereich
  639A*   ED B3          C      	OTIR
  639C*   F1             C      	POP	AF
  639D*   C1             C      	POP	BC
  639E*   D1             C      	POP	DE
  639F*   E1             C      	POP	HL
  63A0*   C9             C      	RET
  63A1*                  C      KI.RENA9:
  63A1*   F0             C      	DB	0F0H
  63A2*   44             C      	DB	044H            ;Kommando
  63A3*   00             C      	DB	0               ;SubAdresse
  63A4*   01             C      	DB	1               ;HSbereich
  63A5*   40             C      	DB	HIGH(PUF.KASS)
  63A6*   70             C      	DB	LOW(PUF.KASS)
  63A7*   FF             C      	DB	0FFH
                         C      ;---------------------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Anzeigen und Aendern des MRES-Verzeichnisses'
                         C      	PAGE
'Anzeigen und Aendern des MRES-Verzeichnisses'	MACRO-80 3.44	09-Dec-81	PAGE	1-49


                         C      
                         C      ;	PN	KV
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;    ANZEIGEN UND AENDERN DES VERZEICHNISSES VON MRES KASSETTEN
                         C      ;
                         C      ;----------------------------------------------------------------------
  63A8*   63A8*          C      	DW	$
  63AA*   44 49 52 20    C      	DB	'DIR '
  63AE*   3A 3326        C      	LD	A,(UE.BWSA + 10*80 +6)	;326H
  63B1*   CD 55C5*       C      	CALL	U1.TST
  63B4*   D8             C      	RET	C
  63B5*   CD 54E2*       C      	CALL	U1.KTINI
  63B8*   DD 77 03       C      	LD	(IX+3),A
  63BB*   CD 55B1*       C      	CALL	U1.BILO
  63BE*   CD 609F*       C      	CALL	UR.KRE
  63C1*   CD 60AD*       C      	CALL	UR.KRWW
  63C4*   CD 5496*       C      	CALL	U1.DSVG
  63C7*   C5             C      	PUSH	BC
                         C      ;----------------------------------------------------------------------
  63C8*   CD 5420*       C      	CALL	U1.KBR4	;KASS.NAME,NR.,KOMMENTAR ANZEIGEN
  63CB*   DD 36 04 02    C      	LD	(IX+4),02H
  63CF*   CD 5D2F*       C      	CALL	UF.EXEC
  63D2*   21 0E69        C      	LD	HL,UE.PUF+4
  63D5*   11 3240        C      	LD	DE,UE.BWSA + 7*80 + 16	;3240H	;=8.ZEILE,16.SPALTE
  63D8*   06 06          C      	LD	B,6
  63DA*   CD 57B0*       C      	CALL	UC.DKONV
  63DD*   21 0E8A        C      	LD	HL,UE.PUF+37
  63E0*   13             C      	INC	DE
  63E1*   13             C      	INC	DE
  63E2*   06 03          C      	LD	B,3
  63E4*   CD 57B0*       C      	CALL	UC.DKONV
  63E7*   13             C      	INC	DE
  63E8*   13             C      	INC	DE
  63E9*   06 0B          C      	LD	B,11
  63EB*   CD 57B0*       C      	CALL	UC.DKONV
  63EE*   21 3290        C      	LD	HL,UE.BWSA + 8*80 + 16	;3290H
  63F1*   3E 3D          C      	LD	A,'='
  63F3*   77             C      	LD	(HL),A
  63F4*   E5             C      	PUSH	HL
  63F5*   D1             C      	POP	DE
  63F6*   13             C      	INC	DE
  63F7*   01 0017        C      	LD	BC,23
  63FA*   ED B0          C      	LDIR
                         C      ;----------------------------------------------------------------------
  63FC*   06 03          C      	LD	B,3	;POSITIONIEREN VOR DS-SATZ
  63FE*   CD 5D2F*       C      	CALL	UF.EXEC
  6401*   10 FB          C      	DJNZ	$-3
  6403*   CD 5518*       C      	CALL	U1.VERIN
  6406*   CD 60AD*       C      	CALL	UR.KRWW
  6409*   06 07          C      	LD	B,7
  640B*   CD 5542*       C      	CALL	U1.VORS1
  640E*   C1             C      	POP	BC
  640F*   05             C      	DEC	B
  6410*   CD 663D*       C      	CALL	KV.ANZ
  6413*   04             C      	INC	B
  6414*   05             C      	DEC	B
  6415*   CA 655F*       C      	JP	Z,KV.KRW
  6418*   04             C      	INC	B
  6419*   C5             C      	PUSH	BC
                         C      ;----------------------------------------------------------------------
  641A*                  C      KV.ANF:
  641A*   05             C      	DEC	B
  641B*   78             C      	LD	A,B
  641C*   58             C      	LD	E,B
  641D*   D6 09          C      	SUB	9
  641F*   38 05          C      	JR	C,$+7
  6421*   0E 09          C      	LD	C,9
  6423*   41             C      	LD	B,C
  6424*   18 03          C      	JR	$+5
  6426*   43             C      	LD	B,E
  6427*   48             C      	LD	C,B
  6428*   AF             C      	XOR	A
  6429*   F5             C      	PUSH	AF	;A=RESTL.ANZAHL ODER 0
  642A*   C5             C      	PUSH	BC
  642B*   21 2B34*       C      	LD	HL,UB.SATZ
  642E*   36 00          C      	LD	(HL),00H
  6430*   23             C      	INC	HL
  6431*   36 37          C      	LD	(HL),55
  6433*   23             C      	INC	HL
  6434*   36 80          C      	LD	(HL),80H
  6436*   23             C      	INC	HL
'Anzeigen und Aendern des MRES-Verzeichnisses'	MACRO-80 3.44	09-Dec-81	PAGE	1-50


  6437*   06 37          C      	LD	B,55
  6439*   3E 20          C      	LD	A,20H
  643B*   CD 55A6*       C      	CALL	U1.TR	;AUSGABESATZ LOESCHEN
  643E*   3E 0D          C      	LD	A,13
  6440*   32 2B00*       C      	LD	(UB.ZN),A
  6443*   CD 55B1*       C      	CALL	U1.BILO
  6446*   11 2B46*       C      	LD	DE,UB.SATZ+18
  6449*   D5             C      	PUSH	DE
  644A*   21 ECA2        C      	LD	HL,BC.VTABE+32	;ADR. VERZ.TABELLE
  644D*   E5             C      	PUSH	HL
                         C      ;---------------------------MAX 9 SAETZE ANZEIGEN----------------------
  644E*                  C      KV.ZLTR:
  644E*   CD 65C5*       C      	CALL	KV.BSTR	;VTABE-->UB.SATZ
  6451*   D1             C      	POP	DE	;VERZ.ADR.
  6452*   E1             C      	POP	HL	;ADR.AUSGABESATZ
  6453*   E5             C      	PUSH	HL
  6454*   D5             C      	PUSH	DE
  6455*   01 0012        C      	LD	BC,18
  6458*   B7             C      	OR	A
  6459*   ED 42          C      	SBC	HL,BC
  645B*   CD 595C*       C      	CALL	UR.MIMO	;ANZEIGE EINE ZEILE
  645E*   E1             C      	POP	HL	;VERZ.ADR
  645F*   D1             C      	POP	DE
  6460*   01 0020        C      	LD	BC,32
  6463*   09             C      	ADD	HL,BC
  6464*   C1             C      	POP	BC
  6465*   05             C      	DEC	B
  6466*   28 05          C      	JR	Z,$+7
  6468*   C5             C      	PUSH	BC
  6469*   D5             C      	PUSH	DE
  646A*   E5             C      	PUSH	HL	;NEUE VERZ.TAB ADR
  646B*   18 E1          C      	JR	KV.ZLTR
                         C      ;----------------------------------------------------------------------
  646D*   41             C      	LD	B,C	;ANZAHL DER ANGEZEIGTEN ZEILEN
  646E*   3A 2B00*       C      	LD	A,(UB.ZN)
  6471*   90             C      	SUB	B
  6472*   32 2B00*       C      	LD	(UB.ZN),A	;KURSOR AUF ANFANG 12.ZEILE
  6475*   C5             C      	PUSH	BC
  6476*   D5             C      	PUSH	DE
  6477*   E5             C      	PUSH	HL
                         C      ;------------------------VERZ. ZEIGER AUF 1.ANGEZEIGTE EINTR.
  6478*   C5             C      	PUSH	BC
  6479*   01 0020        C      	LD	BC,32
  647C*   B7             C      	OR	A
  647D*   ED 42          C      	SBC	HL,BC
  647F*   C1             C      	POP	BC
  6480*   10 F6          C      	DJNZ	$-8
  6482*   E5             C      	PUSH	HL
                         C      ;----------------------------------------------------------------------
  6483*                  C      KV.TABTR:
  6483*   21 603B*       C      	LD	HL,UA.LD
  6486*   CD 595C*       C      	CALL	UR.MIMO	;KURSOR AUF ANF.12.ZEILE
  6489*   DA 64C9*       C      	JP	C,KV.ZEIHO
  648C*   D1             C      	POP	DE
  648D*   D5             C      	PUSH	DE	;ZIELADR.IN VTAB
  648E*   CD 65F2*       C      	CALL	KV.SPTR	;ZEILE WIEDER IN SPEICHER
  6491*   E1             C      	POP	HL	;ZIELADR.IN VTAB
  6492*   01 0020        C      	LD	BC,32
  6495*   09             C      	ADD	HL,BC
  6496*   FD E1          C      	POP	IY
  6498*   D1             C      	POP	DE
  6499*   C1             C      	POP	BC
  649A*   05             C      	DEC	B
  649B*   28 07          C      	JR	Z,$+9
  649D*   C5             C      	PUSH	BC
  649E*   D5             C      	PUSH	DE
  649F*   FD E5          C      	PUSH	IY
  64A1*   E5             C      	PUSH	HL
  64A2*   18 DF          C      	JR	KV.TABTR
                         C      ;--------------------WEITERBLAETTERN ODER AUSGABE----------------------
  64A4*   F1             C      	POP	AF
  64A5*   B7             C      	OR	A
  64A6*   28 42          C      	JR	Z,KV.AUSG	;KEINE WEITEREN ANZEIGEN
  64A8*   D6 09          C      	SUB	9
  64AA*   38 05          C      	JR	C,$+7
  64AC*   06 09          C      	LD	B,9
  64AE*   48             C      	LD	C,B
  64AF*   18 05          C      	JR	$+7
  64B1*   C6 09          C      	ADD	A,9
  64B3*   47             C      	LD	B,A
  64B4*   48             C      	LD	C,B
  64B5*   AF             C      	XOR	A
  64B6*   F5             C      	PUSH	AF
'Anzeigen und Aendern des MRES-Verzeichnisses'	MACRO-80 3.44	09-Dec-81	PAGE	1-51


  64B7*   C5             C      	PUSH	BC
  64B8*   D5             C      	PUSH	DE
  64B9*   E5             C      	PUSH	HL
  64BA*   3E 0D          C      	LD	A,13
  64BC*   32 2B00*       C      	LD	(UB.ZN),A
  64BF*   CD 55B1*       C      	CALL	U1.BILO
  64C2*   E1             C      	POP	HL
  64C3*   D1             C      	POP	DE
  64C4*   D5             C      	PUSH	DE
  64C5*   E5             C      	PUSH	HL
  64C6*   C3 644E*       C      	JP	KV.ZLTR
                         C      ;----------------------------------------------------------------------
  64C9*                  C      KV.ZEIHO:
  64C9*   21 2B00*       C      	LD	HL,UB.ZN
  64CC*   7E             C      	LD	A,(HL)
  64CD*   D6 0F          C      	SUB	15
  64CF*   38 15          C      	JR	C,$+23	;WENN IN 12. ZEILE SYS GEDRUECKT
  64D1*   35             C      	DEC	(HL)
  64D2*   35             C      	DEC	(HL)	;ZEILENNR.-2
  64D3*   E1             C      	POP	HL
  64D4*   01 0020        C      	LD	BC,32
  64D7*   B7             C      	OR	A
  64D8*   ED 42          C      	SBC	HL,BC	;VERZ.ZEIGER RUECKSETZEN
  64DA*   FD E1          C      	POP	IY
  64DC*   D1             C      	POP	DE
  64DD*   C1             C      	POP	BC
  64DE*   04             C      	INC	B
  64DF*   C5             C      	PUSH	BC
  64E0*   D5             C      	PUSH	DE
  64E1*   FD E5          C      	PUSH	IY
  64E3*   E5             C      	PUSH	HL
  64E4*   18 01          C      	JR	$+3
  64E6*   35             C      	DEC	(HL)
  64E7*   C3 6483*       C      	JP	KV.TABTR
                         C      ;----------------------------------------------------------------------
  64EA*                  C      KV.AUSG:
  64EA*   E5             C      	PUSH	HL
  64EB*   21 604D*       C      	LD	HL,UA.ZRSCH
  64EE*   CD 595C*       C      	CALL	UR.MIMO
  64F1*   7E             C      	LD	A,(HL)
  64F2*   E1             C      	POP	HL
  64F3*   FE 4A          C      	CP	'J'
  64F5*   28 11          C      	JR	Z,$+19
  64F7*   21 6066*       C      	LD	HL,UA.ANZWD
  64FA*   CD 595C*       C      	CALL	UR.MIMO
  64FD*   7E             C      	LD	A,(HL)
  64FE*   FE 4A          C      	CP	'J'
  6500*   C1             C      	POP	BC
  6501*   C2 655F*       C      	JP	NZ,KV.KRW
  6504*   C5             C      	PUSH	BC
  6505*   C3 641A*       C      	JP	KV.ANF
                         C      ;--------------------------------Dateien am Ende loeschen ? ---------
  6508*   CD 6633*       C      	CALL	KV.SBC
  650B*   20 34          C      	JR	NZ,$+54
  650D*   3A EC85        C      	LD	A,(BC.VTABE+3)
  6510*   3D             C      	DEC	A
  6511*   5F             C      	LD	E,A
  6512*   16 00          C      	LD	D,0
  6514*   3E 01          C      	LD	A,1
  6516*   82             C      	ADD	A,D
  6517*   57             C      	LD	D,A
  6518*   1D             C      	DEC	E
  6519*   28 05          C      	JR	Z,$+7
  651B*   CD 6633*       C      	CALL	KV.SBC
  651E*   28 F4          C      	JR	Z,$-10
  6520*   C1             C      	POP	BC	;D: Anzahl zu loeschender Dateien
  6521*   79             C      	LD	A,C
  6522*   92             C      	SUB	D
  6523*   32 0E66        C      	LD	(UE.PUF+1),A	;DS-Satz korrigieren
  6526*   78             C      	LD	A,B
  6527*   92             C      	SUB	D
  6528*   32 0E68        C      	LD	(UE.PUF+3),A
  652B*   CD 60D5*       C      	CALL	UR.KBR
  652E*   CD 60D5*       C      	CALL	UR.KBR
  6531*   CD 60CF*       C      	CALL	UR.KBV
  6534*   DD 36 04 08    C      	LD	(IX+4),08H
  6538*   CD 5D2F*       C      	CALL	UF.EXEC	;und schreiben
  653B*   47             C      	LD	B,A
  653C*   05             C      	DEC	B
  653D*   28 20          C      	JR	Z,$+34
  653F*   04             C      	INC	B
  6540*   C5             C      	PUSH	BC
                         C      ;-------------------------------------Verzeichnis schreiben -----------
'Anzeigen und Aendern des MRES-Verzeichnisses'	MACRO-80 3.44	09-Dec-81	PAGE	1-52


  6541*   C1             C      	POP	BC
  6542*   05             C      	DEC	B
  6543*   21 ECA2        C      	LD	HL,BC.VTABE+32
  6546*   C5             C      	PUSH	BC
  6547*   11 0E65        C      	LD	DE,UE.PUF
  654A*   01 0020        C      	LD	BC,32
  654D*   ED B0          C      	LDIR
  654F*   CD 60CF*       C      	CALL	UR.KBV
  6552*   CD 60D5*       C      	CALL	UR.KBR
  6555*   DD 36 04 08    C      	LD	(IX+4),08H	;OHNE RAW
  6559*   CD 5D2F*       C      	CALL	UF.EXEC
  655C*   C1             C      	POP	BC
  655D*   10 E7          C      	DJNZ	$-23
                         C      ;---------------------------------------------------------------------
  655F*                  C      KV.KRW:
  655F*   CD 60A7*       C      	CALL	UR.KRW
  6562*   CD 60B1*       C      	CALL	UR.KRA
  6565*   3A 3328        C      	LD	A,(UE.BWSA+328H)
  6568*   FE 44          C      	CP	'D'
  656A*   C0             C      	RET	NZ
  656B*   21 323D        C      	LD	HL,UE.BWSA+23DH
  656E*   00             C      	NOP
  656F*   CD 65AB*       C      	CALL	KV.DRU1
  6572*   21 328D        C      	LD	HL,UE.BWSA+28DH
  6575*   CD 65AB*       C      	CALL	KV.DRU1
  6578*   CD 4040        C      	CALL	PRINT
  657B*   21 2B6E*       C      	LD	HL,UB.DTAB
  657E*   11 2B6F*       C      	LD	DE,UB.DTAB+1
  6581*   01 0028        C      	LD	BC,40
  6584*   36 20          C      	LD	(HL),20H
  6586*   ED B0          C      	LDIR
  6588*   3A EC85        C      	LD	A,(BC.VTABE+3)
  658B*   47             C      	LD	B,A
  658C*   05             C      	DEC	B
  658D*   21 EC82        C      	LD	HL,BC.VTABE
  6590*   11 0020        C      	LD	DE,32
  6593*                  C      KV.P1:
  6593*   C5             C      	PUSH	BC
  6594*   19             C      	ADD	HL,DE
  6595*   E5             C      	PUSH	HL
  6596*   D5             C      	PUSH	DE
  6597*   11 2B6E*       C      	LD	DE,UB.DTAB
  659A*   CD 65C5*       C      	CALL	KV.BSTR
  659D*   21 2B6E*       C      	LD	HL,UB.DTAB
  65A0*   06 28          C      	LD	B,40
  65A2*   CD 65AD*       C      	CALL	KV.DRU
  65A5*   D1             C      	POP	DE
  65A6*   E1             C      	POP	HL
  65A7*   C1             C      	POP	BC
  65A8*   10 E9          C      	DJNZ	KV.P1
  65AA*   C9             C      	RET
                         C      
  65AB*                  C      KV.DRU1:
  65AB*   06 1E          C      	LD	B,30
  65AD*                  C      KV.DRU:
  65AD*   7E             C      	LD	A,(HL)
  65AE*   23             C      	INC	HL
  65AF*   CD 65BA*       C      	CALL	KV.KO02
  65B2*   10 F9          C      	DJNZ	KV.DRU
  65B4*   3E 1E          C      	LD	A,1EH
  65B6*   CD 4040        C      	CALL	PRINT
  65B9*   C9             C      	RET
                         C      ;
  65BA*                  C      KV.KO02:
  65BA*   CB BF          C      	RES	7,A	;FUER KV17 (DRUCKERAUSGABE)
  65BC*   FE 20          C      	CP	20H
  65BE*   30 02          C      	JR	NC,$+4
  65C0*   3E 2A          C      	LD	A,2AH
  65C2*   C3 4040        C      	JP	PRINT
                         C      ;---------------------------------------------------------------------
  65C5*                  C      KV.BSTR:
  65C5*   01 0006        C      	LD	BC,6	;Aufbereitung des Verz.Satzes
  65C8*   C5             C      	PUSH	BC
  65C9*   ED B0          C      	LDIR		;Transport VTABE--->UB.SATZ
  65CB*   13             C      	INC	DE
  65CC*   13             C      	INC	DE
  65CD*   13             C      	INC	DE
  65CE*   01 0002        C      	LD	BC,2
  65D1*   ED B0          C      	LDIR
  65D3*   13             C      	INC	DE
  65D4*   13             C      	INC	DE
  65D5*   13             C      	INC	DE
  65D6*   C1             C      	POP	BC
'Anzeigen und Aendern des MRES-Verzeichnisses'	MACRO-80 3.44	09-Dec-81	PAGE	1-53


  65D7*   C5             C      	PUSH	BC
  65D8*   ED B0          C      	LDIR
  65DA*   13             C      	INC	DE
  65DB*   13             C      	INC	DE
  65DC*   13             C      	INC	DE
  65DD*   C1             C      	POP	BC
  65DE*   ED B0          C      	LDIR
  65E0*   13             C      	INC	DE
  65E1*   13             C      	INC	DE
  65E2*   13             C      	INC	DE
  65E3*   01 0003        C      	LD	BC,3
  65E6*   ED B0          C      	LDIR
  65E8*   13             C      	INC	DE
  65E9*   13             C      	INC	DE
  65EA*   13             C      	INC	DE
  65EB*   6E             C      	LD	L,(HL)	;Konvertierung Labelnummer
  65EC*   26 00          C      	LD	H,0
  65EE*   CD 571C*       C      	CALL	UC.CVBD2
  65F1*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  65F2*                  C      KV.SPTR:
  65F2*   7E             C      	LD	A,(HL)
  65F3*   FE 09          C      	CP	09H	;Soll Satz geloescht werden?
  65F5*   20 02          C      	JR	NZ,$+4
  65F7*   AF             C      	XOR	A
  65F8*   77             C      	LD	(HL),A
  65F9*   01 0006        C      	LD	BC,6
  65FC*   C5             C      	PUSH	BC
  65FD*   ED B0          C      	LDIR		;Ruecktransport BWSA--->VTABE
  65FF*   23             C      	INC	HL
  6600*   23             C      	INC	HL
  6601*   23             C      	INC	HL
  6602*   01 0002        C      	LD	BC,2
  6605*   ED B0          C      	LDIR
  6607*   23             C      	INC	HL
  6608*   23             C      	INC	HL
  6609*   23             C      	INC	HL
  660A*   C1             C      	POP	BC
  660B*   C5             C      	PUSH	BC
  660C*   ED B0          C      	LDIR
  660E*   23             C      	INC	HL
  660F*   23             C      	INC	HL
  6610*   23             C      	INC	HL
  6611*   C1             C      	POP	BC
  6612*   ED B0          C      	LDIR
  6614*   23             C      	INC	HL
  6615*   23             C      	INC	HL
  6616*   23             C      	INC	HL
  6617*   01 0003        C      	LD	BC,3
  661A*   ED B0          C      	LDIR
  661C*   23             C      	INC	HL
  661D*   23             C      	INC	HL
  661E*   23             C      	INC	HL
  661F*   D5             C      	PUSH	DE
  6620*   EB             C      	EX	DE,HL
  6621*   CD 6628*       C      	CALL	KV.DBCVM
  6624*   7D             C      	LD	A,L
  6625*   E1             C      	POP	HL
  6626*   77             C      	LD	(HL),A
  6627*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  6628*                  C      KV.DBCVM:
  6628*   06 02          C      	LD	B,2	;FELDLAENGE
  662A*   CD 5761*       C      	CALL	UC.CVDB	;KONVERTIER. DEZI-->BINAER
  662D*   D0             C      	RET	NC		;OHNE FEHLER
  662E*   C0             C      	RET	NZ
  662F*   13             C      	INC	DE	;1.ZEICHEN WAR KEINE DEZ.ZAHL
  6630*   10 F8          C      	DJNZ	$-6
  6632*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  6633*                  C      KV.SBC:
  6633*   01 0020        C      	LD	BC,32
  6636*   B7             C      	OR	A
  6637*   ED 42          C      	SBC	HL,BC
  6639*   7E             C      	LD	A,(HL)
  663A*   FE 00          C      	CP	00H
  663C*   C9             C      	RET
                         C      ;---------------------------------------------------------------------
  663D*                  C      KV.ANZ:
  663D*   C5             C      	PUSH	BC
  663E*   68             C      	LD	L,B
  663F*   26 00          C      	LD	H,0
  6641*   11 3332        C      	LD	DE,3332H
'Anzeigen und Aendern des MRES-Verzeichnisses'	MACRO-80 3.44	09-Dec-81	PAGE	1-54


  6644*   CD 5718*       C      	CALL	UC.CVBD3
  6647*   13             C      	INC	DE
  6648*   13             C      	INC	DE
  6649*   21 6653*       C      	LD	HL,KV.AVZS
  664C*   01 0011        C      	LD	BC,17
  664F*   ED B0          C      	LDIR
  6651*   C1             C      	POP	BC
  6652*   C9             C      	RET
                         C      ;-----------------------------------------------------------------------
  6653*                  C      KV.AVZS:
  6653*   56 65 72 7A    C      	DB	'Verzeichnissaetze'
  6657*   65 69 63 68    C      
  665B*   6E 69 73 73    C      
  665F*   61 65 74 7A    C      
  6663*   65             C      
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Kommandos: KRDx und KWRx'
                         C      	PAGE
'Kommandos: KRDx und KWRx'	MACRO-80 3.44	09-Dec-81	PAGE	1-55


                         C      
                         C      ;	PN	KH
                         C      ;**********************************************************************
                         C      ;
                         C      ;   Kommando:
                         C      ;        KRDx...Block einlesen und anzeigen
                         C      ;               zusaetlich werden die entsprechenden Puffer-
                         C      ;               adressen angezeigt.
                         C      ;        KWRx...Block schreiben, standardmaessig nach 'KRDx'
                         C      ;               Ansonsten muessen Blockadresse und Blocklaenge in der
                         C      ;               Verstaendigungstabelle eingetragen werden.
                         C      ;
                         C      ;**********************************************************************
  6664*   6664*          C      	DW	$
  6666*   4B 52 57 31    C      	DB	'KRW1'
  666A*   18 06          C      	JR	KH.RDSTA
                         C      ;
  666C*   666C*          C      	DW	$
  666E*   4B 52 57 32    C      	DB	'KRW2'
  6672*                  C      KH.RDSTA:
  6672*   CD 54E2*       C      	CALL	U1.KTINI	;Initialisierung E/A-Tab.
  6675*   3A 3325        C      	LD	A,(UE.BWSA + 10*80 + 5)	;325H i von KRDi
  6678*   E6 0F          C      	AND	0FH
  667A*   DD 77 03       C      	LD	(IX+3),A	;Subadresse eintragen
  667D*                  C      KH.RES:
  667D*                  C      KH.KSRE:
  667D*   CD 609F*       C      	CALL	UR.KRE	;Reservieren
  6680*                  C      KH.RD1:
  6680*                  C      KH.KSRW:
  6680*   DD 36 04 21    C      	LD	(IX+4),021H	;umspulen (rewind)
  6684*   CD 5D2F*       C      	CALL	UF.EXEC
  6687*   C3 670C*       C      	JP		KH.RDBA
                         C      ;
                         C      ;	Z Y K L U S  ueber Tastatureingaben
  668A*                  C      KH.RD3:	;Zyklus
  668A*   DD 36 0A 00    C      	LD	(IX+10),0	;Anzahl Bandmarken
  668E*   CD 5A88*       C      	CALL	UR.TAREP	;Tastaturabfrage
  6691*   FE 80          C      	CP	080H
  6693*   28 E8          C      	JR	Z,KH.KSRE	;---> P 01	Reservieren EIN
  6695*   FE 82          C      	CP	082H
  6697*   28 2A          C      	JR	Z,KH.KSRA	;---> P 03	Reservieren AUS
  6699*   FE 81          C      	CP	081H
  669B*   28 E3          C      	JR	Z,KH.KSRW	;---> P 02	Rewind
                         C      
  669D*   FE 83          C      	CP	083H
  669F*   28 31          C      	JR	Z,KH.KSRP	;---> P 04	        read; display
  66A1*   FE 85          C      	CP	085H
  66A3*   28 2A          C      	JR	Z,KH.KSRM	;---> P 06	R-; R-; read; display
                         C      
  66A5*   DD 36 0A 01    C      	LD	(IX+10),1	;Anzahl Bandmarken
  66A9*   FE 86          C      	CP	086H
  66AB*   28 3C          C      	JR	Z,KH.BMP	;---> P07	BM+
  66AD*   FE 88          C      	CP	088H
  66AF*   28 40          C      	JR	Z,KH.BMM	;---> P09	BM-
                         C      
  66B1*   FE 89          C      	CP	089H
  66B3*   28 41          C      	JR	Z,KH.WREC	;---> P10	write Record
  66B5*   FE 8A          C      	CP	08AH
  66B7*   28 49          C      	JR	Z,KH.WBM	;---> P11	write BM
  66B9*   FE 8B          C      	CP	08BH
  66BB*   28 47          C      	JR	Z,KH.WSL	;---> P11	write SL
                         C      
  66BD*   FE CD          C      	CP	0CDH
  66BF*   28 45          C      	JR	Z,KH.SYSRT	;---> SYS
                         C      
  66C1*   18 C7          C      	JR	KH.RD3
                         C      
                         C      ;	P 03	Reservieren AUS
  66C3*                  C      KH.KSRA:
  66C3*   DD 36 04 21    C      	LD	(IX+4),021H	;umspulen (rewind)
  66C7*   CD 5D2F*       C      	CALL	UF.EXEC
  66CA*   CD 60B1*       C      	CALL	UR.KRA
  66CD*   18 3D          C      	JR		KH.RDBA
                         C      
                         C      ;	P 06	R-; R-; read; display
  66CF*                  C      KH.KSRM:
  66CF*   CD 676E*       C      	CALL	KH.RD2
                         C      ;	P 04	        read; display
  66D2*                  C      KH.KSRP:
  66D2*   DD 36 04 02    C       	LD	(IX+4),002H	;naechst Record lesen
  66D6*   CD 5D2F*       C      	CALL	UF.EXEC
  66D9*   DD 7E 0A       C      	LD	A,(IX+10)	;Lade die Laenge des Blockes
'Kommandos: KRDx und KWRx'	MACRO-80 3.44	09-Dec-81	PAGE	1-56


  66DC*   FE 01          C      	CP	1	;Laenge = 1, dann BandMarke
  66DE*   28 3D          C      	JR	Z,KH.RDBM
  66E0*   FE 02          C      	CP	2	;Laenge = 2, dann Schlussluecke
  66E2*   28 4A          C      	JR	Z,KH.RDSL
  66E4*   CD 673F*       C      	CALL	KH.ANZBL	;Block anzeigen
  66E7*   18 A1          C      	JR	KH.RD3
                         C      
                         C      ;	P 07	BM+
  66E9*                  C      KH.BMP:
  66E9*   CD 60B7*       C      	CALL	UR.KLV	;Bandmarke vorsetzen
  66EC*   CD 60D5*       C      	CALL	UR.KBR	;Record    zuruecksetzen
  66EF*   18 E1          C      	JR	KH.KSRP
                         C      ;	P 09	BM-
  66F1*                  C      KH.BMM:
  66F1*   CD 60BD*       C      	CALL	UR.KLR	;Bandmarke zurC<cksetzen
  66F4*   18 DC          C      	JR	KH.KSRP
                         C      
                         C      ;	P 10	write Record
  66F6*                  C      KH.WREC:
  66F6*   DD 36 04 08    C      	LD	(IX+4),08H
  66FA*   CD 5D2F*       C      	CALL	UF.EXEC
  66FD*   CD 60D5*       C      	CALL	UR.KBR
  6700*   18 88          C      	JR	KH.RD3
                         C      
                         C      ;	P 11	write BM
  6702*                  C      KH.WBM:
  6702*   18 86          C      	JR	KH.RD3
                         C      
                         C      ;	P 12	write SL
  6704*                  C      KH.WSL:
  6704*   18 84          C      	JR	KH.RD3
                         C      
                         C      ;	SYS		Systemruecksprung
  6706*                  C      KH.SYSRT:
  6706*   CD 67E8*       C      	CALL	KH.BILO
  6709*   C3 000B        C      	JP	SY.SYSTB
                         C      
  670C*                  C      KH.RDBA:
  670C*   CD 67E8*       C      	CALL	KH.BILO
  670F*   21 601B*       C      	LD	HL,UA.ZKBA	;"Bandanfang"
  6712*   11 3000        C      	LD	DE,UE.BWSA
  6715*   01 000A        C      	LD	BC,UA.ZKBM-UA.ZKBA
  6718*   ED B0          C      	LDIR
  671A*   C3 668A*       C      	JP	KH.RD3
                         C      
  671D*                  C      KH.RDBM:
  671D*   CD 67E8*       C      	CALL	KH.BILO
  6720*   21 6025*       C      	LD	HL,UA.ZKBM	;"Bandmarke"
  6723*   11 3000        C      	LD	DE,UE.BWSA
  6726*   01 0009        C      	LD	BC,UA.ZKSL-UA.ZKBM
  6729*   ED B0          C      	LDIR
  672B*   C3 668A*       C      	JP	KH.RD3
                         C      
  672E*                  C      KH.RDSL:
  672E*   CD 67E8*       C      	CALL	KH.BILO
  6731*   21 602E*       C      	LD	HL,UA.ZKSL	;"Schlussluecke"
  6734*   11 3000        C      	LD	DE,UE.BWSA
  6737*   01 000D        C      	LD	BC,UA.ZKEE-UA.ZKSL
  673A*   ED B0          C      	LDIR
  673C*   C3 668A*       C      	JP	KH.RD3
                         C      
  673F*                  C      KH.ANZBL:
  673F*   CD 67E8*       C      	CALL	KH.BILO
  6742*                  C      KH.ANZB1:
  6742*   21 0E65        C      	LD	HL,UE.PUF
  6745*   FE 20          C      	CP	020H
  6747*   20 04          C      	JR	NZ,KH.ANZB2
  6749*   06 02          C      	LD	B,2	; 2 Zeilen anzeigen
  674B*   18 0A          C      	JR	KH.ANZB4
  674D*                  C      KH.ANZB2:
  674D*   FE 80          C      	CP	080H
  674F*   20 04          C      	JR	NZ,KH.ANZB3
  6751*   06 08          C      	LD	B,8	; 8 Zeilen anzeigen
  6753*   18 02          C      	JR	KH.ANZB4
  6755*                  C      KH.ANZB3:
  6755*   06 18          C      	LD	B,24	; 24 Zeilen anzeigen
  6757*                  C      KH.ANZB4:
  6757*   CD 675B*       C      	CALL	KH.AZBLD	;Bild anzeigen (24 Zeilen)
  675A*   C9             C      	RET		; IN...HL:=akt. Pufferadresse
                         C      
  675B*                  C      KH.AZBLD:
  675B*   11 3000        C      	LD	DE,UE.BWSA
  675E*                  C      KH.AZBL1:
'Kommandos: KRDx und KWRx'	MACRO-80 3.44	09-Dec-81	PAGE	1-57


  675E*   C5             C      	PUSH	BC
  675F*   CD 6777*       C      	CALL	KH.AZ1Z	; 1 Zeile anzeigen
  6762*   C1             C      	POP	BC
  6763*   E5             C      	PUSH	HL	;akt. Pufferadresse retten
  6764*   EB             C      	EX	DE,HL
  6765*   11 0050        C      	LD	DE,80
  6768*   19             C      	ADD	HL,DE	;neuen Zeilenanfang berechnen
  6769*   EB             C      	EX	DE,HL
  676A*   E1             C      	POP	HL
  676B*   10 F1          C      	DJNZ	KH.AZBL1
  676D*   C9             C      	RET
                         C      
  676E*                  C      KH.RD2:
  676E*   F5             C      	PUSH	AF	;Flags retten
  676F*   CD 60D5*       C      	CALL	UR.KBR	;Block ruecksetzen
  6772*   CD 60D5*       C      	CALL	UR.KBR
  6775*   F1             C      	POP	AF
  6776*   C9             C      	RET
                         C      ;                                IN...HL:= Pufferadresse
                         C      ;                                     DE:= Zeilenanfang
  6777*                  C      KH.AZ1Z:
  6777*   D5             C      	PUSH	DE	;eine Zeile anzeigen
  6778*   E5             C      	PUSH	HL
  6779*   D5             C      	PUSH	DE
  677A*   E1             C      	POP	HL
  677B*   01 0040        C      	LD	BC,64
  677E*   09             C      	ADD	HL,BC
  677F*   E5             C      	PUSH	HL
  6780*   C1             C      	POP	BC	;BC:= Anfang ASCII-Darstellung
  6781*   E1             C      	POP	HL
  6782*   CD 679B*       C      	CALL	KH.AZADR	;Adresse anzeigen
  6785*   13             C      	INC	DE
  6786*   13             C      	INC	DE
  6787*   CD 67A4*       C      	CALL	KH.AZ4BY	;1. Vierergruppe
  678A*   13             C      	INC	DE
  678B*   13             C      	INC	DE
  678C*   CD 67A4*       C      	CALL	KH.AZ4BY	;2.      ''
  678F*   13             C      	INC	DE
  6790*   13             C      	INC	DE
  6791*   CD 67A4*       C      	CALL	KH.AZ4BY	;3.      ''
  6794*   13             C      	INC	DE
  6795*   13             C      	INC	DE
  6796*   CD 67A4*       C      	CALL	KH.AZ4BY	;4.      ''
  6799*   D1             C      	POP	DE
  679A*   C9             C      	RET
  679B*                  C      KH.AZADR:
  679B*   7C             C      	LD	A,H	;Anzeige der Adresse
  679C*   CD 56A5*       C      	CALL	UC.CVBX+2
  679F*   7D             C      	LD	A,L
  67A0*   CD 56A5*       C      	CALL	UC.CVBX+2
  67A3*   C9             C      	RET
  67A4*                  C      KH.AZ4BY:
  67A4*   AF             C      	XOR	A	;Anzeige einer Vierergruppe
  67A5*   32 2B26*       C      	LD	(UB.PAR1),A
  67A8*                  C      KH.AZ4B0:
  67A8*   7E             C      	LD	A,(HL)
  67A9*   F5             C      	PUSH	AF
  67AA*   CD 56A5*       C      	CALL	UC.CVBX+2	;Code als Hexadezimalzahl
  67AD*   F1             C      	POP	AF
  67AE*   13             C      	INC	DE
  67AF*   23             C      	INC	HL
  67B0*   FE 20          C      	CP	20H
  67B2*   38 15          C      	JR	C,KH.AZ4B1	;nicht darstellbar
  67B4*   FE 7F          C      	CP	7FH
  67B6*   30 11          C      	JR	NC,KH.AZ4B1	;nicht darstellbar
  67B8*                  C      KH.AZ4B3:
  67B8*   02             C      	LD	(BC),A	;Code als ASCII-Zeichen
  67B9*   03             C      	INC	BC
  67BA*   CD 67CD*       C      	CALL	KH.BLEVG	;Test auf Blockende
  67BD*   3A 2B26*       C      	LD	A,(UB.PAR1)
  67C0*   3C             C      	INC	A
  67C1*   FE 04          C      	CP	4
  67C3*   C8             C      	RET	Z
  67C4*   32 2B26*       C      	LD	(UB.PAR1),A
  67C7*   18 DF          C      	JR	KH.AZ4B0
  67C9*                  C      KH.AZ4B1:
  67C9*   3E 7F          C      	LD	A,07FH
  67CB*   18 EB          C      	JR	KH.AZ4B3
  67CD*                  C      KH.BLEVG:
  67CD*   D5             C      	PUSH	DE	;Blockendetest
  67CE*   E5             C      	PUSH	HL
  67CF*   11 0E65        C      	LD	DE,UE.PUF	;DE:= Pufferanfang
  67D2*   B7             C      	OR	A
'Kommandos: KRDx und KWRx'	MACRO-80 3.44	09-Dec-81	PAGE	1-58


  67D3*   ED 52          C      	SBC	HL,DE	;HL:= Anzahl der angezeigten
  67D5*   EB             C      	EX	DE,HL
  67D6*   CD 5611*       C      	CALL	XY.LIDX
  67D9*   09             C      	DB	9
  67DA*   B7             C      	OR	A
  67DB*   ED 52          C      	SBC	HL,DE
  67DD*   E1             C      	POP	HL
  67DE*   D1             C      	POP	DE
  67DF*   28 01          C      	JR	Z,KH.BLEV1
  67E1*   C9             C      	RET
  67E2*                  C      KH.BLEV1:
  67E2*   06 0C          C      	LD	B,12
  67E4*                  C      KH.BLEV2:
  67E4*   33             C      	INC	SP
  67E5*   10 FD          C      	DJNZ	KH.BLEV2
  67E7*   C9             C      	RET		;---> Anzeige beendet
                         C      
                         C      ;----------------------------------------------------
  67E8*                  C      KH.BILO:
  67E8*   21 3000        C      	LD	HL,UE.BWSA
  67EB*   01 077F        C      	LD	BC,24*80 -1	;800H
  67EE*   36 20          C      	LD	(HL),20H
  67F0*   E5             C      	PUSH	HL
  67F1*   D1             C      	POP	DE
  67F2*   13             C      	INC	DE
  67F3*   ED B0          C      	LDIR
  67F5*   C9             C      	RET
                         C      ;------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Ein-/Ausgabe im freien Format'
                         C      	PAGE
'Ein-/Ausgabe im freien Format'	MACRO-80 3.44	09-Dec-81	PAGE	1-59


                         C      
                         C      ;	PN	FD
                         C      ;**********************************************************************
                         C      ;
                         C      ;      Ein-/Ausgabe von Dateien im freien Format in bzw. aus dem
                         C      ;      Editorraum von bzw. auf MRES-Kassetten
                         C      ;
                         C      ;**********************************************************************
                         C      ;      Positionieren auf Datei, IN: <C>:= Labelnummer
                         C      ;
  67F6*                  C      FD.POSK:
  67F6*   C5             C      	PUSH	BC
  67F7*   41             C      	LD	B,C
  67F8*   04             C      	INC	B
  67F9*   CD 60E4*       C      	CALL	UR.POSIK
  67FC*   CD 680E*       C      	CALL	FD.KO01
  67FF*   3A 0E65        C      	LD	A,(UE.PUF)
  6802*   B9             C      	CP	C
  6803*   C1             C      	POP	BC
  6804*   20 01          C      	JR	NZ,$+3
  6806*   C9             C      	RET
  6807*   D1             C      	POP	DE
  6808*   3E 94          C      	LD	A,94H
  680A*   CD 5D5F*       C      	CALL	UF.ERANZ
  680D*   C9             C      	RET
                         C      ;
  680E*                  C      FD.KO01:
  680E*   DD 36 04 02    C      	LD	(IX+4),002H	;FUER FD19
  6812*   C3 5D2F*       C      	JP	UF.EXEC
                         C      ;----------------------------------------------------------------------
                         C      ;      Datei im Verzeichnis suchen
                         C      ;      HL:= Dateiname, <B>:= Anzahl Verzeichniseintragungen + 1
                         C      ;      <D>:= Dateityp
                         C      ;      O:  CY:= 0 Datei nicht vorhanden, <C> unveraendert
                         C      ;          CY:= 1 <C>:= Labelnummer
                         C      ;      K:  B
  6815*                  C      FD.DASU:
  6815*   D5             C      	PUSH	DE
  6816*   05             C      	DEC	B
  6817*   28 0A          C      	JR	Z,$+12
  6819*   CD 680E*       C      	CALL	FD.KO01
  681C*   CD 54C7*       C      	CALL	U1.NMVGL
  681F*   38 05          C      	JR	C,$+7
  6821*   10 F6          C      	DJNZ	$-8
  6823*   B7             C      	OR	A
  6824*   D1             C      	POP	DE
  6825*   C9             C      	RET
  6826*   5F             C      	LD	E,A
  6827*   3A 0E6B        C      	LD	A,(UE.PUF+6)
  682A*   BA             C      	CP	D
  682B*   20 F4          C      	JR	NZ,$-10
  682D*   4B             C      	LD	C,E
  682E*   37             C      	SCF
  682F*   18 F3          C      	JR	$-11
                         C      ;----------------------------------------------------------------------
                         C      ;      Reservebloecke schreiben
                         C      ;
  6831*                  C      FD.WRRES:
  6831*   C5             C      	PUSH	BC
  6832*   D5             C      	PUSH	DE
  6833*   E5             C      	PUSH	HL
  6834*   21 5FCD*       C      	LD	HL,UA.ZKRES
  6837*   CD 595C*       C      	CALL	UR.MIMO
  683A*   EB             C      	EX	DE,HL
  683B*   CD 5761*       C      	CALL	UC.CVDB
  683E*   7C             C      	LD	A,H
  683F*   B5             C      	OR	L
  6840*   20 04          C      	JR	NZ,$+6
  6842*   E1             C      	POP	HL
  6843*   D1             C      	POP	DE
  6844*   C1             C      	POP	BC
  6845*   C9             C      	RET
  6846*   E5             C      	PUSH	HL
  6847*   21 0E65        C      	LD	HL,UE.PUF
  684A*   01 0090        C      	LD	BC,90H
  684D*   CD 5411*       C      	CALL	U1.CLRB
  6850*   21 0080        C      	LD	HL,80H
  6853*   CD 5631*       C      	CALL	XY.STIDX
  6856*   09             C      	DB	9
  6857*   E1             C      	POP	HL
  6858*   CD 6234*       C      	CALL	UK.KBA
  685B*   2B             C      	DEC	HL
'Ein-/Ausgabe im freien Format'	MACRO-80 3.44	09-Dec-81	PAGE	1-60


  685C*   7C             C      	LD	A,H
  685D*   B5             C      	OR	L
  685E*   20 E6          C      	JR	NZ,$-24
  6860*   18 E0          C      	JR	$-30
                         C      ;----------------------------------------------------------------------
                         C      ;      F/S - Datei in den Editorraum einlesen
                         C      ;
  6862*                  C      FD.FDINP:
  6862*   21 0000        C      	LD	HL,0
  6865*   CD 5621*       C      	CALL	XY.STDX
  6868*   11             C      	DB	17
  6869*   CD 6184*       C      	CALL	UK.KLPFB	;Pufferbereitstellung
  686C*   21 3328        C      	LD	HL,UE.BWSA+328H
  686F*   06 05          C      	LD	B,5
  6871*   7E             C      	LD	A,(HL)
  6872*   FE 45          C      	CP	'E'
  6874*   28 05          C      	JR	Z,$+7
  6876*   23             C      	INC	HL
  6877*   10 F8          C      	DJNZ	$-6
  6879*   18 05          C      	JR	$+7
  687B*   2A 0DC6        C      	LD	HL,(UE.EDEND)
  687E*   18 03          C      	JR	$+5
  6880*   21 8830        C      	LD	HL,UE.TEXAN
  6883*   D9             C      	EXX
  6884*   CD 5956*       C      	CALL	DC.INIT	;Dekomprimierung initialisieren
  6887*   D9             C      	EXX
  6888*   3A 2B28*       C      	LD	A,(UB.PAR2)	;Dateitypmerker
  688B*   FE 53          C      	CP	'S'
  688D*   F5             C      	PUSH	AF
  688E*   CC 68A9*       C      	CALL	Z,FD.SDIN	;Zeicheneingabe S- Datei
  6891*   77             C      	LD	(HL),A
  6892*   B7             C      	OR	A
  6893*   28 12          C      	JR	Z,$+20
  6895*   F1             C      	POP	AF
  6896*   28 07          C      	JR	Z,$+9
  6898*   C4 6147*       C      	CALL	NZ,UK.GETK	;Zeicheneingabe F- Datei
  689B*   77             C      	LD	(HL),A	;Zeichen in Speicher eintragen
  689C*   BE             C      	CP	(HL)	;Echolesen
  689D*   20 10          C      	JR	NZ,$+18
  689F*   B7             C      	OR	A	;<A>:= 0, Z:= 1
  68A0*   C8             C      	RET	Z
  68A1*   23             C      	INC	HL	;HL:= HL + 1
  68A2*   22 0DC6        C      	LD	(UE.EDEND),HL	;Textende
  68A5*   18 E1          C      	JR	$-29
  68A7*   F1             C      	POP	AF
  68A8*   C9             C      	RET
  68A9*                  C      FD.SDIN:
  68A9*   D9             C      	EXX
  68AA*   CD 591B*       C      	CALL	DC.DCMPR
  68AD*   D9             C      	EXX
  68AE*   C9             C      	RET
  68AF*   3E 93          C      	LD	A,93H	;Fehlerschluessel
  68B1*   CD 5D5F*       C      	CALL	UF.ERANZ
  68B4*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;      Ausgabe einer F/S - Datei (neuer Bestand)
                         C      ;
  68B5*                  C      FD.FDOUT:
  68B5*   21 0000        C      	LD	HL,0                   ;Blockzaehler loeschen
  68B8*   CD 5621*       C      	CALL	XY.STDX
  68BB*   11             C      	DB	17
  68BC*   21 0080        C      	LD	HL,80H                 ;Blocklaenge eintragen
  68BF*   CD 5631*       C      	CALL	XY.STIDX
  68C2*   09             C      	DB	9
  68C3*   CD 620F*       C      	CALL	UK.KSPFB               ;Pufferbereitstellung
  68C6*   21 8830        C      	LD	HL,UE.TEXAN            ;HL:= Textanfang
  68C9*   ED 5B 0DC6     C      	LD	DE,(UE.EDEND)          ;BC:= Textende
  68CD*   D9             C      	EXX
  68CE*   CD 5915*       C      	CALL	CP.INIT
  68D1*   D9             C      	EXX
  68D2*                  C      FD.FDOUT1:
  68D2*   B7             C      	OR	A                      ;CY:= 0
  68D3*   E5             C      	PUSH	HL
  68D4*   ED 52          C      	SBC	HL,DE
  68D6*   30 13          C      	JR	NC,FD.FDOUT2           ;$+21
  68D8*   E1             C      	POP	HL
  68D9*   3A 2B28*       C      	LD	A,(UB.PAR2)
  68DC*   FE 53          C      	CP	'S'
  68DE*   F5             C      	PUSH	AF
  68DF*   7E             C      	LD	A,(HL)
  68E0*   CC 6903*       C      	CALL	Z,FD.SDOUT
  68E3*   F1             C      	POP	AF
  68E4*   7E             C      	LD	A,(HL)
'Ein-/Ausgabe im freien Format'	MACRO-80 3.44	09-Dec-81	PAGE	1-61


  68E5*   C4 61EB*       C      	CALL	NZ,UK.PUTK
  68E8*   23             C      	INC	HL
  68E9*   18 E7          C      	JR	FD.FDOUT1              ;$-23
  68EB*                  C      FD.FDOUT2:
  68EB*   E1             C      	POP	HL                     ;Endebehandlung
  68EC*   01 0120        C      	LD	BC,288
  68EF*                  C      FD.FDOUT3:
  68EF*   AF             C      	XOR	A
  68F0*   CD 61EB*       C      	CALL	UK.PUTK
  68F3*   0B             C      	DEC	BC
  68F4*   78             C      	LD	A,B
  68F5*   B1             C      	OR	C
  68F6*   20 F7          C      	JR	NZ,FD.FDOUT3           ;$-7
  68F8*   CD 6AC9*       C      	CALL	FD.DSPBB
  68FB*   CD 6831*       C      	CALL	FD.WRRES               ;Reservebloecke schreiben
  68FE*   CD 5601*       C      	CALL	XY.LDDX                ;HL:= Blockzaehler
  6901*   11             C      	DB	17
  6902*   C9             C      	RET
  6903*                  C      FD.SDOUT:
  6903*   D9             C      	EXX
  6904*   CD 58B2*       C      	CALL	CP.COMPR
  6907*   D9             C      	EXX
  6908*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;      Ausgabe einer F/S - Datei (alter Bestand)
                         C      ;
  6909*                  C      FD.FDOWR:
  6909*   21 0000        C      	LD	HL,0
  690C*   CD 5621*       C      	CALL	XY.STDX
  690F*   11             C      	DB	17
  6910*   21 8830        C      	LD	HL,UE.TEXAN
  6913*   D9             C      	EXX
  6914*   CD 5915*       C      	CALL	CP.INIT
  6917*   D9             C      	EXX
  6918*   E5             C      	PUSH	HL
  6919*                  C      FD.FDOW1:
  6919*   CD 6959*       C      	CALL	FD.FDUP
  691C*   E1             C      	POP	HL
  691D*                  C      FD.FDOW2:
  691D*   E5             C      	PUSH	HL
  691E*   ED 5B 0DC6     C      	LD	DE,(UE.EDEND)
  6922*   B7             C      	OR	A
  6923*   ED 52          C      	SBC	HL,DE
  6925*   30 1B          C      	JR	NC,FD.FDOW3
  6927*   E1             C      	POP	HL
  6928*   3A 2B28*       C      	LD	A,(UB.PAR2)
  692B*   FE 53          C      	CP	'S'
  692D*   7E             C      	LD	A,(HL)
  692E*   28 41          C      	JR	Z,FD.SDOW
  6930*   CD 61EB*       C      	CALL	UK.PUTK
  6933*   0B             C      	DEC	BC
  6934*                  C      FD.FDOW4:
  6934*   23             C      	INC	HL
  6935*   78             C      	LD	A,B
  6936*   B1             C      	OR	C
  6937*   20 E4          C      	JR	NZ,FD.FDOW2
  6939*   CD 6234*       C      	CALL	UK.KBA	;Block schreiben
  693C*   E5             C      	PUSH	HL
  693D*   CD 694F*       C      	CALL	FD.DECBZ
  6940*   18 D7          C      	JR	FD.FDOW1
  6942*                  C      FD.FDOW3:
  6942*   E1             C      	POP	HL
  6943*   AF             C      	XOR	A	;Endekennzeichen 00H
  6944*   CD 61EB*       C      	CALL	UK.PUTK
  6947*   CD 6234*       C      	CALL	UK.KBA
  694A*   CD 694F*       C      	CALL	FD.DECBZ
  694D*   B7             C      	OR	A
  694E*   C9             C      	RET
  694F*                  C      FD.DECBZ:
  694F*   CD 5601*       C      	CALL	XY.LDDX
  6952*   11             C      	DB	17
  6953*   2B             C      	DEC	HL
  6954*   CD 5621*       C      	CALL	XY.STDX
  6957*   11             C      	DB	17
  6958*   C9             C      	RET
  6959*                  C      FD.FDUP:
  6959*   CD 61A7*       C      	CALL	UK.KBW
  695C*   DD 7E 0A       C      	LD	A,(IX+10)	;Laenge = 1, dann BM
  695F*   FE 01          C      	CP	1
  6961*   CA 6AEE*       C      	JP	Z,FD.BMGF
  6964*   CD 60D5*       C      	CALL	UR.KBR
  6967*   CD 5611*       C      	CALL	XY.LIDX
  696A*   09             C      	DB	9
'Ein-/Ausgabe im freien Format'	MACRO-80 3.44	09-Dec-81	PAGE	1-62


  696B*   E5             C      	PUSH	HL
  696C*   C1             C      	POP	BC
  696D*   CD 620F*       C      	CALL	UK.KSPFB
  6970*   C9             C      	RET
  6971*                  C      FD.SDOW:
  6971*   CD 6903*       C      	CALL	FD.SDOUT
  6974*   78             C      	LD	A,B
  6975*   A1             C      	AND	C
  6976*   FE FF          C      	CP	0FFH
  6978*   28 1B          C      	JR	Z,FD.SDK1
  697A*   FE FE          C      	CP	0FEH
  697C*   28 03          C      	JR	Z,FD.SDK2
  697E*   C3 6934*       C      	JP	FD.FDOW4
  6981*                  C      FD.SDK2:
  6981*   EB             C      	EX	DE,HL
  6982*   CD 6959*       C      	CALL	FD.FDUP
  6985*   3E 09          C      	LD	A,09H
  6987*   CD 61EB*       C      	CALL	UK.PUTK
  698A*   0B             C      	DEC	BC
  698B*                  C      FD.SDK0:
  698B*   3E 3B          C      	LD	A,';'
  698D*   CD 61EB*       C      	CALL	UK.PUTK
  6990*   0B             C      	DEC	BC
  6991*   EB             C      	EX	DE,HL
  6992*   C3 6934*       C      	JP	FD.FDOW4
  6995*                  C      FD.SDK1:
  6995*   EB             C      	EX	DE,HL
  6996*   CD 6959*       C      	CALL	FD.FDUP
  6999*   18 F0          C      	JR	FD.SDK0
                         C      ;--------------------------------------------------------------
                         C      ;        Startroutine Ein-/Ausgabe
                         C      ;
  699B*                  C      FD.FSTRT:
  699B*   CD 55B1*       C      	CALL	U1.BILO
  699E*   CD 54E2*       C      	CALL	U1.KTINI
  69A1*   3A 3326        C      	LD	A,(UE.BWSA + 10*80 +6)	;326H
  69A4*   CD 55C5*       C      	CALL	U1.TST
  69A7*   DA 69D3*       C      	JP	C,FD.STRT1
  69AA*   DD 77 03       C      	LD	(IX+3),A
  69AD*   CD 609F*       C      	CALL	UR.KRE
  69B0*   CD 60AD*       C      	CALL	UR.KRWW
  69B3*   CD 5496*       C      	CALL	U1.DSVG
  69B6*   3E 0E          C      	LD	A,14
  69B8*   32 2B00*       C      	LD	(UB.ZN),A
  69BB*   3A 3328        C      	LD	A,(UE.BWSA+328H)
  69BE*   FE 53          C      	CP	'S'
  69C0*   28 02          C      	JR	Z,$+4
  69C2*   3E 46          C      	LD	A,'F'
  69C4*   57             C      	LD	D,A
  69C5*   32 2B28*       C      	LD	(UB.PAR2),A
  69C8*   21 5FE0*       C      	LD	HL,UA.ZKSDT
  69CB*   28 03          C      	JR	Z,$+5
  69CD*   21 5F50*       C      	LD	HL,UA.ZKDAT
  69D0*   CD 595C*       C      	CALL	UR.MIMO
  69D3*                  C      FD.STRT1:
  69D3*   FD E1          C      	POP	IY
  69D5*   D8             C      	RET	C
  69D6*   FD E5          C      	PUSH	IY
  69D8*   3E 53          C      	LD	A,'S'
  69DA*   BA             C      	CP	D
  69DB*   CC 6A06*       C      	CALL	Z,FD.DECHL
  69DE*   CD 6815*       C      	CALL	FD.DASU
  69E1*   DC 69E8*       C      	CALL	C,FD.SETJ
  69E4*   D4 6A00*       C      	CALL	NC,FD.SETN
  69E7*   C9             C      	RET
  69E8*                  C      FD.SETJ:
  69E8*   C5             C      	PUSH	BC
  69E9*   D5             C      	PUSH	DE
  69EA*   E5             C      	PUSH	HL
  69EB*   EB             C      	EX	DE,HL
  69EC*   06 08          C      	LD	B,8
  69EE*   13             C      	INC	DE
  69EF*   10 FD          C      	DJNZ	$-1
  69F1*   21 0E6D        C      	LD	HL,UE.PUF+8
  69F4*   01 0006        C      	LD	BC,6
  69F7*   ED B0          C      	LDIR
  69F9*   E1             C      	POP	HL
  69FA*   D1             C      	POP	DE
  69FB*   C1             C      	POP	BC
  69FC*   3E 4A          C      	LD	A,'J'
  69FE*   18 02          C      	JR	$+4
  6A00*                  C      FD.SETN:
  6A00*   3E 4E          C      	LD	A,'N'
'Ein-/Ausgabe im freien Format'	MACRO-80 3.44	09-Dec-81	PAGE	1-63


  6A02*   32 2B26*       C      	LD	(UB.PAR1),A
  6A05*   C9             C      	RET
  6A06*                  C      FD.DECHL:
  6A06*   2B             C      	DEC	HL
  6A07*   2B             C      	DEC	HL
  6A08*   C9             C      	RET
                         C      ;****************************************************************
                         C      ;        Ausgabeprogramm
                         C      ;****************************************************************
  6A09*   6A09*          C      	DW	$
  6A0B*   41 55 53 20    C      	DB	'AUS '
  6A0F*                  C      FD.FOUT1:
  6A0F*   CD 699B*       C      	CALL	FD.FSTRT
  6A12*   3A 2B26*       C      	LD	A,(UB.PAR1)
  6A15*   FE 4A          C      	CP	'J'	;DATEI SCHON VORHANDEN ?
  6A17*   CA 6A85*       C      	JP	Z,FD.FOLWR	;JA
                         C      ;-------------------------------NEIN--> NEUE ERSTELLEN-----------------
  6A1A*   79             C      	LD	A,C	;NEXT RECORD
  6A1B*   32 2B26*       C      	LD	(UB.PAR1),A
  6A1E*   3E 7F          C      	LD	A,7FH
  6A20*   32 2B2A*       C      	LD	(UB.PAR3),A	;PARAMETER KOMMENTARABFRAGE JA
  6A23*   CD 554E*       C      	CALL	U1.VZS	;NEUEN VERZ.SATZ SCHREIBEN
  6A26*   CD 67F6*       C      	CALL	FD.POSK
  6A29*   C5             C      	PUSH	BC
  6A2A*   CD 68B5*       C      	CALL	FD.FDOUT
  6A2D*   E5             C      	PUSH	HL	;BLOCKZAEHLER
  6A2E*   CD 60C3*       C      	CALL	UR.KBM
  6A31*   21 0020        C      	LD	HL,32
  6A34*   CD 5631*       C      	CALL	XY.STIDX
  6A37*   09             C      	DB	9
  6A38*   CD 5486*       C      	CALL	U1.VSX
  6A3B*   E1             C      	POP	HL
  6A3C*   C1             C      	POP	BC
  6A3D*   E5             C      	PUSH	HL
  6A3E*   79             C      	LD	A,C
  6A3F*   3C             C      	INC	A
  6A40*   32 0E65        C      	LD	(UE.PUF),A
  6A43*   F5             C      	PUSH	AF
  6A44*   DD 36 04 08    C      	LD	(IX+4),08H
  6A48*   CD 5D2F*       C      	CALL	UF.EXEC
  6A4B*   CD 60C9*       C      	CALL	UR.KSL
  6A4E*   CD 60AD*       C      	CALL	UR.KRWW
  6A51*   CD 5496*       C      	CALL	U1.DSVG
  6A54*   CD 60D5*       C      	CALL	UR.KBR
  6A57*   F1             C      	POP	AF
  6A58*   32 0E66        C      	LD	(UE.PUF+1),A
  6A5B*   78             C      	LD	A,B
  6A5C*   3C             C      	INC	A
  6A5D*   32 0E68        C      	LD	(UE.PUF+3),A
  6A60*   DD 36 04 08    C      	LD	(IX+4),08H
  6A64*   CD 5D2F*       C      	CALL	UF.EXEC
  6A67*   DD 36 04 02    C      	LD	(IX+4),02H
  6A6B*   CD 5D2F*       C      	CALL	UF.EXEC
  6A6E*   10 FB          C      	DJNZ	$-3
  6A70*   CD 60D5*       C      	CALL	UR.KBR
  6A73*   E1             C      	POP	HL
  6A74*   22 0E7E        C      	LD	(UE.PUF+25),HL
  6A77*   DD 36 04 18    C      	LD	(IX+4),018H
  6A7B*   CD 5D2F*       C      	CALL	UF.EXEC
  6A7E*                  C      FD.FOUT2:
  6A7E*                  C      FD.END:
  6A7E*   CD 60A7*       C      	CALL	UR.KRW
  6A81*   CD 60B1*       C      	CALL	UR.KRA
  6A84*   C9             C      	RET
  6A85*                  C      FD.FOLWR:
  6A85*   21 5FAF*       C      	LD	HL,UA.ZKDL	;DATEI UEBERSCHREIBEN?
  6A88*   CD 595C*       C      	CALL	UR.MIMO
  6A8B*   D8             C      	RET	C
  6A8C*   7E             C      	LD	A,(HL)
  6A8D*   FE 4A          C      	CP	'J'
  6A8F*   C0             C      	RET	NZ
  6A90*   CD 67F6*       C      	CALL	FD.POSK
  6A93*   CD 6909*       C      	CALL	FD.FDOWR
  6A96*   CD 6AC9*       C      	CALL	FD.DSPBB
  6A99*   CD 6AE3*       C      	CALL	FD.RDEND
  6A9C*   CD 6AD9*       C      	CALL	FD.DSPBG
  6A9F*   18 DD          C      	JR	FD.FOUT2
                         C      ;**********************************************************************
                         C      ;      Eingabeprogramm
                         C      ;**********************************************************************
  6AA1*   6AA1*          C      	DW	$
  6AA3*   45 49 4E 20    C      	DB	'EIN '
  6AA7*                  C      FD.FDIN2:
'Ein-/Ausgabe im freien Format'	MACRO-80 3.44	09-Dec-81	PAGE	1-64


  6AA7*   CD 699B*       C      	CALL	FD.FSTRT
  6AAA*   3A 2B26*       C      	LD	A,(UB.PAR1)
  6AAD*   FE 4A          C      	CP	'J'
  6AAF*   28 07          C      	JR	Z,$+9
  6AB1*   3E 91          C      	LD	A,91H
  6AB3*   CD 5D5F*       C      	CALL	UF.ERANZ
  6AB6*   18 C6          C      	JR	FD.END
  6AB8*   CD 67F6*       C      	CALL	FD.POSK
  6ABB*   CD 6862*       C      	CALL	FD.FDINP
  6ABE*   CD 6AC9*       C      	CALL	FD.DSPBB
  6AC1*   CD 6AE3*       C      	CALL	FD.RDEND
  6AC4*   CD 6AD9*       C      	CALL	FD.DSPBG
  6AC7*   18 B5          C      	JR	FD.END
                         C      ;----------------------------------------------------------------------
  6AC9*                  C      FD.DSPBB:
  6AC9*   CD 5601*       C      	CALL	XY.LDDX
  6ACC*   11             C      	DB	17
  6ACD*   EB             C      	EX	DE,HL
  6ACE*   21 5FF5*       C      	LD	HL,UA.ZKBEL
  6AD1*   CD 595C*       C      	CALL	UR.MIMO
  6AD4*   EB             C      	EX	DE,HL
  6AD5*   CD 5718*       C      	CALL	UC.CVBD3
  6AD8*   C9             C      	RET
  6AD9*                  C      FD.DSPBG:
  6AD9*   CD 5601*       C      	CALL	XY.LDDX
  6ADC*   11             C      	DB	17
  6ADD*   EB             C      	EX	DE,HL
  6ADE*   21 6008*       C      	LD	HL,UA.ZKBLG
  6AE1*   18 EE          C      	JR	$-16
  6AE3*                  C      FD.RDEND:
  6AE3*   CD 61A7*       C      	CALL	UK.KBW
  6AE6*   DD 7E 0A       C      	LD	A,(IX+10)	;Laenge = 1, dann BM
  6AE9*   FE 01          C      	CP	1
  6AEB*   C8             C      	RET	Z
  6AEC*   18 F5          C      	JR	FD.RDEND
  6AEE*                  C      FD.BMGF:
  6AEE*   3E 95          C      	LD	A,95H
  6AF0*   CD 5D5F*       C      	CALL	UF.ERANZ
  6AF3*   D1             C      	POP	DE
  6AF4*   D1             C      	POP	DE
  6AF5*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Laden von MRES-P-Dateien'
                         C      	PAGE
'Laden von MRES-P-Dateien'	MACRO-80 3.44	09-Dec-81	PAGE	1-65


                         C      
                         C      ;	PN	LD
                         C      ;***********************************************************
                         C      ;
                         C      ;        Laden von MRES-P-Dateien
                         C      ;
                         C      ;***********************************************************
  6AF6*   6AF6*          C      	DW	$
  6AF8*   4C 4F 41 44    C      	DB	'LOAD'
  6AFC*   3A 3327        C      	LD	A,(UE.BWSA + 10*80 +7)	;327H
  6AFF*   CD 55C5*       C      	CALL	U1.TST
  6B02*   D8             C      	RET	C
  6B03*   CD 54E2*       C      	CALL	U1.KTINI
  6B06*   DD 77 03       C      	LD	(IX+3),A
  6B09*   CD 55B1*       C      	CALL	U1.BILO
  6B0C*   3E 0D          C      	LD	A,13
  6B0E*   32 2B00*       C      	LD	(UB.ZN),A
  6B11*                  C      LD.DATN:
  6B11*   21 5F50*       C      	LD	HL,UA.ZKDAT	;Dateiname ?
  6B14*   CD 595C*       C      	CALL	UR.MIMO
  6B17*   D8             C      	RET	C
  6B18*   CD 609F*       C      	CALL	UR.KRE
  6B1B*   CD 60AD*       C      	CALL	UR.KRWW
  6B1E*   CD 5496*       C      	CALL	U1.DSVG
  6B21*   3E 01          C      	LD	A,01H
  6B23*   B8             C      	CP	B
  6B24*   28 0A          C      	JR	Z,LD.LD21	;NEU INITIALISIERTE KASSETTE
  6B26*                  C      LD.LD2:
  6B26*   CD 61A7*       C      	CALL	UK.KBW
  6B29*   CD 54C7*       C      	CALL	U1.NMVGL	;Dateiname vergleichen
  6B2C*   38 08          C      	JR	C,LD.DATFU	;---> Datei gefunden
  6B2E*   10 F6          C      	DJNZ	LD.LD2
  6B30*                  C      LD.LD21:
  6B30*   3E 91          C      	LD	A,91H	;Datei nicht vorhanden
  6B32*   CD 5D5F*       C      	CALL	UF.ERANZ	;FEHLERANZEIGE
  6B35*   C9             C      	RET
  6B36*                  C      LD.DATFU:
  6B36*   3A 0E6B        C      	LD	A,(UE.PUF+6)	;TYP
  6B39*   FE 4F          C      	CP	'O'
  6B3B*   F5             C      	PUSH	AF
  6B3C*   21 0E7C        C      	LD	HL,UE.PUF+23
  6B3F*   7E             C      	LD	A,(HL)
  6B40*   F5             C      	PUSH	AF
  6B41*   47             C      	LD	B,A
  6B42*   04             C      	INC	B
  6B43*   CD 60E4*       C      	CALL	UR.POSIK	;Positionieren
  6B46*   CD 61A7*       C      	CALL	UK.KBW
  6B49*   F1             C      	POP	AF
  6B4A*   21 0E65        C      	LD	HL,UE.PUF
  6B4D*   BE             C      	CP	(HL)
  6B4E*   28 07          C      	JR	Z,LD.DATPO	;Datei richtig positioniert
  6B50*   F1             C      	POP	AF
  6B51*   3E 94          C      	LD	A,94H
  6B53*   CD 5D5F*       C      	CALL	UF.ERANZ
  6B56*   C9             C      	RET
  6B57*                  C      LD.DATPO:
  6B57*   F1             C      	POP	AF
  6B58*   CA 6BED*       C      	JP	Z,RL.BEG
  6B5B*   3A 3329        C      	LD	A,(UE.BWSA+329H)
  6B5E*   FE 56          C      	CP	'V'
  6B60*   20 57          C      	JR	NZ,LD.LD3
  6B62*   21 5F63*       C      	LD	HL,UA.ZKLAD	;Ladeadresse ?
  6B65*   CD 595C*       C      	CALL	UR.MIMO
  6B68*   DA 6B11*       C      	JP	C,LD.DATN
  6B6B*   CD 55CF*       C      	CALL	U1.PRADR	;ADRESSE EINGEGEBEN
  6B6E*   38 F2          C      	JR	C,$-12
  6B70*   EB             C      	EX	DE,HL
  6B71*   21 2B26*       C      	LD	HL,UB.PAR1
  6B74*   CD 5705*       C      	CALL	UC.CVXA
  6B77*                  C      LD.LD4:
  6B77*   CD 6184*       C      	CALL	UK.KLPFB
  6B7A*   CD 6147*       C      	CALL	UK.GETK
  6B7D*   CD 6147*       C      	CALL	UK.GETK
  6B80*   67             C      	LD	H,A
  6B81*   CD 6147*       C      	CALL	UK.GETK
  6B84*   6F             C      	LD	L,A
  6B85*   7A             C      	LD	A,D
  6B86*   B3             C      	OR	E
  6B87*   28 09          C      	JR	Z,LD.LD5
  6B89*   ED 5B 2B26*    C      	LD	DE,(UB.PAR1)
  6B8D*   EB             C      	EX	DE,HL
  6B8E*   B7             C      	OR	A
'Laden von MRES-P-Dateien'	MACRO-80 3.44	09-Dec-81	PAGE	1-66


  6B8F*   ED 52          C      	SBC	HL,DE
  6B91*   EB             C      	EX	DE,HL	;DE:= Verschiebung zur ersten
  6B92*                  C      LD.LD5:
  6B92*   CD 60D5*       C      	CALL	UR.KBR
  6B95*   CD 6BBE*       C      	CALL	LD.LADER
  6B98*   22 2B28*       C      	LD	(UB.PAR2),HL
  6B9B*   21 3329        C      	LD	HL,UE.BWSA+329H
  6B9E*   06 04          C      	LD	B,4
  6BA0*   7E             C      	LD	A,(HL)
  6BA1*   FE 53          C      	CP	'S'
  6BA3*   28 0A          C      	JR	Z,LD.START
  6BA5*   23             C      	INC	HL
  6BA6*   10 F8          C      	DJNZ	$-6
  6BA8*   CD 60A7*       C      	CALL	UR.KRW
  6BAB*   CD 60B1*       C      	CALL	UR.KRA
  6BAE*   C9             C      	RET
  6BAF*                  C      LD.START:
  6BAF*   CD 60A7*       C      	CALL	UR.KRW
  6BB2*   CD 60B1*       C      	CALL	UR.KRA
  6BB5*   2A 2B28*       C      	LD	HL,(UB.PAR2)
  6BB8*   E9             C      	JP	(HL)
  6BB9*                  C      LD.LD3:
  6BB9*   11 0000        C      	LD	DE,0
  6BBC*   18 B9          C      	JR	LD.LD4
                         C      ;--------------------------------------------------------------
  6BBE*                  C      LD.LADER:
  6BBE*   CD 6184*       C      	CALL	UK.KLPFB
  6BC1*                  C      LD.LAD2:
  6BC1*   CD 6147*       C      	CALL	UK.GETK
  6BC4*   FE 00          C      	CP	0
  6BC6*   28 16          C      	JR	Z,LD.LDEND
  6BC8*   47             C      	LD	B,A
  6BC9*   CD 6147*       C      	CALL	UK.GETK
  6BCC*   67             C      	LD	H,A
  6BCD*   CD 6147*       C      	CALL	UK.GETK
  6BD0*   6F             C      	LD	L,A
  6BD1*   19             C      	ADD	HL,DE
  6BD2*                  C      LD.LAD1:
  6BD2*   CD 6147*       C      	CALL	UK.GETK
  6BD5*   77             C      	LD	(HL),A
  6BD6*   BE             C      	CP	(HL)
  6BD7*   20 0E          C      	JR	NZ,LD.LADF
  6BD9*   23             C      	INC	HL
  6BDA*   10 F6          C      	DJNZ	LD.LAD1
  6BDC*   18 E3          C      	JR	LD.LAD2
  6BDE*                  C      LD.LDEND:
  6BDE*   CD 6147*       C      	CALL	UK.GETK
  6BE1*   67             C      	LD	H,A
  6BE2*   CD 6147*       C      	CALL	UK.GETK
  6BE5*   6F             C      	LD	L,A
  6BE6*   C9             C      	RET
  6BE7*                  C      LD.LADF:
  6BE7*   3E 93          C      	LD	A,93H
  6BE9*   CD 5D5F*       C      	CALL	UF.ERANZ
  6BEC*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Relativloader fuer O-Dateien'
                         C      	PAGE
'Relativloader fuer O-Dateien'	MACRO-80 3.44	09-Dec-81	PAGE	1-67


                         C      
                         C      ;	PN	RL
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;     RELATIVLOADER FUER O-DATEIEN
                         C      ;
                         C      ;----------------------------------------------------------------------
  6BED*                  C      RL.BEG:
  6BED*   21 5F76*       C      	LD	HL,UA.ZKBEG	;BEGINN ?
  6BF0*   CD 595C*       C      	CALL	UR.MIMO
  6BF3*   DA 6B11*       C      	JP	C,LD.DATN
  6BF6*   CD 55CF*       C      	CALL	U1.PRADR
  6BF9*   38 F2          C      	JR	C,RL.BEG
  6BFB*   EB             C      	EX	DE,HL
  6BFC*   21 2B30*       C      	LD	HL,UB.PATAB
  6BFF*   CD 5705*       C      	CALL	UC.CVXA
  6C02*                  C      RL.UG:
  6C02*   CD 61A7*       C      	CALL	UK.KBW
  6C05*   2A 2B30*       C      	LD	HL,(UB.PATAB)	;BGADR---->HL
  6C08*   0E 01          C      	LD	C,001H	;LADEN BLOCKZAEHLER MIT
                         C      			;ANFANGSWERT
  6C0A*   CD 6C95*       C      	CALL	RL.UP6	; AUFRUF EINGABE-UP
                         C      ;********** TEST BEFEHLSKENNZEICHENBYTE *******************************
  6C0D*                  C      RL.M16:
  6C0D*   CB 5A          C      	BIT	3,D	;TEST ORG-BEFEHL
  6C0F*   C2 6CE9*       C      	JP	NZ,RL.OB	;JA--->FEHLER
  6C12*   CB 62          C      	BIT	4,D	;TEST BER -BEFEHL
  6C14*   C2 6C7E*       C      	JP	NZ,RL.M10
  6C17*   3E 07          C      	LD	A,007H
  6C19*   A2             C      	AND	D	;TEST BEFEHLS LAENGE=0 ?
  6C1A*   CA 6C8F*       C      	JP	Z,RL.M11
  6C1D*   47             C      	LD	B,A	;BEFEHLSLAENGE-->B
  6C1E*                  C      RL.M12:
  6C1E*   CD 6C95*       C      	CALL	RL.UP6
  6C21*   72             C      	LD	(HL),D
  6C22*   23             C      	INC	HL
  6C23*   10 F9          C      	DJNZ	RL.M12	;EINGABE BEFEHL
  6C25*   CD 6C95*       C      	CALL	RL.UP6
  6C28*   CB 7A          C      	BIT	7,D	;TEST BEFEHLSKENNZEICHENBYTE ?
  6C2A*   20 E1          C      	JR	NZ,RL.M16	; JA
                         C      ;******* TEST ADRESSKENNZEICHENBYTE ***********************************
  6C2C*   CB 6A          C      	BIT	5,D	;TEST OB REL.ADR. FOLGT
  6C2E*   CA 6CED*       C      	JP	Z,RL.RA	;NEIN-->FEHLER
  6C31*   CB 72          C      	BIT	6,D	;FOLGT BEZUGNAHME AUF
                         C      			;SYMBOLVERZEICHNIS
  6C33*   C2 6CF1*       C      	JP	NZ,RL.SV	;JA--->FEHLER
  6C36*   CB 52          C      	BIT	2,D	;MINUS ?
  6C38*   C2 6CF5*       C      	JP	NZ,RL.MN
  6C3B*                  C      RL.M17:
  6C3B*   3E 03          C      	LD	A,003H
  6C3D*   A2             C      	AND	D	;TEST ADRESSLAENGE
  6C3E*   F5             C      	PUSH	AF
  6C3F*   E5             C      	PUSH	HL
  6C40*   CD 6C95*       C      	CALL	RL.UP6
  6C43*   62             C      	LD	H,D	;ADRESSE ---->HL
  6C44*   CD 6C95*       C      	CALL	RL.UP6
  6C47*   6A             C      	LD	L,D
  6C48*   C5             C      	PUSH	BC
  6C49*   E5             C      	PUSH	HL
  6C4A*   21 2B30*       C      	LD	HL,UB.PATAB
  6C4D*   4E             C      	LD	C,(HL)	;BEGINN(LADE)ADRESSE--->BC
  6C4E*   23             C      	INC	HL
  6C4F*   46             C      	LD	B,(HL)
  6C50*   E1             C      	POP	HL
  6C51*   09             C      	ADD	HL,BC	;ERMITTELN SPEICHERADRESSE
  6C52*   EB             C      	EX	DE,HL	;SP.ADR.--->DE
  6C53*   C1             C      	POP	BC
  6C54*   E1             C      	POP	HL
  6C55*   F1             C      	POP	AF
  6C56*   28 04          C      	JR	Z,RL.M13
  6C58*   CB 47          C      	BIT	0,A	;NUR L-TEIL DER ADRESSE ?
  6C5A*   28 10          C      	JR	Z,RL.M14	; JA
                         C      ;********** ADRESSE IN SPEICHER EINTRAGEN *****************************
  6C5C*                  C      RL.M13:
  6C5C*   73             C      	LD	(HL),E
  6C5D*   F5             C      	PUSH	AF
  6C5E*   7B             C      	LD	A,E
  6C5F*   BE             C      	CP	(HL)
  6C60*   C2 6CE0*       C      	JP	NZ,RL.ECHO
  6C63*   F1             C      	POP	AF
  6C64*   23             C      	INC	HL
  6C65*   FE 03          C      	CP	003H
'Relativloader fuer O-Dateien'	MACRO-80 3.44	09-Dec-81	PAGE	1-68


  6C67*   28 03          C      	JR	Z,RL.M14
  6C69*   B7             C      	OR	A	;NUR H-TEIL DER ADRESSE ?
  6C6A*   20 08          C      	JR	NZ,RL.M15	; JA
  6C6C*                  C      RL.M14:
  6C6C*   72             C      	LD	(HL),D
  6C6D*   F5             C      	PUSH	AF
  6C6E*   7A             C      	LD	A,D
  6C6F*   BE             C      	CP	(HL)
  6C70*   20 6E          C      	JR	NZ,RL.ECHO
  6C72*   F1             C      	POP	AF
  6C73*   23             C      	INC	HL
  6C74*                  C      RL.M15:
  6C74*   CD 6C95*       C      	CALL	RL.UP6
  6C77*   CB 7A          C      	BIT	7,D	; TEST BEFEHLSKENNZEICHENBYTE
  6C79*   20 92          C      	JR	NZ,RL.M16
  6C7B*   C3 6CF9*       C      	JP	RL.BF	; NEIN--->FEHLER
                         C      ;----------------------------------------------------------------------
  6C7E*                  C      RL.M10:
  6C7E*   CD 6C95*       C      	CALL	RL.UP6	;BEI BER-BEFEHL ADDIEREN DER
  6C81*   D5             C      	PUSH	DE	;DEF. BEREICHSLAENGE ZU
  6C82*   CD 6C95*       C      	CALL	RL.UP6	;ADRESSE
  6C85*   7A             C      	LD	A,D
  6C86*   D1             C      	POP	DE
  6C87*   5F             C      	LD	E,A
  6C88*   19             C      	ADD	HL,DE
  6C89*   CD 6C95*       C      	CALL	RL.UP6
  6C8C*   C3 6C0D*       C      	JP	RL.M16
  6C8F*                  C      RL.M11:
  6C8F*   CD 6C95*       C      	CALL	RL.UP6	;BEI BFL=0 SPRUNG ZUM TEST
  6C92*   C3 6C3B*       C      	JP	RL.M17	;ADRESSKENNZEICHENBYTE
                         C      ;******* UP ZUR ZEICHENWEISE EINGABE DER O-DATEI **********************
  6C95*                  C      RL.UP6:
  6C95*   CD 6147*       C      	CALL	UK.GETK
  6C98*   57             C      	LD	D,A
  6C99*   0D             C      	DEC	C	;REDUZIEREN BLOCKLAENGE
  6C9A*   C0             C      	RET	NZ		;RET BEI UNGLEICH NULL
  6C9B*   A7             C      	AND	A	;IST NAECHSTE BLOCKLAENGE NULL ?
  6C9C*   28 04          C      	JR	Z,RL.M21	;JA-->VERZWEIGUNG ENDEBEH
  6C9E*   4F             C      	LD	C,A	;NEIN-->EINTRAGEN BLKLAENGE
  6C9F*   0C             C      	INC	C
  6CA0*   18 F3          C      	JR	RL.UP6
                         C      ;*********** ENDEBEHANDLUNG *******************************************
  6CA2*                  C      RL.M21:
  6CA2*   D1             C      	POP	DE
  6CA3*   E5             C      	PUSH	HL
  6CA4*   3E 0F          C      	LD	A,15
  6CA6*   32 2B00*       C      	LD	(UB.ZN),A
  6CA9*   21 5F8C*       C      	LD	HL,UA.ZKEND+3
  6CAC*   11 3460        C      	LD	DE,3460H
  6CAF*   01 0010        C      	LD	BC,16
  6CB2*   ED B0          C      	LDIR
  6CB4*   21 2B00*       C      	LD	HL,UB.ZN
  6CB7*   34             C      	INC	(HL)
  6CB8*   E1             C      	POP	HL
  6CB9*   2B             C      	DEC	HL
  6CBA*   11 3470        C      	LD	DE,3470H	;HINTER AUSSCHRIFT ENDE
  6CBD*   CD 56BF*       C      	CALL	UC.CVHLX
  6CC0*   21 5F9C*       C      	LD	HL,UA.STADR	;STARTADRESSE ?
  6CC3*   CD 595C*       C      	CALL	UR.MIMO
  6CC6*   D8             C      	RET	C
  6CC7*   EB             C      	EX	DE,HL
  6CC8*   21 2B32*       C      	LD	HL,UB.PATAB+2
  6CCB*   CD 5705*       C      	CALL	UC.CVXA	;STARTADR.-->BINAER
  6CCE*   3A 3329        C      	LD	A,(UE.BWSA+329H)
  6CD1*   FE 53          C      	CP	'S'
  6CD3*   20 04          C      	JR	NZ,$+6
  6CD5*   2A 2B32*       C      	LD	HL,(UB.PATAB+2)
  6CD8*   E9             C      	JP	(HL)
  6CD9*   CD 60A7*       C      	CALL	UR.KRW
  6CDC*   CD 60B1*       C      	CALL	UR.KRA
  6CDF*   C9             C      	RET
                         C      ;---------------------------------------------------------------------
  6CE0*                  C      RL.ECHO:
  6CE0*   D1             C      	POP	DE
  6CE1*   3E 93          C      	LD	A,93H
  6CE3*   18 16          C      	JR	RL.FMELD
  6CE5*                  C      RL.DATNV:
  6CE5*   3E 91          C      	LD	A,91H
  6CE7*   18 12          C      	JR	RL.FMELD
  6CE9*                  C      RL.OB:
  6CE9*   3E 96          C      	LD	A,96H
  6CEB*   18 0E          C      	JR	RL.FMELD
  6CED*                  C      RL.RA:
'Relativloader fuer O-Dateien'	MACRO-80 3.44	09-Dec-81	PAGE	1-69


  6CED*   3E 97          C      	LD	A,97H
  6CEF*   18 0A          C      	JR	RL.FMELD
  6CF1*                  C      RL.SV:
  6CF1*   3E 98          C      	LD	A,98H
  6CF3*   18 06          C      	JR	RL.FMELD
  6CF5*                  C      RL.MN:
  6CF5*   3E 99          C      	LD	A,99H
  6CF7*   18 02          C      	JR	RL.FMELD
  6CF9*                  C      RL.BF:
  6CF9*   3E 9A          C      	LD	A,9AH
  6CFB*                  C      RL.FMELD:
  6CFB*   CD 5D5F*       C      	CALL	UF.ERANZ
  6CFE*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Retten von Maschinencodeprogrammen als MRES - P-Datei'
                         C      	PAGE
'Retten von Maschinencodeprogrammen als MRES - P-Datei'	MACRO-80 3.44	09-Dec-81	PAGE	1-70


                         C      
                         C      ;	PN	SV
                         C      ;**********************************************************************
                         C      ;
                         C      ;      Retten von Maschinencodeprogrammen als MRES - P-Datei
                         C      ;
                         C      ;**********************************************************************
  6CFF*   6CFF*          C      	DW	$
  6D01*   53 41 56 45    C      	DB	'SAVE'
  6D05*   3A 3327        C      	LD	A,(UE.BWSA+ 10*80 +7)	;327H
  6D08*   CD 55C5*       C      	CALL	U1.TST
  6D0B*   D8             C      	RET	C
  6D0C*   CD 54E2*       C      	CALL	U1.KTINI
  6D0F*   DD 77 03       C      	LD	(IX+3),A
  6D12*   AF             C      	XOR	A
  6D13*   32 2B27*       C      	LD	(UB.PAR1+1),A
  6D16*   CD 55B1*       C      	CALL	U1.BILO	;BS LOESCHEN
  6D19*   CD 609F*       C      	CALL	UR.KRE
  6D1C*   DD CB 00 56    C      	BIT	2,(IX)
  6D20*   28 05          C      	JR	Z,$+7
  6D22*   3E 19          C      	LD	A,19H
  6D24*   CD 5D5F*       C      	CALL	UF.ERANZ
  6D27*   CD 60AD*       C      	CALL	UR.KRWW
  6D2A*                  C      SV.SV20:
  6D2A*   CD 5496*       C      	CALL	U1.DSVG
  6D2D*   C5             C      	PUSH	BC
  6D2E*   79             C      	LD	A,C
  6D2F*   32 2B26*       C      	LD	(UB.PAR1),A	;NEXT RECORD
  6D32*   3E 0D          C      	LD	A,13
  6D34*   32 2B00*       C      	LD	(UB.ZN),A
  6D37*                  C      SV.DATN:
  6D37*   21 5F50*       C      	LD	HL,UA.ZKDAT	;Dateiname ?
  6D3A*   CD 595C*       C      	CALL	UR.MIMO
  6D3D*   D8             C      	RET	C
  6D3E*   C1             C      	POP	BC
  6D3F*   05             C      	DEC	B
  6D40*   28 1A          C      	JR	Z,SV.SV30	;NEUE KASSETTE
  6D42*                  C      SV.SV21:
  6D42*   CD 61A7*       C      	CALL	UK.KBW
  6D45*   CD 54C7*       C      	CALL	U1.NMVGL
  6D48*   38 04          C      	JR	C,SV.DATV1	;Dateiname bereits vorhanden
  6D4A*   10 F6          C      	DJNZ	SV.SV21
  6D4C*   18 0E          C      	JR	SV.SV30
  6D4E*                  C      SV.DATV1:
  6D4E*   3E 01          C      	LD	A,01H
  6D50*   B8             C      	CP	B
  6D51*   CC 6E9A*       C      	CALL	Z,SV.DALO1
  6D54*   28 0E          C      	JR	Z,SV.SV37
  6D56*                  C      SV.DATVO:
  6D56*   3E 92          C      	LD	A,92H
  6D58*   CD 5D5F*       C      	CALL	UF.ERANZ
  6D5B*   C9             C      	RET
  6D5C*                  C      SV.SV30:
  6D5C*   3E 50          C      	LD	A,'P'
  6D5E*   32 2B28*       C      	LD	(UB.PAR2),A
  6D61*   CD 554E*       C      	CALL	U1.VZS
  6D64*                  C      SV.SV37:
  6D64*   3A 2B27*       C      	LD	A,(UB.PAR1+1)
  6D67*   FE 4C          C      	CP	'L'
  6D69*   20 0B          C      	JR	NZ,SV.SV31
  6D6B*   21 5FAF*       C      	LD	HL,UA.ZKDL
  6D6E*   CD 595C*       C      	CALL	UR.MIMO
  6D71*   7E             C      	LD	A,(HL)
  6D72*   FE 4A          C      	CP	'J'
  6D74*   20 E0          C      	JR	NZ,SV.DATVO
  6D76*                  C      SV.SV31:
  6D76*   3A 2B26*       C      	LD	A,(UB.PAR1)	;NEXT RECORD
  6D79*   47             C      	LD	B,A
  6D7A*   C5             C      	PUSH	BC
  6D7B*   04             C      	INC	B
  6D7C*   CD 60E4*       C      	CALL	UR.POSIK
  6D7F*   CD 61A7*       C      	CALL	UK.KBW
  6D82*   21 0E65        C      	LD	HL,UE.PUF
  6D85*   C1             C      	POP	BC
  6D86*   7E             C      	LD	A,(HL)
  6D87*   B8             C      	CP	B
  6D88*   28 06          C      	JR	Z,SV.SAVE3
  6D8A*   3E 94          C      	LD	A,94H
  6D8C*   CD 5D5F*       C      	CALL	UF.ERANZ
  6D8F*   C9             C      	RET
  6D90*                  C      SV.SAVE3:
  6D90*   21 5F76*       C      	LD	HL,UA.ZKBEG	;Beginn ?
'Retten von Maschinencodeprogrammen als MRES - P-Datei'	MACRO-80 3.44	09-Dec-81	PAGE	1-71


  6D93*   CD 595C*       C      	CALL	UR.MIMO
  6D96*   DA 6D37*       C      	JP	C,SV.DATN
  6D99*   CD 55CF*       C      	CALL	U1.PRADR
  6D9C*   38 F2          C      	JR	C,SV.SAVE3
  6D9E*   EB             C      	EX	DE,HL
  6D9F*   21 2B28*       C      	LD	HL,UB.PAR2
  6DA2*   CD 5705*       C      	CALL	UC.CVXA
  6DA5*                  C      SV.SAVE4:
  6DA5*   21 5F89*       C      	LD	HL,UA.ZKEND	;Ende ?
  6DA8*   CD 595C*       C      	CALL	UR.MIMO
  6DAB*   38 E3          C      	JR	C,SV.SAVE3
  6DAD*   CD 55CF*       C      	CALL	U1.PRADR
  6DB0*   38 F3          C      	JR	C,SV.SAVE4
  6DB2*   EB             C      	EX	DE,HL
  6DB3*   21 2B2A*       C      	LD	HL,UB.PAR3
  6DB6*   CD 5705*       C      	CALL	UC.CVXA
  6DB9*   CD 6E09*       C      	CALL	SV.BYANZ
  6DBC*   38 D2          C      	JR	C,SV.SAVE3
  6DBE*   28 D0          C      	JR	Z,SV.SAVE3
  6DC0*   CD 6E2E*       C      	CALL	SV.SAVE
  6DC3*   CD 60C3*       C      	CALL	UR.KBM
  6DC6*   CD 6E14*       C      	CALL	SV.DATS1	;1.DATEISATZ SCHREIBEN
  6DC9*   CD 60C9*       C      	CALL	UR.KSL
  6DCC*   CD 60AD*       C      	CALL	UR.KRWW
  6DCF*   CD 5496*       C      	CALL	U1.DSVG
  6DD2*   05             C      	DEC	B
  6DD3*   3A 2B27*       C      	LD	A,(UB.PAR1+1)
  6DD6*   FE 4C          C      	CP	'L'
  6DD8*   28 13          C      	JR	Z,SV.SAVE5
  6DDA*   21 0E66        C      	LD	HL,UE.PUF+1
  6DDD*   34             C      	INC	(HL)	;NEXT RECORD+1
  6DDE*   21 0E68        C      	LD	HL,UE.PUF+3
  6DE1*   46             C      	LD	B,(HL)
  6DE2*   34             C      	INC	(HL)	;ANZ.VERZ.EINTR.+1
  6DE3*                  C      SV.SAVE6:
  6DE3*   CD 60D5*       C      	CALL	UR.KBR
  6DE6*   DD 36 04 08    C      	LD	(IX+4),08H	;NEUEN DS-SATZ AUSGEBEN
  6DEA*   CD 5D2F*       C      	CALL	UF.EXEC
  6DED*                  C      SV.SAVE5:
  6DED*   CD 61A7*       C      	CALL	UK.KBW
  6DF0*   10 FB          C      	DJNZ	SV.SAVE5
  6DF2*   CD 60D5*       C      	CALL	UR.KBR
  6DF5*   2A 2B2E*       C      	LD	HL,(UB.PAR5)
  6DF8*   22 0E7E        C      	LD	(UE.PUF+25),HL	;DATEILAENGE EINTRAGEN
  6DFB*   DD 36 04 08    C      	LD	(IX+4),08H
  6DFF*   CD 5D2F*       C      	CALL	UF.EXEC
  6E02*   CD 60A7*       C      	CALL	UR.KRW
  6E05*   CD 60B1*       C      	CALL	UR.KRA
  6E08*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  6E09*                  C      SV.BYANZ:
  6E09*   2A 2B2A*       C      	LD	HL,(UB.PAR3)	;Byteanzahl berechnen
  6E0C*   ED 5B 2B28*    C      	LD	DE,(UB.PAR2)
  6E10*   B7             C      	OR	A
  6E11*   ED 52          C      	SBC	HL,DE
  6E13*   C9             C      	RET
  6E14*                  C      SV.DATS1:
  6E14*   21 0020        C      	LD	HL,32	;1. Dateisatz schreiben
  6E17*   CD 5631*       C      	CALL	XY.STIDX
  6E1A*   09             C      	DB	9
  6E1B*   CD 5486*       C      	CALL	U1.VSX
  6E1E*   21 0E65        C      	LD	HL,UE.PUF
  6E21*   3A 2B26*       C      	LD	A,(UB.PAR1)	;NEXT RECORD
  6E24*   3C             C      	INC	A
  6E25*   77             C      	LD	(HL),A
  6E26*   DD 36 04 08    C      	LD	(IX+4),08H
  6E2A*   CD 5D2F*       C      	CALL	UF.EXEC
  6E2D*   C9             C      	RET
  6E2E*                  C      SV.SAVE:
  6E2E*   21 0000        C      	LD	HL,0
  6E31*   CD 5621*       C      	CALL	XY.STDX
  6E34*   11             C      	DB	17
  6E35*   21 0080        C      	LD	HL,80H	;Blocklaenge
  6E38*   CD 5631*       C      	CALL	XY.STIDX
  6E3B*   09             C      	DB	9
  6E3C*   CD 620F*       C      	CALL	UK.KSPFB	;Pufferbereitstellung
  6E3F*                  C      SV.SAVE1:
  6E3F*   CD 6E09*       C      	CALL	SV.BYANZ	;Byteanzahl berechnen
  6E42*   23             C      	INC	HL
  6E43*   E5             C      	PUSH	HL
  6E44*   7C             C      	LD	A,H
  6E45*   B5             C      	OR	L
  6E46*   E1             C      	POP	HL
'Retten von Maschinencodeprogrammen als MRES - P-Datei'	MACRO-80 3.44	09-Dec-81	PAGE	1-72


  6E47*   28 13          C      	JR	Z,SV.SVLS2	;---> 0 Byte
  6E49*   01 007D        C      	LD	BC,UE.SVL	;Satzlaenge
  6E4C*   B7             C      	OR	A
  6E4D*   ED 42          C      	SBC	HL,BC
  6E4F*   38 05          C      	JR	C,SV.SVLS	;---> letzter Satz
  6E51*   CD 6EA5*       C      	CALL	SV.SVSZ
  6E54*   18 E9          C      	JR	SV.SAVE1
  6E56*                  C      SV.SVLS:
  6E56*   7D             C      	LD	A,L
  6E57*   C6 7D          C      	ADD	A,UE.SVL	;A:= Laenge des letzten Satzes
  6E59*   CD 6EA7*       C      	CALL	SV.SVSZ2
  6E5C*                  C      SV.SVLS2:
  6E5C*   AF             C      	XOR	A
  6E5D*   CD 61EB*       C      	CALL	UK.PUTK
  6E60*   21 5F9C*       C      	LD	HL,UA.STADR	;Startadresse
  6E63*   CD 595C*       C      	CALL	UR.MIMO
  6E66*   7E             C      	LD	A,(HL)
  6E67*   FE 20          C      	CP	' '
  6E69*   28 27          C      	JR	Z,SV.STAD0	;KEINE EINGABE (0000)
  6E6B*   EB             C      	EX	DE,HL
  6E6C*   21 2B2C*       C      	LD	HL,UB.PAR4
  6E6F*   CD 5705*       C      	CALL	UC.CVXA
  6E72*                  C      SV.SVLS1:
  6E72*   2A 2B2C*       C      	LD	HL,(UB.PAR4)
  6E75*   7C             C      	LD	A,H	;Startadresse ausgeben
  6E76*   CD 61EB*       C      	CALL	UK.PUTK
  6E79*   7D             C      	LD	A,L
  6E7A*   CD 61EB*       C      	CALL	UK.PUTK
  6E7D*   0E 03          C      	LD	C,3
  6E7F*                  C      SV.SVEN2:
  6E7F*   06 80          C      	LD	B,80H
  6E81*   AF             C      	XOR	A
  6E82*                  C      SV.SVEN1:
  6E82*   CD 61EB*       C      	CALL	UK.PUTK
  6E85*   10 FB          C      	DJNZ	SV.SVEN1
  6E87*   0D             C      	DEC	C
  6E88*   20 F5          C      	JR	NZ,SV.SVEN2
  6E8A*   CD 5601*       C      	CALL	XY.LDDX
  6E8D*   11             C      	DB	17
  6E8E*   22 2B2E*       C      	LD	(UB.PAR5),HL
  6E91*   C9             C      	RET
  6E92*                  C      SV.STAD0:
  6E92*   21 0000        C      	LD	HL,0
  6E95*   22 2B2C*       C      	LD	(UB.PAR4),HL
  6E98*   18 D8          C      	JR	SV.SVLS1
  6E9A*                  C      SV.DALO1:
  6E9A*   F5             C      	PUSH	AF
  6E9B*   21 2B26*       C      	LD	HL,UB.PAR1
  6E9E*   35             C      	DEC	(HL)
  6E9F*   23             C      	INC	HL
  6EA0*   3E 4C          C      	LD	A,'L'
  6EA2*   77             C      	LD	(HL),A
  6EA3*   F1             C      	POP	AF
  6EA4*   C9             C      	RET
  6EA5*                  C      SV.SVSZ:
  6EA5*   3E 7D          C      	LD	A,UE.SVL
  6EA7*                  C      SV.SVSZ2:
  6EA7*   F5             C      	PUSH	AF
  6EA8*   CD 61EB*       C      	CALL	UK.PUTK
  6EAB*   ED 5B 2B28*    C      	LD	DE,(UB.PAR2)
  6EAF*   7A             C      	LD	A,D
  6EB0*   CD 61EB*       C      	CALL	UK.PUTK
  6EB3*   7B             C      	LD	A,E
  6EB4*   CD 61EB*       C      	CALL	UK.PUTK
  6EB7*   F1             C      	POP	AF
  6EB8*   47             C      	LD	B,A
  6EB9*                  C      SV.SVSZ1:
  6EB9*   1A             C      	LD	A,(DE)
  6EBA*   CD 61EB*       C      	CALL	UK.PUTK
  6EBD*   13             C      	INC	DE
  6EBE*   10 F9          C      	DJNZ	SV.SVSZ1
  6EC0*   ED 53 2B28*    C      	LD	(UB.PAR2),DE
  6EC4*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                                ;
                                ;	INCLUDE	KX.MAC	;Kopieren von MRES-Kassetten Teil 1
                                ;	INCLUDE	KY.MAC	;Kopieren von MRES-Kassetten Teil 2
                                ;	INCLUDE	KU.MAC	;Unterprogramme fuer KOPI
                         C      	INCLUDE K4.MAC	;Kopieren MRES
                         C      	TITLE	'Kopieren von MRES-Kassetten Teil 1'
                         C      	PAGE
'Kopieren von MRES-Kassetten Teil 1'	MACRO-80 3.44	09-Dec-81	PAGE	1-73


                         C      
                         C      ;	PN	KX
                         C      ;------------------------------------------------------------------
                         C      ;
                         C      ;          KOPIEREN VON MRES-KASSETTEN       TEIL1
                         C      ;
                         C      ;----------------------------------------------------------------
  6EC5*   6EC5*          C      	DW	$
  6EC7*   4B 4F 50 49    C      	DB	'KOPI'
  6ECB*   CD 54E2*       C      	CALL	U1.KTINI
  6ECE*   11 E000        C      	LD	DE,BC.TAB1
  6ED1*   21 3327        C      	LD	HL,UE.BWSA + 10*80 +7	;327H
  6ED4*   7E             C      	LD	A,(HL)
  6ED5*   CD 55C5*       C      	CALL	U1.TST
  6ED8*   D8             C      	RET	C
  6ED9*   12             C      	LD	(DE),A
  6EDA*   23             C      	INC	HL
  6EDB*   EE 33          C      	XOR	33H
  6EDD*   BE             C      	CP	(HL)
  6EDE*   C0             C      	RET	NZ
  6EDF*   EE 30          C      	XOR	30H
  6EE1*   13             C      	INC	DE
  6EE2*   12             C      	LD	(DE),A
  6EE3*   3A 3326        C      	LD	A,(UE.BWSA + 10*80 +6)	;326H
  6EE6*   FE 4A          C      	CP	'J'
  6EE8*   28 05          C      	JR	Z,$+7	;BEI KOPIJ WERDEN WEITERE PARAMETER
  6EEA*   23             C      	INC	HL	;IGNORIERT
  6EEB*   23             C      	INC	HL
  6EEC*   7E             C      	LD	A,(HL)
  6EED*   FE 20          C      	CP	20H
  6EEF*   F5             C      	PUSH	AF
  6EF0*   20 0C          C      	JR	NZ,$+14
  6EF2*   CD 546D*       C      	CALL	U1.EIN
  6EF5*   CD 55E6*       C      	CALL	U1.KRWE
  6EF8*   CD 5476*       C      	CALL	U1.AUS
  6EFB*   CD 55E6*       C      	CALL	U1.KRWE
  6EFE*   CD 7039*       C      	CALL	KX.UPA
  6F01*   F1             C      	POP	AF
  6F02*   28 13          C      	JR	Z,$+21
  6F04*   FE 41          C      	CP	'A'
  6F06*   28 0A          C      	JR	Z,$+12
  6F08*   FE 4C          C      	CP	'L'
  6F0A*   20 0B          C      	JR	NZ,$+13
  6F0C*   CD 5445*       C      	CALL	U1.COPB
  6F0F*   C3 6FDF*       C      	JP	KX.RSPFR
  6F12*   CD 5441*       C      	CALL	U1.COPB2
  6F15*   18 FB          C      	JR	$-3
                         C      ;-------------------------------------------------------------------
  6F17*   CD 546D*       C      	CALL	U1.EIN
  6F1A*   CD 5496*       C      	CALL	U1.DSVG
  6F1D*   CD 5420*       C      	CALL	U1.KBR4
  6F20*   CD 542B*       C      	CALL	U1.BREAD
  6F23*   21 5E62*       C      	LD	HL,UA.Z7E
  6F26*   11 3163        C      	LD	DE,SD.BWSA +  4*80 + 35	;3163H
  6F29*   01 001F        C      	LD	BC,31
  6F2C*   ED B0          C      	LDIR
  6F2E*   21 5E81*       C      	LD	HL,UA.GER
  6F31*   11 31EA        C      	LD	DE,SD.BWSA +  6*80 + 10	;31EAH
  6F34*   CD 55AB*       C      	CALL	U1.INFO
  6F37*   21 5E2C*       C      	LD	HL,UA.KNAME+3
  6F3A*   11 323A        C      	LD	DE,SD.BWSA +  7*80 + 10	;323AH
  6F3D*   CD 55AB*       C      	CALL	U1.INFO
  6F40*   21 5E3F*       C      	LD	HL,UA.NR+3
  6F43*   11 328A        C      	LD	DE,SD.BWSA +  8*80 + 10	;328AH
  6F46*   CD 55AB*       C      	CALL	U1.INFO
  6F49*   21 5E52*       C      	LD	HL,UA.KOMMT+3
  6F4C*   11 32DA        C      	LD	DE,SD.BWSA +  9*80 + 10	;32DAH
  6F4F*   CD 55AB*       C      	CALL	U1.INFO
  6F52*   11 3203        C      	LD	DE,SD.BWSA +  6*80 + 35	;3203H
  6F55*   3A E000        C      	LD	A,(BC.TAB1)
  6F58*   CD 56A5*       C      	CALL	UC.CVBX+2
  6F5B*   11 321B        C      	LD	DE,SD.BWSA +  6*80 + 59	;321BH
  6F5E*   3A E001        C      	LD	A,(BC.TAB1+1)
  6F61*   CD 56A5*       C      	CALL	UC.CVBX+2
  6F64*   21 0E69        C      	LD	HL,UE.PUF+4
  6F67*   11 3253        C      	LD	DE,SD.BWSA +  7*80 + 35	;3253H
  6F6A*   06 06          C      	LD	B,6
  6F6C*   CD 57B0*       C      	CALL	UC.DKONV
  6F6F*   21 0E8A        C      	LD	HL,UE.PUF+37
  6F72*   11 32A3        C      	LD	DE,SD.BWSA +  8*80 + 35	;32A3H
  6F75*   06 03          C      	LD	B,3
  6F77*   CD 57B0*       C      	CALL	UC.DKONV
'Kopieren von MRES-Kassetten Teil 1'	MACRO-80 3.44	09-Dec-81	PAGE	1-74


  6F7A*   11 32F3        C      	LD	DE,SD.BWSA +  9*80 + 35	;32F3H
  6F7D*   06 0B          C      	LD	B,11
  6F7F*   CD 57B0*       C      	CALL	UC.DKONV
  6F82*   CD 60CF*       C      	CALL	UR.KBV
  6F85*   CD 60CF*       C      	CALL	UR.KBV
  6F88*   CD 542B*       C      	CALL	U1.BREAD
  6F8B*   3A 0E68        C      	LD	A,(UE.PUF+3)
  6F8E*   3D             C      	DEC	A
  6F8F*   CA 6FEA*       C      	JP	Z,KX.ENDR
  6F92*   CD 5518*       C      	CALL	U1.VERIN
  6F95*   CD 5476*       C      	CALL	U1.AUS
  6F98*   CD 5496*       C      	CALL	U1.DSVG
  6F9B*   CD 5420*       C      	CALL	U1.KBR4
  6F9E*   DD 36 04 02    C      	LD	(IX+4),02H
  6FA2*   CD 5D2F*       C      	CALL	UF.EXEC
  6FA5*   21 0E69        C      	LD	HL,UE.PUF+4
  6FA8*   11 326B        C      	LD	DE,SD.BWSA +  7*80 + 59	;326BH
  6FAB*   06 06          C      	LD	B,6
  6FAD*   CD 57B0*       C      	CALL	UC.DKONV
  6FB0*   21 0E8A        C      	LD	HL,UE.PUF+37
  6FB3*   11 32BB        C      	LD	DE,SD.BWSA +  8*80 + 59	;32BBH
  6FB6*   06 03          C      	LD	B,3
  6FB8*   CD 57B0*       C      	CALL	UC.DKONV
  6FBB*   11 330B        C      	LD	DE,SD.BWSA +  9*80 + 59	;330BH
  6FBE*   06 0B          C      	LD	B,11
  6FC0*   CD 57B0*       C      	CALL	UC.DKONV
  6FC3*   CD 60CF*       C      	CALL	UR.KBV
  6FC6*   CD 60CF*       C      	CALL	UR.KBV
  6FC9*   DD 36 04 02    C      	LD	(IX+4),02H
  6FCD*   CD 5D2F*       C      	CALL	UF.EXEC
  6FD0*   CD 55B1*       C      	CALL	U1.BILO
  6FD3*   11 E002        C      	LD	DE,BC.VTABA
  6FD6*   CD 5520*       C      	CALL	U1.VERNI
  6FD9*   CD 553A*       C      	CALL	U1.VORST
  6FDC*   C3 7056*       C      	JP	KY.MD
  6FDF*                  C      KX.RSPFR:
  6FDF*   F5             C      	PUSH	AF
  6FE0*   23             C      	INC	HL
  6FE1*   23             C      	INC	HL
  6FE2*   7E             C      	LD	A,(HL)
  6FE3*   B7             C      	OR	A
  6FE4*   FE 52          C      	CP	'R'
  6FE6*   20 06          C      	JR	NZ,$+8
  6FE8*   18 01          C      	JR	$+3
  6FEA*                  C      KX.ENDR:
  6FEA*   F5             C      	PUSH	AF
  6FEB*   37             C      	SCF
  6FEC*   18 04          C      	JR	$+6
  6FEE*   FE 46          C      	CP	'F'
  6FF0*   20 15          C      	JR	NZ,$+23
  6FF2*   CD 546D*       C      	CALL	U1.EIN
  6FF5*   DC 60A7*       C      	CALL	C,UR.KRW
  6FF8*   CD 60B1*       C      	CALL	UR.KRA
  6FFB*   CD 5476*       C      	CALL	U1.AUS
  6FFE*   CD 609F*       C      	CALL	UR.KRE
  7001*   DC 60AD*       C      	CALL	C,UR.KRWW
  7004*   CD 60B1*       C      	CALL	UR.KRA
  7007*   F1             C      	POP	AF
  7008*   C9             C      	RET
  7009*                  C      KX.EXEC2:
  7009*   F5             C      	PUSH	AF
  700A*   DD CB 00 BE    C      	RES	7,(IX+0)
  700E*   DD 36 01 00    C      	LD	(IX+1),0
  7012*   CD 5C97*       C      	CALL	KR.KARO
  7015*   DD CB 00 7E    C      	BIT	7,(IX+0)
  7019*   28 0A          C      	JR	Z,$+12
  701B*   DD 7E 01       C      	LD	A,(IX+1)
  701E*   FE 14          C      	CP	14H
  7020*   28 05          C      	JR	Z,$+7
  7022*   CD 5D5F*       C      	CALL	UF.ERANZ
  7025*   F1             C      	POP	AF
  7026*   C9             C      	RET
  7027*   DD CB 00 BE    C      	RES	7,(IX)
  702B*   CD 5476*       C      	CALL	U1.AUS
  702E*   CD 60C9*       C      	CALL	UR.KSL
  7031*   F1             C      	POP	AF
  7032*   06 06          C      	LD	B,6
  7034*   33             C      	INC	SP
  7035*   10 FD          C      	DJNZ	$-1	;STACK BERICHTIGEN
  7037*   18 A6          C      	JR	KX.RSPFR
  7039*                  C      KX.UPA:
  7039*   CD 546D*       C      	CALL	U1.EIN
  703C*   CD 609F*       C      	CALL	UR.KRE
'Kopieren von MRES-Kassetten Teil 1'	MACRO-80 3.44	09-Dec-81	PAGE	1-75


  703F*   DD 36 00 00    C      	LD	(IX+0),0
  7043*   CD 5476*       C      	CALL	U1.AUS
  7046*   CD 609F*       C      	CALL	UR.KRE
  7049*   DD CB 00 56    C      	BIT	2,(IX+0)
  704D*   28 05          C      	JR	Z,$+7
  704F*   D1             C      	POP	DE
  7050*   3E 19          C      	LD	A,19H
  7052*   CD 5D5F*       C      	CALL	UF.ERANZ
  7055*   C9             C      	RET
                         C      ;	END
                         C      	TITLE	'Kopieren von MRES-Kassetten Teil 2'
                         C      	PAGE
'Kopieren von MRES-Kassetten Teil 2'	MACRO-80 3.44	09-Dec-81	PAGE	1-76


                         C      
                         C      ;	PN	KY
                         C      ;---------------------------------------------------------------------
                         C      ;
                         C      ;          KOPIEREN VON MRES-KASSETTEN           TEIL 2
                         C      ;
                         C      ;--------------------------------------------------------------------
  7056*                  C      KY.MD:
  7056*   CD 55B1*       C      	CALL	U1.BILO
  7059*   21 5E90*       C      	LD	HL,UA.KOPFR
  705C*   CD 72AF*       C      	CALL	KY.SATR
  705F*   3E 0D          C      	LD	A,13
  7061*   32 2B00*       C      	LD	(UB.ZN),A
  7064*   21 ECA2        C      	LD	HL,BC.VTABE+32
  7067*   FD 21 F902     C      	LD	IY,BC.TAB2
  706B*   FD 36 00 FF    C      	LD	(IY+0),0FFH
  706F*   3A EC85        C      	LD	A,(BC.VTABE+3)
  7072*   47             C      	LD	B,A
  7073*   05             C      	DEC	B
                         C      ;--------------------------------ABFRAGEZYKLUS------------------------
  7074*                  C      KY.DFR:
  7074*   C5             C      	PUSH	BC
  7075*   11 2B4E*       C      	LD	DE,UB.SATZ+26
  7078*   01 0006        C      	LD	BC,6
  707B*   ED B0          C      	LDIR
  707D*   13             C      	INC	DE
  707E*   13             C      	INC	DE
  707F*   01 0002        C      	LD	BC,2
  7082*   ED B0          C      	LDIR
  7084*   01 0018        C      	LD	BC,24
  7087*   09             C      	ADD	HL,BC
  7088*   E5             C      	PUSH	HL
  7089*   21 2B34*       C      	LD	HL,UB.SATZ
  708C*   CD 595C*       C      	CALL	UR.MIMO
  708F*   DC 730B*       C      	CALL	C,KU.ZEIR
  7092*   CD 72A6*       C      	CALL	KY.JHL	;BEI KOPIJ WIRD J GESETZT
  7095*   7E             C      	LD	A,(HL)
  7096*   FE 4A          C      	CP	'J'
  7098*   C4 72D3*       C      	CALL	NZ,KU.TAB2L
  709B*   E1             C      	POP	HL
  709C*   01 0009        C      	LD	BC,9
  709F*   B7             C      	OR	A
  70A0*   ED 42          C      	SBC	HL,BC
  70A2*   7E             C      	LD	A,(HL)
  70A3*   FD 77 00       C      	LD	(IY+0),A
  70A6*   FD 23          C      	INC	IY
  70A8*   FD 36 00 FF    C      	LD	(IY+0),0FFH
  70AC*   09             C      	ADD	HL,BC
  70AD*   3A E005        C      	LD	A,(BC.VTABA+3)
  70B0*   FE 01          C      	CP	01H
  70B2*   28 2E          C      	JR	Z,KY.EZYK1
  70B4*   E5             C      	PUSH	HL
  70B5*   01 0020        C      	LD	BC,32
  70B8*   B7             C      	OR	A
  70B9*   ED 42          C      	SBC	HL,BC
  70BB*   EB             C      	EX	DE,HL
  70BC*   E1             C      	POP	HL
  70BD*   DD 21 E002     C      	LD	IX,BC.VTABA
  70C1*   47             C      	LD	B,A
  70C2*   05             C      	DEC	B
  70C3*                  C      KY.VZVGL:
  70C3*   C5             C      	PUSH	BC
  70C4*   01 0020        C      	LD	BC,32
  70C7*   DD 09          C      	ADD	IX,BC
  70C9*   DD E5          C      	PUSH	IX
  70CB*   06 07          C      	LD	B,7
  70CD*   D5             C      	PUSH	DE
  70CE*                  C      KY.SVGL:
  70CE*   1A             C      	LD	A,(DE)
  70CF*   DD BE 00       C      	CP	(IX+0)
  70D2*   20 08          C      	JR	NZ,KY.NDA
  70D4*   DD 23          C      	INC	IX
  70D6*   13             C      	INC	DE
  70D7*   10 F5          C      	DJNZ	KY.SVGL
  70D9*   CD 733B*       C      	CALL	KU.DD	;DATEI SCHON VORHANDEN
  70DC*                  C      KY.NDA:
  70DC*   D1             C      	POP	DE
  70DD*   DD E1          C      	POP	IX
  70DF*   C1             C      	POP	BC
  70E0*   10 E1          C      	DJNZ	KY.VZVGL
  70E2*                  C      KY.EZYK1:
  70E2*   C1             C      	POP	BC
'Kopieren von MRES-Kassetten Teil 2'	MACRO-80 3.44	09-Dec-81	PAGE	1-77


  70E3*   10 8F          C      	DJNZ	KY.DFR
                         C      ;---------------------------------------------------------------------
  70E5*                  C      KY.ATAA:
  70E5*   06 03          C      	LD	B,3	;WARTESCHLEIFE FUER
  70E7*   21 FFFF        C      	LD	HL,0FFFFH
  70EA*   2B             C      	DEC	HL
  70EB*   7C             C      	LD	A,H
  70EC*   B5             C      	OR	L
  70ED*   20 FB          C      	JR	NZ,$-3
  70EF*   10 F6          C      	DJNZ	$-8
  70F1*   21 5EC6*       C      	LD	HL,UA.EABFR
  70F4*   CD 72AF*       C      	CALL	KY.SATR
  70F7*   21 2B34*       C      	LD	HL,UB.SATZ
  70FA*   CD 595C*       C      	CALL	UR.MIMO
  70FD*   38 F8          C      	JR	C,$-6
  70FF*   CD 72A6*       C      	CALL	KY.JHL
  7102*   7E             C      	LD	A,(HL)
  7103*   FE 4A          C      	CP	'J'
  7105*   C2 7056*       C      	JP	NZ,KY.MD
                         C      ;--------------------------------Labelnummern fuer Ausgabe ---------
  7108*                  C      KY.ATAB:
  7108*   06 00          C      	LD	B,0
  710A*   21 F902        C      	LD	HL,BC.TAB2
  710D*   11 F9D2        C      	LD	DE,BC.TAB3
  7110*   7E             C      	LD	A,(HL)
  7111*   FE FF          C      	CP	0FFH	;KEINE DATEI KOPIEREN
  7113*   CA 6FEA*       C      	JP	Z,KX.ENDR
  7116*   3A E003        C      	LD	A,(BC.VTABA+1)
  7119*                  C      KY.ATABE:
  7119*   12             C      	LD	(DE),A
  711A*   23             C      	INC	HL
  711B*   13             C      	INC	DE
  711C*   04             C      	INC	B
  711D*   F5             C      	PUSH	AF
  711E*   7E             C      	LD	A,(HL)
  711F*   FE FF          C      	CP	0FFH
  7121*   28 04          C      	JR	Z,KY.WEI
  7123*   F1             C      	POP	AF
  7124*   3C             C      	INC	A
  7125*   18 F2          C      	JR	KY.ATABE
                         C      ;------------------------------TAB:NR DER VERZ.EINTRAGUNGEN (EING.)------
  7127*                  C      KY.WEI:
  7127*   F1             C      	POP	AF
  7128*   C5             C      	PUSH	BC
  7129*   AF             C      	XOR	A
  712A*   57             C      	LD	D,A
  712B*   3A EC85        C      	LD	A,(BC.VTABE+3)
  712E*   47             C      	LD	B,A
  712F*   05             C      	DEC	B
  7130*   21 F902        C      	LD	HL,BC.TAB2
  7133*   FD 21 F96A     C      	LD	IY,BC.TAB2A
  7137*   DD 21 ECA2     C      	LD	IX,BC.VTABE+32	;???
  713B*                  C      KY.ZYK:
  713B*   14             C      	INC	D
  713C*   7E             C      	LD	A,(HL)
  713D*   DD BE 17       C      	CP	(IX+23)
  7140*   20 0B          C      	JR	NZ,KY.NE
  7142*   7A             C      	LD	A,D
  7143*   FD 77 00       C      	LD	(IY+0),A
  7146*   FD 36 01 FF    C      	LD	(IY+1),0FFH
  714A*   23             C      	INC	HL
  714B*   FD 23          C      	INC	IY
  714D*                  C      KY.NE:
  714D*   C5             C      	PUSH	BC
  714E*   01 0020        C      	LD	BC,32
  7151*   DD 09          C      	ADD	IX,BC
  7153*   C1             C      	POP	BC
  7154*   10 E5          C      	DJNZ	KY.ZYK
                         C      ;------------------------------------AUFBAU AUSGABEVERZ.-----
  7156*   3A E005        C      	LD	A,(BC.VTABA+3)
  7159*   47             C      	LD	B,A
  715A*   FE 01          C      	CP	01H
  715C*   28 08          C      	JR	Z,KY.EVZ
  715E*   21 E002        C      	LD	HL,BC.VTABA
  7161*   CD 72CA*       C      	CALL	KU.VVOR
  7164*   18 03          C      	JR	KY.EVZ1
  7166*                  C      KY.EVZ:
  7166*   21 E022        C      	LD	HL,BC.VTABA+32
  7169*                  C      KY.EVZ1:
  7169*   DD 21 F96A     C      	LD	IX,BC.TAB2A
  716D*   FD 21 F9D2     C      	LD	IY,BC.TAB3
  7171*   EB             C      	EX	DE,HL
  7172*   21 ECA2        C      	LD	HL,BC.VTABE+32
'Kopieren von MRES-Kassetten Teil 2'	MACRO-80 3.44	09-Dec-81	PAGE	1-78


  7175*   DD 7E 00       C      	LD	A,(IX+0)
  7178*   FE 01          C      	CP	01H
  717A*   28 05          C      	JR	Z,KY.VSTR
  717C*   3D             C      	DEC	A
  717D*   47             C      	LD	B,A
  717E*   CD 72CA*       C      	CALL	KU.VVOR
  7181*                  C      KY.VSTR:
  7181*   01 0020        C      	LD	BC,32
  7184*   ED B0          C      	LDIR
  7186*   FD 7E 00       C      	LD	A,(IY+0)
  7189*   EB             C      	EX	DE,HL
  718A*   01 0009        C      	LD	BC,9
  718D*   B7             C      	OR	A
  718E*   ED 42          C      	SBC	HL,BC
  7190*   77             C      	LD	(HL),A
  7191*   09             C      	ADD	HL,BC
  7192*   EB             C      	EX	DE,HL
  7193*   DD 7E 01       C      	LD	A,(IX+1)
  7196*   FE FF          C      	CP	0FFH
  7198*   28 10          C      	JR	Z,KY.COPY
  719A*   DD 96 00       C      	SUB	(IX+0)
  719D*   3D             C      	DEC	A
  719E*   47             C      	LD	B,A
  719F*   FE 00          C      	CP	00H
  71A1*   C4 72CA*       C      	CALL	NZ,KU.VVOR
  71A4*   FD 23          C      	INC	IY
  71A6*   DD 23          C      	INC	IX
  71A8*   18 D7          C      	JR	KY.VSTR
                         C      ;------------------------------------VERZ.SCHREIBEN (NUR NEUE SAETZE)---
  71AA*                  C      KY.COPY:
  71AA*   DD 21 2B03*    C      	LD	IX,UB.KTAB
  71AE*   CD 54FB*       C      	CALL	U1.KTIN1
  71B1*   DD 36 0A 20    C      	LD	(IX+10),20H
  71B5*   CD 5476*       C      	CALL	U1.AUS
  71B8*   3A E005        C      	LD	A,(BC.VTABA+3)
  71BB*   47             C      	LD	B,A
  71BC*   CD 60CF*       C      	CALL	UR.KBV	;AUSGABEKASSETTE
  71BF*   3D             C      	DEC	A
  71C0*   20 FA          C      	JR	NZ,$-4	;VORSTELLEN BIS HINTER LETZTEN ALTEN
  71C2*   21 E002        C      	LD	HL,BC.VTABA	;VERZ.SATZ
  71C5*   11 0020        C      	LD	DE,32
  71C8*   19             C      	ADD	HL,DE
  71C9*   10 FA          C      	DJNZ	$-4	;AUSGABEVERZ.ZEIGER
  71CB*   C1             C      	POP	BC
  71CC*   78             C      	LD	A,B
  71CD*   F5             C      	PUSH	AF
  71CE*                  C      KY.VSCHR:
  71CE*   11 0E65        C      	LD	DE,UE.PUF
  71D1*   01 0020        C      	LD	BC,32
  71D4*   ED B0          C      	LDIR
  71D6*   CD 60CF*       C      	CALL	UR.KBV
  71D9*   CD 60D5*       C      	CALL	UR.KBR
  71DC*   DD 36 04 08    C      	LD	(IX+4),08H
  71E0*   CD 5D2F*       C      	CALL	UF.EXEC
  71E3*   3D             C      	DEC	A
  71E4*   20 E8          C      	JR	NZ,KY.VSCHR
                         C      ;----------------------------------------------------------------
  71E6*   11 33FA        C      	LD	DE,SD.BWSA + 12*80 + 58	;33FAH	;''ES WIRD KOPIERT''
  71E9*   21 7296*       C      	LD	HL,KY.EWK
  71EC*   01 0010        C      	LD	BC,16
  71EF*   ED B0          C      	LDIR
                         C      ;------------------------------KOPIEREN--------------------------
  71F1*   21 F902        C      	LD	HL,BC.TAB2
  71F4*   11 F9D2        C      	LD	DE,BC.TAB3
  71F7*   FD 21 F96A     C      	LD	IY,BC.TAB2A
  71FB*   1A             C      	LD	A,(DE)
  71FC*   47             C      	LD	B,A
  71FD*   04             C      	INC	B
  71FE*   CD 60E4*       C      	CALL	UR.POSIK
  7201*   7E             C      	LD	A,(HL)
  7202*   47             C      	LD	B,A
  7203*   04             C      	INC	B
  7204*                  C      KY.KOPV:
  7204*   CD 546D*       C      	CALL	U1.EIN
  7207*   CD 60E4*       C      	CALL	UR.POSIK
  720A*                  C      KY.KOP:
  720A*   CD 542B*       C      	CALL	U1.BREAD
  720D*   7E             C      	LD	A,(HL)
  720E*   FE 01          C      	CP	01H
  7210*   CC 5486*       C      	CALL	Z,U1.VSX
                         C      ;------------------------ANZEIGE WELCHE DATEI KOPIERT WIRD-------------
  7213*   E5             C      	PUSH	HL
  7214*   D5             C      	PUSH	DE
'Kopieren von MRES-Kassetten Teil 2'	MACRO-80 3.44	09-Dec-81	PAGE	1-79


  7215*   FD 7E 00       C      	LD	A,(IY+0)
  7218*   47             C      	LD	B,A
  7219*   05             C      	DEC	B
  721A*   21 ECA2        C      	LD	HL,BC.VTABE+32
  721D*   FE 01          C      	CP	01H
  721F*   28 03          C      	JR	Z,KY.KOPAN
  7221*   CD 72CA*       C      	CALL	KU.VVOR
  7224*                  C      KY.KOPAN:
  7224*   11 34F0        C      	LD	DE,SD.BWSA + 15*80 + 64	;34F0H
  7227*   01 0006        C      	LD	BC,6
  722A*   ED B0          C      	LDIR
  722C*   13             C      	INC	DE
  722D*   13             C      	INC	DE
  722E*   01 0002        C      	LD	BC,2
  7231*   ED B0          C      	LDIR
  7233*   FD 23          C      	INC	IY
  7235*   D1             C      	POP	DE
  7236*   E1             C      	POP	HL
                         C      ;--------------------------------------------------------------------
  7237*   1A             C      	LD	A,(DE)
  7238*   FE 01          C      	CP	01H
  723A*   CC 547F*       C      	CALL	Z,U1.VS1
  723D*   32 0E65        C      	LD	(UE.PUF),A
  7240*   CD 5436*       C      	CALL	U1.BWRIT
  7243*   CD 5445*       C      	CALL	U1.COPB
  7246*   23             C      	INC	HL
  7247*   7E             C      	LD	A,(HL)
  7248*   FE FF          C      	CP	0FFH
  724A*   28 0B          C      	JR	Z,KY.EOV
  724C*   2B             C      	DEC	HL
  724D*   96             C      	SUB	(HL)
  724E*   23             C      	INC	HL
  724F*   13             C      	INC	DE
  7250*   47             C      	LD	B,A
  7251*   FE 01          C      	CP	01H
  7253*   20 AF          C      	JR	NZ,KY.KOPV
  7255*   18 B3          C      	JR	KY.KOP
                         C      ;-------------------------------------------------------------
  7257*                  C      KY.EOV:
  7257*   CD 5486*       C      	CALL	U1.VSX
  725A*   3A E003        C      	LD	A,(BC.VTABA+1)
  725D*   47             C      	LD	B,A
  725E*   F1             C      	POP	AF
  725F*   F5             C      	PUSH	AF
  7260*   80             C      	ADD	A,B
  7261*   32 0E65        C      	LD	(UE.PUF),A
  7264*   CD 54FB*       C      	CALL	U1.KTIN1
  7267*   DD 36 0A 20    C      	LD	(IX+10),20H
  726B*   CD 5436*       C      	CALL	U1.BWRIT
  726E*   CD 60C9*       C      	CALL	UR.KSL
  7271*   CD 6FEA*       C      	CALL	KX.ENDR
  7274*   CD 609F*       C      	CALL	UR.KRE
  7277*   CD 5496*       C      	CALL	U1.DSVG
  727A*   F1             C      	POP	AF
  727B*   F5             C      	PUSH	AF
  727C*   81             C      	ADD	A,C	;NEXT RECORD UND
  727D*   32 0E66        C      	LD	(UE.PUF+1),A
  7280*   F1             C      	POP	AF
  7281*   80             C      	ADD	A,B	;ANZAHL VERZ.EINTR. KORRIGIEREN
  7282*   32 0E68        C      	LD	(UE.PUF+3),A
  7285*   CD 60D5*       C      	CALL	UR.KBR
  7288*   DD 36 04 08    C      	LD	(IX+4),08H
  728C*   CD 5D2F*       C      	CALL	UF.EXEC	;NEUEN DS-SATZ SCHREIBEN
  728F*   CD 60A7*       C      	CALL	UR.KRW
  7292*   CD 60B1*       C      	CALL	UR.KRA
  7295*   C9             C      	RET
                         C      ;---------------------------------------------------------------
  7296*                  C      KY.EWK:
  7296*   45 73 20 77    C      	DB	'Es wird kopiert:'
  729A*   69 72 64 20    C      
  729E*   6B 6F 70 69    C      
  72A2*   65 72 74 3A    C      
                         C      ;---------------------------------------------------------------
  72A6*                  C      KY.JHL:
  72A6*   3A 2B28*       C      	LD	A,(UB.PAR2)
  72A9*   FE 4A          C      	CP	'J'
  72AB*   20 01          C      	JR	NZ,$+3
  72AD*   77             C      	LD	(HL),A
  72AE*   C9             C      	RET
                         C      ;--------------------------------------------------------------
  72AF*                  C      KY.SATR:
  72AF*   11 2B34*       C      	LD	DE,UB.SATZ
  72B2*   01 0036        C      	LD	BC,54
'Kopieren von MRES-Kassetten Teil 2'	MACRO-80 3.44	09-Dec-81	PAGE	1-80


  72B5*   ED B0          C      	LDIR
  72B7*   3A 3326        C      	LD	A,(UE.BWSA + 10*80 +6)	;326H
  72BA*   FE 4A          C      	CP	'J'
  72BC*   CC 72C3*       C      	CALL	Z,KY.AJ
  72BF*   32 2B28*       C      	LD	(UB.PAR2),A
  72C2*   C9             C      	RET
  72C3*                  C      KY.AJ:
  72C3*   F5             C      	PUSH	AF
  72C4*   AF             C      	XOR	A
  72C5*   32 2B34*       C      	LD	(UB.SATZ),A
  72C8*   F1             C      	POP	AF
  72C9*   C9             C      	RET
                         C      ;--------------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Unterprogramme fuer KOPI'
                         C      	PAGE
'Unterprogramme fuer KOPI'	MACRO-80 3.44	09-Dec-81	PAGE	1-81


                         C      
                         C      ;	PN	KU
                         C      ;------------------------------------------------------------------
                         C      ;
                         C      ;          UNTERPROGRAMME FUER KOPI
                         C      ;
                         C      ;--------------------------------------------------------
  72CA*                  C      KU.VVOR:
  72CA*   C5             C      	PUSH	BC
  72CB*   01 0020        C      	LD	BC,32
  72CE*   09             C      	ADD	HL,BC
  72CF*   C1             C      	POP	BC
  72D0*   10 F8          C      	DJNZ	KU.VVOR
  72D2*   C9             C      	RET
  72D3*                  C      KU.TAB2L:
  72D3*   D1             C      	POP	DE
  72D4*   E1             C      	POP	HL
  72D5*   FD 7E 00       C      	LD	A,(IY+0)
  72D8*   FE FF          C      	CP	0FFH
  72DA*   28 22          C      	JR	Z,$+36
  72DC*   FD E5          C      	PUSH	IY
  72DE*   06 00          C      	LD	B,00H
  72E0*   FD 7E 00       C      	LD	A,(IY+0)
  72E3*   FE FF          C      	CP	0FFH
  72E5*   20 02          C      	JR	NZ,$+4
  72E7*   18 05          C      	JR	$+7
  72E9*   FD 23          C      	INC	IY
  72EB*   04             C      	INC	B
  72EC*   18 F2          C      	JR	$-12
  72EE*   FD E1          C      	POP	IY
  72F0*   FD E5          C      	PUSH	IY
  72F2*   FD 7E 01       C      	LD	A,(IY+1)
  72F5*   FD 77 00       C      	LD	(IY+0),A
  72F8*   FD 23          C      	INC	IY
  72FA*   10 F6          C      	DJNZ	$-8
  72FC*   FD E1          C      	POP	IY
  72FE*   C1             C      	POP	BC
  72FF*   05             C      	DEC	B
  7300*   78             C      	LD	A,B
  7301*   FE 00          C      	CP	00H
  7303*   28 03          C      	JR	Z,$+5
  7305*   C3 7074*       C      	JP	KY.DFR
  7308*   C3 70E5*       C      	JP	KY.ATAA
  730B*                  C      KU.ZEIR:
  730B*   D1             C      	POP	DE
  730C*   E1             C      	POP	HL
  730D*   3A 2B00*       C      	LD	A,(UB.ZN)
  7310*   D6 02          C      	SUB	2
  7312*   FE 0D          C      	CP	13
  7314*   30 04          C      	JR	NC,$+6
  7316*   C1             C      	POP	BC
  7317*   C3 7056*       C      	JP	KY.MD
  731A*   32 2B00*       C      	LD	(UB.ZN),A
  731D*   01 0029        C      	LD	BC,41
  7320*   B7             C      	OR	A
  7321*   ED 42          C      	SBC	HL,BC
  7323*   FD 2B          C      	DEC	IY
  7325*   7E             C      	LD	A,(HL)
  7326*   FD BE 00       C      	CP	(IY+0)
  7329*   CC 7338*       C      	CALL	Z,KU.DECIY
  732C*   FD 23          C      	INC	IY
  732E*   01 0017        C      	LD	BC,23
  7331*   B7             C      	OR	A
  7332*   ED 42          C      	SBC	HL,BC
  7334*   C1             C      	POP	BC
  7335*   04             C      	INC	B
  7336*   18 CA          C      	JR	$-52
  7338*                  C      KU.DECIY:
  7338*   FD 2B          C      	DEC	IY
  733A*   C9             C      	RET
  733B*                  C      KU.DD:
  733B*   E5             C      	PUSH	HL
  733C*   21 5EFC*       C      	LD	HL,UA.VORH
  733F*   CD 595C*       C      	CALL	UR.MIMO
  7342*   38 17          C      	JR	C,$+25
  7344*   7E             C      	LD	A,(HL)
  7345*   FE 4A          C      	CP	'J'
  7347*   28 0C          C      	JR	Z,$+14
  7349*   FD 2B          C      	DEC	IY
  734B*   FD 36 00 FF    C      	LD	(IY+0),0FFH
  734F*   11 0050        C      	LD	DE,80
  7352*   B7             C      	OR	A
'Unterprogramme fuer KOPI'	MACRO-80 3.44	09-Dec-81	PAGE	1-82


  7353*   ED 52          C      	SBC	HL,DE
  7355*   36 20          C      	LD	(HL),20H
  7357*   21 2B00*       C      	LD	HL,UB.ZN
  735A*   35             C      	DEC	(HL)
  735B*   E1             C      	POP	HL
  735C*   C9             C      	RET
  735D*   E1             C      	POP	HL
  735E*   D1             C      	POP	DE
  735F*   DD 21 2B03*    C      	LD	IX,UB.KTAB
  7363*   C3 6FEA*       C      	JP	KX.ENDR
                         C      ;	END
                                ;
                         C      	INCLUDE KM.MAC
                         C      	TITLE	'Kmbg'
                         C      	PAGE
'Kmbg'	MACRO-80 3.44	09-Dec-81	PAGE	1-83


                         C      
                         C      ;	PN	KM01
                         C      ;****************************************************************
                         C      ;*                  DEG2000   V.1.2   ---   Programm:   K m b g *
                         C      ;*  Version         --------------------------------------------*
                         C      ;*                  Programmierer: R. Sieber   A d W            *
                         C      ;*  V 1 . 2         --------------------------------------------*
                         C      ;*                  Stand        : 25.Februar 1985              *
                         C      ;****************************************************************
                         C      
  0002                   C      SM.FNL      EQU   02
  0003                   C      SM.FDOWN    EQU   03
  0005                   C      SM.FLEFT    EQU   05
  0006                   C      SM.FPOS1    EQU   06
  0007                   C      SM.FRIGHT   EQU   07
  0008                   C      SM.FLTAB    EQU   08
  0009                   C      SM.FUP      EQU   09
  000A                   C      SM.FRTAB    EQU   10
  000C                   C      SM.FDEL     EQU   12
  001C                   C      SM.FABS     EQU   28
                         C      
  7366*                  C      KM.ANF:
  7366*   7366*          C      	DW	$
  7368*   4B 6D 62 67    C      	DB	'Kmbg'
  736C*   21 755B*       C      	LD	HL,KM.DEL	;Taste:   D E L
  736F*   22 0CF8        C      	LD	(SM.FKTAB+(2*SM.FDEL)),HL
  7372*   21 7519*       C      	LD	HL,KM.ABS	;Taste:   A B S
  7375*   22 0D18        C      	LD	(SM.FKTAB+(2*SM.FABS)),HL
  7378*   21 73C4*       C      	LD	HL,KM.HOME	;Taste:   H O M E
  737B*   22 0CEC        C      	LD	(SM.FKTAB+(2*SM.FPOS1)),HL
  737E*   21 73CE*       C      	LD	HL,KM.SL	;Taste:   SCH_LINKS
  7381*   22 0CF0        C      	LD	(SM.FKTAB+(2*SM.FLTAB)),HL
  7384*   21 73DB*       C      	LD	HL,KM.SR	;Taste:   SCH_RECHTS
  7387*   22 0CF4        C      	LD	(SM.FKTAB+(2*SM.FRTAB)),HL
  738A*   21 73B8*       C      	LD	HL,KM.CO	;Taste:   C_HOCH
  738D*   22 0CF2        C      	LD	(SM.FKTAB+(2*SM.FUP)),HL
  7390*   21 73E0*       C      	LD	HL,KM.CR	;Taste:   C_RECHTS
  7393*   22 0CEE        C      	LD	(SM.FKTAB+(2*SM.FRIGHT)),HL
  7396*   21 73C9*       C      	LD	HL,KM.CU	;Taste:   C_RUNTER
  7399*   22 0CE6        C      	LD	(SM.FKTAB+(2*SM.FDOWN)),HL
  739C*   21 73D6*       C      	LD	HL,KM.CL	;Taste:   C_LINKS
  739F*   22 0CEA        C      	LD	(SM.FKTAB+(2*SM.FLEFT)),HL
  73A2*   21 73E5*       C      	LD	HL,KM.CNZA	;Taste:   C N Z A
  73A5*   22 0CE4        C      	LD	(SM.FKTAB+(2*SM.FNL)),HL
  73A8*   21 7415*       C      	LD	HL,KM.NEWL	;Taste:   E T 1
  73AB*   22 0DAE        C      	LD	(KM.TNEWL),HL
  73AE*   21 743A*       C      	LD	HL,KM.EINA	;alphanum. Tasten
  73B1*   22 0DB0        C      	LD	(KM.TEINA),HL
                         C      
                         C      	; LD	HL,KM.UP13
                         C      	; LD	DE,KM.RAM
                         C      	; LD	BC,KM.UPEND-KM.UP13
                         C      	; LDIR
                         C      
  73B4*   DD 21 2B03*    C      	LD	IX,KM.KMTAB
  73B8*                  C      KM.CO:
  73B8*   DD CB 00 7E    C      	BIT	7,(IX)
  73BC*   C2 7603*       C      	JP	NZ,KM.UP4-KM.UP13+KM.RAM
  73BF*   CD 7569*       C      	CALL	KM.UP2	;KMBG Reservieren EIN
  73C2*   31             C      	DB	31H
  73C3*   C9             C      	RET
                         C      
                         C      	PAGE
'Kmbg'	MACRO-80 3.44	09-Dec-81	PAGE	1-84


                         C      
                         C      ;****************************************************************
                         C      ;*                  Auswertung der Cursor-Tasten                *
                         C      ;****************************************************************
  73C4*                  C      KM.HOME:
  73C4*   CD 7566*       C      	CALL	KM.UP1	;KMBG Kassette zurueckspulen
  73C7*   21             C      	DB	21H
  73C8*   C9             C      	RET
                         C      
  73C9*                  C      KM.CU:
  73C9*   CD 7569*       C      	CALL	KM.UP2	;KMBG Reservieren AUS
  73CC*   41             C      	DB	41H
  73CD*   C9             C      	RET
                         C      
  73CE*                  C      KM.SL:
  73CE*   CD 7569*       C      	CALL	KM.UP2	;KMBG vorh.  Datensatz anzeigen
  73D1*   15             C      	DB	15H
  73D2*   CD 7566*       C      	CALL	KM.UP1
  73D5*   02             C      	DB	2
  73D6*                  C      KM.CL:
  73D6*   CD 7569*       C      	CALL	KM.UP2	;KMBG einen  Datensatz zuruecksetzen
  73D9*   15             C      	DB	15H
  73DA*   C9             C      	RET
                         C      
  73DB*                  C      KM.SR:
  73DB*   CD 7566*       C      	CALL	KM.UP1	;KMBG nachf. Datensatz anzeigen
  73DE*   02             C      	DB	2
  73DF*   C9             C      	RET
                         C      
  73E0*                  C      KM.CR:
  73E0*   CD 7569*       C      	CALL	KM.UP2	;KMBG einen  Datensatz vorsetzen
  73E3*   11             C      	DB	11H
  73E4*   C9             C      	RET
                         C      
  73E5*                  C      KM.CNZA:
  73E5*   DD CB 00 7E    C      	BIT	7,(IX)
  73E9*   C0             C      	RET	NZ
  73EA*   3A 7615*       C      	LD	A,(KM.TX2-KM.UP13+KM.RAM)
  73ED*   FE 6C          C      	CP	'l'
  73EF*   28 08          C      	JR	Z,KM.CNZA1
  73F1*   DD 36 09 00    C      	LD	(IX+9),0
  73F5*   DD 36 0A 01    C      	LD	(IX+10),1
  73F9*                  C      KM.CNZA1:
  73F9*   3E 71          C      	LD	A,71H
  73FB*   DD B6 04       C      	OR	(IX+4)
  73FE*   DD 77 04       C      	LD	(IX+4),A
  7401*   CD 757A*       C      	CALL	KM.UP5
  7404*   DD 7E 04       C      	LD	A,(IX+4)
  7407*   CD 7566*       C      	CALL	KM.UP1
  740A*   02             C      	DB	2
  740B*   CD 7569*       C      	CALL	KM.UP2
  740E*   15             C      	DB	15H
  740F*   DD 77 04       C      	LD	(IX+4),A
  7412*   C3 7603*       C      	JP	KM.UP4-KM.UP13+KM.RAM
                         C      ;****************************************************************
                         C      ;*                  Routine fuer die Taste   E T 1              *
                         C      ;****************************************************************
  7415*                  C      KM.NEWL:
  7415*   DD CB 00 7E    C      	BIT	7,(IX)
  7419*   C0             C      	RET	NZ
  741A*   21 0E66        C      	LD	HL,KM.PUFF
  741D*   22 2BE2*       C      	LD	(KM.KMTAB+0DFH),HL	;2BE0
  7420*   DD 7E 0A       C      	LD	A,(IX+10)
  7423*   3D             C      	DEC	A
  7424*   E6 F0          C      	AND	0F0H
  7426*   07             C      	RLCA
  7427*   07             C      	RLCA
  7428*   07             C      	RLCA
  7429*   07             C      	RLCA
  742A*   3C             C      	INC	A
  742B*   32 2BED*       C      	LD	(KM.KMTAB+0EAH),A	;2BEB
  742E*   CD 2060        C      	CALL	KM.MHOME
  7431*   CD 23BA        C      	CALL	KM.MINSL
  7434*   CD 225C        C      	CALL	ATACO
  7437*   C3 7603*       C      	JP	KM.UP4-KM.UP13+KM.RAM
                         C      
                         C      	PAGE
'Kmbg'	MACRO-80 3.44	09-Dec-81	PAGE	1-85


                         C      
                         C      ;****************************************************************
                         C      ;*                  Auswertung der alphanumerischen Tasten      *
                         C      ;****************************************************************
  743A*                  C      KM.EINA:
  743A*   79             C      	LD	A,C
  743B*   21 0000        C      	LD	HL,0
  743E*   FE 72          C      	CP	'r'
  7440*   20 03          C      	JR	NZ,KM.EINA1
  7442*   21 74A4*       C      	LD	HL,KM.EINAB
  7445*                  C      KM.EINA1:
  7445*   FE 7A          C      	CP	'z'
  7447*   20 03          C      	JR	NZ,KM.EINA2
  7449*   21 74AF*       C      	LD	HL,KM.EINAC
  744C*                  C      KM.EINA2:
  744C*   FE 70          C      	CP	'p'
  744E*   20 03          C      	JR	NZ,KM.EINA3
  7450*   21 0000        C      	LD	HL,0
  7453*                  C      KM.EINA3:
  7453*   FE 63          C      	CP	'c'
  7455*   20 03          C      	JR	NZ,KM.EINA4
  7457*   21 0000        C      	LD	HL,0
  745A*                  C      KM.EINA4:
  745A*   22 0DA8        C      	LD	(KM.TTABU),HL
  745D*   FE 30          C      	CP	'0'
  745F*   38 04          C      	JR	C,KM.EINA5
  7461*   FE 47          C      	CP	'G'
  7463*   38 06          C      	JR	C,KM.EINA7
  7465*                  C      KM.EINA5:
  7465*   32 7615*       C      	LD	(KM.TX2-KM.UP13+KM.RAM),A
  7468*                  C      KM.EINA6:
  7468*   C3 7603*       C      	JP	KM.UP4-KM.UP13+KM.RAM
                         C      
  746B*                  C      KM.EINA7:
  746B*   3A 7615*       C      	LD	A,(KM.TX2-KM.UP13+KM.RAM)
  746E*   FE 67          C      	CP	'g'
  7470*   20 10          C      	JR	NZ,KM.EINA8
  7472*   79             C      	LD	A,C
  7473*   D6 30          C      	SUB	30H
  7475*   D8             C      	RET	C
  7476*   C8             C      	RET	Z
  7477*   FE 03          C      	CP	3
  7479*   D0             C      	RET	NC
  747A*   DD 77 03       C      	LD	(IX+3),A
  747D*   CD 74DA*       C      	CALL	KM.UP20
  7480*   18 E6          C      	JR	KM.EINA6
                         C      
  7482*                  C      KM.EINA8:
  7482*   FE 6C          C      	CP	'l'
  7484*   20 1D          C      	JR	NZ,KM.EINAA
  7486*   79             C      	LD	A,C
  7487*   D6 30          C      	SUB	30H
  7489*   FE 0A          C      	CP	00AH
  748B*   38 02          C      	JR	C,KM.EINA9
  748D*   D6 07          C      	SUB	7
  748F*                  C      KM.EINA9:
  748F*   5F             C      	LD	E,A
  7490*   16 00          C      	LD	D,0
  7492*   62             C      	LD	H,D
  7493*   DD 6E 0A       C      	LD	L,(IX+10)
  7496*   29             C      	ADD	HL,HL
  7497*   29             C      	ADD	HL,HL
  7498*   29             C      	ADD	HL,HL
  7499*   29             C      	ADD	HL,HL
  749A*   19             C      	ADD	HL,DE
  749B*   DD 74 09       C      	LD	(IX+9),H
  749E*   DD 75 0A       C      	LD	(IX+10),L
  74A1*   18 C5          C      	JR	KM.EINA6
                         C      
  74A3*                  C      KM.EINAA:
  74A3*   C9             C      	RET
                         C      
  74A4*                  C      KM.EINAB:
  74A4*   CD 7569*       C      	CALL	KM.UP2
  74A7*   08             C      	DB	8
  74A8*   21 0000        C      	LD	HL,0
  74AB*   22 0DAA        C      	LD	(SM.TABU),HL	;00DA8H
  74AE*   C9             C      	RET
                         C      
  74AF*                  C      KM.EINAC:
  74AF*   DD 36 0D 00    C      	LD	(IX+13),0
  74B3*   DD 36 0E 00    C      	LD	(IX+14),0
'Kmbg'	MACRO-80 3.44	09-Dec-81	PAGE	1-86


  74B7*                  C      KM.EINAD:
  74B7*   CD 7566*       C      	CALL	KM.UP1
  74BA*   02             C      	DB	2
  74BB*   DD 7E 09       C      	LD	A,(IX+9)
  74BE*   DD B6 0A       C      	OR	(IX+10)
  74C1*   28 08          C      	JR	Z,KM.EINAE
  74C3*   DD 34 0D       C      	INC	(IX+13)
  74C6*   CD 74CB*       C      	CALL	KM.EINAE
  74C9*   18 EC          C      	JR	KM.EINAD
                         C      
  74CB*                  C      KM.EINAE:
  74CB*   CD 7603*       C      	CALL	KM.UP4-KM.UP13+KM.RAM
  74CE*   11 35E0        C      	LD	DE,SD.BWSA + 18*80 + 64	;5E0H
  74D1*   CD 759E*       C      	CALL	KM.UP10
  74D4*   62 7A 3A       C      	DB	'bz:'
  74D7*   0D             C      	DB	00DH
  74D8*   A0             C      	DB	20H+80H
  74D9*   C9             C      	RET
                         C      
  74DA*                  C      KM.UP20:
  74DA*   DD 4E 02       C      	LD	C,(IX+2)
  74DD*   0C             C      	INC	C	;???
  74DE*   0C             C      	INC	C
  74DF*   0C             C      	INC	C
  74E0*   0C             C      	INC	C
  74E1*   ED 40          C      	IN	B,(C)
  74E3*   FE 01          C      	CP	1
  74E5*   20 04          C      	JR	NZ,KM.UP21
  74E7*   CB 48          C      	BIT	1,B
  74E9*   20 29          C      	JR	NZ,KM.UP25
  74EB*                  C      KM.UP21:
  74EB*   CB D8          C      	SET	3,B
  74ED*   18 06          C      	JR	KM.UP22
  74EF*   CB 40          C      	BIT	0,B
  74F1*   20 21          C      	JR	NZ,KM.UP25
  74F3*   CB D0          C      	SET	2,B
  74F5*                  C      KM.UP22:
  74F5*   ED 41          C      	OUT	(C),B
  74F7*   0C             C      	INC	C
  74F8*   ED 50          C      	IN	D,(C)
  74FA*   0D             C      	DEC	C
  74FB*   CB 90          C      	RES	2,B
  74FD*   CB 98          C      	RES	3,B
  74FF*   ED 41          C      	OUT	(C),B
  7501*   FE 01          C      	CP	1
  7503*   20 04          C      	JR	NZ,KM.UP23
  7505*   CB 62          C      	BIT	4,D
  7507*   18 02          C      	JR	KM.UP24
                         C      
  7509*                  C      KM.UP23:
  7509*   CB 5A          C      	BIT	3,D
  750B*                  C      KM.UP24:
  750B*   28 07          C      	JR	Z,KM.UP25
  750D*   DD 36 00 00    C      	LD	(IX+0),0
  7511*   C3 73B8*       C      	JP	KM.CO
                         C      
  7514*                  C      KM.UP25:
  7514*   DD CB 00 FE    C      	SET	7,(IX+0)
  7518*   C9             C      	RET
                         C      
                         C      	PAGE
'Kmbg'	MACRO-80 3.44	09-Dec-81	PAGE	1-87


                         C      
  7519*                  C      KM.ABS:
  7519*   21 3000        C      	LD	HL,SD.BWSA
  751C*   06 11          C      	LD	B,17
  751E*                  C      KM.ABS1:
  751E*   C5             C      	PUSH	BC
  751F*   CD 7528*       C      	CALL	KM.UP30
  7522*   C1             C      	POP	BC
  7523*   10 F9          C      	DJNZ	KM.ABS1
  7525*   C3 753B*       C      	JP	KM.UP36
                         C      
  7528*                  C      KM.UP30:
  7528*   CD 7547*       C      	CALL	KM.UP34
  752B*   A0             C      	DB	0A0H
  752C*   28 15          C      	JR	Z,KM.UP33
  752E*   CD 7547*       C      	CALL	KM.UP34
  7531*   50             C      	DB	050H
  7532*   28 0C          C      	JR	Z,KM.UP32
  7534*                  C      KM.UP31:
  7534*   7E             C      	LD	A,(HL)
  7535*   23             C      	INC	HL
  7536*   CD 4040        C      	CALL	PRINT
  7539*   10 F9          C      	DJNZ	KM.UP31
  753B*                  C      KM.UP36:
  753B*   3E 1E          C      	LD	A,1EH
  753D*   C3 4040        C      	JP	PRINT
                         C      
  7540*                  C      KM.UP32:
  7540*   CD 753B*       C      	CALL	KM.UP36
  7543*                  C      KM.UP33:
  7543*   23             C      	INC	HL
  7544*   10 FD          C      	DJNZ	KM.UP33
  7546*   C9             C      	RET
                         C      
  7547*                  C      KM.UP34:
  7547*   E3             C      	EX	(SP),HL
  7548*   46             C      	LD	B,(HL)
  7549*   23             C      	INC	HL
  754A*   E3             C      	EX	(SP),HL
  754B*   E5             C      	PUSH	HL
  754C*   CD 7553*       C      	CALL	KM.UP35
  754F*   E1             C      	POP	HL
  7550*   06 50          C      	LD	B,80
  7552*   C9             C      	RET
                         C      
  7553*                  C      KM.UP35:
  7553*   3E 20          C      	LD	A,' '
  7555*   BE             C      	CP	(HL)
  7556*   23             C      	INC	HL
  7557*   C0             C      	RET	NZ
  7558*   10 F9          C      	DJNZ	KM.UP35
  755A*   C9             C      	RET
                         C      
  755B*                  C      KM.DEL:
  755B*   DD CB 00 BE    C      	RES	7,(IX+0)
  755F*   DD 36 01 00    C      	LD	(IX+1),0
  7563*   C3 7603*       C      	JP	KM.UP4-KM.UP13+KM.RAM
                         C      
                         C      	PAGE
'Kmbg'	MACRO-80 3.44	09-Dec-81	PAGE	1-88


                         C      
                         C      ;****************************************************************
                         C      ;*                  Unterprogramme                              *
                         C      ;****************************************************************
  7566*                  C      KM.UP1:
  7566*   CD 7586*       C      	CALL	KM.LOE1
  7569*                  C      KM.UP2:
  7569*   DD CB 00 7E    C      	BIT	7,(IX)
  756D*   28 02          C      	JR	Z,KM.UP3
  756F*   E1             C      	POP	HL
  7570*   C0             C      	RET	NZ
  7571*                  C      KM.UP3:
  7571*   E3             C      	EX	(SP),HL
  7572*   F5             C      	PUSH	AF
  7573*   7E             C      	LD	A,(HL)
  7574*   23             C      	INC	HL
  7575*   DD 77 04       C      	LD	(IX+4),A
  7578*   F1             C      	POP	AF
  7579*   E3             C      	EX	(SP),HL
  757A*                  C      KM.UP5:
  757A*   CD 5C97*       C      	CALL	KM.KARO
  757D*   21 6815*       C      	LD	HL,FD.DASU	;05C01H
  7580*   22 0D6E        C      	LD	(SM.FKTAB+8EH),HL	;SM.ZSMER , SM.ZSTC
  7583*   C3 7603*       C      	JP	KM.UP4-KM.UP13+KM.RAM
                         C      
  7586*                  C      KM.LOE1:
  7586*   21 0E65        C      	LD	HL,KM.PUFF-1
  7589*   36 00          C      	LD	(HL),0
  758B*   01 0103        C      	LD	BC,103H
  758E*   18 08          C      	JR	KM.LOE3
  7590*                  C      KM.LOE2:
  7590*   21 3000        C      	LD	HL,SD.BWSA
  7593*   01 077F        C      	LD	BC,24*80 -1 ;007FFH  (25*80-1 = 07CFH; 07FFH-07CFH=30H=48)
  7596*   36 20          C      	LD	(HL),' '
  7598*                  C      KM.LOE3:
  7598*   E5             C      	PUSH	HL
  7599*   D1             C      	POP	DE
  759A*   13             C      	INC	DE
  759B*   ED B0          C      	LDIR
  759D*   C9             C      	RET
                         C      
  759E*                  C      KM.UP10:
  759E*   E3             C      	EX	(SP),HL
  759F*                  C      KM.UP11:
  759F*   7E             C      	LD	A,(HL)
  75A0*   E6 7F          C      	AND	07FH
  75A2*   FE 20          C      	CP	' '
  75A4*   38 02          C      	JR	C,KM.UP12
  75A6*   12             C      	LD	(DE),A
  75A7*   13             C      	INC	DE
  75A8*                  C      KM.UP12:
  75A8*   DC 75E7*       C      	CALL	C,KM.UP13-KM.UP13+KM.RAM
  75AB*   CB 7E          C      	BIT	7,(HL)
  75AD*   23             C      	INC	HL
  75AE*   28 EF          C      	JR	Z,KM.UP11
  75B0*   E3             C      	EX	(SP),HL
  75B1*   C9             C      	RET
                         C      
  75B2*                  C      KM.UP41:
  75B2*   11 3000        C      	LD	DE,SD.BWSA
  75B5*   DD 7E 0A       C      	LD	A,(IX+10)
  75B8*   B7             C      	OR	A
  75B9*   20 0C          C      	JR	NZ,KM.UP42
  75BB*   DD CB 09 46    C      	BIT	0,(IX+9)
  75BF*   C8             C      	RET	Z
  75C0*   F5             C      	PUSH	AF
  75C1*   CD 201D        C      	CALL	KM.MANZ
  75C4*   F1             C      	POP	AF
  75C5*   D6 10          C      	SUB	10H
  75C7*                  C      KM.UP42:
  75C7*   F5             C      	PUSH	AF
  75C8*   CD 201D        C      	CALL	KM.MANZ
  75CB*   F1             C      	POP	AF
  75CC*   D6 10          C      	SUB	10H
  75CE*   C8             C      	RET	Z
  75CF*   D8             C      	RET	C
  75D0*   18 F5          C      	JR	KM.UP42
                         C      
  75D2*                  C      KM.UP43:
  75D2*   FE 1E          C      	CP	01EH
  75D4*   C8             C      	RET	Z
  75D5*   FE 0A          C      	CP	00AH
'Kmbg'	MACRO-80 3.44	09-Dec-81	PAGE	1-89


  75D7*   C8             C      	RET	Z
  75D8*   FE 0D          C      	CP	00DH
  75DA*   C8             C      	RET	Z
  75DB*   B7             C      	OR	A
  75DC*   C8             C      	RET	Z
  75DD*   FE 20          C      	CP	' '
  75DF*   38 03          C      	JR	C,KM.UP44
  75E1*   FE 80          C      	CP	080H
  75E3*   D8             C      	RET	C
  75E4*                  C      KM.UP44:
  75E4*   3E 7F          C      	LD	A,07FH
  75E6*   C9             C      	RET
                         C      
                         C      	PAGE
'Kmbg'	MACRO-80 3.44	09-Dec-81	PAGE	1-90


                         C      
                         C      ;	ORG	00300H
                         C      
  75E7*                  C      KM.UP13:
  75E7*   32 75EC*       C      	LD	(KM.UP15-KM.UP13+KM.RAM-1),A	;???
  75EA*   DD 7E 01       C      	LD	A,(IX+1)	;<<<
  75ED*                  C      KM.UP15:
  75ED*   EB             C      	EX	DE,HL
  75EE*   77             C      	LD	(HL),A
  75EF*   3E 33          C      	LD	A,33H
  75F1*   ED 67          C      	RRD
  75F3*   EB             C      	EX	DE,HL
  75F4*   F5             C      	PUSH	AF
  75F5*   1A             C      	LD	A,(DE)
  75F6*   CD 75FA*       C      	CALL	KM.UP14-KM.UP13+KM.RAM
  75F9*   F1             C      	POP	AF
  75FA*                  C      KM.UP14:
  75FA*   FE 3A          C      	CP	03AH
  75FC*   38 02          C      	JR	C,$+4	;---!
  75FE*   C6 07          C      	ADD	A,7	;   !
  7600*   12             C      	LD	(DE),A	;<--!
  7601*   13             C      	INC	DE
  7602*   C9             C      	RET
                         C      
  7603*                  C      KM.UP4:
  7603*   F5             C      	PUSH	AF
  7604*   CD 7590*       C      	CALL	KM.LOE2
  7607*   DD 7E 03       C      	LD	A,(IX+3)
  760A*   C6 30          C      	ADD	A,30H
  760C*   32 7619*       C      	LD	(KM.TX1-KM.UP13+KM.RAM),A
  760F*   11 35A0        C      	LD	DE,SD.BWSA + 18*80 ;5A0H
  7612*   CD 759E*       C      	CALL	KM.UP10
  7615*                  C      KM.TX2:
  7615*   67 20          C      	DB	'g '
  7617*   04             C      	DB	004H
  7618*   28             C      	DB	'('	;<<<
  7619*                  C      KM.TX1:
  7619*   32 29          C      	DB	'2)'	;<<<
  761B*   BA             C      	DB	3AH+80H	;":"
  761C*   11 35AE        C      	LD	DE,SD.BWSA + 18*80 + 14 ;5AEH	;18*80 +20	;5B4H
  761F*   CD 759E*       C      	CALL	KM.UP10
  7622*   6C 3A          C      	DB	'l:'
  7624*   09             C      	DB	9
  7625*   0A             C      	DB	10
  7626*   20 73 3A       C      	DB	' s:'
  7629*   00             C      	DB	0
  762A*   2F             C      	DB	'/'
  762B*   01             C      	DB	1
  762C*   20 20 20 20    C      	DB	'      '
  7630*   20 20          C      
  7632*   AD             C      	DB	2DH+80H	;"-"
  7633*   1B             C      	DEC	DE
  7634*   1B             C      	DEC	DE
  7635*   1B             C      	DEC	DE
  7636*   21 0E65        C      	LD	HL,KM.PUFF-1
  7639*   7E             C      	LD	A,(HL)
  763A*   23             C      	INC	HL
  763B*   CD 75ED*       C      	CALL	KM.UP15-KM.UP13+KM.RAM
  763E*   13             C      	INC	DE
  763F*   DD 46 0A       C      	LD	B,(IX+10)
  7642*   E5             C      	PUSH	HL
  7643*   23             C      	INC	HL
  7644*   10 FD          C      	DJNZ	$-1
  7646*   7E             C      	LD	A,(HL)
  7647*   CD 75ED*       C      	CALL	KM.UP15-KM.UP13+KM.RAM
  764A*   23             C      	INC	HL
  764B*   7E             C      	LD	A,(HL)
  764C*   CD 75ED*       C      	CALL	KM.UP15-KM.UP13+KM.RAM
  764F*   E1             C      	POP	HL
  7650*   E5             C      	PUSH	HL
  7651*   11 3640        C      	LD	DE,SD.BWSA + 20*80	;640H
  7654*   06 00          C      	LD	B,0
  7656*   7E             C      	LD	A,(HL)
  7657*   CD 75D2*       C      	CALL	KM.UP43
  765A*   12             C      	LD	(DE),A
  765B*   23             C      	INC	HL
  765C*   13             C      	INC	DE
  765D*   10 F7          C      	DJNZ	$-7
  765F*   E1             C      	POP	HL
  7660*                  C      KM.UP40:
  7660*   CD 75B2*       C      	CALL	KM.UP41
  7663*   F1             C      	POP	AF
'Kmbg'	MACRO-80 3.44	09-Dec-81	PAGE	1-91


  7664*   C9             C      	RET
                         C      
  7665*                  C      KM.UPEND	EQU	$
                         C      
                         C      ;SM.FKTAB	EQU	00D00H
  0DA8                   C      KM.TTABU  EQU	00DA8H
  0DAE                   C      KM.TNEWL  EQU	00DAEH
  0DB0                   C      KM.TEINA  EQU	00DB0H
  0E66                   C      KM.PUFF   EQU	00E66H
                         C      
  201D                   C      KM.MANZ   EQU	0201DH
  2060                   C      KM.MHOME  EQU	02060H
  23BA                   C      KM.MINSL  EQU	023BAH
                         C      ;ATACO    EQU	024F8H
                         C      
  2B03*                  C      KM.KMTAB  EQU	UB.KTAB
                         C      ;         DEFS  17,0
                         C      ;SD.BWSA  EQU	03000H
                         C      
  5C97*                  C      KM.KARO   EQU	KR.KARO   ;05A93H
                         C      
                         C      ;DRUZ     EQU	07C00H
                         C      
  75E7*                  C      KM.RAM    EQU	KM.UP13   ;0FF80H
                         C      
                         C      			;(C) Rainer Sieber     A d W
                         C      
                         C      
                         C      ;	END
                                ;
                                	TITLE 'Symbolliste S1b'
                                	END
'Symbolliste S1b'	MACRO-80 3.44	09-Dec-81	PAGE	S


Macros:

Symbols:
0030 	AKB             225C 	ATACO           0001 	BC.AGG          
0000 	BC.EGG          FA3A 	BC.END          E000 	BC.TAB1         
F902 	BC.TAB2         F96A 	BC.TAB2A        F9D2 	BC.TAB3         
E002 	BC.VTABA        EC82 	BC.VTABE        58B2*	CP.COMPR        
5915*	CP.INIT         58E5*	CP.KOM          58B7*	CP.NL           
58E5*	CP.OUT          58C5*	CP.OUTT         58EC*	CP.SOKOM        
5902*	CP.SOSTR        58CA*	CP.SPACE        58C1*	CP.STRNG        
5907*	CP.TAB          58D5*	CP.TEXT         5BB7*	CRC0            
5BBB*	CRC1            5BCE*	CRC2            591B*	DC.DCMPR        
5951*	DC.EOSPC        5956*	DC.INIT         591D*	DC.NL           
5941*	DC.SPACE        5937*	DC.TAB          5929*	DC.TEXT         
6AEE*	FD.BMGF         6815*	FD.DASU         694F*	FD.DECBZ        
6A06*	FD.DECHL        6AC9*	FD.DSPBB        6AD9*	FD.DSPBG        
6A7E*	FD.END          6AA7*	FD.FDIN2        6862*	FD.FDINP        
68B5*	FD.FDOUT        68D2*	FD.FDOUT1       68EB*	FD.FDOUT2       
68EF*	FD.FDOUT3       6919*	FD.FDOW1        691D*	FD.FDOW2        
6942*	FD.FDOW3        6934*	FD.FDOW4        6909*	FD.FDOWR        
6959*	FD.FDUP         6A85*	FD.FOLWR        6A0F*	FD.FOUT1        
6A7E*	FD.FOUT2        699B*	FD.FSTRT        680E*	FD.KO01         
67F6*	FD.POSK         6AE3*	FD.RDEND        68A9*	FD.SDIN         
698B*	FD.SDK0         6995*	FD.SDK1         6981*	FD.SDK2         
6903*	FD.SDOUT        6971*	FD.SDOW         69E8*	FD.SETJ         
6A00*	FD.SETN         69D3*	FD.STRT1        6831*	FD.WRRES        
2B01*	K0.HSB          2B02*	K0.LPD          5AB0*	K1.BRKMB        
5BB4*	K1.CRC          5AF6*	K1.KERN         6742*	KH.ANZB1        
674D*	KH.ANZB2        6755*	KH.ANZB3        6757*	KH.ANZB4        
673F*	KH.ANZBL        6777*	KH.AZ1Z         67A8*	KH.AZ4B0        
67C9*	KH.AZ4B1        67B8*	KH.AZ4B3        67A4*	KH.AZ4BY        
679B*	KH.AZADR        675E*	KH.AZBL1        675B*	KH.AZBLD        
67E8*	KH.BILO         67E2*	KH.BLEV1        67E4*	KH.BLEV2        
67CD*	KH.BLEVG        66F1*	KH.BMM          66E9*	KH.BMP          
66C3*	KH.KSRA         667D*	KH.KSRE         66CF*	KH.KSRM         
66D2*	KH.KSRP         6680*	KH.KSRW         6680*	KH.RD1          
676E*	KH.RD2          668A*	KH.RD3          670C*	KH.RDBA         
671D*	KH.RDBM         672E*	KH.RDSL         6672*	KH.RDSTA        
667D*	KH.RES          6706*	KH.SYSRT        6702*	KH.WBM          
66F6*	KH.WREC         6704*	KH.WSL          630E*	KI.KM           
62CF*	KI.KN           6379*	KI.KO03         62F2*	KI.NMR          
6384*	KI.RENA         63A1*	KI.RENA9        6357*	KI.VERZ         
7519*	KM.ABS          751E*	KM.ABS1         7366*	KM.ANF          
73D6*	KM.CL           73E5*	KM.CNZA         73F9*	KM.CNZA1        
73B8*	KM.CO           73E0*	KM.CR           73C9*	KM.CU           
755B*	KM.DEL          743A*	KM.EINA         7445*	KM.EINA1        
744C*	KM.EINA2        7453*	KM.EINA3        745A*	KM.EINA4        
7465*	KM.EINA5        7468*	KM.EINA6        746B*	KM.EINA7        
7482*	KM.EINA8        748F*	KM.EINA9        74A3*	KM.EINAA        
74A4*	KM.EINAB        74AF*	KM.EINAC        74B7*	KM.EINAD        
74CB*	KM.EINAE        73C4*	KM.HOME         5C97*	KM.KARO         
2B03*	KM.KMTAB        7586*	KM.LOE1         7590*	KM.LOE2         
7598*	KM.LOE3         201D 	KM.MANZ         2060 	KM.MHOME        
23BA 	KM.MINSL        7415*	KM.NEWL         0E66 	KM.PUFF         
75E7*	KM.RAM          73CE*	KM.SL           73DB*	KM.SR           
0DB0 	KM.TEINA        0DAE 	KM.TNEWL        0DA8 	KM.TTABU        
7619*	KM.TX1          7615*	KM.TX2          7566*	KM.UP1          
759E*	KM.UP10         759F*	KM.UP11         75A8*	KM.UP12         
75E7*	KM.UP13         75FA*	KM.UP14         75ED*	KM.UP15         
7569*	KM.UP2          74DA*	KM.UP20         74EB*	KM.UP21         
74F5*	KM.UP22         7509*	KM.UP23         750B*	KM.UP24         
7514*	KM.UP25         7571*	KM.UP3          7528*	KM.UP30         
7534*	KM.UP31         7540*	KM.UP32         7543*	KM.UP33         
7547*	KM.UP34         7553*	KM.UP35         753B*	KM.UP36         
7603*	KM.UP4          7660*	KM.UP40         75B2*	KM.UP41         
75C7*	KM.UP42         75D2*	KM.UP43         75E4*	KM.UP44         
757A*	KM.UP5          7665*	KM.UPEND        5DE8*	KO.KO04         
5BAA*	KOMED           5C90*	KR.CKRA         5BE0*	KR.GR1          
5BEA*	KR.GR2          5BEC*	KR.GR3          5C97*	KR.KARO         
5D15*	KR.KCL          5D24*	KR.TYPT         5C9B*	KR.VORSP        
5CC2*	KR.XKA1         5CE6*	KR.YKA1         5CFB*	KR.YKA2         
733B*	KU.DD           7338*	KU.DECIY        72D3*	KU.TAB2L        
72CA*	KU.VVOR         730B*	KU.ZEIR         641A*	KV.ANF          
663D*	KV.ANZ          64EA*	KV.AUSG         6653*	KV.AVZS         
65C5*	KV.BSTR         6628*	KV.DBCVM        65AD*	KV.DRU          
65AB*	KV.DRU1         65BA*	KV.KO02         655F*	KV.KRW          
6593*	KV.P1           6633*	KV.SBC          65F2*	KV.SPTR         
6483*	KV.TABTR        64C9*	KV.ZEIHO        644E*	KV.ZLTR         
6FEA*	KX.ENDR         7009*	KX.EXEC2        6FDF*	KX.RSPFR        
7039*	KX.UPA          72C3*	KY.AJ           70E5*	KY.ATAA         
7108*	KY.ATAB         7119*	KY.ATABE        71AA*	KY.COPY         
7074*	KY.DFR          7257*	KY.EOV          7166*	KY.EVZ          
'Symbolliste S1b'	MACRO-80 3.44	09-Dec-81	PAGE	S-1


7169*	KY.EVZ1         7296*	KY.EWK          70E2*	KY.EZYK1        
72A6*	KY.JHL          720A*	KY.KOP          7224*	KY.KOPAN        
7204*	KY.KOPV         7056*	KY.MD           70DC*	KY.NDA          
714D*	KY.NE           72AF*	KY.SATR         70CE*	KY.SVGL         
71CE*	KY.VSCHR        7181*	KY.VSTR         70C3*	KY.VZVGL        
7127*	KY.WEI          713B*	KY.ZYK          6B36*	LD.DATFU        
6B11*	LD.DATN         6B57*	LD.DATPO        6BD2*	LD.LAD1         
6BC1*	LD.LAD2         6BBE*	LD.LADER        6BE7*	LD.LADF         
6B26*	LD.LD2          6B30*	LD.LD21         6BB9*	LD.LD3          
6B77*	LD.LD4          6B92*	LD.LD5          6BDE*	LD.LDEND        
6BAF*	LD.START        0080 	MAXBL           60EA*	POSIK1          
4040 	PRINT           4070 	PUF.KASS        6BED*	RL.BEG          
6CF9*	RL.BF           6CE5*	RL.DATNV        6CE0*	RL.ECHO         
6CFB*	RL.FMELD        6C7E*	RL.M10          6C8F*	RL.M11          
6C1E*	RL.M12          6C5C*	RL.M13          6C6C*	RL.M14          
6C74*	RL.M15          6C0D*	RL.M16          6C3B*	RL.M17          
6CA2*	RL.M21          6CF5*	RL.MN           6CE9*	RL.OB           
6CED*	RL.RA           6CF1*	RL.SV           6C02*	RL.UG           
6C95*	RL.UP6          5BA2*	RLAD            5B9D*	RRET            
3000 	SD.BWSA         8010 	SD.PFFI         8830 	SD.TPA          
0DC6 	SM.END          001C 	SM.FABS         000C 	SM.FDEL         
0003 	SM.FDOWN        0CE0 	SM.FKTAB        0005 	SM.FLEFT        
0008 	SM.FLTAB        0002 	SM.FNL          0006 	SM.FPOS1        
0007 	SM.FRIGHT       000A 	SM.FRTAB        0009 	SM.FUP          
0E65 	SM.PUFFS        0CE0 	SM.STACK        0DAA 	SM.TABU         
0E5A 	SM.ZEIN         5B99*	STF07           5B8F*	STF99           
5B96*	STFRS           5B4D*	STT02           5B6B*	STT08           
5B27*	STT11           5B27*	STT15           5B27*	STT21           
5B27*	STT31           5B27*	STT41           5B3E*	STT5            
5B33*	STT51           5B37*	STT61           5B3B*	STT71           
5B3B*	STT75           6E09*	SV.BYANZ        6E9A*	SV.DALO1        
6D37*	SV.DATN         6E14*	SV.DATS1        6D4E*	SV.DATV1        
6D56*	SV.DATVO        6E2E*	SV.SAVE         6E3F*	SV.SAVE1        
6D90*	SV.SAVE3        6DA5*	SV.SAVE4        6DED*	SV.SAVE5        
6DE3*	SV.SAVE6        6E92*	SV.STAD0        6D2A*	SV.SV20         
6D42*	SV.SV21         6D5C*	SV.SV30         6D76*	SV.SV31         
6D64*	SV.SV37         6E82*	SV.SVEN1        6E7F*	SV.SVEN2        
6E56*	SV.SVLS         6E72*	SV.SVLS1        6E5C*	SV.SVLS2        
6EA5*	SV.SVSZ         6EB9*	SV.SVSZ1        6EA7*	SV.SVSZ2        
4036 	SY.RESC         4033 	SY.SETCHL       000B 	SY.SYSTB        
4026 	TA.ABFR1        5476*	U1.AUS          55B1*	U1.BILO         
542B*	U1.BREAD        5436*	U1.BWRIT        5411*	U1.CLRB         
5445*	U1.COPB         5441*	U1.COPB2        5496*	U1.DSVG         
546D*	U1.EIN          55AB*	U1.INFO         5420*	U1.KBR4         
55E6*	U1.KRWE         54FB*	U1.KTIN1        54E2*	U1.KTINI        
54C7*	U1.NMVGL        55CF*	U1.PRADR        5408*	U1.RRST         
5400*	U1.RSAVE        55A6*	U1.TR           55C5*	U1.TST          
5518*	U1.VERIN        5520*	U1.VERNI        5542*	U1.VORS1        
553A*	U1.VORST        547F*	U1.VS1          5486*	U1.VSX          
554E*	U1.VZS          542A*	U1.WAIT         607F*	UA.ALTR         
6066*	UA.ANZWD        5F38*	UA.BMGF         5F49*	UA.DF           
5F42*	UA.DOK          5E09*	UA.DS           5EC6*	UA.EABFR        
5F32*	UA.FRZ          5E81*	UA.GER          5E29*	UA.KNAME        
5E4F*	UA.KOMMT        5E90*	UA.KOPFR        603B*	UA.LD           
5E3C*	UA.NR           5F9C*	UA.STADR        5EFC*	UA.VORH         
5E62*	UA.Z7E          601B*	UA.ZKBA         5F76*	UA.ZKBEG        
5FF5*	UA.ZKBEL        6008*	UA.ZKBLG        6025*	UA.ZKBM         
5F50*	UA.ZKDAT        5FAF*	UA.ZKDL         603B*	UA.ZKEE         
5F89*	UA.ZKEND        5FC2*	UA.ZKF          5F63*	UA.ZKLAD        
5FCD*	UA.ZKRES        5FE0*	UA.ZKSDT        602E*	UA.ZKSL         
604D*	UA.ZRSCH        2B6E*	UB.DTAB         2B97*	UB.END          
2B03*	UB.KTAB         2B1E*	UB.KTABE        2B26*	UB.PAR1         
2B28*	UB.PAR2         2B2A*	UB.PAR3         2B2C*	UB.PAR4         
2B2E*	UB.PAR5         2B30*	UB.PATAB        2B34*	UB.SATZ         
2B00*	UB.ZN           57F2*	UC.ASCCO        57CF*	UC.CKONV        
5699*	UC.CVABX        56B4*	UC.CVAX         56C8*	UC.CVAXB        
5792*	UC.CVBC         5722*	UC.CVBD         572D*	UC.CVBD0        
5720*	UC.CVBD1        571C*	UC.CVBD2        5718*	UC.CVBD3        
5714*	UC.CVBD4        5710*	UC.CVBD5        56A3*	UC.CVBX         
57A3*	UC.CVCB         578A*	UC.CVD1B        5761*	UC.CVDB         
56BF*	UC.CVHLX        56EA*	UC.CVX1B        5705*	UC.CVXA         
56D9*	UC.CVXB         56F3*	UC.CVXER        568B*	UC.DIVR         
57C4*	UC.DK1          57D8*	UC.DK2          5852*	UC.DKOI         
57B0*	UC.DKONV        5672*	UC.HL10C        566B*	UC.HL10N        
57BA*	UC.KONV         57EE*	UC.KONV2        5AB0*	UE.BRKMB        
3000 	UE.BWSA         0060 	UE.COTAL        5BB4*	UE.CRC          
0DC6 	UE.EDEND        0132 	UE.KMPUL        8010 	UE.KPUFF        
0E65 	UE.PUF          0CE0 	UE.STANF        007D 	UE.SVL          
000B 	UE.SYSTB        00F7 	UE.TACL         00F9 	UE.TACR         
001E 	UE.TAQUI        00CD 	UE.TASYS        8830 	UE.TEXAN        
0E5A 	UE.ZEIN         5DAB*	UF.AZVB         5DE0*	UF.BEHB         
5DE8*	UF.BEHB1        5D5F*	UF.ERANZ        5D2F*	UF.EXEC         
5D56*	UF.EXEC1        5D53*	UF.EXEC2        5DFD*	UF.FL14         
'Symbolliste S1b'	MACRO-80 3.44	09-Dec-81	PAGE	S-2


5E00*	UF.FL16         5DFA*	UF.FL17         5DEE*	UF.FL18         
5D2A*	UF.RET          5D9B*	UF.SYS          5DA7*	UF.SYS1         
6147*	UK.GETK         6168*	UK.GETK2        6170*	UK.GETK3        
6176*	UK.GETK4        616C*	UK.GETK5        6234*	UK.KBA          
61A7*	UK.KBW          61E5*	UK.KBW1         61E1*	UK.KBW2         
6184*	UK.KLPFB        620F*	UK.KSPFB        61EB*	UK.PUTK         
5A64*	UR.ALPH1        5A5B*	UR.ALPHA        5A6F*	UR.ALPNU        
5996*	UR.BBSA1        598E*	UR.BBSAD        5AA0*	UR.BILR1        
5A8E*	UR.BILRO        6116*	UR.BM           599E*	UR.DSPZK        
5A79*	UR.HEXAZ        5A86*	UR.HEXZ1        60C3*	UR.KBM          
60D5*	UR.KBR          60CF*	UR.KBV          60BD*	UR.KLR          
60B7*	UR.KLV          60B1*	UR.KRA          609F*	UR.KRE          
60A3*	UR.KRE1         60A7*	UR.KRW          60AD*	UR.KRWW         
60C9*	UR.KSL          60EF*	UR.LES          595C*	UR.MIMO         
5978*	UR.MIMO1        5970*	UR.MIMO2        597F*	UR.MIMO3        
5A66*	UR.NUM          6124*	UR.OK           60E4*	UR.POSIK        
59EE*	UR.RET0         60DB*	UR.RPOS         6143*	UR.RSP          
5A88*	UR.TAREP        59F8*	UR.TCL          5A0A*	UR.TCLN         
5A0D*	UR.TCR          5A1E*	UR.TCRN         5A28*	UR.TQUIT        
5A20*	UR.TSYS         59AB*	UR.ZINP         59B1*	UR.ZINP1        
59B4*	UR.ZINP2        59E2*	UR.ZINP3        59E8*	UR.ZINP4        
59D0*	UR.ZINP5        59F1*	UR.ZINP7        5A56*	UR.ZKON1        
5A30*	UR.ZKONT        55ED*	XY.CALP1        55F6*	XY.CALPE        
5641*	XY.INCDX        565A*	XY.JMPDX        5601*	XY.LDDX         
5611*	XY.LIDX         5621*	XY.STDX         5631*	XY.STIDX        



No Fatal error(s)


