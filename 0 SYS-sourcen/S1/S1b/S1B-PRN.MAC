''	MACRO-80 3.44	09-Dec-81	PAGE	1


  000B                          SY.SYSTB  EQU	0000BH
  0D00                          SM.FKTAB  EQU	00D00H
  0DA8                          SM.TABU   EQU   00DA8H
  21EF                          ATACO     EQU	021EFH
  3000                          SD.BWSA   EQU	03000H
  4026                          TA.ABFR1  EQU	04026H
  4033                          SY.SETCHL EQU	04033H
  4036                          SY.RESC   EQU	04036H
  4040                          PRINT     EQU	04040H
  4070                          PUF.KASS  EQU	04070H
                                
                         C      	INCLUDE K0.MAC	;EQUAL - Anweisungen fuer Assembler
                         C      	TITLE 'EQUAL - Anweisungen fuer Assembler'
                         C      	PAGE	87
'EQUAL - Anweisungen fuer Assembler'	MACRO-80 3.44	09-Dec-81	PAGE	1-1


                         C      
                         C      ;         PN    UE01
                         C      ;****************************************************************
                         C      ;*                  EQUAL - Anweisungen fuer Assembler          *
                         C      ;****************************************************************
  00F7                   C      UE.TACL  EQU	0F7H	;Kursor nach links
  00F9                   C      UE.TACR  EQU	0F9H	; ''    nach rechts
  00CD                   C      UE.TASYS EQU	0CDH	;SYS-Taste
  001E                   C      UE.TAQUI EQU	01EH	;ET1
  007D                   C      UE.SVL   EQU	07DH	;Laenge der SAVE-Bloecke
  0060                   C      UE.COTAL EQU	060H	;Laenge ASC/KOI Codetabelle
  0132                   C      UE.KMPUL EQU	132H	;max. Laenge E/A-Puffer
                         C      
  000B                   C      UE.SYSTB EQU	0000BH	;SY.SYSTB
  0CFE                   C      UE.STANF EQU	00CFEH	;STACK
  0DC4                   C      UE.EDEND EQU	00DC4H	;Speicherpl. fuer Adr. Editorende
  0E5A                   C      UE.ZEIN  EQU	00E5AH	;Pufferzaehler Eingabe
  0E66                   C      UE.PUF   EQU	00E66H	;System-Puffer
  3000                   C      UE.BWSA  EQU	03000H	;Bildwiederholspeicher
  8010                   C      UE.KPUFF EQU	08010H	;E/A Puffer
  8830                   C      UE.TEXAN EQU	08830H	;Begin Editorraum
                         C      
  5400'                  C      UE.BRKMB EQU	K1.BRKMB ;04000H	;phys. Kass.Routine
  54F4'                  C      UE.CRC   EQU	K1.CRC	;04740H	;CRC-Berechnung
                         C      
                         C      ;         END
                         C      ;         PN    UB
                         C                ORG   2B00H
  2B00'                  C      UB.ZN:    DS	1,0
  2B01'                  C      UB.KTAB:  DS	27,0
  2B1C'   0000           C      UB.PAR1:  DW	0
  2B1E'   0000           C      UB.PAR2:  DW	0
  2B20'   0000           C      UB.PAR3:  DW	0
  2B22'   0000           C      UB.PAR4:  DW	0
  2B24'   0000           C      UB.PAR5:  DW	0
  2B26'                  C      UB.PATAB: DS	4,0
  2B2A'   00             C      UB.SATZ:  DB	0
  2B2B'   37             C                DB	55
  2B2C'   80             C                DB	80H
  2B2D'   20 20 20 20    C                DB	'                                                       '
  2B31'   20 20 20 20    C      
  2B35'   20 20 20 20    C      
  2B39'   20 20 20 20    C      
  2B3D'   20 20 20 20    C      
  2B41'   20 20 20 20    C      
  2B45'   20 20 20 20    C      
  2B49'   20 20 20 20    C      
  2B4D'   20 20 20 20    C      
  2B51'   20 20 20 20    C      
  2B55'   20 20 20 20    C      
  2B59'   20 20 20 20    C      
  2B5D'   20 20 20 20    C      
  2B61'   20 20 20       C      
  2B64'                  C      UB.DTAB:  DS	41,0
  2B8D'                  C      UB.END    EQU	$
                         C      ;         END
                         C      ;         PN    BC
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;        BEREICHE FUER KASSETTENKOPIEREN
                         C      ;
                         C      ;----------------------------------------------------------------------
  E000                   C      BC.TAB1    EQU	0E000H
  0000                   C      BC.EGG     EQU	0	;EINGABEGERAET
  0001                   C      BC.AGG     EQU	1	;AUSGABEGERAET
  E002                   C      BC.VTABA   EQU	0E002H
  EC82                   C      BC.VTABE   EQU	0E002H+3200
  F902                   C      BC.TAB2    EQU	0E002H+3200+3200
  F96A                   C      BC.TAB2A   EQU	0E002H+3200+3200+104
  F9D2                   C      BC.TAB3    EQU	0E002H+3200+3200+104+104
  FA3A                   C      BC.END     EQU	0E002H+3200+3200+104+104+104
                         C      ;	ORG	0E000H
                         C      ;BC.TAB1:   DS	2
                         C      ;
                         C      ;BC.EGG     EQU	0	;EINGABEGERAET
                         C      ;BC.AGG     EQU	1	;AUSGABEGERAET
                         C      ;----------------------------------------------------------------------
                         C      ;BC.VTABA:  DS	3200
                         C      ;BC.VTABE:  DS	3200
                         C      ;----------------------------------------------------------------------
                         C      ;BC.TAB2:   DS	104
                         C      ;BC.TAB2A:  DS	104
'EQUAL - Anweisungen fuer Assembler'	MACRO-80 3.44	09-Dec-81	PAGE	1-2


                         C      ;BC.TAB3:   DS	104
                         C      ;BC.END     EQU	$
                         C      ;----------------------------------------------------------------------
                         C      ;         END
                                ;	
                                	ORG	05400H
                         C      	INCLUDE K1.MAC	;BAMOS/Emulator  ---  Kassettenmagnetband
                         C      	TITLE 'BAMOS/Emulator  ---  Kassettenmagnetband'
                         C      	PAGE
'BAMOS/Emulator  ---  Kassettenmagnetband'	MACRO-80 3.44	09-Dec-81	PAGE	1-3


                         C      
                         C      ;****************************************************************
                         C      ;*               BAMOS/Emulator  ---  Kassettenmagnetband       *
                         C      ;* OS - Version  -----------------------------------------------*
                         C      ;*               Programmierer: Marcus Herbote                  *
                         C      ;* V 1 . 2       -----------------------------------------------*
                         C      ;*               Stand        : 18.November 2022                *
                         C      ;****************************************************************
                         C      
                         C      ;****************************************************************
                         C      ;*               Geraetebedienroutine fuer Kassettenmagnetband  *
                         C      ;*               Anschluss von zwei Laufwerken K5200            *
                         C      ;*               an einer AKB K5020                             *
                         C      ;*               -----------------------------------------------*
                         C      ;*               E/A-Tabelle                                    *
                         C      ;*               Byte  0   Status                               *
                         C      ;*               Byte  1   Fehlerschluessel                     *
                         C      ;*               Byte  2   Laenge der Daten im Puffer           *
                         C      ;*                         1, 10H, 20H, 80H                     *
                         C      ;*               Byte  3   Basisadresse der AKB                 *
                         C      ;*               Byte  4   Subadresse                           *
                         C      ;*               Byte  5   Kommando                             *
                         C      ;*               Byte  6   HS-Bereich                           *
                         C      ;*               Byte  7   H-Teil Blockadresse                  *
                         C      ;*               Byte  8   L-Teil Blockadresse                  *
                         C      ;*                         n      bei suchen Bandmarke          *
                         C      ;*               -----------------------------------------------*
                         C      ;*               Byte  9 1 0F0H  Startbyte                      *
                         C      ;*               Byte 10 2       Kommando                       *
                         C      ;*               Byte 11 3       Subadresse                     *
                         C      ;*               Byte 12 4       Anzahl BM  bei 71, 75          *
                         C      ;*               Byte 12 4       'B'        bei 51              *
                         C      ;*               Byte 12 4       'S'        bei 61              *
                         C      ;*               Byte 12 4       HS-Bereich bei 02              *
                         C      ;*               Byte 12 4       Laenge     bei 08              *
                         C      ;*               Byte 12 4 0FFH             bei 31,41,21,11,15  *
                         C      ;*               Byte 13 5       H(Puffer)  bei 02              *
                         C      ;*               Byte 13 5       HS-Bereich bei 08              *
                         C      ;*               Byte 13 5 0FFH             bei 51,61,71,75     *
                         C      ;*               Byte 14 6       L(Puffer)  bei 02              *
                         C      ;*               Byte 14 6       H(Puffer)  bei 08              *
                         C      ;*               Byte 15 7       L(Puffer)  bei 08              *
                         C      ;*               Byte 15 7 0FFH             bei 02              *
                         C      ;*               Byte 16 8 0FFH             bei 08              *
                         C      ;****************************************************************
                         C      ;*               Kommandos:                                     *
                         C      ;*                 Hex   Kommando                               *
                         C      ;*                 02    naechsten Record einlesen              *
                         C      ;*                 08    naechsten Record schreiben             *
                         C      ;*                 11    einen Block vorsetzen                  *
                         C      ;*                 15    einen Block ruecksetzen                *
                         C      ;*                 21    umspulen                               *
                         C      ;*                 31    reservieren ein                        *
                         C      ;*                 41    reservieren aus                        *
                         C      ;*                 51    schreiben einer Bandmarke              *
                         C      ;*                 61    schreiben Schlussluecke                *
                         C      ;*                 71    suche n-te Bandmarke vorwaerts         *
                         C      ;*                 75    suche n-te Bandmarke rueckwaerts       *
                         C      ;****************************************************************
                         C      	PAGE
'BAMOS/Emulator  ---  Kassettenmagnetband'	MACRO-80 3.44	09-Dec-81	PAGE	1-4


                         C      
                         C      ;****************************************************************
                         C      ;*               Status                                         *
                         C      ;*               Bit 0     0 Geraet frei                        *
                         C      ;*                         1 Geraet besetzt                     *
                         C      ;*               Bit 1     0                                    *
                         C      ;*                         1 Datentraegerende                   *
                         C      ;*               Bit 2     0 Aufzeichnen erlaubt                *
                         C      ;*                         1 Aufzeichnen verboten               *
                         C      ;*               Bit 3     0 Kassettenseite A                   *
                         C      ;*                         1 Kassettenseite B                   *
                         C      ;*               Bit 4     0 Geraet       bereit                *
                         C      ;*                         1 Geraet nicht bereit                *
                         C      ;*               Bit 5     0 Geraet nicht reserviert            *
                         C      ;*                         1 Geraet       reserviert            *
                         C      ;*               Bit 6     0 Aufzeichnungsverf.  38 CM*S**-1    *
                         C      ;*                         1 Aufzeichnungsverf.  19 CM*S**-1    *
                         C      ;*               Bit 7     0 Kommando fehlerfrei ausgefuehrt    *
                         C      ;*                         1 Fehler (siehe Fehlerschluessel)    *
                         C      ;*               -----------------------------------------------*
                         C      ;*               Fehlerschluessel                               *
                         C      ;*                 Hex   Fehler                                 *
                         C      ;*                 10    falsches Kommando                      *
                         C      ;*                 11    angewaehltes Geraet nicht reserviert   *
                         C      ;*                 12    Subadresse falsch                      *
                         C      ;*                 13    Pufferl. kleiner 12 oder groesser 256  *
                         C      ;*                 14    Ende der Aufzeichnungen auf dieser     *
                         C      ;*                       Kassettenseite (Lesen)                 *
                         C      ;*                 15    angewaehltes Geraet besetzt            *
                         C      ;*                 16    Ende/Anfang der Aufzeichnungen         *
                         C      ;*                       (Bandmarke suchen)                     *
                         C      ;*                 17    gelesener Block laenger 260 Byte       *
                         C      ;*                 18    Bandmarke nicht gefunden               *
                         C      ;*                 19    Aufzeichnen verboten                   *
                         C      ;*                       (mit Kommando: Aufzeichnen)            *
                         C      ;****************************************************************
                         C          PAGE
'BAMOS/Emulator  ---  Kassettenmagnetband'	MACRO-80 3.44	09-Dec-81	PAGE	1-5


                         C      
                         C      ;****************************************************************
                         C      ;*               Hinweise zur Arbeit mit der Geraetebedienr.    *
                         C      ;*                - E/A-Tabelle laden (Basisadresse AKB)        *
                         C      ;*                - Adresse E/A-Tabelle in IX laden             *
                         C      ;*                - laden Schluessel fuer Kommando , Subadresse *
                         C      ;*                    Adresse Eintrittspunkt                    *
                         C      ;*                - Aufruf Geraetebedienroutine immer mit       *
                         C      ;*                    CALL   KR.BRKMB                           *
                         C      ;*                - wird keine Parallelarbeit mit anderen       *
                         C      ;*                  Programmen gewuenscht , kann wie in         *
                         C      ;*                  folgendem Beispiel verfahren werden:        *
                         C      ;*                        ...                                   *
                         C      ;*                        CALL KR.BRKMB ;Aufruf                 *
                         C      ;*                  MARKE:HALT                                  *
                         C      ;*                        JR   MARKE-#                          *
                         C      ;*                  ADREP:............  ;Adresse Eintrittspunkt *
                         C      ;*                        ...                                   *
                         C      ;*                - bei Rueckkehr der Bedienroutine zum Ein-    *
                         C      ;*                  trittspunkt ist die Adresse des folgenden   *
                         C      ;*                  Befehls , bei dem der letzte Interrupt      *
                         C      ;*                  angenommen wurde , noch im SP .             *
                         C      ;*                  Wird , wie im obigen Beispiel , diese       *
                         C      ;*                  Adresse nicht mehr benoetigt , so ist der   *
                         C      ;*                  SP  um 2 zu erhoehen.                       *
                         C      ;****************************************************************
                         C      	TITLE	'Steuerteil Geraetebedienroutine'
                         C          PAGE
'Steuerteil Geraetebedienroutine'	MACRO-80 3.44	09-Dec-81	PAGE	1-6


                         C      
                         C      ;	ORG	05400H
                         C      ;****************************************************************
                         C      ;*               Steuerteil der Geraetebedienroutine            *
                         C      ;****************************************************************
  5400'                  C      K1.BRKMB:
  5400'   F3             C          DI
  5401'   CD 54DD'       C          CALL    RRET
                         C      
                         C      ;****************************************************************
                         C      ;*               Analyse Kommando                               *
                         C      ;****************************************************************
  5404'   DD 7E 05       C          LD  A,(IX+5)
  5407'   FE 02          C          CP  002H    ;naechsten Record einlesen
  5409'   CA 548D'       C          JP  Z,STT02
  540C'   FE 08          C          CP  008H    ;naechsten Record schreiben
  540E'   CA 54AB'       C          JP  Z,STT08
  5411'   FE 11          C          CP  011H    ;einen Block vorsetzen
  5413'   CA 5465'       C          JP  Z,STT11
  5416'   FE 15          C          CP  015H    ;einen Block ruecksetzen
  5418'   CA 5465'       C          JP  Z,STT15
  541B'   FE 21          C          CP  021H    ;umspulen
  541D'   CA 5465'       C          JP  Z,STT21
  5420'   FE 31          C          CP  031H    ;reservieren ein
  5422'   CA 5465'       C          JP  Z,STT31
  5425'   FE 41          C          CP  041H    ;reservieren aus
  5427'   CA 5465'       C          JP  Z,STT41
  542A'   FE 51          C          CP  051H    ;schreiben einer Bandmarke
  542C'   CA 5471'       C          JP  Z,STT51
  542F'   FE 61          C          CP  061H    ;schreiben Schlussluecke
  5431'   CA 5475'       C          JP  Z,STT61
  5434'   FE 71          C          CP  071H    ;suche n-te Bandmarke vorwaerts
  5436'   CA 5479'       C          JP  Z,STT71    
  5439'   FE 75          C          CP  075H    ;suche n-te Bandmarke rueckwaerts
  543B'   CA 5479'       C          JP  Z,STT75
  543E'   C3 54D9'       C          JP  STF07   ;falsches Kommando
                         C      
                         C      ;****************************************************************
                         C      ;*               Kernroutine MB                                 *
                         C      ;****************************************************************
  5441'                  C      K1.KERN:
  5441'   DD 36 09 F0    C          LD  (IX+9),0F0H
  5445'   DD 7E 05       C          LD  A,(IX+5)    ;Kommando
  5448'   DD 77 0A       C          LD  (IX+10),A
  544B'   DD 7E 04       C          LD  A,(IX+4)    ;Subadresse
  544E'   DD 77 0B       C          LD  (IX+11),A
                         C      
  5451'   DD 4E 03       C          LD  C,(IX+3)    ;Basisadresse der AKB
  5454'   DD E5          C          PUSH    IX
  5456'   E1             C          POP HL
  5457'   11 0009        C          LD  DE,9
  545A'   19             C          ADD  HL,DE
  545B'   ED B3          C          OTIR            ;KM - Routine aufrufen
  545D'   DD E5          C          PUSH    IX
  545F'   E1             C          POP HL
  5460'   06 06          C          LD  B,6
  5462'   ED B2          C          INIR            ;Status und Fehler holen
  5464'   C9             C          RET
                         C          TITLE   '4-/5-Byte IO-Kommandos'
                         C          PAGE
'4-/5-Byte IO-Kommandos'	MACRO-80 3.44	09-Dec-81	PAGE	1-7


                         C      
                         C      ;****************************************************************
                         C      ;*               reservieren ein / aus                          *
                         C      ;****************************************************************
  5465'                  C      STT31:
  5465'                  C      STT41:
                         C      ;****************************************************************
                         C      ;*               umspulen                                       *
                         C      ;****************************************************************
  5465'                  C      STT21:
                         C      ;****************************************************************
                         C      ;*               vor-/ruecksetzen um einen Block                *
                         C      ;****************************************************************
  5465'                  C      STT11:
  5465'                  C      STT15:
  5465'   DD 36 0C FF    C          LD  (IX+12),0FFH
                         C      
  5469'   06 04          C          LD  B,4
  546B'   CD 5441'       C          CALL K1.KERN
  546E'   C3 54EA'       C          JP	KOMED	;Kommandoende
                         C      
                         C      ;****************************************************************
                         C      ;*               schreiben einer Bandmarke                      *
                         C      ;****************************************************************
  5471'                  C      STT51:
  5471'   3E 42          C          LD  A,'B'
  5473'   18 09          C          JR  STT5
                         C      ;****************************************************************
                         C      ;*               schreiben einer Schlussluecke                  *
                         C      ;****************************************************************
  5475'                  C      STT61:
  5475'   3E 53          C          LD  A,'S'
  5477'   18 05          C          JR  STT5
                         C      ;****************************************************************
                         C      ;*               suche Bandmarke vorwaerts / rueckwaerts        *
                         C      ;****************************************************************
  5479'                  C      STT71:
  5479'                  C      STT75:
  5479'   DD 7E 08       C          LD  A,(IX+8)
  547C'   18 00          C          JR  STT5
  547E'                  C      STT5:
  547E'   DD 77 0C       C          LD  (IX+12),A
  5481'   DD 36 0D FF    C          LD  (IX+13),0FFH
                         C      
  5485'   06 05          C          LD  B,5
  5487'   CD 5441'       C          CALL K1.KERN
  548A'   C3 54EA'       C          JP	KOMED	;Kommandoende
                         C      
                         C          TITLE   '7-/8-Byte IO-Kommandos'
                         C          PAGE
'7-/8-Byte IO-Kommandos'	MACRO-80 3.44	09-Dec-81	PAGE	1-8


                         C      
                         C      ;****************************************************************
                         C      ;*               Eingabezweig                                   *
                         C      ;****************************************************************
  548D'                  C      STT02:
  548D'   DD 7E 06       C          LD  A,(IX+6)
  5490'   DD 77 0C       C          LD  (IX+12),A
                         C      
  5493'   DD 7E 07       C          LD  A,(IX+7)
  5496'   DD 77 0D       C          LD  (IX+13),A
  5499'   DD 7E 08       C          LD  A,(IX+8)
  549C'   DD 77 0E       C          LD  (IX+14),A
                         C      
  549F'   DD 36 0F FF    C          LD  (IX+15),0FFH
                         C      
  54A3'   06 07          C          LD  B,7
  54A5'   CD 5441'       C          CALL K1.KERN
  54A8'   C3 54EA'       C          JP	KOMED	;Kommandoende
                         C          
                         C      ;****************************************************************
                         C      ;*               Aufzeichnungszweig                             *
                         C      ;****************************************************************
  54AB'                  C      STT08:
  54AB'   DD 7E 02       C          LD  A,(IX+2)
  54AE'   DD 77 0C       C          LD  (IX+12),A
                         C      
  54B1'   DD 7E 06       C          LD  A,(IX+6)
  54B4'   DD 77 0D       C          LD  (IX+13),A
                         C      
  54B7'   DD 7E 07       C          LD  A,(IX+7)
  54BA'   DD 77 0E       C          LD  (IX+14),A
  54BD'   DD 7E 08       C          LD  A,(IX+8)
  54C0'   DD 77 0F       C          LD  (IX+15),A
                         C      
  54C3'   DD 36 10 FF    C          LD  (IX+16),0FFH
                         C      
  54C7'   06 08          C          LD  B,8
  54C9'   CD 5441'       C          CALL K1.KERN
  54CC'   C3 54EA'       C          JP	KOMED	;Kommandoende
                         C      
                         C          PAGE
'7-/8-Byte IO-Kommandos'	MACRO-80 3.44	09-Dec-81	PAGE	1-9


                         C      
                         C      ;****************************************************************
                         C      ;*               Fehler                                         *
                         C      ;****************************************************************
  54CF'                  C      STF99:
  54CF'   DD 75 01       C      	LD	(IX+1),L	;Fehlerschluessel laden
  54D2'   DD CB 00 FE    C      	SET	7,(IX)	;Fehlerbit setzen
  54D6'                  C      STFRS:
  54D6'   C3 54EA'       C      	JP	KOMED	;Kommandoende
                         C      
  54D9'                  C      STF07:
  54D9'   2E 10          C      	LD	L,10H	;falsches Kommando
  54DB'   18 F2          C      	JR	STF99
                         C      
                         C          PAGE
'7-/8-Byte IO-Kommandos'	MACRO-80 3.44	09-Dec-81	PAGE	1-10


                         C      
                         C      ;****************************************************************
                         C      ;*               Register AF , BC , DE , HL retten in SP        *
                         C      ;****************************************************************
  54DD'                  C      RRET:
  54DD'   E3             C          EX  (SP),HL
  54DE'   D5             C      	PUSH	DE
  54DF'   C5             C      	PUSH	BC
  54E0'   F5             C      	PUSH	AF
  54E1'   E9             C          JP  (HL)
                         C      ;****************************************************************
                         C      ;*               Register AF , BC , DE , HL laden aus SP        *
                         C      ;****************************************************************
  54E2'                  C      RLAD:
  54E2'   E3             C          EX  (SP),HL
  54E3'   33             C          INC SP
  54E4'   33             C          INC SP
  54E5'   F1             C      	POP	AF
  54E6'   C1             C      	POP	BC
  54E7'   D1             C      	POP	DE
  54E8'   E3             C          EX  (SP),HL
  54E9'   C9             C      	RET
                         C      
                         C      ;****************************************************************
                         C      ;*               Verzweigung aus Steuerteil zum Eintrittspunkt  *
                         C      ;*               des Steuerprogrammes                           *
                         C      ;****************************************************************
  54EA'                  C      KOMED:
  54EA'   F3             C      	DI
  54EB'   DD CB 00 86    C      	RES 0,(IX)
  54EF'   CD 54E2'       C      	CALL	RLAD
  54F2'   FB             C      	EI
  54F3'   C9             C      	RET
                         C          PAGE
'7-/8-Byte IO-Kommandos'	MACRO-80 3.44	09-Dec-81	PAGE	1-11


                         C      
                         C      ;****************************************************************
                         C      ;*               CRC-Zeichen berechnen                          *
                         C      ;*               <B>  = Blocklaenge , 0 = 256                   *
                         C      ;*               <HL> = Pufferadresse                           *
                         C      ;*               in  DE  nach Aufruf CRC-Zeichen                *
                         C      ;*                <D> = 1.Byte , wird zuerst gesendet           *
                         C      ;*                <E> = 2.Byte , wird danach gesendet           *
                         C      ;****************************************************************
  54F4'                  C      K1.CRC:
  54F4'   11 0000        C      	LD	DE,0
  54F7'                  C      CRC0:
  54F7'   C5             C      	PUSH	BC	;Bytelaenge
  54F8'   06 08          C      	LD	B,8
  54FA'   4E             C      	LD	C,(HL)
  54FB'                  C      CRC1:
  54FB'   79             C      	LD	A,C
  54FC'   AA             C      	XOR	D
  54FD'   0F             C      	RRCA		;Ergebnis Antivalenz Wort-Byte/CRC-Byte,Bit 0
  54FE'   F5             C      	PUSH	AF
  54FF'   CB 1B          C      	RR	E	;Verschiebung von DE um 1 Bit nach rechts
  5501'   CB 1A          C      	RR	D
  5503'   F1             C      	POP	AF	;Rueckretten F
  5504'   30 08          C      	JR	NC,CRC2	;Sprung wenn Antivalenz 0 + 0 = 0
  5506'   7A             C      	LD	A,D	;Korrektur = Umkehr Bit 13/Bit 0
  5507'   EE 01          C      	XOR	1	;Maske fuer D
  5509'   57             C      	LD	D,A	;Korrektur  D
  550A'   7B             C      	LD	A,E
  550B'   EE 20          C      	XOR	20H	;Maske fuer E
  550D'   5F             C      	LD	E,A	;Korrektur  E
  550E'                  C      CRC2:
  550E'   CB 09          C      	RRC	C	;Schieben Datenbyte
  5510'   10 E9          C      	DJNZ	CRC1
  5512'   C1             C      	POP	BC	;Byte abgearbeitet
  5513'   0B             C      	DEC	BC
  5514'   79             C      	LD	A,C
  5515'   B0             C      	OR	B
  5516'   C8             C      	RET	Z
  5517'   23             C      	INC	HL
  5518'   18 DD          C      	JR	CRC0
                         C      
                         C      ;	END
                                ;
                                ;	INCLUDE	KR.MAC	;Kassettengrundroutinen
                                ;	INCLUDE	UF.MAC	;Fehleranzeige und Behandlung
                                ;	INCLUDE	UA.MAC	;Ausschriften
                         C      	INCLUDE K2.MAC	;Grundroutinen
                         C      	TITLE	'Kassettengrundroutinen'
                         C      	PAGE
'Kassettengrundroutinen'	MACRO-80 3.44	09-Dec-81	PAGE	1-12


                         C      
                         C      ;****************************************************************
                         C      ;*               Anschlussroutinen fuer BAMOS/Emulator          *
                         C      ;* OS - Version  -----------------------------------------------*
                         C      ;*               Programmierer: Marcus Herbote                  *
                         C      ;* V 1 . 2       -----------------------------------------------*
                         C      ;*               Stand        : 18.November 2022                *
                         C      ;****************************************************************
                         C      ;	PN	KR
                         C      ;---------------------------------------------------------------------
                         C      ;        Kassettengrundroutinen
                         C      ;---------------------------------------------------------------------
  551A'   551A'          C      	DW	$
  551C'   4B 31 52 45    C      	DB	'K1RE'
  5520'                  C      KR.GR1:
  5520'   3E 01          C      	LD	A,01H
  5522'   18 08          C      	JR	KR.GR3
                         C      ;
  5524'   5524'          C      	DW	$
  5526'   4B 32 52 45    C      	DB	'K2RE'
  552A'                  C      KR.GR2:
  552A'   3E 02          C      	LD	A,02H
  552C'                  C      KR.GR3:
  552C'   CD 6D90'       C      	CALL	U1.KTINI
  552F'   DD 77 04       C      	LD	(IX+4),A
  5532'   CD 6AB1'       C      	CALL	UR.KRE
  5535'   C9             C      	RET
                         C      ;-------------------------------------------------------------------
  5536'   5536'          C      	DW	$
  5538'   4B 31 4C 2B    C      	DB	'K1L+'
  553C'   CD 5520'       C      	CALL	KR.GR1
  553F'   18 09          C      	JR	$+11
                         C      ;
  5541'   5541'          C      	DW	$
  5543'   4B 32 4C 2B    C      	DB	'K2L+'
  5547'   CD 552A'       C      	CALL	KR.GR2
  554A'   21 0001        C      	LD	HL,1	; IX + 8 := 1 / Anzahl BM
  554D'   CD 6EC7'       C      	CALL	XY.STDX
  5550'   08             C      	DB	8
  5551'   CD 6AC9'       C      	CALL	UR.KLV
  5554'   C9             C      	RET
                         C      ;---------------------------------------------------------------------
  5555'   5555'          C      	DW	$
  5557'   4B 31 4C 2D    C      	DB	'K1L-'
  555B'   CD 5520'       C      	CALL	KR.GR1
  555E'   18 09          C      	JR	$+11
                         C      ;
  5560'   5560'          C      	DW	$
  5562'   4B 32 4C 2D    C      	DB	'K2L-'
  5566'   CD 552A'       C      	CALL	KR.GR2
  5569'   21 0001        C      	LD	HL,1	; IX + 8 := 1 / Anzahl BM
  556C'   CD 6EC7'       C      	CALL	XY.STDX
  556F'   08             C      	DB	8
  5570'   CD 6ACF'       C      	CALL	UR.KLR
  5573'   C9             C      	RET
                         C      ;---------------------------------------------------------------------
  5574'   5574'          C      	DW	$
  5576'   4B 31 52 2B    C      	DB	'K1R+'
  557A'   CD 5520'       C      	CALL	KR.GR1
  557D'   18 09          C      	JR	$+11
                         C      ;
  557F'   557F'          C      	DW	$
  5581'   4B 32 52 2B    C      	DB	'K2R+'
  5585'   CD 552A'       C      	CALL	KR.GR2
  5588'   CD 6AE1'       C      	CALL	UR.KBV
  558B'   C9             C      	RET
                         C      ;--------------------------------------------------------------------
  558C'   558C'          C      	DW	$
  558E'   4B 31 52 2D    C      	DB	'K1R-'
  5592'   CD 5520'       C      	CALL	KR.GR1
  5595'   18 09          C      	JR	$+11
                         C      ;
  5597'   5597'          C      	DW	$
  5599'   4B 32 52 2D    C      	DB	'K2R-'
  559D'   CD 552A'       C      	CALL	KR.GR2
  55A0'   CD 6AE7'       C      	CALL	UR.KBR
  55A3'   C9             C      	RET
                         C      ;--------------------------------------------------------------------
  55A4'   55A4'          C      	DW	$
  55A6'   4B 31 52 57    C      	DB	'K1RW'
  55AA'   CD 5520'       C      	CALL	KR.GR1
  55AD'   18 09          C      	JR	$+11
'Kassettengrundroutinen'	MACRO-80 3.44	09-Dec-81	PAGE	1-13


                         C      ;
  55AF'   55AF'          C      	DW	$
  55B1'   4B 32 52 57    C      	DB	'K2RW'
  55B5'   CD 552A'       C      	CALL	KR.GR2
  55B8'   CD 6AB9'       C      	CALL	UR.KRW
  55BB'   18 14          C      	JR	KR.CKRA
                         C      ;---------------------------------------------------------------------
  55BD'   55BD'          C      	DW	$
  55BF'   4B 31 52 41    C      	DB	'K1RA'
  55C3'   CD 5520'       C      	CALL	KR.GR1
  55C6'   18 09          C      	JR	$+11
                         C      ;
  55C8'   55C8'          C      	DW	$
  55CA'   4B 32 52 41    C      	DB	'K2RA'
  55CE'   CD 552A'       C      	CALL	KR.GR2
  55D1'                  C      KR.CKRA:
  55D1'   CD 6AC3'       C      	CALL	UR.KRA
  55D4'   C9             C      	RET
                         C      ;---------------------------------------------------------------------
  55D5'                  C      KR.KARO:
  55D5'   CD 5400'       C      	CALL	UE.BRKMB	;AUFRUF PHYS.KASS.ROUTINE
  55D8'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  55D9'                  C      KR.VORSP:
  55D9'   11 3327        C      	LD	DE,UE.BWSA+327H
  55DC'   CD 7007'       C      	CALL	UC.CVDB
  55DF'   45             C      	LD	B,L
  55E0'   3E 46          C      	LD	A,'F'
  55E2'   32 2B1E'       C      	LD	(UB.PAR2),A
  55E5'   CD 6AB1'       C      	CALL	UR.KRE
  55E8'   CD 6AF6'       C      	CALL	UR.POSIK
  55EB'   C9             C      	RET
                         C      ;---------------------------------------------------------------------
  55EC'   55EC'          C      	DW	$
  55EE'   58 4B 41 31    C      	DB	'XKA1'
  55F2'   CD 5520'       C      	CALL	KR.GR1
  55F5'   18 09          C      	JR	$+11
                         C      ;
  55F7'   55F7'          C      	DW	$
  55F9'   58 4B 41 32    C      	DB	'XKA2'
  55FD'   CD 552A'       C      	CALL	KR.GR2
  5600'   CD 55D9'       C      	CALL	KR.VORSP
  5603'   CD 5FB0'       C      	CALL	FD.FDINP
  5606'   CD 6AB9'       C      	CALL	UR.KRW
  5609'   CD 6AC3'       C      	CALL	UR.KRA
  560C'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  560D'   560D'          C      	DW	$
  560F'   59 4B 41 31    C      	DB	'YKA1'
  5613'   CD 5520'       C      	CALL	KR.GR1
  5616'   18 09          C      	JR	$+11
                         C      ;
  5618'   5618'          C      	DW	$
  561A'   59 4B 41 32    C      	DB	'YKA2'
  561E'   CD 552A'       C      	CALL	KR.GR2
  5621'   CD 6AB1'       C      	CALL	UR.KRE
  5624'   11 3327        C      	LD	DE,UE.BWSA+327H
  5627'   CD 7007'       C      	CALL	UC.CVDB
  562A'   2D             C      	DEC	L
  562B'   28 09          C      	JR	Z,$+11
  562D'   DD 75 0A       C      	LD	(IX+10),L
  5630'   CD 565D'       C      	CALL	KR.TYPT
  5633'   CD 6AC9'       C      	CALL	UR.KLV
  5636'   CD 6003'       C      	CALL	FD.FDOUT
  5639'   C9             C      	RET
                         C      ;---------------------------------------------------------------------------
  563A'   563A'          C      	DW	$
  563C'   4B 31 43 4C    C      	DB	'K1CL'
  5640'   CD 5520'       C      	CALL	KR.GR1
  5643'   18 09          C      	JR	$+11
                         C      ;
  5645'   5645'          C      	DW	$
  5647'   4B 32 43 4C    C      	DB	'K2CL'
  564B'   CD 552A'       C      	CALL	KR.GR2
  564E'   CD 6AD5'       C      	CALL	UR.KBM
  5651'   CD 6ADB'       C      	CALL	UR.KSL
  5654'   CD 6AB9'       C      	CALL	UR.KRW
  5657'   CD 6AC3'       C      	CALL	UR.KRA
  565A'   C3 000B        C      	JP	UE.SYSTB
                         C      ;--------------------------------------------------------------------
  565D'                  C      KR.TYPT:
  565D'   13             C      	INC	DE
  565E'   1A             C      	LD	A,(DE)
'Kassettengrundroutinen'	MACRO-80 3.44	09-Dec-81	PAGE	1-14


  565F'   32 2B1E'       C      	LD	(UB.PAR2),A
  5662'   C9             C      	RET
                         C      ;--------------------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Fehleranzeige und Behandlung'
                         C      	PAGE
'Fehleranzeige und Behandlung'	MACRO-80 3.44	09-Dec-81	PAGE	1-15


                         C      
                         C      ;	PN	UF
                         C      ;***************************************************************
                         C      ;
                         C      ;      Fehleranzeige  UND  BEHANDLUNG
                         C      ;
                         C      ;***************************************************************
  5663'                  C      UF.RET:
  5663'   F1             C      	POP	AF
  5664'   C1             C      	POP	BC
  5665'   D1             C      	POP	DE
  5666'   E1             C      	POP	HL
  5667'   C9             C      	RET
                         C      ;---------------------Ausfhr. Kass.kommando lt.Steuerblock-------------
  5668'                  C      UF.EXEC:
  5668'   E5             C      	PUSH	HL
  5669'   D5             C      	PUSH	DE
  566A'   C5             C      	PUSH	BC
  566B'   F5             C      	PUSH	AF
  566C'   DD CB 00 BE    C      	RES	7,(IX)
  5670'   DD 36 01 00    C      	LD	(IX+1),0
  5674'   DD 36 06 01    C      	LD	(IX+6),1	;HS-Bereich
  5678'   DD 7E 05       C      	LD	A,(IX+5)	;Kommando
  567B'   FE 71          C      	CP	071H
  567D'   28 0C          C      	JR	Z,UF.EXEC2
  567F'   FE 75          C      	CP	075H
  5681'   28 08          C      	JR	Z,UF.EXEC2
  5683'   DD 36 07 0E    C      	LD	(IX+7),HIGH(UE.PUF)
  5687'   DD 36 08 66    C      	LD	(IX+8),LOW(UE.PUF)
  568B'                  C      UF.EXEC2:	
  568B'   CD 55D5'       C      	CALL	KR.KARO
  568E'                  C      UF.EXEC1:
  568E'   DD CB 00 7E    C      	BIT	7,(IX)	;Status
  5692'   28 CF          C      	JR	Z,UF.RET
  5694'   DD 7E 01       C      	LD	A,(IX+1)	;FehlerschlC<ssel
                         C      ;-------------------------Fehlerbehandlung---------------
  5697'                  C      UF.ERANZ:
  5697'   E5             C      	PUSH	HL
  5698'   D5             C      	PUSH	DE
  5699'   C5             C      	PUSH	BC
  569A'   F5             C      	PUSH	AF
  569B'   F5             C      	PUSH	AF
  569C'   3E 13          C      	LD	A,19
  569E'   32 2B00'       C      	LD	(UB.ZN),A
  56A1'   21 58FA'       C      	LD	HL,UA.ZKF	;IN: <A> Fehlerschluessel
  56A4'   CD 6B59'       C      	CALL	UR.MIMO
  56A7'   F1             C      	POP	AF
  56A8'   F5             C      	PUSH	AF
  56A9'   EB             C      	EX	DE,HL
  56AA'   CD 6F4B'       C      	CALL	UC.CVBX+2
  56AD'   F1             C      	POP	AF
  56AE'   FE 17          C      	CP	17H
  56B0'   CA 5732'       C      	JP	Z,UF.FL17
  56B3'   FE 18          C      	CP	18H
  56B5'   CA 5726'       C      	JP	Z,UF.FL18
  56B8'   FE 00          C      	CP	00H
  56BA'   CA 5718'       C      	JP	Z,UF.BEHB
  56BD'   FE 11          C      	CP	11H
  56BF'   CA 5718'       C      	JP	Z,UF.BEHB
  56C2'   FE 19          C      	CP	19H
  56C4'   28 1D          C      	JR	Z,UF.AZVB
  56C6'   FE 14          C      	CP	14H
  56C8'   CA 5735'       C      	JP	Z,UF.FL14
  56CB'   FE 16          C      	CP	16H
  56CD'   CA 5738'       C      	JP	Z,UF.FL16
  56D0'   C3 5663'       C      	JP	UF.RET
                         C      ;----------------------------------------------------------------------
  56D3'                  C      UF.SYS:
  56D3'   DD 7E 01       C      	LD	A,(IX+1)
  56D6'   11 35A8        C      	LD	DE,UE.BWSA+5A8H
  56D9'   CD 6F4B'       C      	CALL	UC.CVBX+2
  56DC'   00             C      	NOP
  56DD'   00             C      	NOP
  56DE'   00             C      	NOP
  56DF'                  C      UF.SYS1:
  56DF'   31 0CFE        C      	LD	SP,UE.STANF
  56E2'   C9             C      	RET
                         C      ;----------------------------------------------------------
  56E3'                  C      UF.AZVB:
  56E3'   DD CB 00 96    C      	RES	2,(IX)	;Aufzeichnen verboten
  56E7'   DD 36 05 41    C      	LD	(IX+5),41H
  56EB'   CD 55D5'       C      	CALL	KR.KARO
'Fehleranzeige und Behandlung'	MACRO-80 3.44	09-Dec-81	PAGE	1-16


  56EE'   DD CB 00 7E    C      	BIT	7,(IX)
  56F2'   20 DF          C      	JR	NZ,UF.SYS
  56F4'   21 586A'       C      	LD	HL,UA.FRZ
  56F7'   CD 6B59'       C      	CALL	UR.MIMO
  56FA'   38 E3          C      	JR	C,UF.SYS1
  56FC'   DD 36 05 31    C      	LD	(IX+5),31H
  5700'   CD 55D5'       C      	CALL	KR.KARO
  5703'   DD CB 00 66    C      	BIT	4,(IX)
  5707'   20 CA          C      	JR	NZ,UF.SYS
  5709'   DD CB 00 7E    C      	BIT	7,(IX)
  570D'   20 C4          C      	JR	NZ,UF.SYS
  570F'   DD CB 00 56    C      	BIT	2,(IX)
  5713'   20 BE          C      	JR	NZ,UF.SYS
  5715'   C3 5720'       C      	JP	UF.BEHB1
                         C      ;----------------------------------------------------------
  5718'                  C      UF.BEHB:
  5718'   21 586A'       C      	LD	HL,UA.FRZ
  571B'   CD 6B59'       C      	CALL	UR.MIMO
  571E'   38 BF          C      	JR	C,UF.SYS1
  5720'                  C      UF.BEHB1:
  5720'   DD 71 05       C      	LD	(IX+5),C	;??? Inhalt von C
  5723'   C3 566C'       C      	JP	UF.EXEC+4
                         C      ;---------------------------------------
  5726'                  C      UF.FL18:
  5726'   21 5870'       C      	LD	HL,UA.BMGF
  5729'   CD 6B59'       C      	CALL	UR.MIMO
  572C'   DA 56DF'       C      	JP	C,UF.SYS1
  572F'   C3 5663'       C      	JP	UF.RET
                         C      ;------------------------------------------
  5732'                  C      UF.FL17:
  5732'   C3 5663'       C      	JP	UF.RET
                         C      ;-------------------------------------
  5735'                  C      UF.FL14:
  5735'   C3 5663'       C      	JP	UF.RET
                         C      
  5738'                  C      UF.FL16:
  5738'   21 586A'       C      	LD	HL,UA.FRZ
  573B'   CD 6B59'       C      	CALL	UR.MIMO
  573E'   C3 5663'       C      	JP	UF.RET
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                         C          PAGE
'Fehleranzeige und Behandlung'	MACRO-80 3.44	09-Dec-81	PAGE	1-17


                         C      
                         C      ;--------------------------------------------------------------------
                         C      	TITLE	'Ausschriften'
                         C      	PAGE
'Ausschriften'	MACRO-80 3.44	09-Dec-81	PAGE	1-18


                         C      
                         C      ;	PN	UA01
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;     AUSSCHRIFTEN
                         C      ;
                         C      ;----------------------------------------------------------------------
  5741'                  C      UA.DS:
  5741'   00             C      	DB	0
  5742'   01             C      	DB	1
  5743'   00             C      	DB	0
  5744'   01             C      	DB	1
  5745'   20 20 44 53    C      	DB	'  DS************   '
  5749'   2A 2A 2A 2A    C      
  574D'   2A 2A 2A 2A    C      
  5751'   2A 2A 2A 2A    C      
  5755'   20 20 20       C      
  5758'   01             C      	DB	1
  5759'   00             C      	DB	0
  575A'   00             C      	DB	0
  575B'   00             C      	DB	0
  575C'   00             C      	DB	0
  575D'   00             C      	DB	0
  575E'   00             C      	DB	0
  575F'   00             C      	DB	0
  5760'   00             C      	DB	0
                         C      ;----------------------------------------------------------------------
  5761'                  C      UA.KNAME:
  5761'   06             C      	DB	06H
  5762'   10             C      	DB	16
  5763'   40             C      	DB	40H
  5764'   20 4B 61 73    C      	DB	' KassettenName: '
  5768'   73 65 74 74    C      
  576C'   65 6E 4E 61    C      
  5770'   6D 65 3A 20    C      
  5774'                  C      UA.NR:
  5774'   03             C      	DB	03H
  5775'   10             C      	DB	16
  5776'   40             C      	DB	40H
  5777'   20 4B 61 73    C      	DB	' Kassetten-Nr.: '
  577B'   73 65 74 74    C      
  577F'   65 6E 2D 4E    C      
  5783'   72 2E 3A 20    C      
  5787'                  C      UA.KOMMT:
  5787'   0B             C      	DB	0BH
  5788'   10             C      	DB	16
  5789'   80             C      	DB	80H
  578A'   20 20 20 20    C      	DB	'     Kommentar: '
  578E'   20 4B 6F 6D    C      
  5792'   6D 65 6E 74    C      
  5796'   61 72 3A 20    C      
                         C      ;----------------------------------------------------------------------
  579A'                  C      UA.Z7E:
  579A'   45 69 6E 67    C      	DB	'Eingabe      =====>     Ausgabe'
  579E'   61 62 65 20    C      
  57A2'   20 20 20 20    C      
  57A6'   20 3D 3D 3D    C      
  57AA'   3D 3D 3E 20    C      
  57AE'   20 20 20 20    C      
  57B2'   41 75 73 67    C      
  57B6'   61 62 65       C      
  57B9'                  C      UA.GER:
  57B9'   20 20 20 20    C      	DB	'       Geraet: '
  57BD'   20 20 20 47    C      
  57C1'   65 72 61 65    C      
  57C5'   74 3A 20       C      
                         C      ;----------------------------------------------------------------------
  57C8'                  C      UA.KOPFR:
  57C8'   01             C      	DB	01H
  57C9'   33             C      	DB	51
  57CA'   80             C      	DB	80H
  57CB'   20 20 20 20    C      	DB	'                Datei               kopieren J/N ? '
  57CF'   20 20 20 20    C      
  57D3'   20 20 20 20    C      
  57D7'   20 20 20 20    C      
  57DB'   44 61 74 65    C      
  57DF'   69 20 20 20    C      
  57E3'   20 20 20 20    C      
  57E7'   20 20 20 20    C      
  57EB'   20 20 20 20    C      
  57EF'   6B 6F 70 69    C      
  57F3'   65 72 65 6E    C      
'Ausschriften'	MACRO-80 3.44	09-Dec-81	PAGE	1-19


  57F7'   20 4A 2F 4E    C      
  57FB'   20 3F 20       C      
  57FE'                  C      UA.EABFR:
  57FE'   01             C      	DB	01H
  57FF'   33             C      	DB	51
  5800'   80             C      	DB	80H
  5801'   20 20 20 20    C      	DB	'                Eingaben in Ordnung  ---->   J/N ? '
  5805'   20 20 20 20    C      
  5809'   20 20 20 20    C      
  580D'   20 20 20 20    C      
  5811'   45 69 6E 67    C      
  5815'   61 62 65 6E    C      
  5819'   20 69 6E 20    C      
  581D'   4F 72 64 6E    C      
  5821'   75 6E 67 20    C      
  5825'   20 2D 2D 2D    C      
  5829'   2D 3E 20 20    C      
  582D'   20 4A 2F 4E    C      
  5831'   20 3F 20       C      
  5834'                  C      UA.VORH:
  5834'   01             C      	DB	1
  5835'   33             C      	DB	51
  5836'   80             C      	DB	80H
  5837'   2A 2A 2A 2A    C      	DB	'************* Datei vorh.;SYS-Ende,kopieren  J/N ? '
  583B'   2A 2A 2A 2A    C      
  583F'   2A 2A 2A 2A    C      
  5843'   2A 20 44 61    C      
  5847'   74 65 69 20    C      
  584B'   76 6F 72 68    C      
  584F'   2E 3B 53 59    C      
  5853'   53 2D 45 6E    C      
  5857'   64 65 2C 6B    C      
  585B'   6F 70 69 65    C      
  585F'   72 65 6E 20    C      
  5863'   20 4A 2F 4E    C      
  5867'   20 3F 20       C      
                         C      ;----------------------------------------------------------------------
  586A'                  C      UA.FRZ:
  586A'   02             C      	DB	2
  586B'   03             C      	DB	3
  586C'   80             C      	DB	80H
  586D'   3F 3F 20       C      	DB	'?? '
  5870'                  C      UA.BMGF:
  5870'   01             C      	DB	01H
  5871'   07             C      	DB	7
  5872'   80             C      	DB	80H
  5873'   42 4D 20 21    C      	DB	'BM ! ??'
  5877'   20 3F 3F       C      
  587A'                  C      UA.DOK:
  587A'   00             C      	DB	0
  587B'   04             C      	DB	4
  587C'   80             C      	DB	80H
  587D'   69 2E 4F 2E    C      	DB	'i.O.'
  5881'                  C      UA.DF:
  5881'   00             C      	DB	0
  5882'   04             C      	DB	4
  5883'   80             C      	DB	80H
  5884'   46 68 6C 2E    C      	DB	'Fhl.'
                         C      ;----------------------------------------------------------------------
  5888'                  C      UA.ZKDAT:
  5888'   06             C      	DB	6
  5889'   10             C      	DB	16
  588A'   40             C      	DB	40H
  588B'   20 20 20 20    C      	DB	'     Dateiname: '
  588F'   20 44 61 74    C      
  5893'   65 69 6E 61    C      
  5897'   6D 65 3A 20    C      
  589B'                  C      UA.ZKLAD:
  589B'   04             C      	DB	4
  589C'   10             C      	DB	16
  589D'   08             C      	DB	08H
  589E'   20 20 20 4C    C      	DB	'   Ladeadresse: '
  58A2'   61 64 65 61    C      
  58A6'   64 72 65 73    C      
  58AA'   73 65 3A 20    C      
                         C      ;------------------------------------------------------------------
  58AE'                  C      UA.ZKBEG:
  58AE'   04             C      	DB	4
  58AF'   10             C      	DB	16
  58B0'   08             C      	DB	08H
  58B1'   20 20 20 20    C      	DB	'        Beginn: '
  58B5'   20 20 20 20    C      
  58B9'   42 65 67 69    C      
'Ausschriften'	MACRO-80 3.44	09-Dec-81	PAGE	1-20


  58BD'   6E 6E 3A 20    C      
  58C1'                  C      UA.ZKEND:
  58C1'   04             C      	DB	4
  58C2'   10             C      	DB	16
  58C3'   08             C      	DB	08H
  58C4'   20 20 20 20    C      	DB	'          Ende: '
  58C8'   20 20 20 20    C      
  58CC'   20 20 45 6E    C      
  58D0'   64 65 3A 20    C      
  58D4'                  C      UA.STADR:
  58D4'   04             C      	DB	4
  58D5'   10             C      	DB	16
  58D6'   08             C      	DB	08H
  58D7'   20 20 53 74    C      	DB	'  Startadresse: '
  58DB'   61 72 74 61    C      
  58DF'   64 72 65 73    C      
  58E3'   73 65 3A 20    C      
  58E7'                  C      UA.ZKDL:
  58E7'   01             C      	DB	1
  58E8'   10             C      	DB	16
  58E9'   20             C      	DB	20H
  58EA'   20 4C 6F 65    C      	DB	' Loeschen J/N : '
  58EE'   73 63 68 65    C      
  58F2'   6E 20 4A 2F    C      
  58F6'   4E 20 3A 20    C      
  58FA'                  C      UA.ZKF:
  58FA'   00             C      	DB	0
  58FB'   08             C      	DB	8
  58FC'   00             C      	DB	0
  58FD'   46 65 68 6C    C      	DB	'Fehler: '
  5901'   65 72 3A 20    C      
                         C      ;----------------------------------------------------------------------
  5905'                  C      UA.ZKRES:
  5905'   03             C      	DB	3
  5906'   10             C      	DB	16
  5907'   10             C      	DB	10H
  5908'   52 65 73 65    C      	DB	'Reservebloecke: '
  590C'   72 76 65 62    C      
  5910'   6C 6F 65 63    C      
  5914'   6B 65 3A 20    C      
  5918'                  C      UA.ZKSDT:
  5918'   04             C      	DB	4
  5919'   12             C      	DB	18
  591A'   40             C      	DB	40H
  591B'   20 20 20 20    C      	DB	'     Dateiname:   '
  591F'   20 44 61 74    C      
  5923'   65 69 6E 61    C      
  5927'   6D 65 3A 20    C      
  592B'   20 20          C      
  592D'                  C      UA.ZKBEL:
  592D'   00             C      	DB	0
  592E'   10             C      	DB	16
  592F'   00             C      	DB	0
  5930'   42 6C 6F 65    C      	DB	'Bloecke belegt: '
  5934'   63 6B 65 20    C      
  5938'   62 65 6C 65    C      
  593C'   67 74 3A 20    C      
  5940'                  C      UA.ZKBLG:
  5940'   00             C      	DB	0
  5941'   10             C      	DB	16
  5942'   00             C      	DB	0
  5943'   42 6C 6F 65    C      	DB	'Bloecke gesamt: '
  5947'   63 6B 65 20    C      
  594B'   67 65 73 61    C      
  594F'   6D 74 3A 20    C      
                         C      ;----------------------------------------------------------------------
  5953'                  C      UA.ZKBA:
  5953'   42 61 6E 64    C      	DB	'Bandanfang'
  5957'   61 6E 66 61    C      
  595B'   6E 67          C      
  595D'                  C      UA.ZKBM:
  595D'   42 61 6E 64    C      	DB	'Bandmarke'
  5961'   6D 61 72 6B    C      
  5965'   65             C      
  5966'                  C      UA.ZKSL:
  5966'   53 63 68 6C    C      	DB	'Schlussluecke'
  596A'   75 73 73 6C    C      
  596E'   75 65 63 6B    C      
  5972'   65             C      
  5973'                  C      UA.ZKEE:	
                         C      ;----------------------------------------------------------------------
  5973'                  C      UA.LD:
  5973'   26             C      	DB	38
'Ausschriften'	MACRO-80 3.44	09-Dec-81	PAGE	1-21


  5974'   0F             C      	DB	15
  5975'   80             C      	DB	80H
  5976'   20 20 20 20    C      	DB	'               '
  597A'   20 20 20 20    C      
  597E'   20 20 20 20    C      
  5982'   20 20 20       C      
  5985'                  C      UA.ZRSCH:
  5985'   01             C      	DB	1
  5986'   16             C      	DB	22
  5987'   80             C      	DB	80H
  5988'   56 65 72 7A    C      	DB	'Verz. schreiben J/N ? '
  598C'   2E 20 73 63    C      
  5990'   68 72 65 69    C      
  5994'   62 65 6E 20    C      
  5998'   4A 2F 4E 20    C      
  599C'   3F 20          C      
  599E'                  C      UA.ANZWD:
  599E'   01             C      	DB	1
  599F'   16             C      	DB	22
  59A0'   80             C      	DB	80H
  59A1'   41 6E 7A 65    C      	DB	'Anzeige wdhln.  J/N ? '
  59A5'   69 67 65 20    C      
  59A9'   77 64 68 6C    C      
  59AD'   6E 2E 20 20    C      
  59B1'   4A 2F 4E 20    C      
  59B5'   3F 20          C      
                         C      ;----------------------------------------------------------------------
  59B7'                  C      UA.ALTR:
  59B7'   20 41 55 53    C      	DB	' AUSGLEICH LAUFWERKSTOLERANZEN  '
  59BB'   47 4C 45 49    C      
  59BF'   43 48 20 4C    C      
  59C3'   41 55 46 57    C      
  59C7'   45 52 4B 53    C      
  59CB'   54 4F 4C 45    C      
  59CF'   52 41 4E 5A    C      
  59D3'   45 4E 20 20    C      
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                                ;
                                ;	INCLUDE	KI.MAC	;Initialisieren von MRES Kassetten
                                ;	INCLUDE	KV.MAC	;Anzeigen und Aendern des MRES-Verzeichnisses
                                ;	INCLUDE	KH.MAC	;Kommandos: KRDx und KWRx
                                ;	INCLUDE	FD.MAC	;Ein-/Ausgabe im freien Format
                                ;	INCLUDE LD.MAC	;Laden von MRES-P-Dateien
                                ;	INCLUDE RL.MAC	;Relativloader fuer O-Dateien
                                ;	INCLUDE SV.MAC	;Retten von Maschinencodeprogrammen als MRES - P-Datei
                         C      	INCLUDE K3.MAC	;MRES Routinen
                         C      	TITLE	'Initialisieren von MRES Kassetten'
                         C      	PAGE
'Initialisieren von MRES Kassetten'	MACRO-80 3.44	09-Dec-81	PAGE	1-22


                         C      
                         C      ;	PN	KI
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;      INITIALISIEREN VON MRES KASSETTEN
                         C      ;
                         C      ;----------------------------------------------------------------------
  59D7'   59D7'          C      	DW	$
  59D9'   49 4E 49 54    C      	DB	'INIT'
  59DD'   21 4070        C      	LD	HL,PUF.KASS	;Puffer fC<r Umbenennung Kassette lC6schen
  59E0'   11 4071        C      	LD	DE,PUF.KASS+1
  59E3'   01 000F        C      	LD	BC,15
  59E6'   36 20          C      	LD	(HL),020H
  59E8'   ED B0          C      	LDIR
  59EA'   3A 3327        C      	LD	A,(UE.BWSA+327H)
  59ED'   CD 6E6B'       C      	CALL	U1.TST
  59F0'   D8             C      	RET	C
  59F1'   F5             C      	PUSH	AF
  59F2'   CD 6D90'       C      	CALL	U1.KTINI
  59F5'   F1             C      	POP	AF
  59F6'   DD 77 04       C      	LD	(IX+4),A	;GERAETEADR. -->TAB
  59F9'   CD 6AB1'       C      	CALL	UR.KRE	;RES. EIN
  59FC'   DD CB 00 56    C      	BIT	2,(IX)
  5A00'   28 05          C      	JR	Z,$+7
  5A02'   3E 19          C      	LD	A,19H
  5A04'   CD 5697'       C      	CALL	UF.ERANZ
  5A07'   CD 6ABF'       C      	CALL	UR.KRWW	;RUECKSPULEN MIT WARTEN
  5A0A'   CD 6AD5'       C      	CALL	UR.KBM	;BM SCHREIBEN
  5A0D'   21 0E66        C      	LD	HL,UE.PUF	;AUFBAU 1.BLOCK
  5A10'   3E 40          C      	LD	A,40H
  5A12'   06 50          C      	LD	B,80
  5A14'   CD 6E4C'       C      	CALL	U1.TR
  5A17'   3E 00          C      	LD	A,00H
  5A19'   06 30          C      	LD	B,48
  5A1B'   CD 6E4C'       C      	CALL	U1.TR
  5A1E'   DD 36 02 80    C      	LD	(IX+2),80H
  5A22'   DD 36 05 08    C      	LD	(IX+5),08H	;CMD SCHREIBEN
  5A26'   CD 5668'       C      	CALL	UF.EXEC
  5A29'   CD 5AD2'       C      	CALL	KI.KO03
  5A2C'                  C      KI.KN:
  5A2C'   CD 6E57'       C      	CALL	U1.BILO
  5A2F'   3E 0D          C      	LD	A,13
  5A31'   32 2B00'       C      	LD	(UB.ZN),A	;ZEILENNR. 15
  5A34'   21 5761'       C      	LD	HL,UA.KNAME	;ABFRAGE KASS.NAME
  5A37'   CD 6B59'       C      	CALL	UR.MIMO
  5A3A'   D8             C      	RET	C
  5A3B'   E5             C      	PUSH	HL
  5A3C'   C5             C      	PUSH	BC
  5A3D'   11 4070        C      	LD	DE,PUF.KASS
  5A40'   01 0006        C      	LD	BC,6
  5A43'   ED B0          C      	LDIR
  5A45'   C1             C      	POP	BC
  5A46'   E1             C      	POP	HL
  5A47'   06 06          C      	LD	B,6
  5A49'   11 0E6A        C      	LD	DE,UE.PUF+4	;NAME IN PUFFER
  5A4C'   CD 7060'       C      	CALL	UC.KONV	;MIT KONVERTIERUNG IN DKOI-CODE
  5A4F'                  C      KI.NMR:
  5A4F'   21 5774'       C      	LD	HL,UA.NR	;ABFR. KASS.NUMMER
  5A52'   CD 6B59'       C      	CALL	UR.MIMO
  5A55'   38 D5          C      	JR	C,KI.KN	;BEI SYS-TASTE ZU VORHERIGER
  5A57'   E5             C      	PUSH	HL
  5A58'   C5             C      	PUSH	BC
  5A59'   11 4076        C      	LD	DE,PUF.KASS+6
  5A5C'   01 0003        C      	LD	BC,3
  5A5F'   ED B0          C      	LDIR
  5A61'   C1             C      	POP	BC
  5A62'   E1             C      	POP	HL
  5A63'   06 03          C      	LD	B,3
  5A65'   11 0E8B        C      	LD	DE,UE.PUF+37
  5A68'   CD 7060'       C      	CALL	UC.KONV
  5A6B'                  C      KI.KM:
  5A6B'   21 5787'       C      	LD	HL,UA.KOMMT	;ABFR. KOMMENTAR
  5A6E'   CD 6B59'       C      	CALL	UR.MIMO
  5A71'   38 B9          C      	JR	C,KI.KN
  5A73'   06 0B          C      	LD	B,11
  5A75'   11 0E8E        C      	LD	DE,UE.PUF+40
  5A78'   CD 7060'       C      	CALL	UC.KONV
  5A7B'   CD 5668'       C      	CALL	UF.EXEC	;3.BLOCK SCHREIBEN
  5A7E'   CD 5ADD'       C      	CALL	KI.RENA	;Kassette umbenennen
  5A81'   CD 6AD5'       C      	CALL	UR.KBM	;BM , 1.LABEL BEENDET
  5A84'   21 59B7'       C      	LD	HL,UA.ALTR
  5A87'   11 0E66        C      	LD	DE,UE.PUF
'Initialisieren von MRES Kassetten'	MACRO-80 3.44	09-Dec-81	PAGE	1-23


  5A8A'   01 0020        C      	LD	BC,20H
  5A8D'   ED B0          C      	LDIR		;AUSGLEICH LFWSTLNZ->PUFFER
  5A8F'   DD 36 02 20    C      	LD	(IX+2),20H	;NEUE BLOCKLAENGE
  5A93'   DD 36 05 08    C      	LD	(IX+5),08H
  5A97'   CD 5668'       C      	CALL	UF.EXEC	;SCHREIBEN
  5A9A'   21 5741'       C      	LD	HL,UA.DS
  5A9D'   11 0E66        C      	LD	DE,UE.PUF
  5AA0'   01 0020        C      	LD	BC,32
  5AA3'   ED B0          C      	LDIR		;DS-SATZ --> PUFFER
  5AA5'   CD 5668'       C      	CALL	UF.EXEC
  5AA8'   3E A5          C      	LD	A,0A5H
  5AAA'   06 20          C      	LD	B,32
  5AAC'   21 0E66        C      	LD	HL,UE.PUF
  5AAF'   CD 6E4C'       C      	CALL	U1.TR
  5AB2'   06 68          C      	LD	B,68H	;103 VERZ.SAETZE
  5AB4'                  C      KI.VERZ:
  5AB4'   C5             C      	PUSH	BC
  5AB5'   CD 5668'       C      	CALL	UF.EXEC
  5AB8'   C1             C      	POP	BC
  5AB9'   10 F9          C      	DJNZ	KI.VERZ
  5ABB'   CD 6AD5'       C      	CALL	UR.KBM
  5ABE'   CD 6D2D'       C      	CALL	U1.VS1	;1.DATEIVORSATZ -->PUFFER
  5AC1'   DD 36 05 08    C      	LD	(IX+5),08H
  5AC5'   CD 5668'       C      	CALL	UF.EXEC
  5AC8'   CD 6ADB'       C      	CALL	UR.KSL	;SCHLUSSLUECKE SCHREIBEN
  5ACB'   CD 6AB9'       C      	CALL	UR.KRW
  5ACE'   CD 6AC3'       C      	CALL	UR.KRA
  5AD1'   C9             C      	RET
                         C      ;
  5AD2'                  C      KI.KO03:
  5AD2'   CD 5668'       C      	CALL	UF.EXEC	;FUER KI14
  5AD5'   06 31          C      	LD	B,49
  5AD7'   2B             C      	DEC	HL
  5AD8'   10 FD          C      	DJNZ	$-1
  5ADA'   36 D9          C      	LD	(HL),0D9H
  5ADC'   C9             C      	RET
                         C      ;
  5ADD'                  C      KI.RENA:	;Kassettendateiname umbenennen
  5ADD'   E5             C      	PUSH	HL
  5ADE'   D5             C      	PUSH	DE
  5ADF'   C5             C      	PUSH	BC
  5AE0'   F5             C      	PUSH	AF
  5AE1'   21 407A        C      	LD	HL,PUF.KASS+10
  5AE4'   36 00          C      	LD	(HL),0	;AbschluC neuer Name
  5AE6'   21 5AFC'       C      	LD	HL,KI.RENA9+2
  5AE9'   DD 7E 04       C      	LD	A,(IX+4)	;SubAdresse
  5AEC'   77             C      	LD	(HL),A
  5AED'   21 5AFA'       C      	LD	HL,KI.RENA9
  5AF0'   01 0730        C      	LD	BC,00730H	;AKB-Adresse + LC$nge Parameterbereich
  5AF3'   ED B3          C      	OTIR
  5AF5'   F1             C      	POP	AF
  5AF6'   C1             C      	POP	BC
  5AF7'   D1             C      	POP	DE
  5AF8'   E1             C      	POP	HL
  5AF9'   C9             C      	RET
  5AFA'                  C      KI.RENA9:
  5AFA'   F0             C      	DB	0F0H
  5AFB'   44             C      	DB	044H	;Kommando
  5AFC'   00             C      	DB	0		;SubAdresse
  5AFD'   01             C      	DB	1		;HSbereich
  5AFE'   40             C      	DB	HIGH(PUF.KASS)
  5AFF'   70             C      	DB	LOW(PUF.KASS)
  5B00'   FF             C      	DB	0FFH
                         C      ;---------------------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Anzeigen und Aendern des MRES-Verzeichnisses'
                         C      	PAGE
'Anzeigen und Aendern des MRES-Verzeichnisses'	MACRO-80 3.44	09-Dec-81	PAGE	1-24


                         C      
                         C      ;	PN	KV
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;    ANZEIGEN UND AENDERN DES VERZEICHNISSES VON MRES KASSETTEN
                         C      ;
                         C      ;----------------------------------------------------------------------
  5B01'   5B01'          C      	DW	$
  5B03'   44 49 52 20    C      	DB	'DIR '
  5B07'   3A 3326        C      	LD	A,(UE.BWSA+326H)
  5B0A'   CD 6E6B'       C      	CALL	U1.TST
  5B0D'   D8             C      	RET	C
  5B0E'   CD 6D90'       C      	CALL	U1.KTINI
  5B11'   DD 77 04       C      	LD	(IX+4),A
  5B14'   CD 6E57'       C      	CALL	U1.BILO
  5B17'   CD 6AB1'       C      	CALL	UR.KRE
  5B1A'   CD 6ABF'       C      	CALL	UR.KRWW
  5B1D'   CD 6D44'       C      	CALL	U1.DSVG
  5B20'   C5             C      	PUSH	BC
                         C      ;----------------------------------------------------------------------
  5B21'   CD 6CCD'       C      	CALL	U1.KBR4	;KASS.NAME,NR.,KOMMENTAR ANZEIGEN
  5B24'   DD 36 05 02    C      	LD	(IX+5),02H
  5B28'   CD 5668'       C      	CALL	UF.EXEC
  5B2B'   21 0E6A        C      	LD	HL,UE.PUF+4
  5B2E'   11 3240        C      	LD	DE,3240H	;=8.ZEILE,16.SPALTE
  5B31'   06 06          C      	LD	B,6
  5B33'   CD 7056'       C      	CALL	UC.DKONV
  5B36'   21 0E8B        C      	LD	HL,UE.PUF+37
  5B39'   13             C      	INC	DE
  5B3A'   13             C      	INC	DE
  5B3B'   06 03          C      	LD	B,3
  5B3D'   CD 7056'       C      	CALL	UC.DKONV
  5B40'   13             C      	INC	DE
  5B41'   13             C      	INC	DE
  5B42'   06 0B          C      	LD	B,11
  5B44'   CD 7056'       C      	CALL	UC.DKONV
  5B47'   21 3290        C      	LD	HL,3290H
  5B4A'   3E 3D          C      	LD	A,'='
  5B4C'   77             C      	LD	(HL),A
  5B4D'   E5             C      	PUSH	HL
  5B4E'   D1             C      	POP	DE
  5B4F'   13             C      	INC	DE
  5B50'   01 0017        C      	LD	BC,23
  5B53'   ED B0          C      	LDIR
                         C      ;----------------------------------------------------------------------
  5B55'   06 03          C      	LD	B,3	;POSITIONIEREN VOR DS-SATZ
  5B57'   CD 5668'       C      	CALL	UF.EXEC
  5B5A'   10 FB          C      	DJNZ	$-3
  5B5C'   CD 6DBE'       C      	CALL	U1.VERIN
  5B5F'   CD 6ABF'       C      	CALL	UR.KRWW
  5B62'   06 07          C      	LD	B,7
  5B64'   CD 6DE8'       C      	CALL	U1.VORS1
  5B67'   C1             C      	POP	BC
  5B68'   05             C      	DEC	B
  5B69'   CD 5D96'       C      	CALL	KV.ANZ
  5B6C'   04             C      	INC	B
  5B6D'   05             C      	DEC	B
  5B6E'   CA 5CB8'       C      	JP	Z,KV.KRW
  5B71'   04             C      	INC	B
  5B72'   C5             C      	PUSH	BC
                         C      ;----------------------------------------------------------------------
  5B73'                  C      KV.ANF:
  5B73'   05             C      	DEC	B
  5B74'   78             C      	LD	A,B
  5B75'   58             C      	LD	E,B
  5B76'   D6 09          C      	SUB	9
  5B78'   38 05          C      	JR	C,$+7
  5B7A'   0E 09          C      	LD	C,9
  5B7C'   41             C      	LD	B,C
  5B7D'   18 03          C      	JR	$+5
  5B7F'   43             C      	LD	B,E
  5B80'   48             C      	LD	C,B
  5B81'   AF             C      	XOR	A
  5B82'   F5             C      	PUSH	AF	;A=RESTL.ANZAHL ODER 0
  5B83'   C5             C      	PUSH	BC
  5B84'   21 2B2A'       C      	LD	HL,UB.SATZ
  5B87'   36 00          C      	LD	(HL),00H
  5B89'   23             C      	INC	HL
  5B8A'   36 37          C      	LD	(HL),55
  5B8C'   23             C      	INC	HL
  5B8D'   36 80          C      	LD	(HL),80H
  5B8F'   23             C      	INC	HL
'Anzeigen und Aendern des MRES-Verzeichnisses'	MACRO-80 3.44	09-Dec-81	PAGE	1-25


  5B90'   06 37          C      	LD	B,55
  5B92'   3E 20          C      	LD	A,20H
  5B94'   CD 6E4C'       C      	CALL	U1.TR	;AUSGABESATZ LOESCHEN
  5B97'   3E 0D          C      	LD	A,13
  5B99'   32 2B00'       C      	LD	(UB.ZN),A
  5B9C'   CD 6E57'       C      	CALL	U1.BILO
  5B9F'   11 2B3C'       C      	LD	DE,UB.SATZ+18
  5BA2'   D5             C      	PUSH	DE
  5BA3'   21 ECA2        C      	LD	HL,BC.VTABE+32	;ADR. VERZ.TABELLE
  5BA6'   E5             C      	PUSH	HL
                         C      ;---------------------------MAX 9 SAETZE ANZEIGEN----------------------
  5BA7'                  C      KV.ZLTR:
  5BA7'   CD 5D1E'       C      	CALL	KV.BSTR	;VTABE-->UB.SATZ
  5BAA'   D1             C      	POP	DE	;VERZ.ADR.
  5BAB'   E1             C      	POP	HL	;ADR.AUSGABESATZ
  5BAC'   E5             C      	PUSH	HL
  5BAD'   D5             C      	PUSH	DE
  5BAE'   01 0012        C      	LD	BC,18
  5BB1'   B7             C      	OR	A
  5BB2'   ED 42          C      	SBC	HL,BC
  5BB4'   CD 6B59'       C      	CALL	UR.MIMO	;ANZEIGE EINE ZEILE
  5BB7'   E1             C      	POP	HL	;VERZ.ADR
  5BB8'   D1             C      	POP	DE
  5BB9'   01 0020        C      	LD	BC,32
  5BBC'   09             C      	ADD	HL,BC
  5BBD'   C1             C      	POP	BC
  5BBE'   05             C      	DEC	B
  5BBF'   28 05          C      	JR	Z,$+7
  5BC1'   C5             C      	PUSH	BC
  5BC2'   D5             C      	PUSH	DE
  5BC3'   E5             C      	PUSH	HL	;NEUE VERZ.TAB ADR
  5BC4'   18 E1          C      	JR	KV.ZLTR
                         C      ;----------------------------------------------------------------------
  5BC6'   41             C      	LD	B,C	;ANZAHL DER ANGEZEIGTEN ZEILEN
  5BC7'   3A 2B00'       C      	LD	A,(UB.ZN)
  5BCA'   90             C      	SUB	B
  5BCB'   32 2B00'       C      	LD	(UB.ZN),A	;KURSOR AUF ANFANG 12.ZEILE
  5BCE'   C5             C      	PUSH	BC
  5BCF'   D5             C      	PUSH	DE
  5BD0'   E5             C      	PUSH	HL
                         C      ;------------------------VERZ. ZEIGER AUF 1.ANGEZEIGTE EINTR.
  5BD1'   C5             C      	PUSH	BC
  5BD2'   01 0020        C      	LD	BC,32
  5BD5'   B7             C      	OR	A
  5BD6'   ED 42          C      	SBC	HL,BC
  5BD8'   C1             C      	POP	BC
  5BD9'   10 F6          C      	DJNZ	$-8
  5BDB'   E5             C      	PUSH	HL
                         C      ;----------------------------------------------------------------------
  5BDC'                  C      KV.TABTR:
  5BDC'   21 5973'       C      	LD	HL,UA.LD
  5BDF'   CD 6B59'       C      	CALL	UR.MIMO	;KURSOR AUF ANF.12.ZEILE
  5BE2'   DA 5C22'       C      	JP	C,KV.ZEIHO
  5BE5'   D1             C      	POP	DE
  5BE6'   D5             C      	PUSH	DE	;ZIELADR.IN VTAB
  5BE7'   CD 5D4B'       C      	CALL	KV.SPTR	;ZEILE WIEDER IN SPEICHER
  5BEA'   E1             C      	POP	HL	;ZIELADR.IN VTAB
  5BEB'   01 0020        C      	LD	BC,32
  5BEE'   09             C      	ADD	HL,BC
  5BEF'   FD E1          C      	POP	IY
  5BF1'   D1             C      	POP	DE
  5BF2'   C1             C      	POP	BC
  5BF3'   05             C      	DEC	B
  5BF4'   28 07          C      	JR	Z,$+9
  5BF6'   C5             C      	PUSH	BC
  5BF7'   D5             C      	PUSH	DE
  5BF8'   FD E5          C      	PUSH	IY
  5BFA'   E5             C      	PUSH	HL
  5BFB'   18 DF          C      	JR	KV.TABTR
                         C      ;--------------------WEITERBLAETTERN ODER AUSGABE----------------------
  5BFD'   F1             C      	POP	AF
  5BFE'   B7             C      	OR	A
  5BFF'   28 42          C      	JR	Z,KV.AUSG	;KEINE WEITEREN ANZEIGEN
  5C01'   D6 09          C      	SUB	9
  5C03'   38 05          C      	JR	C,$+7
  5C05'   06 09          C      	LD	B,9
  5C07'   48             C      	LD	C,B
  5C08'   18 05          C      	JR	$+7
  5C0A'   C6 09          C      	ADD	A,9
  5C0C'   47             C      	LD	B,A
  5C0D'   48             C      	LD	C,B
  5C0E'   AF             C      	XOR	A
  5C0F'   F5             C      	PUSH	AF
'Anzeigen und Aendern des MRES-Verzeichnisses'	MACRO-80 3.44	09-Dec-81	PAGE	1-26


  5C10'   C5             C      	PUSH	BC
  5C11'   D5             C      	PUSH	DE
  5C12'   E5             C      	PUSH	HL
  5C13'   3E 0D          C      	LD	A,13
  5C15'   32 2B00'       C      	LD	(UB.ZN),A
  5C18'   CD 6E57'       C      	CALL	U1.BILO
  5C1B'   E1             C      	POP	HL
  5C1C'   D1             C      	POP	DE
  5C1D'   D5             C      	PUSH	DE
  5C1E'   E5             C      	PUSH	HL
  5C1F'   C3 5BA7'       C      	JP	KV.ZLTR
                         C      ;----------------------------------------------------------------------
  5C22'                  C      KV.ZEIHO:
  5C22'   21 2B00'       C      	LD	HL,UB.ZN
  5C25'   7E             C      	LD	A,(HL)
  5C26'   D6 0F          C      	SUB	15
  5C28'   38 15          C      	JR	C,$+23	;WENN IN 12. ZEILE SYS GEDRUECKT
  5C2A'   35             C      	DEC	(HL)
  5C2B'   35             C      	DEC	(HL)	;ZEILENNR.-2
  5C2C'   E1             C      	POP	HL
  5C2D'   01 0020        C      	LD	BC,32
  5C30'   B7             C      	OR	A
  5C31'   ED 42          C      	SBC	HL,BC	;VERZ.ZEIGER RUECKSETZEN
  5C33'   FD E1          C      	POP	IY
  5C35'   D1             C      	POP	DE
  5C36'   C1             C      	POP	BC
  5C37'   04             C      	INC	B
  5C38'   C5             C      	PUSH	BC
  5C39'   D5             C      	PUSH	DE
  5C3A'   FD E5          C      	PUSH	IY
  5C3C'   E5             C      	PUSH	HL
  5C3D'   18 01          C      	JR	$+3
  5C3F'   35             C      	DEC	(HL)
  5C40'   C3 5BDC'       C      	JP	KV.TABTR
                         C      ;----------------------------------------------------------------------
  5C43'                  C      KV.AUSG:
  5C43'   E5             C      	PUSH	HL
  5C44'   21 5985'       C      	LD	HL,UA.ZRSCH
  5C47'   CD 6B59'       C      	CALL	UR.MIMO
  5C4A'   7E             C      	LD	A,(HL)
  5C4B'   E1             C      	POP	HL
  5C4C'   FE 4A          C      	CP	'J'
  5C4E'   28 11          C      	JR	Z,$+19
  5C50'   21 599E'       C      	LD	HL,UA.ANZWD
  5C53'   CD 6B59'       C      	CALL	UR.MIMO
  5C56'   7E             C      	LD	A,(HL)
  5C57'   FE 4A          C      	CP	'J'
  5C59'   C1             C      	POP	BC
  5C5A'   C2 5CB8'       C      	JP	NZ,KV.KRW
  5C5D'   C5             C      	PUSH	BC
  5C5E'   C3 5B73'       C      	JP	KV.ANF
                         C      ;--------------------------------Dateien am Ende loeschen ? ---------
  5C61'   CD 5D8C'       C      	CALL	KV.SBC
  5C64'   20 34          C      	JR	NZ,$+54
  5C66'   3A EC85        C      	LD	A,(BC.VTABE+3)
  5C69'   3D             C      	DEC	A
  5C6A'   5F             C      	LD	E,A
  5C6B'   16 00          C      	LD	D,0
  5C6D'   3E 01          C      	LD	A,1
  5C6F'   82             C      	ADD	A,D
  5C70'   57             C      	LD	D,A
  5C71'   1D             C      	DEC	E
  5C72'   28 05          C      	JR	Z,$+7
  5C74'   CD 5D8C'       C      	CALL	KV.SBC
  5C77'   28 F4          C      	JR	Z,$-10
  5C79'   C1             C      	POP	BC	;D: Anzahl zu loeschender Dateien
  5C7A'   79             C      	LD	A,C
  5C7B'   92             C      	SUB	D
  5C7C'   32 0E67        C      	LD	(UE.PUF+1),A	;DS-Satz korrigieren
  5C7F'   78             C      	LD	A,B
  5C80'   92             C      	SUB	D
  5C81'   32 0E69        C      	LD	(UE.PUF+3),A
  5C84'   CD 6AE7'       C      	CALL	UR.KBR
  5C87'   CD 6AE7'       C      	CALL	UR.KBR
  5C8A'   CD 6AE1'       C      	CALL	UR.KBV
  5C8D'   DD 36 05 08    C      	LD	(IX+5),08H
  5C91'   CD 5668'       C      	CALL	UF.EXEC	;und schreiben
  5C94'   47             C      	LD	B,A
  5C95'   05             C      	DEC	B
  5C96'   28 20          C      	JR	Z,$+34
  5C98'   04             C      	INC	B
  5C99'   C5             C      	PUSH	BC
                         C      ;-------------------------------------Verzeichnis schreiben -----------
'Anzeigen und Aendern des MRES-Verzeichnisses'	MACRO-80 3.44	09-Dec-81	PAGE	1-27


  5C9A'   C1             C      	POP	BC
  5C9B'   05             C      	DEC	B
  5C9C'   21 ECA2        C      	LD	HL,BC.VTABE+32
  5C9F'   C5             C      	PUSH	BC
  5CA0'   11 0E66        C      	LD	DE,UE.PUF
  5CA3'   01 0020        C      	LD	BC,32
  5CA6'   ED B0          C      	LDIR
  5CA8'   CD 6AE1'       C      	CALL	UR.KBV
  5CAB'   CD 6AE7'       C      	CALL	UR.KBR
  5CAE'   DD 36 05 08    C      	LD	(IX+5),08H	;OHNE RAW
  5CB2'   CD 5668'       C      	CALL	UF.EXEC
  5CB5'   C1             C      	POP	BC
  5CB6'   10 E7          C      	DJNZ	$-23
                         C      ;---------------------------------------------------------------------
  5CB8'                  C      KV.KRW:
  5CB8'   CD 6AB9'       C      	CALL	UR.KRW
  5CBB'   CD 6AC3'       C      	CALL	UR.KRA
  5CBE'   3A 3328        C      	LD	A,(UE.BWSA+328H)
  5CC1'   FE 44          C      	CP	'D'
  5CC3'   C0             C      	RET	NZ
  5CC4'   21 323D        C      	LD	HL,UE.BWSA+23DH
  5CC7'   00             C      	NOP
  5CC8'   CD 5D04'       C      	CALL	KV.DRU1
  5CCB'   21 328D        C      	LD	HL,UE.BWSA+28DH
  5CCE'   CD 5D04'       C      	CALL	KV.DRU1
  5CD1'   CD 4040        C      	CALL	PRINT
  5CD4'   21 2B64'       C      	LD	HL,UB.DTAB
  5CD7'   11 2B65'       C      	LD	DE,UB.DTAB+1
  5CDA'   01 0028        C      	LD	BC,40
  5CDD'   36 20          C      	LD	(HL),20H
  5CDF'   ED B0          C      	LDIR
  5CE1'   3A EC85        C      	LD	A,(BC.VTABE+3)
  5CE4'   47             C      	LD	B,A
  5CE5'   05             C      	DEC	B
  5CE6'   21 EC82        C      	LD	HL,BC.VTABE
  5CE9'   11 0020        C      	LD	DE,32
  5CEC'                  C      KV.P1:
  5CEC'   C5             C      	PUSH	BC
  5CED'   19             C      	ADD	HL,DE
  5CEE'   E5             C      	PUSH	HL
  5CEF'   D5             C      	PUSH	DE
  5CF0'   11 2B64'       C      	LD	DE,UB.DTAB
  5CF3'   CD 5D1E'       C      	CALL	KV.BSTR
  5CF6'   21 2B64'       C      	LD	HL,UB.DTAB
  5CF9'   06 28          C      	LD	B,40
  5CFB'   CD 5D06'       C      	CALL	KV.DRU
  5CFE'   D1             C      	POP	DE
  5CFF'   E1             C      	POP	HL
  5D00'   C1             C      	POP	BC
  5D01'   10 E9          C      	DJNZ	KV.P1
  5D03'   C9             C      	RET
                         C      
  5D04'                  C      KV.DRU1:
  5D04'   06 1E          C      	LD	B,30
  5D06'                  C      KV.DRU:
  5D06'   7E             C      	LD	A,(HL)
  5D07'   23             C      	INC	HL
  5D08'   CD 5D13'       C      	CALL	KV.KO02
  5D0B'   10 F9          C      	DJNZ	KV.DRU
  5D0D'   3E 1E          C      	LD	A,1EH
  5D0F'   CD 4040        C      	CALL	PRINT
  5D12'   C9             C      	RET
                         C      ;
  5D13'                  C      KV.KO02:
  5D13'   CB BF          C      	RES	7,A	;FUER KV17 (DRUCKERAUSGABE)
  5D15'   FE 20          C      	CP	20H
  5D17'   30 02          C      	JR	NC,$+4
  5D19'   3E 2A          C      	LD	A,2AH
  5D1B'   C3 4040        C      	JP	PRINT
                         C      ;---------------------------------------------------------------------
  5D1E'                  C      KV.BSTR:
  5D1E'   01 0006        C      	LD	BC,6	;Aufbereitung des Verz.Satzes
  5D21'   C5             C      	PUSH	BC
  5D22'   ED B0          C      	LDIR		;Transport VTABE--->UB.SATZ
  5D24'   13             C      	INC	DE
  5D25'   13             C      	INC	DE
  5D26'   13             C      	INC	DE
  5D27'   01 0002        C      	LD	BC,2
  5D2A'   ED B0          C      	LDIR
  5D2C'   13             C      	INC	DE
  5D2D'   13             C      	INC	DE
  5D2E'   13             C      	INC	DE
  5D2F'   C1             C      	POP	BC
'Anzeigen und Aendern des MRES-Verzeichnisses'	MACRO-80 3.44	09-Dec-81	PAGE	1-28


  5D30'   C5             C      	PUSH	BC
  5D31'   ED B0          C      	LDIR
  5D33'   13             C      	INC	DE
  5D34'   13             C      	INC	DE
  5D35'   13             C      	INC	DE
  5D36'   C1             C      	POP	BC
  5D37'   ED B0          C      	LDIR
  5D39'   13             C      	INC	DE
  5D3A'   13             C      	INC	DE
  5D3B'   13             C      	INC	DE
  5D3C'   01 0003        C      	LD	BC,3
  5D3F'   ED B0          C      	LDIR
  5D41'   13             C      	INC	DE
  5D42'   13             C      	INC	DE
  5D43'   13             C      	INC	DE
  5D44'   6E             C      	LD	L,(HL)	;Konvertierung Labelnummer
  5D45'   26 00          C      	LD	H,0
  5D47'   CD 6FC2'       C      	CALL	UC.CVBD2
  5D4A'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  5D4B'                  C      KV.SPTR:
  5D4B'   7E             C      	LD	A,(HL)
  5D4C'   FE 09          C      	CP	09H	;Soll Satz geloescht werden?
  5D4E'   20 02          C      	JR	NZ,$+4
  5D50'   AF             C      	XOR	A
  5D51'   77             C      	LD	(HL),A
  5D52'   01 0006        C      	LD	BC,6
  5D55'   C5             C      	PUSH	BC
  5D56'   ED B0          C      	LDIR		;Ruecktransport BWSA--->VTABE
  5D58'   23             C      	INC	HL
  5D59'   23             C      	INC	HL
  5D5A'   23             C      	INC	HL
  5D5B'   01 0002        C      	LD	BC,2
  5D5E'   ED B0          C      	LDIR
  5D60'   23             C      	INC	HL
  5D61'   23             C      	INC	HL
  5D62'   23             C      	INC	HL
  5D63'   C1             C      	POP	BC
  5D64'   C5             C      	PUSH	BC
  5D65'   ED B0          C      	LDIR
  5D67'   23             C      	INC	HL
  5D68'   23             C      	INC	HL
  5D69'   23             C      	INC	HL
  5D6A'   C1             C      	POP	BC
  5D6B'   ED B0          C      	LDIR
  5D6D'   23             C      	INC	HL
  5D6E'   23             C      	INC	HL
  5D6F'   23             C      	INC	HL
  5D70'   01 0003        C      	LD	BC,3
  5D73'   ED B0          C      	LDIR
  5D75'   23             C      	INC	HL
  5D76'   23             C      	INC	HL
  5D77'   23             C      	INC	HL
  5D78'   D5             C      	PUSH	DE
  5D79'   EB             C      	EX	DE,HL
  5D7A'   CD 5D81'       C      	CALL	KV.DBCVM
  5D7D'   7D             C      	LD	A,L
  5D7E'   E1             C      	POP	HL
  5D7F'   77             C      	LD	(HL),A
  5D80'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  5D81'                  C      KV.DBCVM:
  5D81'   06 02          C      	LD	B,2	;FELDLAENGE
  5D83'   CD 7007'       C      	CALL	UC.CVDB	;KONVERTIER. DEZI-->BINAER
  5D86'   D0             C      	RET	NC		;OHNE FEHLER
  5D87'   C0             C      	RET	NZ
  5D88'   13             C      	INC	DE	;1.ZEICHEN WAR KEINE DEZ.ZAHL
  5D89'   10 F8          C      	DJNZ	$-6
  5D8B'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  5D8C'                  C      KV.SBC:
  5D8C'   01 0020        C      	LD	BC,32
  5D8F'   B7             C      	OR	A
  5D90'   ED 42          C      	SBC	HL,BC
  5D92'   7E             C      	LD	A,(HL)
  5D93'   FE 00          C      	CP	00H
  5D95'   C9             C      	RET	
                         C      ;---------------------------------------------------------------------
  5D96'                  C      KV.ANZ:
  5D96'   C5             C      	PUSH	BC
  5D97'   68             C      	LD	L,B
  5D98'   26 00          C      	LD	H,0
  5D9A'   11 3332        C      	LD	DE,3332H
'Anzeigen und Aendern des MRES-Verzeichnisses'	MACRO-80 3.44	09-Dec-81	PAGE	1-29


  5D9D'   CD 6FBE'       C      	CALL	UC.CVBD3
  5DA0'   13             C      	INC	DE
  5DA1'   13             C      	INC	DE
  5DA2'   21 5DAC'       C      	LD	HL,KV.AVZS
  5DA5'   01 0011        C      	LD	BC,17
  5DA8'   ED B0          C      	LDIR
  5DAA'   C1             C      	POP	BC
  5DAB'   C9             C      	RET
                         C      ;-----------------------------------------------------------------------
  5DAC'                  C      KV.AVZS:
  5DAC'   56 65 72 7A    C      	DB	'Verzeichnissaetze'
  5DB0'   65 69 63 68    C      
  5DB4'   6E 69 73 73    C      
  5DB8'   61 65 74 7A    C      
  5DBC'   65             C      
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Kommandos: KRDx und KWRx'
                         C      	PAGE
'Kommandos: KRDx und KWRx'	MACRO-80 3.44	09-Dec-81	PAGE	1-30


                         C      
                         C      ;	PN	KH
                         C      ;**********************************************************************
                         C      ;
                         C      ;   Kommando:
                         C      ;        KRDx...Block einlesen und anzeigen
                         C      ;               zusaetlich werden die entsprechenden Puffer-
                         C      ;               adressen angezeigt.
                         C      ;        KWRx...Block schreiben, standardmaessig nach 'KRDx'
                         C      ;               Ansonsten muessen Blockadresse und Blocklaenge in der
                         C      ;               Verstaendigungstabelle eingetragen werden.
                         C      ;
                         C      ;**********************************************************************
  5DBD'   5DBD'          C      	DW	$
  5DBF'   4B 52 57 31    C      	DB	'KRW1'
  5DC3'   18 06          C      	JR	KH.RDSTA
                         C      ;
  5DC5'   5DC5'          C      	DW	$
  5DC7'   4B 52 57 32    C      	DB	'KRW2'
  5DCB'                  C      KH.RDSTA:
  5DCB'   CD 6D90'       C      	CALL	U1.KTINI	;Initialisierung E/A-Tab.
  5DCE'   3A 3325        C      	LD	A,(UE.BWSA + 10*80 + 5)	;325H i von KRDi
  5DD1'   E6 0F          C      	AND	0FH
  5DD3'   DD 77 04       C      	LD	(IX+4),A	;Subadresse eintragen
  5DD6'                  C      KH.RES:
  5DD6'                  C      KH.KSRE:
  5DD6'   CD 6AB1'       C      	CALL	UR.KRE	;Reservieren
  5DD9'                  C      KH.RD1:
  5DD9'                  C      KH.KSRW:
  5DD9'   DD 36 05 21    C      	LD	(IX+5),021H	;umspulen (rewind)
  5DDD'   CD 5668'       C      	CALL	UF.EXEC
  5DE0'   18 78          C      	JR		KH.RDBA
                         C      ;
                         C      ;	Z Y K L U S  C<ber Tastatureingaben
  5DE2'                  C      KH.RD3:	;Zyklus
  5DE2'   DD 36 08 00    C      	LD	(IX+8),0	;Anzahl Bandmarken
  5DE6'   CD 6C85'       C      	CALL	UR.TAREP	;Tastaturabfrage
  5DE9'   FE 80          C      	CP	080H
  5DEB'   28 E9          C      	JR	Z,KH.KSRE	;---> P 01	Reservieren EIN
  5DED'   FE 82          C      	CP	082H
  5DEF'   28 2A          C      	JR	Z,KH.KSRA	;---> P 03	Reservieren AUS
  5DF1'   FE 81          C      	CP	081H
  5DF3'   28 E4          C      	JR	Z,KH.KSRW	;---> P 02	Rewind
                         C      
  5DF5'   FE 83          C      	CP	083H
  5DF7'   28 31          C      	JR	Z,KH.KSRP	;---> P 04	        read; display
  5DF9'   FE 85          C      	CP	085H
  5DFB'   28 2A          C      	JR	Z,KH.KSRM	;---> P 06	R-; R-; read; display
                         C      
  5DFD'   DD 36 08 01    C      	LD	(IX+8),1	;Anzahl Bandmarken
  5E01'   FE 86          C      	CP	086H
  5E03'   28 3C          C      	JR	Z,KH.BMP	;---> P07	BM+
  5E05'   FE 88          C      	CP	088H
  5E07'   28 40          C      	JR	Z,KH.BMM	;---> P09	BM-
                         C      
  5E09'   FE 89          C      	CP	089H
  5E0B'   28 41          C      	JR	Z,KH.WREC	;---> P10	write Record
  5E0D'   FE 8A          C      	CP	08AH
  5E0F'   28 3F          C      	JR	Z,KH.WBM	;---> P11	write BM
  5E11'   FE 8B          C      	CP	08BH
  5E13'   28 3D          C      	JR	Z,KH.WSL	;---> P11	write SL
                         C      
  5E15'   FE CD          C      	CP	0CDH
  5E17'   28 3B          C      	JR	Z,KH.SYSRT	;---> SYS
                         C      
  5E19'   18 C7          C      	JR	KH.RD3
                         C      
                         C      ;	P 03	Reservieren AUS
  5E1B'                  C      KH.KSRA:
  5E1B'   DD 36 05 21    C      	LD	(IX+5),021H	;umspulen (rewind)
  5E1F'   CD 5668'       C      	CALL	UF.EXEC
  5E22'   CD 6AC3'       C      	CALL	UR.KRA
  5E25'   18 33          C      	JR		KH.RDBA
                         C      
                         C      ;	P 06	R-; R-; read; display
  5E27'                  C      KH.KSRM:
  5E27'   CD 5EBC'       C      	CALL	KH.RD2
                         C      ;	P 04	        read; display
  5E2A'                  C      KH.KSRP:
  5E2A'   DD 36 05 02    C       	LD	(IX+5),002H	;naechst Record lesen
  5E2E'   CD 5668'       C      	CALL	UF.EXEC
  5E31'   DD 7E 02       C      	LD	A,(IX+2)	;Lade die Laenge des Blockes
'Kommandos: KRDx und KWRx'	MACRO-80 3.44	09-Dec-81	PAGE	1-31


  5E34'   FE 01          C      	CP	1	;Laenge = 1, dann BandMarke
  5E36'   28 33          C      	JR	Z,KH.RDBM
  5E38'   FE 02          C      	CP	2	;Laenge = 2, dann Schlussluecke
  5E3A'   28 40          C      	JR	Z,KH.RDSL
  5E3C'   CD 5E8D'       C      	CALL	KH.ANZBL	;Block anzeigen
  5E3F'   18 A1          C      	JR	KH.RD3
                         C      
                         C      ;	P 07	BM+
  5E41'                  C      KH.BMP:
  5E41'   CD 6AC9'       C      	CALL	UR.KLV	;Bandmarke vorsetzen
  5E44'   CD 6AE7'       C      	CALL	UR.KBR	;Record    zuruecksetzen
  5E47'   18 E1          C      	JR	KH.KSRP
                         C      ;	P 09	BM-
  5E49'                  C      KH.BMM:
  5E49'   CD 6ACF'       C      	CALL	UR.KLR	;Bandmarke zurC<cksetzen
  5E4C'   18 DC          C      	JR	KH.KSRP
                         C      
                         C      ;	P 10	write Record
  5E4E'                  C      KH.WREC:
                         C      	; LD	(IX+5),08H
                         C      	; CALL	UF.EXEC
                         C      	; CALL	UR.KBR
  5E4E'   18 92          C      	JR	KH.RD3
                         C      
                         C      ;	P 11	write BM
  5E50'                  C      KH.WBM:
  5E50'   18 90          C      	JR	KH.RD3
                         C      
                         C      ;	P 12	write SL
  5E52'                  C      KH.WSL:
  5E52'   18 8E          C      	JR	KH.RD3
                         C      
                         C      ;	SYS		Systemruecksprung
  5E54'                  C      KH.SYSRT:
  5E54'   CD 5F36'       C      	CALL	KH.BILO
  5E57'   C3 000B        C      	JP	SY.SYSTB
                         C      
  5E5A'                  C      KH.RDBA:
  5E5A'   CD 5F36'       C      	CALL	KH.BILO
  5E5D'   21 5953'       C      	LD	HL,UA.ZKBA	;"Bandanfang"
  5E60'   11 3000        C      	LD	DE,UE.BWSA
  5E63'   01 000A        C      	LD	BC,UA.ZKBM-UA.ZKBA
  5E66'   ED B0          C      	LDIR
  5E68'   C3 5DE2'       C      	JP	KH.RD3
                         C      
  5E6B'                  C      KH.RDBM:
  5E6B'   CD 5F36'       C      	CALL	KH.BILO
  5E6E'   21 595D'       C      	LD	HL,UA.ZKBM	;"Bandmarke"
  5E71'   11 3000        C      	LD	DE,UE.BWSA
  5E74'   01 0009        C      	LD	BC,UA.ZKSL-UA.ZKBM
  5E77'   ED B0          C      	LDIR
  5E79'   C3 5DE2'       C      	JP	KH.RD3
                         C      
  5E7C'                  C      KH.RDSL:
  5E7C'   CD 5F36'       C      	CALL	KH.BILO
  5E7F'   21 5966'       C      	LD	HL,UA.ZKSL	;"Schlussluecke"
  5E82'   11 3000        C      	LD	DE,UE.BWSA
  5E85'   01 000D        C      	LD	BC,UA.ZKEE-UA.ZKSL
  5E88'   ED B0          C      	LDIR
  5E8A'   C3 5DE2'       C      	JP	KH.RD3
                         C      
  5E8D'                  C      KH.ANZBL:
  5E8D'   CD 5F36'       C      	CALL	KH.BILO
  5E90'                  C      KH.ANZB1:
  5E90'   21 0E66        C      	LD	HL,UE.PUF
  5E93'   FE 20          C      	CP	020H
  5E95'   20 04          C      	JR	NZ,KH.ANZB2
  5E97'   06 02          C      	LD	B,2	; 2 Zeilen anzeigen
  5E99'   18 0A          C      	JR	KH.ANZB4
  5E9B'                  C      KH.ANZB2:
  5E9B'   FE 80          C      	CP	080H
  5E9D'   20 04          C      	JR	NZ,KH.ANZB3
  5E9F'   06 08          C      	LD	B,8	; 8 Zeilen anzeigen
  5EA1'   18 02          C      	JR	KH.ANZB4
  5EA3'                  C      KH.ANZB3:	
  5EA3'   06 18          C      	LD	B,24	; 24 Zeilen anzeigen
  5EA5'                  C      KH.ANZB4:
  5EA5'   CD 5EA9'       C      	CALL	KH.AZBLD	;Bild anzeigen (24 Zeilen)
  5EA8'   C9             C      	RET		; IN...HL:=akt. Pufferadresse
                         C      
  5EA9'                  C      KH.AZBLD:
  5EA9'   11 3000        C      	LD	DE,UE.BWSA
  5EAC'                  C      KH.AZBL1:
'Kommandos: KRDx und KWRx'	MACRO-80 3.44	09-Dec-81	PAGE	1-32


  5EAC'   C5             C      	PUSH	BC
  5EAD'   CD 5EC5'       C      	CALL	KH.AZ1Z	; 1 Zeile anzeigen
  5EB0'   C1             C      	POP	BC
  5EB1'   E5             C      	PUSH	HL	;akt. Pufferadresse retten
  5EB2'   EB             C      	EX	DE,HL
  5EB3'   11 0050        C      	LD	DE,80
  5EB6'   19             C      	ADD	HL,DE	;neuen Zeilenanfang berechnen
  5EB7'   EB             C      	EX	DE,HL
  5EB8'   E1             C      	POP	HL
  5EB9'   10 F1          C      	DJNZ	KH.AZBL1
  5EBB'   C9             C      	RET
                         C      
  5EBC'                  C      KH.RD2:
  5EBC'   F5             C      	PUSH	AF	;Flags retten
  5EBD'   CD 6AE7'       C      	CALL	UR.KBR	;Block ruecksetzen
  5EC0'   CD 6AE7'       C      	CALL	UR.KBR
  5EC3'   F1             C      	POP	AF
  5EC4'   C9             C      	RET
                         C      ;                                IN...HL:= Pufferadresse
                         C      ;                                     DE:= Zeilenanfang
  5EC5'                  C      KH.AZ1Z:
  5EC5'   D5             C      	PUSH	DE	;eine Zeile anzeigen
  5EC6'   E5             C      	PUSH	HL
  5EC7'   D5             C      	PUSH	DE
  5EC8'   E1             C      	POP	HL
  5EC9'   01 0040        C      	LD	BC,64
  5ECC'   09             C      	ADD	HL,BC
  5ECD'   E5             C      	PUSH	HL
  5ECE'   C1             C      	POP	BC	;BC:= Anfang ASCII-Darstellung
  5ECF'   E1             C      	POP	HL
  5ED0'   CD 5EE9'       C      	CALL	KH.AZADR	;Adresse anzeigen
  5ED3'   13             C      	INC	DE
  5ED4'   13             C      	INC	DE
  5ED5'   CD 5EF2'       C      	CALL	KH.AZ4BY	;1. Vierergruppe
  5ED8'   13             C      	INC	DE
  5ED9'   13             C      	INC	DE
  5EDA'   CD 5EF2'       C      	CALL	KH.AZ4BY	;2.      ''
  5EDD'   13             C      	INC	DE
  5EDE'   13             C      	INC	DE
  5EDF'   CD 5EF2'       C      	CALL	KH.AZ4BY	;3.      ''
  5EE2'   13             C      	INC	DE
  5EE3'   13             C      	INC	DE
  5EE4'   CD 5EF2'       C      	CALL	KH.AZ4BY	;4.      ''
  5EE7'   D1             C      	POP	DE
  5EE8'   C9             C      	RET
  5EE9'                  C      KH.AZADR:
  5EE9'   7C             C      	LD	A,H	;Anzeige der Adresse
  5EEA'   CD 6F4B'       C      	CALL	UC.CVBX+2
  5EED'   7D             C      	LD	A,L
  5EEE'   CD 6F4B'       C      	CALL	UC.CVBX+2
  5EF1'   C9             C      	RET
  5EF2'                  C      KH.AZ4BY:
  5EF2'   AF             C      	XOR	A	;Anzeige einer Vierergruppe
  5EF3'   32 2B1C'       C      	LD	(UB.PAR1),A
  5EF6'                  C      KH.AZ4B0:
  5EF6'   7E             C      	LD	A,(HL)
  5EF7'   F5             C      	PUSH	AF
  5EF8'   CD 6F4B'       C      	CALL	UC.CVBX+2	;Code als Hexadezimalzahl
  5EFB'   F1             C      	POP	AF
  5EFC'   13             C      	INC	DE
  5EFD'   23             C      	INC	HL
  5EFE'   FE 20          C      	CP	20H
  5F00'   38 15          C      	JR	C,KH.AZ4B1	;nicht darstellbar
  5F02'   FE 7F          C      	CP	7FH
  5F04'   30 11          C      	JR	NC,KH.AZ4B1	;nicht darstellbar
  5F06'                  C      KH.AZ4B3:
  5F06'   02             C      	LD	(BC),A	;Code als ASCII-Zeichen
  5F07'   03             C      	INC	BC
  5F08'   CD 5F1B'       C      	CALL	KH.BLEVG	;Test auf Blockende
  5F0B'   3A 2B1C'       C      	LD	A,(UB.PAR1)
  5F0E'   3C             C      	INC	A
  5F0F'   FE 04          C      	CP	4
  5F11'   C8             C      	RET	Z
  5F12'   32 2B1C'       C      	LD	(UB.PAR1),A
  5F15'   18 DF          C      	JR	KH.AZ4B0
  5F17'                  C      KH.AZ4B1:
  5F17'   3E 7F          C      	LD	A,07FH
  5F19'   18 EB          C      	JR	KH.AZ4B3
  5F1B'                  C      KH.BLEVG:
  5F1B'   D5             C      	PUSH	DE	;Blockendetest
  5F1C'   E5             C      	PUSH	HL
  5F1D'   11 0E66        C      	LD	DE,UE.PUF	;DE:= Pufferanfang
  5F20'   B7             C      	OR	A
'Kommandos: KRDx und KWRx'	MACRO-80 3.44	09-Dec-81	PAGE	1-33


  5F21'   ED 52          C      	SBC	HL,DE	;HL:= Anzahl der angezeigten
  5F23'   EB             C      	EX	DE,HL
  5F24'   CD 6EB7'       C      	CALL	XY.LIDX
  5F27'   09             C      	DB	9
  5F28'   B7             C      	OR	A
  5F29'   ED 52          C      	SBC	HL,DE
  5F2B'   E1             C      	POP	HL
  5F2C'   D1             C      	POP	DE
  5F2D'   28 01          C      	JR	Z,KH.BLEV1
  5F2F'   C9             C      	RET
  5F30'                  C      KH.BLEV1:
  5F30'   06 0C          C      	LD	B,12
  5F32'                  C      KH.BLEV2:
  5F32'   33             C      	INC	SP
  5F33'   10 FD          C      	DJNZ	KH.BLEV2
  5F35'   C9             C      	RET		;---> Anzeige beendet
                         C      
                         C      ;----------------------------------------------------
  5F36'                  C      KH.BILO:
  5F36'   21 3000        C      	LD	HL,3000H
  5F39'   01 077F        C      	LD	BC,24*80 -1	;800H
  5F3C'   36 20          C      	LD	(HL),20H
  5F3E'   E5             C      	PUSH	HL
  5F3F'   D1             C      	POP	DE
  5F40'   13             C      	INC	DE
  5F41'   ED B0          C      	LDIR
  5F43'   C9             C      	RET
                         C      ;------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Ein-/Ausgabe im freien Format'
                         C      	PAGE
'Ein-/Ausgabe im freien Format'	MACRO-80 3.44	09-Dec-81	PAGE	1-34


                         C      
                         C      ;	PN	FD
                         C      ;**********************************************************************
                         C      ;
                         C      ;      Ein-/Ausgabe von Dateien im freien Format in bzw. aus demEditor-
                         C      ;      raum von bzw. auf MRES-Kassetten
                         C      ;
                         C      ;**********************************************************************
                         C      ;      Positionieren auf Datei, IN: <C>:= Labelnummer
                         C      ;
  5F44'                  C      FD.POSK:
  5F44'   C5             C      	PUSH	BC
  5F45'   41             C      	LD	B,C
  5F46'   04             C      	INC	B
  5F47'   CD 6AF6'       C      	CALL	UR.POSIK
  5F4A'   CD 5F5C'       C      	CALL	FD.KO01
  5F4D'   3A 0E66        C      	LD	A,(UE.PUF)
  5F50'   B9             C      	CP	C
  5F51'   C1             C      	POP	BC
  5F52'   20 01          C      	JR	NZ,$+3
  5F54'   C9             C      	RET
  5F55'   D1             C      	POP	DE
  5F56'   3E 94          C      	LD	A,94H
  5F58'   CD 5697'       C      	CALL	UF.ERANZ
  5F5B'   C9             C      	RET
                         C      ;
  5F5C'   DD 36 05 02    C      FD.KO01:	LD	(IX+5),2	;FUER FD19
  5F60'   C3 5668'       C      	JP	UF.EXEC
                         C      ;----------------------------------------------------------------------
                         C      ;      Datei im Verzeichnis suchen
                         C      ;      HL:= Dateiname, <B>:= Anzahl Verzeichniseintragungen + 1
                         C      ;      <D>:= Dateityp
                         C      ;      O:  CY:= 0 Datei nicht vorhanden, <C> unveraendert
                         C      ;          CY:= 1 <C>:= Labelnummer
                         C      ;      K:  B
  5F63'                  C      FD.DASU:
  5F63'   D5             C      	PUSH	DE
  5F64'   05             C      	DEC	B
  5F65'   28 0A          C      	JR	Z,$+12
  5F67'   CD 5F5C'       C      	CALL	FD.KO01
  5F6A'   CD 6D75'       C      	CALL	U1.NMVGL
  5F6D'   38 05          C      	JR	C,$+7
  5F6F'   10 F6          C      	DJNZ	$-8
  5F71'   B7             C      	OR	A
  5F72'   D1             C      	POP	DE
  5F73'   C9             C      	RET
  5F74'   5F             C      	LD	E,A
  5F75'   3A 0E6C        C      	LD	A,(UE.PUF+6)
  5F78'   BA             C      	CP	D
  5F79'   20 F4          C      	JR	NZ,$-10
  5F7B'   4B             C      	LD	C,E
  5F7C'   37             C      	SCF
  5F7D'   18 F3          C      	JR	$-11
                         C      ;----------------------------------------------------------------------
                         C      ;      Reservebloecke schreiben
                         C      ;
  5F7F'                  C      FD.WRRES:
  5F7F'   C5             C      	PUSH	BC
  5F80'   D5             C      	PUSH	DE
  5F81'   E5             C      	PUSH	HL
  5F82'   21 5905'       C      	LD	HL,UA.ZKRES
  5F85'   CD 6B59'       C      	CALL	UR.MIMO
  5F88'   EB             C      	EX	DE,HL
  5F89'   CD 7007'       C      	CALL	UC.CVDB
  5F8C'   7C             C      	LD	A,H
  5F8D'   B5             C      	OR	L
  5F8E'   20 04          C      	JR	NZ,$+6
  5F90'   E1             C      	POP	HL
  5F91'   D1             C      	POP	DE
  5F92'   C1             C      	POP	BC
  5F93'   C9             C      	RET
  5F94'   E5             C      	PUSH	HL
  5F95'   21 0E66        C      	LD	HL,UE.PUF
  5F98'   01 0090        C      	LD	BC,90H
  5F9B'   CD 6CBE'       C      	CALL	U1.CLRB
  5F9E'   21 0080        C      	LD	HL,80H
  5FA1'   CD 6ED7'       C      	CALL	XY.STIDX
  5FA4'   09             C      	DB	9
  5FA5'   E1             C      	POP	HL
  5FA6'   CD 72F0'       C      	CALL	UK.KBA
  5FA9'   2B             C      	DEC	HL
  5FAA'   7C             C      	LD	A,H
'Ein-/Ausgabe im freien Format'	MACRO-80 3.44	09-Dec-81	PAGE	1-35


  5FAB'   B5             C      	OR	L
  5FAC'   20 E6          C      	JR	NZ,$-24
  5FAE'   18 E0          C      	JR	$-30
                         C      ;----------------------------------------------------------------------
                         C      ;      F/S - Datei in den Editorraum einlesen
                         C      ;
  5FB0'                  C      FD.FDINP:
  5FB0'   21 0000        C      	LD	HL,0
  5FB3'   CD 6EC7'       C      	CALL	XY.STDX
  5FB6'   11             C      	DB	17
  5FB7'   CD 723F'       C      	CALL	UK.KLPFB	;Pufferbereitstellung
  5FBA'   21 3328        C      	LD	HL,UE.BWSA+328H
  5FBD'   06 05          C      	LD	B,5
  5FBF'   7E             C      	LD	A,(HL)
  5FC0'   FE 45          C      	CP	'E'
  5FC2'   28 05          C      	JR	Z,$+7
  5FC4'   23             C      	INC	HL
  5FC5'   10 F8          C      	DJNZ	$-6
  5FC7'   18 05          C      	JR	$+7
  5FC9'   2A 0DC4        C      	LD	HL,(UE.EDEND)
  5FCC'   18 03          C      	JR	$+5
  5FCE'   21 8830        C      	LD	HL,UE.TEXAN
  5FD1'   D9             C      	EXX
  5FD2'   CD 71FC'       C      	CALL	DC.INIT	;Dekomprimierung initialisieren
  5FD5'   D9             C      	EXX
  5FD6'   3A 2B1E'       C      	LD	A,(UB.PAR2)	;Dateitypmerker
  5FD9'   FE 53          C      	CP	'S'
  5FDB'   F5             C      	PUSH	AF
  5FDC'   CC 5FF7'       C      	CALL	Z,FD.SDIN	;Zeicheneingabe S- Datei
  5FDF'   77             C      	LD	(HL),A
  5FE0'   B7             C      	OR	A
  5FE1'   28 12          C      	JR	Z,$+20
  5FE3'   F1             C      	POP	AF
  5FE4'   28 07          C      	JR	Z,$+9
  5FE6'   C4 7202'       C      	CALL	NZ,UK.GETK	;Zeicheneingabe F- Datei
  5FE9'   77             C      	LD	(HL),A	;Zeichen in Speicher eintragen
  5FEA'   BE             C      	CP	(HL)	;Echolesen
  5FEB'   20 10          C      	JR	NZ,$+18
  5FED'   B7             C      	OR	A	;<A>:= 0, Z:= 1
  5FEE'   C8             C      	RET	Z
  5FEF'   23             C      	INC	HL	;HL:= HL + 1
  5FF0'   22 0DC4        C      	LD	(UE.EDEND),HL	;Textende
  5FF3'   18 E1          C      	JR	$-29
  5FF5'   F1             C      	POP	AF
  5FF6'   C9             C      	RET
  5FF7'                  C      FD.SDIN:
  5FF7'   D9             C      	EXX
  5FF8'   CD 71C1'       C      	CALL	DC.DCMPR
  5FFB'   D9             C      	EXX
  5FFC'   C9             C      	RET
  5FFD'   3E 93          C      	LD	A,93H	;Fehlerschluessel
  5FFF'   CD 5697'       C      	CALL	UF.ERANZ
  6002'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;      Ausgabe einer F/S - Datei (neuer Bestand)
                         C      ;
  6003'                  C      FD.FDOUT:
  6003'   21 0000        C      	LD	HL,0	;Blockzaehler loeschen
  6006'   CD 6EC7'       C      	CALL	XY.STDX
  6009'   11             C      	DB	17
  600A'   21 0080        C      	LD	HL,80H	;Blocklaenge eintragen
  600D'   CD 6ED7'       C      	CALL	XY.STIDX
  6010'   09             C      	DB	9
  6011'   CD 72CB'       C      	CALL	UK.KSPFB	;Pufferbereitstellung
  6014'   21 8830        C      	LD	HL,UE.TEXAN	;HL:= Textanfang
  6017'   ED 5B 0DC4     C      	LD	DE,(UE.EDEND)	;BC:= Textende
  601B'   D9             C      	EXX
  601C'   CD 71BB'       C      	CALL	CP.INIT
  601F'   D9             C      	EXX
  6020'   B7             C      	OR	A	;CY:= 0
  6021'   E5             C      	PUSH	HL
  6022'   ED 52          C      	SBC	HL,DE
  6024'   30 13          C      	JR	NC,$+21
  6026'   E1             C      	POP	HL
  6027'   3A 2B1E'       C      	LD	A,(UB.PAR2)
  602A'   FE 53          C      	CP	'S'
  602C'   F5             C      	PUSH	AF
  602D'   7E             C      	LD	A,(HL)
  602E'   CC 6051'       C      	CALL	Z,FD.SDOUT
  6031'   F1             C      	POP	AF
  6032'   7E             C      	LD	A,(HL)
  6033'   C4 72A7'       C      	CALL	NZ,UK.PUTK
  6036'   23             C      	INC	HL
'Ein-/Ausgabe im freien Format'	MACRO-80 3.44	09-Dec-81	PAGE	1-36


  6037'   18 E7          C      	JR	$-23
  6039'   E1             C      	POP	HL	;Endebehandlung
  603A'   01 0120        C      	LD	BC,288
  603D'   AF             C      	XOR	A
  603E'   CD 72A7'       C      	CALL	UK.PUTK
  6041'   0B             C      	DEC	BC
  6042'   78             C      	LD	A,B
  6043'   B1             C      	OR	C
  6044'   20 F7          C      	JR	NZ,$-7
  6046'   CD 6214'       C      	CALL	FD.DSPBB
  6049'   CD 5F7F'       C      	CALL	FD.WRRES	;Reservebloecke schreiben
  604C'   CD 6EA7'       C      	CALL	XY.LDDX	;HL:= Blockzaehler
  604F'   11             C      	DB	17
  6050'   C9             C      	RET
  6051'                  C      FD.SDOUT:
  6051'   D9             C      	EXX
  6052'   CD 7158'       C      	CALL	CP.COMPR
  6055'   D9             C      	EXX
  6056'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;      Ausgabe einer F/S - Datei (alter Bestand)
                         C      ;
  6057'                  C      FD.FDOWR:
  6057'   21 0000        C      	LD	HL,0
  605A'   CD 6EC7'       C      	CALL	XY.STDX
  605D'   11             C      	DB	17
  605E'   21 8830        C      	LD	HL,UE.TEXAN
  6061'   D9             C      	EXX
  6062'   CD 71BB'       C      	CALL	CP.INIT
  6065'   D9             C      	EXX
  6066'   E5             C      	PUSH	HL
  6067'                  C      FD.FDOW1:
  6067'   CD 60A7'       C      	CALL	FD.FDUP
  606A'   E1             C      	POP	HL
  606B'                  C      FD.FDOW2:
  606B'   E5             C      	PUSH	HL
  606C'   ED 5B 0DC4     C      	LD	DE,(UE.EDEND)
  6070'   B7             C      	OR	A
  6071'   ED 52          C      	SBC	HL,DE
  6073'   30 1B          C      	JR	NC,FD.FDOW3
  6075'   E1             C      	POP	HL
  6076'   3A 2B1E'       C      	LD	A,(UB.PAR2)
  6079'   FE 53          C      	CP	'S'
  607B'   7E             C      	LD	A,(HL)
  607C'   28 41          C      	JR	Z,FD.SDOW
  607E'   CD 72A7'       C      	CALL	UK.PUTK
  6081'   0B             C      	DEC	BC
  6082'                  C      FD.FDOW4:
  6082'   23             C      	INC	HL
  6083'   78             C      	LD	A,B
  6084'   B1             C      	OR	C
  6085'   20 E4          C      	JR	NZ,FD.FDOW2
  6087'   CD 72F0'       C      	CALL	UK.KBA	;Block schreiben
  608A'   E5             C      	PUSH	HL
  608B'   CD 609D'       C      	CALL	FD.DECBZ
  608E'   18 D7          C      	JR	FD.FDOW1
  6090'                  C      FD.FDOW3:
  6090'   E1             C      	POP	HL
  6091'   AF             C      	XOR	A	;Endekennzeichen 00H 
  6092'   CD 72A7'       C      	CALL	UK.PUTK
  6095'   CD 72F0'       C      	CALL	UK.KBA
  6098'   CD 609D'       C      	CALL	FD.DECBZ
  609B'   B7             C      	OR	A
  609C'   C9             C      	RET
  609D'                  C      FD.DECBZ:
  609D'   CD 6EA7'       C      	CALL	XY.LDDX
  60A0'   11             C      	DB	17
  60A1'   2B             C      	DEC	HL
  60A2'   CD 6EC7'       C      	CALL	XY.STDX
  60A5'   11             C      	DB	17
  60A6'   C9             C      	RET
  60A7'                  C      FD.FDUP:
  60A7'   CD 7262'       C      	CALL	UK.KBW
  60AA'   DD 7E 02       C      	LD	A,(IX+2)	;Laenge = 1, dann BM
  60AD'   FE 01          C      	CP	1
  60AF'   CA 6239'       C      	JP	Z,FD.BMGF
  60B2'   CD 6AE7'       C      	CALL	UR.KBR
  60B5'   CD 6EB7'       C      	CALL	XY.LIDX
  60B8'   09             C      	DB	9
  60B9'   E5             C      	PUSH	HL
  60BA'   C1             C      	POP	BC
  60BB'   CD 72CB'       C      	CALL	UK.KSPFB
  60BE'   C9             C      	RET
'Ein-/Ausgabe im freien Format'	MACRO-80 3.44	09-Dec-81	PAGE	1-37


  60BF'                  C      FD.SDOW:
  60BF'   CD 6051'       C      	CALL	FD.SDOUT
  60C2'   78             C      	LD	A,B
  60C3'   A1             C      	AND	C
  60C4'   FE FF          C      	CP	0FFH
  60C6'   28 1B          C      	JR	Z,FD.SDK1
  60C8'   FE FE          C      	CP	0FEH
  60CA'   28 03          C      	JR	Z,FD.SDK2
  60CC'   C3 6082'       C      	JP	FD.FDOW4
  60CF'                  C      FD.SDK2:
  60CF'   EB             C      	EX	DE,HL
  60D0'   CD 60A7'       C      	CALL	FD.FDUP
  60D3'   3E 09          C      	LD	A,09H
  60D5'   CD 72A7'       C      	CALL	UK.PUTK
  60D8'   0B             C      	DEC	BC
  60D9'                  C      FD.SDK0:
  60D9'   3E 3B          C      	LD	A,';'
  60DB'   CD 72A7'       C      	CALL	UK.PUTK
  60DE'   0B             C      	DEC	BC
  60DF'   EB             C      	EX	DE,HL
  60E0'   C3 6082'       C      	JP	FD.FDOW4
  60E3'                  C      FD.SDK1:
  60E3'   EB             C      	EX	DE,HL
  60E4'   CD 60A7'       C      	CALL	FD.FDUP
  60E7'   18 F0          C      	JR	FD.SDK0
                         C      ;--------------------------------------------------------------
                         C      ;        Startroutine Ein-/Ausgabe
                         C      ;
  60E9'                  C      FD.FSTRT:
  60E9'   CD 6E57'       C      	CALL	U1.BILO
  60EC'   CD 6D90'       C      	CALL	U1.KTINI
  60EF'   3A 3326        C      	LD	A,(UE.BWSA+326H)
  60F2'   CD 6E6B'       C      	CALL	U1.TST
  60F5'   DA 6121'       C      	JP	C,FD.STRT1
  60F8'   DD 77 04       C      	LD	(IX+4),A
  60FB'   CD 6AB1'       C      	CALL	UR.KRE
  60FE'   CD 6ABF'       C      	CALL	UR.KRWW
  6101'   CD 6D44'       C      	CALL	U1.DSVG
  6104'   3E 0E          C      	LD	A,14
  6106'   32 2B00'       C      	LD	(UB.ZN),A
  6109'   3A 3328        C      	LD	A,(UE.BWSA+328H)
  610C'   FE 53          C      	CP	'S'
  610E'   28 02          C      	JR	Z,$+4
  6110'   3E 46          C      	LD	A,'F'
  6112'   57             C      	LD	D,A
  6113'   32 2B1E'       C      	LD	(UB.PAR2),A
  6116'   21 5918'       C      	LD	HL,UA.ZKSDT
  6119'   28 03          C      	JR	Z,$+5
  611B'   21 5888'       C      	LD	HL,UA.ZKDAT
  611E'   CD 6B59'       C      	CALL	UR.MIMO
  6121'                  C      FD.STRT1:
  6121'   FD E1          C      	POP	IY
  6123'   D8             C      	RET	C
  6124'   FD E5          C      	PUSH	IY
  6126'   3E 53          C      	LD	A,'S'
  6128'   BA             C      	CP	D
  6129'   CC 6154'       C      	CALL	Z,FD.DECHL
  612C'   CD 5F63'       C      	CALL	FD.DASU
  612F'   DC 6136'       C      	CALL	C,FD.SETJ
  6132'   D4 614E'       C      	CALL	NC,FD.SETN
  6135'   C9             C      	RET
  6136'                  C      FD.SETJ:
  6136'   C5             C      	PUSH	BC
  6137'   D5             C      	PUSH	DE
  6138'   E5             C      	PUSH	HL
  6139'   EB             C      	EX	DE,HL
  613A'   06 08          C      	LD	B,8
  613C'   13             C      	INC	DE
  613D'   10 FD          C      	DJNZ	$-1
  613F'   21 0E6E        C      	LD	HL,UE.PUF+8
  6142'   01 0006        C      	LD	BC,6
  6145'   ED B0          C      	LDIR
  6147'   E1             C      	POP	HL
  6148'   D1             C      	POP	DE
  6149'   C1             C      	POP	BC
  614A'   3E 4A          C      	LD	A,'J'
  614C'   18 02          C      	JR	$+4
  614E'                  C      FD.SETN:
  614E'   3E 4E          C      	LD	A,'N'
  6150'   32 2B1C'       C      	LD	(UB.PAR1),A
  6153'   C9             C      	RET
  6154'                  C      FD.DECHL:
  6154'   2B             C      	DEC	HL
'Ein-/Ausgabe im freien Format'	MACRO-80 3.44	09-Dec-81	PAGE	1-38


  6155'   2B             C      	DEC	HL
  6156'   C9             C      	RET
                         C      ;****************************************************************
                         C      ;        Ausgabeprogramm
                         C      ;****************************************************************
  6157'   6157'          C      	DW	$
  6159'   41 55 53 20    C      	DB	'AUS '
  615D'                  C      FD.FOUT1:
  615D'   CD 60E9'       C      	CALL	FD.FSTRT
  6160'   3A 2B1C'       C      	LD	A,(UB.PAR1)
  6163'   FE 4A          C      	CP	'J'	;DATEI SCHON VORHANDEN ?
  6165'   CA 61D0'       C      	JP	Z,FD.FOLWR	;JA
                         C      ;-------------------------------NEIN--> NEUE ERSTELLEN-----------------
  6168'   79             C      	LD	A,C	;NEXT RECORD
  6169'   32 2B1C'       C      	LD	(UB.PAR1),A
  616C'   3E 7F          C      	LD	A,7FH
  616E'   32 2B20'       C      	LD	(UB.PAR3),A	;PARAMETER KOMMENTARABFRAGE JA
  6171'   CD 6DF4'       C      	CALL	U1.VZS	;NEUEN VERZ.SATZ SCHREIBEN
  6174'   CD 5F44'       C      	CALL	FD.POSK
  6177'   C5             C      	PUSH	BC
  6178'   CD 6003'       C      	CALL	FD.FDOUT
  617B'   E5             C      	PUSH	HL	;BLOCKZAEHLER
  617C'   CD 6AD5'       C      	CALL	UR.KBM
  617F'   21 0020        C      	LD	HL,32
  6182'   CD 6ED7'       C      	CALL	XY.STIDX
  6185'   09             C      	DB	9
  6186'   CD 6D34'       C      	CALL	U1.VSX
  6189'   E1             C      	POP	HL
  618A'   C1             C      	POP	BC
  618B'   E5             C      	PUSH	HL
  618C'   79             C      	LD	A,C
  618D'   3C             C      	INC	A
  618E'   32 0E66        C      	LD	(UE.PUF),A
  6191'   F5             C      	PUSH	AF
  6192'   DD 36 05 08    C      	LD	(IX+5),08H
  6196'   CD 5668'       C      	CALL	UF.EXEC
  6199'   CD 6ABF'       C      	CALL	UR.KRWW
  619C'   CD 6D44'       C      	CALL	U1.DSVG
  619F'   CD 6AE7'       C      	CALL	UR.KBR
  61A2'   F1             C      	POP	AF
  61A3'   32 0E67        C      	LD	(UE.PUF+1),A
  61A6'   78             C      	LD	A,B
  61A7'   3C             C      	INC	A
  61A8'   32 0E69        C      	LD	(UE.PUF+3),A
  61AB'   DD 36 05 08    C      	LD	(IX+5),08H
  61AF'   CD 5668'       C      	CALL	UF.EXEC
  61B2'   DD 36 05 02    C      	LD	(IX+5),02H
  61B6'   CD 5668'       C      	CALL	UF.EXEC
  61B9'   10 FB          C      	DJNZ	$-3
  61BB'   CD 6AE7'       C      	CALL	UR.KBR
  61BE'   E1             C      	POP	HL
  61BF'   22 0E7F        C      	LD	(UE.PUF+25),HL
  61C2'   DD 36 05 08    C      	LD	(IX+5),08H
  61C6'   CD 5668'       C      	CALL	UF.EXEC
  61C9'                  C      FD.END:
  61C9'   CD 6AB9'       C      	CALL	UR.KRW
  61CC'   CD 6AC3'       C      	CALL	UR.KRA
  61CF'   C9             C      	RET
  61D0'                  C      FD.FOLWR:
  61D0'   21 58E7'       C      	LD	HL,UA.ZKDL	;DATEI UEBERSCHREIBEN?
  61D3'   CD 6B59'       C      	CALL	UR.MIMO
  61D6'   D8             C      	RET	C
  61D7'   7E             C      	LD	A,(HL)
  61D8'   FE 4A          C      	CP	'J'
  61DA'   C0             C      	RET	NZ
  61DB'   CD 5F44'       C      	CALL	FD.POSK
  61DE'   CD 6057'       C      	CALL	FD.FDOWR
  61E1'   CD 6214'       C      	CALL	FD.DSPBB
  61E4'   CD 622E'       C      	CALL	FD.RDEND
  61E7'   CD 6224'       C      	CALL	FD.DSPBG
  61EA'   18 DD          C      	JR	$-33
                         C      ;**********************************************************************
                         C      ;      Eingabeprogramm
                         C      ;**********************************************************************
  61EC'   61EC'          C      	DW	$
  61EE'   45 49 4E 20    C      	DB	'EIN '
  61F2'                  C      FD.FDIN2:
  61F2'   CD 60E9'       C      	CALL	FD.FSTRT
  61F5'   3A 2B1C'       C      	LD	A,(UB.PAR1)
  61F8'   FE 4A          C      	CP	'J'
  61FA'   28 07          C      	JR	Z,$+9
  61FC'   3E 91          C      	LD	A,91H
  61FE'   CD 5697'       C      	CALL	UF.ERANZ
'Ein-/Ausgabe im freien Format'	MACRO-80 3.44	09-Dec-81	PAGE	1-39


  6201'   18 C6          C      	JR	FD.END
  6203'   CD 5F44'       C      	CALL	FD.POSK
  6206'   CD 5FB0'       C      	CALL	FD.FDINP
  6209'   CD 6214'       C      	CALL	FD.DSPBB
  620C'   CD 622E'       C      	CALL	FD.RDEND
  620F'   CD 6224'       C      	CALL	FD.DSPBG
  6212'   18 B5          C      	JR	FD.END
                         C      ;----------------------------------------------------------------------
  6214'                  C      FD.DSPBB:
  6214'   CD 6EA7'       C      	CALL	XY.LDDX
  6217'   11             C      	DB	17
  6218'   EB             C      	EX	DE,HL
  6219'   21 592D'       C      	LD	HL,UA.ZKBEL
  621C'   CD 6B59'       C      	CALL	UR.MIMO
  621F'   EB             C      	EX	DE,HL
  6220'   CD 6FBE'       C      	CALL	UC.CVBD3
  6223'   C9             C      	RET
  6224'                  C      FD.DSPBG:
  6224'   CD 6EA7'       C      	CALL	XY.LDDX
  6227'   11             C      	DB	17
  6228'   EB             C      	EX	DE,HL
  6229'   21 5940'       C      	LD	HL,UA.ZKBLG
  622C'   18 EE          C      	JR	$-16
  622E'                  C      FD.RDEND:
  622E'   CD 7262'       C      	CALL	UK.KBW
  6231'   DD 7E 02       C      	LD	A,(IX+2)	;Laenge = 1, dann BM
  6234'   FE 01          C      	CP	1
  6236'   C8             C      	RET	Z
  6237'   18 F5          C      	JR	FD.RDEND
  6239'                  C      FD.BMGF:
  6239'   3E 95          C      	LD	A,95H
  623B'   CD 5697'       C      	CALL	UF.ERANZ
  623E'   D1             C      	POP	DE
  623F'   D1             C      	POP	DE
  6240'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Laden von MRES-P-Dateien'
                         C      	PAGE
'Laden von MRES-P-Dateien'	MACRO-80 3.44	09-Dec-81	PAGE	1-40


                         C      
                         C      ;	PN	LD
                         C      ;***********************************************************
                         C      ;
                         C      ;        Laden von MRES-P-Dateien
                         C      ;
                         C      ;***********************************************************
  6241'   6241'          C      	DW	$
  6243'   4C 4F 41 44    C      	DB	'LOAD'
  6247'   3A 3327        C      	LD	A,(UE.BWSA+327H)
  624A'   CD 6E6B'       C      	CALL	U1.TST
  624D'   D8             C      	RET	C
  624E'   CD 6D90'       C      	CALL	U1.KTINI
  6251'   DD 77 04       C      	LD	(IX+4),A
  6254'   CD 6E57'       C      	CALL	U1.BILO
  6257'   3E 0D          C      	LD	A,13
  6259'   32 2B00'       C      	LD	(UB.ZN),A
  625C'                  C      LD.DATN:
  625C'   21 5888'       C      	LD	HL,UA.ZKDAT	;Dateiname ?
  625F'   CD 6B59'       C      	CALL	UR.MIMO
  6262'   D8             C      	RET	C
  6263'   CD 6AB1'       C      	CALL	UR.KRE
  6266'   CD 6ABF'       C      	CALL	UR.KRWW
  6269'   CD 6D44'       C      	CALL	U1.DSVG
  626C'   3E 01          C      	LD	A,01H
  626E'   B8             C      	CP	B
  626F'   28 0A          C      	JR	Z,LD.LD21	;NEU INITIALISIERTE KASSETTE
  6271'                  C      LD.LD2:
  6271'   CD 7262'       C      	CALL	UK.KBW
  6274'   CD 6D75'       C      	CALL	U1.NMVGL	;Dateiname vergleichen
  6277'   38 08          C      	JR	C,LD.DATFU	;---> Datei gefunden
  6279'   10 F6          C      	DJNZ	LD.LD2
  627B'                  C      LD.LD21:
  627B'   3E 91          C      	LD	A,91H	;Datei nicht vorhanden
  627D'   CD 5697'       C      	CALL	UF.ERANZ	;FEHLERANZEIGE
  6280'   C9             C      	RET
  6281'                  C      LD.DATFU:
  6281'   3A 0E6C        C      	LD	A,(UE.PUF+6)	;TYP
  6284'   FE 4F          C      	CP	'O'
  6286'   F5             C      	PUSH	AF
  6287'   21 0E7D        C      	LD	HL,UE.PUF+23
  628A'   7E             C      	LD	A,(HL)
  628B'   F5             C      	PUSH	AF
  628C'   47             C      	LD	B,A
  628D'   04             C      	INC	B
  628E'   CD 6AF6'       C      	CALL	UR.POSIK	;Positionieren
  6291'   CD 7262'       C      	CALL	UK.KBW
  6294'   F1             C      	POP	AF
  6295'   21 0E66        C      	LD	HL,UE.PUF
  6298'   BE             C      	CP	(HL)
  6299'   28 07          C      	JR	Z,LD.DATPO	;Datei richtig positioniert
  629B'   F1             C      	POP	AF
  629C'   3E 94          C      	LD	A,94H
  629E'   CD 5697'       C      	CALL	UF.ERANZ
  62A1'   C9             C      	RET
  62A2'                  C      LD.DATPO:
  62A2'   F1             C      	POP	AF
  62A3'   CA 6338'       C      	JP	Z,RL.BEG
  62A6'   3A 3329        C      	LD	A,(UE.BWSA+329H)
  62A9'   FE 56          C      	CP	'V'
  62AB'   20 57          C      	JR	NZ,LD.LD3
  62AD'   21 589B'       C      	LD	HL,UA.ZKLAD	;Ladeadresse ?
  62B0'   CD 6B59'       C      	CALL	UR.MIMO
  62B3'   DA 625C'       C      	JP	C,LD.DATN
  62B6'   CD 6E75'       C      	CALL	U1.PRADR	;ADRESSE EINGEGEBEN
  62B9'   38 F2          C      	JR	C,$-12
  62BB'   EB             C      	EX	DE,HL
  62BC'   21 2B1C'       C      	LD	HL,UB.PAR1
  62BF'   CD 6FAB'       C      	CALL	UC.CVXA
  62C2'                  C      LD.LD4:
  62C2'   CD 723F'       C      	CALL	UK.KLPFB
  62C5'   CD 7202'       C      	CALL	UK.GETK
  62C8'   CD 7202'       C      	CALL	UK.GETK
  62CB'   67             C      	LD	H,A
  62CC'   CD 7202'       C      	CALL	UK.GETK
  62CF'   6F             C      	LD	L,A
  62D0'   7A             C      	LD	A,D
  62D1'   B3             C      	OR	E
  62D2'   28 09          C      	JR	Z,LD.LD5
  62D4'   ED 5B 2B1C'    C      	LD	DE,(UB.PAR1)
  62D8'   EB             C      	EX	DE,HL
  62D9'   B7             C      	OR	A
'Laden von MRES-P-Dateien'	MACRO-80 3.44	09-Dec-81	PAGE	1-41


  62DA'   ED 52          C      	SBC	HL,DE
  62DC'   EB             C      	EX	DE,HL	;DE:= Verschiebung zur ersten
  62DD'                  C      LD.LD5:
  62DD'   CD 6AE7'       C      	CALL	UR.KBR
  62E0'   CD 6309'       C      	CALL	LD.LADER
  62E3'   22 2B1E'       C      	LD	(UB.PAR2),HL
  62E6'   21 3329        C      	LD	HL,UE.BWSA+329H
  62E9'   06 04          C      	LD	B,4
  62EB'   7E             C      	LD	A,(HL)
  62EC'   FE 53          C      	CP	'S'
  62EE'   28 0A          C      	JR	Z,LD.START
  62F0'   23             C      	INC	HL
  62F1'   10 F8          C      	DJNZ	$-6
  62F3'   CD 6AB9'       C      	CALL	UR.KRW
  62F6'   CD 6AC3'       C      	CALL	UR.KRA
  62F9'   C9             C      	RET
  62FA'                  C      LD.START:
  62FA'   CD 6AB9'       C      	CALL	UR.KRW
  62FD'   CD 6AC3'       C      	CALL	UR.KRA
  6300'   2A 2B1E'       C      	LD	HL,(UB.PAR2)
  6303'   E9             C      	JP	(HL)
  6304'                  C      LD.LD3:
  6304'   11 0000        C      	LD	DE,0
  6307'   18 B9          C      	JR	LD.LD4
                         C      ;--------------------------------------------------------------
  6309'                  C      LD.LADER:
  6309'   CD 723F'       C      	CALL	UK.KLPFB
  630C'                  C      LD.LAD2:
  630C'   CD 7202'       C      	CALL	UK.GETK
  630F'   FE 00          C      	CP	0
  6311'   28 16          C      	JR	Z,LD.LDEND
  6313'   47             C      	LD	B,A
  6314'   CD 7202'       C      	CALL	UK.GETK
  6317'   67             C      	LD	H,A
  6318'   CD 7202'       C      	CALL	UK.GETK
  631B'   6F             C      	LD	L,A
  631C'   19             C      	ADD	HL,DE
  631D'                  C      LD.LAD1:
  631D'   CD 7202'       C      	CALL	UK.GETK
  6320'   77             C      	LD	(HL),A
  6321'   BE             C      	CP	(HL)
  6322'   20 0E          C      	JR	NZ,LD.LADF
  6324'   23             C      	INC	HL
  6325'   10 F6          C      	DJNZ	LD.LAD1
  6327'   18 E3          C      	JR	LD.LAD2
  6329'                  C      LD.LDEND:
  6329'   CD 7202'       C      	CALL	UK.GETK
  632C'   67             C      	LD	H,A
  632D'   CD 7202'       C      	CALL	UK.GETK
  6330'   6F             C      	LD	L,A
  6331'   C9             C      	RET
  6332'                  C      LD.LADF:
  6332'   3E 93          C      	LD	A,93H
  6334'   CD 5697'       C      	CALL	UF.ERANZ
  6337'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Relativloader fuer O-Dateien'
                         C      	PAGE
'Relativloader fuer O-Dateien'	MACRO-80 3.44	09-Dec-81	PAGE	1-42


                         C      
                         C      ;	PN	RL
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;     RELATIVLOADER FUER O-DATEIEN
                         C      ;
                         C      ;----------------------------------------------------------------------
  6338'                  C      RL.BEG:
  6338'   21 58AE'       C      	LD	HL,UA.ZKBEG	;BEGINN ?
  633B'   CD 6B59'       C      	CALL	UR.MIMO
  633E'   DA 625C'       C      	JP	C,LD.DATN
  6341'   CD 6E75'       C      	CALL	U1.PRADR
  6344'   38 F2          C      	JR	C,RL.BEG
  6346'   EB             C      	EX	DE,HL
  6347'   21 2B26'       C      	LD	HL,UB.PATAB
  634A'   CD 6FAB'       C      	CALL	UC.CVXA
  634D'                  C      RL.UG:
  634D'   CD 7262'       C      	CALL	UK.KBW
  6350'   2A 2B26'       C      	LD	HL,(UB.PATAB)	;BGADR---->HL
  6353'   0E 01          C      	LD	C,001H	;LADEN BLOCKZAEHLER MIT
                         C      			;ANFANGSWERT
  6355'   CD 63E0'       C      	CALL	RL.UP6	; AUFRUF EINGABE-UP
                         C      ;********** TEST BEFEHLSKENNZEICHENBYTE *******************************
  6358'                  C      RL.M16:
  6358'   CB 5A          C      	BIT	3,D	;TEST ORG-BEFEHL
  635A'   C2 6434'       C      	JP	NZ,RL.OB	;JA--->FEHLER
  635D'   CB 62          C      	BIT	4,D	;TEST BER -BEFEHL
  635F'   C2 63C9'       C      	JP	NZ,RL.M10
  6362'   3E 07          C      	LD	A,007H
  6364'   A2             C      	AND	D	;TEST BEFEHLS LAENGE=0 ?
  6365'   CA 63DA'       C      	JP	Z,RL.M11
  6368'   47             C      	LD	B,A	;BEFEHLSLAENGE-->B
  6369'                  C      RL.M12:
  6369'   CD 63E0'       C      	CALL	RL.UP6
  636C'   72             C      	LD	(HL),D
  636D'   23             C      	INC	HL
  636E'   10 F9          C      	DJNZ	RL.M12	;EINGABE BEFEHL
  6370'   CD 63E0'       C      	CALL	RL.UP6
  6373'   CB 7A          C      	BIT	7,D	;TEST BEFEHLSKENNZEICHENBYTE ?
  6375'   20 E1          C      	JR	NZ,RL.M16	; JA
                         C      ;******* TEST ADRESSKENNZEICHENBYTE ***********************************
  6377'   CB 6A          C      	BIT	5,D	;TEST OB REL.ADR. FOLGT
  6379'   CA 6438'       C      	JP	Z,RL.RA	;NEIN-->FEHLER
  637C'   CB 72          C      	BIT	6,D	;FOLGT BEZUGNAHME AUF
                         C      			;SYMBOLVERZEICHNIS
  637E'   C2 643C'       C      	JP	NZ,RL.SV	;JA--->FEHLER
  6381'   CB 52          C      	BIT	2,D	;MINUS ?
  6383'   C2 6440'       C      	JP	NZ,RL.MN
  6386'                  C      RL.M17:
  6386'   3E 03          C      	LD	A,003H
  6388'   A2             C      	AND	D	;TEST ADRESSLAENGE
  6389'   F5             C      	PUSH	AF
  638A'   E5             C      	PUSH	HL
  638B'   CD 63E0'       C      	CALL	RL.UP6
  638E'   62             C      	LD	H,D	;ADRESSE ---->HL
  638F'   CD 63E0'       C      	CALL	RL.UP6
  6392'   6A             C      	LD	L,D
  6393'   C5             C      	PUSH	BC
  6394'   E5             C      	PUSH	HL
  6395'   21 2B26'       C      	LD	HL,UB.PATAB
  6398'   4E             C      	LD	C,(HL)	;BEGINN(LADE)ADRESSE--->BC
  6399'   23             C      	INC	HL
  639A'   46             C      	LD	B,(HL)
  639B'   E1             C      	POP	HL
  639C'   09             C      	ADD	HL,BC	;ERMITTELN SPEICHERADRESSE
  639D'   EB             C      	EX	DE,HL	;SP.ADR.--->DE
  639E'   C1             C      	POP	BC
  639F'   E1             C      	POP	HL
  63A0'   F1             C      	POP	AF
  63A1'   28 04          C      	JR	Z,RL.M13
  63A3'   CB 47          C      	BIT	0,A	;NUR L-TEIL DER ADRESSE ?
  63A5'   28 10          C      	JR	Z,RL.M14	; JA
                         C      ;********** ADRESSE IN SPEICHER EINTRAGEN *****************************
  63A7'                  C      RL.M13:
  63A7'   73             C      	LD	(HL),E
  63A8'   F5             C      	PUSH	AF
  63A9'   7B             C      	LD	A,E
  63AA'   BE             C      	CP	(HL)
  63AB'   C2 642B'       C      	JP	NZ,RL.ECHO
  63AE'   F1             C      	POP	AF
  63AF'   23             C      	INC	HL
  63B0'   FE 03          C      	CP	003H
'Relativloader fuer O-Dateien'	MACRO-80 3.44	09-Dec-81	PAGE	1-43


  63B2'   28 03          C      	JR	Z,RL.M14
  63B4'   B7             C      	OR	A	;NUR H-TEIL DER ADRESSE ?
  63B5'   20 08          C      	JR	NZ,RL.M15	; JA
  63B7'                  C      RL.M14:
  63B7'   72             C      	LD	(HL),D
  63B8'   F5             C      	PUSH	AF
  63B9'   7A             C      	LD	A,D
  63BA'   BE             C      	CP	(HL)
  63BB'   20 6E          C      	JR	NZ,RL.ECHO
  63BD'   F1             C      	POP	AF
  63BE'   23             C      	INC	HL
  63BF'                  C      RL.M15:
  63BF'   CD 63E0'       C      	CALL	RL.UP6
  63C2'   CB 7A          C      	BIT	7,D	; TEST BEFEHLSKENNZEICHENBYTE
  63C4'   20 92          C      	JR	NZ,RL.M16
  63C6'   C3 6444'       C      	JP	RL.BF	; NEIN--->FEHLER
                         C      ;----------------------------------------------------------------------
  63C9'                  C      RL.M10:
  63C9'   CD 63E0'       C      	CALL	RL.UP6	;BEI BER-BEFEHL ADDIEREN DER
  63CC'   D5             C      	PUSH	DE	;DEF. BEREICHSLAENGE ZU
  63CD'   CD 63E0'       C      	CALL	RL.UP6	;ADRESSE
  63D0'   7A             C      	LD	A,D
  63D1'   D1             C      	POP	DE
  63D2'   5F             C      	LD	E,A
  63D3'   19             C      	ADD	HL,DE
  63D4'   CD 63E0'       C      	CALL	RL.UP6
  63D7'   C3 6358'       C      	JP	RL.M16
  63DA'                  C      RL.M11:
  63DA'   CD 63E0'       C      	CALL	RL.UP6	;BEI BFL=0 SPRUNG ZUM TEST
  63DD'   C3 6386'       C      	JP	RL.M17	;ADRESSKENNZEICHENBYTE
                         C      ;******* UP ZUR ZEICHENWEISE EINGABE DER O-DATEI **********************
  63E0'                  C      RL.UP6:
  63E0'   CD 7202'       C      	CALL	UK.GETK
  63E3'   57             C      	LD	D,A
  63E4'   0D             C      	DEC	C	;REDUZIEREN BLOCKLAENGE
  63E5'   C0             C      	RET	NZ		;RET BEI UNGLEICH NULL
  63E6'   A7             C      	AND	A	;IST NAECHSTE BLOCKLAENGE NULL ?
  63E7'   28 04          C      	JR	Z,RL.M21	;JA-->VERZWEIGUNG ENDEBEH
  63E9'   4F             C      	LD	C,A	;NEIN-->EINTRAGEN BLKLAENGE
  63EA'   0C             C      	INC	C
  63EB'   18 F3          C      	JR	RL.UP6
                         C      ;*********** ENDEBEHANDLUNG *******************************************
  63ED'                  C      RL.M21:
  63ED'   D1             C      	POP	DE
  63EE'   E5             C      	PUSH	HL
  63EF'   3E 0F          C      	LD	A,15
  63F1'   32 2B00'       C      	LD	(UB.ZN),A
  63F4'   21 58C4'       C      	LD	HL,UA.ZKEND+3
  63F7'   11 3460        C      	LD	DE,3460H
  63FA'   01 0010        C      	LD	BC,16
  63FD'   ED B0          C      	LDIR
  63FF'   21 2B00'       C      	LD	HL,UB.ZN
  6402'   34             C      	INC	(HL)
  6403'   E1             C      	POP	HL
  6404'   2B             C      	DEC	HL
  6405'   11 3470        C      	LD	DE,3470H	;HINTER AUSSCHRIFT ENDE
  6408'   CD 6F65'       C      	CALL	UC.CVHLX
  640B'   21 58D4'       C      	LD	HL,UA.STADR	;STARTADRESSE ?
  640E'   CD 6B59'       C      	CALL	UR.MIMO
  6411'   D8             C      	RET	C
  6412'   EB             C      	EX	DE,HL
  6413'   21 2B28'       C      	LD	HL,UB.PATAB+2
  6416'   CD 6FAB'       C      	CALL	UC.CVXA	;STARTADR.-->BINAER
  6419'   3A 3329        C      	LD	A,(UE.BWSA+329H)
  641C'   FE 53          C      	CP	'S'
  641E'   20 04          C      	JR	NZ,$+6
  6420'   2A 2B28'       C      	LD	HL,(UB.PATAB+2)
  6423'   E9             C      	JP	(HL)
  6424'   CD 6AB9'       C      	CALL	UR.KRW
  6427'   CD 6AC3'       C      	CALL	UR.KRA
  642A'   C9             C      	RET
                         C      ;---------------------------------------------------------------------
  642B'                  C      RL.ECHO:
  642B'   D1             C      	POP	DE
  642C'   3E 93          C      	LD	A,93H
  642E'   18 16          C      	JR	RL.FMELD
  6430'                  C      RL.DATNV:
  6430'   3E 91          C      	LD	A,91H
  6432'   18 12          C      	JR	RL.FMELD
  6434'                  C      RL.OB:
  6434'   3E 96          C      	LD	A,96H
  6436'   18 0E          C      	JR	RL.FMELD
  6438'                  C      RL.RA:
'Relativloader fuer O-Dateien'	MACRO-80 3.44	09-Dec-81	PAGE	1-44


  6438'   3E 97          C      	LD	A,97H
  643A'   18 0A          C      	JR	RL.FMELD
  643C'                  C      RL.SV:
  643C'   3E 98          C      	LD	A,98H
  643E'   18 06          C      	JR	RL.FMELD
  6440'                  C      RL.MN:
  6440'   3E 99          C      	LD	A,99H
  6442'   18 02          C      	JR	RL.FMELD
  6444'                  C      RL.BF:
  6444'   3E 9A          C      	LD	A,9AH
  6446'                  C      RL.FMELD:
  6446'   CD 5697'       C      	CALL	UF.ERANZ
  6449'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Retten von Maschinencodeprogrammen als MRES - P-Datei'
                         C      	PAGE
'Retten von Maschinencodeprogrammen als MRES - P-Datei'	MACRO-80 3.44	09-Dec-81	PAGE	1-45


                         C      
                         C      ;	PN	SV
                         C      ;**********************************************************************
                         C      ;
                         C      ;      Retten von Maschinencodeprogrammen als MRES - P-Datei
                         C      ;
                         C      ;**********************************************************************
  644A'   644A'          C      	DW	$
  644C'   53 41 56 45    C      	DB	'SAVE'
  6450'   3A 3327        C      	LD	A,(UE.BWSA+327H)
  6453'   CD 6E6B'       C      	CALL	U1.TST
  6456'   D8             C      	RET	C
  6457'   CD 6D90'       C      	CALL	U1.KTINI
  645A'   DD 77 04       C      	LD	(IX+4),A
  645D'   AF             C      	XOR	A
  645E'   32 2B1D'       C      	LD	(UB.PAR1+1),A
  6461'   CD 6E57'       C      	CALL	U1.BILO	;BS LOESCHEN
  6464'   CD 6AB1'       C      	CALL	UR.KRE
  6467'   DD CB 00 56    C      	BIT	2,(IX)
  646B'   28 05          C      	JR	Z,$+7
  646D'   3E 19          C      	LD	A,19H
  646F'   CD 5697'       C      	CALL	UF.ERANZ
  6472'   CD 6ABF'       C      	CALL	UR.KRWW
  6475'                  C      SV.SV20:
  6475'   CD 6D44'       C      	CALL	U1.DSVG
  6478'   C5             C      	PUSH	BC
  6479'   79             C      	LD	A,C
  647A'   32 2B1C'       C      	LD	(UB.PAR1),A	;NEXT RECORD
  647D'   3E 0D          C      	LD	A,13
  647F'   32 2B00'       C      	LD	(UB.ZN),A
  6482'                  C      SV.DATN:
  6482'   21 5888'       C      	LD	HL,UA.ZKDAT	;Dateiname ?
  6485'   CD 6B59'       C      	CALL	UR.MIMO
  6488'   D8             C      	RET	C
  6489'   C1             C      	POP	BC
  648A'   05             C      	DEC	B
  648B'   28 1A          C      	JR	Z,SV.SV30	;NEUE KASSETTE
  648D'                  C      SV.SV21:
  648D'   CD 7262'       C      	CALL	UK.KBW
  6490'   CD 6D75'       C      	CALL	U1.NMVGL
  6493'   38 04          C      	JR	C,SV.DATV1	;Dateiname bereits vorhanden
  6495'   10 F6          C      	DJNZ	SV.SV21
  6497'   18 0E          C      	JR	SV.SV30
  6499'                  C      SV.DATV1:
  6499'   3E 01          C      	LD	A,01H
  649B'   B8             C      	CP	B
  649C'   CC 65E5'       C      	CALL	Z,SV.DALO1
  649F'   28 0E          C      	JR	Z,SV.SV37
  64A1'                  C      SV.DATVO:
  64A1'   3E 92          C      	LD	A,92H
  64A3'   CD 5697'       C      	CALL	UF.ERANZ
  64A6'   C9             C      	RET
  64A7'                  C      SV.SV30:
  64A7'   3E 50          C      	LD	A,'P'
  64A9'   32 2B1E'       C      	LD	(UB.PAR2),A
  64AC'   CD 6DF4'       C      	CALL	U1.VZS
  64AF'                  C      SV.SV37:
  64AF'   3A 2B1D'       C      	LD	A,(UB.PAR1+1)
  64B2'   FE 4C          C      	CP	'L'
  64B4'   20 0B          C      	JR	NZ,SV.SV31
  64B6'   21 58E7'       C      	LD	HL,UA.ZKDL
  64B9'   CD 6B59'       C      	CALL	UR.MIMO
  64BC'   7E             C      	LD	A,(HL)
  64BD'   FE 4A          C      	CP	'J'
  64BF'   20 E0          C      	JR	NZ,SV.DATVO
  64C1'                  C      SV.SV31:
  64C1'   3A 2B1C'       C      	LD	A,(UB.PAR1)	;NEXT RECORD
  64C4'   47             C      	LD	B,A
  64C5'   C5             C      	PUSH	BC
  64C6'   04             C      	INC	B
  64C7'   CD 6AF6'       C      	CALL	UR.POSIK
  64CA'   CD 7262'       C      	CALL	UK.KBW
  64CD'   21 0E66        C      	LD	HL,UE.PUF
  64D0'   C1             C      	POP	BC
  64D1'   7E             C      	LD	A,(HL)
  64D2'   B8             C      	CP	B
  64D3'   28 06          C      	JR	Z,SV.SAVE3
  64D5'   3E 94          C      	LD	A,94H
  64D7'   CD 5697'       C      	CALL	UF.ERANZ
  64DA'   C9             C      	RET
  64DB'                  C      SV.SAVE3:
  64DB'   21 58AE'       C      	LD	HL,UA.ZKBEG	;Beginn ?
'Retten von Maschinencodeprogrammen als MRES - P-Datei'	MACRO-80 3.44	09-Dec-81	PAGE	1-46


  64DE'   CD 6B59'       C      	CALL	UR.MIMO
  64E1'   DA 6482'       C      	JP	C,SV.DATN
  64E4'   CD 6E75'       C      	CALL	U1.PRADR
  64E7'   38 F2          C      	JR	C,SV.SAVE3
  64E9'   EB             C      	EX	DE,HL
  64EA'   21 2B1E'       C      	LD	HL,UB.PAR2
  64ED'   CD 6FAB'       C      	CALL	UC.CVXA
  64F0'                  C      SV.SAVE4:
  64F0'   21 58C1'       C      	LD	HL,UA.ZKEND	;Ende ?
  64F3'   CD 6B59'       C      	CALL	UR.MIMO
  64F6'   38 E3          C      	JR	C,SV.SAVE3
  64F8'   CD 6E75'       C      	CALL	U1.PRADR
  64FB'   38 F3          C      	JR	C,SV.SAVE4
  64FD'   EB             C      	EX	DE,HL
  64FE'   21 2B20'       C      	LD	HL,UB.PAR3
  6501'   CD 6FAB'       C      	CALL	UC.CVXA
  6504'   CD 6554'       C      	CALL	SV.BYANZ
  6507'   38 D2          C      	JR	C,SV.SAVE3
  6509'   28 D0          C      	JR	Z,SV.SAVE3
  650B'   CD 6579'       C      	CALL	SV.SAVE
  650E'   CD 6AD5'       C      	CALL	UR.KBM
  6511'   CD 655F'       C      	CALL	SV.DATS1	;1.DATEISATZ SCHREIBEN
  6514'   CD 6ADB'       C      	CALL	UR.KSL
  6517'   CD 6ABF'       C      	CALL	UR.KRWW
  651A'   CD 6D44'       C      	CALL	U1.DSVG
  651D'   05             C      	DEC	B
  651E'   3A 2B1D'       C      	LD	A,(UB.PAR1+1)
  6521'   FE 4C          C      	CP	'L'
  6523'   28 13          C      	JR	Z,SV.SAVE5
  6525'   21 0E67        C      	LD	HL,UE.PUF+1
  6528'   34             C      	INC	(HL)	;NEXT RECORD+1
  6529'   21 0E69        C      	LD	HL,UE.PUF+3
  652C'   46             C      	LD	B,(HL)
  652D'   34             C      	INC	(HL)	;ANZ.VERZ.EINTR.+1
  652E'                  C      SV.SAVE6:
  652E'   CD 6AE7'       C      	CALL	UR.KBR
  6531'   DD 36 05 08    C      	LD	(IX+5),08H	;NEUEN DS-SATZ AUSGEBEN
  6535'   CD 5668'       C      	CALL	UF.EXEC
  6538'                  C      SV.SAVE5:
  6538'   CD 7262'       C      	CALL	UK.KBW
  653B'   10 FB          C      	DJNZ	SV.SAVE5
  653D'   CD 6AE7'       C      	CALL	UR.KBR
  6540'   2A 2B24'       C      	LD	HL,(UB.PAR5)
  6543'   22 0E7F        C      	LD	(UE.PUF+25),HL	;DATEILAENGE EINTRAGEN
  6546'   DD 36 05 08    C      	LD	(IX+5),08H
  654A'   CD 5668'       C      	CALL	UF.EXEC
  654D'   CD 6AB9'       C      	CALL	UR.KRW
  6550'   CD 6AC3'       C      	CALL	UR.KRA
  6553'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  6554'                  C      SV.BYANZ:
  6554'   2A 2B20'       C      	LD	HL,(UB.PAR3)	;Byteanzahl berechnen
  6557'   ED 5B 2B1E'    C      	LD	DE,(UB.PAR2)
  655B'   B7             C      	OR	A
  655C'   ED 52          C      	SBC	HL,DE
  655E'   C9             C      	RET
  655F'                  C      SV.DATS1:
  655F'   21 0020        C      	LD	HL,32	;1. Dateisatz schreiben
  6562'   CD 6ED7'       C      	CALL	XY.STIDX
  6565'   09             C      	DB	9
  6566'   CD 6D34'       C      	CALL	U1.VSX
  6569'   21 0E66        C      	LD	HL,UE.PUF
  656C'   3A 2B1C'       C      	LD	A,(UB.PAR1)	;NEXT RECORD
  656F'   3C             C      	INC	A
  6570'   77             C      	LD	(HL),A
  6571'   DD 36 05 08    C      	LD	(IX+5),08H
  6575'   CD 5668'       C      	CALL	UF.EXEC
  6578'   C9             C      	RET
  6579'                  C      SV.SAVE:
  6579'   21 0000        C      	LD	HL,0
  657C'   CD 6EC7'       C      	CALL	XY.STDX
  657F'   11             C      	DB	17
  6580'   21 0080        C      	LD	HL,80H	;Blocklaenge
  6583'   CD 6ED7'       C      	CALL	XY.STIDX
  6586'   09             C      	DB	9
  6587'   CD 72CB'       C      	CALL	UK.KSPFB	;Pufferbereitstellung
  658A'                  C      SV.SAVE1:
  658A'   CD 6554'       C      	CALL	SV.BYANZ	;Byteanzahl berechnen
  658D'   23             C      	INC	HL
  658E'   E5             C      	PUSH	HL
  658F'   7C             C      	LD	A,H
  6590'   B5             C      	OR	L
  6591'   E1             C      	POP	HL
'Retten von Maschinencodeprogrammen als MRES - P-Datei'	MACRO-80 3.44	09-Dec-81	PAGE	1-47


  6592'   28 13          C      	JR	Z,SV.SVLS2	;---> 0 Byte
  6594'   01 007D        C      	LD	BC,UE.SVL	;Satzlaenge
  6597'   B7             C      	OR	A
  6598'   ED 42          C      	SBC	HL,BC
  659A'   38 05          C      	JR	C,SV.SVLS	;---> letzter Satz
  659C'   CD 65F0'       C      	CALL	SV.SVSZ
  659F'   18 E9          C      	JR	SV.SAVE1
  65A1'                  C      SV.SVLS:
  65A1'   7D             C      	LD	A,L
  65A2'   C6 7D          C      	ADD	A,UE.SVL	;A:= Laenge des letzten Satzes
  65A4'   CD 65F2'       C      	CALL	SV.SVSZ2
  65A7'                  C      SV.SVLS2:
  65A7'   AF             C      	XOR	A
  65A8'   CD 72A7'       C      	CALL	UK.PUTK
  65AB'   21 58D4'       C      	LD	HL,UA.STADR	;Startadresse
  65AE'   CD 6B59'       C      	CALL	UR.MIMO
  65B1'   7E             C      	LD	A,(HL)
  65B2'   FE 20          C      	CP	' '
  65B4'   28 27          C      	JR	Z,SV.STAD0	;KEINE EINGABE (0000)
  65B6'   EB             C      	EX	DE,HL
  65B7'   21 2B22'       C      	LD	HL,UB.PAR4
  65BA'   CD 6FAB'       C      	CALL	UC.CVXA
  65BD'                  C      SV.SVLS1:
  65BD'   2A 2B22'       C      	LD	HL,(UB.PAR4)
  65C0'   7C             C      	LD	A,H	;Startadresse ausgeben
  65C1'   CD 72A7'       C      	CALL	UK.PUTK
  65C4'   7D             C      	LD	A,L
  65C5'   CD 72A7'       C      	CALL	UK.PUTK
  65C8'   0E 03          C      	LD	C,3
  65CA'                  C      SV.SVEN2:
  65CA'   06 80          C      	LD	B,80H
  65CC'   AF             C      	XOR	A
  65CD'                  C      SV.SVEN1:
  65CD'   CD 72A7'       C      	CALL	UK.PUTK
  65D0'   10 FB          C      	DJNZ	SV.SVEN1
  65D2'   0D             C      	DEC	C
  65D3'   20 F5          C      	JR	NZ,SV.SVEN2
  65D5'   CD 6EA7'       C      	CALL	XY.LDDX
  65D8'   11             C      	DB	17
  65D9'   22 2B24'       C      	LD	(UB.PAR5),HL
  65DC'   C9             C      	RET
  65DD'                  C      SV.STAD0:
  65DD'   21 0000        C      	LD	HL,0
  65E0'   22 2B22'       C      	LD	(UB.PAR4),HL
  65E3'   18 D8          C      	JR	SV.SVLS1
  65E5'                  C      SV.DALO1:
  65E5'   F5             C      	PUSH	AF
  65E6'   21 2B1C'       C      	LD	HL,UB.PAR1
  65E9'   35             C      	DEC	(HL)
  65EA'   23             C      	INC	HL
  65EB'   3E 4C          C      	LD	A,'L'
  65ED'   77             C      	LD	(HL),A
  65EE'   F1             C      	POP	AF
  65EF'   C9             C      	RET
  65F0'                  C      SV.SVSZ:
  65F0'   3E 7D          C      	LD	A,UE.SVL
  65F2'                  C      SV.SVSZ2:
  65F2'   F5             C      	PUSH	AF
  65F3'   CD 72A7'       C      	CALL	UK.PUTK
  65F6'   ED 5B 2B1E'    C      	LD	DE,(UB.PAR2)
  65FA'   7A             C      	LD	A,D
  65FB'   CD 72A7'       C      	CALL	UK.PUTK
  65FE'   7B             C      	LD	A,E
  65FF'   CD 72A7'       C      	CALL	UK.PUTK
  6602'   F1             C      	POP	AF
  6603'   47             C      	LD	B,A
  6604'                  C      SV.SVSZ1:
  6604'   1A             C      	LD	A,(DE)
  6605'   CD 72A7'       C      	CALL	UK.PUTK
  6608'   13             C      	INC	DE
  6609'   10 F9          C      	DJNZ	SV.SVSZ1
  660B'   ED 53 2B1E'    C      	LD	(UB.PAR2),DE
  660F'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                                ;	
                                ;	INCLUDE	KX.MAC	;Kopieren von MRES-Kassetten Teil 1
                                ;	INCLUDE	KY.MAC	;Kopieren von MRES-Kassetten Teil 2
                                ;	INCLUDE	KU.MAC	;Unterprogramme fuer KOPI
                         C      	INCLUDE K6.MAC	;Kopieren MRES
                         C      	TITLE	'Kopieren von MRES-Kassetten Teil 1'
                         C      	PAGE
'Kopieren von MRES-Kassetten Teil 1'	MACRO-80 3.44	09-Dec-81	PAGE	1-48


                         C      
                         C      ;	PN	KX
                         C      ;------------------------------------------------------------------
                         C      ;
                         C      ;          KOPIEREN VON MRES-KASSETTEN       TEIL1
                         C      ;
                         C      ;----------------------------------------------------------------
  6610'   6610'          C      	DW	$
  6612'   4B 4F 50 49    C      	DB	'KOPI'
  6616'   CD 6D90'       C      	CALL	U1.KTINI
  6619'   11 E000        C      	LD	DE,BC.TAB1
  661C'   21 3327        C      	LD	HL,UE.BWSA+327H
  661F'   7E             C      	LD	A,(HL)
  6620'   CD 6E6B'       C      	CALL	U1.TST
  6623'   D8             C      	RET	C
  6624'   12             C      	LD	(DE),A
  6625'   23             C      	INC	HL
  6626'   EE 33          C      	XOR	33H
  6628'   BE             C      	CP	(HL)
  6629'   C0             C      	RET	NZ
  662A'   EE 30          C      	XOR	30H
  662C'   13             C      	INC	DE
  662D'   12             C      	LD	(DE),A
  662E'   3A 3326        C      	LD	A,(UE.BWSA+326H)
  6631'   FE 4A          C      	CP	'J'
  6633'   28 05          C      	JR	Z,$+7	;BEI KOPIJ WERDEN WEITERE PARAMETER
  6635'   23             C      	INC	HL	;IGNORIERT
  6636'   23             C      	INC	HL
  6637'   7E             C      	LD	A,(HL)
  6638'   FE 20          C      	CP	20H
  663A'   F5             C      	PUSH	AF
  663B'   20 0C          C      	JR	NZ,$+14
  663D'   CD 6D1B'       C      	CALL	U1.EIN
  6640'   CD 6E8C'       C      	CALL	U1.KRWE
  6643'   CD 6D24'       C      	CALL	U1.AUS
  6646'   CD 6E8C'       C      	CALL	U1.KRWE
  6649'   CD 6784'       C      	CALL	KX.UPA
  664C'   F1             C      	POP	AF
  664D'   28 13          C      	JR	Z,$+21
  664F'   FE 41          C      	CP	'A'
  6651'   28 0A          C      	JR	Z,$+12
  6653'   FE 4C          C      	CP	'L'
  6655'   20 0B          C      	JR	NZ,$+13
  6657'   CD 6CF2'       C      	CALL	U1.COPB
  665A'   C3 672A'       C      	JP	KX.RSPFR
  665D'   CD 6CEE'       C      	CALL	U1.COPB2
  6660'   18 FB          C      	JR	$-3
                         C      ;-------------------------------------------------------------------
  6662'   CD 6D1B'       C      	CALL	U1.EIN
  6665'   CD 6D44'       C      	CALL	U1.DSVG
  6668'   CD 6CCD'       C      	CALL	U1.KBR4
  666B'   CD 6CD8'       C      	CALL	U1.BREAD
  666E'   21 579A'       C      	LD	HL,UA.Z7E
  6671'   11 3163        C      	LD	DE,3163H
  6674'   01 001F        C      	LD	BC,31
  6677'   ED B0          C      	LDIR
  6679'   21 57B9'       C      	LD	HL,UA.GER
  667C'   11 31EA        C      	LD	DE,31EAH
  667F'   CD 6E51'       C      	CALL	U1.INFO
  6682'   21 5764'       C      	LD	HL,UA.KNAME+3
  6685'   11 323A        C      	LD	DE,323AH
  6688'   CD 6E51'       C      	CALL	U1.INFO
  668B'   21 5777'       C      	LD	HL,UA.NR+3
  668E'   11 328A        C      	LD	DE,328AH
  6691'   CD 6E51'       C      	CALL	U1.INFO
  6694'   21 578A'       C      	LD	HL,UA.KOMMT+3
  6697'   11 32DA        C      	LD	DE,32DAH
  669A'   CD 6E51'       C      	CALL	U1.INFO
  669D'   11 3203        C      	LD	DE,3203H
  66A0'   3A E000        C      	LD	A,(BC.TAB1)
  66A3'   CD 6F4B'       C      	CALL	UC.CVBX+2
  66A6'   11 321B        C      	LD	DE,321BH
  66A9'   3A E001        C      	LD	A,(BC.TAB1+1)
  66AC'   CD 6F4B'       C      	CALL	UC.CVBX+2
  66AF'   21 0E6A        C      	LD	HL,UE.PUF+4
  66B2'   11 3253        C      	LD	DE,3253H
  66B5'   06 06          C      	LD	B,6
  66B7'   CD 7056'       C      	CALL	UC.DKONV
  66BA'   21 0E8B        C      	LD	HL,UE.PUF+37
  66BD'   11 32A3        C      	LD	DE,32A3H
  66C0'   06 03          C      	LD	B,3
  66C2'   CD 7056'       C      	CALL	UC.DKONV
'Kopieren von MRES-Kassetten Teil 1'	MACRO-80 3.44	09-Dec-81	PAGE	1-49


  66C5'   11 32F3        C      	LD	DE,32F3H
  66C8'   06 0B          C      	LD	B,11
  66CA'   CD 7056'       C      	CALL	UC.DKONV
  66CD'   CD 6AE1'       C      	CALL	UR.KBV
  66D0'   CD 6AE1'       C      	CALL	UR.KBV
  66D3'   CD 6CD8'       C      	CALL	U1.BREAD
  66D6'   3A 0E69        C      	LD	A,(UE.PUF+3)
  66D9'   3D             C      	DEC	A
  66DA'   CA 6735'       C      	JP	Z,KX.ENDR
  66DD'   CD 6DBE'       C      	CALL	U1.VERIN
  66E0'   CD 6D24'       C      	CALL	U1.AUS
  66E3'   CD 6D44'       C      	CALL	U1.DSVG
  66E6'   CD 6CCD'       C      	CALL	U1.KBR4
  66E9'   DD 36 05 02    C      	LD	(IX+5),02H
  66ED'   CD 5668'       C      	CALL	UF.EXEC
  66F0'   21 0E6A        C      	LD	HL,UE.PUF+4
  66F3'   11 326B        C      	LD	DE,326BH
  66F6'   06 06          C      	LD	B,6
  66F8'   CD 7056'       C      	CALL	UC.DKONV
  66FB'   21 0E8B        C      	LD	HL,UE.PUF+37
  66FE'   11 32BB        C      	LD	DE,32BBH
  6701'   06 03          C      	LD	B,3
  6703'   CD 7056'       C      	CALL	UC.DKONV
  6706'   11 330B        C      	LD	DE,330BH
  6709'   06 0B          C      	LD	B,11
  670B'   CD 7056'       C      	CALL	UC.DKONV
  670E'   CD 6AE1'       C      	CALL	UR.KBV
  6711'   CD 6AE1'       C      	CALL	UR.KBV
  6714'   DD 36 05 02    C      	LD	(IX+5),02H
  6718'   CD 5668'       C      	CALL	UF.EXEC
  671B'   CD 6E57'       C      	CALL	U1.BILO
  671E'   11 E002        C      	LD	DE,BC.VTABA
  6721'   CD 6DC6'       C      	CALL	U1.VERNI
  6724'   CD 6DE0'       C      	CALL	U1.VORST
  6727'   C3 67A1'       C      	JP	KY.MD
  672A'                  C      KX.RSPFR:
  672A'   F5             C      	PUSH	AF
  672B'   23             C      	INC	HL
  672C'   23             C      	INC	HL
  672D'   7E             C      	LD	A,(HL)
  672E'   B7             C      	OR	A
  672F'   FE 52          C      	CP	'R'
  6731'   20 06          C      	JR	NZ,$+8
  6733'   18 01          C      	JR	$+3
  6735'                  C      KX.ENDR:
  6735'   F5             C      	PUSH	AF
  6736'   37             C      	SCF
  6737'   18 04          C      	JR	$+6
  6739'   FE 46          C      	CP	'F'
  673B'   20 15          C      	JR	NZ,$+23
  673D'   CD 6D1B'       C      	CALL	U1.EIN
  6740'   DC 6AB9'       C      	CALL	C,UR.KRW
  6743'   CD 6AC3'       C      	CALL	UR.KRA
  6746'   CD 6D24'       C      	CALL	U1.AUS
  6749'   CD 6AB1'       C      	CALL	UR.KRE
  674C'   DC 6ABF'       C      	CALL	C,UR.KRWW
  674F'   CD 6AC3'       C      	CALL	UR.KRA
  6752'   F1             C      	POP	AF
  6753'   C9             C      	RET
  6754'                  C      KX.EXEC2:
  6754'   F5             C      	PUSH	AF
  6755'   DD CB 00 BE    C      	RES	7,(IX)
  6759'   DD 36 01 00    C      	LD	(IX+1),0
  675D'   CD 55D5'       C      	CALL	KR.KARO
  6760'   DD CB 00 7E    C      	BIT	7,(IX)
  6764'   28 0A          C      	JR	Z,$+12
  6766'   DD 7E 01       C      	LD	A,(IX+1)
  6769'   FE 14          C      	CP	14H
  676B'   28 05          C      	JR	Z,$+7
  676D'   CD 5697'       C      	CALL	UF.ERANZ
  6770'   F1             C      	POP	AF
  6771'   C9             C      	RET
  6772'   DD CB 00 BE    C      	RES	7,(IX)
  6776'   CD 6D24'       C      	CALL	U1.AUS
  6779'   CD 6ADB'       C      	CALL	UR.KSL
  677C'   F1             C      	POP	AF
  677D'   06 06          C      	LD	B,6
  677F'   33             C      	INC	SP
  6780'   10 FD          C      	DJNZ	$-1	;STACK BERICHTIGEN
  6782'   18 A6          C      	JR	KX.RSPFR
  6784'                  C      KX.UPA:
  6784'   CD 6D1B'       C      	CALL	U1.EIN
  6787'   CD 6AB1'       C      	CALL	UR.KRE
'Kopieren von MRES-Kassetten Teil 1'	MACRO-80 3.44	09-Dec-81	PAGE	1-50


  678A'   DD 36 00 00    C      	LD	(IX+0),0
  678E'   CD 6D24'       C      	CALL	U1.AUS
  6791'   CD 6AB1'       C      	CALL	UR.KRE
  6794'   DD CB 00 56    C      	BIT	2,(IX)
  6798'   28 05          C      	JR	Z,$+7
  679A'   D1             C      	POP	DE
  679B'   3E 19          C      	LD	A,19H
  679D'   CD 5697'       C      	CALL	UF.ERANZ
  67A0'   C9             C      	RET
                         C      ;	END
                         C      	TITLE	'Kopieren von MRES-Kassetten Teil 2'
                         C      	PAGE
'Kopieren von MRES-Kassetten Teil 2'	MACRO-80 3.44	09-Dec-81	PAGE	1-51


                         C      
                         C      ;	PN	KY
                         C      ;---------------------------------------------------------------------
                         C      ;
                         C      ;          KOPIEREN VON MRES-KASSETTEN           TEIL 2
                         C      ;
                         C      ;--------------------------------------------------------------------
  67A1'                  C      KY.MD:
  67A1'   CD 6E57'       C      	CALL	U1.BILO
  67A4'   21 57C8'       C      	LD	HL,UA.KOPFR
  67A7'   CD 69FA'       C      	CALL	KY.SATR
  67AA'   3E 0D          C      	LD	A,13
  67AC'   32 2B00'       C      	LD	(UB.ZN),A
  67AF'   21 ECA2        C      	LD	HL,BC.VTABE+32
  67B2'   FD 21 F902     C      	LD	IY,BC.TAB2
  67B6'   FD 36 00 FF    C      	LD	(IY+0),0FFH
  67BA'   3A EC85        C      	LD	A,(BC.VTABE+3)
  67BD'   47             C      	LD	B,A
  67BE'   05             C      	DEC	B
                         C      ;--------------------------------ABFRAGEZYKLUS------------------------
  67BF'                  C      KY.DFR:
  67BF'   C5             C      	PUSH	BC
  67C0'   11 2B44'       C      	LD	DE,UB.SATZ+26
  67C3'   01 0006        C      	LD	BC,6
  67C6'   ED B0          C      	LDIR
  67C8'   13             C      	INC	DE
  67C9'   13             C      	INC	DE
  67CA'   01 0002        C      	LD	BC,2
  67CD'   ED B0          C      	LDIR
  67CF'   01 0018        C      	LD	BC,24
  67D2'   09             C      	ADD	HL,BC
  67D3'   E5             C      	PUSH	HL
  67D4'   21 2B2A'       C      	LD	HL,UB.SATZ
  67D7'   CD 6B59'       C      	CALL	UR.MIMO
  67DA'   DC 6A56'       C      	CALL	C,KU.ZEIR
  67DD'   CD 69F1'       C      	CALL	KY.JHL	;BEI KOPIJ WIRD J GESETZT
  67E0'   7E             C      	LD	A,(HL)
  67E1'   FE 4A          C      	CP	'J'
  67E3'   C4 6A1E'       C      	CALL	NZ,KU.TAB2L
  67E6'   E1             C      	POP	HL
  67E7'   01 0009        C      	LD	BC,9
  67EA'   B7             C      	OR	A
  67EB'   ED 42          C      	SBC	HL,BC
  67ED'   7E             C      	LD	A,(HL)
  67EE'   FD 77 00       C      	LD	(IY+0),A
  67F1'   FD 23          C      	INC	IY
  67F3'   FD 36 00 FF    C      	LD	(IY+0),0FFH
  67F7'   09             C      	ADD	HL,BC
  67F8'   3A E005        C      	LD	A,(BC.VTABA+3)
  67FB'   FE 01          C      	CP	01H
  67FD'   28 2E          C      	JR	Z,KY.EZYK1
  67FF'   E5             C      	PUSH	HL
  6800'   01 0020        C      	LD	BC,32
  6803'   B7             C      	OR	A
  6804'   ED 42          C      	SBC	HL,BC
  6806'   EB             C      	EX	DE,HL
  6807'   E1             C      	POP	HL
  6808'   DD 21 E002     C      	LD	IX,BC.VTABA
  680C'   47             C      	LD	B,A
  680D'   05             C      	DEC	B
  680E'                  C      KY.VZVGL:
  680E'   C5             C      	PUSH	BC
  680F'   01 0020        C      	LD	BC,32
  6812'   DD 09          C      	ADD	IX,BC
  6814'   DD E5          C      	PUSH	IX
  6816'   06 07          C      	LD	B,7
  6818'   D5             C      	PUSH	DE
  6819'                  C      KY.SVGL:
  6819'   1A             C      	LD	A,(DE)
  681A'   DD BE 00       C      	CP	(IX+0)
  681D'   20 08          C      	JR	NZ,KY.NDA
  681F'   DD 23          C      	INC	IX
  6821'   13             C      	INC	DE
  6822'   10 F5          C      	DJNZ	KY.SVGL
  6824'   CD 6A86'       C      	CALL	KU.DD	;DATEI SCHON VORHANDEN
  6827'                  C      KY.NDA:
  6827'   D1             C      	POP	DE
  6828'   DD E1          C      	POP	IX
  682A'   C1             C      	POP	BC
  682B'   10 E1          C      	DJNZ	KY.VZVGL
  682D'                  C      KY.EZYK1:
  682D'   C1             C      	POP	BC
'Kopieren von MRES-Kassetten Teil 2'	MACRO-80 3.44	09-Dec-81	PAGE	1-52


  682E'   10 8F          C      	DJNZ	KY.DFR
                         C      ;---------------------------------------------------------------------
  6830'                  C      KY.ATAA:
  6830'   06 03          C      	LD	B,3	;WARTESCHLEIFE FUER
  6832'   21 FFFF        C      	LD	HL,0FFFFH
  6835'   2B             C      	DEC	HL
  6836'   7C             C      	LD	A,H
  6837'   B5             C      	OR	L
  6838'   20 FB          C      	JR	NZ,$-3
  683A'   10 F6          C      	DJNZ	$-8
  683C'   21 57FE'       C      	LD	HL,UA.EABFR
  683F'   CD 69FA'       C      	CALL	KY.SATR
  6842'   21 2B2A'       C      	LD	HL,UB.SATZ
  6845'   CD 6B59'       C      	CALL	UR.MIMO
  6848'   38 F8          C      	JR	C,$-6
  684A'   CD 69F1'       C      	CALL	KY.JHL
  684D'   7E             C      	LD	A,(HL)
  684E'   FE 4A          C      	CP	'J'
  6850'   C2 67A1'       C      	JP	NZ,KY.MD
                         C      ;--------------------------------Labelnummern fuer Ausgabe ---------
  6853'                  C      KY.ATAB:
  6853'   06 00          C      	LD	B,0
  6855'   21 F902        C      	LD	HL,BC.TAB2
  6858'   11 F9D2        C      	LD	DE,BC.TAB3
  685B'   7E             C      	LD	A,(HL)
  685C'   FE FF          C      	CP	0FFH	;KEINE DATEI KOPIEREN
  685E'   CA 6735'       C      	JP	Z,KX.ENDR
  6861'   3A E003        C      	LD	A,(BC.VTABA+1)
  6864'                  C      KY.ATABE:
  6864'   12             C      	LD	(DE),A
  6865'   23             C      	INC	HL
  6866'   13             C      	INC	DE
  6867'   04             C      	INC	B
  6868'   F5             C      	PUSH	AF
  6869'   7E             C      	LD	A,(HL)
  686A'   FE FF          C      	CP	0FFH
  686C'   28 04          C      	JR	Z,KY.WEI
  686E'   F1             C      	POP	AF
  686F'   3C             C      	INC	A
  6870'   18 F2          C      	JR	KY.ATABE
                         C      ;------------------------------TAB:NR DER VERZ.EINTRAGUNGEN (EING.)------
  6872'                  C      KY.WEI:
  6872'   F1             C      	POP	AF
  6873'   C5             C      	PUSH	BC
  6874'   AF             C      	XOR	A
  6875'   57             C      	LD	D,A
  6876'   3A EC85        C      	LD	A,(BC.VTABE+3)
  6879'   47             C      	LD	B,A
  687A'   05             C      	DEC	B
  687B'   21 F902        C      	LD	HL,BC.TAB2
  687E'   FD 21 F96A     C      	LD	IY,BC.TAB2A
  6882'   DD 21 ECA2     C      	LD	IX,BC.VTABE+32
  6886'                  C      KY.ZYK:
  6886'   14             C      	INC	D
  6887'   7E             C      	LD	A,(HL)
  6888'   DD BE 17       C      	CP	(IX+23)
  688B'   20 0B          C      	JR	NZ,KY.NE
  688D'   7A             C      	LD	A,D
  688E'   FD 77 00       C      	LD	(IY+0),A
  6891'   FD 36 01 FF    C      	LD	(IY+1),0FFH
  6895'   23             C      	INC	HL
  6896'   FD 23          C      	INC	IY
  6898'                  C      KY.NE:
  6898'   C5             C      	PUSH	BC
  6899'   01 0020        C      	LD	BC,32
  689C'   DD 09          C      	ADD	IX,BC
  689E'   C1             C      	POP	BC
  689F'   10 E5          C      	DJNZ	KY.ZYK
                         C      ;------------------------------------AUFBAU AUSGABEVERZ.-----
  68A1'   3A E005        C      	LD	A,(BC.VTABA+3)
  68A4'   47             C      	LD	B,A
  68A5'   FE 01          C      	CP	01H
  68A7'   28 08          C      	JR	Z,KY.EVZ
  68A9'   21 E002        C      	LD	HL,BC.VTABA
  68AC'   CD 6A15'       C      	CALL	KU.VVOR
  68AF'   18 03          C      	JR	KY.EVZ1
  68B1'                  C      KY.EVZ:
  68B1'   21 E022        C      	LD	HL,BC.VTABA+32
  68B4'                  C      KY.EVZ1:
  68B4'   DD 21 F96A     C      	LD	IX,BC.TAB2A
  68B8'   FD 21 F9D2     C      	LD	IY,BC.TAB3
  68BC'   EB             C      	EX	DE,HL
  68BD'   21 ECA2        C      	LD	HL,BC.VTABE+32
'Kopieren von MRES-Kassetten Teil 2'	MACRO-80 3.44	09-Dec-81	PAGE	1-53


  68C0'   DD 7E 00       C      	LD	A,(IX+0)
  68C3'   FE 01          C      	CP	01H
  68C5'   28 05          C      	JR	Z,KY.VSTR
  68C7'   3D             C      	DEC	A
  68C8'   47             C      	LD	B,A
  68C9'   CD 6A15'       C      	CALL	KU.VVOR
  68CC'                  C      KY.VSTR:
  68CC'   01 0020        C      	LD	BC,32
  68CF'   ED B0          C      	LDIR
  68D1'   FD 7E 00       C      	LD	A,(IY+0)
  68D4'   EB             C      	EX	DE,HL
  68D5'   01 0009        C      	LD	BC,9
  68D8'   B7             C      	OR	A
  68D9'   ED 42          C      	SBC	HL,BC
  68DB'   77             C      	LD	(HL),A
  68DC'   09             C      	ADD	HL,BC
  68DD'   EB             C      	EX	DE,HL
  68DE'   DD 7E 01       C      	LD	A,(IX+1)
  68E1'   FE FF          C      	CP	0FFH
  68E3'   28 10          C      	JR	Z,KY.COPY
  68E5'   DD 96 00       C      	SUB	(IX+0)
  68E8'   3D             C      	DEC	A
  68E9'   47             C      	LD	B,A
  68EA'   FE 00          C      	CP	00H
  68EC'   C4 6A15'       C      	CALL	NZ,KU.VVOR
  68EF'   FD 23          C      	INC	IY
  68F1'   DD 23          C      	INC	IX
  68F3'   18 D7          C      	JR	KY.VSTR
                         C      ;------------------------------------VERZ.SCHREIBEN (NUR NEUE SAETZE)---
  68F5'                  C      KY.COPY:
  68F5'   DD 21 2B01'    C      	LD	IX,UB.KTAB
  68F9'   CD 6DA9'       C      	CALL	U1.KTIN1
  68FC'   DD 36 0A 20    C      	LD	(IX+10),20H
  6900'   CD 6D24'       C      	CALL	U1.AUS
  6903'   3A E005        C      	LD	A,(BC.VTABA+3)
  6906'   47             C      	LD	B,A
  6907'   CD 6AE1'       C      	CALL	UR.KBV	;AUSGABEKASSETTE
  690A'   3D             C      	DEC	A
  690B'   20 FA          C      	JR	NZ,$-4	;VORSTELLEN BIS HINTER LETZTEN ALTEN
  690D'   21 E002        C      	LD	HL,BC.VTABA	;VERZ.SATZ
  6910'   11 0020        C      	LD	DE,32
  6913'   19             C      	ADD	HL,DE
  6914'   10 FA          C      	DJNZ	$-4	;AUSGABEVERZ.ZEIGER
  6916'   C1             C      	POP	BC
  6917'   78             C      	LD	A,B
  6918'   F5             C      	PUSH	AF
  6919'                  C      KY.VSCHR:
  6919'   11 0E66        C      	LD	DE,UE.PUF
  691C'   01 0020        C      	LD	BC,32
  691F'   ED B0          C      	LDIR
  6921'   CD 6AE1'       C      	CALL	UR.KBV
  6924'   CD 6AE7'       C      	CALL	UR.KBR
  6927'   DD 36 05 08    C      	LD	(IX+5),08H
  692B'   CD 5668'       C      	CALL	UF.EXEC
  692E'   3D             C      	DEC	A
  692F'   20 E8          C      	JR	NZ,KY.VSCHR
                         C      ;----------------------------------------------------------------
  6931'   11 33FA        C      	LD	DE,33FAH	;''ES WIRD KOPIERT''
  6934'   21 69E1'       C      	LD	HL,KY.EWK
  6937'   01 0010        C      	LD	BC,16
  693A'   ED B0          C      	LDIR
                         C      ;------------------------------KOPIEREN--------------------------
  693C'   21 F902        C      	LD	HL,BC.TAB2
  693F'   11 F9D2        C      	LD	DE,BC.TAB3
  6942'   FD 21 F96A     C      	LD	IY,BC.TAB2A
  6946'   1A             C      	LD	A,(DE)
  6947'   47             C      	LD	B,A
  6948'   04             C      	INC	B
  6949'   CD 6AF6'       C      	CALL	UR.POSIK
  694C'   7E             C      	LD	A,(HL)
  694D'   47             C      	LD	B,A
  694E'   04             C      	INC	B
  694F'                  C      KY.KOPV:
  694F'   CD 6D1B'       C      	CALL	U1.EIN
  6952'   CD 6AF6'       C      	CALL	UR.POSIK
  6955'                  C      KY.KOP:
  6955'   CD 6CD8'       C      	CALL	U1.BREAD
  6958'   7E             C      	LD	A,(HL)
  6959'   FE 01          C      	CP	01H
  695B'   CC 6D34'       C      	CALL	Z,U1.VSX
                         C      ;------------------------ANZEIGE WELCHE DATEI KOPIERT WIRD-------------
  695E'   E5             C      	PUSH	HL
  695F'   D5             C      	PUSH	DE
'Kopieren von MRES-Kassetten Teil 2'	MACRO-80 3.44	09-Dec-81	PAGE	1-54


  6960'   FD 7E 00       C      	LD	A,(IY+0)
  6963'   47             C      	LD	B,A
  6964'   05             C      	DEC	B
  6965'   21 ECA2        C      	LD	HL,BC.VTABE+32
  6968'   FE 01          C      	CP	01H
  696A'   28 03          C      	JR	Z,KY.KOPAN
  696C'   CD 6A15'       C      	CALL	KU.VVOR
  696F'                  C      KY.KOPAN:
  696F'   11 34F0        C      	LD	DE,34F0H
  6972'   01 0006        C      	LD	BC,6
  6975'   ED B0          C      	LDIR
  6977'   13             C      	INC	DE
  6978'   13             C      	INC	DE
  6979'   01 0002        C      	LD	BC,2
  697C'   ED B0          C      	LDIR
  697E'   FD 23          C      	INC	IY
  6980'   D1             C      	POP	DE
  6981'   E1             C      	POP	HL
                         C      ;--------------------------------------------------------------------
  6982'   1A             C      	LD	A,(DE)
  6983'   FE 01          C      	CP	01H
  6985'   CC 6D2D'       C      	CALL	Z,U1.VS1
  6988'   32 0E66        C      	LD	(UE.PUF),A
  698B'   CD 6CE3'       C      	CALL	U1.BWRIT
  698E'   CD 6CF2'       C      	CALL	U1.COPB
  6991'   23             C      	INC	HL
  6992'   7E             C      	LD	A,(HL)
  6993'   FE FF          C      	CP	0FFH
  6995'   28 0B          C      	JR	Z,KY.EOV
  6997'   2B             C      	DEC	HL
  6998'   96             C      	SUB	(HL)
  6999'   23             C      	INC	HL
  699A'   13             C      	INC	DE
  699B'   47             C      	LD	B,A
  699C'   FE 01          C      	CP	01H
  699E'   20 AF          C      	JR	NZ,KY.KOPV
  69A0'   18 B3          C      	JR	KY.KOP
                         C      ;-------------------------------------------------------------
  69A2'                  C      KY.EOV:
  69A2'   CD 6D34'       C      	CALL	U1.VSX
  69A5'   3A E003        C      	LD	A,(BC.VTABA+1)
  69A8'   47             C      	LD	B,A
  69A9'   F1             C      	POP	AF
  69AA'   F5             C      	PUSH	AF
  69AB'   80             C      	ADD	A,B
  69AC'   32 0E66        C      	LD	(UE.PUF),A
  69AF'   CD 6DA9'       C      	CALL	U1.KTIN1
  69B2'   DD 36 0A 20    C      	LD	(IX+10),20H
  69B6'   CD 6CE3'       C      	CALL	U1.BWRIT
  69B9'   CD 6ADB'       C      	CALL	UR.KSL
  69BC'   CD 6735'       C      	CALL	KX.ENDR
  69BF'   CD 6AB1'       C      	CALL	UR.KRE
  69C2'   CD 6D44'       C      	CALL	U1.DSVG
  69C5'   F1             C      	POP	AF
  69C6'   F5             C      	PUSH	AF
  69C7'   81             C      	ADD	A,C	;NEXT RECORD UND
  69C8'   32 0E67        C      	LD	(UE.PUF+1),A
  69CB'   F1             C      	POP	AF
  69CC'   80             C      	ADD	A,B	;ANZAHL VERZ.EINTR. KORRIGIEREN
  69CD'   32 0E69        C      	LD	(UE.PUF+3),A
  69D0'   CD 6AE7'       C      	CALL	UR.KBR
  69D3'   DD 36 05 08    C      	LD	(IX+5),08H
  69D7'   CD 5668'       C      	CALL	UF.EXEC	;NEUEN DS-SATZ SCHREIBEN
  69DA'   CD 6AB9'       C      	CALL	UR.KRW
  69DD'   CD 6AC3'       C      	CALL	UR.KRA
  69E0'   C9             C      	RET
                         C      ;---------------------------------------------------------------
  69E1'                  C      KY.EWK:
  69E1'   45 73 20 77    C      	DB	'Es wird kopiert:'
  69E5'   69 72 64 20    C      
  69E9'   6B 6F 70 69    C      
  69ED'   65 72 74 3A    C      
                         C      ;---------------------------------------------------------------
  69F1'                  C      KY.JHL:
  69F1'   3A 2B1E'       C      	LD	A,(UB.PAR2)
  69F4'   FE 4A          C      	CP	'J'
  69F6'   20 01          C      	JR	NZ,$+3
  69F8'   77             C      	LD	(HL),A
  69F9'   C9             C      	RET
                         C      ;--------------------------------------------------------------
  69FA'                  C      KY.SATR:
  69FA'   11 2B2A'       C      	LD	DE,UB.SATZ
  69FD'   01 0036        C      	LD	BC,54
'Kopieren von MRES-Kassetten Teil 2'	MACRO-80 3.44	09-Dec-81	PAGE	1-55


  6A00'   ED B0          C      	LDIR
  6A02'   3A 3326        C      	LD	A,(UE.BWSA+326H)
  6A05'   FE 4A          C      	CP	'J'
  6A07'   CC 6A0E'       C      	CALL	Z,KY.AJ
  6A0A'   32 2B1E'       C      	LD	(UB.PAR2),A
  6A0D'   C9             C      	RET
  6A0E'                  C      KY.AJ:
  6A0E'   F5             C      	PUSH	AF
  6A0F'   AF             C      	XOR	A
  6A10'   32 2B2A'       C      	LD	(UB.SATZ),A
  6A13'   F1             C      	POP	AF
  6A14'   C9             C      	RET
                         C      ;--------------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Unterprogramme fuer KOPI'
                         C      	PAGE
'Unterprogramme fuer KOPI'	MACRO-80 3.44	09-Dec-81	PAGE	1-56


                         C      
                         C      ;	PN	KU
                         C      ;------------------------------------------------------------------
                         C      ;
                         C      ;          UNTERPROGRAMME FUER KOPI
                         C      ;
                         C      ;--------------------------------------------------------
  6A15'                  C      KU.VVOR:
  6A15'   C5             C      	PUSH	BC
  6A16'   01 0020        C      	LD	BC,32
  6A19'   09             C      	ADD	HL,BC
  6A1A'   C1             C      	POP	BC
  6A1B'   10 F8          C      	DJNZ	KU.VVOR
  6A1D'   C9             C      	RET
  6A1E'                  C      KU.TAB2L:
  6A1E'   D1             C      	POP	DE
  6A1F'   E1             C      	POP	HL
  6A20'   FD 7E 00       C      	LD	A,(IY+0)
  6A23'   FE FF          C      	CP	0FFH
  6A25'   28 22          C      	JR	Z,$+36
  6A27'   FD E5          C      	PUSH	IY
  6A29'   06 00          C      	LD	B,00H
  6A2B'   FD 7E 00       C      	LD	A,(IY+0)
  6A2E'   FE FF          C      	CP	0FFH
  6A30'   20 02          C      	JR	NZ,$+4
  6A32'   18 05          C      	JR	$+7
  6A34'   FD 23          C      	INC	IY
  6A36'   04             C      	INC	B
  6A37'   18 F2          C      	JR	$-12
  6A39'   FD E1          C      	POP	IY
  6A3B'   FD E5          C      	PUSH	IY
  6A3D'   FD 7E 01       C      	LD	A,(IY+1)
  6A40'   FD 77 00       C      	LD	(IY+0),A
  6A43'   FD 23          C      	INC	IY
  6A45'   10 F6          C      	DJNZ	$-8
  6A47'   FD E1          C      	POP	IY
  6A49'   C1             C      	POP	BC
  6A4A'   05             C      	DEC	B
  6A4B'   78             C      	LD	A,B
  6A4C'   FE 00          C      	CP	00H
  6A4E'   28 03          C      	JR	Z,$+5
  6A50'   C3 67BF'       C      	JP	KY.DFR
  6A53'   C3 6830'       C      	JP	KY.ATAA
  6A56'                  C      KU.ZEIR:
  6A56'   D1             C      	POP	DE
  6A57'   E1             C      	POP	HL
  6A58'   3A 2B00'       C      	LD	A,(UB.ZN)
  6A5B'   D6 02          C      	SUB	2
  6A5D'   FE 0D          C      	CP	13
  6A5F'   30 04          C      	JR	NC,$+6
  6A61'   C1             C      	POP	BC
  6A62'   C3 67A1'       C      	JP	KY.MD
  6A65'   32 2B00'       C      	LD	(UB.ZN),A
  6A68'   01 0029        C      	LD	BC,41
  6A6B'   B7             C      	OR	A
  6A6C'   ED 42          C      	SBC	HL,BC
  6A6E'   FD 2B          C      	DEC	IY
  6A70'   7E             C      	LD	A,(HL)
  6A71'   FD BE 00       C      	CP	(IY+0)
  6A74'   CC 6A83'       C      	CALL	Z,KU.DECIY
  6A77'   FD 23          C      	INC	IY
  6A79'   01 0017        C      	LD	BC,23
  6A7C'   B7             C      	OR	A
  6A7D'   ED 42          C      	SBC	HL,BC
  6A7F'   C1             C      	POP	BC
  6A80'   04             C      	INC	B
  6A81'   18 CA          C      	JR	$-52
  6A83'                  C      KU.DECIY:
  6A83'   FD 2B          C      	DEC	IY
  6A85'   C9             C      	RET
  6A86'                  C      KU.DD:
  6A86'   E5             C      	PUSH	HL
  6A87'   21 5834'       C      	LD	HL,UA.VORH
  6A8A'   CD 6B59'       C      	CALL	UR.MIMO
  6A8D'   38 17          C      	JR	C,$+25
  6A8F'   7E             C      	LD	A,(HL)
  6A90'   FE 4A          C      	CP	'J'
  6A92'   28 0C          C      	JR	Z,$+14
  6A94'   FD 2B          C      	DEC	IY
  6A96'   FD 36 00 FF    C      	LD	(IY+0),0FFH
  6A9A'   11 0050        C      	LD	DE,80
  6A9D'   B7             C      	OR	A
'Unterprogramme fuer KOPI'	MACRO-80 3.44	09-Dec-81	PAGE	1-57


  6A9E'   ED 52          C      	SBC	HL,DE
  6AA0'   36 20          C      	LD	(HL),20H
  6AA2'   21 2B00'       C      	LD	HL,UB.ZN
  6AA5'   35             C      	DEC	(HL)
  6AA6'   E1             C      	POP	HL
  6AA7'   C9             C      	RET
  6AA8'   E1             C      	POP	HL
  6AA9'   D1             C      	POP	DE
  6AAA'   DD 21 2B01'    C      	LD	IX,UB.KTAB
  6AAE'   C3 6735'       C      	JP	KX.ENDR
                         C      ;	END
                                ;	
                         C      	INCLUDE K7.MAC	;Routinen fuer Kassette,Monitor UND Tastatur (UR.ASM)
                         C      	TITLE 'Routinen fuer Kassette,Monitor UND Tastatur'
                         C      	PAGE
'Routinen fuer Kassette,Monitor UND Tastatur'	MACRO-80 3.44	09-Dec-81	PAGE	1-58


                         C      
                         C      ;	PN	UR
                         C      ;	ORG	49A0H
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;   ROUTINEN FUER KASSETTE,MONITOR UND TASTATUR
                         C      ;
                         C      ;----------------------------------------------------------------------
                         C      ;   1.     KASSETTE
                         C      ;----------------------------------------------------------------------
  6AB1'                  C      UR.KRE:
  6AB1'   DD 36 05 31    C      	LD	(IX+5),31H
  6AB5'                  C      UR.KRE1:
  6AB5'   CD 5668'       C      	CALL	UF.EXEC
  6AB8'   C9             C      	RET
  6AB9'                  C      UR.KRW:
  6AB9'   DD 36 05 21    C      	LD	(IX+5),21H
  6ABD'   18 F6          C      	JR	UR.KRE1	;Umspulen
  6ABF'                  C      UR.KRWW:
  6ABF'   CD 6AB9'       C      	CALL	UR.KRW
  6AC2'   C9             C      	RET
  6AC3'                  C      UR.KRA:
  6AC3'   DD 36 05 41    C      	LD	(IX+5),41H
  6AC7'   18 EC          C      	JR	UR.KRE1	;Reservieren aus
  6AC9'                  C      UR.KLV:
  6AC9'   DD 36 05 71    C      	LD	(IX+5),71H
  6ACD'   18 E6          C      	JR	UR.KRE1	;Label vorsetzen
  6ACF'                  C      UR.KLR:
  6ACF'   DD 36 05 75    C      	LD	(IX+5),75H
  6AD3'   18 E0          C      	JR	UR.KRE1	;LABEL RUECKSETZEN
  6AD5'                  C      UR.KBM:
  6AD5'   DD 36 05 51    C      	LD	(IX+5),51H
  6AD9'   18 DA          C      	JR	UR.KRE1	;BANDMARKE SCHREIBEN
  6ADB'                  C      UR.KSL:
  6ADB'   DD 36 05 61    C      	LD	(IX+5),61H
  6ADF'   18 D4          C      	JR	UR.KRE1	;SCHLUSSLUECKE SCHREIBEN
  6AE1'                  C      UR.KBV:
  6AE1'   DD 36 05 11    C      	LD	(IX+5),11H
  6AE5'   18 CE          C      	JR	UR.KRE1	;Block vorsetzen
  6AE7'                  C      UR.KBR:
  6AE7'   DD 36 05 15    C      	LD	(IX+5),15H
  6AEB'   18 C8          C      	JR	UR.KRE1
                         C      ;--------------------------------------------------------------------
  6AED'                  C      UR.RPOS:
  6AED'   E5             C      	PUSH	HL
  6AEE'   D5             C      	PUSH	DE
  6AEF'   F5             C      	PUSH	AF
  6AF0'   C5             C      	PUSH	BC
  6AF1'   AF             C      	XOR	A
  6AF2'   3D             C      	DEC	A
  6AF3'   4F             C      	LD	C,A
  6AF4'   18 06          C      	JR	POSIK1
  6AF6'                  C      UR.POSIK:
  6AF6'   E5             C      	PUSH	HL
  6AF7'   D5             C      	PUSH	DE
  6AF8'   F5             C      	PUSH	AF
  6AF9'   C5             C      	PUSH	BC	;Positionieren
  6AFA'   AF             C      	XOR	A
  6AFB'   4F             C      	LD	C,A
  6AFC'                  C      POSIK1:
  6AFC'   06 00          C      	LD	B,0
  6AFE'   11 0000        C      	LD	DE,0
  6B01'                  C      UR.LES:
  6B01'   DD 36 05 02    C      	LD	(IX+5),02H
  6B05'   CD 5668'       C      	CALL	UF.EXEC	;BLOCK LESEN
  6B08'   DD 7E 02       C      	LD	A,(IX+2)
  6B0B'   FE 01          C      	CP	1	;BANDMARKE?
  6B0D'   28 19          C      	JR	Z,UR.BM
  6B0F'   04             C      	INC	B	;ANZAHL BLOECKE
  6B10'   78             C      	LD	A,B
  6B11'   FE 04          C      	CP	4
  6B13'   28 21          C      	JR	Z,UR.OK
  6B15'   21 0000        C      	LD	HL,0
  6B18'   CD 6EB7'       C      	CALL	XY.LIDX
  6B1B'   09             C      	DB	9	;HL<--BLOCKLAENGE
  6B1C'   19             C      	ADD	HL,DE
  6B1D'   EB             C      	EX	DE,HL
  6B1E'   21 012C        C      	LD	HL,300
  6B21'   B7             C      	OR	A
  6B22'   ED 52          C      	SBC	HL,DE
  6B24'   38 10          C      	JR	C,UR.OK
  6B26'   18 D9          C      	JR	UR.LES
'Routinen fuer Kassette,Monitor UND Tastatur'	MACRO-80 3.44	09-Dec-81	PAGE	1-59


  6B28'                  C      UR.BM:
  6B28'   AF             C      	XOR	A
  6B29'   B1             C      	OR	C
  6B2A'   28 04          C      	JR	Z,$+6
  6B2C'   C1             C      	POP	BC
  6B2D'   04             C      	INC	B
  6B2E'   18 C9          C      	JR	UR.POSIK+3
  6B30'   C1             C      	POP	BC
  6B31'   05             C      	DEC	B
  6B32'   28 21          C      	JR	Z,UR.RSP
  6B34'   18 C3          C      	JR	UR.POSIK+3
  6B36'                  C      UR.OK:
  6B36'   AF             C      	XOR	A
  6B37'   B1             C      	OR	C
  6B38'   28 08          C      	JR	Z,$+10
  6B3A'   DD 70 08       C      	LD	(IX+8),B
  6B3D'   CD 6ACF'       C      	CALL	UR.KLR
  6B40'   18 13          C      	JR	UR.RSP
  6B42'   DD 36 05 15    C      	LD	(IX+5),15H
  6B46'   CD 5668'       C      	CALL	UF.EXEC
  6B49'   10 F7          C      	DJNZ	$-7
  6B4B'   C1             C      	POP	BC
  6B4C'   05             C      	DEC	B
  6B4D'   28 06          C      	JR	Z,UR.RSP
  6B4F'   DD 70 08       C      	LD	(IX+8),B
  6B52'   CD 6AC9'       C      	CALL	UR.KLV
  6B55'                  C      UR.RSP:
  6B55'   F1             C      	POP	AF
  6B56'   D1             C      	POP	DE
  6B57'   E1             C      	POP	HL
  6B58'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;     2.     MONITOR
                         C      ;----------------------------------------------------------------------
  6B59'                  C      UR.MIMO:
  6B59'   D5             C      	PUSH	DE	;Register DE, BC retten
  6B5A'   C5             C      	PUSH	BC
  6B5B'   46             C      	LD	B,(HL)	;Anzahl einzugebender Zeichen
  6B5C'   23             C      	INC	HL
  6B5D'   4E             C      	LD	C,(HL)	;Laenge der Zeichenkette
  6B5E'   23             C      	INC	HL
  6B5F'   5E             C      	LD	E,(HL)	;Zeichenschluessel
  6B60'   23             C      	INC	HL
  6B61'   3A 2B00'       C      	LD	A,(UB.ZN)	;Zeilennummer
  6B64'   57             C      	LD	D,A	;D:= Zeilennummer
  6B65'   AF             C      	XOR	A
  6B66'   B9             C      	CP	C
  6B67'   28 0C          C      	JR	Z,UR.MIMO1	;Anzeige entfaellt
  6B69'   D5             C      	PUSH	DE
  6B6A'   CD 6B9B'       C      	CALL	UR.DSPZK	;Anzeige
  6B6D'                  C      UR.MIMO2:
  6B6D'   D1             C      	POP	DE
  6B6E'   CD 6BA8'       C      	CALL	UR.ZINP	;Zeicheneingabe ueber Tastatur
  6B71'   C1             C      	POP	BC
  6B72'   D1             C      	POP	DE
  6B73'   18 07          C      	JR	UR.MIMO3
  6B75'                  C      UR.MIMO1:
  6B75'   D5             C      	PUSH	DE
  6B76'   CD 6B8B'       C      	CALL	UR.BBSAD	;BWS - Adresse berechnen
  6B79'   EB             C      	EX	DE,HL	;HL:= akt. Bildschirmposition
  6B7A'   18 F1          C      	JR	UR.MIMO2
  6B7C'                  C      UR.MIMO3:
  6B7C'   F5             C      	PUSH	AF
  6B7D'   3A 2B00'       C      	LD	A,(UB.ZN)
  6B80'   3C             C      	INC	A
  6B81'   FE 18          C      	CP	24
  6B83'   CC 6C8B'       C      	CALL	Z,UR.BILRO	;Zeile 24 ---> Bild rollen
  6B86'   32 2B00'       C      	LD	(UB.ZN),A
  6B89'   F1             C      	POP	AF
  6B8A'   C9             C      	RET
  6B8B'                  C      UR.BBSAD:
  6B8B'   E5             C      	PUSH	HL	;Berechnung der BWS-Adresse
  6B8C'   C5             C      	PUSH	BC	;IN:    D...Zeilennummer
  6B8D'   21 2FB0        C      	LD	HL,UE.BWSA-80	;OUT:   DE..BWS-Adresse
  6B90'   01 0050        C      	LD	BC,80	;BC:= Zeichen/Zeile
  6B93'                  C      UR.BBSA1:
  6B93'   09             C      	ADD	HL,BC
  6B94'   15             C      	DEC	D
  6B95'   20 FC          C      	JR	NZ,UR.BBSA1
  6B97'   EB             C      	EX	DE,HL
  6B98'   C1             C      	POP	BC
  6B99'   E1             C      	POP	HL
  6B9A'   C9             C      	RET
'Routinen fuer Kassette,Monitor UND Tastatur'	MACRO-80 3.44	09-Dec-81	PAGE	1-60


  6B9B'                  C      UR.DSPZK:
  6B9B'   D5             C      	PUSH	DE	;Anzeige
  6B9C'   C5             C      	PUSH	BC	;IN   HL...Anfangsadresse ZK
  6B9D'   CD 6B8B'       C      	CALL	UR.BBSAD	;      D...Zeilennummer
  6BA0'   06 00          C      	LD	B,0	;      C...Zeichenkettenlaenge
  6BA2'   ED B0          C      	LDIR		;OUT  HL...akt. BWS-Adresse
  6BA4'   EB             C      	EX	DE,HL
  6BA5'   C1             C      	POP	BC
  6BA6'   D1             C      	POP	DE
  6BA7'   C9             C      	RET
  6BA8'                  C      UR.ZINP:
  6BA8'   E5             C      	PUSH	HL	;Zeicheneingabe ueber Tastatur
  6BA9'   AF             C      	XOR	A	;IN    B...Zeichenanzahl (max.)
  6BAA'   50             C      	LD	D,B	;     HL...akt. Adresse
  6BAB'   B8             C      	CP	B	;      E...Zeichenschluessel
  6BAC'   28 3D          C      	JR	Z,UR.RET0	;keine Zeicheneingabe
  6BAE'                  C      UR.ZINP1:
  6BAE'   CD 4033        C      	CALL	SY.SETCHL	;Kursor setzen
  6BB1'                  C      UR.ZINP2:
  6BB1'   CD 6C85'       C      	CALL	UR.TAREP	;Tastaturabfrage
  6BB4'   CD 6BF5'       C      	CALL	UR.TCL	; <---
  6BB7'   CD 6C0A'       C      	CALL	UR.TCR	; --->
  6BBA'   CD 6C1D'       C      	CALL	UR.TSYS	; SYS
  6BBD'   CD 6C25'       C      	CALL	UR.TQUIT	; POS.QUIT
  6BC0'   CD 6C2D'       C      	CALL	UR.ZKONT	;Zeichenkontrolle
  6BC3'   CD 4036        C      	CALL	SY.RESC	;Kursor loeschen
  6BC6'   77             C      	LD	(HL),A	;Zeichen anzeigen
  6BC7'   23             C      	INC	HL	;akt. Adresse erhoehen
  6BC8'   10 E4          C      	DJNZ	UR.ZINP1	;B > 0, naechstes Zeichen
  6BCA'   CD 4033        C      	CALL	SY.SETCHL	;Kursor setzen
  6BCD'                  C      UR.ZINP5:
  6BCD'   CD 6C85'       C      	CALL	UR.TAREP
  6BD0'   FE F7          C      	CP	UE.TACL
  6BD2'   CC 6BEE'       C      	CALL	Z,UR.ZINP7
  6BD5'   FE 1E          C      	CP	UE.TAQUI
  6BD7'   28 06          C      	JR	Z,UR.ZINP3	;---> POS.QUIT
  6BD9'   FE CD          C      	CP	UE.TASYS
  6BDB'   28 08          C      	JR	Z,UR.ZINP4	;---> SYS
  6BDD'   18 EE          C      	JR	UR.ZINP5
  6BDF'                  C      UR.ZINP3:
  6BDF'   CD 4036        C      	CALL	SY.RESC	;Kursor loeschen
  6BE2'   E1             C      	POP	HL	;BWS - Adresse auskellern
  6BE3'   AF             C      	XOR	A	;CY:= 0
  6BE4'   C9             C      	RET
  6BE5'                  C      UR.ZINP4:
  6BE5'   CD 4036        C      	CALL	SY.RESC	;Kursor loeschen
  6BE8'   E1             C      	POP	HL
  6BE9'   37             C      	SCF		;CY:= 1
  6BEA'   C9             C      	RET
  6BEB'                  C      UR.RET0:
  6BEB'   E1             C      	POP	HL	;keine Zeicheneingabe
  6BEC'   AF             C      	XOR	A
  6BED'   C9             C      	RET
  6BEE'                  C      UR.ZINP7:
  6BEE'   CD 6BF5'       C      	CALL	UR.TCL
  6BF1'   33             C      	INC	SP
  6BF2'   33             C      	INC	SP
  6BF3'   18 BC          C      	JR	UR.ZINP2
  6BF5'                  C      UR.TCL:
  6BF5'   FE F7          C      	CP	UE.TACL	;   <---
  6BF7'   C0             C      	RET	NZ		;Taste nicht gedrueckt
  6BF8'   F5             C      	PUSH	AF	;Tastencode retten
  6BF9'   04             C      	INC	B
  6BFA'   7A             C      	LD	A,D
  6BFB'   B8             C      	CP	B
  6BFC'   38 09          C      	JR	C,UR.TCLN	;Linksbewegung nicht zulaessig
  6BFE'   CD 4036        C      	CALL	SY.RESC	;Kursor loeschen
  6C01'   2B             C      	DEC	HL	;BWS - Adresse decrementieren
  6C02'   CD 4033        C      	CALL	SY.SETCHL	;Kursor setzen
  6C05'   F1             C      	POP	AF	;Code auskellern
  6C06'   C9             C      	RET
  6C07'                  C      UR.TCLN:
  6C07'   05             C      	DEC	B
  6C08'   F1             C      	POP	AF
  6C09'   C9             C      	RET
  6C0A'                  C      UR.TCR:
  6C0A'   FE F9          C      	CP	UE.TACR	;   --->
  6C0C'   C0             C      	RET	NZ
  6C0D'   F5             C      	PUSH	AF
  6C0E'   78             C      	LD	A,B
  6C0F'   FE 02          C      	CP	2
  6C11'   38 08          C      	JR	C,UR.TCRN
  6C13'   05             C      	DEC	B
'Routinen fuer Kassette,Monitor UND Tastatur'	MACRO-80 3.44	09-Dec-81	PAGE	1-61


  6C14'   CD 4036        C      	CALL	SY.RESC
  6C17'   23             C      	INC	HL
  6C18'   CD 4033        C      	CALL	SY.SETCHL
  6C1B'                  C      UR.TCRN:
  6C1B'   F1             C      	POP	AF
  6C1C'   C9             C      	RET
  6C1D'                  C      UR.TSYS:
  6C1D'   FE CD          C      	CP	UE.TASYS	; SYS-Taste
  6C1F'   C0             C      	RET	NZ
  6C20'   33             C      	INC	SP
  6C21'   33             C      	INC	SP	;Returnadresse uebergehen
  6C22'   C3 6BE5'       C      	JP	UR.ZINP4
  6C25'                  C      UR.TQUIT:
  6C25'   FE 1E          C      	CP	UE.TAQUI	; POS.QUIT
  6C27'   C0             C      	RET	NZ
  6C28'   33             C      	INC	SP
  6C29'   33             C      	INC	SP
  6C2A'   C3 6BDF'       C      	JP	UR.ZINP3
  6C2D'                  C      UR.ZKONT:
  6C2D'   FE 7F          C      	CP	7FH
  6C2F'   30 22          C      	JR	NC,UR.ZKON1
  6C31'   CB 7B          C      	BIT	7,E	;Zeichenschluesselauswertung
  6C33'   C0             C      	RET	NZ		;Bit 7 = L, alle Tasten erlaubt
  6C34'   FE 20          C      	CP	20H
  6C36'   C8             C      	RET	Z		;Leertaste
  6C37'   CB 6B          C      	BIT	5,E
  6C39'   37             C      	SCF
  6C3A'   C4 6C58'       C      	CALL	NZ,UR.ALPHA
  6C3D'   D0             C      	RET	NC		;Bit 5 = L, nur Buchstaben
  6C3E'   CB 63          C      	BIT	4,E
  6C40'   37             C      	SCF
  6C41'   C4 6C63'       C      	CALL	NZ,UR.NUM
  6C44'   D0             C      	RET	NC		;Bit 4 = L, nur Ziffern
  6C45'   CB 73          C      	BIT	6,E
  6C47'   37             C      	SCF
  6C48'   C4 6C6C'       C      	CALL	NZ,UR.ALPNU
  6C4B'   D0             C      	RET	NC		;Bit 6 = L, Buchstaben und
                         C      			;            Ziffern
  6C4C'   CB 5B          C      	BIT	3,E
  6C4E'   37             C      	SCF
  6C4F'   C4 6C76'       C      	CALL	NZ,UR.HEXAZ
  6C52'   D0             C      	RET	NC		;BIT 3 = L ,HEXAZEICHEN
  6C53'                  C      UR.ZKON1:
  6C53'   33             C      	INC	SP
  6C54'   33             C      	INC	SP
  6C55'   C3 6BB1'       C      	JP	UR.ZINP2	;unerlaubter Tastencode
  6C58'                  C      UR.ALPHA:
  6C58'   FE 41          C      	CP	41H
  6C5A'   D8             C      	RET	C
  6C5B'   FE 5B          C      	CP	5BH
  6C5D'   38 02          C      	JR	C,UR.ALPH1
  6C5F'   37             C      	SCF
  6C60'   C9             C      	RET
  6C61'                  C      UR.ALPH1:
  6C61'   3F             C      	CCF
  6C62'   C9             C      	RET
  6C63'                  C      UR.NUM:
  6C63'   FE 30          C      	CP	30H
  6C65'   D8             C      	RET	C
  6C66'   FE 3A          C      	CP	3AH
  6C68'   38 F7          C      	JR	C,UR.ALPH1
  6C6A'   37             C      	SCF
  6C6B'   C9             C      	RET
  6C6C'                  C      UR.ALPNU:
  6C6C'   CD 6C58'       C      	CALL	UR.ALPHA
  6C6F'   D0             C      	RET	NC
  6C70'   CD 6C63'       C      	CALL	UR.NUM
  6C73'   D0             C      	RET	NC
  6C74'   37             C      	SCF
  6C75'   C9             C      	RET
  6C76'                  C      UR.HEXAZ:
  6C76'   CD 6C63'       C      	CALL	UR.NUM
  6C79'   D0             C      	RET	NC
  6C7A'   FE 41          C      	CP	'A'
  6C7C'   D8             C      	RET	C
  6C7D'   FE 47          C      	CP	'G'
  6C7F'   38 02          C      	JR	C,UR.HEXZ1
  6C81'   37             C      	SCF
  6C82'   C9             C      	RET
  6C83'                  C      UR.HEXZ1:
  6C83'   3F             C      	CCF
  6C84'   C9             C      	RET
                         C      
'Routinen fuer Kassette,Monitor UND Tastatur'	MACRO-80 3.44	09-Dec-81	PAGE	1-62


  6C85'                  C      UR.TAREP:
  6C85'   CD 4026        C      	CALL	TA.ABFR1	;TASTATURROUTINE FUER ATS
  6C88'   28 FB          C      	JR	Z,$-3	;ES LIEGT KEIN ZEICHEN AN
  6C8A'   C9             C      	RET
                         C      
  6C8B'                  C      UR.BILRO:
  6C8B'   C5             C      	PUSH	BC
  6C8C'   D5             C      	PUSH	DE
  6C8D'   E5             C      	PUSH	HL
  6C8E'   01 03C0        C      	LD	BC,960
  6C91'   11 3370        C      	LD	DE,UE.BWSA+880
  6C94'   21 33C0        C      	LD	HL,UE.BWSA+960
  6C97'   ED B0          C      	LDIR
  6C99'   3E 20          C      	LD	A,20H	;letzte Zeile loeschen
  6C9B'   06 50          C      	LD	B,80
  6C9D'                  C      UR.BILR1:
  6C9D'   12             C      	LD	(DE),A
  6C9E'   10 FD          C      	DJNZ	UR.BILR1
  6CA0'   E1             C      	POP	HL
  6CA1'   AF             C      	XOR	A
  6CA2'   01 0050        C      	LD	BC,80
  6CA5'   ED 42          C      	SBC	HL,BC	;aktuelle BWS-Adresse nach  ROLL
  6CA7'   3A 2B00'       C      	LD	A,(UB.ZN)
  6CAA'   D1             C      	POP	DE
  6CAB'   C1             C      	POP	BC
  6CAC'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                                ;	
                                ;	INCLUDE	U1.MAC	;Allgemeine Unterprogramme
                                ;	INCLUDE	XY.MAC	;Handling f. IX/IY-adressierte Bereiche
                                ;	INCLUDE	UC.MAC	;Konvertierungen
                                ;	INCLUDE	CP.MAC	;Komprimierung
                                ;	INCLUDE	DC.MAC	;Dekomprimierung
                                ;	INCLUDE	UK.MAC	;Einzelzeicheneingabe fuer KMBG
                         C      	INCLUDE K8.MAC	;Allgemeine Unterprogramme
                         C      	TITLE	'Allgemeine Unterprogramme'
                         C      	PAGE
'Allgemeine Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-63


                         C      
                         C      ;	PN	U1
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;        Allgemeine Unterprogramme
                         C      ;
                         C      ;----------------------------------------------------------------------
  6CAD'                  C      U1.RSAVE:
  6CAD'   E3             C      	EX	(SP),HL	;Register retten (nicht AF)
  6CAE'   D5             C      	PUSH	DE
  6CAF'   C5             C      	PUSH	BC
  6CB0'   FD E5          C      	PUSH	IY
  6CB2'   DD E5          C      	PUSH	IX
  6CB4'   E9             C      	JP	(HL)
  6CB5'                  C      U1.RRST:
  6CB5'   E1             C      	POP	HL	;Register wieder herstellen
  6CB6'   DD E1          C      	POP	IX
  6CB8'   FD E1          C      	POP	IY
  6CBA'   C1             C      	POP	BC
  6CBB'   D1             C      	POP	DE
  6CBC'   E3             C      	EX	(SP),HL
  6CBD'   C9             C      	RET
  6CBE'                  C      U1.CLRB:
  6CBE'   E5             C      	PUSH	HL	;Bereich loeschen
  6CBF'   D5             C      	PUSH	DE
  6CC0'   C5             C      	PUSH	BC
  6CC1'   E5             C      	PUSH	HL	;IN:  HL= Bereichsanfang
  6CC2'   D1             C      	POP	DE	;     BC= Bereichslaenge
  6CC3'   13             C      	INC	DE
  6CC4'   AF             C      	XOR	A
  6CC5'   77             C      	LD	(HL),A
  6CC6'   0B             C      	DEC	BC
  6CC7'   ED B0          C      	LDIR
  6CC9'   C1             C      	POP	BC
  6CCA'   D1             C      	POP	DE
  6CCB'   E1             C      	POP	HL
  6CCC'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  6CCD'                  C      U1.KBR4:
  6CCD'   C5             C      	PUSH	BC
  6CCE'   06 04          C      	LD	B,4
  6CD0'   CD 6AE7'       C      	CALL	UR.KBR
  6CD3'   10 FB          C      	DJNZ	$-3
  6CD5'   C1             C      	POP	BC
  6CD6'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  6CD7'                  C      U1.WAIT:
                         C      	; PUSH	AF
                         C      	; CALL	UE.BERT
                         C      	; JR	C,$-3
                         C      	; POP	AF
  6CD7'   C9             C      	RET
                         C      ;--------------------------------------------------------------------
  6CD8'                  C      U1.BREAD:
  6CD8'   CD 6D1B'       C      	CALL	U1.EIN	;BLOCK LESEN VON EINGABE
  6CDB'   DD 36 05 02    C      	LD	(IX+5),02H
  6CDF'   CD 5668'       C      	CALL	UF.EXEC
  6CE2'   C9             C      	RET
  6CE3'                  C      U1.BWRIT:
  6CE3'   CD 6D24'       C      	CALL	U1.AUS	;BLOCK SCHREIBEN AUF AUSGABE
  6CE6'   DD 36 05 08    C      	LD	(IX+5),08H
  6CEA'   CD 5668'       C      	CALL	UF.EXEC
  6CED'   C9             C      	RET
  6CEE'                  C      U1.COPB2:
  6CEE'   F5             C      	PUSH	AF
  6CEF'   37             C      	SCF
  6CF0'   18 02          C      	JR	$+4
  6CF2'                  C      U1.COPB:
  6CF2'   F5             C      	PUSH	AF
  6CF3'   B7             C      	OR	A
  6CF4'   CD 6D1B'       C      	CALL	U1.EIN
  6CF7'   DD 36 05 02    C      	LD	(IX+5),02H
  6CFB'   DC 6754'       C      	CALL	C,KX.EXEC2
  6CFE'   D4 5668'       C      	CALL	NC,UF.EXEC
  6D01'   F5             C      	PUSH	AF
  6D02'   CD 6D24'       C      	CALL	U1.AUS
  6D05'   DD 7E 09       C      	LD	A,(IX+9)
  6D08'   DD B6 0A       C      	OR	(IX+10)
  6D0B'   28 08          C      	JR	Z,$+10
  6D0D'   CD 6CE3'       C      	CALL	U1.BWRIT
  6D10'   F1             C      	POP	AF
  6D11'   38 DC          C      	JR	C,$-34
'Allgemeine Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-64


  6D13'   30 DE          C      	JR	NC,$-32
  6D15'   CD 6AD5'       C      	CALL	UR.KBM
  6D18'   F1             C      	POP	AF
  6D19'   F1             C      	POP	AF
  6D1A'   C9             C      	RET
  6D1B'                  C      U1.EIN:
  6D1B'   F5             C      	PUSH	AF
  6D1C'   3A E000        C      	LD	A,(BC.TAB1)
  6D1F'   DD 77 03       C      	LD	(IX+3),A
  6D22'   F1             C      	POP	AF
  6D23'   C9             C      	RET
  6D24'                  C      U1.AUS:
  6D24'   F5             C      	PUSH	AF
  6D25'   3A E001        C      	LD	A,(BC.TAB1+1)
  6D28'   DD 77 03       C      	LD	(IX+3),A
  6D2B'   F1             C      	POP	AF
  6D2C'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  6D2D'                  C      U1.VS1:
  6D2D'   E5             C      	PUSH	HL
  6D2E'   C5             C      	PUSH	BC
  6D2F'   F5             C      	PUSH	AF
  6D30'   3E 01          C      	LD	A,01H	;1.DATEIVORSATZ IM PUFFER
  6D32'   18 04          C      	JR	$+6
  6D34'                  C      U1.VSX:
  6D34'   E5             C      	PUSH	HL
  6D35'   C5             C      	PUSH	BC
  6D36'   F5             C      	PUSH	AF
  6D37'   AF             C      	XOR	A	;00-DATEIVORSATZ IM PUFFER
  6D38'   06 20          C      	LD	B,32
  6D3A'   21 0E66        C      	LD	HL,UE.PUF
  6D3D'   CD 6E4C'       C      	CALL	U1.TR
  6D40'   F1             C      	POP	AF
  6D41'   C1             C      	POP	BC
  6D42'   E1             C      	POP	HL
  6D43'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  6D44'                  C      U1.DSVG:
  6D44'   E5             C      	PUSH	HL
  6D45'   D5             C      	PUSH	DE
  6D46'   F5             C      	PUSH	AF
  6D47'   06 07          C      	LD	B,7	;MRES KASSETTE ?
  6D49'   CD 6DE8'       C      	CALL	U1.VORS1
  6D4C'   11 0E6C        C      	LD	DE,UE.PUF+6
  6D4F'   21 5747'       C      	LD	HL,UA.DS+6
  6D52'   06 0E          C      	LD	B,14
  6D54'   1A             C      	LD	A,(DE)
  6D55'   BE             C      	CP	(HL)
  6D56'   20 10          C      	JR	NZ,$+18
  6D58'   13             C      	INC	DE
  6D59'   23             C      	INC	HL
  6D5A'   10 F8          C      	DJNZ	$-6
  6D5C'   3A 0E67        C      	LD	A,(UE.PUF+1)
  6D5F'   4F             C      	LD	C,A	;C <-- NEXT RECORD
  6D60'   3A 0E69        C      	LD	A,(UE.PUF+3)
  6D63'   47             C      	LD	B,A	;B <-- ANZ.VERZ.EINTRAG.
  6D64'   F1             C      	POP	AF
  6D65'   D1             C      	POP	DE
  6D66'   E1             C      	POP	HL
  6D67'   C9             C      	RET
  6D68'   F1             C      	POP	AF
  6D69'   D1             C      	POP	DE
  6D6A'   E1             C      	POP	HL
  6D6B'   FD E1          C      	POP	IY
  6D6D'   3E 90          C      	LD	A,90H
  6D6F'   CD 5697'       C      	CALL	UF.ERANZ
  6D72'   C3 000B        C      	JP	UE.SYSTB
                         C      ;----------------------------------------------------------------------
  6D75'                  C      U1.NMVGL:
  6D75'   C5             C      	PUSH	BC
  6D76'   D5             C      	PUSH	DE
  6D77'   E5             C      	PUSH	HL
  6D78'   06 06          C      	LD	B,6
  6D7A'   11 0E66        C      	LD	DE,UE.PUF
  6D7D'   1A             C      	LD	A,(DE)
  6D7E'   BE             C      	CP	(HL)	;HL:ZU SUCHENDER PROGR.NAME
  6D7F'   20 0C          C      	JR	NZ,$+14
  6D81'   23             C      	INC	HL
  6D82'   13             C      	INC	DE
  6D83'   10 F8          C      	DJNZ	$-6
  6D85'   3A 0E7D        C      	LD	A,(UE.PUF+23)	;LABELNR. -->A
  6D88'   37             C      	SCF		;CY=1,WENN PROGR. GEFUNDEN
  6D89'   E1             C      	POP	HL
'Allgemeine Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-65


  6D8A'   D1             C      	POP	DE
  6D8B'   C1             C      	POP	BC
  6D8C'   C9             C      	RET
  6D8D'   B7             C      	OR	A
  6D8E'   18 F9          C      	JR	$-5
                         C      ;----------------------------------------------------------------------
  6D90'                  C      U1.KTINI:
  6D90'   E5             C      	PUSH	HL
  6D91'   C5             C      	PUSH	BC
  6D92'   F5             C      	PUSH	AF
  6D93'   CD 6E57'       C      	CALL	U1.BILO	;UNTERE HAELFTE BS LOESCHEN
  6D96'   DD 21 2B01'    C      	LD	IX,UB.KTAB	;ADR. STEUERTAB. F.KASS.ROUTINE
  6D9A'   DD E5          C      	PUSH	IX
  6D9C'   E1             C      	POP	HL
  6D9D'   AF             C      	XOR	A
  6D9E'   06 1B          C      	LD	B,27
  6DA0'   CD 6E4C'       C      	CALL	U1.TR	;TAB. AUF 00 LOESCHEN
  6DA3'   DD 36 03 30    C      	LD	(IX+3),30H
                         C      ;	CALL	UE.KINI
  6DA7'   18 03          C      	JR	$+5
  6DA9'                  C      U1.KTIN1:
  6DA9'   E5             C      	PUSH	HL
  6DAA'   C5             C      	PUSH	BC
  6DAB'   F5             C      	PUSH	AF
                         C      ;	LD	(IX+11),7	;ANZAHL LESE/SCHREIBWDHLGNN
                         C      ;	LD	(IX+12),4	;ANZAHL
  6DAC'   21 0E66        C      	LD	HL,UE.PUF
  6DAF'   CD 6ED7'       C      	CALL	XY.STIDX
  6DB2'   07             C      	DB	7	;SYSTEMPUFFERADR.-->TAB
  6DB3'   21 8010        C      	LD	HL,UE.KPUFF
  6DB6'   CD 6EC7'       C      	CALL	XY.STDX
  6DB9'   19             C      	DB	25	;E/A PUFFERADR.-->TAB	;???
  6DBA'   F1             C      	POP	AF
  6DBB'   C1             C      	POP	BC
  6DBC'   E1             C      	POP	HL
  6DBD'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  6DBE'                  C      U1.VERIN:
  6DBE'   E5             C      	PUSH	HL
  6DBF'   C5             C      	PUSH	BC
  6DC0'   F5             C      	PUSH	AF
  6DC1'   11 EC82        C      	LD	DE,BC.VTABE	;VERZ. EINGABEGER. EINLESEN
  6DC4'   18 03          C      	JR	$+5
  6DC6'                  C      U1.VERNI:
  6DC6'   E5             C      	PUSH	HL
  6DC7'   C5             C      	PUSH	BC
  6DC8'   F5             C      	PUSH	AF
  6DC9'   3A 0E69        C      	LD	A,(UE.PUF+3)	;ANZ. DATEIEN-->B
  6DCC'   47             C      	LD	B,A
  6DCD'   C5             C      	PUSH	BC
  6DCE'   21 0E66        C      	LD	HL,UE.PUF
  6DD1'   01 0020        C      	LD	BC,32
  6DD4'   ED B0          C      	LDIR
  6DD6'   CD 5668'       C      	CALL	UF.EXEC
  6DD9'   C1             C      	POP	BC
  6DDA'   10 F1          C      	DJNZ	$-13
  6DDC'   F1             C      	POP	AF
  6DDD'   C1             C      	POP	BC
  6DDE'   E1             C      	POP	HL
  6DDF'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  6DE0'                  C      U1.VORST:
  6DE0'   C5             C      	PUSH	BC
  6DE1'   CD 6ABF'       C      	CALL	UR.KRWW
  6DE4'   06 06          C      	LD	B,6
  6DE6'   18 01          C      	JR	$+3
  6DE8'                  C      U1.VORS1:
  6DE8'   C5             C      	PUSH	BC
  6DE9'   DD 36 05 02    C      	LD	(IX+5),02H
  6DED'   CD 5668'       C      	CALL	UF.EXEC
  6DF0'   10 FB          C      	DJNZ	$-3
  6DF2'   C1             C      	POP	BC
  6DF3'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  6DF4'                  C      U1.VZS:
  6DF4'   D5             C      	PUSH	DE
  6DF5'   C5             C      	PUSH	BC
  6DF6'   E5             C      	PUSH	HL
  6DF7'   F5             C      	PUSH	AF
  6DF8'   CD 6AE1'       C      	CALL	UR.KBV
  6DFB'   CD 6AE7'       C      	CALL	UR.KBR
  6DFE'   11 0E66        C      	LD	DE,UE.PUF
  6E01'   01 0006        C      	LD	BC,6
'Allgemeine Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-66


  6E04'   ED B0          C      	LDIR		;PROGR.NAME --> PUFFER
  6E06'   3A 2B1E'       C      	LD	A,(UB.PAR2)	;DATEITYP
  6E09'   12             C      	LD	(DE),A
  6E0A'   13             C      	INC	DE
  6E0B'   3E 44          C      	LD	A,'D'
  6E0D'   12             C      	LD	(DE),A
  6E0E'   13             C      	INC	DE
  6E0F'   3A 2B20'       C      	LD	A,(UB.PAR3)
  6E12'   FE 7F          C      	CP	7FH
  6E14'   20 0F          C      	JR	NZ,$+17
  6E16'   21 5787'       C      	LD	HL,UA.KOMMT	;FRAGE KOMMENTAR WENN PAR3=7F
  6E19'   CD 6B59'       C      	CALL	UR.MIMO
  6E1C'   01 0006        C      	LD	BC,6
  6E1F'   ED B0          C      	LDIR
  6E21'   06 09          C      	LD	B,9
  6E23'   18 02          C      	JR	$+4
  6E25'   06 0F          C      	LD	B,15
  6E27'   3E 20          C      	LD	A,' '
  6E29'   12             C      	LD	(DE),A
  6E2A'   13             C      	INC	DE
  6E2B'   10 FC          C      	DJNZ	$-2
  6E2D'   3A 2B1C'       C      	LD	A,(UB.PAR1)
  6E30'   12             C      	LD	(DE),A
  6E31'   13             C      	INC	DE
  6E32'   06 08          C      	LD	B,8
  6E34'   AF             C      	XOR	A
  6E35'   12             C      	LD	(DE),A
  6E36'   13             C      	INC	DE
  6E37'   10 FC          C      	DJNZ	$-2
  6E39'   21 0020        C      	LD	HL,32
  6E3C'   CD 6ED7'       C      	CALL	XY.STIDX
  6E3F'   09             C      	DB	9
  6E40'   DD 36 05 08    C      	LD	(IX+5),08H
  6E44'   CD 5668'       C      	CALL	UF.EXEC
  6E47'   F1             C      	POP	AF
  6E48'   E1             C      	POP	HL
  6E49'   C1             C      	POP	BC
  6E4A'   D1             C      	POP	DE
  6E4B'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  6E4C'                  C      U1.TR:
  6E4C'   77             C      	LD	(HL),A	;A=INHALT
  6E4D'   23             C      	INC	HL
  6E4E'   10 FC          C      	DJNZ	U1.TR	;B=ANZAHL
  6E50'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  6E51'                  C      U1.INFO:
  6E51'   01 000E        C      	LD	BC,14
  6E54'   ED B0          C      	LDIR
  6E56'   C9             C      	RET
  6E57'                  C      U1.BILO:
  6E57'   CD 6CAD'       C      	CALL	U1.RSAVE
  6E5A'   21 3370        C      	LD	HL,SD.BWSA + 11*80	;3370H
  6E5D'   01 040F        C      	LD	BC,13*80 - 1	;1120  ( -80 ... eine Zeile )
  6E60'   36 20          C      	LD	(HL),20H
  6E62'   54             C      	LD	D,H
  6E63'   5D             C      	LD	E,L
  6E64'   13             C      	INC	DE
  6E65'   ED B0          C      	LDIR
  6E67'   CD 6CB5'       C      	CALL	U1.RRST
  6E6A'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  6E6B'                  C      U1.TST:
  6E6B'   B7             C      	OR	A
  6E6C'   D6 30          C      	SUB	30H
  6E6E'   47             C      	LD	B,A
  6E6F'   05             C      	DEC	B
  6E70'   C8             C      	RET	Z
  6E71'   05             C      	DEC	B
  6E72'   C8             C      	RET	Z
  6E73'   37             C      	SCF
  6E74'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  6E75'                  C      U1.PRADR:
  6E75'   E5             C      	PUSH	HL
  6E76'   C5             C      	PUSH	BC
  6E77'   06 04          C      	LD	B,4
  6E79'   7E             C      	LD	A,(HL)
  6E7A'   FE 20          C      	CP	' '
  6E7C'   28 07          C      	JR	Z,$+9
  6E7E'   23             C      	INC	HL
  6E7F'   10 F8          C      	DJNZ	$-6
  6E81'   B7             C      	OR	A
'Allgemeine Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-67


  6E82'   C1             C      	POP	BC
  6E83'   E1             C      	POP	HL
  6E84'   C9             C      	RET
  6E85'   37             C      	SCF
  6E86'   21 2B00'       C      	LD	HL,UB.ZN
  6E89'   35             C      	DEC	(HL)
  6E8A'   18 F6          C      	JR	$-8
                         C      ;---------------------------------------------------------------------
  6E8C'                  C      U1.KRWE:
  6E8C'   CD 6AB1'       C      	CALL	UR.KRE
  6E8F'   CD 6ABF'       C      	CALL	UR.KRWW
  6E92'   C9             C      	RET
                         C      ;---------------------------------------------------------------------
                         C      ;	END
                         C      	TITLE 'Handling f. IX/IY-adressierte Bereiche'
                         C      	PAGE
'Handling f. IX/IY-adressierte Bereiche'	MACRO-80 3.44	09-Dec-81	PAGE	1-68


                         C      
                         C      ;	PN	XY ; Unterprogramme
                         C      ;**********************************************************************
                         C      ;*                                                                    *
                         C      ;*       Handling f. IX/IY-adressierte Steuer-Bloecke bzw.            *
                         C      ;*                                     Arbeits-Bereiche               *
                         C      ;*                                                                    *
                         C      ;*--------------------------------------------------------------------*
                         C      ;*                                                                    *
                         C      ;*       Ausser den angegebenen Registern bzw. Flags wird nur noch    *
                         C      ;*       die angegebene Anzahl der ersten freien Stack-Plaetze (je    *
                         C      ;*       Byte) veraendert. Weiterer RAM-Platz wird nicht benoetigt.   *
                         C      ;*                                                                    *
                         C      ;**********************************************************************
                         C      ;*                                                                    *
                         C      ;*       Technische (Hilfs-) Unter-Programme                          *
                         C      ;*                                                                    *
                         C      ;**********************************************************************
                         C      			;
                         C      ;        Uebernahme von nach dem CALL stehenden Parameter
                         C      ;        ++++++++++++++++++++++++++++++++++++++++++++++++
                         C      ;        erwarten Stack:           Return-Adresse f.uebergeordnetes UP
                         C      ;                       (SP) -->   Return-Adresse f.CALPn
                         C      ;        geben Stack zurueck:      Return-Adresse f.uebergeordn.UP + n
                         C      ;                                  (DE)
                         C      ;                       (SP) -->   (HL)
                         C      ;        geben in Reg.zurueck:     (DE):  Wert    1.Parameter-Byte
                         C      ;                                  (HL):  Adresse 2.Parameter-Byte
                         C      ;        --------------------------------------------------------------
                         C      			;
  6E93'                  C      XY.CALP1	EQU	$	; 1 Byte-Parameter
                         C      			; ++++++++++++++++++++++++++++++
  6E93'   E5             C      	PUSH	HL	; Retten HL
  6E94'   E1             C      	POP	HL
                         C      			;
  6E95'   EB             C      	EX	DE,HL	; DE <--> RET-Adr.f.CALPn
  6E96'   E3             C      	EX	(SP),HL
  6E97'   EB             C      	EX	DE,HL
                         C      			;
  6E98'   E1             C      	POP	HL	; (SP) --> RET-Adr.f.ueberg.UP
                         C      			;
  6E99'   E1             C      	POP	HL	; Laden u. korrig. ...
  6E9A'   23             C      	INC	HL
  6E9B'   E5             C      	PUSH	HL
  6E9C'                  C      XY.CALPE:
  6E9C'   2B             C      	DEC	HL
                         C      			;
  6E9D'   3B             C      	DEC	SP	; (SP) --> (DE)
  6E9E'   3B             C      	DEC	SP
  6E9F'   3B             C      	DEC	SP	; (SP) --> (HL)
  6EA0'   3B             C      	DEC	SP
                         C      			;
  6EA1'   D5             C      	PUSH	DE	; RET-Adr.f.CALPn
                         C      			;
  6EA2'   5E             C      	LD	E,(HL)	; Laden DE, HL
  6EA3'   16 00          C      	LD	D,0
  6EA5'   23             C      	INC	HL
                         C      			;
  6EA6'   C9             C      	RET
                         C      			;
                         C      			;
                         C      ;**********************************************************************
                         C      ;*                                                                    *
                         C      ;*       Lade-, Speicher- und Transport-Unterprogramme                *
                         C      ;*                                                                    *
                         C      ;**********************************************************************
                         C      ;
                         C      ;    CALL  LDDX    'Load':              HL := (IX+d)
                         C      ;    DB    d                                              Stack: 4
                         C      ;    -----------   ----------------------------------------------------
                         C      			;
  6EA7'                  C      XY.LDDX:
  6EA7'   CD 6E93'       C      	CALL	XY.CALP1	; Uebernahme d
                         C      			;
  6EAA'   DD E5          C      	PUSH	IX	; HL := IX+d
  6EAC'   E1             C      	POP	HL	;               <--- LDDY
  6EAD'   F5             C      	PUSH	AF
  6EAE'   19             C      	ADD	HL,DE
  6EAF'   F1             C      	POP	AF
                         C      			;
  6EB0'   5E             C      	LD	E,(HL)	; HL := (IX+d)
  6EB1'   23             C      	INC	HL
'Handling f. IX/IY-adressierte Bereiche'	MACRO-80 3.44	09-Dec-81	PAGE	1-69


  6EB2'   56             C      	LD	D,(HL)
  6EB3'   EB             C      	EX	DE,HL
                         C      			;
  6EB4'   D1             C      	POP	DE	; Return
  6EB5'   D1             C      	POP	DE
  6EB6'   C9             C      	RET
                         C      			;
                         C      ;**********************************************************************
                         C      ;
                         C      ;    CALL  LIDX    'Load inverse':      LH := (IX+d)
                         C      ;    DB    d                                              Stack: 4
                         C      ;    -----------   ----------------------------------------------------
                         C      			;
  6EB7'                  C      XY.LIDX:
  6EB7'   CD 6E93'       C      	CALL	XY.CALP1	; Uebernahme d
                         C      			;
  6EBA'   DD E5          C      	PUSH	IX	; HL := IX+d
  6EBC'   E1             C      	POP	HL	;               <--- LIDY
  6EBD'   F5             C      	PUSH	AF
  6EBE'   19             C      	ADD	HL,DE
  6EBF'   F1             C      	POP	AF
                         C      			;
  6EC0'   56             C      	LD	D,(HL)	; LH := (IX+d)
  6EC1'   23             C      	INC	HL
  6EC2'   5E             C      	LD	E,(HL)
  6EC3'   EB             C      	EX	DE,HL
                         C      			;
  6EC4'   D1             C      	POP	DE	; Return
  6EC5'   D1             C      	POP	DE
  6EC6'   C9             C      	RET
                         C      			;
                         C      ;**********************************************************************
                         C      ;
                         C      ;    CALL  STDX    'Store':            (IX+d) := HL
                         C      ;    DB    d                                                  Stack: 4
                         C      ;    -----------   ----------------------------------------------------
                         C      			;
  6EC7'                  C      XY.STDX:
  6EC7'   CD 6E93'       C      	CALL	XY.CALP1	; Uebernahme d
                         C      			;
  6ECA'   DD E5          C      	PUSH	IX	; HL := IX+d
  6ECC'   E1             C      	POP	HL	;               <--- STDY
  6ECD'   F5             C      	PUSH	AF
  6ECE'   19             C      	ADD	HL,DE
  6ECF'   F1             C      	POP	AF
                         C      			;
  6ED0'   D1             C      	POP	DE
  6ED1'   73             C      	LD	(HL),E	; (IX+d) := HL
  6ED2'   23             C      	INC	HL
  6ED3'   72             C      	LD	(HL),D
  6ED4'   EB             C      	EX	DE,HL
                         C      			;
  6ED5'   D1             C      	POP	DE	; Return
  6ED6'   C9             C      	RET
                         C      			;
                         C      ;**********************************************************************
                         C      ;
                         C      ;    CALL  STIDX    'Store inverse':    (IX+d) := LH
                         C      ;    DB    d                                                  Stack: 4
                         C      ;    -----------   ----------------------------------------------------
                         C      			;
  6ED7'                  C      XY.STIDX:
  6ED7'   CD 6E93'       C      	CALL	XY.CALP1	; Uebernahme d
                         C      			;
  6EDA'   DD E5          C      	PUSH	IX	; HL := IX+d
  6EDC'   E1             C      	POP	HL	;               <--- STIDY
  6EDD'   F5             C      	PUSH	AF
  6EDE'   19             C      	ADD	HL,DE
  6EDF'   F1             C      	POP	AF
                         C      			;
  6EE0'   D1             C      	POP	DE
  6EE1'   72             C      	LD	(HL),D	; (IX+d) := LH
  6EE2'   23             C      	INC	HL
  6EE3'   73             C      	LD	(HL),E
  6EE4'   EB             C      	EX	DE,HL
                         C      			;
  6EE5'   D1             C      	POP	DE	; Return
  6EE6'   C9             C      	RET
                         C      			;
                         C      ;**********************************************************************
                         C      ;
                         C      ;    CALL  INCDX    'Increment':        (IX+d) := (IX+d) + 1
                         C      ;    DB    d                                    Flags wie ADC HL,...
'Handling f. IX/IY-adressierte Bereiche'	MACRO-80 3.44	09-Dec-81	PAGE	1-70


                         C      ;                                                             Stack: 4
                         C      ;    -----------   ----------------------------------------------------
                         C      			;
  6EE7'                  C      XY.INCDX:
  6EE7'   CD 6E93'       C      	CALL	XY.CALP1	; Uebernahme d
                         C      			;
  6EEA'   DD E5          C      	PUSH	IX	; HL := IX+d
  6EEC'   E1             C      	POP	HL	;               <--- INCDY
  6EED'   19             C      	ADD	HL,DE
                         C      			;
  6EEE'   5E             C      	LD	E,(HL)	; DE := (IX+d)
  6EEF'   23             C      	INC	HL
  6EF0'   56             C      	LD	D,(HL)
                         C      			;
  6EF1'   E5             C      	PUSH	HL	; DE := (IX+d) + 1
  6EF2'   21 0001        C      	LD	HL,1
  6EF5'   B7             C      	OR	A
  6EF6'   ED 5A          C      	ADC	HL,DE
  6EF8'   EB             C      	EX	DE,HL
  6EF9'   E1             C      	POP	HL
  6EFA'   72             C      	LD	(HL),D
  6EFB'   2B             C      	DEC	HL
  6EFC'   73             C      	LD	(HL),E
                         C      			;
  6EFD'   E1             C      	POP	HL	; Return
  6EFE'   D1             C      	POP	DE
  6EFF'   C9             C      	RET
                         C      			;
                         C      ;**********************************************************************
                         C      ;*                                                                    *
                         C      ;*       Unterprogramm  'Unbedingter Sprung'                          *
                         C      ;*                                                                    *
                         C      ;**********************************************************************
                         C      ;
                         C      ;    CALL  JMPDX   'Jump':              JMP  (IX+d)
                         C      ;    DB    d                                              Stack: 4
                         C      ;                                       Achtung!
                         C      ;                                           Veraendert freie Stack-Pl.
                         C      ;    -----------   ----------------------------------------------------
                         C      			;
  6F00'                  C      XY.JMPDX:
  6F00'   CD 6E93'       C      	CALL	XY.CALP1	; Uebernahme d
                         C      			;
  6F03'   DD E5          C      	PUSH	IX	; HL := IX+d
  6F05'   E1             C      	POP	HL	;               <--- JMPDY
  6F06'   F5             C      	PUSH	AF
  6F07'   19             C      	ADD	HL,DE
  6F08'   F1             C      	POP	AF
                         C      			;
  6F09'   5E             C      	LD	E,(HL)	; HL := (IX+d)
  6F0A'   23             C      	INC	HL
  6F0B'   56             C      	LD	D,(HL)
  6F0C'   EB             C      	EX	DE,HL
                         C      			;
  6F0D'   D1             C      	POP	DE	; Return = Jump
  6F0E'   E3             C      	EX	(SP),HL
  6F0F'   EB             C      	EX	DE,HL
  6F10'   C9             C      	RET
                         C      			;
                         C      ;**********************************************************************
                         C      ;	END
                         C      	TITLE 'Konvertierungen'
                         C      	PAGE
'Konvertierungen'	MACRO-80 3.44	09-Dec-81	PAGE	1-71


                         C      
                         C      ;	PN	UC
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;       KONVERTIERUNGEN
                         C      ;
                         C      ;----------------------------------------------------------------------
                         C      ;                            HL := HL * 10
                         C      ;                                      (ohne Kontrolle auf Uebertrag)
  6F11'                  C      UC.HL10N:
  6F11'   E5             C      	PUSH	HL
  6F12'   D1             C      	POP	DE	; alter Wert in DE
  6F13'   29             C      	ADD	HL,HL
  6F14'   29             C      	ADD	HL,HL
  6F15'   19             C      	ADD	HL,DE
  6F16'   29             C      	ADD	HL,HL
  6F17'   C9             C      	RET
                         C      ;                            HL := HL * 10
                         C      ;                                            -->  C: Uebertrag in A
  6F18'                  C      UC.HL10C:
  6F18'   E5             C      	PUSH	HL
  6F19'   D1             C      	POP	DE	; alter Wert in DE
  6F1A'   AF             C      	XOR	A
  6F1B'   29             C      	ADD	HL,HL
  6F1C'   30 01          C      	JR	NC,$+3
  6F1E'   3C             C      	INC	A
  6F1F'   87             C      	ADD	A,A
  6F20'   29             C      	ADD	HL,HL
  6F21'   30 01          C      	JR	NC,$+3
  6F23'   3C             C      	INC	A
  6F24'   19             C      	ADD	HL,DE
  6F25'   30 01          C      	JR	NC,$+3
  6F27'   3C             C      	INC	A
  6F28'   87             C      	ADD	A,A
  6F29'   29             C      	ADD	HL,HL
  6F2A'   30 01          C      	JR	NC,$+3
  6F2C'   3C             C      	INC	A
  6F2D'   B7             C      	OR	A
  6F2E'   C8             C      	RET	Z
  6F2F'   37             C      	SCF
  6F30'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      ;                            Division mit Rest:  A  := HL / DE
                         C      ;                                                HL := Rest
                         C      			;      Cy(A) --->  A=255
                         C      			;-------------------------------
  6F31'                  C      UC.DIVR:
  6F31'   AF             C      	XOR	A
  6F32'   ED 52          C      	SBC	HL,DE
  6F34'   3C             C      	INC	A
  6F35'   20 03          C      	JR	NZ,$+5
  6F37'   3D             C      	DEC	A
  6F38'   38 03          C      	JR	C,$+5
  6F3A'   30 F6          C      	JR	NC,$-8
  6F3C'   3D             C      	DEC	A
  6F3D'   19             C      	ADD	HL,DE
  6F3E'   C9             C      	RET
                         C      			;
                         C      ;**********************************************************************
                         C      ;*                                                                    *
                         C      ;*       CV...               Konvertierungen     (convert ...)        *
                         C      ;*                                                                    *
                         C      ;*--------------------------------------------------------------------*
                         C      ;*       ..A..:              in A                                     *
                         C      ;*       ..?*.:              von Typ *                                *
                         C      ;*       ..?.*:              nach Typ *                               *
                         C      ;*                                                                    *
                         C      ;*       Typen:              B - binaer                               *
                         C      ;*                           X - hexadezimal ASCII                    *
                         C      ;*                           A - Adresse binaer (L,H)                 *
                         C      ;*                           D - dezimal ASCII                        *
                         C      ;*                                                                    *
                         C      ;**********************************************************************
                         C      			;
                         C      ;                            In A:      Binaer < 16 --> ASCII hexa
                         C      ;                            ------------------------------------------
  6F3F'                  C      UC.CVABX:
  6F3F'   E6 0F          C      	AND	0FH
  6F41'   F6 30          C      	OR	30H
  6F43'   FE 3A          C      	CP	3AH
  6F45'   D8             C      	RET	C
'Konvertierungen'	MACRO-80 3.44	09-Dec-81	PAGE	1-72


  6F46'   C6 07          C      	ADD	A,7H
  6F48'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      ;                            Byte binaer (HL) --> 2 ASCII hexa (DE)
                         C      ;                                                            HL+1, DE+2
                         C      ;                            ------------------------------------------
  6F49'                  C      UC.CVBX:
  6F49'   7E             C      	LD	A,(HL)
  6F4A'   23             C      	INC	HL	; benutzt: A, 2 Stack-P.
                         C      			;
  6F4B'   F5             C      	PUSH	AF	;ENTRY,WENN ZEICHEN IN A
  6F4C'   0F             C      	RRCA
  6F4D'   0F             C      	RRCA
  6F4E'   0F             C      	RRCA
  6F4F'   0F             C      	RRCA
  6F50'   CD 6F54'       C      	CALL	$+4
  6F53'   F1             C      	POP	AF
                         C      			;
  6F54'   CD 6F3F'       C      	CALL	UC.CVABX
  6F57'   12             C      	LD	(DE),A
  6F58'   13             C      	INC	DE
  6F59'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      ;                       Adresse (L,H) binaer (HL) --> 4 ASCII hexa (DE)
                         C      ;                                                            HL+2, DE+4
                         C      ;                       -----------------------------------------------
  6F5A'                  C      UC.CVAX:
  6F5A'   23             C      	INC	HL
  6F5B'   CD 6F49'       C      	CALL	UC.CVBX	; benutzt: A, 3 Stack-P.
  6F5E'   2B             C      	DEC	HL
  6F5F'   2B             C      	DEC	HL
  6F60'   CD 6F49'       C      	CALL	UC.CVBX
  6F63'   23             C      	INC	HL
  6F64'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      ;                       Adresse aus HL, binaer    --> 4 ASCII hexa (DE)
                         C      ;                                                                  DE+4
                         C      ;                       -----------------------------------------------
  6F65'                  C      UC.CVHLX:
  6F65'   7C             C      	LD	A,H
  6F66'   CD 6F4B'       C      	CALL	UC.CVBX+2	; benutzt: A, 3 Stack-P.
  6F69'   7D             C      	LD	A,L
  6F6A'   CD 6F4B'       C      	CALL	UC.CVBX+2
  6F6D'   C9             C      	RET
                         C      			;
                         C      			;
                         C      ;      ---------------------------------------------------------------
                         C      ;                            In A:     ASCII hexa --> binaer < 16
                         C      ;
                         C      ;                                       Datenfehler: Cy, A undefiniert
                         C      ;                            ------------------------------------------
  6F6E'                  C      UC.CVAXB:
  6F6E'   D6 30          C      	SUB	30H
  6F70'   D8             C      	RET	C		;       (A) < '0'
  6F71'   FE 0A          C      	CP	10
  6F73'   3F             C      	CCF
  6F74'   D0             C      	RET	NC
  6F75'   FE 11          C      	CP	11H
  6F77'   D8             C      	RET	C		; '9' < (A) < 'A'
  6F78'   FE 17          C      	CP	17H
  6F7A'   3F             C      	CCF
  6F7B'   D8             C      	RET	C		; 'F' < (A)
  6F7C'   D6 07          C      	SUB	7H
  6F7E'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      ;                            2 ASCII hexa (DE) --> Byte binaer (HL)
                         C      ;                                                            DE+2, HL+1
                         C      ;
                         C      ;                                       mit Datenfehler-Behandlung
                         C      ;                            ------------------------------------------
  6F7F'                  C      UC.CVXB:
  6F7F'   C5             C      	PUSH	BC
                         C      			; benutzt: A, 3 Stack-P.
  6F80'   CD 6F90'       C      	CALL	UC.CVX1B
  6F83'   87             C      	ADD	A,A
  6F84'   87             C      	ADD	A,A
  6F85'   87             C      	ADD	A,A
  6F86'   87             C      	ADD	A,A
  6F87'   4F             C      	LD	C,A
'Konvertierungen'	MACRO-80 3.44	09-Dec-81	PAGE	1-73


                         C      			;
  6F88'   CD 6F90'       C      	CALL	UC.CVX1B
  6F8B'   81             C      	ADD	A,C
                         C      			;
  6F8C'   77             C      	LD	(HL),A
  6F8D'   23             C      	INC	HL
  6F8E'   C1             C      	POP	BC
  6F8F'   C9             C      	RET
                         C      			;
  6F90'                  C      UC.CVX1B:
  6F90'   1A             C      	LD	A,(DE)	; ASCII hexa (DE) --> A binaer,
  6F91'   CD 6F6E'       C      	CALL	UC.CVAXB	;                           DE+1
  6F94'   DC 6F99'       C      	CALL	C,UC.CVXER
  6F97'   13             C      	INC	DE
  6F98'   C9             C      	RET
                         C      			;
  6F99'                  C      UC.CVXER:
  6F99'   EB             C      	EX	DE,HL       ; Datenfehler-Behandlung hexa
  6F9A'   CD 4033        C      	CALL	SY.SETCHL      ;         set cursor
  6F9D'   CD 6C85'       C          CALL  UR.TAREP  ; <-+     tast.request
  6FA0'   77             C          LD    (HL),A    ;   |     write in conv.-area
  6FA1'   CD 6F6E'       C          CALL  UC.CVAXB  ;   |     conv.in A
  6FA4'   38 F7          C          JR    C,$-7     ; --+     on error ...
  6FA6'   CD 4036        C          CALL	SY.RESC
  6FA9'   EB             C          EX    DE,HL
  6FAA'   C9             C          RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      ;                       4 ASCII hexa (DE) --> Adresse (L,H) binaer (HL)
                         C      ;                                                            DE+4, HL+2
                         C      ;
                         C      ;                                       mit Datenfehler-Behandlung
                         C      ;                       -----------------------------------------------
  6FAB'                  C      UC.CVXA:
  6FAB'   23             C      	INC	HL
  6FAC'   CD 6F7F'       C      	CALL	UC.CVXB	; benutzt: A, 4 Stack-P.
  6FAF'   2B             C      	DEC	HL
  6FB0'   2B             C      	DEC	HL
  6FB1'   CD 6F7F'       C      	CALL	UC.CVXB
  6FB4'   23             C      	INC	HL
  6FB5'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      ;                     2 Byte binaer in HL ---> 1...5-stellig dezi (DE),
                         C      ;                                                             DE+1...5
                         C      ;                                  mit Vor-Null-Unterdrueckung
                         C      ;                                                    (nach nicht-dezi),
                         C      ;                                  zu wenig Stellen -->
                         C      ;                                      '*' in der obersten angeg.Stelle
                         C      ;                      ------------------------------------------------
  6FB6'                  C      UC.CVBD5:
  6FB6'   3E 05          C      	LD	A,5	; benutzt: A, 7 Stack-P.
  6FB8'   18 0E          C      	JR	$+16
  6FBA'                  C      UC.CVBD4:
  6FBA'   3E 04          C      	LD	A,4
  6FBC'   18 0A          C      	JR	$+12
  6FBE'                  C      UC.CVBD3:
  6FBE'   3E 03          C      	LD	A,3
  6FC0'   18 06          C      	JR	$+8
  6FC2'                  C      UC.CVBD2:
  6FC2'   3E 02          C      	LD	A,2
  6FC4'   18 02          C      	JR	$+4
  6FC6'                  C      UC.CVBD1:
  6FC6'   3E 01          C      	LD	A,1
                         C      			;
  6FC8'   C5             C      UC.CVBD:	PUSH	BC	; Zeichenzahl in A
  6FC9'   E5             C      	PUSH	HL
  6FCA'   47             C      	LD	B,A
  6FCB'   CD 6FD3'       C      	CALL	UC.CVBD0
  6FCE'   10 FB          C      	DJNZ	$-3
  6FD0'   E1             C      	POP	HL
  6FD1'   C1             C      	POP	BC
  6FD2'   C9             C      	RET
                         C      			;
                         C      ;                          Abspaltung B-te Stelle dezi von HL nach (DE)
                         C      ;                                                                  DE+1
                         C      ;                          B-te nicht fuehrende Stelle: '*' nach (DE)
                         C      ;                          --------------------------------------------
  6FD3'                  C      UC.CVBD0:
  6FD3'   C5             C      	PUSH	BC	; benutzt: A, 5 Stack-P.
                         C      			; --------
  6FD4'   7D             C      	LD	A,L
  6FD5'   F6 30          C      	OR	'0'
'Konvertierungen'	MACRO-80 3.44	09-Dec-81	PAGE	1-74


  6FD7'   05             C      	DEC	B
  6FD8'   28 29          C          JR   Z,$+43	  ; -------+
                         C                        ;        |
  6FDA'   D5             C          PUSH DE       ;        |
  6FDB'   E5             C          PUSH HL       ; DE := (B-1)-te Zehner-Potenz
  6FDC'   21 0001        C          LD   HL,1     ;        |
  6FDF'   CD 6F11'       C          CALL UC.HL10N ;        |
  6FE2'   10 FB          C          DJNZ $-3      ;        |
  6FE4'   EB             C          EX   DE,HL    ;        |
  6FE5'   E1             C          POP  HL       ;        |
                         C                        ;        |
  6FE6'   CD 6F31'       C          CALL UC.DIVR  ; A := HL / B-te Zehner-Potenz
  6FE9'   D1             C          POP  DE       ;        |     HL := Rest
                         C                        ;        |
  6FEA'   FE 0A          C          CP   10       ; test to decimal
  6FEC'   38 04          C          JR   C,$+6    ; ---+   |
  6FEE'   3E 2A          C          LD   A,'*'    ;    |   |
  6FF0'   18 11          C          JR   $+19     ; -------+
                         C                        ; <--+   |
  6FF2'   F6 30          C          OR   '0'      ; conv.to decimal
                         C                        ;        |
  6FF4'   FE 30          C          CP   '0'      ; Vor-Null ?
  6FF6'   20 0B          C          JR   NZ,$+13  ; -------+
  6FF8'   1B             C          DEC  DE       ;        |
  6FF9'   4F             C          LD   C,A      ;        |
  6FFA'   CD 7030'       C          CALL UC.CVD1B ;        |
  6FFD'   79             C          LD   A,C      ;        |
  6FFE'   13             C          INC  DE       ;        |
  6FFF'   30 02          C          JR   NC,$+4   ;        |
  7001'   3E 20          C          LD   A,' '    ;        |
                         C                        ; <------+
  7003'   12             C      	LD	(DE),A
  7004'   13             C      	INC	DE
  7005'   C1             C      	POP	BC
  7006'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      ;                      Dezi von (DE) bis (-->DE) nicht-dezi
                         C      ;                                                --->      binaer in HL
                         C      ;
                         C      ;                         Fehler:
                         C      ;                         -------
                         C      ;                         Cy, NZ: Zahl zu gross, HL ohne letzte Ziffer
                         C      ;                         Cy, Z:  Leere Zahl (1.Position keine Ziffer),
                         C      ;                                        -->     HL = 0
                         C      ;                      ------------------------------------------------
  7007'                  C      UC.CVDB:
  7007'   26 00          C      	LD	H,0
  7009'   CD 7030'       C      	CALL	UC.CVD1B
  700C'   6F             C      	LD	L,A
  700D'   30 04          C      	JR	NC,$+6
  700F'   AF             C      	XOR	A
  7010'   6F             C      	LD	L,A
  7011'   37             C      	SCF
  7012'   C9             C      	RET		; ---> abend C, Z
                         C      			;
  7013'   13             C      	INC	DE
  7014'   CD 7030'       C      	CALL	UC.CVD1B
  7017'   3F             C      	CCF
  7018'   D0             C      	RET	NC		; ---> normal end
  7019'   D5             C          PUSH  DE
  701A'   F5             C          PUSH  AF
  701B'   CD 6F18'       C          CALL  UC.HL10C
  701E'   38 0B          C          JR    C,$+13    ; ----------+
  7020'   F1             C          POP   AF        ;           |
  7021'   85             C          ADD   A,L       ;           |
  7022'   6F             C          LD    L,A       ;           |
  7023'   30 03          C          JR    NC,$+5	; --+       |
  7025'   24             C          INC   H         ;   |       |
  7026'   28 04          C          JR    Z,$+6     ;   |    ---|--+
  7028'   D1             C          POP   DE        ; <-+       |  |
  7029'   18 E8          C          JR    $-22      ;           |  |
                         C                          ;      <----+  !
  702B'   E1             C          POP   HL        ; abend Cy, NZ !
  702C'   25             C          DEC   H         ;              |
  702D'   EB             C          EX    DE,HL     ;        <-----+
  702E'   D1             C          POP   DE
  702F'   C9             C          RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      ;                            Ziffer dezi (DE) ---> binaer nach A, DE+1
                         C      ;                                                  Cy: nicht-dezi
                         C      ;                            ------------------------------------------
'Konvertierungen'	MACRO-80 3.44	09-Dec-81	PAGE	1-75


  7030'                  C      UC.CVD1B:
  7030'   1A             C      	LD	A,(DE)
  7031'   D6 30          C      	SUB	30H
  7033'   D8             C      	RET	C
  7034'   FE 0A          C      	CP	10
  7036'   3F             C      	CCF
  7037'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      ;                    Byte binaer (HL) --> Byte ASCII-Symbol (DE)
                         C      ;                                         (sonst: 7FH )
                         C      ;                                                     HL+1, DE+1
                         C      ;                    --------------------------------------------------
  7038'                  C      UC.CVBC:
  7038'   7E             C      	LD	A,(HL)	; benutzt: A, 0 Stack-P.
  7039'   23             C      	INC	HL	; --------
  703A'   FE 20          C      	CP	20H
  703C'   30 02          C      	JR	NC,$+4
  703E'   3E 7F          C      	LD	A,7FH
  7040'   FE 7F          C      	CP	7FH
  7042'   38 02          C      	JR	C,$+4
  7044'   3E 7F          C      	LD	A,7FH
  7046'   12             C      	LD	(DE),A
  7047'   13             C      	INC	DE
  7048'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      ;                       Byte ASCII-Symbol (DE)   -->   Byte binaer (HL)
                         C      ;                                                      DE+1, HL+1
                         C      ;                       -----------------------------------------------
  7049'                  C      UC.CVCB:
  7049'   1A             C      	LD	A,(DE)	; benutzt: A, 0 Stack-P.
  704A'   13             C      	INC	DE
  704B'   FE 20          C      	CP	20H
  704D'   38 05          C      	JR	C,$+7
  704F'   FE 7E          C      	CP	7EH
  7051'   30 01          C      	JR	NC,$+3
  7053'   77             C      	LD	(HL),A
  7054'   23             C      	INC	HL
  7055'   C9             C      	RET
                         C      			;
                         C      
                         C      ;**********************************************************************
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;      KONVERTIERUNGEN
                         C      ;
                         C      ;----------------------------------------------------------------------
  7056'                  C      UC.DKONV:
  7056'   7E             C      	LD	A,(HL)	;DKOI--->ASCII
  7057'   CD 706A'       C      	CALL	UC.DK1	;(HL)--->(DE)
  705A'   12             C      	LD	(DE),A
  705B'   23             C      	INC	HL
  705C'   13             C      	INC	DE
  705D'   10 F7          C      	DJNZ	UC.DKONV
  705F'   C9             C      	RET
                         C      ;------------------------------------
  7060'                  C      UC.KONV:
  7060'   7E             C      	LD	A,(HL)	;ASCII--->DKOI
  7061'   CD 7075'       C      	CALL	UC.CKONV	;(HL) --->(DE)
  7064'   12             C      	LD	(DE),A
  7065'   23             C      	INC	HL
  7066'   13             C      	INC	DE
  7067'   10 F7          C      	DJNZ	UC.KONV
  7069'   C9             C      	RET
                         C      ;-----------------------------
  706A'                  C      UC.DK1:
  706A'   E5             C      	PUSH	HL	;DKOI--->ASCII
  706B'   D5             C      	PUSH	DE
  706C'   C5             C      	PUSH	BC
  706D'   21 7098'       C      	LD	HL,UC.ASCCO
  7070'   11 70F8'       C      	LD	DE,UC.DKOI
  7073'   18 09          C      	JR	UC.DK2
  7075'                  C      UC.CKONV:
  7075'   E5             C      	PUSH	HL	;ASCII ---> DKOI
  7076'   D5             C      	PUSH	DE
  7077'   C5             C      	PUSH	BC
  7078'   21 70F8'       C      	LD	HL,UC.DKOI	;HL:= Anfangsadresse
  707B'   11 7098'       C      	LD	DE,UC.ASCCO	;DE:= Anfangsadresse
  707E'                  C      UC.DK2:
  707E'   F5             C      	PUSH	AF	;Quellcodebyte retten
  707F'   AF             C      	XOR	A	;CY = 0
  7080'   ED 52          C      	SBC	HL,DE	;Tabellendistanz berechnen
'Konvertierungen'	MACRO-80 3.44	09-Dec-81	PAGE	1-76


  7082'   2B             C      	DEC	HL
  7083'   E5             C      	PUSH	HL
  7084'   C1             C      	POP	BC	;BC:= Tabellendistanz - 1
  7085'   EB             C      	EX	DE,HL	;HL:= Anfangsadresse
  7086'   F1             C      	POP	AF	;Zeichen wieder herstellen
  7087'   C5             C      	PUSH	BC	;Tabellendistanz retten
  7088'   01 0060        C      	LD	BC,UE.COTAL	;BC:= Tabellenlaenge
  708B'   ED B1          C      	CPIR		;Quellcodebyte suchen
  708D'   37             C      	SCF		;CY = 1
  708E'   C1             C      	POP	BC	;Tabellendistanz auskellern
  708F'   20 03          C      	JR	NZ,UC.KONV2	;---> Quellcodebyte nicht
  7091'   09             C      	ADD	HL,BC	;Zielcodeadresse berechnen
  7092'   AF             C      	XOR	A	;CY = 0
  7093'   7E             C      	LD	A,(HL)	;Zielcodebyte laden
  7094'                  C      UC.KONV2:
  7094'   C1             C      	POP	BC
  7095'   D1             C      	POP	DE
  7096'   E1             C      	POP	HL
  7097'   C9             C      	RET
                         C      ;****************************************************************
                         C      ;         ASCII - Codetabelle
                         C      ;****************************************************************
  7098'                  C      UC.ASCCO:
  7098'   20 21 22 23    C      	DB	' !"#$%&'
  709C'   24 25 26       C      
  709F'   27             C      	DB	27H	;'
  70A0'   28 29 2A 2B    C      	DB	'()*+,-./'
  70A4'   2C 2D 2E 2F    C      
  70A8'   30 31 32 33    C      	DB	'0123456789'
  70AC'   34 35 36 37    C      
  70B0'   38 39          C      
  70B2'   3A 3B 3C 3D    C      	DB	':;<=>?@'
  70B6'   3E 3F 40       C      
  70B9'   41 42 43 44    C      	DB	'ABCDEFGHIJKLMNOPQRSTUVWXYZ'
  70BD'   45 46 47 48    C      
  70C1'   49 4A 4B 4C    C      
  70C5'   4D 4E 4F 50    C      
  70C9'   51 52 53 54    C      
  70CD'   55 56 57 58    C      
  70D1'   59 5A          C      
  70D3'   5B 5C 5D 5E    C      	DB	'[\]^_`'
  70D7'   5F 60          C      
  70D9'   61 62 63 64    C      	DB	'abcdefghijklmnopqrstuvwxyz'
  70DD'   65 66 67 68    C      
  70E1'   69 6A 6B 6C    C      
  70E5'   6D 6E 6F 70    C      
  70E9'   71 72 73 74    C      
  70ED'   75 76 77 78    C      
  70F1'   79 7A          C      
  70F3'   7B 7C 7D 7E    C      	DB	'{|}~'
  70F7'   7F             C      	DB	7FH	;DEL
                         C      ;***************************************************************
                         C      ;         DKOI - Codetabelle
                         C      ;***************************************************************
  70F8'                  C      UC.DKOI:
  70F8'   40             C      	DB	40H	;blank
  70F9'   4F             C      	DB	4FH	;!
  70FA'   7F             C      	DB	7FH	;"
  70FB'   7B             C      	DB	7BH	;#
  70FC'   5B             C      	DB	5BH	;$
  70FD'   6C             C      	DB	6CH	;%
  70FE'   50             C      	DB	50H	;&
  70FF'   7D             C      	DB	7DH	;'
  7100'   4D             C      	DB	4DH	;(
  7101'   5D             C      	DB	5DH	;)
  7102'   5C             C      	DB	5CH	;*
  7103'   4E             C      	DB	4EH	;+
  7104'   6B             C      	DB	6BH	;,
  7105'   60             C      	DB	60H	;-
  7106'   4B             C      	DB	4BH	;.
  7107'   61             C      	DB	61H	;/
  7108'   F0             C      	DB	0F0H	;0
  7109'   F1             C      	DB	0F1H	;1
  710A'   F2             C      	DB	0F2H	;2
  710B'   F3             C      	DB	0F3H	;3
  710C'   F4             C      	DB	0F4H	;4
  710D'   F5             C      	DB	0F5H	;5
  710E'   F6             C      	DB	0F6H	;6
  710F'   F7             C      	DB	0F7H	;7
  7110'   F8             C      	DB	0F8H	;8
  7111'   F9             C      	DB	0F9H	;9
  7112'   7A             C      	DB	7AH	;:
  7113'   5E             C      	DB	5EH	;;
'Konvertierungen'	MACRO-80 3.44	09-Dec-81	PAGE	1-77


  7114'   4C             C      	DB	4CH	;<
  7115'   7E             C      	DB	7EH	;=
  7116'   6E             C      	DB	6EH	;>
  7117'   6F             C      	DB	6FH	;?
  7118'   7C             C      	DB	7CH	;@
  7119'   C1             C      	DB	0C1H	;A
  711A'   C2             C      	DB	0C2H	;B
  711B'   C3             C      	DB	0C3H	;C
  711C'   C4             C      	DB	0C4H	;D
  711D'   C5             C      	DB	0C5H	;E
  711E'   C6             C      	DB	0C6H	;F
  711F'   C7             C      	DB	0C7H	;G
  7120'   C8             C      	DB	0C8H	;H
  7121'   C9             C      	DB	0C9H	;I
  7122'   D1             C      	DB	0D1H	;J
  7123'   D2             C      	DB	0D2H	;K
  7124'   D3             C      	DB	0D3H	;L
  7125'   D4             C      	DB	0D4H	;M
  7126'   D5             C      	DB	0D5H	;N
  7127'   D6             C      	DB	0D6H	;O
  7128'   D7             C      	DB	0D7H	;P
  7129'   D8             C      	DB	0D8H	;Q
  712A'   D9             C      	DB	0D9H	;R
  712B'   E2             C      	DB	0E2H	;S
  712C'   E3             C      	DB	0E3H	;T
  712D'   E4             C      	DB	0E4H	;U
  712E'   E5             C      	DB	0E5H	;V
  712F'   E6             C      	DB	0E6H	;W
  7130'   E7             C      	DB	0E7H	;X
  7131'   E8             C      	DB	0E8H	;Y
  7132'   E9             C      	DB	0E9H	;Z
  7133'   4A             C      	DB	4AH	;[
  7134'   E0             C      	DB	0E0H	;\
  7135'   5A             C      	DB	5AH	;]
  7136'   5F             C      	DB	5FH	;^
  7137'   6D             C      	DB	6DH	;_
  7138'   79             C      	DB	79H	;`
  7139'   81             C      	DB	81H	;a
  713A'   82             C      	DB	82H	;b
  713B'   83             C      	DB	83H	;c
  713C'   84             C      	DB	84H	;d
  713D'   85             C      	DB	85H	;e
  713E'   86             C      	DB	86H	;f
  713F'   87             C      	DB	87H	;g
  7140'   88             C      	DB	88H	;h
  7141'   89             C      	DB	89H	;i
  7142'   91             C      	DB	91H	;j
  7143'   92             C      	DB	92H	;k
  7144'   93             C      	DB	93H	;l
  7145'   94             C      	DB	94H	;m
  7146'   95             C      	DB	95H	;n
  7147'   96             C      	DB	96H	;o
  7148'   97             C      	DB	97H	;p
  7149'   98             C      	DB	98H	;q
  714A'   99             C      	DB	99H	;r
  714B'   A2             C      	DB	0A2H	;s
  714C'   A3             C      	DB	0A3H	;t
  714D'   A4             C      	DB	0A4H	;u
  714E'   A5             C      	DB	0A5H	;v
  714F'   A6             C      	DB	0A6H	;w
  7150'   A7             C      	DB	0A7H	;x
  7151'   A8             C      	DB	0A8H	;y
  7152'   A9             C      	DB	0A9H	;z
  7153'   C0             C      	DB	0C0H	;{
  7154'   6A             C      	DB	6AH	;|
  7155'   D0             C      	DB	0D0H	;}
  7156'   A1             C      	DB	0A1H	;~
  7157'   FF             C      	DB	0FFH	;DEL
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Komprimierung'
                         C      	PAGE
'Komprimierung'	MACRO-80 3.44	09-Dec-81	PAGE	1-78


                         C      
                         C      ;	PN	CP
                         C      ;**********************************************************************
                         C      ;*       COMPR:    Komprimierung                                      *
                         C      ;*                 EDIT - F/Q-Format   --->  MRES20 - Quelltextformat *
                         C      ;**********************************************************************
                         C      			;
  7158'                  C      CP.COMPR	EQU	$	; A  Uebergabe/-nahme Zeichen
                         C      			; HL: Status von COMPR
                         C      			; B:  dekr. Tabulator-Zaehler
                         C      			;-------------------------------
                         C      			; OUTA: Einzelzeichen-Ausgabe
                         C      			;         (Zeichen in Reg. A)
                         C      ;----------------------------------------------------------------------
                         C      			;
  7158'   FE 1E          C      	CP	1EH	; NL ?
  715A'   28 01          C      	JR	Z,CP.NL
  715C'   E9             C      	JP	(HL)
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      			; Status "New-Line"
                         C      			;-------------------------------
  715D'                  C      CP.NL:
  715D'   CD 6EE7'       C      	CALL	XY.INCDX	;         Satz-Zaehler + 1
  7160'   13             C      	DB	19
  7161'   06 03          C      	LD	B,3	;         noch 3 TAB erlaubt
  7163'   3E 0A          C      	LD	A,0AH	;         MRES20-NL
  7165'   18 04          C      	JR	CP.OUTT
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      			; Status "String"
                         C      			;-------------------------------
  7167'                  C      CP.STRNG:
  7167'   FE 27          C      	CP	27H	;         Apostroph
  7169'   20 20          C      	JR	NZ,CP.OUT
                         C      			;
  716B'                  C      CP.OUTT:
  716B'   21 717B'       C      	LD	HL,CP.TEXT	;         --> Status "Text"
  716E'   18 1B          C      	JR	CP.OUT
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      			; Status "Space"
                         C      			;-------------------------------
  7170'                  C      CP.SPACE:
  7170'   FE 20          C      	CP	' '
  7172'   C8             C      	RET	Z
  7173'   FE 09          C      	CP	09H	;         Tabulator
  7175'   C8             C      	RET	Z
  7176'   21 717B'       C      	LD	HL,CP.TEXT	;         ---> Status "Text"
  7179'   18 08          C      	JR	CP.TEXT+8
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      			; Status "Text"
                         C      			;-------------------------------
  717B'                  C      CP.TEXT:
  717B'   FE 20          C      	CP	' '
  717D'   28 2E          C      	JR	Z,CP.TAB
  717F'   FE 09          C      	CP	09H	;         Tabulator
  7181'   28 2A          C      	JR	Z,CP.TAB
  7183'   FE 3B          C      	CP	';'
  7185'   28 0B          C      	JR	Z,CP.SOKOM
  7187'   FE 27          C      	CP	27H	;         Apostroph
  7189'   28 1D          C      	JR	Z,CP.SOSTR
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      			; Status "Kom"
                         C      			;-------------------------------
  718B'                  C      CP.KOM	EQU	$
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      			; Einzelzeichen-Ausgabe u. Ret.
                         C      			;-------------------------------
  718B'                  C      CP.OUT:
  718B'   CD 72A7'       C      	CALL	UK.PUTK
  718E'   D9             C      	EXX
  718F'   0B             C      	DEC	BC
  7190'   D9             C      	EXX
  7191'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      			; Start "Kommentar"
                         C      			;-------------------------------
'Komprimierung'	MACRO-80 3.44	09-Dec-81	PAGE	1-79


  7192'                  C      CP.SOKOM:
  7192'   78             C          LD	A,B	;         0 oder 3 TAB vorher
  7193'   FE 03          C          CP   3
  7195'   28 0A          C          JR   Z,$+12
  7197'   B7             C          OR   A
  7198'   28 07          C          JR   Z,$+9      ;         ---+
  719A'   3E 09          C          LD   A,09H      ;         <-+|
  719C'   CD 718B'       C          CALL CP.OUT     ;           ||
  719F'   10 F9          C          DJNZ $-5        ;         --+|
  71A1'   3E 3B          C          LD   A,';'      ;         <--+
  71A3'   21 718B'       C          LD   HL,CP.KOM
  71A6'   18 E3          C          JR   CP.OUT
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      			; Start "String"
                         C      			;-------------------------------
  71A8'                  C      CP.SOSTR:
  71A8'   21 7167'       C      	LD	HL,CP.STRNG
  71AB'   18 DE          C      	JR	CP.OUT
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      			; Tabulator-Behandlung
                         C      			;-------------------------------
  71AD'                  C      CP.TAB:
  71AD'   78             C      	LD	A,B
  71AE'   B7             C      	OR	A
  71AF'   3E 20          C      	LD	A,' '
  71B1'   28 D8          C      	JR	Z,CP.OUT
  71B3'   05             C      	DEC	B
  71B4'   3E 09          C      	LD	A,09H	;         Tabulator MRES20
  71B6'   21 7170'       C      	LD	HL,CP.SPACE
  71B9'   18 D0          C      	JR	CP.OUT
                         C      			;
                         C      ;**********************************************************************
                         C      			;
  71BB'                  C      CP.INIT:
  71BB'   06 03          C      	LD	B,3	; Initialisierung COMPR
  71BD'   21 717B'       C      	LD	HL,CP.TEXT
  71C0'   C9             C      	RET
                         C      			;
                         C      ;**********************************************************************
                         C      ;	END
                         C      	TITLE	'Dekomprimierung'
                         C      	PAGE
'Dekomprimierung'	MACRO-80 3.44	09-Dec-81	PAGE	1-80


                         C      
                         C      ;	PN	DC
                         C      ;**********************************************************************
                         C      ;*       DCMPR:    Dekomprimierung                                    *
                         C      ;*                 MRES20-Quelltexte   --->   EDIT - Format F         *
                         C      ;**********************************************************************
                         C      			;
  71C1'                  C      DC.DCMPR	EQU	$
                         C      			; A:  Uebergabe/-nahme Zeichen
                         C      			; HL: Status-Register DCMPR
                         C      			; B:  Position (Spalte)
                         C      			;-------------------------------
                         C      			; INA: Einzelzeichen-Eingabe
                         C      			;      nach Reg. A
                         C      ;        --------------------------------------------------------------
  71C1'   04             C      	INC	B	;         Position + 1
  71C2'   E9             C      	JP	(HL)
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      			; Status "Neue Zeile"
                         C      			;-------------------------------
  71C3'                  C      DC.NL:
  71C3'   CD 6EE7'       C      	CALL	XY.INCDX	;         Satzzaehler + 1
  71C6'   13             C      	DB	19
  71C7'   3E 1E          C      	LD	A,1EH	;         EDIT-New-Line
  71C9'   06 01          C      	LD	B,1	;         Pos.=1
  71CB'   21 71CF'       C      	LD	HL,DC.TEXT	;         Status "TEXT"
  71CE'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      			; Status "Text"
                         C      			;-------------------------------
  71CF'                  C      DC.TEXT:
  71CF'   CD 7202'       C      	CALL	UK.GETK	;         Einzelzeichen-Eingabe
  71D2'   B7             C      	OR	A
  71D3'   C8             C      	RET	Z
  71D4'   FE 0A          C      	CP	0AH	;         NL ?
  71D6'   28 EB          C      	JR	Z,DC.NL
  71D8'   FE 09          C      	CP	09H	;         TAB ?
  71DA'   28 01          C      	JR	Z,DC.TAB
  71DC'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      			; Tabulator-Behandlung
                         C      			;-------------------------------
  71DD'                  C      DC.TAB:
  71DD'   78             C      	LD	A,B
  71DE'   FE 28          C      	CP	40
  71E0'   D0             C      	RET	NC
  71E1'   21 71E7'       C      	LD	HL,DC.SPACE	;         ---> Status "Space"
  71E4'   3E 20          C      	LD	A,' '	;         anstelle TAB Space
  71E6'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      			; Status "Space"
                         C      			;-------------------------------
  71E7'                  C      DC.SPACE:
  71E7'   78             C      	LD	A,B
  71E8'   FE 0B          C      	CP	10+1
  71EA'   28 0B          C      	JR	Z,DC.EOSPC
  71EC'   FE 11          C      	CP	16+1
  71EE'   28 07          C      	JR	Z,DC.EOSPC
  71F0'   FE 24          C      	CP	35+1
  71F2'   28 03          C      	JR	Z,DC.EOSPC
  71F4'   3E 20          C      	LD	A,' '
  71F6'   C9             C      	RET
                         C      			;
  71F7'                  C      DC.EOSPC:
  71F7'   21 71CF'       C      	LD	HL,DC.TEXT	; TAB-Position erreicht
  71FA'   18 D3          C      	JR	DC.TEXT
                         C      			;
                         C      			;
                         C      ;**********************************************************************
  71FC'                  C      DC.INIT:
  71FC'   21 71CF'       C      	LD	HL,DC.TEXT	; Initialisierung
  71FF'   06 01          C      	LD	B,1
  7201'   C9             C      	RET
                         C      			;
                         C      ;**********************************************************************
                         C      ;	END
                         C      	TITLE	'Einzelzeicheneingabe fuer KMBG'
                         C      	PAGE
'Einzelzeicheneingabe fuer KMBG'	MACRO-80 3.44	09-Dec-81	PAGE	1-81


                         C      
                         C      ;	PN	UK
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;        Einzelzeicheneingabe fuer KMBG
                         C      ;
                         C      ;----------------------------------------------------------------------
                         C      ;
  7202'                  C      UK.GETK:
  7202'   CD 6CAD'       C      	CALL	U1.RSAVE
  7205'   CD 6EB7'       C      	CALL	XY.LIDX	;HL:= Blocklaenge
  7208'   07             C      	DB	7
  7209'   E5             C      	PUSH	HL
  720A'   CD 6EA7'       C      	CALL	XY.LDDX
  720D'   17             C      	DB	23
  720E'   EB             C      	EX	DE,HL	;DE:= Pufferzaehler
  720F'   AF             C      	XOR	A
  7210'   E1             C      	POP	HL	;HL:= Blocklaenge
  7211'   ED 52          C      	SBC	HL,DE
  7213'   E5             C      	PUSH	HL	;Restbyteanzahl retten
  7214'   7C             C      	LD	A,H
  7215'   B5             C      	OR	L
  7216'   CC 7262'       C      	CALL	Z,UK.KBW	;Block lesen
  7219'   E1             C      	POP	HL
  721A'   AF             C      	XOR	A
  721B'   BC             C      	CP	H
  721C'   20 05          C      	JR	NZ,UK.GETK2
  721E'   7D             C      	LD	A,L
  721F'   FE 01          C      	CP	1
  7221'   28 08          C      	JR	Z,UK.GETK3	;---> letztes Datenbyte des
  7223'                  C      UK.GETK2:
  7223'   CD 7231'       C      	CALL	UK.GETK4
  7226'   B7             C      	OR	A
  7227'                  C      UK.GETK5:
  7227'   CD 6CB5'       C      	CALL	U1.RRST
  722A'   C9             C      	RET
                         C      ;
                         C      ;
  722B'                  C      UK.GETK3:
  722B'   CD 7231'       C      	CALL	UK.GETK4
  722E'   37             C      	SCF
  722F'   18 F6          C      	JR	UK.GETK5
                         C      ;
  7231'                  C      UK.GETK4:
  7231'   CD 6EA7'       C      	CALL	XY.LDDX	;HL:= aktuelle Pufferadresse
  7234'   15             C      	DB	21
  7235'   7E             C      	LD	A,(HL)	;Datenbyte laden
  7236'   CD 6EE7'       C      	CALL	XY.INCDX	;Pufferzeiger erhoehen
  7239'   15             C      	DB	21
  723A'   CD 6EE7'       C      	CALL	XY.INCDX	;Pufferzaehler erhoehen
  723D'   17             C      	DB	23
  723E'   C9             C      	RET
                         C      ;
                         C      ;******************************************************************
                         C      ;
                         C      ;        KMBG  Eingabepuffer bereitstellen
                         C      ;
                         C      ;*******************************************************************
                         C      ;
  723F'                  C      UK.KLPFB:
  723F'   CD 6CAD'       C      	CALL	U1.RSAVE
  7242'   CD 6DA9'       C      	CALL	U1.KTIN1
  7245'   21 0100        C      	LD	HL,100H	;max. Blocklaenge Kassette
  7248'   CD 6ED7'       C      	CALL	XY.STIDX	;max. Blocklaenge initialisieren
  724B'   07             C      	DB	7
  724C'   E5             C      	PUSH	HL
  724D'   C1             C      	POP	BC	;BC:= Blocklaenge
  724E'   CD 6EC7'       C      	CALL	XY.STDX	;Pufferzaehler "Leer"
  7251'   17             C      	DB	23
  7252'   21 0E66        C      	LD	HL,UE.PUF	;Systempuffer Kassette
  7255'   CD 6CBE'       C      	CALL	U1.CLRB	;Systempuffer loeschen
  7258'   21 8010        C      	LD	HL,UE.KPUFF
  725B'   CD 6CBE'       C      	CALL	U1.CLRB
  725E'   CD 6CB5'       C      	CALL	U1.RRST
  7261'   C9             C      	RET
                         C      ;
                         C      ;******************************************************************
                         C      ;
                         C      ;        Einlesen eines Blockes von Kassette
                         C      ;
                         C      ;         - Besonderheit gegenueber MBW: Blockinhalt wird vom
                         C      ;           Systempuffer in den E/A-Puffer uebertragen
'Einzelzeicheneingabe fuer KMBG'	MACRO-80 3.44	09-Dec-81	PAGE	1-82


                         C      ;
                         C      ;*******************************************************************
                         C      ;
  7262'                  C      UK.KBW:
  7262'   CD 6CAD'       C      	CALL	U1.RSAVE
  7265'   CD 723F'       C      	CALL	UK.KLPFB
  7268'   DD 36 05 02    C      	LD	(IX+5),02H
  726C'   CD 5668'       C      	CALL	UF.EXEC
  726F'   DD 7E 09       C      	LD	A,(IX+9)
  7272'   DD B6 0A       C      	OR	(IX+10)
  7275'   28 2A          C      	JR	Z,UK.KBW1	;EOF
  7277'   CD 6EA7'       C      	CALL	XY.LDDX	;HL:= Blockadresse
  727A'   07             C      	DB	7
  727B'   DD 46 09       C      	LD	B,(IX+9)	;BC:= Blocklaenge
  727E'   DD 4E 0A       C      	LD	C,(IX+10)
  7281'   E5             C      	PUSH	HL	;E/A-Puffer
  7282'   CD 6EA7'       C      	CALL	XY.LDDX
  7285'   19             C      	DB	25
  7286'   EB             C      	EX	DE,HL
  7287'   E1             C      	POP	HL
  7288'   ED B0          C      	LDIR		;Transport in E/A-Puffer
  728A'   CD 6EA7'       C      	CALL	XY.LDDX
  728D'   19             C      	DB	25
  728E'   CD 6EC7'       C      	CALL	XY.STDX	;Pufferzeiger auf Anfang
  7291'   15             C      	DB	21
  7292'   21 0000        C      	LD	HL,0
  7295'   CD 6EC7'       C      	CALL	XY.STDX	;Pufferzaehler rueckstellen
  7298'   17             C      	DB	23
  7299'   CD 6EE7'       C      	CALL	XY.INCDX	;Blockzaehler incrementieren
  729C'   11             C      	DB	17
  729D'                  C      UK.KBW2:
  729D'   CD 6CB5'       C      	CALL	U1.RRST
  72A0'   C9             C      	RET
                         C      ;
  72A1'                  C      UK.KBW1:
  72A1'   CD 6EE7'       C      	CALL	XY.INCDX	;Labelzaehler incrementieren
  72A4'   11             C      	DB	17
  72A5'   18 F6          C      	JR	UK.KBW2
                         C      ;
                         C      ;********************************************************************
                         C      ;
                         C      ;        Einzelzeichenausgabe fuer KMBG
                         C      ;
                         C      ;*********************************************************************
                         C      ;
  72A7'                  C      UK.PUTK:
  72A7'   CD 6CAD'       C      	CALL	U1.RSAVE
  72AA'   F5             C      	PUSH	AF	;Zeichen retten
  72AB'   CD 6EA7'       C      	CALL	XY.LDDX	;HL:= Pufferzaehler
  72AE'   17             C      	DB	23
  72AF'   01 0132        C      	LD	BC,UE.KMPUL	;BC:= max. Pufferlaenge
  72B2'   B7             C      	OR	A
  72B3'   ED 42          C      	SBC	HL,BC
  72B5'   3F             C      	CCF
  72B6'   CC 72F0'       C      	CALL	Z,UK.KBA	;---> Puffer voll
  72B9'   F1             C      	POP	AF	;Zeichen auskellern
  72BA'   CD 6EA7'       C      	CALL	XY.LDDX
  72BD'   15             C      	DB	21
  72BE'   77             C      	LD	(HL),A	;Zeichen in Puffer eintragen
  72BF'   CD 6EE7'       C      	CALL	XY.INCDX	;Pufferzeiger erhoehen
  72C2'   15             C      	DB	21
  72C3'   CD 6EE7'       C      	CALL	XY.INCDX	;Pufferzaehler erhoehen
  72C6'   17             C      	DB	23
  72C7'   CD 6CB5'       C      	CALL	U1.RRST
  72CA'   C9             C      	RET
                         C      ;
                         C      ;******************************************************************
                         C      ;
                         C      ;        Ausgabepufferbereitstellung fuer KMBG
                         C      ;
                         C      ;*******************************************************************
                         C      ;
  72CB'                  C      UK.KSPFB:
  72CB'   CD 6CAD'       C      	CALL	U1.RSAVE
  72CE'   CD 6DA9'       C      	CALL	U1.KTIN1
  72D1'   CD 6EB7'       C      	CALL	XY.LIDX
  72D4'   07             C      	DB	7
  72D5'   E5             C      	PUSH	HL
  72D6'   C1             C      	POP	BC	;BC:= Blocklaenge
  72D7'   21 0000        C      	LD	HL,0
  72DA'   CD 6EC7'       C      	CALL	XY.STDX	;Pufferzaehler = 0
  72DD'   17             C      	DB	23
  72DE'   CD 6EA7'       C      	CALL	XY.LDDX
'Einzelzeicheneingabe fuer KMBG'	MACRO-80 3.44	09-Dec-81	PAGE	1-83


  72E1'   19             C      	DB	25
  72E2'   CD 6EC7'       C      	CALL	XY.STDX	;Pufferzeiger setzen
  72E5'   15             C      	DB	21
  72E6'   21 0E66        C      	LD	HL,UE.PUF
  72E9'   CD 6CBE'       C      	CALL	U1.CLRB
  72EC'   CD 6CB5'       C      	CALL	U1.RRST
  72EF'   C9             C      	RET
                         C      ;
                         C      ;*******************************************************************
                         C      ;
                         C      ;        Ausgabe eines Blockes auf KMBG
                         C      ;
                         C      ;*******************************************************************
                         C      ;
  72F0'                  C      UK.KBA:
  72F0'   CD 6CAD'       C      	CALL	U1.RSAVE
  72F3'   CD 72CB'       C      	CALL	UK.KSPFB
  72F6'   CD 6EA7'       C      	CALL	XY.LDDX
  72F9'   07             C      	DB	7
  72FA'   EB             C      	EX	DE,HL	;DE:= Blockadresse
  72FB'   D5             C      	PUSH	DE	;Blockadresse retten
  72FC'   CD 6EB7'       C      	CALL	XY.LIDX
  72FF'   09             C      	DB	9
  7300'   E5             C      	PUSH	HL
  7301'   C1             C      	POP	BC	;BC:= Blocklaenge
  7302'   D1             C      	POP	DE	;DE:= Blockadresse
  7303'   C5             C      	PUSH	BC	;Blocklaenge retten
  7304'   CD 6EA7'       C      	CALL	XY.LDDX	;HL:= E/A-Pufferanfang
  7307'   19             C      	DB	25
  7308'   ED B0          C      	LDIR		;Block in Systempuffer
  730A'   C1             C      	POP	BC	;BC:= Blocklaenge
  730B'   E5             C      	PUSH	HL	;aktuelle Pufferadresse retten
  730C'   21 0132        C      	LD	HL,UE.KMPUL	;HL:= max. Laenge
  730F'   B7             C      	OR	A
  7310'   ED 42          C      	SBC	HL,BC	;HL:= Restbyteanzahl
  7312'   CD 6EC7'       C      	CALL	XY.STDX	;Pufferzaehler setzen
  7315'   17             C      	DB	23
  7316'   E5             C      	PUSH	HL
  7317'   C1             C      	POP	BC	;BC:= Restbyteanzahl
  7318'   CD 6EA7'       C      	CALL	XY.LDDX	;HL:= aktuelle Pufferadresse
  731B'   19             C      	DB	25
  731C'   EB             C      	EX	DE,HL	;DE:= Pufferanfang
  731D'   E1             C      	POP	HL
  731E'   ED B0          C      	LDIR
  7320'   EB             C      	EX	DE,HL	;HL:= aktuelle Pufferadresse
  7321'   CD 6EC7'       C      	CALL	XY.STDX	;Pufferzeiger setzen
  7324'   15             C      	DB	21
  7325'   DD 36 05 08    C      	LD	(IX+5),08H
  7329'   CD 5668'       C      	CALL	UF.EXEC	;physische Blockausgabe
  732C'   F5             C      	PUSH	AF
  732D'   CD 6EE7'       C      	CALL	XY.INCDX	;Blockzaehler erhoehen
  7330'   11             C      	DB	17
  7331'   F1             C      	POP	AF
  7332'   CD 6CB5'       C      	CALL	U1.RRST
  7335'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                                ;
                         C      	INCLUDE KM.MAC
                         C      	TITLE	'Kmbg'
                         C      	PAGE
'Kmbg'	MACRO-80 3.44	09-Dec-81	PAGE	1-84


                         C      
                         C      ;	PN	KM01
                         C      ;****************************************************************
                         C      ;*                  DEG2000   V.1.2   ---   Programm:   K m b g *
                         C      ;*  Version         --------------------------------------------*
                         C      ;*                  Programmierer: R. Sieber   A d W            *
                         C      ;*  V 1 . 2         --------------------------------------------*
                         C      ;*                  Stand        : 25.Februar 1985              *
                         C      ;****************************************************************
                         C      
  7336'                  C      KM.ANF:
  7336'   7336'          C      	DW	$
  7338'   4B 6D 62 67    C      	DB	'Kmbg'
  733C'   21 7520'       C      	LD	HL,KM.DEL	;Taste:   D E L
  733F'   22 0D58        C      	LD	(SM.FKTAB+58H),HL
  7342'   21 74DE'       C      	LD	HL,KM.ABS	;Taste:   A B S
  7345'   22 0D24        C      	LD	(SM.FKTAB+24H),HL
  7348'   21 7394'       C      	LD	HL,KM.HOME	;Taste:   H O M E
  734B'   22 0D74        C      	LD	(SM.FKTAB+74H),HL
  734E'   21 739E'       C      	LD	HL,KM.SL	;Taste:   SCH_LINKS
  7351'   22 0D26        C      	LD	(SM.FKTAB+26H),HL
  7354'   21 73AB'       C      	LD	HL,KM.SR	;Taste:   SCH_RECHTS
  7357'   22 0D36        C      	LD	(SM.FKTAB+36H),HL
  735A'   21 7388'       C      	LD	HL,KM.CO	;Taste:   C_HOCH
  735D'   22 0D06        C      	LD	(SM.FKTAB+06H),HL
  7360'   21 73B0'       C      	LD	HL,KM.CR	;Taste:   C_RECHTS
  7363'   22 0D16        C      	LD	(SM.FKTAB+16H),HL
  7366'   21 7399'       C      	LD	HL,KM.CU	;Taste:   C_RUNTER
  7369'   22 0D18        C      	LD	(SM.FKTAB+18H),HL
  736C'   21 73A6'       C      	LD	HL,KM.CL	;Taste:   C_LINKS
  736F'   22 0D08        C      	LD	(SM.FKTAB+08H),HL
  7372'   21 73B5'       C      	LD	HL,KM.CNZA	;Taste:   C N Z A
  7375'   22 0D76        C      	LD	(SM.FKTAB+76H),HL
  7378'   21 73E5'       C      	LD	HL,KM.NEWL	;Taste:   E T 1
  737B'   22 0DAE        C      	LD	(KM.TNEWL),HL
  737E'   21 740A'       C      	LD	HL,KM.EINA	;alphanum. Tasten
  7381'   22 0DB0        C      	LD	(KM.TEINA),HL
                         C      
                         C      	; LD	HL,KM.UP13
                         C      	; LD	DE,KM.RAM
                         C      	; LD	BC,KM.UPEND-KM.UP13
                         C      	; LDIR
                         C      
  7384'   DD 21 2B01'    C      	LD	IX,KM.KMTAB
  7388'                  C      KM.CO:
  7388'   DD CB 00 7E    C      	BIT	7,(IX)
  738C'   C2 75C8'       C      	JP	NZ,KM.UP4-KM.UP13+KM.RAM
  738F'   CD 752E'       C      	CALL	KM.UP2	;KMBG Reservieren EIN
  7392'   31             C      	DB	31H
  7393'   C9             C      	RET
                         C      
                         C      	PAGE
'Kmbg'	MACRO-80 3.44	09-Dec-81	PAGE	1-85


                         C      
                         C      ;****************************************************************
                         C      ;*                  Auswertung der Cursor-Tasten                *
                         C      ;****************************************************************
  7394'                  C      KM.HOME:
  7394'   CD 752B'       C      	CALL	KM.UP1	;KMBG Kassette zurueckspulen
  7397'   21             C      	DB	21H
  7398'   C9             C      	RET
                         C      
  7399'                  C      KM.CU:
  7399'   CD 752E'       C      	CALL	KM.UP2	;KMBG Reservieren AUS
  739C'   41             C      	DB	41H
  739D'   C9             C      	RET
                         C      
  739E'                  C      KM.SL:
  739E'   CD 752E'       C      	CALL	KM.UP2	;KMBG vorh.  Datensatz anzeigen
  73A1'   15             C      	DB	15H
  73A2'   CD 752B'       C      	CALL	KM.UP1
  73A5'   02             C      	DB	2
  73A6'                  C      KM.CL:
  73A6'   CD 752E'       C      	CALL	KM.UP2	;KMBG einen  Datensatz zuruecksetzen
  73A9'   15             C      	DB	15H
  73AA'   C9             C      	RET
                         C      
  73AB'                  C      KM.SR:
  73AB'   CD 752B'       C      	CALL	KM.UP1	;KMBG nachf. Datensatz anzeigen
  73AE'   02             C      	DB	2
  73AF'   C9             C      	RET
                         C      
  73B0'                  C      KM.CR:
  73B0'   CD 752E'       C      	CALL	KM.UP2	;KMBG einen  Datensatz vorsetzen
  73B3'   11             C      	DB	11H
  73B4'   C9             C      	RET
                         C      
  73B5'                  C      KM.CNZA:
  73B5'   DD CB 00 7E    C      	BIT	7,(IX)
  73B9'   C0             C      	RET	NZ
  73BA'   3A 75DA'       C      	LD	A,(KM.TX2-KM.UP13+KM.RAM)
  73BD'   FE 6C          C      	CP	'l'
  73BF'   28 08          C      	JR	Z,KM.CNZA1
  73C1'   DD 36 07 00    C      	LD	(IX+7),0
  73C5'   DD 36 08 01    C      	LD	(IX+8),1
  73C9'                  C      KM.CNZA1:
  73C9'   3E 71          C      	LD	A,71H
  73CB'   DD B6 05       C      	OR	(IX+5)
  73CE'   DD 77 05       C      	LD	(IX+5),A
  73D1'   CD 753F'       C      	CALL	KM.UP5
  73D4'   DD 7E 05       C      	LD	A,(IX+5)
  73D7'   CD 752B'       C      	CALL	KM.UP1
  73DA'   02             C      	DB	2
  73DB'   CD 752E'       C      	CALL	KM.UP2
  73DE'   15             C      	DB	15H
  73DF'   DD 77 05       C      	LD	(IX+5),A
  73E2'   C3 75C8'       C      	JP	KM.UP4-KM.UP13+KM.RAM
                         C      ;****************************************************************
                         C      ;*                  Routine fuer die Taste   E T 1              *
                         C      ;****************************************************************
  73E5'                  C      KM.NEWL:
  73E5'   DD CB 00 7E    C      	BIT	7,(IX)
  73E9'   C0             C      	RET	NZ
  73EA'   21 0E66        C      	LD	HL,KM.PUFF
  73ED'   22 2BE0'       C      	LD	(KM.KMTAB+0DFH),HL	;2BE0
  73F0'   DD 7E 08       C      	LD	A,(IX+8)
  73F3'   3D             C      	DEC	A
  73F4'   E6 F0          C      	AND	0F0H
  73F6'   07             C      	RLCA
  73F7'   07             C      	RLCA
  73F8'   07             C      	RLCA
  73F9'   07             C      	RLCA
  73FA'   3C             C      	INC	A
  73FB'   32 2BEB'       C      	LD	(KM.KMTAB+0EAH),A	;2BEB
  73FE'   CD 2060        C      	CALL	KM.MHOME
  7401'   CD 23BA        C      	CALL	KM.MINSL
  7404'   CD 21EF        C      	CALL	ATACO
  7407'   C3 75C8'       C      	JP	KM.UP4-KM.UP13+KM.RAM
                         C      
                         C      	PAGE
'Kmbg'	MACRO-80 3.44	09-Dec-81	PAGE	1-86


                         C      
                         C      ;****************************************************************
                         C      ;*                  Auswertung der alphanumerischen Tasten      *
                         C      ;****************************************************************
  740A'                  C      KM.EINA:
  740A'   79             C      	LD	A,C
  740B'   21 0000        C      	LD	HL,0
  740E'   FE 72          C      	CP	'r'
  7410'   20 03          C      	JR	NZ,KM.EINA1
  7412'   21 7474'       C      	LD	HL,KM.EINAB
  7415'                  C      KM.EINA1:
  7415'   FE 7A          C      	CP	'z'
  7417'   20 03          C      	JR	NZ,KM.EINA2
  7419'   21 747F'       C      	LD	HL,KM.EINAC
  741C'                  C      KM.EINA2:
  741C'   FE 70          C      	CP	'p'
  741E'   20 03          C      	JR	NZ,KM.EINA3
  7420'   21 0000        C      	LD	HL,0
  7423'                  C      KM.EINA3:
  7423'   FE 63          C      	CP	'c'
  7425'   20 03          C      	JR	NZ,KM.EINA4
  7427'   21 0000        C      	LD	HL,0
  742A'                  C      KM.EINA4:
  742A'   22 0DA8        C      	LD	(KM.TTABU),HL
  742D'   FE 30          C      	CP	'0'
  742F'   38 04          C      	JR	C,KM.EINA5
  7431'   FE 47          C      	CP	'G'
  7433'   38 06          C      	JR	C,KM.EINA7
  7435'                  C      KM.EINA5:
  7435'   32 75DA'       C      	LD	(KM.TX2-KM.UP13+KM.RAM),A
  7438'                  C      KM.EINA6:
  7438'   C3 75C8'       C      	JP	KM.UP4-KM.UP13+KM.RAM
                         C      
  743B'                  C      KM.EINA7:
  743B'   3A 75DA'       C      	LD	A,(KM.TX2-KM.UP13+KM.RAM)
  743E'   FE 67          C      	CP	'g'
  7440'   20 10          C      	JR	NZ,KM.EINA8
  7442'   79             C      	LD	A,C
  7443'   D6 30          C      	SUB	30H
  7445'   D8             C      	RET	C
  7446'   C8             C      	RET	Z
  7447'   FE 03          C      	CP	3
  7449'   D0             C      	RET	NC
  744A'   DD 77 04       C      	LD	(IX+4),A
  744D'   CD 749F'       C      	CALL	KM.UP20
  7450'   18 E6          C      	JR	KM.EINA6
                         C      
  7452'                  C      KM.EINA8:
  7452'   FE 6C          C      	CP	'l'
  7454'   20 1D          C      	JR	NZ,KM.EINAA
  7456'   79             C      	LD	A,C
  7457'   D6 30          C      	SUB	30H
  7459'   FE 0A          C      	CP	00AH
  745B'   38 02          C      	JR	C,KM.EINA9
  745D'   D6 07          C      	SUB	7
  745F'                  C      KM.EINA9:
  745F'   5F             C      	LD	E,A
  7460'   16 00          C      	LD	D,0
  7462'   62             C      	LD	H,D
  7463'   DD 6E 08       C      	LD	L,(IX+8)
  7466'   29             C      	ADD	HL,HL
  7467'   29             C      	ADD	HL,HL
  7468'   29             C      	ADD	HL,HL
  7469'   29             C      	ADD	HL,HL
  746A'   19             C      	ADD	HL,DE
  746B'   DD 74 07       C      	LD	(IX+7),H
  746E'   DD 75 08       C      	LD	(IX+8),L
  7471'   18 C5          C      	JR	KM.EINA6
                         C      
  7473'                  C      KM.EINAA:
  7473'   C9             C      	RET
                         C      
  7474'                  C      KM.EINAB:
  7474'   CD 752E'       C      	CALL	KM.UP2
  7477'   08             C      	DB	8
  7478'   21 0000        C      	LD	HL,0
  747B'   22 0DA8        C      	LD	(SM.TABU),HL	;00DA8H
  747E'   C9             C      	RET
                         C      
  747F'                  C      KM.EINAC:
                         C      ;	LD	(IX+13),0	;???
                         C      ;	LD	(IX+14),0	;???
'Kmbg'	MACRO-80 3.44	09-Dec-81	PAGE	1-87


  747F'                  C      KM.EINAD:
  747F'   CD 752B'       C      	CALL	KM.UP1
  7482'   02             C      	DB	2
  7483'   DD 7E 07       C      	LD	A,(IX+7)
  7486'   DD B6 08       C      	OR	(IX+8)
  7489'   28 05          C      	JR	Z,KM.EINAE
                         C      ;	INC	(IX+13)	;???
  748B'   CD 7490'       C      	CALL	KM.EINAE
  748E'   18 EF          C      	JR	KM.EINAD
                         C      
  7490'                  C      KM.EINAE:
  7490'   CD 75C8'       C      	CALL	KM.UP4-KM.UP13+KM.RAM
  7493'   11 35E0        C      	LD	DE,SD.BWSA + 18*80 + 64	;5E0H
  7496'   CD 7563'       C      	CALL	KM.UP10
  7499'   62 7A 3A       C      	DB	'bz:'
  749C'   0D             C      	DB	00DH
  749D'   A0             C      	DB	20H+80H
  749E'   C9             C      	RET
                         C      
  749F'                  C      KM.UP20:
  749F'   DD 4E 03       C      	LD	C,(IX+3)
  74A2'   0C             C      	INC	C	;???
  74A3'   0C             C      	INC	C
  74A4'   0C             C      	INC	C
  74A5'   0C             C      	INC	C
  74A6'   ED 40          C      	IN	B,(C)
  74A8'   FE 01          C      	CP	1
  74AA'   20 04          C      	JR	NZ,KM.UP21
  74AC'   CB 48          C      	BIT	1,B
  74AE'   20 29          C      	JR	NZ,KM.UP25
  74B0'                  C      KM.UP21:
  74B0'   CB D8          C      	SET	3,B
  74B2'   18 06          C      	JR	KM.UP22
  74B4'   CB 40          C      	BIT	0,B
  74B6'   20 21          C      	JR	NZ,KM.UP25
  74B8'   CB D0          C      	SET	2,B
  74BA'                  C      KM.UP22:
  74BA'   ED 41          C      	OUT	(C),B
  74BC'   0C             C      	INC	C
  74BD'   ED 50          C      	IN	D,(C)
  74BF'   0D             C      	DEC	C
  74C0'   CB 90          C      	RES	2,B
  74C2'   CB 98          C      	RES	3,B
  74C4'   ED 41          C      	OUT	(C),B
  74C6'   FE 01          C      	CP	1
  74C8'   20 04          C      	JR	NZ,KM.UP23
  74CA'   CB 62          C      	BIT	4,D
  74CC'   18 02          C      	JR	KM.UP24
                         C      
  74CE'                  C      KM.UP23:
  74CE'   CB 5A          C      	BIT	3,D
  74D0'                  C      KM.UP24:
  74D0'   28 07          C      	JR	Z,KM.UP25
  74D2'   DD 36 00 00    C      	LD	(IX+0),0
  74D6'   C3 7388'       C      	JP	KM.CO
                         C      
  74D9'                  C      KM.UP25:
  74D9'   DD CB 00 FE    C      	SET	7,(IX+0)
  74DD'   C9             C      	RET
                         C      
                         C      	PAGE
'Kmbg'	MACRO-80 3.44	09-Dec-81	PAGE	1-88


                         C      
  74DE'                  C      KM.ABS:
  74DE'   21 3000        C      	LD	HL,SD.BWSA
  74E1'   06 11          C      	LD	B,17
  74E3'                  C      KM.ABS1:
  74E3'   C5             C      	PUSH	BC
  74E4'   CD 74ED'       C      	CALL	KM.UP30
  74E7'   C1             C      	POP	BC
  74E8'   10 F9          C      	DJNZ	KM.ABS1
  74EA'   C3 7500'       C      	JP	KM.UP36
                         C      
  74ED'                  C      KM.UP30:
  74ED'   CD 750C'       C      	CALL	KM.UP34
  74F0'   A0             C      	DB	0A0H
  74F1'   28 15          C      	JR	Z,KM.UP33
  74F3'   CD 750C'       C      	CALL	KM.UP34
  74F6'   50             C      	DB	050H
  74F7'   28 0C          C      	JR	Z,KM.UP32
  74F9'                  C      KM.UP31:
  74F9'   7E             C      	LD	A,(HL)
  74FA'   23             C      	INC	HL
  74FB'   CD 4040        C      	CALL	PRINT
  74FE'   10 F9          C      	DJNZ	KM.UP31
  7500'                  C      KM.UP36:
  7500'   3E 1E          C      	LD	A,1EH
  7502'   C3 4040        C      	JP	PRINT
                         C      
  7505'                  C      KM.UP32:
  7505'   CD 7500'       C      	CALL	KM.UP36
  7508'                  C      KM.UP33:
  7508'   23             C      	INC	HL
  7509'   10 FD          C      	DJNZ	KM.UP33
  750B'   C9             C      	RET
                         C      
  750C'                  C      KM.UP34:
  750C'   E3             C      	EX	(SP),HL
  750D'   46             C      	LD	B,(HL)
  750E'   23             C      	INC	HL
  750F'   E3             C      	EX	(SP),HL
  7510'   E5             C      	PUSH	HL
  7511'   CD 7518'       C      	CALL	KM.UP35
  7514'   E1             C      	POP	HL
  7515'   06 50          C      	LD	B,80
  7517'   C9             C      	RET
                         C      
  7518'                  C      KM.UP35:
  7518'   3E 20          C      	LD	A,' '
  751A'   BE             C      	CP	(HL)
  751B'   23             C      	INC	HL
  751C'   C0             C      	RET	NZ
  751D'   10 F9          C      	DJNZ	KM.UP35
  751F'   C9             C      	RET
                         C      
  7520'                  C      KM.DEL:
  7520'   DD CB 00 BE    C      	RES	7,(IX+0)
  7524'   DD 36 01 00    C      	LD	(IX+1),0
  7528'   C3 75C8'       C      	JP	KM.UP4-KM.UP13+KM.RAM
                         C      
                         C      	PAGE
'Kmbg'	MACRO-80 3.44	09-Dec-81	PAGE	1-89


                         C      
                         C      ;****************************************************************
                         C      ;*                  Unterprogramme                              *
                         C      ;****************************************************************
  752B'                  C      KM.UP1:
  752B'   CD 754B'       C      	CALL	KM.LOE1
  752E'                  C      KM.UP2:
  752E'   DD CB 00 7E    C      	BIT	7,(IX)
  7532'   28 02          C      	JR	Z,KM.UP3
  7534'   E1             C      	POP	HL
  7535'   C0             C      	RET	NZ
  7536'                  C      KM.UP3:
  7536'   E3             C      	EX	(SP),HL
  7537'   F5             C      	PUSH	AF
  7538'   7E             C      	LD	A,(HL)
  7539'   23             C      	INC	HL
  753A'   DD 77 05       C      	LD	(IX+5),A
  753D'   F1             C      	POP	AF
  753E'   E3             C      	EX	(SP),HL
  753F'                  C      KM.UP5:
  753F'   CD 55D5'       C      	CALL	KM.KARO
  7542'   21 5F63'       C      	LD	HL,FD.DASU	;05C01H
  7545'   22 0D8E        C      	LD	(SM.FKTAB+8EH),HL	;SM.ZSMER , SM.ZSTC
  7548'   C3 75C8'       C      	JP	KM.UP4-KM.UP13+KM.RAM
                         C      
  754B'                  C      KM.LOE1:
  754B'   21 0E65        C      	LD	HL,KM.PUFF-1
  754E'   36 00          C      	LD	(HL),0
  7550'   01 0103        C      	LD	BC,103H
  7553'   18 08          C      	JR	KM.LOE3
  7555'                  C      KM.LOE2:
  7555'   21 3000        C      	LD	HL,SD.BWSA
  7558'   01 077F        C      	LD	BC,24*80 -1 ;007FFH ??? (25*80-1 = 07CFH; 07FFH-07CFH=30H=48)
  755B'   36 20          C      	LD	(HL),' '
  755D'                  C      KM.LOE3:
  755D'   E5             C      	PUSH	HL
  755E'   D1             C      	POP	DE
  755F'   13             C      	INC	DE
  7560'   ED B0          C      	LDIR
  7562'   C9             C      	RET
                         C      
  7563'                  C      KM.UP10:
  7563'   E3             C      	EX	(SP),HL
  7564'                  C      KM.UP11:
  7564'   7E             C      	LD	A,(HL)
  7565'   E6 7F          C      	AND	07FH
  7567'   FE 20          C      	CP	' '
  7569'   38 02          C      	JR	C,KM.UP12
  756B'   12             C      	LD	(DE),A
  756C'   13             C      	INC	DE
  756D'                  C      KM.UP12:
  756D'   DC 75AC'       C      	CALL	C,KM.UP13-KM.UP13+KM.RAM
  7570'   CB 7E          C      	BIT	7,(HL)
  7572'   23             C      	INC	HL
  7573'   28 EF          C      	JR	Z,KM.UP11
  7575'   E3             C      	EX	(SP),HL
  7576'   C9             C      	RET
                         C      
  7577'                  C      KM.UP41:
  7577'   11 3000        C      	LD	DE,SD.BWSA
  757A'   DD 7E 08       C      	LD	A,(IX+8)
  757D'   B7             C      	OR	A
  757E'   20 0C          C      	JR	NZ,KM.UP42
  7580'   DD CB 07 46    C      	BIT	0,(IX+7)
  7584'   C8             C      	RET	Z
  7585'   F5             C      	PUSH	AF
  7586'   CD 201D        C      	CALL	KM.MANZ
  7589'   F1             C      	POP	AF
  758A'   D6 10          C      	SUB	10H
  758C'                  C      KM.UP42:
  758C'   F5             C      	PUSH	AF
  758D'   CD 201D        C      	CALL	KM.MANZ
  7590'   F1             C      	POP	AF
  7591'   D6 10          C      	SUB	10H
  7593'   C8             C      	RET	Z
  7594'   D8             C      	RET	C
  7595'   18 F5          C      	JR	KM.UP42
                         C      
  7597'                  C      KM.UP43:
  7597'   FE 1E          C      	CP	01EH
  7599'   C8             C      	RET	Z
  759A'   FE 0A          C      	CP	00AH
'Kmbg'	MACRO-80 3.44	09-Dec-81	PAGE	1-90


  759C'   C8             C      	RET	Z
  759D'   FE 0D          C      	CP	00DH
  759F'   C8             C      	RET	Z
  75A0'   B7             C      	OR	A
  75A1'   C8             C      	RET	Z
  75A2'   FE 20          C      	CP	' '
  75A4'   38 03          C      	JR	C,KM.UP44
  75A6'   FE 80          C      	CP	080H
  75A8'   D8             C      	RET	C
  75A9'                  C      KM.UP44:
  75A9'   3E 7F          C      	LD	A,07FH
  75AB'   C9             C      	RET
                         C      
                         C      	PAGE
'Kmbg'	MACRO-80 3.44	09-Dec-81	PAGE	1-91


                         C      
                         C      ;	ORG	00300H
                         C      
  75AC'   32 75B1'       C      KM.UP13:	LD	(KM.UP15-KM.UP13+KM.RAM-1),A	;???
  75AF'   DD 7E 01       C      	LD	A,(IX+1)	;<<<
  75B2'                  C      KM.UP15:
  75B2'   EB             C      	EX	DE,HL
  75B3'   77             C      	LD	(HL),A
  75B4'   3E 33          C      	LD	A,33H
  75B6'   ED 67          C      	RRD
  75B8'   EB             C      	EX	DE,HL
  75B9'   F5             C      	PUSH	AF
  75BA'   1A             C      	LD	A,(DE)
  75BB'   CD 75BF'       C      	CALL	KM.UP14-KM.UP13+KM.RAM
  75BE'   F1             C      	POP	AF
  75BF'                  C      KM.UP14:
  75BF'   FE 3A          C      	CP	03AH
  75C1'   38 02          C      	JR	C,$+4	;---!
  75C3'   C6 07          C      	ADD	A,7	;   !
  75C5'   12             C      	LD	(DE),A	;<--!
  75C6'   13             C      	INC	DE
  75C7'   C9             C      	RET
                         C      
  75C8'                  C      KM.UP4:
  75C8'   F5             C      	PUSH	AF
  75C9'   CD 7555'       C      	CALL	KM.LOE2
  75CC'   DD 7E 04       C      	LD	A,(IX+4)
  75CF'   C6 30          C      	ADD	A,30H
  75D1'   32 75DE'       C      	LD	(KM.TX1-KM.UP13+KM.RAM),A
  75D4'   11 35A0        C      	LD	DE,SD.BWSA + 18*80 ;5A0H
  75D7'   CD 7563'       C      	CALL	KM.UP10
  75DA'                  C      KM.TX2:
  75DA'   67 20          C      	DB	'g '
  75DC'   04             C      	DB	004H
  75DD'   28             C      	DB	'('	;<<<
  75DE'                  C      KM.TX1:
  75DE'   32 29          C      	DB	'2)'	;<<<
  75E0'   BA             C      	DB	3AH+80H	;":"
  75E1'   11 35AE        C      	LD	DE,SD.BWSA + 18*80 + 14 ;5AEH	;18*80 +20	;5B4H
  75E4'   CD 7563'       C      	CALL	KM.UP10
  75E7'   6C 3A          C      	DB	'l:'
  75E9'   09             C      	DB	9
  75EA'   0A             C      	DB	10
  75EB'   20 73 3A       C      	DB	' s:'
  75EE'   00             C      	DB	0
  75EF'   2F             C      	DB	'/'
  75F0'   01             C      	DB	1
  75F1'   20 20 20 20    C      	DB	'      '
  75F5'   20 20          C      
  75F7'   AD             C      	DB	2DH+80H	;"-"
  75F8'   1B             C      	DEC	DE
  75F9'   1B             C      	DEC	DE
  75FA'   1B             C      	DEC	DE
  75FB'   21 0E65        C      	LD	HL,KM.PUFF-1
  75FE'   7E             C      	LD	A,(HL)
  75FF'   23             C      	INC	HL
  7600'   CD 75B2'       C      	CALL	KM.UP15-KM.UP13+KM.RAM
  7603'   13             C      	INC	DE
  7604'   DD 46 08       C      	LD	B,(IX+8)
  7607'   E5             C      	PUSH	HL
  7608'   23             C      	INC	HL
  7609'   10 FD          C      	DJNZ	$-1
  760B'   7E             C      	LD	A,(HL)
  760C'   CD 75B2'       C      	CALL	KM.UP15-KM.UP13+KM.RAM
  760F'   23             C      	INC	HL
  7610'   7E             C      	LD	A,(HL)
  7611'   CD 75B2'       C      	CALL	KM.UP15-KM.UP13+KM.RAM
  7614'   E1             C      	POP	HL
  7615'   E5             C      	PUSH	HL
  7616'   11 3640        C      	LD	DE,SD.BWSA + 20*80	;640H
  7619'   06 00          C      	LD	B,0
  761B'   7E             C      	LD	A,(HL)
  761C'   CD 7597'       C      	CALL	KM.UP43
  761F'   12             C      	LD	(DE),A
  7620'   23             C      	INC	HL
  7621'   13             C      	INC	DE
  7622'   10 F7          C      	DJNZ	$-7
  7624'   E1             C      	POP	HL
  7625'                  C      KM.UP40:
  7625'   CD 7577'       C      	CALL	KM.UP41
  7628'   F1             C      	POP	AF
  7629'   C9             C      	RET
'Kmbg'	MACRO-80 3.44	09-Dec-81	PAGE	1-92


                         C      
  762A'                  C      KM.UPEND	EQU	$
                         C      
                         C      ;SM.FKTAB	EQU	00D00H
  0DA8                   C      KM.TTABU  EQU	00DA8H
  0DAE                   C      KM.TNEWL  EQU	00DAEH
  0DB0                   C      KM.TEINA  EQU	00DB0H
  0E66                   C      KM.PUFF   EQU	00E66H
                         C      
  201D                   C      KM.MANZ   EQU	0201DH
  2060                   C      KM.MHOME  EQU	02060H
  23BA                   C      KM.MINSL  EQU	023BAH
                         C      ;ATACO    EQU	024F8H
                         C      
  2B01'                  C      KM.KMTAB  EQU	UB.KTAB
                         C      ;         DEFS  17,0
                         C      ;SD.BWSA  EQU	03000H
                         C      
  55D5'                  C      KM.KARO   EQU	KR.KARO   ;05A93H
                         C      
                         C      ;DRUZ     EQU	07C00H
                         C      
  75AC'                  C      KM.RAM    EQU	KM.UP13   ;0FF80H
                         C      
                         C      			;(C) Rainer Sieber     A d W
                         C      
                         C      
                         C      ;	END
                                
                                	TITLE ''
                                	END
''	MACRO-80 3.44	09-Dec-81	PAGE	S


Macros:

Symbols:
21EF 	ATACO           0001 	BC.AGG          0000 	BC.EGG          
FA3A 	BC.END          E000 	BC.TAB1         F902 	BC.TAB2         
F96A 	BC.TAB2A        F9D2 	BC.TAB3         E002 	BC.VTABA        
EC82 	BC.VTABE        7158'	CP.COMPR        71BB'	CP.INIT         
718B'	CP.KOM          715D'	CP.NL           718B'	CP.OUT          
716B'	CP.OUTT         7192'	CP.SOKOM        71A8'	CP.SOSTR        
7170'	CP.SPACE        7167'	CP.STRNG        71AD'	CP.TAB          
717B'	CP.TEXT         54F7'	CRC0            54FB'	CRC1            
550E'	CRC2            71C1'	DC.DCMPR        71F7'	DC.EOSPC        
71FC'	DC.INIT         71C3'	DC.NL           71E7'	DC.SPACE        
71DD'	DC.TAB          71CF'	DC.TEXT         6239'	FD.BMGF         
5F63'	FD.DASU         609D'	FD.DECBZ        6154'	FD.DECHL        
6214'	FD.DSPBB        6224'	FD.DSPBG        61C9'	FD.END          
61F2'	FD.FDIN2        5FB0'	FD.FDINP        6003'	FD.FDOUT        
6067'	FD.FDOW1        606B'	FD.FDOW2        6090'	FD.FDOW3        
6082'	FD.FDOW4        6057'	FD.FDOWR        60A7'	FD.FDUP         
61D0'	FD.FOLWR        615D'	FD.FOUT1        60E9'	FD.FSTRT        
5F5C'	FD.KO01         5F44'	FD.POSK         622E'	FD.RDEND        
5FF7'	FD.SDIN         60D9'	FD.SDK0         60E3'	FD.SDK1         
60CF'	FD.SDK2         6051'	FD.SDOUT        60BF'	FD.SDOW         
6136'	FD.SETJ         614E'	FD.SETN         6121'	FD.STRT1        
5F7F'	FD.WRRES        5400'	K1.BRKMB        54F4'	K1.CRC          
5441'	K1.KERN         5E90'	KH.ANZB1        5E9B'	KH.ANZB2        
5EA3'	KH.ANZB3        5EA5'	KH.ANZB4        5E8D'	KH.ANZBL        
5EC5'	KH.AZ1Z         5EF6'	KH.AZ4B0        5F17'	KH.AZ4B1        
5F06'	KH.AZ4B3        5EF2'	KH.AZ4BY        5EE9'	KH.AZADR        
5EAC'	KH.AZBL1        5EA9'	KH.AZBLD        5F36'	KH.BILO         
5F30'	KH.BLEV1        5F32'	KH.BLEV2        5F1B'	KH.BLEVG        
5E49'	KH.BMM          5E41'	KH.BMP          5E1B'	KH.KSRA         
5DD6'	KH.KSRE         5E27'	KH.KSRM         5E2A'	KH.KSRP         
5DD9'	KH.KSRW         5DD9'	KH.RD1          5EBC'	KH.RD2          
5DE2'	KH.RD3          5E5A'	KH.RDBA         5E6B'	KH.RDBM         
5E7C'	KH.RDSL         5DCB'	KH.RDSTA        5DD6'	KH.RES          
5E54'	KH.SYSRT        5E50'	KH.WBM          5E4E'	KH.WREC         
5E52'	KH.WSL          5A6B'	KI.KM           5A2C'	KI.KN           
5AD2'	KI.KO03         5A4F'	KI.NMR          5ADD'	KI.RENA         
5AFA'	KI.RENA9        5AB4'	KI.VERZ         74DE'	KM.ABS          
74E3'	KM.ABS1         7336'	KM.ANF          73A6'	KM.CL           
73B5'	KM.CNZA         73C9'	KM.CNZA1        7388'	KM.CO           
73B0'	KM.CR           7399'	KM.CU           7520'	KM.DEL          
740A'	KM.EINA         7415'	KM.EINA1        741C'	KM.EINA2        
7423'	KM.EINA3        742A'	KM.EINA4        7435'	KM.EINA5        
7438'	KM.EINA6        743B'	KM.EINA7        7452'	KM.EINA8        
745F'	KM.EINA9        7473'	KM.EINAA        7474'	KM.EINAB        
747F'	KM.EINAC        747F'	KM.EINAD        7490'	KM.EINAE        
7394'	KM.HOME         55D5'	KM.KARO         2B01'	KM.KMTAB        
754B'	KM.LOE1         7555'	KM.LOE2         755D'	KM.LOE3         
201D 	KM.MANZ         2060 	KM.MHOME        23BA 	KM.MINSL        
73E5'	KM.NEWL         0E66 	KM.PUFF         75AC'	KM.RAM          
739E'	KM.SL           73AB'	KM.SR           0DB0 	KM.TEINA        
0DAE 	KM.TNEWL        0DA8 	KM.TTABU        75DE'	KM.TX1          
75DA'	KM.TX2          752B'	KM.UP1          7563'	KM.UP10         
7564'	KM.UP11         756D'	KM.UP12         75AC'	KM.UP13         
75BF'	KM.UP14         75B2'	KM.UP15         752E'	KM.UP2          
749F'	KM.UP20         74B0'	KM.UP21         74BA'	KM.UP22         
74CE'	KM.UP23         74D0'	KM.UP24         74D9'	KM.UP25         
7536'	KM.UP3          74ED'	KM.UP30         74F9'	KM.UP31         
7505'	KM.UP32         7508'	KM.UP33         750C'	KM.UP34         
7518'	KM.UP35         7500'	KM.UP36         75C8'	KM.UP4          
7625'	KM.UP40         7577'	KM.UP41         758C'	KM.UP42         
7597'	KM.UP43         75A9'	KM.UP44         753F'	KM.UP5          
762A'	KM.UPEND        54EA'	KOMED           55D1'	KR.CKRA         
5520'	KR.GR1          552A'	KR.GR2          552C'	KR.GR3          
55D5'	KR.KARO         565D'	KR.TYPT         55D9'	KR.VORSP        
6A86'	KU.DD           6A83'	KU.DECIY        6A1E'	KU.TAB2L        
6A15'	KU.VVOR         6A56'	KU.ZEIR         5B73'	KV.ANF          
5D96'	KV.ANZ          5C43'	KV.AUSG         5DAC'	KV.AVZS         
5D1E'	KV.BSTR         5D81'	KV.DBCVM        5D06'	KV.DRU          
5D04'	KV.DRU1         5D13'	KV.KO02         5CB8'	KV.KRW          
5CEC'	KV.P1           5D8C'	KV.SBC          5D4B'	KV.SPTR         
5BDC'	KV.TABTR        5C22'	KV.ZEIHO        5BA7'	KV.ZLTR         
6735'	KX.ENDR         6754'	KX.EXEC2        672A'	KX.RSPFR        
6784'	KX.UPA          6A0E'	KY.AJ           6830'	KY.ATAA         
6853'	KY.ATAB         6864'	KY.ATABE        68F5'	KY.COPY         
67BF'	KY.DFR          69A2'	KY.EOV          68B1'	KY.EVZ          
68B4'	KY.EVZ1         69E1'	KY.EWK          682D'	KY.EZYK1        
69F1'	KY.JHL          6955'	KY.KOP          696F'	KY.KOPAN        
694F'	KY.KOPV         67A1'	KY.MD           6827'	KY.NDA          
6898'	KY.NE           69FA'	KY.SATR         6819'	KY.SVGL         
''	MACRO-80 3.44	09-Dec-81	PAGE	S-1


6919'	KY.VSCHR        68CC'	KY.VSTR         680E'	KY.VZVGL        
6872'	KY.WEI          6886'	KY.ZYK          6281'	LD.DATFU        
625C'	LD.DATN         62A2'	LD.DATPO        631D'	LD.LAD1         
630C'	LD.LAD2         6309'	LD.LADER        6332'	LD.LADF         
6271'	LD.LD2          627B'	LD.LD21         6304'	LD.LD3          
62C2'	LD.LD4          62DD'	LD.LD5          6329'	LD.LDEND        
62FA'	LD.START        6AFC'	POSIK1          4040 	PRINT           
4070 	PUF.KASS        6338'	RL.BEG          6444'	RL.BF           
6430'	RL.DATNV        642B'	RL.ECHO         6446'	RL.FMELD        
63C9'	RL.M10          63DA'	RL.M11          6369'	RL.M12          
63A7'	RL.M13          63B7'	RL.M14          63BF'	RL.M15          
6358'	RL.M16          6386'	RL.M17          63ED'	RL.M21          
6440'	RL.MN           6434'	RL.OB           6438'	RL.RA           
643C'	RL.SV           634D'	RL.UG           63E0'	RL.UP6          
54E2'	RLAD            54DD'	RRET            3000 	SD.BWSA         
0D00 	SM.FKTAB        0DA8 	SM.TABU         54D9'	STF07           
54CF'	STF99           54D6'	STFRS           548D'	STT02           
54AB'	STT08           5465'	STT11           5465'	STT15           
5465'	STT21           5465'	STT31           5465'	STT41           
547E'	STT5            5471'	STT51           5475'	STT61           
5479'	STT71           5479'	STT75           6554'	SV.BYANZ        
65E5'	SV.DALO1        6482'	SV.DATN         655F'	SV.DATS1        
6499'	SV.DATV1        64A1'	SV.DATVO        6579'	SV.SAVE         
658A'	SV.SAVE1        64DB'	SV.SAVE3        64F0'	SV.SAVE4        
6538'	SV.SAVE5        652E'	SV.SAVE6        65DD'	SV.STAD0        
6475'	SV.SV20         648D'	SV.SV21         64A7'	SV.SV30         
64C1'	SV.SV31         64AF'	SV.SV37         65CD'	SV.SVEN1        
65CA'	SV.SVEN2        65A1'	SV.SVLS         65BD'	SV.SVLS1        
65A7'	SV.SVLS2        65F0'	SV.SVSZ         6604'	SV.SVSZ1        
65F2'	SV.SVSZ2        4036 	SY.RESC         4033 	SY.SETCHL       
000B 	SY.SYSTB        4026 	TA.ABFR1        6D24'	U1.AUS          
6E57'	U1.BILO         6CD8'	U1.BREAD        6CE3'	U1.BWRIT        
6CBE'	U1.CLRB         6CF2'	U1.COPB         6CEE'	U1.COPB2        
6D44'	U1.DSVG         6D1B'	U1.EIN          6E51'	U1.INFO         
6CCD'	U1.KBR4         6E8C'	U1.KRWE         6DA9'	U1.KTIN1        
6D90'	U1.KTINI        6D75'	U1.NMVGL        6E75'	U1.PRADR        
6CB5'	U1.RRST         6CAD'	U1.RSAVE        6E4C'	U1.TR           
6E6B'	U1.TST          6DBE'	U1.VERIN        6DC6'	U1.VERNI        
6DE8'	U1.VORS1        6DE0'	U1.VORST        6D2D'	U1.VS1          
6D34'	U1.VSX          6DF4'	U1.VZS          6CD7'	U1.WAIT         
59B7'	UA.ALTR         599E'	UA.ANZWD        5870'	UA.BMGF         
5881'	UA.DF           587A'	UA.DOK          5741'	UA.DS           
57FE'	UA.EABFR        586A'	UA.FRZ          57B9'	UA.GER          
5761'	UA.KNAME        5787'	UA.KOMMT        57C8'	UA.KOPFR        
5973'	UA.LD           5774'	UA.NR           58D4'	UA.STADR        
5834'	UA.VORH         579A'	UA.Z7E          5953'	UA.ZKBA         
58AE'	UA.ZKBEG        592D'	UA.ZKBEL        5940'	UA.ZKBLG        
595D'	UA.ZKBM         5888'	UA.ZKDAT        58E7'	UA.ZKDL         
5973'	UA.ZKEE         58C1'	UA.ZKEND        58FA'	UA.ZKF          
589B'	UA.ZKLAD        5905'	UA.ZKRES        5918'	UA.ZKSDT        
5966'	UA.ZKSL         5985'	UA.ZRSCH        2B64'	UB.DTAB         
2B8D'	UB.END          2B01'	UB.KTAB         2B1C'	UB.PAR1         
2B1E'	UB.PAR2         2B20'	UB.PAR3         2B22'	UB.PAR4         
2B24'	UB.PAR5         2B26'	UB.PATAB        2B2A'	UB.SATZ         
2B00'	UB.ZN           7098'	UC.ASCCO        7075'	UC.CKONV        
6F3F'	UC.CVABX        6F5A'	UC.CVAX         6F6E'	UC.CVAXB        
7038'	UC.CVBC         6FC8'	UC.CVBD         6FD3'	UC.CVBD0        
6FC6'	UC.CVBD1        6FC2'	UC.CVBD2        6FBE'	UC.CVBD3        
6FBA'	UC.CVBD4        6FB6'	UC.CVBD5        6F49'	UC.CVBX         
7049'	UC.CVCB         7030'	UC.CVD1B        7007'	UC.CVDB         
6F65'	UC.CVHLX        6F90'	UC.CVX1B        6FAB'	UC.CVXA         
6F7F'	UC.CVXB         6F99'	UC.CVXER        6F31'	UC.DIVR         
706A'	UC.DK1          707E'	UC.DK2          70F8'	UC.DKOI         
7056'	UC.DKONV        6F18'	UC.HL10C        6F11'	UC.HL10N        
7060'	UC.KONV         7094'	UC.KONV2        5400'	UE.BRKMB        
3000 	UE.BWSA         0060 	UE.COTAL        54F4'	UE.CRC          
0DC4 	UE.EDEND        0132 	UE.KMPUL        8010 	UE.KPUFF        
0E66 	UE.PUF          0CFE 	UE.STANF        007D 	UE.SVL          
000B 	UE.SYSTB        00F7 	UE.TACL         00F9 	UE.TACR         
001E 	UE.TAQUI        00CD 	UE.TASYS        8830 	UE.TEXAN        
0E5A 	UE.ZEIN         56E3'	UF.AZVB         5718'	UF.BEHB         
5720'	UF.BEHB1        5697'	UF.ERANZ        5668'	UF.EXEC         
568E'	UF.EXEC1        568B'	UF.EXEC2        5735'	UF.FL14         
5738'	UF.FL16         5732'	UF.FL17         5726'	UF.FL18         
5663'	UF.RET          56D3'	UF.SYS          56DF'	UF.SYS1         
7202'	UK.GETK         7223'	UK.GETK2        722B'	UK.GETK3        
7231'	UK.GETK4        7227'	UK.GETK5        72F0'	UK.KBA          
7262'	UK.KBW          72A1'	UK.KBW1         729D'	UK.KBW2         
723F'	UK.KLPFB        72CB'	UK.KSPFB        72A7'	UK.PUTK         
6C61'	UR.ALPH1        6C58'	UR.ALPHA        6C6C'	UR.ALPNU        
6B93'	UR.BBSA1        6B8B'	UR.BBSAD        6C9D'	UR.BILR1        
6C8B'	UR.BILRO        6B28'	UR.BM           6B9B'	UR.DSPZK        
6C76'	UR.HEXAZ        6C83'	UR.HEXZ1        6AD5'	UR.KBM          
''	MACRO-80 3.44	09-Dec-81	PAGE	S-2


6AE7'	UR.KBR          6AE1'	UR.KBV          6ACF'	UR.KLR          
6AC9'	UR.KLV          6AC3'	UR.KRA          6AB1'	UR.KRE          
6AB5'	UR.KRE1         6AB9'	UR.KRW          6ABF'	UR.KRWW         
6ADB'	UR.KSL          6B01'	UR.LES          6B59'	UR.MIMO         
6B75'	UR.MIMO1        6B6D'	UR.MIMO2        6B7C'	UR.MIMO3        
6C63'	UR.NUM          6B36'	UR.OK           6AF6'	UR.POSIK        
6BEB'	UR.RET0         6AED'	UR.RPOS         6B55'	UR.RSP          
6C85'	UR.TAREP        6BF5'	UR.TCL          6C07'	UR.TCLN         
6C0A'	UR.TCR          6C1B'	UR.TCRN         6C25'	UR.TQUIT        
6C1D'	UR.TSYS         6BA8'	UR.ZINP         6BAE'	UR.ZINP1        
6BB1'	UR.ZINP2        6BDF'	UR.ZINP3        6BE5'	UR.ZINP4        
6BCD'	UR.ZINP5        6BEE'	UR.ZINP7        6C53'	UR.ZKON1        
6C2D'	UR.ZKONT        6E93'	XY.CALP1        6E9C'	XY.CALPE        
6EE7'	XY.INCDX        6F00'	XY.JMPDX        6EA7'	XY.LDDX         
6EB7'	XY.LIDX         6EC7'	XY.STDX         6ED7'	XY.STIDX        



No Fatal error(s)


    
6C0A'	UR.TCR          6C1B'	UR.TCRN         6C25'	UR.TQUIT        
6C1D'	UR.TSYS