'EQUAL - Anweisungen fuer Assembler'	MACRO-80 3.44	09-Dec-81	PAGE	1


                                	TITLE 'EQUAL - Anweisungen fuer Assembler'
                                	PAGE	87
'EQUAL - Anweisungen fuer Assembler'	MACRO-80 3.44	09-Dec-81	PAGE	1-1


                                
  000B                          SY.SYSTB  EQU	0000BH
  0CE0                          SM.STACK  EQU	00CE0H
  0CE0                          SM.FKTAB  EQU	00CE0H
  0DAA                          SM.TABU   EQU	00DAAH
  0DC6                          SM.END    EQU	00DC6H  ;Position Textende
  0E5A                          SM.ZEIN   EQU	00E5AH  ;Zaehler Eingabe
  0E65                          SM.PUFFS  EQU	00E65H  ;Eingabepuffer
  8010                          SD.PFFI   EQU	08010H  ;Eingabepuffer
  8830                          SD.TPA    EQU	08830H  ;Anf.adr. Textpuffer
  225C                          ATACO     EQU	0225CH
  3000                          SD.BWSA   EQU	03000H
  4026                          TA.ABFR1  EQU	04026H
  4033                          SY.SETCHL EQU	04033H
  4036                          SY.RESC   EQU	04036H
  4040                          PRINT     EQU	04040H
  4070                          PUF.KASS  EQU	04070H
                                
                                	ORG	00000H
  0000*                         	DEFS	05400H,0
                         C      	INCLUDE K0.MAC	;EQUAL - Anweisungen fuer Assembler
                         C      ;         PN    UE01
                         C      ;****************************************************************
                         C      ;*                  EQUAL - Anweisungen fuer Assembler          *
                         C      ;****************************************************************
  0030                   C      AKB      EQU	030H    ;IO-Adresse der AKB
  0080                   C      MaxBL    EQU	080H    ;max. Blocklaenge
                         C      
  00F7                   C      UE.TACL  EQU	0F7H    ;Kursor nach links
  00F9                   C      UE.TACR  EQU	0F9H    ; ''    nach rechts
  00CD                   C      UE.TASYS EQU	0CDH    ;SYS-Taste
  001E                   C      UE.TAQUI EQU	01EH    ;ET1
  007D                   C      UE.SVL   EQU	07DH    ;Laenge der SAVE-Bloecke
  0060                   C      UE.COTAL EQU	060H    ;Laenge ASC/KOI Codetabelle
  0132                   C      UE.KMPUL EQU	132H    ;max. Laenge E/A-Puffer
                         C      
  000B                   C      UE.SYSTB EQU	SY.SYSTB
  0CE0                   C      UE.STANF EQU	SM.STACK
  0DC6                   C      UE.EDEND EQU	SM.END   ;Speicherpl. fuer Adr. Editorende
  0E5A                   C      UE.ZEIN  EQU	SM.ZEIN  ;Pufferzaehler Eingabe
  0E65                   C      UE.PUF   EQU	SM.PUFFS ;System-Puffer
  3000                   C      UE.BWSA  EQU	SD.BWSA  ;Bildwiederholspeicher
  8010                   C      UE.KPUFF EQU	SD.PFFI  ;E/A Puffer
  8830                   C      UE.TEXAN EQU	SD.TPA   ;Begin Editorraum
                         C      
  5AB0*                  C      UE.BRKMB EQU	K1.BRKMB ;04000H	;phys. Kass.Routine
  5BAF*                  C      UE.CRC   EQU	K1.CRC   ;04740H	;CRC-Berechnung
                         C      
                         C      ;         END
                         C      ;         PN    UB
                         C                ORG   2B00H
  2B00*                  C      UB.ZN:    DS	1,0
  2B01*                  C      K0.HSB:   DS	1,0   ;HS-Bereich
  2B02*                  C      K0.LPD:   DS	1,0   ;Laenge der Daten im Puffer
  2B03*                  C      UB.KTAB:  DS	27,0  ;Originale Tabelle nach Robotron
  2B1E*                  C      UB.KTABE: DS	8,0   ;Tabelle fuer Kassetten im DEG2000 Emulator
  2B26*   0000           C      UB.PAR1:  DW	0
  2B28*   0000           C      UB.PAR2:  DW	0
  2B2A*   0000           C      UB.PAR3:  DW	0
  2B2C*   0000           C      UB.PAR4:  DW	0
  2B2E*   0000           C      UB.PAR5:  DW	0
  2B30*                  C      UB.PATAB: DS	4,0
  2B34*   00             C      UB.SATZ:  DB	0
  2B35*   37             C                DB	55
  2B36*   80             C                DB	80H
  2B37*                  C                DS	55,' '
  2B6E*                  C      UB.DTAB:  DS	41,0
  2B97*                  C      UB.END    EQU	$
                         C      ;         END
                         C      ;         PN    BC
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;        BEREICHE FUER KASSETTENKOPIEREN
                         C      ;
                         C      ;----------------------------------------------------------------------
  0000                   C      BC.EGG     EQU	0	;EINGABEGERAET
  0001                   C      BC.AGG     EQU	1	;AUSGABEGERAET
                         C      
                         C      ;	ORG	0E000H
  E000                   C      BC.TAB1    EQU	0E000H               ;Subadresse fuer Input -Kassette
                         C      ;          EQU	0E001H               ;Subadresse fuer Output-Kassette
  E002                   C      BC.VTABA   EQU	BC.TAB1  +    2
'EQUAL - Anweisungen fuer Assembler'	MACRO-80 3.44	09-Dec-81	PAGE	1-2


  EC82                   C      BC.VTABE   EQU	BC.VTABA + 3200
  F902                   C      BC.TAB2    EQU	BC.VTABE + 3200
  F96A                   C      BC.TAB2A   EQU	BC.TAB2  +  104
  F9D2                   C      BC.TAB3    EQU	BC.TAB2A +  104
  FA3A                   C      BC.END     EQU	BC.TAB3  +  104
                         C      ;         END
                                ;
                                	ORG	05400H
                                ;
                                ;	INCLUDE	U1.MAC	;Allgemeine Unterprogramme
                                ;	INCLUDE	XY.MAC	;Handling f. IX/IY-adressierte Bereiche
                                ;	INCLUDE	UC.MAC	;Konvertierungen
                                ;	INCLUDE	CP.MAC	;Komprimierung
                                ;	INCLUDE	DC.MAC	;Dekomprimierung
                                ;	INCLUDE UR.MAC	;Routinen fuer Monitor UND Tastatur
                         C      	INCLUDE K1.MAC	;Allgemeine Unterprogramme
                         C      	TITLE	'Allgemeine Unterprogramme'
                         C      	PAGE
'Allgemeine Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-3


                         C      
                         C      ;	PN	U1
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;        Allgemeine Unterprogramme
                         C      ;
                         C      ;----------------------------------------------------------------------
  5400*                  C      U1.RSAVE:
  5400*   E3             C      	EX	(SP),HL      ;Register retten (nicht AF)
  5401*   D5             C      	PUSH	DE
  5402*   C5             C      	PUSH	BC
  5403*   FD E5          C      	PUSH	IY
  5405*   DD E5          C      	PUSH	IX
  5407*   E9             C      	JP	(HL)
  5408*                  C      U1.RRST:
  5408*   E1             C      	POP	HL           ;Register wieder herstellen
  5409*   DD E1          C      	POP	IX
  540B*   FD E1          C      	POP	IY
  540D*   C1             C      	POP	BC
  540E*   D1             C      	POP	DE
  540F*   E3             C      	EX	(SP),HL
  5410*   C9             C      	RET
  5411*                  C      U1.CLRB:
  5411*   E5             C      	PUSH	HL           ;Bereich loeschen
  5412*   D5             C      	PUSH	DE
  5413*   C5             C      	PUSH	BC
  5414*   E5             C      	PUSH	HL          ;IN:  HL= Bereichsanfang
  5415*   D1             C      	POP	DE          ;     BC= Bereichslaenge
  5416*   13             C      	INC	DE
  5417*   AF             C      	XOR	A
  5418*   77             C      	LD	(HL),A
  5419*   0B             C      	DEC	BC
  541A*   ED B0          C      	LDIR
  541C*   C1             C      	POP	BC
  541D*   D1             C      	POP	DE
  541E*   E1             C      	POP	HL
  541F*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  5420*                  C      U1.KBR4:
  5420*   C5             C      	PUSH	BC
  5421*   06 04          C      	LD	B,4
  5423*   CD 60D0*       C      	CALL	UR.KBR
  5426*   10 FB          C      	DJNZ	$-3
  5428*   C1             C      	POP	BC
  5429*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  542A*                  C      U1.WAIT:
                         C      	; PUSH	AF
                         C      	; CALL	UE.BERT
                         C      	; JR	C,$-3
                         C      	; POP	AF
  542A*   C9             C      	RET
                         C      ;--------------------------------------------------------------------
  542B*                  C      U1.BREAD:
  542B*   CD 546D*       C      	CALL	U1.EIN       ;BLOCK LESEN VON EINGABE
  542E*   DD 36 04 02    C      	LD	(IX+4),02H
  5432*   CD 5D2A*       C      	CALL	UF.EXEC
  5435*   C9             C      	RET
  5436*                  C      U1.BWRIT:
  5436*   CD 5476*       C      	CALL	U1.AUS       ;BLOCK SCHREIBEN AUF AUSGABE
  5439*   DD 36 04 08    C      	LD	(IX+4),08H
  543D*   CD 5D2A*       C      	CALL	UF.EXEC
  5440*   C9             C      	RET
  5441*                  C      U1.COPB2:
  5441*   F5             C      	PUSH	AF
  5442*   37             C      	SCF
  5443*   18 02          C      	JR	$+4
  5445*                  C      U1.COPB:
  5445*   F5             C      	PUSH	AF
  5446*   B7             C      	OR	A
  5447*   CD 546D*       C      	CALL	U1.EIN
  544A*   DD 36 04 02    C      	LD	(IX+4),02H
  544E*   DC 6FFD*       C      	CALL	C,KX.EXEC2
  5451*   D4 5D2A*       C      	CALL	NC,UF.EXEC
  5454*   F5             C      	PUSH	AF
  5455*   CD 5476*       C      	CALL	U1.AUS
                         C      	;LD	A,(IX+9)
                         C      	;OR	(IX+10)
  5458*   DD 7E 0A       C      	LD	A,(IX+10)    ;Laenge = 1, dann BM
  545B*   FE 01          C      	CP	1
  545D*   28 08          C      	JR	Z,$+10
  545F*   CD 5436*       C      	CALL	U1.BWRIT
'Allgemeine Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-4


  5462*   F1             C      	POP	AF
  5463*   38 DC          C      	JR	C,$-34
  5465*   30 DE          C      	JR	NC,$-32
  5467*   CD 60BE*       C      	CALL	UR.KBM
  546A*   F1             C      	POP	AF
  546B*   F1             C      	POP	AF
  546C*   C9             C      	RET
  546D*                  C      U1.EIN:
  546D*   F5             C      	PUSH	AF
  546E*   3A E000        C      	LD	A,(BC.TAB1)
  5471*   DD 77 03       C      	LD	(IX+3),A
  5474*   F1             C      	POP	AF
  5475*   C9             C      	RET
  5476*                  C      U1.AUS:
  5476*   F5             C      	PUSH	AF
  5477*   3A E001        C      	LD	A,(BC.TAB1+1)
  547A*   DD 77 03       C      	LD	(IX+3),A
  547D*   F1             C      	POP	AF
  547E*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  547F*                  C      U1.VS1:
  547F*   E5             C      	PUSH	HL
  5480*   C5             C      	PUSH	BC
  5481*   F5             C      	PUSH	AF
  5482*   3E 01          C      	LD	A,01H        ;1.DATEIVORSATZ IM PUFFER
  5484*   18 04          C      	JR	$+6
  5486*                  C      U1.VSX:
  5486*   E5             C      	PUSH	HL
  5487*   C5             C      	PUSH	BC
  5488*   F5             C      	PUSH	AF
  5489*   AF             C      	XOR	A            ;00-DATEIVORSATZ IM PUFFER
  548A*   06 20          C      	LD	B,32
  548C*   21 0E65        C      	LD	HL,UE.PUF
  548F*   CD 55A6*       C      	CALL	U1.TR
  5492*   F1             C      	POP	AF
  5493*   C1             C      	POP	BC
  5494*   E1             C      	POP	HL
  5495*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  5496*                  C      U1.DSVG:
  5496*   E5             C      	PUSH	HL
  5497*   D5             C      	PUSH	DE
  5498*   F5             C      	PUSH	AF
  5499*   06 07          C      	LD	B,7          ;MRES KASSETTE ?
  549B*   CD 5542*       C      	CALL	U1.VORS1
  549E*   11 0E6B        C      	LD	DE,UE.PUF+6
  54A1*   21 5E0A*       C      	LD	HL,UA.DS+6
  54A4*   06 0E          C      	LD	B,14
  54A6*   1A             C      	LD	A,(DE)
  54A7*   BE             C      	CP	(HL)
  54A8*   20 10          C      	JR	NZ,$+18
  54AA*   13             C      	INC	DE
  54AB*   23             C      	INC	HL
  54AC*   10 F8          C      	DJNZ	$-6
  54AE*   3A 0E66        C      	LD	A,(UE.PUF+1)
  54B1*   4F             C      	LD	C,A          ;C <-- NEXT RECORD
  54B2*   3A 0E68        C      	LD	A,(UE.PUF+3)
  54B5*   47             C      	LD	B,A          ;B <-- ANZ.VERZ.EINTRAG.
  54B6*   F1             C      	POP	AF
  54B7*   D1             C      	POP	DE
  54B8*   E1             C      	POP	HL
  54B9*   C9             C      	RET
                         C      
  54BA*   F1             C      	POP	AF
  54BB*   D1             C      	POP	DE
  54BC*   E1             C      	POP	HL
  54BD*   FD E1          C      	POP	IY
  54BF*   3E 90          C      	LD	A,90H
  54C1*   CD 5D5A*       C      	CALL	UF.ERANZ
  54C4*   C3 000B        C      	JP	UE.SYSTB
                         C      ;----------------------------------------------------------------------
  54C7*                  C      U1.NMVGL:
  54C7*   C5             C      	PUSH	BC
  54C8*   D5             C      	PUSH	DE
  54C9*   E5             C      	PUSH	HL
  54CA*   06 06          C      	LD	B,6
  54CC*   11 0E65        C      	LD	DE,UE.PUF
  54CF*   1A             C      	LD	A,(DE)
  54D0*   BE             C      	CP	(HL)         ;HL:ZU SUCHENDER PROGR.NAME
  54D1*   20 0C          C      	JR	NZ,$+14
  54D3*   23             C      	INC	HL
  54D4*   13             C      	INC	DE
  54D5*   10 F8          C      	DJNZ	$-6
'Allgemeine Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-5


  54D7*   3A 0E7C        C      	LD	A,(UE.PUF+23);LABELNR. -->A
  54DA*   37             C      	SCF	             ;CY=1,WENN PROGR. GEFUNDEN
  54DB*   E1             C      	POP	HL
  54DC*   D1             C      	POP	DE
  54DD*   C1             C      	POP	BC
  54DE*   C9             C      	RET
                         C      
  54DF*   B7             C      	OR	A
  54E0*   18 F9          C      	JR	$-5
                         C      ;----------------------------------------------------------------------
  54E2*                  C      U1.KTINI:
  54E2*   E5             C      	PUSH	HL
  54E3*   C5             C      	PUSH	BC
  54E4*   F5             C      	PUSH	AF
  54E5*   CD 55B1*       C      	CALL	U1.BILO      ;UNTERE HAELFTE BS LOESCHEN
  54E8*   DD 21 2B03*    C      	LD	IX,UB.KTAB   ;ADR. STEUERTAB. F.KASS.ROUTINE
  54EC*   DD E5          C      	PUSH	IX
  54EE*   E1             C      	POP	HL
  54EF*   AF             C      	XOR	A
  54F0*   06 1B          C      	LD	B,27
  54F2*   CD 55A6*       C      	CALL	U1.TR        ;TAB. AUF 00 LOESCHEN
  54F5*   DD 36 02 30    C      	LD	(IX+2),AKB
                         C      ;	CALL	UE.KINI
  54F9*   18 03          C      	JR	$+5
                         C      ;----------------------------------------------------------------------
  54FB*                  C      U1.KTIN1:
  54FB*   E5             C      	PUSH	HL
  54FC*   C5             C      	PUSH	BC
  54FD*   F5             C      	PUSH	AF
  54FE*   DD 36 0B 07    C      	LD	(IX+11),7    ;ANZAHL LESE/SCHREIBWDHLGNN
  5502*   DD 36 0C 04    C      	LD	(IX+12),4    ;ANZAHL
  5506*   21 0E65        C      	LD	HL,UE.PUF
  5509*   CD 5621*       C      	CALL	XY.STDX
  550C*   07             C      	DB	7            ;SYSTEMPUFFERADR.-->TAB
  550D*   21 8010        C      	LD	HL,UE.KPUFF
  5510*   CD 5621*       C      	CALL	XY.STDX
  5513*   19             C      	DB	25           ;E/A PUFFERADR.-->TAB
  5514*   F1             C      	POP	AF
  5515*   C1             C      	POP	BC
  5516*   E1             C      	POP	HL
  5517*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  5518*                  C      U1.VERIN:
  5518*   E5             C      	PUSH	HL
  5519*   C5             C      	PUSH	BC
  551A*   F5             C      	PUSH	AF
  551B*   11 EC82        C      	LD	DE,BC.VTABE  ;VERZ. EINGABEGER. EINLESEN
  551E*   18 03          C      	JR	$+5
  5520*                  C      U1.VERNI:
  5520*   E5             C      	PUSH	HL
  5521*   C5             C      	PUSH	BC
  5522*   F5             C      	PUSH	AF
  5523*   3A 0E68        C      	LD	A,(UE.PUF+3) ;ANZ. DATEIEN-->B
  5526*   47             C      	LD	B,A
  5527*   C5             C      	PUSH	BC
  5528*   21 0E65        C      	LD	HL,UE.PUF
  552B*   01 0020        C      	LD	BC,32
  552E*   ED B0          C      	LDIR
  5530*   CD 5D2A*       C      	CALL	UF.EXEC
  5533*   C1             C      	POP	BC
  5534*   10 F1          C      	DJNZ	$-13
  5536*   F1             C      	POP	AF
  5537*   C1             C      	POP	BC
  5538*   E1             C      	POP	HL
  5539*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  553A*                  C      U1.VORST:
  553A*   C5             C      	PUSH	BC
  553B*   CD 60A8*       C      	CALL	UR.KRWW
  553E*   06 06          C      	LD	B,6
  5540*   18 01          C      	JR	$+3
  5542*                  C      U1.VORS1:
  5542*   C5             C      	PUSH	BC
  5543*   DD 36 04 02    C      	LD	(IX+4),02H
  5547*   CD 5D2A*       C      	CALL	UF.EXEC
  554A*   10 FB          C      	DJNZ	$-3
  554C*   C1             C      	POP	BC
  554D*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  554E*                  C      U1.VZS:
  554E*   D5             C      	PUSH	DE
  554F*   C5             C      	PUSH	BC
  5550*   E5             C      	PUSH	HL
'Allgemeine Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-6


  5551*   F5             C      	PUSH	AF
  5552*   CD 60CA*       C      	CALL	UR.KBV
  5555*   CD 60D0*       C      	CALL	UR.KBR
  5558*   11 0E65        C      	LD	DE,UE.PUF
  555B*   01 0006        C      	LD	BC,6
  555E*   ED B0          C      	LDIR	             ;PROGR.NAME --> PUFFER
  5560*   3A 2B28*       C      	LD	A,(UB.PAR2)  ;DATEITYP
  5563*   12             C      	LD	(DE),A
  5564*   13             C      	INC	DE
  5565*   3E 44          C      	LD	A,'D'
  5567*   12             C      	LD	(DE),A
  5568*   13             C      	INC	DE
  5569*   3A 2B2A*       C      	LD	A,(UB.PAR3)
  556C*   FE 7F          C      	CP	7FH
  556E*   20 0F          C      	JR	NZ,$+17
  5570*   21 5E4A*       C      	LD	HL,UA.KOMMT  ;FRAGE KOMMENTAR WENN PAR3=7F
  5573*   CD 595C*       C      	CALL	UR.MIMO
  5576*   01 0006        C      	LD	BC,6
  5579*   ED B0          C      	LDIR
  557B*   06 09          C      	LD	B,9
  557D*   18 02          C      	JR	$+4
  557F*   06 0F          C      	LD	B,15
  5581*   3E 20          C      	LD	A,' '
  5583*   12             C      	LD	(DE),A
  5584*   13             C      	INC	DE
  5585*   10 FC          C      	DJNZ	$-2
  5587*   3A 2B26*       C      	LD	A,(UB.PAR1)
  558A*   12             C      	LD	(DE),A
  558B*   13             C      	INC	DE
  558C*   06 08          C      	LD	B,8
  558E*   AF             C      	XOR	A
  558F*   12             C      	LD	(DE),A
  5590*   13             C      	INC	DE
  5591*   10 FC          C      	DJNZ	$-2
  5593*   21 0020        C      	LD	HL,32
  5596*   CD 5631*       C      	CALL	XY.STIDX
  5599*   09             C      	DB	9
  559A*   DD 36 04 08    C      	LD	(IX+4),08H
  559E*   CD 5D2A*       C      	CALL	UF.EXEC
  55A1*   F1             C      	POP	AF
  55A2*   E1             C      	POP	HL
  55A3*   C1             C      	POP	BC
  55A4*   D1             C      	POP	DE
  55A5*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  55A6*                  C      U1.TR:
  55A6*   77             C      	LD	(HL),A       ;A=INHALT
  55A7*   23             C      	INC	HL
  55A8*   10 FC          C      	DJNZ	U1.TR        ;B=ANZAHL
  55AA*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  55AB*                  C      U1.INFO:
  55AB*   01 000E        C      	LD	BC,14
  55AE*   ED B0          C      	LDIR
  55B0*   C9             C      	RET
  55B1*                  C      U1.BILO:
  55B1*   CD 5400*       C      	CALL	U1.RSAVE
  55B4*   21 3370        C      	LD	HL,SD.BWSA + 11*80 ;3370H
  55B7*   01 040F        C      	LD	BC,13*80 - 1       ;1120  ( -80 ... eine Zeile )
  55BA*   36 20          C      	LD	(HL),20H
  55BC*   54             C      	LD	D,H
  55BD*   5D             C      	LD	E,L
  55BE*   13             C      	INC	DE
  55BF*   ED B0          C      	LDIR
  55C1*   CD 5408*       C      	CALL	U1.RRST
  55C4*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  55C5*                  C      U1.TST:
  55C5*   B7             C      	OR	A
  55C6*   D6 30          C      	SUB	30H
  55C8*   47             C      	LD	B,A
  55C9*   05             C      	DEC	B
  55CA*   C8             C      	RET	Z
  55CB*   05             C      	DEC	B
  55CC*   C8             C      	RET	Z
  55CD*   37             C      	SCF
  55CE*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  55CF*                  C      U1.PRADR:
  55CF*   E5             C      	PUSH	HL
  55D0*   C5             C      	PUSH	BC
  55D1*   06 04          C      	LD	B,4
  55D3*   7E             C      	LD	A,(HL)
'Allgemeine Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-7


  55D4*   FE 20          C      	CP	' '
  55D6*   28 07          C      	JR	Z,$+9
  55D8*   23             C      	INC	HL
  55D9*   10 F8          C      	DJNZ	$-6
  55DB*   B7             C      	OR	A
  55DC*   C1             C      	POP	BC
  55DD*   E1             C      	POP	HL
  55DE*   C9             C      	RET
  55DF*   37             C      	SCF
  55E0*   21 2B00*       C      	LD	HL,UB.ZN
  55E3*   35             C      	DEC	(HL)
  55E4*   18 F6          C      	JR	$-8
                         C      ;---------------------------------------------------------------------
  55E6*                  C      U1.KRWE:
  55E6*   CD 609A*       C      	CALL	UR.KRE
  55E9*   CD 60A8*       C      	CALL	UR.KRWW
  55EC*   C9             C      	RET
                         C      ;---------------------------------------------------------------------
                         C      ;	END
                         C      	TITLE 'Handling f. IX/IY-adressierte Bereiche'
                         C      	PAGE
'Handling f. IX/IY-adressierte Bereiche'	MACRO-80 3.44	09-Dec-81	PAGE	1-8


                         C      
                         C      ;	PN	XY ; Unterprogramme
                         C      ;**********************************************************************
                         C      ;*                                                                    *
                         C      ;*       Handling f. IX/IY-adressierte Steuer-Bloecke bzw.            *
                         C      ;*                                     Arbeits-Bereiche               *
                         C      ;*                                                                    *
                         C      ;*--------------------------------------------------------------------*
                         C      ;*                                                                    *
                         C      ;*       Ausser den angegebenen Registern bzw. Flags wird nur noch    *
                         C      ;*       die angegebene Anzahl der ersten freien Stack-Plaetze (je    *
                         C      ;*       Byte) veraendert. Weiterer RAM-Platz wird nicht benoetigt.   *
                         C      ;*                                                                    *
                         C      ;**********************************************************************
                         C      ;*                                                                    *
                         C      ;*       Technische (Hilfs-) Unter-Programme                          *
                         C      ;*                                                                    *
                         C      ;**********************************************************************
                         C      			;
                         C      ;        Uebernahme von nach dem CALL stehenden Parameter
                         C      ;        ++++++++++++++++++++++++++++++++++++++++++++++++
                         C      ;        erwarten Stack:           Return-Adresse f.uebergeordnetes UP
                         C      ;                       (SP) -->   Return-Adresse f.CALPn
                         C      ;        geben Stack zurueck:      Return-Adresse f.uebergeordn.UP + n
                         C      ;                                  (DE)
                         C      ;                       (SP) -->   (HL)
                         C      ;        geben in Reg.zurueck:     (DE):  Wert    1.Parameter-Byte
                         C      ;                                  (HL):  Adresse 2.Parameter-Byte
                         C      ;        --------------------------------------------------------------
                         C      		             ;
  55ED*                  C      XY.CALP1	EQU	$    ; 1 Byte-Parameter
                         C      		             ; ++++++++++++++++++++++++++++++
  55ED*   E5             C      	PUSH	HL           ; Retten HL
  55EE*   E1             C      	POP	HL
                         C      		             ;
  55EF*   EB             C      	EX	DE,HL        ; DE <--> RET-Adr.f.CALPn
  55F0*   E3             C      	EX	(SP),HL
  55F1*   EB             C      	EX	DE,HL
                         C      		             ;
  55F2*   E1             C      	POP	HL           ; (SP) --> RET-Adr.f.ueberg.UP
                         C      		             ;
  55F3*   E1             C      	POP	HL           ; Laden u. korrig. ...
  55F4*   23             C      	INC	HL
  55F5*   E5             C      	PUSH	HL
  55F6*                  C      XY.CALPE:
  55F6*   2B             C      	DEC	HL
                         C      		             ;
  55F7*   3B             C      	DEC	SP           ; (SP) --> (DE)
  55F8*   3B             C      	DEC	SP
  55F9*   3B             C      	DEC	SP           ; (SP) --> (HL)
  55FA*   3B             C      	DEC	SP
                         C      		             ;
  55FB*   D5             C      	PUSH	DE           ; RET-Adr.f.CALPn
                         C      		             ;
  55FC*   5E             C      	LD	E,(HL)       ; Laden DE, HL
  55FD*   16 00          C      	LD	D,0
  55FF*   23             C      	INC	HL
                         C      		             ;
  5600*   C9             C      	RET
                         C      ;**********************************************************************
                         C      ;*                                                                    *
                         C      ;*       Lade-, Speicher- und Transport-Unterprogramme                *
                         C      ;*                                                                    *
                         C      ;**********************************************************************
                         C      ;
                         C      ;    CALL  LDDX    'Load':              HL := (IX+d)
                         C      ;    DB    d                                              Stack: 4
                         C      ;    -----------   ----------------------------------------------------
                         C      		             ;
  5601*                  C      XY.LDDX:
  5601*   CD 55ED*       C      	CALL	XY.CALP1     ; Uebernahme d
                         C      		             ;
  5604*   DD E5          C      	PUSH	IX           ; HL := IX+d
  5606*   E1             C      	POP	HL           ;               <--- LDDY
  5607*   F5             C      	PUSH	AF
  5608*   19             C      	ADD	HL,DE
  5609*   F1             C      	POP	AF
                         C      		             ;
  560A*   5E             C      	LD	E,(HL)       ; HL := (IX+d)
  560B*   23             C      	INC	HL
  560C*   56             C      	LD	D,(HL)
  560D*   EB             C      	EX	DE,HL
'Handling f. IX/IY-adressierte Bereiche'	MACRO-80 3.44	09-Dec-81	PAGE	1-9


                         C      		             ;
  560E*   D1             C      	POP	DE           ; Return
  560F*   D1             C      	POP	DE
  5610*   C9             C      	RET
                         C      		             ;
                         C      ;**********************************************************************
                         C      ;
                         C      ;    CALL  LIDX    'Load inverse':      LH := (IX+d)
                         C      ;    DB    d                                              Stack: 4
                         C      ;    -----------   ----------------------------------------------------
                         C      		             ;
  5611*                  C      XY.LIDX:
  5611*   CD 55ED*       C      	CALL	XY.CALP1     ; Uebernahme d
                         C      		             ;
  5614*   DD E5          C      	PUSH	IX           ; HL := IX+d
  5616*   E1             C      	POP	HL           ;               <--- LIDY
  5617*   F5             C      	PUSH	AF
  5618*   19             C      	ADD	HL,DE
  5619*   F1             C      	POP	AF
                         C      		             ;
  561A*   56             C      	LD	D,(HL)       ; LH := (IX+d)
  561B*   23             C      	INC	HL
  561C*   5E             C      	LD	E,(HL)
  561D*   EB             C      	EX	DE,HL
                         C      		             ;
  561E*   D1             C      	POP	DE           ; Return
  561F*   D1             C      	POP	DE
  5620*   C9             C      	RET
                         C      		             ;
                         C      ;**********************************************************************
                         C      ;
                         C      ;    CALL  STDX    'Store':            (IX+d) := HL
                         C      ;    DB    d                                                  Stack: 4
                         C      ;    -----------   ----------------------------------------------------
                         C      		             ;
  5621*                  C      XY.STDX:
  5621*   CD 55ED*       C      	CALL	XY.CALP1     ; Uebernahme d
                         C      		             ;
  5624*   DD E5          C      	PUSH	IX           ; HL := IX+d
  5626*   E1             C      	POP	HL           ;               <--- STDY
  5627*   F5             C      	PUSH	AF
  5628*   19             C      	ADD	HL,DE
  5629*   F1             C      	POP	AF
                         C      		             ;
  562A*   D1             C      	POP	DE
  562B*   73             C      	LD	(HL),E       ; (IX+d) := HL
  562C*   23             C      	INC	HL
  562D*   72             C      	LD	(HL),D
  562E*   EB             C      	EX	DE,HL
                         C      		             ;
  562F*   D1             C      	POP	DE           ; Return
  5630*   C9             C      	RET
                         C      		             ;
                         C      ;**********************************************************************
                         C      ;
                         C      ;    CALL  STIDX    'Store inverse':    (IX+d) := LH
                         C      ;    DB    d                                                  Stack: 4
                         C      ;    -----------   ----------------------------------------------------
                         C      		             ;
  5631*                  C      XY.STIDX:
  5631*   CD 55ED*       C      	CALL	XY.CALP1     ; Uebernahme d
                         C      		             ;
  5634*   DD E5          C      	PUSH	IX           ; HL := IX+d
  5636*   E1             C      	POP	HL           ;               <--- STIDY
  5637*   F5             C      	PUSH	AF
  5638*   19             C      	ADD	HL,DE
  5639*   F1             C      	POP	AF
                         C      		             ;
  563A*   D1             C      	POP	DE
  563B*   72             C      	LD	(HL),D       ; (IX+d) := LH
  563C*   23             C      	INC	HL
  563D*   73             C      	LD	(HL),E
  563E*   EB             C      	EX	DE,HL
                         C      		             ;
  563F*   D1             C      	POP	DE           ; Return
  5640*   C9             C      	RET
                         C      		             ;
                         C      ;**********************************************************************
                         C      ;
                         C      ;    CALL  INCDX    'Increment':        (IX+d) := (IX+d) + 1
                         C      ;    DB    d                                    Flags wie ADC HL,...
                         C      ;                                                             Stack: 4
                         C      ;    -----------   ----------------------------------------------------
'Handling f. IX/IY-adressierte Bereiche'	MACRO-80 3.44	09-Dec-81	PAGE	1-10


                         C      		             ;
  5641*                  C      XY.INCDX:
  5641*   CD 55ED*       C      	CALL	XY.CALP1     ; Uebernahme d
                         C      		             ;
  5644*   DD E5          C      	PUSH	IX           ; HL := IX+d
  5646*   E1             C      	POP	HL           ;               <--- INCDY
  5647*   19             C      	ADD	HL,DE
                         C      		             ;
  5648*   5E             C      	LD	E,(HL)       ; DE := (IX+d)
  5649*   23             C      	INC	HL
  564A*   56             C      	LD	D,(HL)
                         C      		             ;
  564B*   E5             C      	PUSH	HL           ; DE := (IX+d) + 1
  564C*   21 0001        C      	LD	HL,1
  564F*   B7             C      	OR	A
  5650*   ED 5A          C      	ADC	HL,DE
  5652*   EB             C      	EX	DE,HL
  5653*   E1             C      	POP	HL
  5654*   72             C      	LD	(HL),D
  5655*   2B             C      	DEC	HL
  5656*   73             C      	LD	(HL),E
                         C      		             ;
  5657*   E1             C      	POP	HL           ; Return
  5658*   D1             C      	POP	DE
  5659*   C9             C      	RET
                         C      		             ;
                         C      ;**********************************************************************
                         C      ;*                                                                    *
                         C      ;*       Unterprogramm  'Unbedingter Sprung'                          *
                         C      ;*                                                                    *
                         C      ;**********************************************************************
                         C      ;
                         C      ;    CALL  JMPDX   'Jump':              JMP  (IX+d)
                         C      ;    DB    d                                              Stack: 4
                         C      ;                                       Achtung!
                         C      ;                                           Veraendert freie Stack-Pl.
                         C      ;    -----------   ----------------------------------------------------
                         C      		             ;
  565A*                  C      XY.JMPDX:
  565A*   CD 55ED*       C      	CALL	XY.CALP1     ; Uebernahme d
                         C      		             ;
  565D*   DD E5          C      	PUSH	IX           ; HL := IX+d
  565F*   E1             C      	POP	HL           ;               <--- JMPDY
  5660*   F5             C      	PUSH	AF
  5661*   19             C      	ADD	HL,DE
  5662*   F1             C      	POP	AF
                         C      		             ;
  5663*   5E             C      	LD	E,(HL)       ; HL := (IX+d)
  5664*   23             C      	INC	HL
  5665*   56             C      	LD	D,(HL)
  5666*   EB             C      	EX	DE,HL
                         C      		             ;
  5667*   D1             C      	POP	DE           ; Return = Jump
  5668*   E3             C      	EX	(SP),HL
  5669*   EB             C      	EX	DE,HL
  566A*   C9             C      	RET
                         C      		             ;
                         C      ;**********************************************************************
                         C      ;	END
                         C      	TITLE 'Konvertierungen'
                         C      	PAGE
'Konvertierungen'	MACRO-80 3.44	09-Dec-81	PAGE	1-11


                         C      
                         C      ;	PN	UC
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;       KONVERTIERUNGEN
                         C      ;
                         C      ;----------------------------------------------------------------------
                         C      ;                            HL := HL * 10
                         C      ;                                      (ohne Kontrolle auf Uebertrag)
  566B*                  C      UC.HL10N:
  566B*   E5             C      	PUSH	HL
  566C*   D1             C      	POP	DE           ; alter Wert in DE
  566D*   29             C      	ADD	HL,HL
  566E*   29             C      	ADD	HL,HL
  566F*   19             C      	ADD	HL,DE
  5670*   29             C      	ADD	HL,HL
  5671*   C9             C      	RET
                         C      ;                            HL := HL * 10
                         C      ;                                            -->  C: Uebertrag in A
  5672*                  C      UC.HL10C:
  5672*   E5             C      	PUSH	HL
  5673*   D1             C      	POP	DE           ; alter Wert in DE
  5674*   AF             C      	XOR	A
  5675*   29             C      	ADD	HL,HL
  5676*   30 01          C      	JR	NC,$+3
  5678*   3C             C      	INC	A
  5679*   87             C      	ADD	A,A
  567A*   29             C      	ADD	HL,HL
  567B*   30 01          C      	JR	NC,$+3
  567D*   3C             C      	INC	A
  567E*   19             C      	ADD	HL,DE
  567F*   30 01          C      	JR	NC,$+3
  5681*   3C             C      	INC	A
  5682*   87             C      	ADD	A,A
  5683*   29             C      	ADD	HL,HL
  5684*   30 01          C      	JR	NC,$+3
  5686*   3C             C      	INC	A
  5687*   B7             C      	OR	A
  5688*   C8             C      	RET	Z
  5689*   37             C      	SCF
  568A*   C9             C      	RET
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      ;                            Division mit Rest:  A  := HL / DE
                         C      ;                                                HL := Rest
                         C      		             ;      Cy(A) --->  A=255
                         C      		             ;-------------------------------
  568B*                  C      UC.DIVR:
  568B*   AF             C      	XOR	A
  568C*   ED 52          C      	SBC	HL,DE
  568E*   3C             C      	INC	A
  568F*   20 03          C      	JR	NZ,$+5
  5691*   3D             C      	DEC	A
  5692*   38 03          C      	JR	C,$+5
  5694*   30 F6          C      	JR	NC,$-8
  5696*   3D             C      	DEC	A
  5697*   19             C      	ADD	HL,DE
  5698*   C9             C      	RET
                         C      		             ;
                         C      ;**********************************************************************
                         C      ;*                                                                    *
                         C      ;*       CV...               Konvertierungen     (convert ...)        *
                         C      ;*                                                                    *
                         C      ;*--------------------------------------------------------------------*
                         C      ;*       ..A..:              in A                                     *
                         C      ;*       ..?*.:              von Typ *                                *
                         C      ;*       ..?.*:              nach Typ *                               *
                         C      ;*                                                                    *
                         C      ;*       Typen:              B - binaer                               *
                         C      ;*                           X - hexadezimal ASCII                    *
                         C      ;*                           A - Adresse binaer (L,H)                 *
                         C      ;*                           D - dezimal ASCII                        *
                         C      ;*                                                                    *
                         C      ;**********************************************************************
                         C      		             ;
                         C      ;                            In A:      Binaer < 16 --> ASCII hexa
                         C      ;                            ------------------------------------------
  5699*                  C      UC.CVABX:
  5699*   E6 0F          C      	AND	0FH
  569B*   F6 30          C      	OR	30H
  569D*   FE 3A          C      	CP	3AH
  569F*   D8             C      	RET	C
'Konvertierungen'	MACRO-80 3.44	09-Dec-81	PAGE	1-12


  56A0*   C6 07          C      	ADD	A,7H
  56A2*   C9             C      	RET
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      ;                            Byte binaer (HL) --> 2 ASCII hexa (DE)
                         C      ;                                                            HL+1, DE+2
                         C      ;                            ------------------------------------------
  56A3*                  C      UC.CVBX:
  56A3*   7E             C      	LD	A,(HL)
  56A4*   23             C      	INC	HL           ; benutzt: A, 2 Stack-P.
                         C      		             ;
  56A5*   F5             C      	PUSH	AF           ;ENTRY,WENN ZEICHEN IN A
  56A6*   0F             C      	RRCA
  56A7*   0F             C      	RRCA
  56A8*   0F             C      	RRCA
  56A9*   0F             C      	RRCA
  56AA*   CD 56AE*       C      	CALL	$+4
  56AD*   F1             C      	POP	AF
                         C      		             ;
  56AE*   CD 5699*       C      	CALL	UC.CVABX
  56B1*   12             C      	LD	(DE),A
  56B2*   13             C      	INC	DE
  56B3*   C9             C      	RET
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      ;                       Adresse (L,H) binaer (HL) --> 4 ASCII hexa (DE)
                         C      ;                                                            HL+2, DE+4
                         C      ;                       -----------------------------------------------
  56B4*                  C      UC.CVAX:
  56B4*   23             C      	INC	HL
  56B5*   CD 56A3*       C      	CALL	UC.CVBX      ; benutzt: A, 3 Stack-P.
  56B8*   2B             C      	DEC	HL
  56B9*   2B             C      	DEC	HL
  56BA*   CD 56A3*       C      	CALL	UC.CVBX
  56BD*   23             C      	INC	HL
  56BE*   C9             C      	RET
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      ;                       Adresse aus HL, binaer    --> 4 ASCII hexa (DE)
                         C      ;                                                                  DE+4
                         C      ;                       -----------------------------------------------
  56BF*                  C      UC.CVHLX:
  56BF*   7C             C      	LD	A,H
  56C0*   CD 56A5*       C      	CALL	UC.CVBX+2    ; benutzt: A, 3 Stack-P.
  56C3*   7D             C      	LD	A,L
  56C4*   CD 56A5*       C      	CALL	UC.CVBX+2
  56C7*   C9             C      	RET
                         C      		             ;
                         C      		             ;
                         C      ;      ---------------------------------------------------------------
                         C      ;                            In A:     ASCII hexa --> binaer < 16
                         C      ;
                         C      ;                                       Datenfehler: Cy, A undefiniert
                         C      ;                            ------------------------------------------
  56C8*                  C      UC.CVAXB:
  56C8*   D6 30          C      	SUB	30H
  56CA*   D8             C      	RET	C            ;       (A) < '0'
  56CB*   FE 0A          C      	CP	10
  56CD*   3F             C      	CCF
  56CE*   D0             C      	RET	NC
  56CF*   FE 11          C      	CP	11H
  56D1*   D8             C      	RET	C            ; '9' < (A) < 'A'
  56D2*   FE 17          C      	CP	17H
  56D4*   3F             C      	CCF
  56D5*   D8             C      	RET	C            ; 'F' < (A)
  56D6*   D6 07          C      	SUB	7H
  56D8*   C9             C      	RET
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      ;                            2 ASCII hexa (DE) --> Byte binaer (HL)
                         C      ;                                                            DE+2, HL+1
                         C      ;
                         C      ;                                       mit Datenfehler-Behandlung
                         C      ;                            ------------------------------------------
  56D9*                  C      UC.CVXB:
  56D9*   C5             C      	PUSH	BC
                         C      		             ; benutzt: A, 3 Stack-P.
  56DA*   CD 56EA*       C      	CALL	UC.CVX1B
  56DD*   87             C      	ADD	A,A
  56DE*   87             C      	ADD	A,A
  56DF*   87             C      	ADD	A,A
  56E0*   87             C      	ADD	A,A
  56E1*   4F             C      	LD	C,A
'Konvertierungen'	MACRO-80 3.44	09-Dec-81	PAGE	1-13


                         C      		             ;
  56E2*   CD 56EA*       C      	CALL	UC.CVX1B
  56E5*   81             C      	ADD	A,C
                         C      		             ;
  56E6*   77             C      	LD	(HL),A
  56E7*   23             C      	INC	HL
  56E8*   C1             C      	POP	BC
  56E9*   C9             C      	RET
                         C      		             ;
  56EA*                  C      UC.CVX1B:
  56EA*   1A             C      	LD	A,(DE)       ; ASCII hexa (DE) --> A binaer,
  56EB*   CD 56C8*       C      	CALL	UC.CVAXB     ;                           DE+1
  56EE*   DC 56F3*       C      	CALL	C,UC.CVXER
  56F1*   13             C      	INC	DE
  56F2*   C9             C      	RET
                         C      		             ;
  56F3*                  C      UC.CVXER:
  56F3*   EB             C      	EX	DE,HL        ; Datenfehler-Behandlung hexa
  56F4*   CD 4033        C      	CALL	SY.SETCHL    ;         set cursor
  56F7*   CD 5A88*       C      	CALL 	UR.TAREP     ; <-+     tast.request
  56FA*   77             C      	LD   	(HL),A       ;   |     write in conv.-area
  56FB*   CD 56C8*       C      	CALL 	UC.CVAXB     ;   |     conv.in A
  56FE*   38 F7          C      	JR   	C,$-7        ; --+     on error ...
  5700*   CD 4036        C      	CALL	SY.RESC
  5703*   EB             C      	EX   	DE,HL
  5704*   C9             C      	RET
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      ;                       4 ASCII hexa (DE) --> Adresse (L,H) binaer (HL)
                         C      ;                                                            DE+4, HL+2
                         C      ;
                         C      ;                                       mit Datenfehler-Behandlung
                         C      ;                       -----------------------------------------------
  5705*                  C      UC.CVXA:
  5705*   23             C      	INC	HL
  5706*   CD 56D9*       C      	CALL	UC.CVXB      ; benutzt: A, 4 Stack-P.
  5709*   2B             C      	DEC	HL
  570A*   2B             C      	DEC	HL
  570B*   CD 56D9*       C      	CALL	UC.CVXB
  570E*   23             C      	INC	HL
  570F*   C9             C      	RET
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      ;                     2 Byte binaer in HL ---> 1...5-stellig dezi (DE),
                         C      ;                                                             DE+1...5
                         C      ;                                  mit Vor-Null-Unterdrueckung
                         C      ;                                                    (nach nicht-dezi),
                         C      ;                                  zu wenig Stellen -->
                         C      ;                                      '*' in der obersten angeg.Stelle
                         C      ;                      ------------------------------------------------
  5710*                  C      UC.CVBD5:
  5710*   3E 05          C      	LD	A,5          ; benutzt: A, 7 Stack-P.
  5712*   18 0E          C      	JR	$+16
  5714*                  C      UC.CVBD4:
  5714*   3E 04          C      	LD	A,4
  5716*   18 0A          C      	JR	$+12
  5718*                  C      UC.CVBD3:
  5718*   3E 03          C      	LD	A,3
  571A*   18 06          C      	JR	$+8
  571C*                  C      UC.CVBD2:
  571C*   3E 02          C      	LD	A,2
  571E*   18 02          C      	JR	$+4
  5720*                  C      UC.CVBD1:
  5720*   3E 01          C      	LD	A,1
                         C      		             ;
  5722*                  C      UC.CVBD:
  5722*   C5             C      	PUSH	BC           ; Zeichenzahl in A
  5723*   E5             C      	PUSH	HL
  5724*   47             C      	LD	B,A
  5725*   CD 572D*       C      	CALL	UC.CVBD0
  5728*   10 FB          C      	DJNZ	$-3
  572A*   E1             C      	POP	HL
  572B*   C1             C      	POP	BC
  572C*   C9             C      	RET
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      ;                          Abspaltung B-te Stelle dezi von HL nach (DE)
                         C      ;                                                                  DE+1
                         C      ;                          B-te nicht fuehrende Stelle: '*' nach (DE)
                         C      ;                          --------------------------------------------
  572D*                  C      UC.CVBD0:
  572D*   C5             C      	PUSH	BC           ; benutzt: A, 5 Stack-P.
                         C      		             ; --------
'Konvertierungen'	MACRO-80 3.44	09-Dec-81	PAGE	1-14


  572E*   7D             C      	LD	A,L
  572F*   F6 30          C      	OR	'0'
  5731*   05             C      	DEC	B
  5732*   28 29          C              JR      Z,$+43       ; -------+
                         C                                   ;        |
  5734*   D5             C              PUSH    DE           ;        |
  5735*   E5             C              PUSH    HL           ; DE := (B-1)-te Zehner-Potenz
  5736*   21 0001        C              LD      HL,1         ;        |
  5739*   CD 566B*       C              CALL    UC.HL10N     ;        |
  573C*   10 FB          C              DJNZ    $-3          ;        |
  573E*   EB             C              EX      DE,HL        ;        |
  573F*   E1             C              POP     HL           ;        |
                         C                                   ;        |
  5740*   CD 568B*       C              CALL    UC.DIVR      ; A := HL / B-te Zehner-Potenz
  5743*   D1             C              POP     DE           ;        |     HL := Rest
                         C                                   ;        |
  5744*   FE 0A          C              CP      10           ; test to decimal
  5746*   38 04          C              JR      C,$+6        ; ---+   |
  5748*   3E 2A          C              LD      A,'*'        ;    |   |
  574A*   18 11          C              JR      $+19         ; -------+
                         C                                   ; <--+   |
  574C*   F6 30          C              OR      '0'          ; conv.to decimal
                         C                                   ;        |
  574E*   FE 30          C              CP      '0'          ; Vor-Null ?
  5750*   20 0B          C              JR      NZ,$+13      ; -------+
  5752*   1B             C              DEC     DE           ;        |
  5753*   4F             C              LD      C,A          ;        |
  5754*   CD 578A*       C              CALL    UC.CVD1B     ;        |
  5757*   79             C              LD      A,C          ;        |
  5758*   13             C              INC     DE           ;        |
  5759*   30 02          C              JR      NC,$+4       ;        |
  575B*   3E 20          C              LD      A,' '        ;        |
                         C                                   ; <------+
  575D*   12             C      	LD	(DE),A
  575E*   13             C      	INC	DE
  575F*   C1             C      	POP	BC
  5760*   C9             C      	RET
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      ;                      Dezi von (DE) bis (-->DE) nicht-dezi
                         C      ;                                                --->      binaer in HL
                         C      ;
                         C      ;                         Fehler:
                         C      ;                         -------
                         C      ;                         Cy, NZ: Zahl zu gross, HL ohne letzte Ziffer
                         C      ;                         Cy, Z:  Leere Zahl (1.Position keine Ziffer),
                         C      ;                                        -->     HL = 0
                         C      ;                      ------------------------------------------------
  5761*                  C      UC.CVDB:
  5761*   26 00          C      	LD	H,0
  5763*   CD 578A*       C      	CALL	UC.CVD1B
  5766*   6F             C      	LD	L,A
  5767*   30 04          C      	JR	NC,$+6
  5769*   AF             C      	XOR	A
  576A*   6F             C      	LD	L,A
  576B*   37             C      	SCF
  576C*   C9             C      	RET                  ; ---> abend C, Z
                         C                                   ;
  576D*   13             C      	INC	DE
  576E*   CD 578A*       C      	CALL	UC.CVD1B
  5771*   3F             C      	CCF
  5772*   D0             C      	RET	NC           ; ---> normal end
  5773*   D5             C      	PUSH	DE
  5774*   F5             C      	PUSH	AF
  5775*   CD 5672*       C      	CALL	UC.HL10C
  5778*   38 0B          C      	JR	C,$+13       ; ----------+
  577A*   F1             C      	POP	AF           ;           |
  577B*   85             C      	ADD	A,L          ;           |
  577C*   6F             C      	LD	L,A          ;           |
  577D*   30 03          C      	JR	NC,$+5       ; --+       |
  577F*   24             C      	INC	H            ;   |       |
  5780*   28 04          C      	JR	Z,$+6        ;   |    ---|--+
  5782*   D1             C      	POP	DE           ; <-+       |  |
  5783*   18 E8          C      	JR	$-22         ;           |  |
                         C                         ;      <----+  !
  5785*   E1             C      	POP	HL           ; abend Cy, NZ !
  5786*   25             C      	DEC	H            ;              |
  5787*   EB             C      	EX	DE,HL        ;        <-----+
  5788*   D1             C      	POP	DE
  5789*   C9             C      	RET
                         C                                   ;
                         C      ;        --------------------------------------------------------------
                         C      ;                            Ziffer dezi (DE) ---> binaer nach A, DE+1
'Konvertierungen'	MACRO-80 3.44	09-Dec-81	PAGE	1-15


                         C      ;                                                  Cy: nicht-dezi
                         C      ;                            ------------------------------------------
  578A*                  C      UC.CVD1B:
  578A*   1A             C      	LD	A,(DE)
  578B*   D6 30          C      	SUB	30H
  578D*   D8             C      	RET	C
  578E*   FE 0A          C      	CP	10
  5790*   3F             C      	CCF
  5791*   C9             C      	RET
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      ;                    Byte binaer (HL) --> Byte ASCII-Symbol (DE)
                         C      ;                                         (sonst: 7FH )
                         C      ;                                                     HL+1, DE+1
                         C      ;                    --------------------------------------------------
  5792*                  C      UC.CVBC:
  5792*   7E             C      	LD	A,(HL)       ; benutzt: A, 0 Stack-P.
  5793*   23             C      	INC	HL           ; --------
  5794*   FE 20          C      	CP	20H
  5796*   30 02          C      	JR	NC,$+4
  5798*   3E 7F          C      	LD	A,7FH
  579A*   FE 7F          C      	CP	7FH
  579C*   38 02          C      	JR	C,$+4
  579E*   3E 7F          C      	LD	A,7FH
  57A0*   12             C      	LD	(DE),A
  57A1*   13             C      	INC	DE
  57A2*   C9             C      	RET
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      ;                       Byte ASCII-Symbol (DE)   -->   Byte binaer (HL)
                         C      ;                                                      DE+1, HL+1
                         C      ;                       -----------------------------------------------
  57A3*                  C      UC.CVCB:
  57A3*   1A             C      	LD	A,(DE)       ; benutzt: A, 0 Stack-P.
  57A4*   13             C      	INC	DE
  57A5*   FE 20          C      	CP	20H
  57A7*   38 05          C      	JR	C,$+7
  57A9*   FE 7E          C      	CP	7EH
  57AB*   30 01          C      	JR	NC,$+3
  57AD*   77             C      	LD	(HL),A
  57AE*   23             C      	INC	HL
  57AF*   C9             C      	RET
                         C      		             ;
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;      KONVERTIERUNGEN
                         C      ;
                         C      ;----------------------------------------------------------------------
  57B0*                  C      UC.DKONV:
  57B0*   7E             C      	LD	A,(HL)       ;DKOI--->ASCII
  57B1*   CD 57C4*       C      	CALL	UC.DK1       ;(HL)--->(DE)
  57B4*   12             C      	LD	(DE),A
  57B5*   23             C      	INC	HL
  57B6*   13             C      	INC	DE
  57B7*   10 F7          C      	DJNZ	UC.DKONV
  57B9*   C9             C      	RET
                         C      ;------------------------------------
  57BA*                  C      UC.KONV:
  57BA*   7E             C      	LD	A,(HL)       ;ASCII--->DKOI
  57BB*   CD 57CF*       C      	CALL	UC.CKONV     ;(HL) --->(DE)
  57BE*   12             C      	LD	(DE),A
  57BF*   23             C      	INC	HL
  57C0*   13             C      	INC	DE
  57C1*   10 F7          C      	DJNZ	UC.KONV
  57C3*   C9             C      	RET
                         C      ;-----------------------------
  57C4*                  C      UC.DK1:
  57C4*   E5             C      	PUSH	HL           ;DKOI--->ASCII
  57C5*   D5             C      	PUSH	DE
  57C6*   C5             C      	PUSH	BC
  57C7*   21 57F2*       C      	LD	HL,UC.ASCCO
  57CA*   11 5852*       C      	LD	DE,UC.DKOI
  57CD*   18 09          C      	JR	UC.DK2
  57CF*                  C      UC.CKONV:
  57CF*   E5             C      	PUSH	HL           ;ASCII ---> DKOI
  57D0*   D5             C      	PUSH	DE
  57D1*   C5             C      	PUSH	BC
  57D2*   21 5852*       C      	LD	HL,UC.DKOI   ;HL:= Anfangsadresse
  57D5*   11 57F2*       C      	LD	DE,UC.ASCCO  ;DE:= Anfangsadresse
  57D8*                  C      UC.DK2:
  57D8*   F5             C      	PUSH	AF           ;Quellcodebyte retten
  57D9*   AF             C      	XOR	A            ;CY = 0
  57DA*   ED 52          C      	SBC	HL,DE        ;Tabellendistanz berechnen
'Konvertierungen'	MACRO-80 3.44	09-Dec-81	PAGE	1-16


  57DC*   2B             C      	DEC	HL
  57DD*   E5             C      	PUSH	HL
  57DE*   C1             C      	POP	BC           ;BC:= Tabellendistanz - 1
  57DF*   EB             C      	EX	DE,HL        ;HL:= Anfangsadresse
  57E0*   F1             C      	POP	AF           ;Zeichen wieder herstellen
  57E1*   C5             C      	PUSH	BC           ;Tabellendistanz retten
  57E2*   01 0060        C      	LD	BC,UE.COTAL  ;BC:= Tabellenlaenge
  57E5*   ED B1          C      	CPIR	             ;Quellcodebyte suchen
  57E7*   37             C      	SCF                  ;CY = 1
  57E8*   C1             C      	POP	BC           ;Tabellendistanz auskellern
  57E9*   20 03          C      	JR	NZ,UC.KONV2  ;---> Quellcodebyte nicht
  57EB*   09             C      	ADD	HL,BC        ;Zielcodeadresse berechnen
  57EC*   AF             C      	XOR	A            ;CY = 0
  57ED*   7E             C      	LD	A,(HL)       ;Zielcodebyte laden
  57EE*                  C      UC.KONV2:
  57EE*   C1             C      	POP	BC
  57EF*   D1             C      	POP	DE
  57F0*   E1             C      	POP	HL
  57F1*   C9             C      	RET
                         C      ;****************************************************************
                         C      ;         ASCII - Codetabelle
                         C      ;****************************************************************
  57F2*                  C      UC.ASCCO:
  57F2*   20 21 22 23    C      	DB	' !"#$%&'
  57F6*   24 25 26       C      
  57F9*   27             C      	DB	27H	;'
  57FA*   28 29 2A 2B    C      	DB	'()*+,-./'
  57FE*   2C 2D 2E 2F    C      
  5802*   30 31 32 33    C      	DB	'0123456789'
  5806*   34 35 36 37    C      
  580A*   38 39          C      
  580C*   3A 3B 3C 3D    C      	DB	':;<=>?@'
  5810*   3E 3F 40       C      
  5813*   41 42 43 44    C      	DB	'ABCDEFGHIJKLMNOPQRSTUVWXYZ'
  5817*   45 46 47 48    C      
  581B*   49 4A 4B 4C    C      
  581F*   4D 4E 4F 50    C      
  5823*   51 52 53 54    C      
  5827*   55 56 57 58    C      
  582B*   59 5A          C      
  582D*   5B 5C 5D 5E    C      	DB	'[\]^_`'
  5831*   5F 60          C      
  5833*   61 62 63 64    C      	DB	'abcdefghijklmnopqrstuvwxyz'
  5837*   65 66 67 68    C      
  583B*   69 6A 6B 6C    C      
  583F*   6D 6E 6F 70    C      
  5843*   71 72 73 74    C      
  5847*   75 76 77 78    C      
  584B*   79 7A          C      
  584D*   7B 7C 7D 7E    C      	DB	'{|}~'
  5851*   7F             C      	DB	7FH	;DEL
                         C      ;***************************************************************
                         C      ;         DKOI - Codetabelle
                         C      ;***************************************************************
  5852*                  C      UC.DKOI:
  5852*   40             C      	DB	40H	;blank
  5853*   4F             C      	DB	4FH	;!
  5854*   7F             C      	DB	7FH	;"
  5855*   7B             C      	DB	7BH	;#
  5856*   5B             C      	DB	5BH	;$
  5857*   6C             C      	DB	6CH	;%
  5858*   50             C      	DB	50H	;&
  5859*   7D             C      	DB	7DH	;'
  585A*   4D             C      	DB	4DH	;(
  585B*   5D             C      	DB	5DH	;)
  585C*   5C             C      	DB	5CH	;*
  585D*   4E             C      	DB	4EH	;+
  585E*   6B             C      	DB	6BH	;,
  585F*   60             C      	DB	60H	;-
  5860*   4B             C      	DB	4BH	;.
  5861*   61             C      	DB	61H	;/
  5862*   F0             C      	DB	0F0H	;0
  5863*   F1             C      	DB	0F1H	;1
  5864*   F2             C      	DB	0F2H	;2
  5865*   F3             C      	DB	0F3H	;3
  5866*   F4             C      	DB	0F4H	;4
  5867*   F5             C      	DB	0F5H	;5
  5868*   F6             C      	DB	0F6H	;6
  5869*   F7             C      	DB	0F7H	;7
  586A*   F8             C      	DB	0F8H	;8
  586B*   F9             C      	DB	0F9H	;9
  586C*   7A             C      	DB	7AH	;:
  586D*   5E             C      	DB	5EH	;;
'Konvertierungen'	MACRO-80 3.44	09-Dec-81	PAGE	1-17


  586E*   4C             C      	DB	4CH	;<
  586F*   7E             C      	DB	7EH	;=
  5870*   6E             C      	DB	6EH	;>
  5871*   6F             C      	DB	6FH	;?
  5872*   7C             C      	DB	7CH	;@
  5873*   C1             C      	DB	0C1H	;A
  5874*   C2             C      	DB	0C2H	;B
  5875*   C3             C      	DB	0C3H	;C
  5876*   C4             C      	DB	0C4H	;D
  5877*   C5             C      	DB	0C5H	;E
  5878*   C6             C      	DB	0C6H	;F
  5879*   C7             C      	DB	0C7H	;G
  587A*   C8             C      	DB	0C8H	;H
  587B*   C9             C      	DB	0C9H	;I
  587C*   D1             C      	DB	0D1H	;J
  587D*   D2             C      	DB	0D2H	;K
  587E*   D3             C      	DB	0D3H	;L
  587F*   D4             C      	DB	0D4H	;M
  5880*   D5             C      	DB	0D5H	;N
  5881*   D6             C      	DB	0D6H	;O
  5882*   D7             C      	DB	0D7H	;P
  5883*   D8             C      	DB	0D8H	;Q
  5884*   D9             C      	DB	0D9H	;R
  5885*   E2             C      	DB	0E2H	;S
  5886*   E3             C      	DB	0E3H	;T
  5887*   E4             C      	DB	0E4H	;U
  5888*   E5             C      	DB	0E5H	;V
  5889*   E6             C      	DB	0E6H	;W
  588A*   E7             C      	DB	0E7H	;X
  588B*   E8             C      	DB	0E8H	;Y
  588C*   E9             C      	DB	0E9H	;Z
  588D*   4A             C      	DB	4AH	;[
  588E*   E0             C      	DB	0E0H	;\
  588F*   5A             C      	DB	5AH	;]
  5890*   5F             C      	DB	5FH	;^
  5891*   6D             C      	DB	6DH	;_
  5892*   79             C      	DB	79H	;`
  5893*   81             C      	DB	81H	;a
  5894*   82             C      	DB	82H	;b
  5895*   83             C      	DB	83H	;c
  5896*   84             C      	DB	84H	;d
  5897*   85             C      	DB	85H	;e
  5898*   86             C      	DB	86H	;f
  5899*   87             C      	DB	87H	;g
  589A*   88             C      	DB	88H	;h
  589B*   89             C      	DB	89H	;i
  589C*   91             C      	DB	91H	;j
  589D*   92             C      	DB	92H	;k
  589E*   93             C      	DB	93H	;l
  589F*   94             C      	DB	94H	;m
  58A0*   95             C      	DB	95H	;n
  58A1*   96             C      	DB	96H	;o
  58A2*   97             C      	DB	97H	;p
  58A3*   98             C      	DB	98H	;q
  58A4*   99             C      	DB	99H	;r
  58A5*   A2             C      	DB	0A2H	;s
  58A6*   A3             C      	DB	0A3H	;t
  58A7*   A4             C      	DB	0A4H	;u
  58A8*   A5             C      	DB	0A5H	;v
  58A9*   A6             C      	DB	0A6H	;w
  58AA*   A7             C      	DB	0A7H	;x
  58AB*   A8             C      	DB	0A8H	;y
  58AC*   A9             C      	DB	0A9H	;z
  58AD*   C0             C      	DB	0C0H	;{
  58AE*   6A             C      	DB	6AH	;|
  58AF*   D0             C      	DB	0D0H	;}
  58B0*   A1             C      	DB	0A1H	;~
  58B1*   FF             C      	DB	0FFH	;DEL
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Komprimierung'
                         C      	PAGE
'Komprimierung'	MACRO-80 3.44	09-Dec-81	PAGE	1-18


                         C      
                         C      ;	PN	CP
                         C      ;**********************************************************************
                         C      ;*       COMPR:    Komprimierung                                      *
                         C      ;*                 EDIT - F/Q-Format   --->  MRES20 - Quelltextformat *
                         C      ;**********************************************************************
                         C      		             ;
  58B2*                  C      CP.COMPR	EQU	$    ; A  Uebergabe/-nahme Zeichen
                         C      		             ; HL: Status von COMPR
                         C      		             ; B:  dekr. Tabulator-Zaehler
                         C      		             ;-------------------------------
                         C      		             ; OUTA: Einzelzeichen-Ausgabe
                         C      		             ;         (Zeichen in Reg. A)
                         C      ;----------------------------------------------------------------------
                         C      		             ;
  58B2*   FE 1E          C      	CP	1EH          ; NL ?
  58B4*   28 01          C      	JR	Z,CP.NL
  58B6*   E9             C      	JP	(HL)
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      		             ; Status "New-Line"
                         C      		             ;-------------------------------
  58B7*                  C      CP.NL:
  58B7*   CD 5641*       C      	CALL	XY.INCDX     ;         Satz-Zaehler + 1
  58BA*   13             C      	DB	19
  58BB*   06 03          C      	LD	B,3          ;         noch 3 TAB erlaubt
  58BD*   3E 0A          C      	LD	A,0AH        ;         MRES20-NL
  58BF*   18 04          C      	JR	CP.OUTT
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      		             ; Status "String"
                         C      		             ;-------------------------------
  58C1*                  C      CP.STRNG:
  58C1*   FE 27          C      	CP	27H          ;         Apostroph
  58C3*   20 20          C      	JR	NZ,CP.OUT
                         C      		             ;
  58C5*                  C      CP.OUTT:
  58C5*   21 58D5*       C      	LD	HL,CP.TEXT   ;         --> Status "Text"
  58C8*   18 1B          C      	JR	CP.OUT
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      		             ; Status "Space"
                         C      		             ;-------------------------------
  58CA*                  C      CP.SPACE:
  58CA*   FE 20          C      	CP	' '
  58CC*   C8             C      	RET	Z
  58CD*   FE 09          C      	CP	09H          ;         Tabulator
  58CF*   C8             C      	RET	Z
  58D0*   21 58D5*       C      	LD	HL,CP.TEXT   ;         ---> Status "Text"
  58D3*   18 08          C      	JR	CP.TEXT+8
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      		             ; Status "Text"
                         C      		             ;-------------------------------
  58D5*                  C      CP.TEXT:
  58D5*   FE 20          C      	CP	' '
  58D7*   28 2E          C      	JR	Z,CP.TAB
  58D9*   FE 09          C      	CP	09H          ;         Tabulator
  58DB*   28 2A          C      	JR	Z,CP.TAB
  58DD*   FE 3B          C      	CP	';'
  58DF*   28 0B          C      	JR	Z,CP.SOKOM
  58E1*   FE 27          C      	CP	27H          ;         Apostroph
  58E3*   28 1D          C      	JR	Z,CP.SOSTR
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      		             ; Status "Kom"
                         C      		             ;-------------------------------
  58E5*                  C      CP.KOM	EQU	$
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      		             ; Einzelzeichen-Ausgabe u. Ret.
                         C      		             ;-------------------------------
  58E5*                  C      CP.OUT:
  58E5*   CD 61E6*       C      	CALL	UK.PUTK
  58E8*   D9             C      	EXX
  58E9*   0B             C      	DEC	BC
  58EA*   D9             C      	EXX
  58EB*   C9             C      	RET
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      		             ; Start "Kommentar"
                         C      		             ;-------------------------------
'Komprimierung'	MACRO-80 3.44	09-Dec-81	PAGE	1-19


  58EC*                  C      CP.SOKOM:
  58EC*   78             C      	LD	A,B          ;         0 oder 3 TAB vorher
  58ED*   FE 03          C      	CP	3
  58EF*   28 0A          C      	JR	Z,$+12
  58F1*   B7             C      	OR	A
  58F2*   28 07          C      	JR	Z,$+9        ;         ---+
  58F4*   3E 09          C      	LD	A,09H        ;         <-+|
  58F6*   CD 58E5*       C      	CALL	CP.OUT       ;           ||
  58F9*   10 F9          C      	DJNZ	$-5          ;         --+|
  58FB*   3E 3B          C      	LD	A,';'        ;         <--+
  58FD*   21 58E5*       C      	LD	HL,CP.KOM
  5900*   18 E3          C      	JR	CP.OUT
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      		             ; Start "String"
                         C      		             ;-------------------------------
  5902*                  C      CP.SOSTR:
  5902*   21 58C1*       C      	LD	HL,CP.STRNG
  5905*   18 DE          C      	JR	CP.OUT
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      		             ; Tabulator-Behandlung
                         C      		             ;-------------------------------
  5907*                  C      CP.TAB:
  5907*   78             C      	LD	A,B
  5908*   B7             C      	OR	A
  5909*   3E 20          C      	LD	A,' '
  590B*   28 D8          C      	JR	Z,CP.OUT
  590D*   05             C      	DEC	B
  590E*   3E 09          C      	LD	A,09H        ;         Tabulator MRES20
  5910*   21 58CA*       C      	LD	HL,CP.SPACE
  5913*   18 D0          C      	JR	CP.OUT
                         C      		             ;
                         C      ;**********************************************************************
                         C      		             ;
  5915*                  C      CP.INIT:
  5915*   06 03          C      	LD	B,3          ; Initialisierung COMPR
  5917*   21 58D5*       C      	LD	HL,CP.TEXT
  591A*   C9             C      	RET
                         C      		             ;
                         C      ;**********************************************************************
                         C      ;	END
                         C      	TITLE	'Dekomprimierung'
                         C      	PAGE
'Dekomprimierung'	MACRO-80 3.44	09-Dec-81	PAGE	1-20


                         C      
                         C      ;	PN	DC
                         C      ;**********************************************************************
                         C      ;*       DCMPR:    Dekomprimierung                                    *
                         C      ;*                 MRES20-Quelltexte   --->   EDIT - Format F         *
                         C      ;**********************************************************************
                         C      		             ;
  591B*                  C      DC.DCMPR	EQU	$
                         C      		             ; A:  Uebergabe/-nahme Zeichen
                         C      		             ; HL: Status-Register DCMPR
                         C      		             ; B:  Position (Spalte)
                         C      		             ;-------------------------------
                         C      		             ; INA: Einzelzeichen-Eingabe
                         C      		             ;      nach Reg. A
                         C      ;        --------------------------------------------------------------
  591B*   04             C      	INC	B            ;         Position + 1
  591C*   E9             C      	JP	(HL)
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      		             ; Status "Neue Zeile"
                         C      		             ;-------------------------------
  591D*                  C      DC.NL:
  591D*   CD 5641*       C      	CALL	XY.INCDX     ;         Satzzaehler + 1
  5920*   13             C      	DB	19
  5921*   3E 1E          C      	LD	A,1EH        ;         EDIT-New-Line
  5923*   06 01          C      	LD	B,1          ;         Pos.=1
  5925*   21 5929*       C      	LD	HL,DC.TEXT   ;         Status "TEXT"
  5928*   C9             C      	RET
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      		             ; Status "Text"
                         C      		             ;-------------------------------
  5929*                  C      DC.TEXT:
  5929*   CD 6142*       C      	CALL	UK.GETK      ;         Einzelzeichen-Eingabe
  592C*   B7             C      	OR	A
  592D*   C8             C      	RET	Z
  592E*   FE 0A          C      	CP	0AH          ;         NL ?
  5930*   28 EB          C      	JR	Z,DC.NL
  5932*   FE 09          C      	CP	09H          ;         TAB ?
  5934*   28 01          C      	JR	Z,DC.TAB
  5936*   C9             C      	RET
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      		             ; Tabulator-Behandlung
                         C      		             ;-------------------------------
  5937*                  C      DC.TAB:
  5937*   78             C      	LD	A,B
  5938*   FE 28          C      	CP	40
  593A*   D0             C      	RET	NC
  593B*   21 5941*       C      	LD	HL,DC.SPACE  ;         ---> Status "Space"
  593E*   3E 20          C      	LD	A,' '        ;         anstelle TAB Space
  5940*   C9             C      	RET
                         C      		             ;
                         C      ;        --------------------------------------------------------------
                         C      		             ; Status "Space"
                         C      		             ;-------------------------------
  5941*                  C      DC.SPACE:
  5941*   78             C      	LD	A,B
  5942*   FE 0B          C      	CP	10+1
  5944*   28 0B          C      	JR	Z,DC.EOSPC
  5946*   FE 11          C      	CP	16+1
  5948*   28 07          C      	JR	Z,DC.EOSPC
  594A*   FE 24          C      	CP	35+1
  594C*   28 03          C      	JR	Z,DC.EOSPC
  594E*   3E 20          C      	LD	A,' '
  5950*   C9             C      	RET
                         C      		             ;
  5951*                  C      DC.EOSPC:
  5951*   21 5929*       C      	LD	HL,DC.TEXT   ; TAB-Position erreicht
  5954*   18 D3          C      	JR	DC.TEXT
                         C      		             ;
                         C      		             ;
                         C      ;**********************************************************************
  5956*                  C      DC.INIT:
  5956*   21 5929*       C      	LD	HL,DC.TEXT   ; Initialisierung
  5959*   06 01          C      	LD	B,1
  595B*   C9             C      	RET
                         C      		             ;
                         C      ;**********************************************************************
                         C      ;	END
                         C      	TITLE 'Routinen fuer Monitor UND Tastatur'
                         C      	PAGE
'Routinen fuer Monitor UND Tastatur'	MACRO-80 3.44	09-Dec-81	PAGE	1-21


                         C      
  595C*                  C      UR.MIMO:
  595C*   D5             C      	PUSH	DE           ;Register DE, BC retten
  595D*   C5             C      	PUSH	BC
  595E*   46             C      	LD	B,(HL)       ;Anzahl einzugebender Zeichen
  595F*   23             C      	INC	HL
  5960*   4E             C      	LD	C,(HL)       ;Laenge der Zeichenkette
  5961*   23             C      	INC	HL
  5962*   5E             C      	LD	E,(HL)       ;Zeichenschluessel
  5963*   23             C      	INC	HL
  5964*   3A 2B00*       C      	LD	A,(UB.ZN)    ;Zeilennummer
  5967*   57             C      	LD	D,A          ;D:= Zeilennummer
  5968*   AF             C      	XOR	A
  5969*   B9             C      	CP	C
  596A*   28 0C          C      	JR	Z,UR.MIMO1   ;Anzeige entfaellt
  596C*   D5             C      	PUSH	DE
  596D*   CD 599E*       C      	CALL	UR.DSPZK     ;Anzeige
  5970*                  C      UR.MIMO2:
  5970*   D1             C      	POP	DE
  5971*   CD 59AB*       C      	CALL	UR.ZINP	     ;Zeicheneingabe ueber Tastatur
  5974*   C1             C      	POP	BC
  5975*   D1             C      	POP	DE
  5976*   18 07          C      	JR	UR.MIMO3
  5978*                  C      UR.MIMO1:
  5978*   D5             C      	PUSH	DE
  5979*   CD 598E*       C      	CALL	UR.BBSAD     ;BWS - Adresse berechnen
  597C*   EB             C      	EX	DE,HL        ;HL:= akt. Bildschirmposition
  597D*   18 F1          C      	JR	UR.MIMO2
  597F*                  C      UR.MIMO3:
  597F*   F5             C      	PUSH	AF
  5980*   3A 2B00*       C      	LD	A,(UB.ZN)
  5983*   3C             C      	INC	A
  5984*   FE 18          C      	CP	24
  5986*   CC 5A8E*       C      	CALL	Z,UR.BILRO   ;Zeile 24 ---> Bild rollen
  5989*   32 2B00*       C      	LD	(UB.ZN),A
  598C*   F1             C      	POP	AF
  598D*   C9             C      	RET
  598E*                  C      UR.BBSAD:
  598E*   E5             C      	PUSH	HL           ;Berechnung der BWS-Adresse
  598F*   C5             C      	PUSH	BC           ;IN:    D...Zeilennummer
  5990*   21 2FB0        C      	LD	HL,UE.BWSA-80;OUT:   DE..BWS-Adresse
  5993*   01 0050        C      	LD	BC,80        ;BC:= Zeichen/Zeile
  5996*                  C      UR.BBSA1:
  5996*   09             C      	ADD	HL,BC
  5997*   15             C      	DEC	D
  5998*   20 FC          C      	JR	NZ,UR.BBSA1
  599A*   EB             C      	EX	DE,HL
  599B*   C1             C      	POP	BC
  599C*   E1             C      	POP	HL
  599D*   C9             C      	RET
  599E*                  C      UR.DSPZK:
  599E*   D5             C      	PUSH	DE           ;Anzeige
  599F*   C5             C      	PUSH	BC           ;IN   HL...Anfangsadresse ZK
  59A0*   CD 598E*       C      	CALL	UR.BBSAD     ;      D...Zeilennummer
  59A3*   06 00          C      	LD	B,0          ;      C...Zeichenkettenlaenge
  59A5*   ED B0          C      	LDIR	             ;OUT  HL...akt. BWS-Adresse
  59A7*   EB             C      	EX	DE,HL
  59A8*   C1             C      	POP	BC
  59A9*   D1             C      	POP	DE
  59AA*   C9             C      	RET
  59AB*                  C      UR.ZINP:
  59AB*   E5             C      	PUSH	HL           ;Zeicheneingabe ueber Tastatur
  59AC*   AF             C      	XOR	A            ;IN    B...Zeichenanzahl (max.)
  59AD*   50             C      	LD	D,B          ;     HL...akt. Adresse
  59AE*   B8             C      	CP	B            ;      E...Zeichenschluessel
  59AF*   28 3D          C      	JR	Z,UR.RET0    ;keine Zeicheneingabe
  59B1*                  C      UR.ZINP1:
  59B1*   CD 4033        C      	CALL	SY.SETCHL    ;Kursor setzen
  59B4*                  C      UR.ZINP2:
  59B4*   CD 5A88*       C      	CALL	UR.TAREP     ;Tastaturabfrage
  59B7*   CD 59F8*       C      	CALL	UR.TCL       ; <---
  59BA*   CD 5A0D*       C      	CALL	UR.TCR       ; --->
  59BD*   CD 5A20*       C      	CALL	UR.TSYS      ; SYS
  59C0*   CD 5A28*       C      	CALL	UR.TQUIT     ; POS.QUIT
  59C3*   CD 5A30*       C      	CALL	UR.ZKONT     ;Zeichenkontrolle
  59C6*   CD 4036        C      	CALL	SY.RESC      ;Kursor loeschen
  59C9*   77             C      	LD	(HL),A       ;Zeichen anzeigen
  59CA*   23             C      	INC	HL           ;akt. Adresse erhoehen
  59CB*   10 E4          C      	DJNZ	UR.ZINP1     ;B > 0, naechstes Zeichen
  59CD*   CD 4033        C      	CALL	SY.SETCHL    ;Kursor setzen
  59D0*                  C      UR.ZINP5:
  59D0*   CD 5A88*       C      	CALL	UR.TAREP
'Routinen fuer Monitor UND Tastatur'	MACRO-80 3.44	09-Dec-81	PAGE	1-22


  59D3*   FE F7          C      	CP	UE.TACL
  59D5*   CC 59F1*       C      	CALL	Z,UR.ZINP7
  59D8*   FE 1E          C      	CP	UE.TAQUI
  59DA*   28 06          C      	JR	Z,UR.ZINP3   ;---> POS.QUIT
  59DC*   FE CD          C      	CP	UE.TASYS
  59DE*   28 08          C      	JR	Z,UR.ZINP4   ;---> SYS
  59E0*   18 EE          C      	JR	UR.ZINP5
  59E2*                  C      UR.ZINP3:
  59E2*   CD 4036        C      	CALL	SY.RESC      ;Kursor loeschen
  59E5*   E1             C      	POP	HL           ;BWS - Adresse auskellern
  59E6*   AF             C      	XOR	A            ;CY:= 0
  59E7*   C9             C      	RET
  59E8*                  C      UR.ZINP4:
  59E8*   CD 4036        C      	CALL	SY.RESC      ;Kursor loeschen
  59EB*   E1             C      	POP	HL
  59EC*   37             C      	SCF	             ;CY:= 1
  59ED*   C9             C      	RET
  59EE*                  C      UR.RET0:
  59EE*   E1             C      	POP	HL           ;keine Zeicheneingabe
  59EF*   AF             C      	XOR	A
  59F0*   C9             C      	RET
  59F1*                  C      UR.ZINP7:
  59F1*   CD 59F8*       C      	CALL	UR.TCL
  59F4*   33             C      	INC	SP
  59F5*   33             C      	INC	SP
  59F6*   18 BC          C      	JR	UR.ZINP2
  59F8*                  C      UR.TCL:
  59F8*   FE F7          C      	CP	UE.TACL      ;   <---
  59FA*   C0             C      	RET	NZ           ;Taste nicht gedrueckt
  59FB*   F5             C      	PUSH	AF           ;Tastencode retten
  59FC*   04             C      	INC	B
  59FD*   7A             C      	LD	A,D
  59FE*   B8             C      	CP	B
  59FF*   38 09          C      	JR	C,UR.TCLN    ;Linksbewegung nicht zulaessig
  5A01*   CD 4036        C      	CALL	SY.RESC      ;Kursor loeschen
  5A04*   2B             C      	DEC	HL           ;BWS - Adresse decrementieren
  5A05*   CD 4033        C      	CALL	SY.SETCHL    ;Kursor setzen
  5A08*   F1             C      	POP	AF           ;Code auskellern
  5A09*   C9             C      	RET
  5A0A*                  C      UR.TCLN:
  5A0A*   05             C      	DEC	B
  5A0B*   F1             C      	POP	AF
  5A0C*   C9             C      	RET
  5A0D*                  C      UR.TCR:
  5A0D*   FE F9          C      	CP	UE.TACR      ;   --->
  5A0F*   C0             C      	RET	NZ
  5A10*   F5             C      	PUSH	AF
  5A11*   78             C      	LD	A,B
  5A12*   FE 02          C      	CP	2
  5A14*   38 08          C      	JR	C,UR.TCRN
  5A16*   05             C      	DEC	B
  5A17*   CD 4036        C      	CALL	SY.RESC
  5A1A*   23             C      	INC	HL
  5A1B*   CD 4033        C      	CALL	SY.SETCHL
  5A1E*                  C      UR.TCRN:
  5A1E*   F1             C      	POP	AF
  5A1F*   C9             C      	RET
  5A20*                  C      UR.TSYS:
  5A20*   FE CD          C      	CP	UE.TASYS     ; SYS-Taste
  5A22*   C0             C      	RET	NZ
  5A23*   33             C      	INC	SP
  5A24*   33             C      	INC	SP           ;Returnadresse uebergehen
  5A25*   C3 59E8*       C      	JP	UR.ZINP4
  5A28*                  C      UR.TQUIT:
  5A28*   FE 1E          C      	CP	UE.TAQUI     ; POS.QUIT
  5A2A*   C0             C      	RET	NZ
  5A2B*   33             C      	INC	SP
  5A2C*   33             C      	INC	SP
  5A2D*   C3 59E2*       C      	JP	UR.ZINP3
  5A30*                  C      UR.ZKONT:
  5A30*   FE 7F          C      	CP	7FH
  5A32*   30 22          C      	JR	NC,UR.ZKON1
  5A34*   CB 7B          C      	BIT	7,E          ;Zeichenschluesselauswertung
  5A36*   C0             C      	RET	NZ           ;Bit 7 = L, alle Tasten erlaubt
  5A37*   FE 20          C      	CP	20H
  5A39*   C8             C      	RET	Z            ;Leertaste
  5A3A*   CB 6B          C      	BIT	5,E
  5A3C*   37             C      	SCF
  5A3D*   C4 5A5B*       C      	CALL	NZ,UR.ALPHA
  5A40*   D0             C      	RET	NC           ;Bit 5 = L, nur Buchstaben
  5A41*   CB 63          C      	BIT	4,E
  5A43*   37             C      	SCF
  5A44*   C4 5A66*       C      	CALL	NZ,UR.NUM
'Routinen fuer Monitor UND Tastatur'	MACRO-80 3.44	09-Dec-81	PAGE	1-23


  5A47*   D0             C      	RET	NC           ;Bit 4 = L, nur Ziffern
  5A48*   CB 73          C      	BIT	6,E
  5A4A*   37             C      	SCF
  5A4B*   C4 5A6F*       C      	CALL	NZ,UR.ALPNU
  5A4E*   D0             C      	RET	NC           ;Bit 6 = L, Buchstaben und
                         C      		             ;            Ziffern
  5A4F*   CB 5B          C      	BIT	3,E
  5A51*   37             C      	SCF
  5A52*   C4 5A79*       C      	CALL	NZ,UR.HEXAZ
  5A55*   D0             C      	RET	NC           ;BIT 3 = L ,HEXAZEICHEN
  5A56*                  C      UR.ZKON1:
  5A56*   33             C      	INC	SP
  5A57*   33             C      	INC	SP
  5A58*   C3 59B4*       C      	JP	UR.ZINP2     ;unerlaubter Tastencode
  5A5B*                  C      UR.ALPHA:
  5A5B*   FE 41          C      	CP	41H
  5A5D*   D8             C      	RET	C
  5A5E*   FE 5B          C      	CP	5BH
  5A60*   38 02          C      	JR	C,UR.ALPH1
  5A62*   37             C      	SCF
  5A63*   C9             C      	RET
  5A64*                  C      UR.ALPH1:
  5A64*   3F             C      	CCF
  5A65*   C9             C      	RET
  5A66*                  C      UR.NUM:
  5A66*   FE 30          C      	CP	30H
  5A68*   D8             C      	RET	C
  5A69*   FE 3A          C      	CP	3AH
  5A6B*   38 F7          C      	JR	C,UR.ALPH1
  5A6D*   37             C      	SCF
  5A6E*   C9             C      	RET
  5A6F*                  C      UR.ALPNU:
  5A6F*   CD 5A5B*       C      	CALL	UR.ALPHA
  5A72*   D0             C      	RET	NC
  5A73*   CD 5A66*       C      	CALL	UR.NUM
  5A76*   D0             C      	RET	NC
  5A77*   37             C      	SCF
  5A78*   C9             C      	RET
  5A79*                  C      UR.HEXAZ:
  5A79*   CD 5A66*       C      	CALL	UR.NUM
  5A7C*   D0             C      	RET	NC
  5A7D*   FE 41          C      	CP	'A'
  5A7F*   D8             C      	RET	C
  5A80*   FE 47          C      	CP	'G'
  5A82*   38 02          C      	JR	C,UR.HEXZ1
  5A84*   37             C      	SCF
  5A85*   C9             C      	RET
  5A86*                  C      UR.HEXZ1:
  5A86*   3F             C      	CCF
  5A87*   C9             C      	RET
                         C      
  5A88*                  C      UR.TAREP:
  5A88*   CD 4026        C      	CALL	TA.ABFR1     ;TASTATURROUTINE FUER ATS
  5A8B*   28 FB          C      	JR	Z,$-3        ;ES LIEGT KEIN ZEICHEN AN
  5A8D*   C9             C      	RET
                         C      
  5A8E*                  C      UR.BILRO:
  5A8E*   C5             C      	PUSH	BC
  5A8F*   D5             C      	PUSH	DE
  5A90*   E5             C      	PUSH	HL
  5A91*   01 03C0        C      	LD	BC,960
  5A94*   11 3370        C      	LD	DE,UE.BWSA+880
  5A97*   21 33C0        C      	LD	HL,UE.BWSA+960
  5A9A*   ED B0          C      	LDIR
  5A9C*   3E 20          C      	LD	A,20H        ;letzte Zeile loeschen
  5A9E*   06 50          C      	LD	B,80
  5AA0*                  C      UR.BILR1:
  5AA0*   12             C      	LD	(DE),A
  5AA1*   10 FD          C      	DJNZ	UR.BILR1
  5AA3*   E1             C      	POP	HL
  5AA4*   AF             C      	XOR	A
  5AA5*   01 0050        C      	LD	BC,80
  5AA8*   ED 42          C      	SBC	HL,BC        ;aktuelle BWS-Adresse nach  ROLL
  5AAA*   3A 2B00*       C      	LD	A,(UB.ZN)
  5AAD*   D1             C      	POP	DE
  5AAE*   C1             C      	POP	BC
  5AAF*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                                ;
                                ;	INCLUDE K1.MAC	;BAMOS/Emulator  ---  Kassettenmagnetband
                                ;	INCLUDE	KR.MAC	;Kassettengrundroutinen
                                ;	INCLUDE	UF.MAC	;Fehleranzeige und Behandlung
'Routinen fuer Monitor UND Tastatur'	MACRO-80 3.44	09-Dec-81	PAGE	1-24


                                ;	INCLUDE	UA.MAC	;Ausschriften
                                ;	INCLUDE UR.MAC	;Routinen fuer Kassette
                                ;	INCLUDE	UK.MAC	;Einzelzeicheneingabe fuer KMBG
                         C      	INCLUDE K2.MAC	;BAMOS/Emulator  ---  Kassettenmagnetband
                         C      	TITLE 'BAMOS/Emulator  ---  Kassettenmagnetband'
                         C      	PAGE
'BAMOS/Emulator  ---  Kassettenmagnetband'	MACRO-80 3.44	09-Dec-81	PAGE	1-25


                         C      
                         C      ;****************************************************************
                         C      ;*               BAMOS/Emulator  ---  Kassettenmagnetband       *
                         C      ;* OS - Version  -----------------------------------------------*
                         C      ;*               Programmierer: Marcus Herbote                  *
                         C      ;* V 1 . 2       -----------------------------------------------*
                         C      ;*               Stand        : 18.November 2022                *
                         C      ;****************************************************************
                         C      
                         C      ;****************************************************************
                         C      ;*               BAMOS/Robotron         Stand: 01.Januar 1981   *
                         C      ;*               -----------------------------------------------*
                         C      ;*               Geraetebedienroutine fuer Kassettenmagnetband  *
                         C      ;*               Anschluss von zwei Laufwerken K5200            *
                         C      ;*               an einer AKB K5020                             *
                         C      ;*               -----------------------------------------------*
                         C      ;*               E/A-Tabelle                                    *
                         C      ;*               Byte -2   HS-Bereich                           *
                         C      ;*               Byte -1   laenge der Daten im Puffer           *
                         C      ;*                         1, 10H, 20H, 80H                     *
                         C      ;*               -----------------------------------------------*
                         C      ;*               Byte  0   Status                               *
                         C      ;*               Byte  1   Fehlerschluessel                     *
                         C      ;*               Byte  2   Basisadresse der AKB                 *
                         C      ;*               Byte  3   Subadresse                           *
                         C      ;*               Byte  4   Kommando                             *
                         C      ;*               Byte  5   L-Teil Adresse Eintrittspunkt        *
                         C      ;*               Byte  6   H-Teil Adresse Eintrittspunkt        *
                         C      ;*               Byte  7   L-Teil Blockadresse                  *
                         C      ;*               Byte  8   H-Teil Blockadresse                  *
                         C      ;*               Byte  9   H-Teil Blocklaenge (Bit 15...Bit 8)  *
                         C      ;*               Byte 10   L-Teil Blocklaenge (Bit  7...Bit 0)  *
                         C      ;*                         n      bei suchen Bandmarke          *
                         C      ;*               Byte 11   Anzahl Lese-/Schreib wiederholen     *
                         C      ;*               Byte 12   Anzahl Blocklueckenverlaengerungen   *
                         C      ;****************************************************************
                         C      ;*               Bytes fuer die Uebergabe an den Z80-Emulator   *
                         C      ;*               -----------------------------------------------*
                         C      ;*               Byte 28 1 0F0H  Startbyte                      *
                         C      ;*               Byte 29 2       Kommando                       *
                         C      ;*               Byte 30 3       Subadresse                     *
                         C      ;*               Byte 31 4       Anzahl BM  bei 71, 75          *
                         C      ;*               Byte 31 4       'B'        bei 51              *
                         C      ;*               Byte 31 4       'S'        bei 61              *
                         C      ;*               Byte 31 4       HS-Bereich bei 02              *
                         C      ;*               Byte 31 4       Laenge     bei 08              *
                         C      ;*               Byte 31 4 0FFH             bei 31,41,21,11,15  *
                         C      ;*               Byte 32 5       H(Puffer)  bei 02              *
                         C      ;*               Byte 32 5       HS-Bereich bei 08              *
                         C      ;*               Byte 32 5 0FFH             bei 51,61,71,75     *
                         C      ;*               Byte 33 6       L(Puffer)  bei 02              *
                         C      ;*               Byte 33 6       H(Puffer)  bei 08              *
                         C      ;*               Byte 34 7       L(Puffer)  bei 08              *
                         C      ;*               Byte 34 7 0FFH             bei 02              *
                         C      ;*               Byte 35 8 0FFH             bei 08              *
                         C      ;****************************************************************
                         C      ;*               Kommandos:                                     *
                         C      ;*                 Hex   Kommando                               *
                         C      ;*                 02    naechsten Record einlesen              *
                         C      ;*                 08    naechsten Record schreiben             *
                         C      ;*                 11    einen Block vorsetzen                  *
                         C      ;*                 15    einen Block ruecksetzen                *
                         C      ;*                 21    umspulen                               *
                         C      ;*                 31    reservieren ein                        *
                         C      ;*                 41    reservieren aus                        *
                         C      ;*                 51    schreiben einer Bandmarke              *
                         C      ;*                 61    schreiben Schlussluecke                *
                         C      ;*                 71    suche n-te Bandmarke vorwaerts         *
                         C      ;*                 75    suche n-te Bandmarke rueckwaerts       *
                         C      ;****************************************************************
                         C      	PAGE
'BAMOS/Emulator  ---  Kassettenmagnetband'	MACRO-80 3.44	09-Dec-81	PAGE	1-26


                         C      
                         C      ;****************************************************************
                         C      ;*               Status                                         *
                         C      ;*               Bit 0     0 Geraet frei                        *
                         C      ;*                         1 Geraet besetzt                     *
                         C      ;*               Bit 1     0                                    *
                         C      ;*                         1 Datentraegerende                   *
                         C      ;*               Bit 2     0 Aufzeichnen erlaubt                *
                         C      ;*                         1 Aufzeichnen verboten               *
                         C      ;*               Bit 3     0 Kassettenseite A                   *
                         C      ;*                         1 Kassettenseite B                   *
                         C      ;*               Bit 4     0 Geraet       bereit                *
                         C      ;*                         1 Geraet nicht bereit                *
                         C      ;*               Bit 5     0 Geraet nicht reserviert            *
                         C      ;*                         1 Geraet       reserviert            *
                         C      ;*               Bit 6     0 Aufzeichnungsverf.  38 CM*S**-1    *
                         C      ;*                         1 Aufzeichnungsverf.  19 CM*S**-1    *
                         C      ;*               Bit 7     0 Kommando fehlerfrei ausgefuehrt    *
                         C      ;*                         1 Fehler (siehe Fehlerschluessel)    *
                         C      ;*               -----------------------------------------------*
                         C      ;*               Fehlerschluessel                               *
                         C      ;*                 Hex   Fehler                                 *
                         C      ;*                 10    falsches Kommando                      *
                         C      ;*                 11    angewaehltes Geraet nicht reserviert   *
                         C      ;*                 12    Subadresse falsch                      *
                         C      ;*                 13    Pufferl. kleiner 12 oder groesser 256  *
                         C      ;*                 14    Ende der Aufzeichnungen auf dieser     *
                         C      ;*                       Kassettenseite (Lesen)                 *
                         C      ;*                 15    angewaehltes Geraet besetzt            *
                         C      ;*                 16    Ende/Anfang der Aufzeichnungen         *
                         C      ;*                       (Bandmarke suchen)                     *
                         C      ;*                 17    gelesener Block laenger 260 Byte       *
                         C      ;*                 18    Bandmarke nicht gefunden               *
                         C      ;*                 19    Aufzeichnen verboten                   *
                         C      ;*                       (mit Kommando: Aufzeichnen)            *
                         C      ;*               -----------------------------------------------*
                         C      ;*               nachfolgende Codes nicht bei DEG2000-Emulator  *
                         C      ;*                 21    Fehler nach festgelegter Anzahl        *
                         C      ;*                       Lesewiederholungen                     *
                         C      ;*                 22    Fehler nach festgelegter Anzahl        *
                         C      ;*                       Schreibwiederholungen                  *
                         C      ;*                 23    kein Echosignal vom Eingabekanal       *
                         C      ;*                       bei  RAW                               *
                         C      ;****************************************************************
                         C      ;*               Hinweise zur Arbeit mit der Geraetebedienr.    *
                         C      ;*                - E/A-Tabelle laden (Basisadresse AKB)        *
                         C      ;*                - Adresse E/A-Tabelle in IX laden             *
                         C      ;*                - laden Schluessel fuer Kommando , Subadresse *
                         C      ;*                    Adresse Eintrittspunkt                    *
                         C      ;*                - Aufruf Geraetebedienroutine immer mit       *
                         C      ;*                    CALL   KR.BRKMB                           *
                         C      ;*                - wird keine Parallelarbeit mit anderen       *
                         C      ;*                  Programmen gewuenscht , kann wie in         *
                         C      ;*                  folgendem Beispiel verfahren werden:        *
                         C      ;*                        ...                                   *
                         C      ;*                        CALL KR.BRKMB ;Aufruf                 *
                         C      ;*                  MARKE:HALT                                  *
                         C      ;*                        JR   MARKE-#                          *
                         C      ;*                  ADREP:............  ;Adresse Eintrittspunkt *
                         C      ;*                        ...                                   *
                         C      ;*                - bei Rueckkehr der Bedienroutine zum Ein-    *
                         C      ;*                  trittspunkt ist die Adresse des folgenden   *
                         C      ;*                  Befehls , bei dem der letzte Interrupt      *
                         C      ;*                  angenommen wurde , noch im SP .             *
                         C      ;*                  Wird , wie im obigen Beispiel , diese       *
                         C      ;*                  Adresse nicht mehr benoetigt , so ist der   *
                         C      ;*                  SP  um 2 zu erhoehen.                       *
                         C      ;****************************************************************
                         C      	TITLE	'Steuerteil Geraetebedienroutine'
                         C      	PAGE
'Steuerteil Geraetebedienroutine'	MACRO-80 3.44	09-Dec-81	PAGE	1-27


                         C      
                         C      ;****************************************************************
                         C      ;*               Steuerteil der Geraetebedienroutine            *
                         C      ;****************************************************************
  5AB0*                  C      K1.BRKMB:
  5AB0*   F3             C          DI
  5AB1*   CD 5B98*       C          CALL    RRET
                         C      
                         C      ;****************************************************************
                         C      ;*               Analyse Kommando                               *
                         C      ;****************************************************************
  5AB4*   DD 7E 04       C          LD  A,(IX+4)
  5AB7*   FE 02          C          CP  002H    ;naechsten Record einlesen
  5AB9*   CA 5B48*       C          JP  Z,STT02
  5ABC*   FE 08          C          CP  008H    ;naechsten Record schreiben
  5ABE*   CA 5B66*       C          JP  Z,STT08
  5AC1*   FE 11          C          CP  011H    ;einen Block vorsetzen
  5AC3*   CA 5B22*       C          JP  Z,STT11
  5AC6*   FE 15          C          CP  015H    ;einen Block ruecksetzen
  5AC8*   CA 5B22*       C          JP  Z,STT15
  5ACB*   FE 21          C          CP  021H    ;umspulen
  5ACD*   CA 5B22*       C          JP  Z,STT21
  5AD0*   FE 31          C          CP  031H    ;reservieren ein
  5AD2*   CA 5B22*       C          JP  Z,STT31
  5AD5*   FE 41          C          CP  041H    ;reservieren aus
  5AD7*   CA 5B22*       C          JP  Z,STT41
  5ADA*   FE 51          C          CP  051H    ;schreiben einer Bandmarke
  5ADC*   CA 5B2E*       C          JP  Z,STT51
  5ADF*   FE 61          C          CP  061H    ;schreiben Schlussluecke
  5AE1*   CA 5B32*       C          JP  Z,STT61
  5AE4*   FE 71          C          CP  071H    ;suche n-te Bandmarke vorwaerts
  5AE6*   CA 5B36*       C          JP  Z,STT71
  5AE9*   FE 75          C          CP  075H    ;suche n-te Bandmarke rueckwaerts
  5AEB*   CA 5B36*       C          JP  Z,STT75
  5AEE*   C3 5B94*       C          JP  STF07   ;falsches Kommando
                         C      
                         C      ;****************************************************************
                         C      ;*               Kernroutine MB                                 *
                         C      ;*               -----------------------------------------------*
                         C      ;*               Schnittstelle zum DEG2000 - Emulator           *
                         C      ;****************************************************************
  5AF1*                  C      K1.KERN:
  5AF1*   DD 36 1C F0    C          LD  (IX+28),0F0H
  5AF5*   DD 7E 04       C          LD  A,(IX+4)    ;Kommando
  5AF8*   DD 77 1D       C          LD  (IX+29),A
  5AFB*   DD 7E 03       C          LD  A,(IX+3)    ;Subadresse
  5AFE*   DD 77 1E       C          LD  (IX+30),A
                         C      
  5B01*   DD 4E 02       C          LD  C,(IX+2)    ;Basisadresse der AKB
  5B04*   DD E5          C          PUSH    IX
  5B06*   E1             C          POP HL
  5B07*   11 001C        C          LD  DE,28
  5B0A*   19             C          ADD  HL,DE
  5B0B*   ED B3          C          OTIR            ;KM - Routine aufrufen
  5B0D*   DD E5          C          PUSH    IX
  5B0F*   E1             C          POP HL
  5B10*   2B             C          DEC HL
  5B11*   2B             C          DEC HL
  5B12*   06 04          C          LD  B,4
  5B14*   ED B2          C          INIR            ;Status und Fehler holen
  5B16*   2B             C          DEC HL          ;Laenge der Daten im Puffer holen
  5B17*   2B             C          DEC HL
  5B18*   2B             C          DEC HL
  5B19*   DD 36 09 00    C          LD  (IX+9),0
  5B1D*   7E             C          LD  A,(HL)
  5B1E*   DD 77 0A       C          LD  (IX+10),A
  5B21*   C9             C          RET
                         C          TITLE   '4-/5-Byte IO-Kommandos'
                         C          PAGE
'4-/5-Byte IO-Kommandos'	MACRO-80 3.44	09-Dec-81	PAGE	1-28


                         C      
                         C      ;****************************************************************
                         C      ;*               reservieren ein / aus                          *
                         C      ;****************************************************************
  5B22*                  C      STT31:
  5B22*                  C      STT41:
                         C      ;****************************************************************
                         C      ;*               umspulen                                       *
                         C      ;****************************************************************
  5B22*                  C      STT21:
                         C      ;****************************************************************
                         C      ;*               vor-/ruecksetzen um einen Block                *
                         C      ;****************************************************************
  5B22*                  C      STT11:
  5B22*                  C      STT15:
  5B22*   DD 36 1F FF    C          LD  (IX+31),0FFH
                         C      
  5B26*   06 04          C          LD  B,4
  5B28*   CD 5AF1*       C          CALL K1.KERN
  5B2B*   C3 5BA5*       C          JP	KOMED	;Kommandoende
                         C      
                         C      ;****************************************************************
                         C      ;*               schreiben einer Bandmarke                      *
                         C      ;****************************************************************
  5B2E*                  C      STT51:
  5B2E*   3E 42          C          LD  A,'B'
  5B30*   18 07          C          JR  STT5
                         C      ;****************************************************************
                         C      ;*               schreiben einer Schlussluecke                  *
                         C      ;****************************************************************
  5B32*                  C      STT61:
  5B32*   3E 53          C          LD  A,'S'
  5B34*   18 03          C          JR  STT5
                         C      ;****************************************************************
                         C      ;*               suche Bandmarke vorwaerts / rueckwaerts        *
                         C      ;****************************************************************
  5B36*                  C      STT71:
  5B36*                  C      STT75:
  5B36*   DD 7E 0A       C          LD  A,(IX+10)	;Anzahl Bandmarken
                         C      
  5B39*                  C      STT5:
  5B39*   DD 77 1F       C          LD  (IX+31),A
  5B3C*   DD 36 20 FF    C          LD  (IX+32),0FFH
                         C      
  5B40*   06 05          C          LD  B,5
  5B42*   CD 5AF1*       C          CALL K1.KERN
  5B45*   C3 5BA5*       C          JP	KOMED	;Kommandoende
                         C      
                         C          TITLE   '7-/8-Byte IO-Kommandos'
                         C          PAGE
'7-/8-Byte IO-Kommandos'	MACRO-80 3.44	09-Dec-81	PAGE	1-29


                         C      
                         C      ;****************************************************************
                         C      ;*               Eingabezweig                                   *
                         C      ;****************************************************************
  5B48*                  C      STT02:
  5B48*   3A 2B01*       C          LD  A,(K0.HSB)   ;HS-Bereich
  5B4B*   DD 77 1F       C          LD  (IX+31),A
                         C      
  5B4E*   DD 7E 08       C          LD  A,(IX+8)
  5B51*   DD 77 20       C          LD  (IX+32),A
  5B54*   DD 7E 07       C          LD  A,(IX+7)
  5B57*   DD 77 21       C          LD  (IX+33),A
                         C      
  5B5A*   DD 36 22 FF    C          LD  (IX+34),0FFH
                         C      
  5B5E*   06 07          C          LD  B,7
  5B60*   CD 5AF1*       C          CALL K1.KERN
  5B63*   C3 5BA5*       C          JP	KOMED	;Kommandoende
                         C      
                         C      ;****************************************************************
                         C      ;*               Aufzeichnungszweig                             *
                         C      ;****************************************************************
  5B66*                  C      STT08:
  5B66*   DD 7E 0A       C          LD  A,(IX+10)            ;Laenge der Daten im Puffer
  5B69*   DD 77 1F       C          LD  (IX+31),A
                         C      
  5B6C*   3A 2B01*       C          LD  A,(K0.HSB)           ;HS-Bereich
  5B6F*   DD 77 20       C          LD  (IX+32),A
                         C      
  5B72*   DD 7E 08       C          LD  A,(IX+8)
  5B75*   DD 77 21       C          LD  (IX+33),A
  5B78*   DD 7E 07       C          LD  A,(IX+7)
  5B7B*   DD 77 22       C          LD  (IX+34),A
                         C      
  5B7E*   DD 36 23 FF    C          LD  (IX+35),0FFH
                         C      
                         C      ;     LD  DE,UE.PUF            ;Kassettenpuffer
                         C      ;     LD  H,(IX+26)
                         C      ;     LD  L,(IX+25)
                         C      ;     LD  B,(IX+9)
                         C      ;     LD  C,(IX+10)
                         C      ;     LDIR
                         C      
  5B82*   06 08          C          LD  B,8
  5B84*   CD 5AF1*       C          CALL K1.KERN
  5B87*   C3 5BA5*       C          JP	KOMED	;Kommandoende
                         C      
                         C          PAGE
'7-/8-Byte IO-Kommandos'	MACRO-80 3.44	09-Dec-81	PAGE	1-30


                         C      
                         C      ;****************************************************************
                         C      ;*               Fehler                                         *
                         C      ;****************************************************************
  5B8A*                  C      STF99:
  5B8A*   DD 75 01       C      	LD	(IX+1),L	;Fehlerschluessel laden
  5B8D*   DD CB 00 FE    C      	SET	7,(IX+0)	;Fehlerbit setzen
  5B91*                  C      STFRS:
  5B91*   C3 5BA5*       C      	JP	KOMED	;Kommandoende
                         C      
  5B94*                  C      STF07:
  5B94*   2E 10          C      	LD	L,10H	;falsches Kommando
  5B96*   18 F2          C      	JR	STF99
                         C      
                         C          PAGE
'7-/8-Byte IO-Kommandos'	MACRO-80 3.44	09-Dec-81	PAGE	1-31


                         C      
                         C      ;****************************************************************
                         C      ;*               Register AF , BC , DE , HL retten in SP        *
                         C      ;****************************************************************
  5B98*                  C      RRET:
  5B98*   E3             C          EX  (SP),HL
  5B99*   D5             C      	PUSH	DE
  5B9A*   C5             C      	PUSH	BC
  5B9B*   F5             C      	PUSH	AF
  5B9C*   E9             C          JP  (HL)
                         C      ;****************************************************************
                         C      ;*               Register AF , BC , DE , HL laden aus SP        *
                         C      ;****************************************************************
  5B9D*                  C      RLAD:
  5B9D*   E3             C          EX  (SP),HL
  5B9E*   33             C          INC SP
  5B9F*   33             C          INC SP
  5BA0*   F1             C      	POP	AF
  5BA1*   C1             C      	POP	BC
  5BA2*   D1             C      	POP	DE
  5BA3*   E3             C          EX  (SP),HL
  5BA4*   C9             C      	RET
                         C      
                         C      ;****************************************************************
                         C      ;*               Verzweigung aus Steuerteil zum Eintrittspunkt  *
                         C      ;*               des Steuerprogrammes                           *
                         C      ;****************************************************************
  5BA5*                  C      KOMED:
  5BA5*   F3             C      	DI
  5BA6*   DD CB 00 86    C      	RES 0,(IX)
  5BAA*   CD 5B9D*       C      	CALL	RLAD
  5BAD*   FB             C      	EI
  5BAE*   C9             C      	RET
                         C      
                         C          PAGE
'7-/8-Byte IO-Kommandos'	MACRO-80 3.44	09-Dec-81	PAGE	1-32


                         C      
                         C      ;****************************************************************
                         C      ;*               CRC-Zeichen berechnen                          *
                         C      ;*               <B>  = Blocklaenge , 0 = 256                   *
                         C      ;*               <HL> = Pufferadresse                           *
                         C      ;*               in  DE  nach Aufruf CRC-Zeichen                *
                         C      ;*                <D> = 1.Byte , wird zuerst gesendet           *
                         C      ;*                <E> = 2.Byte , wird danach gesendet           *
                         C      ;****************************************************************
  5BAF*                  C      K1.CRC:
  5BAF*   11 0000        C      	LD	DE,0
  5BB2*                  C      CRC0:
  5BB2*   C5             C      	PUSH	BC	;Bytelaenge
  5BB3*   06 08          C      	LD	B,8
  5BB5*   4E             C      	LD	C,(HL)
  5BB6*                  C      CRC1:
  5BB6*   79             C      	LD	A,C
  5BB7*   AA             C      	XOR	D
  5BB8*   0F             C      	RRCA		;Ergebnis Antivalenz Wort-Byte/CRC-Byte,Bit 0
  5BB9*   F5             C      	PUSH	AF
  5BBA*   CB 1B          C      	RR	E	;Verschiebung von DE um 1 Bit nach rechts
  5BBC*   CB 1A          C      	RR	D
  5BBE*   F1             C      	POP	AF	;Rueckretten F
  5BBF*   30 08          C      	JR	NC,CRC2	;Sprung wenn Antivalenz 0 + 0 = 0
  5BC1*   7A             C      	LD	A,D	;Korrektur = Umkehr Bit 13/Bit 0
  5BC2*   EE 01          C      	XOR	1	;Maske fuer D
  5BC4*   57             C      	LD	D,A	;Korrektur  D
  5BC5*   7B             C      	LD	A,E
  5BC6*   EE 20          C      	XOR	20H	;Maske fuer E
  5BC8*   5F             C      	LD	E,A	;Korrektur  E
  5BC9*                  C      CRC2:
  5BC9*   CB 09          C      	RRC	C	;Schieben Datenbyte
  5BCB*   10 E9          C      	DJNZ	CRC1
  5BCD*   C1             C      	POP	BC	;Byte abgearbeitet
  5BCE*   0B             C      	DEC	BC
  5BCF*   79             C      	LD	A,C
  5BD0*   B0             C      	OR	B
  5BD1*   C8             C      	RET	Z
  5BD2*   23             C      	INC	HL
  5BD3*   18 DD          C      	JR	CRC0
                         C      
                         C      ;	END
                         C      	TITLE	'Kassettengrundroutinen'
                         C      	PAGE
'Kassettengrundroutinen'	MACRO-80 3.44	09-Dec-81	PAGE	1-33


                         C      
                         C      ;****************************************************************
                         C      ;*               Anschlussroutinen fuer BAMOS/Emulator          *
                         C      ;* OS - Version  -----------------------------------------------*
                         C      ;*               Programmierer: Marcus Herbote                  *
                         C      ;* V 1 . 2       -----------------------------------------------*
                         C      ;*               Stand        : 18.November 2022                *
                         C      ;****************************************************************
                         C      ;	PN	KR
                         C      ;---------------------------------------------------------------------
                         C      ;        Kassettengrundroutinen
                         C      ;---------------------------------------------------------------------
  5BD5*   5BD5*          C      	DW	$
  5BD7*   4B 31 52 45    C      	DB	'K1RE'
  5BDB*                  C      KR.GR1:
  5BDB*   3E 01          C      	LD	A,01H
  5BDD*   18 08          C      	JR	KR.GR3
                         C      ;
  5BDF*   5BDF*          C      	DW	$
  5BE1*   4B 32 52 45    C      	DB	'K2RE'
  5BE5*                  C      KR.GR2:
  5BE5*   3E 02          C      	LD	A,02H
  5BE7*                  C      KR.GR3:
  5BE7*   CD 54E2*       C      	CALL	U1.KTINI
  5BEA*   DD 77 03       C      	LD	(IX+3),A
  5BED*   CD 609A*       C      	CALL	UR.KRE
  5BF0*   C9             C      	RET
                         C      ;-------------------------------------------------------------------
  5BF1*   5BF1*          C      	DW	$
  5BF3*   4B 31 4C 2B    C      	DB	'K1L+'
  5BF7*   CD 5BDB*       C      	CALL	KR.GR1
  5BFA*   18 09          C      	JR	$+11
                         C      ;
  5BFC*   5BFC*          C      	DW	$
  5BFE*   4B 32 4C 2B    C      	DB	'K2L+'
  5C02*   CD 5BE5*       C      	CALL	KR.GR2
  5C05*   21 0001        C      	LD	HL,1	; IX + 10 := 1 / Anzahl BM
  5C08*   CD 5621*       C      	CALL	XY.STDX
  5C0B*   0A             C      	DB	10
  5C0C*   CD 60B2*       C      	CALL	UR.KLV
  5C0F*   C9             C      	RET
                         C      ;---------------------------------------------------------------------
  5C10*   5C10*          C      	DW	$
  5C12*   4B 31 4C 2D    C      	DB	'K1L-'
  5C16*   CD 5BDB*       C      	CALL	KR.GR1
  5C19*   18 09          C      	JR	$+11
                         C      ;
  5C1B*   5C1B*          C      	DW	$
  5C1D*   4B 32 4C 2D    C      	DB	'K2L-'
  5C21*   CD 5BE5*       C      	CALL	KR.GR2
  5C24*   21 0001        C      	LD	HL,1	; IX + 10 := 1 / Anzahl BM
  5C27*   CD 5621*       C      	CALL	XY.STDX
  5C2A*   0A             C      	DB	10
  5C2B*   CD 60B8*       C      	CALL	UR.KLR
  5C2E*   C9             C      	RET
                         C      ;---------------------------------------------------------------------
  5C2F*   5C2F*          C      	DW	$
  5C31*   4B 31 52 2B    C      	DB	'K1R+'
  5C35*   CD 5BDB*       C      	CALL	KR.GR1
  5C38*   18 09          C      	JR	$+11
                         C      ;
  5C3A*   5C3A*          C      	DW	$
  5C3C*   4B 32 52 2B    C      	DB	'K2R+'
  5C40*   CD 5BE5*       C      	CALL	KR.GR2
  5C43*   CD 60CA*       C      	CALL	UR.KBV
  5C46*   C9             C      	RET
                         C      ;--------------------------------------------------------------------
  5C47*   5C47*          C      	DW	$
  5C49*   4B 31 52 2D    C      	DB	'K1R-'
  5C4D*   CD 5BDB*       C      	CALL	KR.GR1
  5C50*   18 09          C      	JR	$+11
                         C      ;
  5C52*   5C52*          C      	DW	$
  5C54*   4B 32 52 2D    C      	DB	'K2R-'
  5C58*   CD 5BE5*       C      	CALL	KR.GR2
  5C5B*   CD 60D0*       C      	CALL	UR.KBR
  5C5E*   C9             C      	RET
                         C      ;--------------------------------------------------------------------
  5C5F*   5C5F*          C      	DW	$
  5C61*   4B 31 52 57    C      	DB	'K1RW'
  5C65*   CD 5BDB*       C      	CALL	KR.GR1
  5C68*   18 09          C      	JR	$+11
'Kassettengrundroutinen'	MACRO-80 3.44	09-Dec-81	PAGE	1-34


                         C      ;
  5C6A*   5C6A*          C      	DW	$
  5C6C*   4B 32 52 57    C      	DB	'K2RW'
  5C70*   CD 5BE5*       C      	CALL	KR.GR2
  5C73*   CD 60A2*       C      	CALL	UR.KRW
  5C76*   C9             C      	RET		;JR	KR.CKRA
                         C      ;---------------------------------------------------------------------
  5C77*   5C77*          C      	DW	$
  5C79*   4B 31 52 41    C      	DB	'K1RA'
  5C7D*   CD 5BDB*       C      	CALL	KR.GR1
  5C80*   18 09          C      	JR	$+11
                         C      ;
  5C82*   5C82*          C      	DW	$
  5C84*   4B 32 52 41    C      	DB	'K2RA'
  5C88*   CD 5BE5*       C      	CALL	KR.GR2
  5C8B*                  C      KR.CKRA:
  5C8B*   CD 60A2*       C      	CALL	UR.KRW
  5C8E*   CD 60AC*       C      	CALL	UR.KRA
  5C91*   C9             C      	RET
                         C      ;---------------------------------------------------------------------
  5C92*                  C      KR.KARO:
  5C92*   CD 5AB0*       C      	CALL	UE.BRKMB	;AUFRUF PHYS.KASS.ROUTINE
  5C95*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  5C96*                  C      KR.VORSP:
  5C96*   11 3327        C      	LD	DE,UE.BWSA + 10*80 +7	;327H
  5C99*   CD 5761*       C      	CALL	UC.CVDB
  5C9C*   45             C      	LD	B,L
  5C9D*   3E 46          C      	LD	A,'F'
  5C9F*   32 2B28*       C      	LD	(UB.PAR2),A
  5CA2*   CD 609A*       C      	CALL	UR.KRE
  5CA5*   CD 60DF*       C      	CALL	UR.POSIK
  5CA8*   C9             C      	RET
                         C      ;---------------------------------------------------------------------
  5CA9*   5CA9*          C      	DW	$
  5CAB*   58 4B 41 31    C      	DB	'XKA1'
  5CAF*   CD 5BDB*       C      	CALL	KR.GR1
  5CB2*   18 09          C      	JR	KR.XKA1
                         C      ;
  5CB4*   5CB4*          C      	DW	$
  5CB6*   58 4B 41 32    C      	DB	'XKA2'
  5CBA*   CD 5BE5*       C      	CALL	KR.GR2
  5CBD*                  C      KR.XKA1:
  5CBD*   CD 609A*       C      	CALL	UR.KRE
  5CC0*   CD 5C96*       C      	CALL	KR.VORSP
  5CC3*   CD 6859*       C      	CALL	FD.FDINP
  5CC6*   CD 60A2*       C      	CALL	UR.KRW
  5CC9*   CD 60AC*       C      	CALL	UR.KRA
  5CCC*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  5CCD*   5CCD*          C      	DW	$
  5CCF*   59 4B 41 31    C      	DB	'YKA1'
  5CD3*   CD 5BDB*       C      	CALL	KR.GR1
  5CD6*   18 09          C      	JR	KR.YKA1	;$+11
                         C      ;
  5CD8*   5CD8*          C      	DW	$
  5CDA*   59 4B 41 32    C      	DB	'YKA2'
  5CDE*   CD 5BE5*       C      	CALL	KR.GR2
  5CE1*                  C      KR.YKA1:
  5CE1*   CD 609A*       C      	CALL	UR.KRE
  5CE4*   11 3327        C      	LD	DE,UE.BWSA + 10*80 +7	;327H
  5CE7*   CD 5761*       C      	CALL	UC.CVDB
  5CEA*   2D             C      	DEC	L
  5CEB*   28 09          C      	JR	Z,KR.YKA2	;$+11
  5CED*   DD 75 0A       C      	LD	(IX+10),L
  5CF0*   CD 5D1F*       C      	CALL	KR.TYPT
  5CF3*   CD 60B2*       C      	CALL	UR.KLV
  5CF6*                  C      KR.YKA2:
  5CF6*   CD 68AC*       C      	CALL	FD.FDOUT
  5CF9*   18 15          C      	JR	KR.KCL	;BM und SL schreiben; Rewind; RA
  5CFB*   C9             C      	RET
                         C      ;---------------------------------------------------------------------------
  5CFC*   5CFC*          C      	DW	$
  5CFE*   4B 31 43 4C    C      	DB	'K1CL'
  5D02*   CD 5BDB*       C      	CALL	KR.GR1
  5D05*   18 09          C      	JR	KR.KCL	;$+11
                         C      ;
  5D07*   5D07*          C      	DW	$
  5D09*   4B 32 43 4C    C      	DB	'K2CL'
  5D0D*   CD 5BE5*       C      	CALL	KR.GR2
  5D10*                  C      KR.KCL:
  5D10*   CD 60BE*       C      	CALL	UR.KBM
  5D13*   CD 60C4*       C      	CALL	UR.KSL
'Kassettengrundroutinen'	MACRO-80 3.44	09-Dec-81	PAGE	1-35


  5D16*   CD 60A2*       C      	CALL	UR.KRW
  5D19*   CD 60AC*       C      	CALL	UR.KRA
  5D1C*   C3 000B        C      	JP	UE.SYSTB
                         C      ;--------------------------------------------------------------------
  5D1F*                  C      KR.TYPT:
  5D1F*   13             C      	INC	DE
  5D20*   1A             C      	LD	A,(DE)
  5D21*   32 2B28*       C      	LD	(UB.PAR2),A
  5D24*   C9             C      	RET
                         C      ;--------------------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Fehleranzeige und Behandlung'
                         C      	PAGE
'Fehleranzeige und Behandlung'	MACRO-80 3.44	09-Dec-81	PAGE	1-36


                         C      
                         C      ;	PN	UF
                         C      ;***************************************************************
                         C      ;
                         C      ;      Fehleranzeige  UND  BEHANDLUNG
                         C      ;
                         C      ;***************************************************************
  5D25*                  C      UF.RET:
  5D25*   F1             C      	POP	AF
  5D26*   C1             C      	POP	BC
  5D27*   D1             C      	POP	DE
  5D28*   E1             C      	POP	HL
  5D29*   C9             C      	RET
                         C      ;---------------------Ausfhr. Kass.kommando lt.Steuerblock-------------
  5D2A*                  C      UF.EXEC:
  5D2A*   E5             C      	PUSH	HL
  5D2B*   D5             C      	PUSH	DE
  5D2C*   C5             C      	PUSH	BC
  5D2D*   F5             C      	PUSH	AF
  5D2E*   DD CB 00 BE    C      	RES	7,(IX)
  5D32*   DD 36 01 00    C      	LD	(IX+1),0
                         C      	;JP	KO.KO05
                         C      
  5D36*   3E 01          C      	LD	A,1
  5D38*   32 2B01*       C      	LD	(K0.HSB),A	;HS-Bereich
  5D3B*   DD 7E 04       C      	LD	A,(IX+4)	;Kommando
  5D3E*   FE 71          C      	CP	071H
  5D40*   28 0C          C      	JR	Z,UF.EXEC2
  5D42*   FE 75          C      	CP	075H
  5D44*   28 08          C      	JR	Z,UF.EXEC2
  5D46*   DD 36 07 65    C      	LD	(IX+7),LOW(UE.PUF)
  5D4A*   DD 36 08 0E    C      	LD	(IX+8),HIGH(UE.PUF)
  5D4E*                  C      UF.EXEC2:
  5D4E*   CD 5C92*       C      	CALL	KR.KARO
  5D51*                  C      UF.EXEC1:
  5D51*   DD CB 00 7E    C      	BIT	7,(IX)	;Status
  5D55*   28 CE          C      	JR	Z,UF.RET
  5D57*   DD 7E 01       C      	LD	A,(IX+1)	;FehlerschlC<ssel
                         C      ;-------------------------Fehlerbehandlung---------------
  5D5A*                  C      UF.ERANZ:
  5D5A*   E5             C      	PUSH	HL
  5D5B*   D5             C      	PUSH	DE
  5D5C*   C5             C      	PUSH	BC
  5D5D*   F5             C      	PUSH	AF
  5D5E*   F5             C      	PUSH	AF
  5D5F*   3E 13          C      	LD	A,19
  5D61*   32 2B00*       C      	LD	(UB.ZN),A
  5D64*   21 5FBD*       C      	LD	HL,UA.ZKF	;IN: <A> Fehlerschluessel
  5D67*   CD 595C*       C      	CALL	UR.MIMO
  5D6A*   F1             C      	POP	AF
  5D6B*   F5             C      	PUSH	AF
  5D6C*   EB             C      	EX	DE,HL
  5D6D*   CD 56A5*       C      	CALL	UC.CVBX+2
  5D70*   F1             C      	POP	AF
  5D71*   FE 17          C      	CP	17H
  5D73*   CA 5DF5*       C      	JP	Z,UF.FL17
  5D76*   FE 18          C      	CP	18H
  5D78*   CA 5DE9*       C      	JP	Z,UF.FL18
  5D7B*   FE 00          C      	CP	00H
  5D7D*   CA 5DDB*       C      	JP	Z,UF.BEHB
  5D80*   FE 11          C      	CP	11H
  5D82*   CA 5DDB*       C      	JP	Z,UF.BEHB
  5D85*   FE 19          C      	CP	19H
  5D87*   28 1D          C      	JR	Z,UF.AZVB
  5D89*   FE 14          C      	CP	14H
  5D8B*   CA 5DF8*       C      	JP	Z,UF.FL14
  5D8E*   FE 16          C      	CP	16H
  5D90*   CA 5DFB*       C      	JP	Z,UF.FL16
  5D93*   C3 5D25*       C      	JP	UF.RET
                         C      ;----------------------------------------------------------------------
  5D96*                  C      UF.SYS:
  5D96*   DD 7E 01       C      	LD	A,(IX+1)
  5D99*   11 35A8        C      	LD	DE,UE.BWSA+5A8H
  5D9C*   CD 56A5*       C      	CALL	UC.CVBX+2
  5D9F*   00             C      	NOP
  5DA0*   00             C      	NOP
  5DA1*   00             C      	NOP
  5DA2*                  C      UF.SYS1:
  5DA2*   31 0CE0        C      	LD	SP,UE.STANF
  5DA5*   C9             C      	RET
                         C      ;----------------------------------------------------------
  5DA6*                  C      UF.AZVB:
'Fehleranzeige und Behandlung'	MACRO-80 3.44	09-Dec-81	PAGE	1-37


  5DA6*   DD CB 00 96    C      	RES	2,(IX)	;Aufzeichnen verboten
  5DAA*   DD 36 04 41    C      	LD	(IX+4),41H
  5DAE*   CD 5C92*       C      	CALL	KR.KARO
  5DB1*   DD CB 00 7E    C      	BIT	7,(IX)
  5DB5*   20 DF          C      	JR	NZ,UF.SYS
  5DB7*   21 5F2D*       C      	LD	HL,UA.FRZ
  5DBA*   CD 595C*       C      	CALL	UR.MIMO
  5DBD*   38 E3          C      	JR	C,UF.SYS1
  5DBF*   DD 36 04 31    C      	LD	(IX+4),31H
  5DC3*   CD 5C92*       C      	CALL	KR.KARO
  5DC6*   DD CB 00 66    C      	BIT	4,(IX+0)
  5DCA*   20 CA          C      	JR	NZ,UF.SYS
  5DCC*   DD CB 00 7E    C      	BIT	7,(IX+0)
  5DD0*   20 C4          C      	JR	NZ,UF.SYS
  5DD2*   DD CB 00 56    C      	BIT	2,(IX+0)
  5DD6*   20 BE          C      	JR	NZ,UF.SYS
  5DD8*   C3 5DE3*       C      	JP	UF.BEHB1
                         C      ;----------------------------------------------------------
  5DDB*                  C      UF.BEHB:
  5DDB*   21 5F2D*       C      	LD	HL,UA.FRZ
  5DDE*   CD 595C*       C      	CALL	UR.MIMO
  5DE1*   38 BF          C      	JR	C,UF.SYS1
                         C      
  5DE3*                  C      UF.BEHB1:
  5DE3*                  C      KO.KO04:
  5DE3*   DD 71 04       C      	LD	(IX+4),C	;FUER UF19
  5DE6*   C3 5D2E*       C      	JP	UF.EXEC+4
                         C      ;---------------------------------------
  5DE9*                  C      UF.FL18:
  5DE9*   21 5F33*       C      	LD	HL,UA.BMGF
  5DEC*   CD 595C*       C      	CALL	UR.MIMO
  5DEF*   DA 5DA2*       C      	JP	C,UF.SYS1
  5DF2*   C3 5D25*       C      	JP	UF.RET
                         C      ;------------------------------------------
  5DF5*                  C      UF.FL17:
  5DF5*   C3 5D25*       C      	JP	UF.RET
                         C      ;-------------------------------------
  5DF8*                  C      UF.FL14:
  5DF8*   C3 5D25*       C      	JP	UF.RET
                         C      
  5DFB*                  C      UF.FL16:
  5DFB*   21 5F2D*       C      	LD	HL,UA.FRZ
  5DFE*   CD 595C*       C      	CALL	UR.MIMO
  5E01*   C3 5D25*       C      	JP	UF.RET
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Ausschriften'
                         C      	PAGE
'Ausschriften'	MACRO-80 3.44	09-Dec-81	PAGE	1-38


                         C      
                         C      ;	PN	UA01
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;     AUSSCHRIFTEN
                         C      ;
                         C      ;----------------------------------------------------------------------
  5E04*                  C      UA.DS:
  5E04*   00             C      	DB	0
  5E05*   01             C      	DB	1
  5E06*   00             C      	DB	0
  5E07*   01             C      	DB	1
  5E08*   20 20 44 53    C      	DB	'  DS************   '
  5E0C*   2A 2A 2A 2A    C      
  5E10*   2A 2A 2A 2A    C      
  5E14*   2A 2A 2A 2A    C      
  5E18*   20 20 20       C      
  5E1B*   01             C      	DB	1
  5E1C*   00             C      	DB	0
  5E1D*   00             C      	DB	0
  5E1E*   00             C      	DB	0
  5E1F*   00             C      	DB	0
  5E20*   00             C      	DB	0
  5E21*   00             C      	DB	0
  5E22*   00             C      	DB	0
  5E23*   00             C      	DB	0
                         C      ;----------------------------------------------------------------------
  5E24*                  C      UA.KNAME:
  5E24*   06             C      	DB	06H
  5E25*   10             C      	DB	16
  5E26*   40             C      	DB	40H
  5E27*   20 4B 61 73    C      	DB	' KassettenName: '
  5E2B*   73 65 74 74    C      
  5E2F*   65 6E 4E 61    C      
  5E33*   6D 65 3A 20    C      
  5E37*                  C      UA.NR:
  5E37*   03             C      	DB	03H
  5E38*   10             C      	DB	16
  5E39*   40             C      	DB	40H
  5E3A*   20 4B 61 73    C      	DB	' Kassetten-Nr.: '
  5E3E*   73 65 74 74    C      
  5E42*   65 6E 2D 4E    C      
  5E46*   72 2E 3A 20    C      
  5E4A*                  C      UA.KOMMT:
  5E4A*   0B             C      	DB	0BH
  5E4B*   10             C      	DB	16
  5E4C*   80             C      	DB	80H
  5E4D*   20 20 20 20    C      	DB	'     Kommentar: '
  5E51*   20 4B 6F 6D    C      
  5E55*   6D 65 6E 74    C      
  5E59*   61 72 3A 20    C      
                         C      ;----------------------------------------------------------------------
  5E5D*                  C      UA.Z7E:
  5E5D*   45 69 6E 67    C      	DB	'Eingabe      =====>     Ausgabe'
  5E61*   61 62 65 20    C      
  5E65*   20 20 20 20    C      
  5E69*   20 3D 3D 3D    C      
  5E6D*   3D 3D 3E 20    C      
  5E71*   20 20 20 20    C      
  5E75*   41 75 73 67    C      
  5E79*   61 62 65       C      
  5E7C*                  C      UA.GER:
  5E7C*   20 20 20 20    C      	DB	'       Geraet: '
  5E80*   20 20 20 47    C      
  5E84*   65 72 61 65    C      
  5E88*   74 3A 20       C      
                         C      ;----------------------------------------------------------------------
  5E8B*                  C      UA.KOPFR:
  5E8B*   01             C      	DB	01H
  5E8C*   33             C      	DB	51
  5E8D*   80             C      	DB	80H
  5E8E*   20 20 20 20    C      	DB	'                Datei               kopieren J/N ? '
  5E92*   20 20 20 20    C      
  5E96*   20 20 20 20    C      
  5E9A*   20 20 20 20    C      
  5E9E*   44 61 74 65    C      
  5EA2*   69 20 20 20    C      
  5EA6*   20 20 20 20    C      
  5EAA*   20 20 20 20    C      
  5EAE*   20 20 20 20    C      
  5EB2*   6B 6F 70 69    C      
  5EB6*   65 72 65 6E    C      
'Ausschriften'	MACRO-80 3.44	09-Dec-81	PAGE	1-39


  5EBA*   20 4A 2F 4E    C      
  5EBE*   20 3F 20       C      
  5EC1*                  C      UA.EABFR:
  5EC1*   01             C      	DB	01H
  5EC2*   33             C      	DB	51
  5EC3*   80             C      	DB	80H
  5EC4*   20 20 20 20    C      	DB	'                Eingaben in Ordnung  ---->   J/N ? '
  5EC8*   20 20 20 20    C      
  5ECC*   20 20 20 20    C      
  5ED0*   20 20 20 20    C      
  5ED4*   45 69 6E 67    C      
  5ED8*   61 62 65 6E    C      
  5EDC*   20 69 6E 20    C      
  5EE0*   4F 72 64 6E    C      
  5EE4*   75 6E 67 20    C      
  5EE8*   20 2D 2D 2D    C      
  5EEC*   2D 3E 20 20    C      
  5EF0*   20 4A 2F 4E    C      
  5EF4*   20 3F 20       C      
  5EF7*                  C      UA.VORH:
  5EF7*   01             C      	DB	1
  5EF8*   33             C      	DB	51
  5EF9*   80             C      	DB	80H
  5EFA*   2A 2A 2A 2A    C      	DB	'************* Datei vorh.;SYS-Ende,kopieren  J/N ? '
  5EFE*   2A 2A 2A 2A    C      
  5F02*   2A 2A 2A 2A    C      
  5F06*   2A 20 44 61    C      
  5F0A*   74 65 69 20    C      
  5F0E*   76 6F 72 68    C      
  5F12*   2E 3B 53 59    C      
  5F16*   53 2D 45 6E    C      
  5F1A*   64 65 2C 6B    C      
  5F1E*   6F 70 69 65    C      
  5F22*   72 65 6E 20    C      
  5F26*   20 4A 2F 4E    C      
  5F2A*   20 3F 20       C      
                         C      ;----------------------------------------------------------------------
  5F2D*                  C      UA.FRZ:
  5F2D*   02             C      	DB	2
  5F2E*   03             C      	DB	3
  5F2F*   80             C      	DB	80H
  5F30*   3F 3F 20       C      	DB	'?? '
  5F33*                  C      UA.BMGF:
  5F33*   01             C      	DB	01H
  5F34*   07             C      	DB	7
  5F35*   80             C      	DB	80H
  5F36*   42 4D 20 21    C      	DB	'BM ! ??'
  5F3A*   20 3F 3F       C      
  5F3D*                  C      UA.DOK:
  5F3D*   00             C      	DB	0
  5F3E*   04             C      	DB	4
  5F3F*   80             C      	DB	80H
  5F40*   69 2E 4F 2E    C      	DB	'i.O.'
  5F44*                  C      UA.DF:
  5F44*   00             C      	DB	0
  5F45*   04             C      	DB	4
  5F46*   80             C      	DB	80H
  5F47*   46 68 6C 2E    C      	DB	'Fhl.'
                         C      ;----------------------------------------------------------------------
  5F4B*                  C      UA.ZKDAT:
  5F4B*   06             C      	DB	6
  5F4C*   10             C      	DB	16
  5F4D*   40             C      	DB	40H
  5F4E*   20 20 20 20    C      	DB	'     Dateiname: '
  5F52*   20 44 61 74    C      
  5F56*   65 69 6E 61    C      
  5F5A*   6D 65 3A 20    C      
  5F5E*                  C      UA.ZKLAD:
  5F5E*   04             C      	DB	4
  5F5F*   10             C      	DB	16
  5F60*   08             C      	DB	08H
  5F61*   20 20 20 4C    C      	DB	'   Ladeadresse: '
  5F65*   61 64 65 61    C      
  5F69*   64 72 65 73    C      
  5F6D*   73 65 3A 20    C      
                         C      ;------------------------------------------------------------------
  5F71*                  C      UA.ZKBEG:
  5F71*   04             C      	DB	4
  5F72*   10             C      	DB	16
  5F73*   08             C      	DB	08H
  5F74*   20 20 20 20    C      	DB	'        Beginn: '
  5F78*   20 20 20 20    C      
  5F7C*   42 65 67 69    C      
'Ausschriften'	MACRO-80 3.44	09-Dec-81	PAGE	1-40


  5F80*   6E 6E 3A 20    C      
  5F84*                  C      UA.ZKEND:
  5F84*   04             C      	DB	4
  5F85*   10             C      	DB	16
  5F86*   08             C      	DB	08H
  5F87*   20 20 20 20    C      	DB	'          Ende: '
  5F8B*   20 20 20 20    C      
  5F8F*   20 20 45 6E    C      
  5F93*   64 65 3A 20    C      
  5F97*                  C      UA.STADR:
  5F97*   04             C      	DB	4
  5F98*   10             C      	DB	16
  5F99*   08             C      	DB	08H
  5F9A*   20 20 53 74    C      	DB	'  Startadresse: '
  5F9E*   61 72 74 61    C      
  5FA2*   64 72 65 73    C      
  5FA6*   73 65 3A 20    C      
  5FAA*                  C      UA.ZKDL:
  5FAA*   01             C      	DB	1
  5FAB*   10             C      	DB	16
  5FAC*   20             C      	DB	20H
  5FAD*   20 4C 6F 65    C      	DB	' Loeschen J/N : '
  5FB1*   73 63 68 65    C      
  5FB5*   6E 20 4A 2F    C      
  5FB9*   4E 20 3A 20    C      
  5FBD*                  C      UA.ZKF:
  5FBD*   00             C      	DB	0
  5FBE*   08             C      	DB	8
  5FBF*   00             C      	DB	0
  5FC0*   46 65 68 6C    C      	DB	'Fehler: '
  5FC4*   65 72 3A 20    C      
                         C      ;----------------------------------------------------------------------
  5FC8*                  C      UA.ZKRES:
  5FC8*   03             C      	DB	3
  5FC9*   10             C      	DB	16
  5FCA*   10             C      	DB	10H
  5FCB*   52 65 73 65    C      	DB	'Reservebloecke: '
  5FCF*   72 76 65 62    C      
  5FD3*   6C 6F 65 63    C      
  5FD7*   6B 65 3A 20    C      
  5FDB*                  C      UA.ZKSDT:
  5FDB*   04             C      	DB	4
  5FDC*   12             C      	DB	18
  5FDD*   40             C      	DB	40H
  5FDE*   20 20 20 20    C      	DB	'     Dateiname:   '
  5FE2*   20 44 61 74    C      
  5FE6*   65 69 6E 61    C      
  5FEA*   6D 65 3A 20    C      
  5FEE*   20 20          C      
  5FF0*                  C      UA.ZKBEL:
  5FF0*   00             C      	DB	0
  5FF1*   10             C      	DB	16
  5FF2*   00             C      	DB	0
  5FF3*   42 6C 6F 65    C      	DB	'Bloecke belegt: '
  5FF7*   63 6B 65 20    C      
  5FFB*   62 65 6C 65    C      
  5FFF*   67 74 3A 20    C      
  6003*                  C      UA.ZKBLG:
  6003*   00             C      	DB	0
  6004*   10             C      	DB	16
  6005*   00             C      	DB	0
  6006*   42 6C 6F 65    C      	DB	'Bloecke gesamt: '
  600A*   63 6B 65 20    C      
  600E*   67 65 73 61    C      
  6012*   6D 74 3A 20    C      
                         C      ;----------------------------------------------------------------------
  6016*                  C      UA.ZKBA:
  6016*   42 61 6E 64    C      	DB	'Bandanfang'
  601A*   61 6E 66 61    C      
  601E*   6E 67          C      
  6020*                  C      UA.ZKBM:
  6020*   42 61 6E 64    C      	DB	'Bandmarke'
  6024*   6D 61 72 6B    C      
  6028*   65             C      
  6029*                  C      UA.ZKSL:
  6029*   53 63 68 6C    C      	DB	'Schlussluecke'
  602D*   75 73 73 6C    C      
  6031*   75 65 63 6B    C      
  6035*   65             C      
  6036*                  C      UA.ZKEE:
                         C      ;----------------------------------------------------------------------
  6036*                  C      UA.LD:
  6036*   26             C      	DB	38
'Ausschriften'	MACRO-80 3.44	09-Dec-81	PAGE	1-41


  6037*   0F             C      	DB	15
  6038*   80             C      	DB	80H
  6039*   20 20 20 20    C      	DB	'               '
  603D*   20 20 20 20    C      
  6041*   20 20 20 20    C      
  6045*   20 20 20       C      
  6048*                  C      UA.ZRSCH:
  6048*   01             C      	DB	1
  6049*   16             C      	DB	22
  604A*   80             C      	DB	80H
  604B*   56 65 72 7A    C      	DB	'Verz. schreiben J/N ? '
  604F*   2E 20 73 63    C      
  6053*   68 72 65 69    C      
  6057*   62 65 6E 20    C      
  605B*   4A 2F 4E 20    C      
  605F*   3F 20          C      
  6061*                  C      UA.ANZWD:
  6061*   01             C      	DB	1
  6062*   16             C      	DB	22
  6063*   80             C      	DB	80H
  6064*   41 6E 7A 65    C      	DB	'Anzeige wdhln.  J/N ? '
  6068*   69 67 65 20    C      
  606C*   77 64 68 6C    C      
  6070*   6E 2E 20 20    C      
  6074*   4A 2F 4E 20    C      
  6078*   3F 20          C      
                         C      ;----------------------------------------------------------------------
  607A*                  C      UA.ALTR:
  607A*   20 41 55 53    C      	DB	' AUSGLEICH LAUFWERKSTOLERANZEN  '
  607E*   47 4C 45 49    C      
  6082*   43 48 20 4C    C      
  6086*   41 55 46 57    C      
  608A*   45 52 4B 53    C      
  608E*   54 4F 4C 45    C      
  6092*   52 41 4E 5A    C      
  6096*   45 4E 20 20    C      
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                         C      	TITLE 'Routinen fuer Kassette'
                         C      	PAGE
'Routinen fuer Kassette'	MACRO-80 3.44	09-Dec-81	PAGE	1-42


                         C      
                         C      ;----------------------------------------------------------------------
                         C      ;   Routinen fuer KASSETTE
                         C      ;----------------------------------------------------------------------
  609A*                  C      UR.KRE:
  609A*   DD 36 04 31    C      	LD	(IX+4),31H
  609E*                  C      UR.KRE1:
  609E*   CD 5D2A*       C      	CALL	UF.EXEC
  60A1*   C9             C      	RET
  60A2*                  C      UR.KRW:
  60A2*   DD 36 04 21    C      	LD	(IX+4),21H
  60A6*   18 F6          C      	JR	UR.KRE1	;Umspulen
  60A8*                  C      UR.KRWW:
  60A8*   CD 60A2*       C      	CALL	UR.KRW
  60AB*   C9             C      	RET
  60AC*                  C      UR.KRA:
  60AC*   DD 36 04 41    C      	LD	(IX+4),41H
  60B0*   18 EC          C      	JR	UR.KRE1	;Reservieren aus
  60B2*                  C      UR.KLV:
  60B2*   DD 36 04 71    C      	LD	(IX+4),71H
  60B6*   18 E6          C      	JR	UR.KRE1	;Label vorsetzen
  60B8*                  C      UR.KLR:
  60B8*   DD 36 04 75    C      	LD	(IX+4),75H
  60BC*   18 E0          C      	JR	UR.KRE1	;LABEL RUECKSETZEN
  60BE*                  C      UR.KBM:
  60BE*   DD 36 04 51    C      	LD	(IX+4),51H
  60C2*   18 DA          C      	JR	UR.KRE1	;BANDMARKE SCHREIBEN
  60C4*                  C      UR.KSL:
  60C4*   DD 36 04 61    C      	LD	(IX+4),61H
  60C8*   18 D4          C      	JR	UR.KRE1	;SCHLUSSLUECKE SCHREIBEN
  60CA*                  C      UR.KBV:
  60CA*   DD 36 04 11    C      	LD	(IX+4),11H
  60CE*   18 CE          C      	JR	UR.KRE1	;Block vorsetzen
  60D0*                  C      UR.KBR:
  60D0*   DD 36 04 15    C      	LD	(IX+4),15H
  60D4*   18 C8          C      	JR	UR.KRE1
                         C      ;--------------------------------------------------------------------
  60D6*                  C      UR.RPOS:
  60D6*   E5             C      	PUSH	HL
  60D7*   D5             C      	PUSH	DE
  60D8*   F5             C      	PUSH	AF
  60D9*   C5             C      	PUSH	BC
  60DA*   AF             C      	XOR	A
  60DB*   3D             C      	DEC	A
  60DC*   4F             C      	LD	C,A
  60DD*   18 06          C      	JR	POSIK1
  60DF*                  C      UR.POSIK:
  60DF*   E5             C      	PUSH	HL
  60E0*   D5             C      	PUSH	DE
  60E1*   F5             C      	PUSH	AF
  60E2*   C5             C      	PUSH	BC	;Positionieren
  60E3*   AF             C      	XOR	A
  60E4*   4F             C      	LD	C,A
  60E5*                  C      POSIK1:
  60E5*   06 00          C      	LD	B,0
  60E7*   11 0000        C      	LD	DE,0
  60EA*                  C      UR.LES:
  60EA*   DD 36 04 02    C      	LD	(IX+4),02H
  60EE*   CD 5D2A*       C      	CALL	UF.EXEC	;BLOCK LESEN
  60F1*   DD 7E 0A       C      	LD	A,(IX+10)
  60F4*   FE 01          C      	CP	1	;BANDMARKE?
  60F6*   28 19          C      	JR	Z,UR.BM
  60F8*   04             C      	INC	B	;ANZAHL BLOECKE
  60F9*   78             C      	LD	A,B
  60FA*   FE 04          C      	CP	4
  60FC*   28 21          C      	JR	Z,UR.OK
  60FE*   21 0000        C      	LD	HL,0
  6101*   CD 5611*       C      	CALL	XY.LIDX
  6104*   09             C      	DB	9	;HL<--BLOCKLAENGE
  6105*   19             C      	ADD	HL,DE
  6106*   EB             C      	EX	DE,HL
  6107*   21 012C        C      	LD	HL,300
  610A*   B7             C      	OR	A
  610B*   ED 52          C      	SBC	HL,DE
  610D*   38 10          C      	JR	C,UR.OK
  610F*   18 D9          C      	JR	UR.LES
  6111*                  C      UR.BM:
  6111*   AF             C      	XOR	A
  6112*   B1             C      	OR	C
  6113*   28 04          C      	JR	Z,$+6
  6115*   C1             C      	POP	BC
  6116*   04             C      	INC	B
'Routinen fuer Kassette'	MACRO-80 3.44	09-Dec-81	PAGE	1-43


  6117*   18 C9          C      	JR	UR.POSIK+3
  6119*   C1             C      	POP	BC
  611A*   05             C      	DEC	B
  611B*   28 21          C      	JR	Z,UR.RSP
  611D*   18 C3          C      	JR	UR.POSIK+3
  611F*                  C      UR.OK:
  611F*   AF             C      	XOR	A
  6120*   B1             C      	OR	C
  6121*   28 08          C      	JR	Z,$+10
  6123*   DD 70 0A       C      	LD	(IX+10),B
  6126*   CD 60B8*       C      	CALL	UR.KLR
  6129*   18 13          C      	JR	UR.RSP
  612B*   DD 36 04 15    C      	LD	(IX+4),15H
  612F*   CD 5D2A*       C      	CALL	UF.EXEC
  6132*   10 F7          C      	DJNZ	$-7
  6134*   C1             C      	POP	BC
  6135*   05             C      	DEC	B
  6136*   28 06          C      	JR	Z,UR.RSP
  6138*   DD 70 0A       C      	LD	(IX+10),B
  613B*   CD 60B2*       C      	CALL	UR.KLV
  613E*                  C      UR.RSP:
  613E*   F1             C      	POP	AF
  613F*   D1             C      	POP	DE
  6140*   E1             C      	POP	HL
  6141*   C9             C      	RET
                         C      	TITLE	'Einzelzeicheneingabe fuer KMBG'
                         C      	PAGE
'Einzelzeicheneingabe fuer KMBG'	MACRO-80 3.44	09-Dec-81	PAGE	1-44


                         C      
                         C      ;	PN	UK
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;        Einzelzeicheneingabe fuer KMBG
                         C      ;
                         C      ;----------------------------------------------------------------------
  6142*                  C      UK.GETK:
  6142*   CD 5400*       C      	CALL	U1.RSAVE
  6145*   CD 5611*       C      	CALL	XY.LIDX	;HL:= Blocklaenge
  6148*   09             C      	DB	9
  6149*   E5             C      	PUSH	HL
  614A*   CD 5601*       C      	CALL	XY.LDDX
  614D*   17             C      	DB	23
  614E*   EB             C      	EX	DE,HL	;DE:= Pufferzaehler
  614F*   AF             C      	XOR	A
  6150*   E1             C      	POP	HL	;HL:= Blocklaenge
  6151*   ED 52          C      	SBC	HL,DE
  6153*   E5             C      	PUSH	HL	;Restbyteanzahl retten
  6154*   7C             C      	LD	A,H
  6155*   B5             C      	OR	L
  6156*   CC 61A2*       C      	CALL	Z,UK.KBW	;Block lesen
  6159*   E1             C      	POP	HL
  615A*   AF             C      	XOR	A
  615B*   BC             C      	CP	H
  615C*   20 05          C      	JR	NZ,UK.GETK2
  615E*   7D             C      	LD	A,L
  615F*   FE 01          C      	CP	1
  6161*   28 08          C      	JR	Z,UK.GETK3	;---> letztes Datenbyte des
  6163*                  C      UK.GETK2:
  6163*   CD 6171*       C      	CALL	UK.GETK4
  6166*   B7             C      	OR	A
  6167*                  C      UK.GETK5:
  6167*   CD 5408*       C      	CALL	U1.RRST
  616A*   C9             C      	RET
                         C      ;
                         C      ;
  616B*                  C      UK.GETK3:
  616B*   CD 6171*       C      	CALL	UK.GETK4
  616E*   37             C      	SCF
  616F*   18 F6          C      	JR	UK.GETK5
                         C      ;
  6171*                  C      UK.GETK4:
  6171*   CD 5601*       C      	CALL	XY.LDDX	;HL:= aktuelle Pufferadresse
  6174*   15             C      	DB	21
  6175*   7E             C      	LD	A,(HL)	;Datenbyte laden
  6176*   CD 5641*       C      	CALL	XY.INCDX	;Pufferzeiger erhoehen
  6179*   15             C      	DB	21
  617A*   CD 5641*       C      	CALL	XY.INCDX	;Pufferzaehler erhoehen
  617D*   17             C      	DB	23
  617E*   C9             C      	RET
                         C      
                         C      ;******************************************************************
                         C      ;
                         C      ;        KMBG  Eingabepuffer bereitstellen
                         C      ;
                         C      ;*******************************************************************
  617F*                  C      UK.KLPFB:
  617F*   CD 5400*       C      	CALL	U1.RSAVE
  6182*   CD 54FB*       C      	CALL	U1.KTIN1
  6185*   21 0080        C      	LD	HL,MaxBL     ;max. Blocklaenge Kassette (100H)
  6188*   CD 5631*       C      	CALL	XY.STIDX     ;max. Blocklaenge initialisieren
  618B*   09             C      	DB	9
  618C*   E5             C      	PUSH	HL
  618D*   C1             C      	POP	BC           ;BC:= Blocklaenge
  618E*   CD 5621*       C      	CALL	XY.STDX      ;Pufferzaehler "Leer"
  6191*   17             C      	DB	23
  6192*   21 0E65        C      	LD	HL,UE.PUF    ;Systempuffer Kassette
  6195*   CD 5411*       C      	CALL	U1.CLRB      ;Systempuffer loeschen
  6198*   21 8010        C      	LD	HL,UE.KPUFF
  619B*   CD 5411*       C      	CALL	U1.CLRB
  619E*   CD 5408*       C      	CALL	U1.RRST
  61A1*   C9             C      	RET
                         C      
                         C      ;******************************************************************
                         C      ;
                         C      ;        Einlesen eines Blockes von Kassette
                         C      ;
                         C      ;         - Besonderheit gegenueber MBW: Blockinhalt wird vom
                         C      ;           Systempuffer in den E/A-Puffer uebertragen
                         C      ;
                         C      ;*******************************************************************
'Einzelzeicheneingabe fuer KMBG'	MACRO-80 3.44	09-Dec-81	PAGE	1-45


  61A2*                  C      UK.KBW:
  61A2*   CD 5400*       C      	CALL	U1.RSAVE
  61A5*   CD 617F*       C      	CALL	UK.KLPFB
  61A8*   DD 36 04 02    C      	LD	(IX+4),02H
  61AC*   CD 5D2A*       C      	CALL	UF.EXEC
                         C      	;LD	A,(IX+9)
                         C      	;OR	(IX+10)
  61AF*   DD 7E 0A       C      	LD	A,(IX+10)	;Laenge = 1, dann BM
  61B2*   FE 01          C      	CP	1
  61B4*   28 2A          C      	JR	Z,UK.KBW1	;EOF
  61B6*   CD 5601*       C      	CALL	XY.LDDX	;HL:= Blockadresse
  61B9*   07             C      	DB	7
  61BA*   DD 46 09       C      	LD	B,(IX+9)	;BC:= Blocklaenge
  61BD*   DD 4E 0A       C      	LD	C,(IX+10)
  61C0*   E5             C      	PUSH	HL	;E/A-Puffer
  61C1*   CD 5601*       C      	CALL	XY.LDDX
  61C4*   19             C      	DB	25
  61C5*   EB             C      	EX	DE,HL
  61C6*   E1             C      	POP	HL
  61C7*   ED B0          C      	LDIR		;Transport in E/A-Puffer
  61C9*   CD 5601*       C      	CALL	XY.LDDX
  61CC*   19             C      	DB	25
  61CD*   CD 5621*       C      	CALL	XY.STDX	;Pufferzeiger auf Anfang
  61D0*   15             C      	DB	21
  61D1*   21 0000        C      	LD	HL,0
  61D4*   CD 5621*       C      	CALL	XY.STDX	;Pufferzaehler rueckstellen
  61D7*   17             C      	DB	23
  61D8*   CD 5641*       C      	CALL	XY.INCDX	;Blockzaehler incrementieren
  61DB*   11             C      	DB	17
  61DC*                  C      UK.KBW2:
  61DC*   CD 5408*       C      	CALL	U1.RRST
  61DF*   C9             C      	RET
                         C      ;
  61E0*                  C      UK.KBW1:
  61E0*   CD 5641*       C      	CALL	XY.INCDX	;Labelzaehler incrementieren
  61E3*   11             C      	DB	17
  61E4*   18 F6          C      	JR	UK.KBW2
                         C      
                         C      ;********************************************************************
                         C      ;
                         C      ;        Einzelzeichenausgabe fuer KMBG
                         C      ;
                         C      ;*********************************************************************
  61E6*                  C      UK.PUTK:
  61E6*   CD 5400*       C      	CALL	U1.RSAVE
  61E9*   F5             C      	PUSH	AF	;Zeichen retten
  61EA*   CD 5601*       C      	CALL	XY.LDDX	;HL:= Pufferzaehler
  61ED*   17             C      	DB	23
  61EE*   01 0132        C      	LD	BC,UE.KMPUL	;BC:= max. Pufferlaenge
  61F1*   B7             C      	OR	A
  61F2*   ED 42          C      	SBC	HL,BC
  61F4*   3F             C      	CCF
  61F5*   CC 622F*       C      	CALL	Z,UK.KBA	;---> Puffer voll
  61F8*   F1             C      	POP	AF	;Zeichen auskellern
  61F9*   CD 5601*       C      	CALL	XY.LDDX
  61FC*   15             C      	DB	21
  61FD*   77             C      	LD	(HL),A	;Zeichen in Puffer eintragen
  61FE*   CD 5641*       C      	CALL	XY.INCDX	;Pufferzeiger erhoehen
  6201*   15             C      	DB	21
  6202*   CD 5641*       C      	CALL	XY.INCDX	;Pufferzaehler erhoehen
  6205*   17             C      	DB	23
  6206*   CD 5408*       C      	CALL	U1.RRST
  6209*   C9             C      	RET
                         C      
                         C      ;******************************************************************
                         C      ;
                         C      ;        Ausgabepufferbereitstellung fuer KMBG
                         C      ;
                         C      ;*******************************************************************
  620A*                  C      UK.KSPFB:
  620A*   CD 5400*       C      	CALL	U1.RSAVE
  620D*   CD 54FB*       C      	CALL	U1.KTIN1
  6210*   CD 5611*       C      	CALL	XY.LIDX
  6213*   09             C      	DB	9
  6214*   E5             C      	PUSH	HL
  6215*   C1             C      	POP	BC	;BC:= Blocklaenge
  6216*   21 0000        C      	LD	HL,0
  6219*   CD 5621*       C      	CALL	XY.STDX	;Pufferzaehler = 0
  621C*   17             C      	DB	23
  621D*   CD 5601*       C      	CALL	XY.LDDX
  6220*   19             C      	DB	25
  6221*   CD 5621*       C      	CALL	XY.STDX	;Pufferzeiger setzen
  6224*   15             C      	DB	21
'Einzelzeicheneingabe fuer KMBG'	MACRO-80 3.44	09-Dec-81	PAGE	1-46


  6225*   21 0E65        C      	LD	HL,UE.PUF
  6228*   CD 5411*       C      	CALL	U1.CLRB
  622B*   CD 5408*       C      	CALL	U1.RRST
  622E*   C9             C      	RET
                         C      
                         C      ;*******************************************************************
                         C      ;
                         C      ;        Ausgabe eines Blockes auf KMBG
                         C      ;
                         C      ;*******************************************************************
  622F*                  C      UK.KBA:
  622F*   CD 5400*       C      	CALL	U1.RSAVE
  6232*   CD 620A*       C      	CALL	UK.KSPFB
  6235*   CD 5601*       C      	CALL	XY.LDDX
  6238*   07             C      	DB	7
  6239*   EB             C      	EX	DE,HL	;DE:= Blockadresse
  623A*   D5             C      	PUSH	DE	;Blockadresse retten
  623B*   CD 5611*       C      	CALL	XY.LIDX
  623E*   09             C      	DB	9
  623F*   E5             C      	PUSH	HL
  6240*   C1             C      	POP	BC	;BC:= Blocklaenge
  6241*   D1             C      	POP	DE	;DE:= Blockadresse
  6242*   C5             C      	PUSH	BC	;Blocklaenge retten
  6243*   CD 5601*       C      	CALL	XY.LDDX	;HL:= E/A-Pufferanfang
  6246*   19             C      	DB	25
  6247*   ED B0          C      	LDIR		;Block in Systempuffer
  6249*   C1             C      	POP	BC	;BC:= Blocklaenge
  624A*   E5             C      	PUSH	HL	;aktuelle Pufferadresse retten
  624B*   21 0132        C      	LD	HL,UE.KMPUL	;HL:= max. Laenge
  624E*   B7             C      	OR	A
  624F*   ED 42          C      	SBC	HL,BC	;HL:= Restbyteanzahl
  6251*   CD 5621*       C      	CALL	XY.STDX	;Pufferzaehler setzen
  6254*   17             C      	DB	23
  6255*   E5             C      	PUSH	HL
  6256*   C1             C      	POP	BC	;BC:= Restbyteanzahl
  6257*   CD 5601*       C      	CALL	XY.LDDX	;HL:= aktuelle Pufferadresse
  625A*   19             C      	DB	25
  625B*   EB             C      	EX	DE,HL	;DE:= Pufferanfang
  625C*   E1             C      	POP	HL
  625D*   ED B0          C      	LDIR
  625F*   EB             C      	EX	DE,HL	;HL:= aktuelle Pufferadresse
  6260*   CD 5621*       C      	CALL	XY.STDX	;Pufferzeiger setzen
  6263*   15             C      	DB	21
  6264*   DD 36 04 08    C      	LD	(IX+4),08H
  6268*   CD 5D2A*       C      	CALL	UF.EXEC	;physische Blockausgabe
  626B*   F5             C      	PUSH	AF
  626C*   CD 5641*       C      	CALL	XY.INCDX	;Blockzaehler erhoehen
  626F*   11             C      	DB	17
  6270*   F1             C      	POP	AF
  6271*   CD 5408*       C      	CALL	U1.RRST
  6274*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                                ;
                                ;	INCLUDE	KI.MAC	;Initialisieren von MRES Kassetten
                                ;	INCLUDE	KV.MAC	;Anzeigen und Aendern des MRES-Verzeichnisses
                                ;	INCLUDE	KH.MAC	;Kommandos: KRDx und KWRx
                                ;	INCLUDE	FD.MAC	;Ein-/Ausgabe im freien Format
                                ;	INCLUDE LD.MAC	;Laden von MRES-P-Dateien
                                ;	INCLUDE RL.MAC	;Relativloader fuer O-Dateien
                                ;	INCLUDE SV.MAC	;Retten von Maschinencodeprogrammen als MRES - P-Datei
                         C      	INCLUDE K3.MAC	;MRES Routinen
                         C      	TITLE	'Initialisieren von MRES Kassetten'
                         C      	PAGE
'Initialisieren von MRES Kassetten'	MACRO-80 3.44	09-Dec-81	PAGE	1-47


                         C      
                         C      ;	PN	KI
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;      INITIALISIEREN VON MRES KASSETTEN
                         C      ;
                         C      ;----------------------------------------------------------------------
  6275*   6275*          C      	DW	$
  6277*   49 4E 49 54    C      	DB	'INIT'
  627B*   21 4070        C      	LD	HL,PUF.KASS	;Puffer fuer Umbenennung Kassette loeschen
  627E*   11 4071        C      	LD	DE,PUF.KASS+1
  6281*   01 000F        C      	LD	BC,15
  6284*   36 20          C      	LD	(HL),020H
  6286*   ED B0          C      	LDIR
  6288*   3A 3327        C      	LD	A,(UE.BWSA + 10*80 +7)	;327H
  628B*   CD 55C5*       C      	CALL	U1.TST
  628E*   D8             C      	RET	C
  628F*   F5             C      	PUSH	AF
  6290*   CD 54E2*       C      	CALL	U1.KTINI
  6293*   F1             C      	POP	AF
  6294*   DD 77 03       C      	LD	(IX+3),A	;GERAETEADR. -->TAB
  6297*   CD 609A*       C      	CALL	UR.KRE	;RES. EIN
  629A*   DD CB 00 56    C      	BIT	2,(IX+0)
  629E*   28 05          C      	JR	Z,$+7
  62A0*   3E 19          C      	LD	A,19H
  62A2*   CD 5D5A*       C      	CALL	UF.ERANZ
  62A5*   CD 60A8*       C      	CALL	UR.KRWW	;RUECKSPULEN MIT WARTEN
  62A8*   CD 60BE*       C      	CALL	UR.KBM	;BM SCHREIBEN
  62AB*   21 0E65        C      	LD	HL,UE.PUF	;AUFBAU 1.BLOCK
  62AE*   3E 40          C      	LD	A,40H
  62B0*   06 50          C      	LD	B,80
  62B2*   CD 55A6*       C      	CALL	U1.TR
  62B5*   3E 00          C      	LD	A,00H
  62B7*   06 30          C      	LD	B,48
  62B9*   CD 55A6*       C      	CALL	U1.TR
  62BC*   DD 36 0A 80    C      	LD	(IX+10),80H	;Blocklaenge
  62C0*   DD 36 04 08    C      	LD	(IX+4),08H	;CMD SCHREIBEN
  62C4*   CD 5D2A*       C      	CALL	UF.EXEC
  62C7*   CD 6370*       C      	CALL	KI.KO03
  62CA*                  C      KI.KN:
  62CA*   CD 55B1*       C      	CALL	U1.BILO
  62CD*   3E 0D          C      	LD	A,13
  62CF*   32 2B00*       C      	LD	(UB.ZN),A	;ZEILENNR. 15
  62D2*   21 5E24*       C      	LD	HL,UA.KNAME	;ABFRAGE KASS.NAME
  62D5*   CD 595C*       C      	CALL	UR.MIMO
  62D8*   D8             C      	RET	C
                         C      ;---\
  62D9*   E5             C      	PUSH	HL
  62DA*   C5             C      	PUSH	BC
  62DB*   11 4070        C      	LD	DE,PUF.KASS
  62DE*   01 0006        C      	LD	BC,6
  62E1*   ED B0          C      	LDIR
  62E3*   C1             C      	POP	BC
  62E4*   E1             C      	POP	HL
                         C      ;---/
  62E5*   06 06          C      	LD	B,6
  62E7*   11 0E69        C      	LD	DE,UE.PUF+4	;NAME IN PUFFER
  62EA*   CD 57BA*       C      	CALL	UC.KONV	;MIT KONVERTIERUNG IN DKOI-CODE
  62ED*                  C      KI.NMR:
  62ED*   21 5E37*       C      	LD	HL,UA.NR	;ABFR. KASS.NUMMER
  62F0*   CD 595C*       C      	CALL	UR.MIMO
  62F3*   38 D5          C      	JR	C,KI.KN	;BEI SYS-TASTE ZU VORHERIGER
                         C      ;---\
  62F5*   E5             C      	PUSH	HL
  62F6*   C5             C      	PUSH	BC
  62F7*   11 4076        C      	LD	DE,PUF.KASS+6
  62FA*   01 0003        C      	LD	BC,3
  62FD*   ED B0          C      	LDIR
  62FF*   C1             C      	POP	BC
  6300*   E1             C      	POP	HL
                         C      ;---/
  6301*   06 03          C      	LD	B,3
  6303*   11 0E8A        C      	LD	DE,UE.PUF+37
  6306*   CD 57BA*       C      	CALL	UC.KONV
  6309*                  C      KI.KM:
  6309*   21 5E4A*       C      	LD	HL,UA.KOMMT	;ABFR. KOMMENTAR
  630C*   CD 595C*       C      	CALL	UR.MIMO
  630F*   38 B9          C      	JR	C,KI.KN
  6311*   06 0B          C      	LD	B,11
  6313*   11 0E8D        C      	LD	DE,UE.PUF+40
  6316*   CD 57BA*       C      	CALL	UC.KONV
  6319*   CD 5D2A*       C      	CALL	UF.EXEC	;3.BLOCK SCHREIBEN
'Initialisieren von MRES Kassetten'	MACRO-80 3.44	09-Dec-81	PAGE	1-48


  631C*   CD 637B*       C      	CALL	KI.RENA	;Kassette umbenennen
  631F*   CD 60BE*       C      	CALL	UR.KBM	;BM , 1.LABEL BEENDET
  6322*   21 607A*       C      	LD	HL,UA.ALTR
  6325*   11 0E65        C      	LD	DE,UE.PUF
  6328*   01 0020        C      	LD	BC,20H
  632B*   ED B0          C      	LDIR		;AUSGLEICH LFWSTLNZ->PUFFER
  632D*   DD 36 0A 20    C      	LD	(IX+10),20H	;NEUE BLOCKLAENGE
  6331*   DD 36 04 08    C      	LD	(IX+4),08H
  6335*   CD 5D2A*       C      	CALL	UF.EXEC	;SCHREIBEN
  6338*   21 5E04*       C      	LD	HL,UA.DS
  633B*   11 0E65        C      	LD	DE,UE.PUF
  633E*   01 0020        C      	LD	BC,32
  6341*   ED B0          C      	LDIR		;DS-SATZ --> PUFFER
  6343*   CD 5D2A*       C      	CALL	UF.EXEC
  6346*   3E A5          C      	LD	A,0A5H
  6348*   06 20          C      	LD	B,32
  634A*   21 0E65        C      	LD	HL,UE.PUF
  634D*   CD 55A6*       C      	CALL	U1.TR
  6350*   06 68          C      	LD	B,68H	;103 VERZ.SAETZE
  6352*                  C      KI.VERZ:
  6352*   C5             C      	PUSH	BC
  6353*   CD 5D2A*       C      	CALL	UF.EXEC
  6356*   C1             C      	POP	BC
  6357*   10 F9          C      	DJNZ	KI.VERZ
  6359*   CD 60BE*       C      	CALL	UR.KBM
  635C*   CD 547F*       C      	CALL	U1.VS1	;1.DATEIVORSATZ -->PUFFER
  635F*   DD 36 04 08    C      	LD	(IX+4),08H
  6363*   CD 5D2A*       C      	CALL	UF.EXEC
  6366*   CD 60C4*       C      	CALL	UR.KSL	;SCHLUSSLUECKE SCHREIBEN
  6369*   CD 60A2*       C      	CALL	UR.KRW
  636C*   CD 60AC*       C      	CALL	UR.KRA
  636F*   C9             C      	RET
                         C      ;
  6370*                  C      KI.KO03:
  6370*   CD 5D2A*       C      	CALL	UF.EXEC	;FUER KI14
  6373*   06 31          C      	LD	B,49
  6375*   2B             C      	DEC	HL
  6376*   10 FD          C      	DJNZ	$-1
  6378*   36 D9          C      	LD	(HL),0D9H
  637A*   C9             C      	RET
                         C      ;
  637B*                  C      KI.RENA:	;Kassettendateiname umbenennen
  637B*   E5             C      	PUSH	HL
  637C*   D5             C      	PUSH	DE
  637D*   C5             C      	PUSH	BC
  637E*   F5             C      	PUSH	AF
  637F*   21 407A        C      	LD	HL,PUF.KASS+10
  6382*   36 00          C      	LD	(HL),0          ;Abschluss neuer Name
  6384*   21 639A*       C      	LD	HL,KI.RENA9+2
  6387*   DD 7E 03       C      	LD	A,(IX+3)        ;SubAdresse
  638A*   77             C      	LD	(HL),A
  638B*   21 6398*       C      	LD	HL,KI.RENA9
  638E*   01 0730        C      	LD	BC,00700H + AKB ;AKB-Adresse + Laenge Parameterbereich
  6391*   ED B3          C      	OTIR
  6393*   F1             C      	POP	AF
  6394*   C1             C      	POP	BC
  6395*   D1             C      	POP	DE
  6396*   E1             C      	POP	HL
  6397*   C9             C      	RET
  6398*                  C      KI.RENA9:
  6398*   F0             C      	DB	0F0H
  6399*   44             C      	DB	044H            ;Kommando
  639A*   00             C      	DB	0               ;SubAdresse
  639B*   01             C      	DB	1               ;HSbereich
  639C*   40             C      	DB	HIGH(PUF.KASS)
  639D*   70             C      	DB	LOW(PUF.KASS)
  639E*   FF             C      	DB	0FFH
                         C      ;---------------------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Anzeigen und Aendern des MRES-Verzeichnisses'
                         C      	PAGE
'Anzeigen und Aendern des MRES-Verzeichnisses'	MACRO-80 3.44	09-Dec-81	PAGE	1-49


                         C      
                         C      ;	PN	KV
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;    ANZEIGEN UND AENDERN DES VERZEICHNISSES VON MRES KASSETTEN
                         C      ;
                         C      ;----------------------------------------------------------------------
  639F*   639F*          C      	DW	$
  63A1*   44 49 52 20    C      	DB	'DIR '
  63A5*   3A 3326        C      	LD	A,(UE.BWSA + 10*80 +6)	;326H
  63A8*   CD 55C5*       C      	CALL	U1.TST
  63AB*   D8             C      	RET	C
  63AC*   CD 54E2*       C      	CALL	U1.KTINI
  63AF*   DD 77 03       C      	LD	(IX+3),A
  63B2*   CD 55B1*       C      	CALL	U1.BILO
  63B5*   CD 609A*       C      	CALL	UR.KRE
  63B8*   CD 60A8*       C      	CALL	UR.KRWW
  63BB*   CD 5496*       C      	CALL	U1.DSVG
  63BE*   C5             C      	PUSH	BC
                         C      ;----------------------------------------------------------------------
  63BF*   CD 5420*       C      	CALL	U1.KBR4	;KASS.NAME,NR.,KOMMENTAR ANZEIGEN
  63C2*   DD 36 04 02    C      	LD	(IX+4),02H
  63C6*   CD 5D2A*       C      	CALL	UF.EXEC
  63C9*   21 0E69        C      	LD	HL,UE.PUF+4
  63CC*   11 3240        C      	LD	DE,UE.BWSA + 7*80 + 16	;3240H	;=8.ZEILE,16.SPALTE
  63CF*   06 06          C      	LD	B,6
  63D1*   CD 57B0*       C      	CALL	UC.DKONV
  63D4*   21 0E8A        C      	LD	HL,UE.PUF+37
  63D7*   13             C      	INC	DE
  63D8*   13             C      	INC	DE
  63D9*   06 03          C      	LD	B,3
  63DB*   CD 57B0*       C      	CALL	UC.DKONV
  63DE*   13             C      	INC	DE
  63DF*   13             C      	INC	DE
  63E0*   06 0B          C      	LD	B,11
  63E2*   CD 57B0*       C      	CALL	UC.DKONV
  63E5*   21 3290        C      	LD	HL,UE.BWSA + 8*80 + 16	;3290H
  63E8*   3E 3D          C      	LD	A,'='
  63EA*   77             C      	LD	(HL),A
  63EB*   E5             C      	PUSH	HL
  63EC*   D1             C      	POP	DE
  63ED*   13             C      	INC	DE
  63EE*   01 0017        C      	LD	BC,23
  63F1*   ED B0          C      	LDIR
                         C      ;----------------------------------------------------------------------
  63F3*   06 03          C      	LD	B,3	;POSITIONIEREN VOR DS-SATZ
  63F5*   CD 5D2A*       C      	CALL	UF.EXEC
  63F8*   10 FB          C      	DJNZ	$-3
  63FA*   CD 5518*       C      	CALL	U1.VERIN
  63FD*   CD 60A8*       C      	CALL	UR.KRWW
  6400*   06 07          C      	LD	B,7
  6402*   CD 5542*       C      	CALL	U1.VORS1
  6405*   C1             C      	POP	BC
  6406*   05             C      	DEC	B
  6407*   CD 6634*       C      	CALL	KV.ANZ
  640A*   04             C      	INC	B
  640B*   05             C      	DEC	B
  640C*   CA 6556*       C      	JP	Z,KV.KRW
  640F*   04             C      	INC	B
  6410*   C5             C      	PUSH	BC
                         C      ;----------------------------------------------------------------------
  6411*                  C      KV.ANF:
  6411*   05             C      	DEC	B
  6412*   78             C      	LD	A,B
  6413*   58             C      	LD	E,B
  6414*   D6 09          C      	SUB	9
  6416*   38 05          C      	JR	C,$+7
  6418*   0E 09          C      	LD	C,9
  641A*   41             C      	LD	B,C
  641B*   18 03          C      	JR	$+5
  641D*   43             C      	LD	B,E
  641E*   48             C      	LD	C,B
  641F*   AF             C      	XOR	A
  6420*   F5             C      	PUSH	AF	;A=RESTL.ANZAHL ODER 0
  6421*   C5             C      	PUSH	BC
  6422*   21 2B34*       C      	LD	HL,UB.SATZ
  6425*   36 00          C      	LD	(HL),00H
  6427*   23             C      	INC	HL
  6428*   36 37          C      	LD	(HL),55
  642A*   23             C      	INC	HL
  642B*   36 80          C      	LD	(HL),80H
  642D*   23             C      	INC	HL
'Anzeigen und Aendern des MRES-Verzeichnisses'	MACRO-80 3.44	09-Dec-81	PAGE	1-50


  642E*   06 37          C      	LD	B,55
  6430*   3E 20          C      	LD	A,20H
  6432*   CD 55A6*       C      	CALL	U1.TR	;AUSGABESATZ LOESCHEN
  6435*   3E 0D          C      	LD	A,13
  6437*   32 2B00*       C      	LD	(UB.ZN),A
  643A*   CD 55B1*       C      	CALL	U1.BILO
  643D*   11 2B46*       C      	LD	DE,UB.SATZ+18
  6440*   D5             C      	PUSH	DE
  6441*   21 ECA2        C      	LD	HL,BC.VTABE+32	;ADR. VERZ.TABELLE
  6444*   E5             C      	PUSH	HL
                         C      ;---------------------------MAX 9 SAETZE ANZEIGEN----------------------
  6445*                  C      KV.ZLTR:
  6445*   CD 65BC*       C      	CALL	KV.BSTR	;VTABE-->UB.SATZ
  6448*   D1             C      	POP	DE	;VERZ.ADR.
  6449*   E1             C      	POP	HL	;ADR.AUSGABESATZ
  644A*   E5             C      	PUSH	HL
  644B*   D5             C      	PUSH	DE
  644C*   01 0012        C      	LD	BC,18
  644F*   B7             C      	OR	A
  6450*   ED 42          C      	SBC	HL,BC
  6452*   CD 595C*       C      	CALL	UR.MIMO	;ANZEIGE EINE ZEILE
  6455*   E1             C      	POP	HL	;VERZ.ADR
  6456*   D1             C      	POP	DE
  6457*   01 0020        C      	LD	BC,32
  645A*   09             C      	ADD	HL,BC
  645B*   C1             C      	POP	BC
  645C*   05             C      	DEC	B
  645D*   28 05          C      	JR	Z,$+7
  645F*   C5             C      	PUSH	BC
  6460*   D5             C      	PUSH	DE
  6461*   E5             C      	PUSH	HL	;NEUE VERZ.TAB ADR
  6462*   18 E1          C      	JR	KV.ZLTR
                         C      ;----------------------------------------------------------------------
  6464*   41             C      	LD	B,C	;ANZAHL DER ANGEZEIGTEN ZEILEN
  6465*   3A 2B00*       C      	LD	A,(UB.ZN)
  6468*   90             C      	SUB	B
  6469*   32 2B00*       C      	LD	(UB.ZN),A	;KURSOR AUF ANFANG 12.ZEILE
  646C*   C5             C      	PUSH	BC
  646D*   D5             C      	PUSH	DE
  646E*   E5             C      	PUSH	HL
                         C      ;------------------------VERZ. ZEIGER AUF 1.ANGEZEIGTE EINTR.
  646F*   C5             C      	PUSH	BC
  6470*   01 0020        C      	LD	BC,32
  6473*   B7             C      	OR	A
  6474*   ED 42          C      	SBC	HL,BC
  6476*   C1             C      	POP	BC
  6477*   10 F6          C      	DJNZ	$-8
  6479*   E5             C      	PUSH	HL
                         C      ;----------------------------------------------------------------------
  647A*                  C      KV.TABTR:
  647A*   21 6036*       C      	LD	HL,UA.LD
  647D*   CD 595C*       C      	CALL	UR.MIMO	;KURSOR AUF ANF.12.ZEILE
  6480*   DA 64C0*       C      	JP	C,KV.ZEIHO
  6483*   D1             C      	POP	DE
  6484*   D5             C      	PUSH	DE	;ZIELADR.IN VTAB
  6485*   CD 65E9*       C      	CALL	KV.SPTR	;ZEILE WIEDER IN SPEICHER
  6488*   E1             C      	POP	HL	;ZIELADR.IN VTAB
  6489*   01 0020        C      	LD	BC,32
  648C*   09             C      	ADD	HL,BC
  648D*   FD E1          C      	POP	IY
  648F*   D1             C      	POP	DE
  6490*   C1             C      	POP	BC
  6491*   05             C      	DEC	B
  6492*   28 07          C      	JR	Z,$+9
  6494*   C5             C      	PUSH	BC
  6495*   D5             C      	PUSH	DE
  6496*   FD E5          C      	PUSH	IY
  6498*   E5             C      	PUSH	HL
  6499*   18 DF          C      	JR	KV.TABTR
                         C      ;--------------------WEITERBLAETTERN ODER AUSGABE----------------------
  649B*   F1             C      	POP	AF
  649C*   B7             C      	OR	A
  649D*   28 42          C      	JR	Z,KV.AUSG	;KEINE WEITEREN ANZEIGEN
  649F*   D6 09          C      	SUB	9
  64A1*   38 05          C      	JR	C,$+7
  64A3*   06 09          C      	LD	B,9
  64A5*   48             C      	LD	C,B
  64A6*   18 05          C      	JR	$+7
  64A8*   C6 09          C      	ADD	A,9
  64AA*   47             C      	LD	B,A
  64AB*   48             C      	LD	C,B
  64AC*   AF             C      	XOR	A
  64AD*   F5             C      	PUSH	AF
'Anzeigen und Aendern des MRES-Verzeichnisses'	MACRO-80 3.44	09-Dec-81	PAGE	1-51


  64AE*   C5             C      	PUSH	BC
  64AF*   D5             C      	PUSH	DE
  64B0*   E5             C      	PUSH	HL
  64B1*   3E 0D          C      	LD	A,13
  64B3*   32 2B00*       C      	LD	(UB.ZN),A
  64B6*   CD 55B1*       C      	CALL	U1.BILO
  64B9*   E1             C      	POP	HL
  64BA*   D1             C      	POP	DE
  64BB*   D5             C      	PUSH	DE
  64BC*   E5             C      	PUSH	HL
  64BD*   C3 6445*       C      	JP	KV.ZLTR
                         C      ;----------------------------------------------------------------------
  64C0*                  C      KV.ZEIHO:
  64C0*   21 2B00*       C      	LD	HL,UB.ZN
  64C3*   7E             C      	LD	A,(HL)
  64C4*   D6 0F          C      	SUB	15
  64C6*   38 15          C      	JR	C,$+23	;WENN IN 12. ZEILE SYS GEDRUECKT
  64C8*   35             C      	DEC	(HL)
  64C9*   35             C      	DEC	(HL)	;ZEILENNR.-2
  64CA*   E1             C      	POP	HL
  64CB*   01 0020        C      	LD	BC,32
  64CE*   B7             C      	OR	A
  64CF*   ED 42          C      	SBC	HL,BC	;VERZ.ZEIGER RUECKSETZEN
  64D1*   FD E1          C      	POP	IY
  64D3*   D1             C      	POP	DE
  64D4*   C1             C      	POP	BC
  64D5*   04             C      	INC	B
  64D6*   C5             C      	PUSH	BC
  64D7*   D5             C      	PUSH	DE
  64D8*   FD E5          C      	PUSH	IY
  64DA*   E5             C      	PUSH	HL
  64DB*   18 01          C      	JR	$+3
  64DD*   35             C      	DEC	(HL)
  64DE*   C3 647A*       C      	JP	KV.TABTR
                         C      ;----------------------------------------------------------------------
  64E1*                  C      KV.AUSG:
  64E1*   E5             C      	PUSH	HL
  64E2*   21 6048*       C      	LD	HL,UA.ZRSCH
  64E5*   CD 595C*       C      	CALL	UR.MIMO
  64E8*   7E             C      	LD	A,(HL)
  64E9*   E1             C      	POP	HL
  64EA*   FE 4A          C      	CP	'J'
  64EC*   28 11          C      	JR	Z,$+19
  64EE*   21 6061*       C      	LD	HL,UA.ANZWD
  64F1*   CD 595C*       C      	CALL	UR.MIMO
  64F4*   7E             C      	LD	A,(HL)
  64F5*   FE 4A          C      	CP	'J'
  64F7*   C1             C      	POP	BC
  64F8*   C2 6556*       C      	JP	NZ,KV.KRW
  64FB*   C5             C      	PUSH	BC
  64FC*   C3 6411*       C      	JP	KV.ANF
                         C      ;--------------------------------Dateien am Ende loeschen ? ---------
  64FF*   CD 662A*       C      	CALL	KV.SBC
  6502*   20 34          C      	JR	NZ,$+54
  6504*   3A EC85        C      	LD	A,(BC.VTABE+3)
  6507*   3D             C      	DEC	A
  6508*   5F             C      	LD	E,A
  6509*   16 00          C      	LD	D,0
  650B*   3E 01          C      	LD	A,1
  650D*   82             C      	ADD	A,D
  650E*   57             C      	LD	D,A
  650F*   1D             C      	DEC	E
  6510*   28 05          C      	JR	Z,$+7
  6512*   CD 662A*       C      	CALL	KV.SBC
  6515*   28 F4          C      	JR	Z,$-10
  6517*   C1             C      	POP	BC	;D: Anzahl zu loeschender Dateien
  6518*   79             C      	LD	A,C
  6519*   92             C      	SUB	D
  651A*   32 0E66        C      	LD	(UE.PUF+1),A	;DS-Satz korrigieren
  651D*   78             C      	LD	A,B
  651E*   92             C      	SUB	D
  651F*   32 0E68        C      	LD	(UE.PUF+3),A
  6522*   CD 60D0*       C      	CALL	UR.KBR
  6525*   CD 60D0*       C      	CALL	UR.KBR
  6528*   CD 60CA*       C      	CALL	UR.KBV
  652B*   DD 36 04 08    C      	LD	(IX+4),08H
  652F*   CD 5D2A*       C      	CALL	UF.EXEC	;und schreiben
  6532*   47             C      	LD	B,A
  6533*   05             C      	DEC	B
  6534*   28 20          C      	JR	Z,$+34
  6536*   04             C      	INC	B
  6537*   C5             C      	PUSH	BC
                         C      ;-------------------------------------Verzeichnis schreiben -----------
'Anzeigen und Aendern des MRES-Verzeichnisses'	MACRO-80 3.44	09-Dec-81	PAGE	1-52


  6538*   C1             C      	POP	BC
  6539*   05             C      	DEC	B
  653A*   21 ECA2        C      	LD	HL,BC.VTABE+32
  653D*   C5             C      	PUSH	BC
  653E*   11 0E65        C      	LD	DE,UE.PUF
  6541*   01 0020        C      	LD	BC,32
  6544*   ED B0          C      	LDIR
  6546*   CD 60CA*       C      	CALL	UR.KBV
  6549*   CD 60D0*       C      	CALL	UR.KBR
  654C*   DD 36 04 08    C      	LD	(IX+4),08H	;OHNE RAW
  6550*   CD 5D2A*       C      	CALL	UF.EXEC
  6553*   C1             C      	POP	BC
  6554*   10 E7          C      	DJNZ	$-23
                         C      ;---------------------------------------------------------------------
  6556*                  C      KV.KRW:
  6556*   CD 60A2*       C      	CALL	UR.KRW
  6559*   CD 60AC*       C      	CALL	UR.KRA
  655C*   3A 3328        C      	LD	A,(UE.BWSA+328H)
  655F*   FE 44          C      	CP	'D'
  6561*   C0             C      	RET	NZ
  6562*   21 323D        C      	LD	HL,UE.BWSA+23DH
  6565*   00             C      	NOP
  6566*   CD 65A2*       C      	CALL	KV.DRU1
  6569*   21 328D        C      	LD	HL,UE.BWSA+28DH
  656C*   CD 65A2*       C      	CALL	KV.DRU1
  656F*   CD 4040        C      	CALL	PRINT
  6572*   21 2B6E*       C      	LD	HL,UB.DTAB
  6575*   11 2B6F*       C      	LD	DE,UB.DTAB+1
  6578*   01 0028        C      	LD	BC,40
  657B*   36 20          C      	LD	(HL),20H
  657D*   ED B0          C      	LDIR
  657F*   3A EC85        C      	LD	A,(BC.VTABE+3)
  6582*   47             C      	LD	B,A
  6583*   05             C      	DEC	B
  6584*   21 EC82        C      	LD	HL,BC.VTABE
  6587*   11 0020        C      	LD	DE,32
  658A*                  C      KV.P1:
  658A*   C5             C      	PUSH	BC
  658B*   19             C      	ADD	HL,DE
  658C*   E5             C      	PUSH	HL
  658D*   D5             C      	PUSH	DE
  658E*   11 2B6E*       C      	LD	DE,UB.DTAB
  6591*   CD 65BC*       C      	CALL	KV.BSTR
  6594*   21 2B6E*       C      	LD	HL,UB.DTAB
  6597*   06 28          C      	LD	B,40
  6599*   CD 65A4*       C      	CALL	KV.DRU
  659C*   D1             C      	POP	DE
  659D*   E1             C      	POP	HL
  659E*   C1             C      	POP	BC
  659F*   10 E9          C      	DJNZ	KV.P1
  65A1*   C9             C      	RET
                         C      
  65A2*                  C      KV.DRU1:
  65A2*   06 1E          C      	LD	B,30
  65A4*                  C      KV.DRU:
  65A4*   7E             C      	LD	A,(HL)
  65A5*   23             C      	INC	HL
  65A6*   CD 65B1*       C      	CALL	KV.KO02
  65A9*   10 F9          C      	DJNZ	KV.DRU
  65AB*   3E 1E          C      	LD	A,1EH
  65AD*   CD 4040        C      	CALL	PRINT
  65B0*   C9             C      	RET
                         C      ;
  65B1*                  C      KV.KO02:
  65B1*   CB BF          C      	RES	7,A	;FUER KV17 (DRUCKERAUSGABE)
  65B3*   FE 20          C      	CP	20H
  65B5*   30 02          C      	JR	NC,$+4
  65B7*   3E 2A          C      	LD	A,2AH
  65B9*   C3 4040        C      	JP	PRINT
                         C      ;---------------------------------------------------------------------
  65BC*                  C      KV.BSTR:
  65BC*   01 0006        C      	LD	BC,6	;Aufbereitung des Verz.Satzes
  65BF*   C5             C      	PUSH	BC
  65C0*   ED B0          C      	LDIR		;Transport VTABE--->UB.SATZ
  65C2*   13             C      	INC	DE
  65C3*   13             C      	INC	DE
  65C4*   13             C      	INC	DE
  65C5*   01 0002        C      	LD	BC,2
  65C8*   ED B0          C      	LDIR
  65CA*   13             C      	INC	DE
  65CB*   13             C      	INC	DE
  65CC*   13             C      	INC	DE
  65CD*   C1             C      	POP	BC
'Anzeigen und Aendern des MRES-Verzeichnisses'	MACRO-80 3.44	09-Dec-81	PAGE	1-53


  65CE*   C5             C      	PUSH	BC
  65CF*   ED B0          C      	LDIR
  65D1*   13             C      	INC	DE
  65D2*   13             C      	INC	DE
  65D3*   13             C      	INC	DE
  65D4*   C1             C      	POP	BC
  65D5*   ED B0          C      	LDIR
  65D7*   13             C      	INC	DE
  65D8*   13             C      	INC	DE
  65D9*   13             C      	INC	DE
  65DA*   01 0003        C      	LD	BC,3
  65DD*   ED B0          C      	LDIR
  65DF*   13             C      	INC	DE
  65E0*   13             C      	INC	DE
  65E1*   13             C      	INC	DE
  65E2*   6E             C      	LD	L,(HL)	;Konvertierung Labelnummer
  65E3*   26 00          C      	LD	H,0
  65E5*   CD 571C*       C      	CALL	UC.CVBD2
  65E8*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  65E9*                  C      KV.SPTR:
  65E9*   7E             C      	LD	A,(HL)
  65EA*   FE 09          C      	CP	09H	;Soll Satz geloescht werden?
  65EC*   20 02          C      	JR	NZ,$+4
  65EE*   AF             C      	XOR	A
  65EF*   77             C      	LD	(HL),A
  65F0*   01 0006        C      	LD	BC,6
  65F3*   C5             C      	PUSH	BC
  65F4*   ED B0          C      	LDIR		;Ruecktransport BWSA--->VTABE
  65F6*   23             C      	INC	HL
  65F7*   23             C      	INC	HL
  65F8*   23             C      	INC	HL
  65F9*   01 0002        C      	LD	BC,2
  65FC*   ED B0          C      	LDIR
  65FE*   23             C      	INC	HL
  65FF*   23             C      	INC	HL
  6600*   23             C      	INC	HL
  6601*   C1             C      	POP	BC
  6602*   C5             C      	PUSH	BC
  6603*   ED B0          C      	LDIR
  6605*   23             C      	INC	HL
  6606*   23             C      	INC	HL
  6607*   23             C      	INC	HL
  6608*   C1             C      	POP	BC
  6609*   ED B0          C      	LDIR
  660B*   23             C      	INC	HL
  660C*   23             C      	INC	HL
  660D*   23             C      	INC	HL
  660E*   01 0003        C      	LD	BC,3
  6611*   ED B0          C      	LDIR
  6613*   23             C      	INC	HL
  6614*   23             C      	INC	HL
  6615*   23             C      	INC	HL
  6616*   D5             C      	PUSH	DE
  6617*   EB             C      	EX	DE,HL
  6618*   CD 661F*       C      	CALL	KV.DBCVM
  661B*   7D             C      	LD	A,L
  661C*   E1             C      	POP	HL
  661D*   77             C      	LD	(HL),A
  661E*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  661F*                  C      KV.DBCVM:
  661F*   06 02          C      	LD	B,2	;FELDLAENGE
  6621*   CD 5761*       C      	CALL	UC.CVDB	;KONVERTIER. DEZI-->BINAER
  6624*   D0             C      	RET	NC		;OHNE FEHLER
  6625*   C0             C      	RET	NZ
  6626*   13             C      	INC	DE	;1.ZEICHEN WAR KEINE DEZ.ZAHL
  6627*   10 F8          C      	DJNZ	$-6
  6629*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  662A*                  C      KV.SBC:
  662A*   01 0020        C      	LD	BC,32
  662D*   B7             C      	OR	A
  662E*   ED 42          C      	SBC	HL,BC
  6630*   7E             C      	LD	A,(HL)
  6631*   FE 00          C      	CP	00H
  6633*   C9             C      	RET
                         C      ;---------------------------------------------------------------------
  6634*                  C      KV.ANZ:
  6634*   C5             C      	PUSH	BC
  6635*   68             C      	LD	L,B
  6636*   26 00          C      	LD	H,0
  6638*   11 3332        C      	LD	DE,3332H
'Anzeigen und Aendern des MRES-Verzeichnisses'	MACRO-80 3.44	09-Dec-81	PAGE	1-54


  663B*   CD 5718*       C      	CALL	UC.CVBD3
  663E*   13             C      	INC	DE
  663F*   13             C      	INC	DE
  6640*   21 664A*       C      	LD	HL,KV.AVZS
  6643*   01 0011        C      	LD	BC,17
  6646*   ED B0          C      	LDIR
  6648*   C1             C      	POP	BC
  6649*   C9             C      	RET
                         C      ;-----------------------------------------------------------------------
  664A*                  C      KV.AVZS:
  664A*   56 65 72 7A    C      	DB	'Verzeichnissaetze'
  664E*   65 69 63 68    C      
  6652*   6E 69 73 73    C      
  6656*   61 65 74 7A    C      
  665A*   65             C      
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Kommandos: KRDx und KWRx'
                         C      	PAGE
'Kommandos: KRDx und KWRx'	MACRO-80 3.44	09-Dec-81	PAGE	1-55


                         C      
                         C      ;	PN	KH
                         C      ;**********************************************************************
                         C      ;
                         C      ;   Kommando:
                         C      ;        KRDx...Block einlesen und anzeigen
                         C      ;               zusaetlich werden die entsprechenden Puffer-
                         C      ;               adressen angezeigt.
                         C      ;        KWRx...Block schreiben, standardmaessig nach 'KRDx'
                         C      ;               Ansonsten muessen Blockadresse und Blocklaenge in der
                         C      ;               Verstaendigungstabelle eingetragen werden.
                         C      ;
                         C      ;**********************************************************************
  665B*   665B*          C      	DW	$
  665D*   4B 52 57 31    C      	DB	'KRW1'
  6661*   18 06          C      	JR	KH.RDSTA
                         C      ;
  6663*   6663*          C      	DW	$
  6665*   4B 52 57 32    C      	DB	'KRW2'
  6669*                  C      KH.RDSTA:
  6669*   CD 54E2*       C      	CALL	U1.KTINI	;Initialisierung E/A-Tab.
  666C*   3A 3325        C      	LD	A,(UE.BWSA + 10*80 + 5)	;325H i von KRDi
  666F*   E6 0F          C      	AND	0FH
  6671*   DD 77 03       C      	LD	(IX+3),A	;Subadresse eintragen
  6674*                  C      KH.RES:
  6674*                  C      KH.KSRE:
  6674*   CD 609A*       C      	CALL	UR.KRE	;Reservieren
  6677*                  C      KH.RD1:
  6677*                  C      KH.KSRW:
  6677*   DD 36 04 21    C      	LD	(IX+4),021H	;umspulen (rewind)
  667B*   CD 5D2A*       C      	CALL	UF.EXEC
  667E*   C3 6703*       C      	JP		KH.RDBA
                         C      ;
                         C      ;	Z Y K L U S  ueber Tastatureingaben
  6681*                  C      KH.RD3:	;Zyklus
  6681*   DD 36 0A 00    C      	LD	(IX+10),0	;Anzahl Bandmarken
  6685*   CD 5A88*       C      	CALL	UR.TAREP	;Tastaturabfrage
  6688*   FE 80          C      	CP	080H
  668A*   28 E8          C      	JR	Z,KH.KSRE	;---> P 01	Reservieren EIN
  668C*   FE 82          C      	CP	082H
  668E*   28 2A          C      	JR	Z,KH.KSRA	;---> P 03	Reservieren AUS
  6690*   FE 81          C      	CP	081H
  6692*   28 E3          C      	JR	Z,KH.KSRW	;---> P 02	Rewind
                         C      
  6694*   FE 83          C      	CP	083H
  6696*   28 31          C      	JR	Z,KH.KSRP	;---> P 04	        read; display
  6698*   FE 85          C      	CP	085H
  669A*   28 2A          C      	JR	Z,KH.KSRM	;---> P 06	R-; R-; read; display
                         C      
  669C*   DD 36 0A 01    C      	LD	(IX+10),1	;Anzahl Bandmarken
  66A0*   FE 86          C      	CP	086H
  66A2*   28 3C          C      	JR	Z,KH.BMP	;---> P07	BM+
  66A4*   FE 88          C      	CP	088H
  66A6*   28 40          C      	JR	Z,KH.BMM	;---> P09	BM-
                         C      
  66A8*   FE 89          C      	CP	089H
  66AA*   28 41          C      	JR	Z,KH.WREC	;---> P10	write Record
  66AC*   FE 8A          C      	CP	08AH
  66AE*   28 49          C      	JR	Z,KH.WBM	;---> P11	write BM
  66B0*   FE 8B          C      	CP	08BH
  66B2*   28 47          C      	JR	Z,KH.WSL	;---> P11	write SL
                         C      
  66B4*   FE CD          C      	CP	0CDH
  66B6*   28 45          C      	JR	Z,KH.SYSRT	;---> SYS
                         C      
  66B8*   18 C7          C      	JR	KH.RD3
                         C      
                         C      ;	P 03	Reservieren AUS
  66BA*                  C      KH.KSRA:
  66BA*   DD 36 04 21    C      	LD	(IX+4),021H	;umspulen (rewind)
  66BE*   CD 5D2A*       C      	CALL	UF.EXEC
  66C1*   CD 60AC*       C      	CALL	UR.KRA
  66C4*   18 3D          C      	JR		KH.RDBA
                         C      
                         C      ;	P 06	R-; R-; read; display
  66C6*                  C      KH.KSRM:
  66C6*   CD 6765*       C      	CALL	KH.RD2
                         C      ;	P 04	        read; display
  66C9*                  C      KH.KSRP:
  66C9*   DD 36 04 02    C       	LD	(IX+4),002H	;naechst Record lesen
  66CD*   CD 5D2A*       C      	CALL	UF.EXEC
  66D0*   DD 7E 0A       C      	LD	A,(IX+10)	;Lade die Laenge des Blockes
'Kommandos: KRDx und KWRx'	MACRO-80 3.44	09-Dec-81	PAGE	1-56


  66D3*   FE 01          C      	CP	1	;Laenge = 1, dann BandMarke
  66D5*   28 3D          C      	JR	Z,KH.RDBM
  66D7*   FE 02          C      	CP	2	;Laenge = 2, dann Schlussluecke
  66D9*   28 4A          C      	JR	Z,KH.RDSL
  66DB*   CD 6736*       C      	CALL	KH.ANZBL	;Block anzeigen
  66DE*   18 A1          C      	JR	KH.RD3
                         C      
                         C      ;	P 07	BM+
  66E0*                  C      KH.BMP:
  66E0*   CD 60B2*       C      	CALL	UR.KLV	;Bandmarke vorsetzen
  66E3*   CD 60D0*       C      	CALL	UR.KBR	;Record    zuruecksetzen
  66E6*   18 E1          C      	JR	KH.KSRP
                         C      ;	P 09	BM-
  66E8*                  C      KH.BMM:
  66E8*   CD 60B8*       C      	CALL	UR.KLR	;Bandmarke zurC<cksetzen
  66EB*   18 DC          C      	JR	KH.KSRP
                         C      
                         C      ;	P 10	write Record
  66ED*                  C      KH.WREC:
  66ED*   DD 36 04 08    C      	LD	(IX+4),08H
  66F1*   CD 5D2A*       C      	CALL	UF.EXEC
  66F4*   CD 60D0*       C      	CALL	UR.KBR
  66F7*   18 88          C      	JR	KH.RD3
                         C      
                         C      ;	P 11	write BM
  66F9*                  C      KH.WBM:
  66F9*   18 86          C      	JR	KH.RD3
                         C      
                         C      ;	P 12	write SL
  66FB*                  C      KH.WSL:
  66FB*   18 84          C      	JR	KH.RD3
                         C      
                         C      ;	SYS		Systemruecksprung
  66FD*                  C      KH.SYSRT:
  66FD*   CD 67DF*       C      	CALL	KH.BILO
  6700*   C3 000B        C      	JP	SY.SYSTB
                         C      
  6703*                  C      KH.RDBA:
  6703*   CD 67DF*       C      	CALL	KH.BILO
  6706*   21 6016*       C      	LD	HL,UA.ZKBA	;"Bandanfang"
  6709*   11 3000        C      	LD	DE,UE.BWSA
  670C*   01 000A        C      	LD	BC,UA.ZKBM-UA.ZKBA
  670F*   ED B0          C      	LDIR
  6711*   C3 6681*       C      	JP	KH.RD3
                         C      
  6714*                  C      KH.RDBM:
  6714*   CD 67DF*       C      	CALL	KH.BILO
  6717*   21 6020*       C      	LD	HL,UA.ZKBM	;"Bandmarke"
  671A*   11 3000        C      	LD	DE,UE.BWSA
  671D*   01 0009        C      	LD	BC,UA.ZKSL-UA.ZKBM
  6720*   ED B0          C      	LDIR
  6722*   C3 6681*       C      	JP	KH.RD3
                         C      
  6725*                  C      KH.RDSL:
  6725*   CD 67DF*       C      	CALL	KH.BILO
  6728*   21 6029*       C      	LD	HL,UA.ZKSL	;"Schlussluecke"
  672B*   11 3000        C      	LD	DE,UE.BWSA
  672E*   01 000D        C      	LD	BC,UA.ZKEE-UA.ZKSL
  6731*   ED B0          C      	LDIR
  6733*   C3 6681*       C      	JP	KH.RD3
                         C      
  6736*                  C      KH.ANZBL:
  6736*   CD 67DF*       C      	CALL	KH.BILO
  6739*                  C      KH.ANZB1:
  6739*   21 0E65        C      	LD	HL,UE.PUF
  673C*   FE 20          C      	CP	020H
  673E*   20 04          C      	JR	NZ,KH.ANZB2
  6740*   06 02          C      	LD	B,2	; 2 Zeilen anzeigen
  6742*   18 0A          C      	JR	KH.ANZB4
  6744*                  C      KH.ANZB2:
  6744*   FE 80          C      	CP	080H
  6746*   20 04          C      	JR	NZ,KH.ANZB3
  6748*   06 08          C      	LD	B,8	; 8 Zeilen anzeigen
  674A*   18 02          C      	JR	KH.ANZB4
  674C*                  C      KH.ANZB3:
  674C*   06 18          C      	LD	B,24	; 24 Zeilen anzeigen
  674E*                  C      KH.ANZB4:
  674E*   CD 6752*       C      	CALL	KH.AZBLD	;Bild anzeigen (24 Zeilen)
  6751*   C9             C      	RET		; IN...HL:=akt. Pufferadresse
                         C      
  6752*                  C      KH.AZBLD:
  6752*   11 3000        C      	LD	DE,UE.BWSA
  6755*                  C      KH.AZBL1:
'Kommandos: KRDx und KWRx'	MACRO-80 3.44	09-Dec-81	PAGE	1-57


  6755*   C5             C      	PUSH	BC
  6756*   CD 676E*       C      	CALL	KH.AZ1Z	; 1 Zeile anzeigen
  6759*   C1             C      	POP	BC
  675A*   E5             C      	PUSH	HL	;akt. Pufferadresse retten
  675B*   EB             C      	EX	DE,HL
  675C*   11 0050        C      	LD	DE,80
  675F*   19             C      	ADD	HL,DE	;neuen Zeilenanfang berechnen
  6760*   EB             C      	EX	DE,HL
  6761*   E1             C      	POP	HL
  6762*   10 F1          C      	DJNZ	KH.AZBL1
  6764*   C9             C      	RET
                         C      
  6765*                  C      KH.RD2:
  6765*   F5             C      	PUSH	AF	;Flags retten
  6766*   CD 60D0*       C      	CALL	UR.KBR	;Block ruecksetzen
  6769*   CD 60D0*       C      	CALL	UR.KBR
  676C*   F1             C      	POP	AF
  676D*   C9             C      	RET
                         C      ;                                IN...HL:= Pufferadresse
                         C      ;                                     DE:= Zeilenanfang
  676E*                  C      KH.AZ1Z:
  676E*   D5             C      	PUSH	DE	;eine Zeile anzeigen
  676F*   E5             C      	PUSH	HL
  6770*   D5             C      	PUSH	DE
  6771*   E1             C      	POP	HL
  6772*   01 0040        C      	LD	BC,64
  6775*   09             C      	ADD	HL,BC
  6776*   E5             C      	PUSH	HL
  6777*   C1             C      	POP	BC	;BC:= Anfang ASCII-Darstellung
  6778*   E1             C      	POP	HL
  6779*   CD 6792*       C      	CALL	KH.AZADR	;Adresse anzeigen
  677C*   13             C      	INC	DE
  677D*   13             C      	INC	DE
  677E*   CD 679B*       C      	CALL	KH.AZ4BY	;1. Vierergruppe
  6781*   13             C      	INC	DE
  6782*   13             C      	INC	DE
  6783*   CD 679B*       C      	CALL	KH.AZ4BY	;2.      ''
  6786*   13             C      	INC	DE
  6787*   13             C      	INC	DE
  6788*   CD 679B*       C      	CALL	KH.AZ4BY	;3.      ''
  678B*   13             C      	INC	DE
  678C*   13             C      	INC	DE
  678D*   CD 679B*       C      	CALL	KH.AZ4BY	;4.      ''
  6790*   D1             C      	POP	DE
  6791*   C9             C      	RET
  6792*                  C      KH.AZADR:
  6792*   7C             C      	LD	A,H	;Anzeige der Adresse
  6793*   CD 56A5*       C      	CALL	UC.CVBX+2
  6796*   7D             C      	LD	A,L
  6797*   CD 56A5*       C      	CALL	UC.CVBX+2
  679A*   C9             C      	RET
  679B*                  C      KH.AZ4BY:
  679B*   AF             C      	XOR	A	;Anzeige einer Vierergruppe
  679C*   32 2B26*       C      	LD	(UB.PAR1),A
  679F*                  C      KH.AZ4B0:
  679F*   7E             C      	LD	A,(HL)
  67A0*   F5             C      	PUSH	AF
  67A1*   CD 56A5*       C      	CALL	UC.CVBX+2	;Code als Hexadezimalzahl
  67A4*   F1             C      	POP	AF
  67A5*   13             C      	INC	DE
  67A6*   23             C      	INC	HL
  67A7*   FE 20          C      	CP	20H
  67A9*   38 15          C      	JR	C,KH.AZ4B1	;nicht darstellbar
  67AB*   FE 7F          C      	CP	7FH
  67AD*   30 11          C      	JR	NC,KH.AZ4B1	;nicht darstellbar
  67AF*                  C      KH.AZ4B3:
  67AF*   02             C      	LD	(BC),A	;Code als ASCII-Zeichen
  67B0*   03             C      	INC	BC
  67B1*   CD 67C4*       C      	CALL	KH.BLEVG	;Test auf Blockende
  67B4*   3A 2B26*       C      	LD	A,(UB.PAR1)
  67B7*   3C             C      	INC	A
  67B8*   FE 04          C      	CP	4
  67BA*   C8             C      	RET	Z
  67BB*   32 2B26*       C      	LD	(UB.PAR1),A
  67BE*   18 DF          C      	JR	KH.AZ4B0
  67C0*                  C      KH.AZ4B1:
  67C0*   3E 7F          C      	LD	A,07FH
  67C2*   18 EB          C      	JR	KH.AZ4B3
  67C4*                  C      KH.BLEVG:
  67C4*   D5             C      	PUSH	DE	;Blockendetest
  67C5*   E5             C      	PUSH	HL
  67C6*   11 0E65        C      	LD	DE,UE.PUF	;DE:= Pufferanfang
  67C9*   B7             C      	OR	A
'Kommandos: KRDx und KWRx'	MACRO-80 3.44	09-Dec-81	PAGE	1-58


  67CA*   ED 52          C      	SBC	HL,DE	;HL:= Anzahl der angezeigten
  67CC*   EB             C      	EX	DE,HL
  67CD*   CD 5611*       C      	CALL	XY.LIDX
  67D0*   09             C      	DB	9
  67D1*   B7             C      	OR	A
  67D2*   ED 52          C      	SBC	HL,DE
  67D4*   E1             C      	POP	HL
  67D5*   D1             C      	POP	DE
  67D6*   28 01          C      	JR	Z,KH.BLEV1
  67D8*   C9             C      	RET
  67D9*                  C      KH.BLEV1:
  67D9*   06 0C          C      	LD	B,12
  67DB*                  C      KH.BLEV2:
  67DB*   33             C      	INC	SP
  67DC*   10 FD          C      	DJNZ	KH.BLEV2
  67DE*   C9             C      	RET		;---> Anzeige beendet
                         C      
                         C      ;----------------------------------------------------
  67DF*                  C      KH.BILO:
  67DF*   21 3000        C      	LD	HL,UE.BWSA
  67E2*   01 077F        C      	LD	BC,24*80 -1	;800H
  67E5*   36 20          C      	LD	(HL),20H
  67E7*   E5             C      	PUSH	HL
  67E8*   D1             C      	POP	DE
  67E9*   13             C      	INC	DE
  67EA*   ED B0          C      	LDIR
  67EC*   C9             C      	RET
                         C      ;------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Ein-/Ausgabe im freien Format'
                         C      	PAGE
'Ein-/Ausgabe im freien Format'	MACRO-80 3.44	09-Dec-81	PAGE	1-59


                         C      
                         C      ;	PN	FD
                         C      ;**********************************************************************
                         C      ;
                         C      ;      Ein-/Ausgabe von Dateien im freien Format in bzw. aus dem
                         C      ;      Editorraum von bzw. auf MRES-Kassetten
                         C      ;
                         C      ;**********************************************************************
                         C      ;      Positionieren auf Datei, IN: <C>:= Labelnummer
                         C      ;
  67ED*                  C      FD.POSK:
  67ED*   C5             C      	PUSH	BC
  67EE*   41             C      	LD	B,C
  67EF*   04             C      	INC	B
  67F0*   CD 60DF*       C      	CALL	UR.POSIK
  67F3*   CD 6805*       C      	CALL	FD.KO01
  67F6*   3A 0E65        C      	LD	A,(UE.PUF)
  67F9*   B9             C      	CP	C
  67FA*   C1             C      	POP	BC
  67FB*   20 01          C      	JR	NZ,$+3
  67FD*   C9             C      	RET
  67FE*   D1             C      	POP	DE
  67FF*   3E 94          C      	LD	A,94H
  6801*   CD 5D5A*       C      	CALL	UF.ERANZ
  6804*   C9             C      	RET
                         C      ;
  6805*                  C      FD.KO01:
  6805*   DD 36 04 02    C      	LD	(IX+4),002H	;FUER FD19
  6809*   C3 5D2A*       C      	JP	UF.EXEC
                         C      ;----------------------------------------------------------------------
                         C      ;      Datei im Verzeichnis suchen
                         C      ;      HL:= Dateiname, <B>:= Anzahl Verzeichniseintragungen + 1
                         C      ;      <D>:= Dateityp
                         C      ;      O:  CY:= 0 Datei nicht vorhanden, <C> unveraendert
                         C      ;          CY:= 1 <C>:= Labelnummer
                         C      ;      K:  B
  680C*                  C      FD.DASU:
  680C*   D5             C      	PUSH	DE
  680D*   05             C      	DEC	B
  680E*   28 0A          C      	JR	Z,$+12
  6810*   CD 6805*       C      	CALL	FD.KO01
  6813*   CD 54C7*       C      	CALL	U1.NMVGL
  6816*   38 05          C      	JR	C,$+7
  6818*   10 F6          C      	DJNZ	$-8
  681A*   B7             C      	OR	A
  681B*   D1             C      	POP	DE
  681C*   C9             C      	RET
  681D*   5F             C      	LD	E,A
  681E*   3A 0E6B        C      	LD	A,(UE.PUF+6)
  6821*   BA             C      	CP	D
  6822*   20 F4          C      	JR	NZ,$-10
  6824*   4B             C      	LD	C,E
  6825*   37             C      	SCF
  6826*   18 F3          C      	JR	$-11
                         C      ;----------------------------------------------------------------------
                         C      ;      Reservebloecke schreiben
                         C      ;
  6828*                  C      FD.WRRES:
  6828*   C5             C      	PUSH	BC
  6829*   D5             C      	PUSH	DE
  682A*   E5             C      	PUSH	HL
  682B*   21 5FC8*       C      	LD	HL,UA.ZKRES
  682E*   CD 595C*       C      	CALL	UR.MIMO
  6831*   EB             C      	EX	DE,HL
  6832*   CD 5761*       C      	CALL	UC.CVDB
  6835*   7C             C      	LD	A,H
  6836*   B5             C      	OR	L
  6837*   20 04          C      	JR	NZ,$+6
  6839*   E1             C      	POP	HL
  683A*   D1             C      	POP	DE
  683B*   C1             C      	POP	BC
  683C*   C9             C      	RET
  683D*   E5             C      	PUSH	HL
  683E*   21 0E65        C      	LD	HL,UE.PUF
  6841*   01 0090        C      	LD	BC,90H
  6844*   CD 5411*       C      	CALL	U1.CLRB
  6847*   21 0080        C      	LD	HL,80H
  684A*   CD 5631*       C      	CALL	XY.STIDX
  684D*   09             C      	DB	9
  684E*   E1             C      	POP	HL
  684F*   CD 622F*       C      	CALL	UK.KBA
  6852*   2B             C      	DEC	HL
'Ein-/Ausgabe im freien Format'	MACRO-80 3.44	09-Dec-81	PAGE	1-60


  6853*   7C             C      	LD	A,H
  6854*   B5             C      	OR	L
  6855*   20 E6          C      	JR	NZ,$-24
  6857*   18 E0          C      	JR	$-30
                         C      ;----------------------------------------------------------------------
                         C      ;      F/S - Datei in den Editorraum einlesen
                         C      ;
  6859*                  C      FD.FDINP:
  6859*   21 0000        C      	LD	HL,0
  685C*   CD 5621*       C      	CALL	XY.STDX
  685F*   11             C      	DB	17
  6860*   CD 617F*       C      	CALL	UK.KLPFB	;Pufferbereitstellung
  6863*   21 3328        C      	LD	HL,UE.BWSA+328H
  6866*   06 05          C      	LD	B,5
  6868*   7E             C      	LD	A,(HL)
  6869*   FE 45          C      	CP	'E'
  686B*   28 05          C      	JR	Z,$+7
  686D*   23             C      	INC	HL
  686E*   10 F8          C      	DJNZ	$-6
  6870*   18 05          C      	JR	$+7
  6872*   2A 0DC6        C      	LD	HL,(UE.EDEND)
  6875*   18 03          C      	JR	$+5
  6877*   21 8830        C      	LD	HL,UE.TEXAN
  687A*   D9             C      	EXX
  687B*   CD 5956*       C      	CALL	DC.INIT	;Dekomprimierung initialisieren
  687E*   D9             C      	EXX
  687F*   3A 2B28*       C      	LD	A,(UB.PAR2)	;Dateitypmerker
  6882*   FE 53          C      	CP	'S'
  6884*   F5             C      	PUSH	AF
  6885*   CC 68A0*       C      	CALL	Z,FD.SDIN	;Zeicheneingabe S- Datei
  6888*   77             C      	LD	(HL),A
  6889*   B7             C      	OR	A
  688A*   28 12          C      	JR	Z,$+20
  688C*   F1             C      	POP	AF
  688D*   28 07          C      	JR	Z,$+9
  688F*   C4 6142*       C      	CALL	NZ,UK.GETK	;Zeicheneingabe F- Datei
  6892*   77             C      	LD	(HL),A	;Zeichen in Speicher eintragen
  6893*   BE             C      	CP	(HL)	;Echolesen
  6894*   20 10          C      	JR	NZ,$+18
  6896*   B7             C      	OR	A	;<A>:= 0, Z:= 1
  6897*   C8             C      	RET	Z
  6898*   23             C      	INC	HL	;HL:= HL + 1
  6899*   22 0DC6        C      	LD	(UE.EDEND),HL	;Textende
  689C*   18 E1          C      	JR	$-29
  689E*   F1             C      	POP	AF
  689F*   C9             C      	RET
  68A0*                  C      FD.SDIN:
  68A0*   D9             C      	EXX
  68A1*   CD 591B*       C      	CALL	DC.DCMPR
  68A4*   D9             C      	EXX
  68A5*   C9             C      	RET
  68A6*   3E 93          C      	LD	A,93H	;Fehlerschluessel
  68A8*   CD 5D5A*       C      	CALL	UF.ERANZ
  68AB*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;      Ausgabe einer F/S - Datei (neuer Bestand)
                         C      ;
  68AC*                  C      FD.FDOUT:
  68AC*   21 0000        C      	LD	HL,0                   ;Blockzaehler loeschen
  68AF*   CD 5621*       C      	CALL	XY.STDX
  68B2*   11             C      	DB	17
  68B3*   21 0080        C      	LD	HL,80H                 ;Blocklaenge eintragen
  68B6*   CD 5631*       C      	CALL	XY.STIDX
  68B9*   09             C      	DB	9
  68BA*   CD 620A*       C      	CALL	UK.KSPFB               ;Pufferbereitstellung
  68BD*   21 8830        C      	LD	HL,UE.TEXAN            ;HL:= Textanfang
  68C0*   ED 5B 0DC6     C      	LD	DE,(UE.EDEND)          ;BC:= Textende
  68C4*   D9             C      	EXX
  68C5*   CD 5915*       C      	CALL	CP.INIT
  68C8*   D9             C      	EXX
  68C9*                  C      FD.FDOUT1:
  68C9*   B7             C      	OR	A                      ;CY:= 0
  68CA*   E5             C      	PUSH	HL
  68CB*   ED 52          C      	SBC	HL,DE
  68CD*   30 13          C      	JR	NC,FD.FDOUT2           ;$+21
  68CF*   E1             C      	POP	HL
  68D0*   3A 2B28*       C      	LD	A,(UB.PAR2)
  68D3*   FE 53          C      	CP	'S'
  68D5*   F5             C      	PUSH	AF
  68D6*   7E             C      	LD	A,(HL)
  68D7*   CC 68FA*       C      	CALL	Z,FD.SDOUT
  68DA*   F1             C      	POP	AF
  68DB*   7E             C      	LD	A,(HL)
'Ein-/Ausgabe im freien Format'	MACRO-80 3.44	09-Dec-81	PAGE	1-61


  68DC*   C4 61E6*       C      	CALL	NZ,UK.PUTK
  68DF*   23             C      	INC	HL
  68E0*   18 E7          C      	JR	FD.FDOUT1              ;$-23
  68E2*                  C      FD.FDOUT2:
  68E2*   E1             C      	POP	HL                     ;Endebehandlung
  68E3*   01 0120        C      	LD	BC,288
  68E6*                  C      FD.FDOUT3:
  68E6*   AF             C      	XOR	A
  68E7*   CD 61E6*       C      	CALL	UK.PUTK
  68EA*   0B             C      	DEC	BC
  68EB*   78             C      	LD	A,B
  68EC*   B1             C      	OR	C
  68ED*   20 F7          C      	JR	NZ,FD.FDOUT3           ;$-7
  68EF*   CD 6ABD*       C      	CALL	FD.DSPBB
  68F2*   CD 6828*       C      	CALL	FD.WRRES               ;Reservebloecke schreiben
  68F5*   CD 5601*       C      	CALL	XY.LDDX                ;HL:= Blockzaehler
  68F8*   11             C      	DB	17
  68F9*   C9             C      	RET
  68FA*                  C      FD.SDOUT:
  68FA*   D9             C      	EXX
  68FB*   CD 58B2*       C      	CALL	CP.COMPR
  68FE*   D9             C      	EXX
  68FF*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;      Ausgabe einer F/S - Datei (alter Bestand)
                         C      ;
  6900*                  C      FD.FDOWR:
  6900*   21 0000        C      	LD	HL,0
  6903*   CD 5621*       C      	CALL	XY.STDX
  6906*   11             C      	DB	17
  6907*   21 8830        C      	LD	HL,UE.TEXAN
  690A*   D9             C      	EXX
  690B*   CD 5915*       C      	CALL	CP.INIT
  690E*   D9             C      	EXX
  690F*   E5             C      	PUSH	HL
  6910*                  C      FD.FDOW1:
  6910*   CD 6950*       C      	CALL	FD.FDUP
  6913*   E1             C      	POP	HL
  6914*                  C      FD.FDOW2:
  6914*   E5             C      	PUSH	HL
  6915*   ED 5B 0DC6     C      	LD	DE,(UE.EDEND)
  6919*   B7             C      	OR	A
  691A*   ED 52          C      	SBC	HL,DE
  691C*   30 1B          C      	JR	NC,FD.FDOW3
  691E*   E1             C      	POP	HL
  691F*   3A 2B28*       C      	LD	A,(UB.PAR2)
  6922*   FE 53          C      	CP	'S'
  6924*   7E             C      	LD	A,(HL)
  6925*   28 41          C      	JR	Z,FD.SDOW
  6927*   CD 61E6*       C      	CALL	UK.PUTK
  692A*   0B             C      	DEC	BC
  692B*                  C      FD.FDOW4:
  692B*   23             C      	INC	HL
  692C*   78             C      	LD	A,B
  692D*   B1             C      	OR	C
  692E*   20 E4          C      	JR	NZ,FD.FDOW2
  6930*   CD 622F*       C      	CALL	UK.KBA	;Block schreiben
  6933*   E5             C      	PUSH	HL
  6934*   CD 6946*       C      	CALL	FD.DECBZ
  6937*   18 D7          C      	JR	FD.FDOW1
  6939*                  C      FD.FDOW3:
  6939*   E1             C      	POP	HL
  693A*   AF             C      	XOR	A	;Endekennzeichen 00H
  693B*   CD 61E6*       C      	CALL	UK.PUTK
  693E*   CD 622F*       C      	CALL	UK.KBA
  6941*   CD 6946*       C      	CALL	FD.DECBZ
  6944*   B7             C      	OR	A
  6945*   C9             C      	RET
  6946*                  C      FD.DECBZ:
  6946*   CD 5601*       C      	CALL	XY.LDDX
  6949*   11             C      	DB	17
  694A*   2B             C      	DEC	HL
  694B*   CD 5621*       C      	CALL	XY.STDX
  694E*   11             C      	DB	17
  694F*   C9             C      	RET
  6950*                  C      FD.FDUP:
  6950*   CD 61A2*       C      	CALL	UK.KBW
  6953*   DD 7E 0A       C      	LD	A,(IX+10)	;Laenge = 1, dann BM
  6956*   FE 01          C      	CP	1
  6958*   CA 6AE2*       C      	JP	Z,FD.BMGF
  695B*   CD 60D0*       C      	CALL	UR.KBR
  695E*   CD 5611*       C      	CALL	XY.LIDX
  6961*   09             C      	DB	9
'Ein-/Ausgabe im freien Format'	MACRO-80 3.44	09-Dec-81	PAGE	1-62


  6962*   E5             C      	PUSH	HL
  6963*   C1             C      	POP	BC
  6964*   CD 620A*       C      	CALL	UK.KSPFB
  6967*   C9             C      	RET
  6968*                  C      FD.SDOW:
  6968*   CD 68FA*       C      	CALL	FD.SDOUT
  696B*   78             C      	LD	A,B
  696C*   A1             C      	AND	C
  696D*   FE FF          C      	CP	0FFH
  696F*   28 1B          C      	JR	Z,FD.SDK1
  6971*   FE FE          C      	CP	0FEH
  6973*   28 03          C      	JR	Z,FD.SDK2
  6975*   C3 692B*       C      	JP	FD.FDOW4
  6978*                  C      FD.SDK2:
  6978*   EB             C      	EX	DE,HL
  6979*   CD 6950*       C      	CALL	FD.FDUP
  697C*   3E 09          C      	LD	A,09H
  697E*   CD 61E6*       C      	CALL	UK.PUTK
  6981*   0B             C      	DEC	BC
  6982*                  C      FD.SDK0:
  6982*   3E 3B          C      	LD	A,';'
  6984*   CD 61E6*       C      	CALL	UK.PUTK
  6987*   0B             C      	DEC	BC
  6988*   EB             C      	EX	DE,HL
  6989*   C3 692B*       C      	JP	FD.FDOW4
  698C*                  C      FD.SDK1:
  698C*   EB             C      	EX	DE,HL
  698D*   CD 6950*       C      	CALL	FD.FDUP
  6990*   18 F0          C      	JR	FD.SDK0
                         C      ;--------------------------------------------------------------
                         C      ;        Startroutine Ein-/Ausgabe
                         C      ;
  6992*                  C      FD.FSTRT:
  6992*   CD 55B1*       C      	CALL	U1.BILO
  6995*   CD 54E2*       C      	CALL	U1.KTINI
  6998*   3A 3326        C      	LD	A,(UE.BWSA + 10*80 +6)	;326H
  699B*   CD 55C5*       C      	CALL	U1.TST
  699E*   DA 69CA*       C      	JP	C,FD.STRT1
  69A1*   DD 77 03       C      	LD	(IX+3),A
  69A4*   CD 609A*       C      	CALL	UR.KRE
  69A7*   CD 60A8*       C      	CALL	UR.KRWW
  69AA*   CD 5496*       C      	CALL	U1.DSVG
  69AD*   3E 0E          C      	LD	A,14
  69AF*   32 2B00*       C      	LD	(UB.ZN),A
  69B2*   3A 3328        C      	LD	A,(UE.BWSA+328H)
  69B5*   FE 53          C      	CP	'S'
  69B7*   28 02          C      	JR	Z,$+4
  69B9*   3E 46          C      	LD	A,'F'
  69BB*   57             C      	LD	D,A
  69BC*   32 2B28*       C      	LD	(UB.PAR2),A
  69BF*   21 5FDB*       C      	LD	HL,UA.ZKSDT
  69C2*   28 03          C      	JR	Z,$+5
  69C4*   21 5F4B*       C      	LD	HL,UA.ZKDAT
  69C7*   CD 595C*       C      	CALL	UR.MIMO
  69CA*                  C      FD.STRT1:
  69CA*   FD E1          C      	POP	IY
  69CC*   D8             C      	RET	C
  69CD*   FD E5          C      	PUSH	IY
  69CF*   3E 53          C      	LD	A,'S'
  69D1*   BA             C      	CP	D
  69D2*   CC 69FD*       C      	CALL	Z,FD.DECHL
  69D5*   CD 680C*       C      	CALL	FD.DASU
  69D8*   DC 69DF*       C      	CALL	C,FD.SETJ
  69DB*   D4 69F7*       C      	CALL	NC,FD.SETN
  69DE*   C9             C      	RET
  69DF*                  C      FD.SETJ:
  69DF*   C5             C      	PUSH	BC
  69E0*   D5             C      	PUSH	DE
  69E1*   E5             C      	PUSH	HL
  69E2*   EB             C      	EX	DE,HL
  69E3*   06 08          C      	LD	B,8
  69E5*   13             C      	INC	DE
  69E6*   10 FD          C      	DJNZ	$-1
  69E8*   21 0E6D        C      	LD	HL,UE.PUF+8
  69EB*   01 0006        C      	LD	BC,6
  69EE*   ED B0          C      	LDIR
  69F0*   E1             C      	POP	HL
  69F1*   D1             C      	POP	DE
  69F2*   C1             C      	POP	BC
  69F3*   3E 4A          C      	LD	A,'J'
  69F5*   18 02          C      	JR	$+4
  69F7*                  C      FD.SETN:
  69F7*   3E 4E          C      	LD	A,'N'
'Ein-/Ausgabe im freien Format'	MACRO-80 3.44	09-Dec-81	PAGE	1-63


  69F9*   32 2B26*       C      	LD	(UB.PAR1),A
  69FC*   C9             C      	RET
  69FD*                  C      FD.DECHL:
  69FD*   2B             C      	DEC	HL
  69FE*   2B             C      	DEC	HL
  69FF*   C9             C      	RET
                         C      ;****************************************************************
                         C      ;        Ausgabeprogramm
                         C      ;****************************************************************
  6A00*   6A00*          C      	DW	$
  6A02*   41 55 53 20    C      	DB	'AUS '
  6A06*                  C      FD.FOUT1:
  6A06*   CD 6992*       C      	CALL	FD.FSTRT
  6A09*   3A 2B26*       C      	LD	A,(UB.PAR1)
  6A0C*   FE 4A          C      	CP	'J'	;DATEI SCHON VORHANDEN ?
  6A0E*   CA 6A79*       C      	JP	Z,FD.FOLWR	;JA
                         C      ;-------------------------------NEIN--> NEUE ERSTELLEN-----------------
  6A11*   79             C      	LD	A,C	;NEXT RECORD
  6A12*   32 2B26*       C      	LD	(UB.PAR1),A
  6A15*   3E 7F          C      	LD	A,7FH
  6A17*   32 2B2A*       C      	LD	(UB.PAR3),A	;PARAMETER KOMMENTARABFRAGE JA
  6A1A*   CD 554E*       C      	CALL	U1.VZS	;NEUEN VERZ.SATZ SCHREIBEN
  6A1D*   CD 67ED*       C      	CALL	FD.POSK
  6A20*   C5             C      	PUSH	BC
  6A21*   CD 68AC*       C      	CALL	FD.FDOUT
  6A24*   E5             C      	PUSH	HL	;BLOCKZAEHLER
  6A25*   CD 60BE*       C      	CALL	UR.KBM
  6A28*   21 0020        C      	LD	HL,32
  6A2B*   CD 5631*       C      	CALL	XY.STIDX
  6A2E*   09             C      	DB	9
  6A2F*   CD 5486*       C      	CALL	U1.VSX
  6A32*   E1             C      	POP	HL
  6A33*   C1             C      	POP	BC
  6A34*   E5             C      	PUSH	HL
  6A35*   79             C      	LD	A,C
  6A36*   3C             C      	INC	A
  6A37*   32 0E65        C      	LD	(UE.PUF),A
  6A3A*   F5             C      	PUSH	AF
  6A3B*   DD 36 04 08    C      	LD	(IX+4),08H
  6A3F*   CD 5D2A*       C      	CALL	UF.EXEC
  6A42*   CD 60A8*       C      	CALL	UR.KRWW
  6A45*   CD 5496*       C      	CALL	U1.DSVG
  6A48*   CD 60D0*       C      	CALL	UR.KBR
  6A4B*   F1             C      	POP	AF
  6A4C*   32 0E66        C      	LD	(UE.PUF+1),A
  6A4F*   78             C      	LD	A,B
  6A50*   3C             C      	INC	A
  6A51*   32 0E68        C      	LD	(UE.PUF+3),A
  6A54*   DD 36 04 08    C      	LD	(IX+4),08H
  6A58*   CD 5D2A*       C      	CALL	UF.EXEC
  6A5B*   DD 36 04 02    C      	LD	(IX+4),02H
  6A5F*   CD 5D2A*       C      	CALL	UF.EXEC
  6A62*   10 FB          C      	DJNZ	$-3
  6A64*   CD 60D0*       C      	CALL	UR.KBR
  6A67*   E1             C      	POP	HL
  6A68*   22 0E7E        C      	LD	(UE.PUF+25),HL
  6A6B*   DD 36 04 08    C      	LD	(IX+4),08H
  6A6F*   CD 5D2A*       C      	CALL	UF.EXEC
  6A72*                  C      FD.END:
  6A72*   CD 60A2*       C      	CALL	UR.KRW
  6A75*   CD 60AC*       C      	CALL	UR.KRA
  6A78*   C9             C      	RET
  6A79*                  C      FD.FOLWR:
  6A79*   21 5FAA*       C      	LD	HL,UA.ZKDL	;DATEI UEBERSCHREIBEN?
  6A7C*   CD 595C*       C      	CALL	UR.MIMO
  6A7F*   D8             C      	RET	C
  6A80*   7E             C      	LD	A,(HL)
  6A81*   FE 4A          C      	CP	'J'
  6A83*   C0             C      	RET	NZ
  6A84*   CD 67ED*       C      	CALL	FD.POSK
  6A87*   CD 6900*       C      	CALL	FD.FDOWR
  6A8A*   CD 6ABD*       C      	CALL	FD.DSPBB
  6A8D*   CD 6AD7*       C      	CALL	FD.RDEND
  6A90*   CD 6ACD*       C      	CALL	FD.DSPBG
  6A93*   18 DD          C      	JR	$-33
                         C      ;**********************************************************************
                         C      ;      Eingabeprogramm
                         C      ;**********************************************************************
  6A95*   6A95*          C      	DW	$
  6A97*   45 49 4E 20    C      	DB	'EIN '
  6A9B*                  C      FD.FDIN2:
  6A9B*   CD 6992*       C      	CALL	FD.FSTRT
  6A9E*   3A 2B26*       C      	LD	A,(UB.PAR1)
'Ein-/Ausgabe im freien Format'	MACRO-80 3.44	09-Dec-81	PAGE	1-64


  6AA1*   FE 4A          C      	CP	'J'
  6AA3*   28 07          C      	JR	Z,$+9
  6AA5*   3E 91          C      	LD	A,91H
  6AA7*   CD 5D5A*       C      	CALL	UF.ERANZ
  6AAA*   18 C6          C      	JR	FD.END
  6AAC*   CD 67ED*       C      	CALL	FD.POSK
  6AAF*   CD 6859*       C      	CALL	FD.FDINP
  6AB2*   CD 6ABD*       C      	CALL	FD.DSPBB
  6AB5*   CD 6AD7*       C      	CALL	FD.RDEND
  6AB8*   CD 6ACD*       C      	CALL	FD.DSPBG
  6ABB*   18 B5          C      	JR	FD.END
                         C      ;----------------------------------------------------------------------
  6ABD*                  C      FD.DSPBB:
  6ABD*   CD 5601*       C      	CALL	XY.LDDX
  6AC0*   11             C      	DB	17
  6AC1*   EB             C      	EX	DE,HL
  6AC2*   21 5FF0*       C      	LD	HL,UA.ZKBEL
  6AC5*   CD 595C*       C      	CALL	UR.MIMO
  6AC8*   EB             C      	EX	DE,HL
  6AC9*   CD 5718*       C      	CALL	UC.CVBD3
  6ACC*   C9             C      	RET
  6ACD*                  C      FD.DSPBG:
  6ACD*   CD 5601*       C      	CALL	XY.LDDX
  6AD0*   11             C      	DB	17
  6AD1*   EB             C      	EX	DE,HL
  6AD2*   21 6003*       C      	LD	HL,UA.ZKBLG
  6AD5*   18 EE          C      	JR	$-16
  6AD7*                  C      FD.RDEND:
  6AD7*   CD 61A2*       C      	CALL	UK.KBW
  6ADA*   DD 7E 0A       C      	LD	A,(IX+10)	;Laenge = 1, dann BM
  6ADD*   FE 01          C      	CP	1
  6ADF*   C8             C      	RET	Z
  6AE0*   18 F5          C      	JR	FD.RDEND
  6AE2*                  C      FD.BMGF:
  6AE2*   3E 95          C      	LD	A,95H
  6AE4*   CD 5D5A*       C      	CALL	UF.ERANZ
  6AE7*   D1             C      	POP	DE
  6AE8*   D1             C      	POP	DE
  6AE9*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Laden von MRES-P-Dateien'
                         C      	PAGE
'Laden von MRES-P-Dateien'	MACRO-80 3.44	09-Dec-81	PAGE	1-65


                         C      
                         C      ;	PN	LD
                         C      ;***********************************************************
                         C      ;
                         C      ;        Laden von MRES-P-Dateien
                         C      ;
                         C      ;***********************************************************
  6AEA*   6AEA*          C      	DW	$
  6AEC*   4C 4F 41 44    C      	DB	'LOAD'
  6AF0*   3A 3327        C      	LD	A,(UE.BWSA + 10*80 +7)	;327H
  6AF3*   CD 55C5*       C      	CALL	U1.TST
  6AF6*   D8             C      	RET	C
  6AF7*   CD 54E2*       C      	CALL	U1.KTINI
  6AFA*   DD 77 03       C      	LD	(IX+3),A
  6AFD*   CD 55B1*       C      	CALL	U1.BILO
  6B00*   3E 0D          C      	LD	A,13
  6B02*   32 2B00*       C      	LD	(UB.ZN),A
  6B05*                  C      LD.DATN:
  6B05*   21 5F4B*       C      	LD	HL,UA.ZKDAT	;Dateiname ?
  6B08*   CD 595C*       C      	CALL	UR.MIMO
  6B0B*   D8             C      	RET	C
  6B0C*   CD 609A*       C      	CALL	UR.KRE
  6B0F*   CD 60A8*       C      	CALL	UR.KRWW
  6B12*   CD 5496*       C      	CALL	U1.DSVG
  6B15*   3E 01          C      	LD	A,01H
  6B17*   B8             C      	CP	B
  6B18*   28 0A          C      	JR	Z,LD.LD21	;NEU INITIALISIERTE KASSETTE
  6B1A*                  C      LD.LD2:
  6B1A*   CD 61A2*       C      	CALL	UK.KBW
  6B1D*   CD 54C7*       C      	CALL	U1.NMVGL	;Dateiname vergleichen
  6B20*   38 08          C      	JR	C,LD.DATFU	;---> Datei gefunden
  6B22*   10 F6          C      	DJNZ	LD.LD2
  6B24*                  C      LD.LD21:
  6B24*   3E 91          C      	LD	A,91H	;Datei nicht vorhanden
  6B26*   CD 5D5A*       C      	CALL	UF.ERANZ	;FEHLERANZEIGE
  6B29*   C9             C      	RET
  6B2A*                  C      LD.DATFU:
  6B2A*   3A 0E6B        C      	LD	A,(UE.PUF+6)	;TYP
  6B2D*   FE 4F          C      	CP	'O'
  6B2F*   F5             C      	PUSH	AF
  6B30*   21 0E7C        C      	LD	HL,UE.PUF+23
  6B33*   7E             C      	LD	A,(HL)
  6B34*   F5             C      	PUSH	AF
  6B35*   47             C      	LD	B,A
  6B36*   04             C      	INC	B
  6B37*   CD 60DF*       C      	CALL	UR.POSIK	;Positionieren
  6B3A*   CD 61A2*       C      	CALL	UK.KBW
  6B3D*   F1             C      	POP	AF
  6B3E*   21 0E65        C      	LD	HL,UE.PUF
  6B41*   BE             C      	CP	(HL)
  6B42*   28 07          C      	JR	Z,LD.DATPO	;Datei richtig positioniert
  6B44*   F1             C      	POP	AF
  6B45*   3E 94          C      	LD	A,94H
  6B47*   CD 5D5A*       C      	CALL	UF.ERANZ
  6B4A*   C9             C      	RET
  6B4B*                  C      LD.DATPO:
  6B4B*   F1             C      	POP	AF
  6B4C*   CA 6BE1*       C      	JP	Z,RL.BEG
  6B4F*   3A 3329        C      	LD	A,(UE.BWSA+329H)
  6B52*   FE 56          C      	CP	'V'
  6B54*   20 57          C      	JR	NZ,LD.LD3
  6B56*   21 5F5E*       C      	LD	HL,UA.ZKLAD	;Ladeadresse ?
  6B59*   CD 595C*       C      	CALL	UR.MIMO
  6B5C*   DA 6B05*       C      	JP	C,LD.DATN
  6B5F*   CD 55CF*       C      	CALL	U1.PRADR	;ADRESSE EINGEGEBEN
  6B62*   38 F2          C      	JR	C,$-12
  6B64*   EB             C      	EX	DE,HL
  6B65*   21 2B26*       C      	LD	HL,UB.PAR1
  6B68*   CD 5705*       C      	CALL	UC.CVXA
  6B6B*                  C      LD.LD4:
  6B6B*   CD 617F*       C      	CALL	UK.KLPFB
  6B6E*   CD 6142*       C      	CALL	UK.GETK
  6B71*   CD 6142*       C      	CALL	UK.GETK
  6B74*   67             C      	LD	H,A
  6B75*   CD 6142*       C      	CALL	UK.GETK
  6B78*   6F             C      	LD	L,A
  6B79*   7A             C      	LD	A,D
  6B7A*   B3             C      	OR	E
  6B7B*   28 09          C      	JR	Z,LD.LD5
  6B7D*   ED 5B 2B26*    C      	LD	DE,(UB.PAR1)
  6B81*   EB             C      	EX	DE,HL
  6B82*   B7             C      	OR	A
'Laden von MRES-P-Dateien'	MACRO-80 3.44	09-Dec-81	PAGE	1-66


  6B83*   ED 52          C      	SBC	HL,DE
  6B85*   EB             C      	EX	DE,HL	;DE:= Verschiebung zur ersten
  6B86*                  C      LD.LD5:
  6B86*   CD 60D0*       C      	CALL	UR.KBR
  6B89*   CD 6BB2*       C      	CALL	LD.LADER
  6B8C*   22 2B28*       C      	LD	(UB.PAR2),HL
  6B8F*   21 3329        C      	LD	HL,UE.BWSA+329H
  6B92*   06 04          C      	LD	B,4
  6B94*   7E             C      	LD	A,(HL)
  6B95*   FE 53          C      	CP	'S'
  6B97*   28 0A          C      	JR	Z,LD.START
  6B99*   23             C      	INC	HL
  6B9A*   10 F8          C      	DJNZ	$-6
  6B9C*   CD 60A2*       C      	CALL	UR.KRW
  6B9F*   CD 60AC*       C      	CALL	UR.KRA
  6BA2*   C9             C      	RET
  6BA3*                  C      LD.START:
  6BA3*   CD 60A2*       C      	CALL	UR.KRW
  6BA6*   CD 60AC*       C      	CALL	UR.KRA
  6BA9*   2A 2B28*       C      	LD	HL,(UB.PAR2)
  6BAC*   E9             C      	JP	(HL)
  6BAD*                  C      LD.LD3:
  6BAD*   11 0000        C      	LD	DE,0
  6BB0*   18 B9          C      	JR	LD.LD4
                         C      ;--------------------------------------------------------------
  6BB2*                  C      LD.LADER:
  6BB2*   CD 617F*       C      	CALL	UK.KLPFB
  6BB5*                  C      LD.LAD2:
  6BB5*   CD 6142*       C      	CALL	UK.GETK
  6BB8*   FE 00          C      	CP	0
  6BBA*   28 16          C      	JR	Z,LD.LDEND
  6BBC*   47             C      	LD	B,A
  6BBD*   CD 6142*       C      	CALL	UK.GETK
  6BC0*   67             C      	LD	H,A
  6BC1*   CD 6142*       C      	CALL	UK.GETK
  6BC4*   6F             C      	LD	L,A
  6BC5*   19             C      	ADD	HL,DE
  6BC6*                  C      LD.LAD1:
  6BC6*   CD 6142*       C      	CALL	UK.GETK
  6BC9*   77             C      	LD	(HL),A
  6BCA*   BE             C      	CP	(HL)
  6BCB*   20 0E          C      	JR	NZ,LD.LADF
  6BCD*   23             C      	INC	HL
  6BCE*   10 F6          C      	DJNZ	LD.LAD1
  6BD0*   18 E3          C      	JR	LD.LAD2
  6BD2*                  C      LD.LDEND:
  6BD2*   CD 6142*       C      	CALL	UK.GETK
  6BD5*   67             C      	LD	H,A
  6BD6*   CD 6142*       C      	CALL	UK.GETK
  6BD9*   6F             C      	LD	L,A
  6BDA*   C9             C      	RET
  6BDB*                  C      LD.LADF:
  6BDB*   3E 93          C      	LD	A,93H
  6BDD*   CD 5D5A*       C      	CALL	UF.ERANZ
  6BE0*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Relativloader fuer O-Dateien'
                         C      	PAGE
'Relativloader fuer O-Dateien'	MACRO-80 3.44	09-Dec-81	PAGE	1-67


                         C      
                         C      ;	PN	RL
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;     RELATIVLOADER FUER O-DATEIEN
                         C      ;
                         C      ;----------------------------------------------------------------------
  6BE1*                  C      RL.BEG:
  6BE1*   21 5F71*       C      	LD	HL,UA.ZKBEG	;BEGINN ?
  6BE4*   CD 595C*       C      	CALL	UR.MIMO
  6BE7*   DA 6B05*       C      	JP	C,LD.DATN
  6BEA*   CD 55CF*       C      	CALL	U1.PRADR
  6BED*   38 F2          C      	JR	C,RL.BEG
  6BEF*   EB             C      	EX	DE,HL
  6BF0*   21 2B30*       C      	LD	HL,UB.PATAB
  6BF3*   CD 5705*       C      	CALL	UC.CVXA
  6BF6*                  C      RL.UG:
  6BF6*   CD 61A2*       C      	CALL	UK.KBW
  6BF9*   2A 2B30*       C      	LD	HL,(UB.PATAB)	;BGADR---->HL
  6BFC*   0E 01          C      	LD	C,001H	;LADEN BLOCKZAEHLER MIT
                         C      			;ANFANGSWERT
  6BFE*   CD 6C89*       C      	CALL	RL.UP6	; AUFRUF EINGABE-UP
                         C      ;********** TEST BEFEHLSKENNZEICHENBYTE *******************************
  6C01*                  C      RL.M16:
  6C01*   CB 5A          C      	BIT	3,D	;TEST ORG-BEFEHL
  6C03*   C2 6CDD*       C      	JP	NZ,RL.OB	;JA--->FEHLER
  6C06*   CB 62          C      	BIT	4,D	;TEST BER -BEFEHL
  6C08*   C2 6C72*       C      	JP	NZ,RL.M10
  6C0B*   3E 07          C      	LD	A,007H
  6C0D*   A2             C      	AND	D	;TEST BEFEHLS LAENGE=0 ?
  6C0E*   CA 6C83*       C      	JP	Z,RL.M11
  6C11*   47             C      	LD	B,A	;BEFEHLSLAENGE-->B
  6C12*                  C      RL.M12:
  6C12*   CD 6C89*       C      	CALL	RL.UP6
  6C15*   72             C      	LD	(HL),D
  6C16*   23             C      	INC	HL
  6C17*   10 F9          C      	DJNZ	RL.M12	;EINGABE BEFEHL
  6C19*   CD 6C89*       C      	CALL	RL.UP6
  6C1C*   CB 7A          C      	BIT	7,D	;TEST BEFEHLSKENNZEICHENBYTE ?
  6C1E*   20 E1          C      	JR	NZ,RL.M16	; JA
                         C      ;******* TEST ADRESSKENNZEICHENBYTE ***********************************
  6C20*   CB 6A          C      	BIT	5,D	;TEST OB REL.ADR. FOLGT
  6C22*   CA 6CE1*       C      	JP	Z,RL.RA	;NEIN-->FEHLER
  6C25*   CB 72          C      	BIT	6,D	;FOLGT BEZUGNAHME AUF
                         C      			;SYMBOLVERZEICHNIS
  6C27*   C2 6CE5*       C      	JP	NZ,RL.SV	;JA--->FEHLER
  6C2A*   CB 52          C      	BIT	2,D	;MINUS ?
  6C2C*   C2 6CE9*       C      	JP	NZ,RL.MN
  6C2F*                  C      RL.M17:
  6C2F*   3E 03          C      	LD	A,003H
  6C31*   A2             C      	AND	D	;TEST ADRESSLAENGE
  6C32*   F5             C      	PUSH	AF
  6C33*   E5             C      	PUSH	HL
  6C34*   CD 6C89*       C      	CALL	RL.UP6
  6C37*   62             C      	LD	H,D	;ADRESSE ---->HL
  6C38*   CD 6C89*       C      	CALL	RL.UP6
  6C3B*   6A             C      	LD	L,D
  6C3C*   C5             C      	PUSH	BC
  6C3D*   E5             C      	PUSH	HL
  6C3E*   21 2B30*       C      	LD	HL,UB.PATAB
  6C41*   4E             C      	LD	C,(HL)	;BEGINN(LADE)ADRESSE--->BC
  6C42*   23             C      	INC	HL
  6C43*   46             C      	LD	B,(HL)
  6C44*   E1             C      	POP	HL
  6C45*   09             C      	ADD	HL,BC	;ERMITTELN SPEICHERADRESSE
  6C46*   EB             C      	EX	DE,HL	;SP.ADR.--->DE
  6C47*   C1             C      	POP	BC
  6C48*   E1             C      	POP	HL
  6C49*   F1             C      	POP	AF
  6C4A*   28 04          C      	JR	Z,RL.M13
  6C4C*   CB 47          C      	BIT	0,A	;NUR L-TEIL DER ADRESSE ?
  6C4E*   28 10          C      	JR	Z,RL.M14	; JA
                         C      ;********** ADRESSE IN SPEICHER EINTRAGEN *****************************
  6C50*                  C      RL.M13:
  6C50*   73             C      	LD	(HL),E
  6C51*   F5             C      	PUSH	AF
  6C52*   7B             C      	LD	A,E
  6C53*   BE             C      	CP	(HL)
  6C54*   C2 6CD4*       C      	JP	NZ,RL.ECHO
  6C57*   F1             C      	POP	AF
  6C58*   23             C      	INC	HL
  6C59*   FE 03          C      	CP	003H
'Relativloader fuer O-Dateien'	MACRO-80 3.44	09-Dec-81	PAGE	1-68


  6C5B*   28 03          C      	JR	Z,RL.M14
  6C5D*   B7             C      	OR	A	;NUR H-TEIL DER ADRESSE ?
  6C5E*   20 08          C      	JR	NZ,RL.M15	; JA
  6C60*                  C      RL.M14:
  6C60*   72             C      	LD	(HL),D
  6C61*   F5             C      	PUSH	AF
  6C62*   7A             C      	LD	A,D
  6C63*   BE             C      	CP	(HL)
  6C64*   20 6E          C      	JR	NZ,RL.ECHO
  6C66*   F1             C      	POP	AF
  6C67*   23             C      	INC	HL
  6C68*                  C      RL.M15:
  6C68*   CD 6C89*       C      	CALL	RL.UP6
  6C6B*   CB 7A          C      	BIT	7,D	; TEST BEFEHLSKENNZEICHENBYTE
  6C6D*   20 92          C      	JR	NZ,RL.M16
  6C6F*   C3 6CED*       C      	JP	RL.BF	; NEIN--->FEHLER
                         C      ;----------------------------------------------------------------------
  6C72*                  C      RL.M10:
  6C72*   CD 6C89*       C      	CALL	RL.UP6	;BEI BER-BEFEHL ADDIEREN DER
  6C75*   D5             C      	PUSH	DE	;DEF. BEREICHSLAENGE ZU
  6C76*   CD 6C89*       C      	CALL	RL.UP6	;ADRESSE
  6C79*   7A             C      	LD	A,D
  6C7A*   D1             C      	POP	DE
  6C7B*   5F             C      	LD	E,A
  6C7C*   19             C      	ADD	HL,DE
  6C7D*   CD 6C89*       C      	CALL	RL.UP6
  6C80*   C3 6C01*       C      	JP	RL.M16
  6C83*                  C      RL.M11:
  6C83*   CD 6C89*       C      	CALL	RL.UP6	;BEI BFL=0 SPRUNG ZUM TEST
  6C86*   C3 6C2F*       C      	JP	RL.M17	;ADRESSKENNZEICHENBYTE
                         C      ;******* UP ZUR ZEICHENWEISE EINGABE DER O-DATEI **********************
  6C89*                  C      RL.UP6:
  6C89*   CD 6142*       C      	CALL	UK.GETK
  6C8C*   57             C      	LD	D,A
  6C8D*   0D             C      	DEC	C	;REDUZIEREN BLOCKLAENGE
  6C8E*   C0             C      	RET	NZ		;RET BEI UNGLEICH NULL
  6C8F*   A7             C      	AND	A	;IST NAECHSTE BLOCKLAENGE NULL ?
  6C90*   28 04          C      	JR	Z,RL.M21	;JA-->VERZWEIGUNG ENDEBEH
  6C92*   4F             C      	LD	C,A	;NEIN-->EINTRAGEN BLKLAENGE
  6C93*   0C             C      	INC	C
  6C94*   18 F3          C      	JR	RL.UP6
                         C      ;*********** ENDEBEHANDLUNG *******************************************
  6C96*                  C      RL.M21:
  6C96*   D1             C      	POP	DE
  6C97*   E5             C      	PUSH	HL
  6C98*   3E 0F          C      	LD	A,15
  6C9A*   32 2B00*       C      	LD	(UB.ZN),A
  6C9D*   21 5F87*       C      	LD	HL,UA.ZKEND+3
  6CA0*   11 3460        C      	LD	DE,3460H
  6CA3*   01 0010        C      	LD	BC,16
  6CA6*   ED B0          C      	LDIR
  6CA8*   21 2B00*       C      	LD	HL,UB.ZN
  6CAB*   34             C      	INC	(HL)
  6CAC*   E1             C      	POP	HL
  6CAD*   2B             C      	DEC	HL
  6CAE*   11 3470        C      	LD	DE,3470H	;HINTER AUSSCHRIFT ENDE
  6CB1*   CD 56BF*       C      	CALL	UC.CVHLX
  6CB4*   21 5F97*       C      	LD	HL,UA.STADR	;STARTADRESSE ?
  6CB7*   CD 595C*       C      	CALL	UR.MIMO
  6CBA*   D8             C      	RET	C
  6CBB*   EB             C      	EX	DE,HL
  6CBC*   21 2B32*       C      	LD	HL,UB.PATAB+2
  6CBF*   CD 5705*       C      	CALL	UC.CVXA	;STARTADR.-->BINAER
  6CC2*   3A 3329        C      	LD	A,(UE.BWSA+329H)
  6CC5*   FE 53          C      	CP	'S'
  6CC7*   20 04          C      	JR	NZ,$+6
  6CC9*   2A 2B32*       C      	LD	HL,(UB.PATAB+2)
  6CCC*   E9             C      	JP	(HL)
  6CCD*   CD 60A2*       C      	CALL	UR.KRW
  6CD0*   CD 60AC*       C      	CALL	UR.KRA
  6CD3*   C9             C      	RET
                         C      ;---------------------------------------------------------------------
  6CD4*                  C      RL.ECHO:
  6CD4*   D1             C      	POP	DE
  6CD5*   3E 93          C      	LD	A,93H
  6CD7*   18 16          C      	JR	RL.FMELD
  6CD9*                  C      RL.DATNV:
  6CD9*   3E 91          C      	LD	A,91H
  6CDB*   18 12          C      	JR	RL.FMELD
  6CDD*                  C      RL.OB:
  6CDD*   3E 96          C      	LD	A,96H
  6CDF*   18 0E          C      	JR	RL.FMELD
  6CE1*                  C      RL.RA:
'Relativloader fuer O-Dateien'	MACRO-80 3.44	09-Dec-81	PAGE	1-69


  6CE1*   3E 97          C      	LD	A,97H
  6CE3*   18 0A          C      	JR	RL.FMELD
  6CE5*                  C      RL.SV:
  6CE5*   3E 98          C      	LD	A,98H
  6CE7*   18 06          C      	JR	RL.FMELD
  6CE9*                  C      RL.MN:
  6CE9*   3E 99          C      	LD	A,99H
  6CEB*   18 02          C      	JR	RL.FMELD
  6CED*                  C      RL.BF:
  6CED*   3E 9A          C      	LD	A,9AH
  6CEF*                  C      RL.FMELD:
  6CEF*   CD 5D5A*       C      	CALL	UF.ERANZ
  6CF2*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Retten von Maschinencodeprogrammen als MRES - P-Datei'
                         C      	PAGE
'Retten von Maschinencodeprogrammen als MRES - P-Datei'	MACRO-80 3.44	09-Dec-81	PAGE	1-70


                         C      
                         C      ;	PN	SV
                         C      ;**********************************************************************
                         C      ;
                         C      ;      Retten von Maschinencodeprogrammen als MRES - P-Datei
                         C      ;
                         C      ;**********************************************************************
  6CF3*   6CF3*          C      	DW	$
  6CF5*   53 41 56 45    C      	DB	'SAVE'
  6CF9*   3A 3327        C      	LD	A,(UE.BWSA+ 10*80 +7)	;327H
  6CFC*   CD 55C5*       C      	CALL	U1.TST
  6CFF*   D8             C      	RET	C
  6D00*   CD 54E2*       C      	CALL	U1.KTINI
  6D03*   DD 77 03       C      	LD	(IX+3),A
  6D06*   AF             C      	XOR	A
  6D07*   32 2B27*       C      	LD	(UB.PAR1+1),A
  6D0A*   CD 55B1*       C      	CALL	U1.BILO	;BS LOESCHEN
  6D0D*   CD 609A*       C      	CALL	UR.KRE
  6D10*   DD CB 00 56    C      	BIT	2,(IX)
  6D14*   28 05          C      	JR	Z,$+7
  6D16*   3E 19          C      	LD	A,19H
  6D18*   CD 5D5A*       C      	CALL	UF.ERANZ
  6D1B*   CD 60A8*       C      	CALL	UR.KRWW
  6D1E*                  C      SV.SV20:
  6D1E*   CD 5496*       C      	CALL	U1.DSVG
  6D21*   C5             C      	PUSH	BC
  6D22*   79             C      	LD	A,C
  6D23*   32 2B26*       C      	LD	(UB.PAR1),A	;NEXT RECORD
  6D26*   3E 0D          C      	LD	A,13
  6D28*   32 2B00*       C      	LD	(UB.ZN),A
  6D2B*                  C      SV.DATN:
  6D2B*   21 5F4B*       C      	LD	HL,UA.ZKDAT	;Dateiname ?
  6D2E*   CD 595C*       C      	CALL	UR.MIMO
  6D31*   D8             C      	RET	C
  6D32*   C1             C      	POP	BC
  6D33*   05             C      	DEC	B
  6D34*   28 1A          C      	JR	Z,SV.SV30	;NEUE KASSETTE
  6D36*                  C      SV.SV21:
  6D36*   CD 61A2*       C      	CALL	UK.KBW
  6D39*   CD 54C7*       C      	CALL	U1.NMVGL
  6D3C*   38 04          C      	JR	C,SV.DATV1	;Dateiname bereits vorhanden
  6D3E*   10 F6          C      	DJNZ	SV.SV21
  6D40*   18 0E          C      	JR	SV.SV30
  6D42*                  C      SV.DATV1:
  6D42*   3E 01          C      	LD	A,01H
  6D44*   B8             C      	CP	B
  6D45*   CC 6E8E*       C      	CALL	Z,SV.DALO1
  6D48*   28 0E          C      	JR	Z,SV.SV37
  6D4A*                  C      SV.DATVO:
  6D4A*   3E 92          C      	LD	A,92H
  6D4C*   CD 5D5A*       C      	CALL	UF.ERANZ
  6D4F*   C9             C      	RET
  6D50*                  C      SV.SV30:
  6D50*   3E 50          C      	LD	A,'P'
  6D52*   32 2B28*       C      	LD	(UB.PAR2),A
  6D55*   CD 554E*       C      	CALL	U1.VZS
  6D58*                  C      SV.SV37:
  6D58*   3A 2B27*       C      	LD	A,(UB.PAR1+1)
  6D5B*   FE 4C          C      	CP	'L'
  6D5D*   20 0B          C      	JR	NZ,SV.SV31
  6D5F*   21 5FAA*       C      	LD	HL,UA.ZKDL
  6D62*   CD 595C*       C      	CALL	UR.MIMO
  6D65*   7E             C      	LD	A,(HL)
  6D66*   FE 4A          C      	CP	'J'
  6D68*   20 E0          C      	JR	NZ,SV.DATVO
  6D6A*                  C      SV.SV31:
  6D6A*   3A 2B26*       C      	LD	A,(UB.PAR1)	;NEXT RECORD
  6D6D*   47             C      	LD	B,A
  6D6E*   C5             C      	PUSH	BC
  6D6F*   04             C      	INC	B
  6D70*   CD 60DF*       C      	CALL	UR.POSIK
  6D73*   CD 61A2*       C      	CALL	UK.KBW
  6D76*   21 0E65        C      	LD	HL,UE.PUF
  6D79*   C1             C      	POP	BC
  6D7A*   7E             C      	LD	A,(HL)
  6D7B*   B8             C      	CP	B
  6D7C*   28 06          C      	JR	Z,SV.SAVE3
  6D7E*   3E 94          C      	LD	A,94H
  6D80*   CD 5D5A*       C      	CALL	UF.ERANZ
  6D83*   C9             C      	RET
  6D84*                  C      SV.SAVE3:
  6D84*   21 5F71*       C      	LD	HL,UA.ZKBEG	;Beginn ?
'Retten von Maschinencodeprogrammen als MRES - P-Datei'	MACRO-80 3.44	09-Dec-81	PAGE	1-71


  6D87*   CD 595C*       C      	CALL	UR.MIMO
  6D8A*   DA 6D2B*       C      	JP	C,SV.DATN
  6D8D*   CD 55CF*       C      	CALL	U1.PRADR
  6D90*   38 F2          C      	JR	C,SV.SAVE3
  6D92*   EB             C      	EX	DE,HL
  6D93*   21 2B28*       C      	LD	HL,UB.PAR2
  6D96*   CD 5705*       C      	CALL	UC.CVXA
  6D99*                  C      SV.SAVE4:
  6D99*   21 5F84*       C      	LD	HL,UA.ZKEND	;Ende ?
  6D9C*   CD 595C*       C      	CALL	UR.MIMO
  6D9F*   38 E3          C      	JR	C,SV.SAVE3
  6DA1*   CD 55CF*       C      	CALL	U1.PRADR
  6DA4*   38 F3          C      	JR	C,SV.SAVE4
  6DA6*   EB             C      	EX	DE,HL
  6DA7*   21 2B2A*       C      	LD	HL,UB.PAR3
  6DAA*   CD 5705*       C      	CALL	UC.CVXA
  6DAD*   CD 6DFD*       C      	CALL	SV.BYANZ
  6DB0*   38 D2          C      	JR	C,SV.SAVE3
  6DB2*   28 D0          C      	JR	Z,SV.SAVE3
  6DB4*   CD 6E22*       C      	CALL	SV.SAVE
  6DB7*   CD 60BE*       C      	CALL	UR.KBM
  6DBA*   CD 6E08*       C      	CALL	SV.DATS1	;1.DATEISATZ SCHREIBEN
  6DBD*   CD 60C4*       C      	CALL	UR.KSL
  6DC0*   CD 60A8*       C      	CALL	UR.KRWW
  6DC3*   CD 5496*       C      	CALL	U1.DSVG
  6DC6*   05             C      	DEC	B
  6DC7*   3A 2B27*       C      	LD	A,(UB.PAR1+1)
  6DCA*   FE 4C          C      	CP	'L'
  6DCC*   28 13          C      	JR	Z,SV.SAVE5
  6DCE*   21 0E66        C      	LD	HL,UE.PUF+1
  6DD1*   34             C      	INC	(HL)	;NEXT RECORD+1
  6DD2*   21 0E68        C      	LD	HL,UE.PUF+3
  6DD5*   46             C      	LD	B,(HL)
  6DD6*   34             C      	INC	(HL)	;ANZ.VERZ.EINTR.+1
  6DD7*                  C      SV.SAVE6:
  6DD7*   CD 60D0*       C      	CALL	UR.KBR
  6DDA*   DD 36 04 08    C      	LD	(IX+4),08H	;NEUEN DS-SATZ AUSGEBEN
  6DDE*   CD 5D2A*       C      	CALL	UF.EXEC
  6DE1*                  C      SV.SAVE5:
  6DE1*   CD 61A2*       C      	CALL	UK.KBW
  6DE4*   10 FB          C      	DJNZ	SV.SAVE5
  6DE6*   CD 60D0*       C      	CALL	UR.KBR
  6DE9*   2A 2B2E*       C      	LD	HL,(UB.PAR5)
  6DEC*   22 0E7E        C      	LD	(UE.PUF+25),HL	;DATEILAENGE EINTRAGEN
  6DEF*   DD 36 04 08    C      	LD	(IX+4),08H
  6DF3*   CD 5D2A*       C      	CALL	UF.EXEC
  6DF6*   CD 60A2*       C      	CALL	UR.KRW
  6DF9*   CD 60AC*       C      	CALL	UR.KRA
  6DFC*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  6DFD*                  C      SV.BYANZ:
  6DFD*   2A 2B2A*       C      	LD	HL,(UB.PAR3)	;Byteanzahl berechnen
  6E00*   ED 5B 2B28*    C      	LD	DE,(UB.PAR2)
  6E04*   B7             C      	OR	A
  6E05*   ED 52          C      	SBC	HL,DE
  6E07*   C9             C      	RET
  6E08*                  C      SV.DATS1:
  6E08*   21 0020        C      	LD	HL,32	;1. Dateisatz schreiben
  6E0B*   CD 5631*       C      	CALL	XY.STIDX
  6E0E*   09             C      	DB	9
  6E0F*   CD 5486*       C      	CALL	U1.VSX
  6E12*   21 0E65        C      	LD	HL,UE.PUF
  6E15*   3A 2B26*       C      	LD	A,(UB.PAR1)	;NEXT RECORD
  6E18*   3C             C      	INC	A
  6E19*   77             C      	LD	(HL),A
  6E1A*   DD 36 04 08    C      	LD	(IX+4),08H
  6E1E*   CD 5D2A*       C      	CALL	UF.EXEC
  6E21*   C9             C      	RET
  6E22*                  C      SV.SAVE:
  6E22*   21 0000        C      	LD	HL,0
  6E25*   CD 5621*       C      	CALL	XY.STDX
  6E28*   11             C      	DB	17
  6E29*   21 0080        C      	LD	HL,80H	;Blocklaenge
  6E2C*   CD 5631*       C      	CALL	XY.STIDX
  6E2F*   09             C      	DB	9
  6E30*   CD 620A*       C      	CALL	UK.KSPFB	;Pufferbereitstellung
  6E33*                  C      SV.SAVE1:
  6E33*   CD 6DFD*       C      	CALL	SV.BYANZ	;Byteanzahl berechnen
  6E36*   23             C      	INC	HL
  6E37*   E5             C      	PUSH	HL
  6E38*   7C             C      	LD	A,H
  6E39*   B5             C      	OR	L
  6E3A*   E1             C      	POP	HL
'Retten von Maschinencodeprogrammen als MRES - P-Datei'	MACRO-80 3.44	09-Dec-81	PAGE	1-72


  6E3B*   28 13          C      	JR	Z,SV.SVLS2	;---> 0 Byte
  6E3D*   01 007D        C      	LD	BC,UE.SVL	;Satzlaenge
  6E40*   B7             C      	OR	A
  6E41*   ED 42          C      	SBC	HL,BC
  6E43*   38 05          C      	JR	C,SV.SVLS	;---> letzter Satz
  6E45*   CD 6E99*       C      	CALL	SV.SVSZ
  6E48*   18 E9          C      	JR	SV.SAVE1
  6E4A*                  C      SV.SVLS:
  6E4A*   7D             C      	LD	A,L
  6E4B*   C6 7D          C      	ADD	A,UE.SVL	;A:= Laenge des letzten Satzes
  6E4D*   CD 6E9B*       C      	CALL	SV.SVSZ2
  6E50*                  C      SV.SVLS2:
  6E50*   AF             C      	XOR	A
  6E51*   CD 61E6*       C      	CALL	UK.PUTK
  6E54*   21 5F97*       C      	LD	HL,UA.STADR	;Startadresse
  6E57*   CD 595C*       C      	CALL	UR.MIMO
  6E5A*   7E             C      	LD	A,(HL)
  6E5B*   FE 20          C      	CP	' '
  6E5D*   28 27          C      	JR	Z,SV.STAD0	;KEINE EINGABE (0000)
  6E5F*   EB             C      	EX	DE,HL
  6E60*   21 2B2C*       C      	LD	HL,UB.PAR4
  6E63*   CD 5705*       C      	CALL	UC.CVXA
  6E66*                  C      SV.SVLS1:
  6E66*   2A 2B2C*       C      	LD	HL,(UB.PAR4)
  6E69*   7C             C      	LD	A,H	;Startadresse ausgeben
  6E6A*   CD 61E6*       C      	CALL	UK.PUTK
  6E6D*   7D             C      	LD	A,L
  6E6E*   CD 61E6*       C      	CALL	UK.PUTK
  6E71*   0E 03          C      	LD	C,3
  6E73*                  C      SV.SVEN2:
  6E73*   06 80          C      	LD	B,80H
  6E75*   AF             C      	XOR	A
  6E76*                  C      SV.SVEN1:
  6E76*   CD 61E6*       C      	CALL	UK.PUTK
  6E79*   10 FB          C      	DJNZ	SV.SVEN1
  6E7B*   0D             C      	DEC	C
  6E7C*   20 F5          C      	JR	NZ,SV.SVEN2
  6E7E*   CD 5601*       C      	CALL	XY.LDDX
  6E81*   11             C      	DB	17
  6E82*   22 2B2E*       C      	LD	(UB.PAR5),HL
  6E85*   C9             C      	RET
  6E86*                  C      SV.STAD0:
  6E86*   21 0000        C      	LD	HL,0
  6E89*   22 2B2C*       C      	LD	(UB.PAR4),HL
  6E8C*   18 D8          C      	JR	SV.SVLS1
  6E8E*                  C      SV.DALO1:
  6E8E*   F5             C      	PUSH	AF
  6E8F*   21 2B26*       C      	LD	HL,UB.PAR1
  6E92*   35             C      	DEC	(HL)
  6E93*   23             C      	INC	HL
  6E94*   3E 4C          C      	LD	A,'L'
  6E96*   77             C      	LD	(HL),A
  6E97*   F1             C      	POP	AF
  6E98*   C9             C      	RET
  6E99*                  C      SV.SVSZ:
  6E99*   3E 7D          C      	LD	A,UE.SVL
  6E9B*                  C      SV.SVSZ2:
  6E9B*   F5             C      	PUSH	AF
  6E9C*   CD 61E6*       C      	CALL	UK.PUTK
  6E9F*   ED 5B 2B28*    C      	LD	DE,(UB.PAR2)
  6EA3*   7A             C      	LD	A,D
  6EA4*   CD 61E6*       C      	CALL	UK.PUTK
  6EA7*   7B             C      	LD	A,E
  6EA8*   CD 61E6*       C      	CALL	UK.PUTK
  6EAB*   F1             C      	POP	AF
  6EAC*   47             C      	LD	B,A
  6EAD*                  C      SV.SVSZ1:
  6EAD*   1A             C      	LD	A,(DE)
  6EAE*   CD 61E6*       C      	CALL	UK.PUTK
  6EB1*   13             C      	INC	DE
  6EB2*   10 F9          C      	DJNZ	SV.SVSZ1
  6EB4*   ED 53 2B28*    C      	LD	(UB.PAR2),DE
  6EB8*   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                                ;
                                ;	INCLUDE	KX.MAC	;Kopieren von MRES-Kassetten Teil 1
                                ;	INCLUDE	KY.MAC	;Kopieren von MRES-Kassetten Teil 2
                                ;	INCLUDE	KU.MAC	;Unterprogramme fuer KOPI
                         C      	INCLUDE K4.MAC	;Kopieren MRES
                         C      	TITLE	'Kopieren von MRES-Kassetten Teil 1'
                         C      	PAGE
'Kopieren von MRES-Kassetten Teil 1'	MACRO-80 3.44	09-Dec-81	PAGE	1-73


                         C      
                         C      ;	PN	KX
                         C      ;------------------------------------------------------------------
                         C      ;
                         C      ;          KOPIEREN VON MRES-KASSETTEN       TEIL1
                         C      ;
                         C      ;----------------------------------------------------------------
  6EB9*   6EB9*          C      	DW	$
  6EBB*   4B 4F 50 49    C      	DB	'KOPI'
  6EBF*   CD 54E2*       C      	CALL	U1.KTINI
  6EC2*   11 E000        C      	LD	DE,BC.TAB1
  6EC5*   21 3327        C      	LD	HL,UE.BWSA + 10*80 +7	;327H
  6EC8*   7E             C      	LD	A,(HL)
  6EC9*   CD 55C5*       C      	CALL	U1.TST
  6ECC*   D8             C      	RET	C
  6ECD*   12             C      	LD	(DE),A
  6ECE*   23             C      	INC	HL
  6ECF*   EE 33          C      	XOR	33H
  6ED1*   BE             C      	CP	(HL)
  6ED2*   C0             C      	RET	NZ
  6ED3*   EE 30          C      	XOR	30H
  6ED5*   13             C      	INC	DE
  6ED6*   12             C      	LD	(DE),A
  6ED7*   3A 3326        C      	LD	A,(UE.BWSA + 10*80 +6)	;326H
  6EDA*   FE 4A          C      	CP	'J'
  6EDC*   28 05          C      	JR	Z,$+7	;BEI KOPIJ WERDEN WEITERE PARAMETER
  6EDE*   23             C      	INC	HL	;IGNORIERT
  6EDF*   23             C      	INC	HL
  6EE0*   7E             C      	LD	A,(HL)
  6EE1*   FE 20          C      	CP	20H
  6EE3*   F5             C      	PUSH	AF
  6EE4*   20 0C          C      	JR	NZ,$+14
  6EE6*   CD 546D*       C      	CALL	U1.EIN
  6EE9*   CD 55E6*       C      	CALL	U1.KRWE
  6EEC*   CD 5476*       C      	CALL	U1.AUS
  6EEF*   CD 55E6*       C      	CALL	U1.KRWE
  6EF2*   CD 702D*       C      	CALL	KX.UPA
  6EF5*   F1             C      	POP	AF
  6EF6*   28 13          C      	JR	Z,$+21
  6EF8*   FE 41          C      	CP	'A'
  6EFA*   28 0A          C      	JR	Z,$+12
  6EFC*   FE 4C          C      	CP	'L'
  6EFE*   20 0B          C      	JR	NZ,$+13
  6F00*   CD 5445*       C      	CALL	U1.COPB
  6F03*   C3 6FD3*       C      	JP	KX.RSPFR
  6F06*   CD 5441*       C      	CALL	U1.COPB2
  6F09*   18 FB          C      	JR	$-3
                         C      ;-------------------------------------------------------------------
  6F0B*   CD 546D*       C      	CALL	U1.EIN
  6F0E*   CD 5496*       C      	CALL	U1.DSVG
  6F11*   CD 5420*       C      	CALL	U1.KBR4
  6F14*   CD 542B*       C      	CALL	U1.BREAD
  6F17*   21 5E5D*       C      	LD	HL,UA.Z7E
  6F1A*   11 3163        C      	LD	DE,SD.BWSA +  4*80 + 35	;3163H
  6F1D*   01 001F        C      	LD	BC,31
  6F20*   ED B0          C      	LDIR
  6F22*   21 5E7C*       C      	LD	HL,UA.GER
  6F25*   11 31EA        C      	LD	DE,SD.BWSA +  6*80 + 10	;31EAH
  6F28*   CD 55AB*       C      	CALL	U1.INFO
  6F2B*   21 5E27*       C      	LD	HL,UA.KNAME+3
  6F2E*   11 323A        C      	LD	DE,SD.BWSA +  7*80 + 10	;323AH
  6F31*   CD 55AB*       C      	CALL	U1.INFO
  6F34*   21 5E3A*       C      	LD	HL,UA.NR+3
  6F37*   11 328A        C      	LD	DE,SD.BWSA +  8*80 + 10	;328AH
  6F3A*   CD 55AB*       C      	CALL	U1.INFO
  6F3D*   21 5E4D*       C      	LD	HL,UA.KOMMT+3
  6F40*   11 32DA        C      	LD	DE,SD.BWSA +  9*80 + 10	;32DAH
  6F43*   CD 55AB*       C      	CALL	U1.INFO
  6F46*   11 3203        C      	LD	DE,SD.BWSA +  6*80 + 35	;3203H
  6F49*   3A E000        C      	LD	A,(BC.TAB1)
  6F4C*   CD 56A5*       C      	CALL	UC.CVBX+2
  6F4F*   11 321B        C      	LD	DE,SD.BWSA +  6*80 + 59	;321BH
  6F52*   3A E001        C      	LD	A,(BC.TAB1+1)
  6F55*   CD 56A5*       C      	CALL	UC.CVBX+2
  6F58*   21 0E69        C      	LD	HL,UE.PUF+4
  6F5B*   11 3253        C      	LD	DE,SD.BWSA +  7*80 + 35	;3253H
  6F5E*   06 06          C      	LD	B,6
  6F60*   CD 57B0*       C      	CALL	UC.DKONV
  6F63*   21 0E8A        C      	LD	HL,UE.PUF+37
  6F66*   11 32A3        C      	LD	DE,SD.BWSA +  8*80 + 35	;32A3H
  6F69*   06 03          C      	LD	B,3
  6F6B*   CD 57B0*       C      	CALL	UC.DKONV
'Kopieren von MRES-Kassetten Teil 1'	MACRO-80 3.44	09-Dec-81	PAGE	1-74


  6F6E*   11 32F3        C      	LD	DE,SD.BWSA +  9*80 + 35	;32F3H
  6F71*   06 0B          C      	LD	B,11
  6F73*   CD 57B0*       C      	CALL	UC.DKONV
  6F76*   CD 60CA*       C      	CALL	UR.KBV
  6F79*   CD 60CA*       C      	CALL	UR.KBV
  6F7C*   CD 542B*       C      	CALL	U1.BREAD
  6F7F*   3A 0E68        C      	LD	A,(UE.PUF+3)
  6F82*   3D             C      	DEC	A
  6F83*   CA 6FDE*       C      	JP	Z,KX.ENDR
  6F86*   CD 5518*       C      	CALL	U1.VERIN
  6F89*   CD 5476*       C      	CALL	U1.AUS
  6F8C*   CD 5496*       C      	CALL	U1.DSVG
  6F8F*   CD 5420*       C      	CALL	U1.KBR4
  6F92*   DD 36 04 02    C      	LD	(IX+4),02H
  6F96*   CD 5D2A*       C      	CALL	UF.EXEC
  6F99*   21 0E69        C      	LD	HL,UE.PUF+4
  6F9C*   11 326B        C      	LD	DE,SD.BWSA +  7*80 + 59	;326BH
  6F9F*   06 06          C      	LD	B,6
  6FA1*   CD 57B0*       C      	CALL	UC.DKONV
  6FA4*   21 0E8A        C      	LD	HL,UE.PUF+37
  6FA7*   11 32BB        C      	LD	DE,SD.BWSA +  8*80 + 59	;32BBH
  6FAA*   06 03          C      	LD	B,3
  6FAC*   CD 57B0*       C      	CALL	UC.DKONV
  6FAF*   11 330B        C      	LD	DE,SD.BWSA +  9*80 + 59	;330BH
  6FB2*   06 0B          C      	LD	B,11
  6FB4*   CD 57B0*       C      	CALL	UC.DKONV
  6FB7*   CD 60CA*       C      	CALL	UR.KBV
  6FBA*   CD 60CA*       C      	CALL	UR.KBV
  6FBD*   DD 36 04 02    C      	LD	(IX+4),02H
  6FC1*   CD 5D2A*       C      	CALL	UF.EXEC
  6FC4*   CD 55B1*       C      	CALL	U1.BILO
  6FC7*   11 E002        C      	LD	DE,BC.VTABA
  6FCA*   CD 5520*       C      	CALL	U1.VERNI
  6FCD*   CD 553A*       C      	CALL	U1.VORST
  6FD0*   C3 704A*       C      	JP	KY.MD
  6FD3*                  C      KX.RSPFR:
  6FD3*   F5             C      	PUSH	AF
  6FD4*   23             C      	INC	HL
  6FD5*   23             C      	INC	HL
  6FD6*   7E             C      	LD	A,(HL)
  6FD7*   B7             C      	OR	A
  6FD8*   FE 52          C      	CP	'R'
  6FDA*   20 06          C      	JR	NZ,$+8
  6FDC*   18 01          C      	JR	$+3
  6FDE*                  C      KX.ENDR:
  6FDE*   F5             C      	PUSH	AF
  6FDF*   37             C      	SCF
  6FE0*   18 04          C      	JR	$+6
  6FE2*   FE 46          C      	CP	'F'
  6FE4*   20 15          C      	JR	NZ,$+23
  6FE6*   CD 546D*       C      	CALL	U1.EIN
  6FE9*   DC 60A2*       C      	CALL	C,UR.KRW
  6FEC*   CD 60AC*       C      	CALL	UR.KRA
  6FEF*   CD 5476*       C      	CALL	U1.AUS
  6FF2*   CD 609A*       C      	CALL	UR.KRE
  6FF5*   DC 60A8*       C      	CALL	C,UR.KRWW
  6FF8*   CD 60AC*       C      	CALL	UR.KRA
  6FFB*   F1             C      	POP	AF
  6FFC*   C9             C      	RET
  6FFD*                  C      KX.EXEC2:
  6FFD*   F5             C      	PUSH	AF
  6FFE*   DD CB 00 BE    C      	RES	7,(IX+0)
  7002*   DD 36 01 00    C      	LD	(IX+1),0
  7006*   CD 5C92*       C      	CALL	KR.KARO
  7009*   DD CB 00 7E    C      	BIT	7,(IX+0)
  700D*   28 0A          C      	JR	Z,$+12
  700F*   DD 7E 01       C      	LD	A,(IX+1)
  7012*   FE 14          C      	CP	14H
  7014*   28 05          C      	JR	Z,$+7
  7016*   CD 5D5A*       C      	CALL	UF.ERANZ
  7019*   F1             C      	POP	AF
  701A*   C9             C      	RET
  701B*   DD CB 00 BE    C      	RES	7,(IX)
  701F*   CD 5476*       C      	CALL	U1.AUS
  7022*   CD 60C4*       C      	CALL	UR.KSL
  7025*   F1             C      	POP	AF
  7026*   06 06          C      	LD	B,6
  7028*   33             C      	INC	SP
  7029*   10 FD          C      	DJNZ	$-1	;STACK BERICHTIGEN
  702B*   18 A6          C      	JR	KX.RSPFR
  702D*                  C      KX.UPA:
  702D*   CD 546D*       C      	CALL	U1.EIN
  7030*   CD 609A*       C      	CALL	UR.KRE
'Kopieren von MRES-Kassetten Teil 1'	MACRO-80 3.44	09-Dec-81	PAGE	1-75


  7033*   DD 36 00 00    C      	LD	(IX+0),0
  7037*   CD 5476*       C      	CALL	U1.AUS
  703A*   CD 609A*       C      	CALL	UR.KRE
  703D*   DD CB 00 56    C      	BIT	2,(IX+0)
  7041*   28 05          C      	JR	Z,$+7
  7043*   D1             C      	POP	DE
  7044*   3E 19          C      	LD	A,19H
  7046*   CD 5D5A*       C      	CALL	UF.ERANZ
  7049*   C9             C      	RET
                         C      ;	END
                         C      	TITLE	'Kopieren von MRES-Kassetten Teil 2'
                         C      	PAGE
'Kopieren von MRES-Kassetten Teil 2'	MACRO-80 3.44	09-Dec-81	PAGE	1-76


                         C      
                         C      ;	PN	KY
                         C      ;---------------------------------------------------------------------
                         C      ;
                         C      ;          KOPIEREN VON MRES-KASSETTEN           TEIL 2
                         C      ;
                         C      ;--------------------------------------------------------------------
  704A*                  C      KY.MD:
  704A*   CD 55B1*       C      	CALL	U1.BILO
  704D*   21 5E8B*       C      	LD	HL,UA.KOPFR
  7050*   CD 72A3*       C      	CALL	KY.SATR
  7053*   3E 0D          C      	LD	A,13
  7055*   32 2B00*       C      	LD	(UB.ZN),A
  7058*   21 ECA2        C      	LD	HL,BC.VTABE+32
  705B*   FD 21 F902     C      	LD	IY,BC.TAB2
  705F*   FD 36 00 FF    C      	LD	(IY+0),0FFH
  7063*   3A EC85        C      	LD	A,(BC.VTABE+3)
  7066*   47             C      	LD	B,A
  7067*   05             C      	DEC	B
                         C      ;--------------------------------ABFRAGEZYKLUS------------------------
  7068*                  C      KY.DFR:
  7068*   C5             C      	PUSH	BC
  7069*   11 2B4E*       C      	LD	DE,UB.SATZ+26
  706C*   01 0006        C      	LD	BC,6
  706F*   ED B0          C      	LDIR
  7071*   13             C      	INC	DE
  7072*   13             C      	INC	DE
  7073*   01 0002        C      	LD	BC,2
  7076*   ED B0          C      	LDIR
  7078*   01 0018        C      	LD	BC,24
  707B*   09             C      	ADD	HL,BC
  707C*   E5             C      	PUSH	HL
  707D*   21 2B34*       C      	LD	HL,UB.SATZ
  7080*   CD 595C*       C      	CALL	UR.MIMO
  7083*   DC 72FF*       C      	CALL	C,KU.ZEIR
  7086*   CD 729A*       C      	CALL	KY.JHL	;BEI KOPIJ WIRD J GESETZT
  7089*   7E             C      	LD	A,(HL)
  708A*   FE 4A          C      	CP	'J'
  708C*   C4 72C7*       C      	CALL	NZ,KU.TAB2L
  708F*   E1             C      	POP	HL
  7090*   01 0009        C      	LD	BC,9
  7093*   B7             C      	OR	A
  7094*   ED 42          C      	SBC	HL,BC
  7096*   7E             C      	LD	A,(HL)
  7097*   FD 77 00       C      	LD	(IY+0),A
  709A*   FD 23          C      	INC	IY
  709C*   FD 36 00 FF    C      	LD	(IY+0),0FFH
  70A0*   09             C      	ADD	HL,BC
  70A1*   3A E005        C      	LD	A,(BC.VTABA+3)
  70A4*   FE 01          C      	CP	01H
  70A6*   28 2E          C      	JR	Z,KY.EZYK1
  70A8*   E5             C      	PUSH	HL
  70A9*   01 0020        C      	LD	BC,32
  70AC*   B7             C      	OR	A
  70AD*   ED 42          C      	SBC	HL,BC
  70AF*   EB             C      	EX	DE,HL
  70B0*   E1             C      	POP	HL
  70B1*   DD 21 E002     C      	LD	IX,BC.VTABA
  70B5*   47             C      	LD	B,A
  70B6*   05             C      	DEC	B
  70B7*                  C      KY.VZVGL:
  70B7*   C5             C      	PUSH	BC
  70B8*   01 0020        C      	LD	BC,32
  70BB*   DD 09          C      	ADD	IX,BC
  70BD*   DD E5          C      	PUSH	IX
  70BF*   06 07          C      	LD	B,7
  70C1*   D5             C      	PUSH	DE
  70C2*                  C      KY.SVGL:
  70C2*   1A             C      	LD	A,(DE)
  70C3*   DD BE 00       C      	CP	(IX+0)
  70C6*   20 08          C      	JR	NZ,KY.NDA
  70C8*   DD 23          C      	INC	IX
  70CA*   13             C      	INC	DE
  70CB*   10 F5          C      	DJNZ	KY.SVGL
  70CD*   CD 732F*       C      	CALL	KU.DD	;DATEI SCHON VORHANDEN
  70D0*                  C      KY.NDA:
  70D0*   D1             C      	POP	DE
  70D1*   DD E1          C      	POP	IX
  70D3*   C1             C      	POP	BC
  70D4*   10 E1          C      	DJNZ	KY.VZVGL
  70D6*                  C      KY.EZYK1:
  70D6*   C1             C      	POP	BC
'Kopieren von MRES-Kassetten Teil 2'	MACRO-80 3.44	09-Dec-81	PAGE	1-77


  70D7*   10 8F          C      	DJNZ	KY.DFR
                         C      ;---------------------------------------------------------------------
  70D9*                  C      KY.ATAA:
  70D9*   06 03          C      	LD	B,3	;WARTESCHLEIFE FUER
  70DB*   21 FFFF        C      	LD	HL,0FFFFH
  70DE*   2B             C      	DEC	HL
  70DF*   7C             C      	LD	A,H
  70E0*   B5             C      	OR	L
  70E1*   20 FB          C      	JR	NZ,$-3
  70E3*   10 F6          C      	DJNZ	$-8
  70E5*   21 5EC1*       C      	LD	HL,UA.EABFR
  70E8*   CD 72A3*       C      	CALL	KY.SATR
  70EB*   21 2B34*       C      	LD	HL,UB.SATZ
  70EE*   CD 595C*       C      	CALL	UR.MIMO
  70F1*   38 F8          C      	JR	C,$-6
  70F3*   CD 729A*       C      	CALL	KY.JHL
  70F6*   7E             C      	LD	A,(HL)
  70F7*   FE 4A          C      	CP	'J'
  70F9*   C2 704A*       C      	JP	NZ,KY.MD
                         C      ;--------------------------------Labelnummern fuer Ausgabe ---------
  70FC*                  C      KY.ATAB:
  70FC*   06 00          C      	LD	B,0
  70FE*   21 F902        C      	LD	HL,BC.TAB2
  7101*   11 F9D2        C      	LD	DE,BC.TAB3
  7104*   7E             C      	LD	A,(HL)
  7105*   FE FF          C      	CP	0FFH	;KEINE DATEI KOPIEREN
  7107*   CA 6FDE*       C      	JP	Z,KX.ENDR
  710A*   3A E003        C      	LD	A,(BC.VTABA+1)
  710D*                  C      KY.ATABE:
  710D*   12             C      	LD	(DE),A
  710E*   23             C      	INC	HL
  710F*   13             C      	INC	DE
  7110*   04             C      	INC	B
  7111*   F5             C      	PUSH	AF
  7112*   7E             C      	LD	A,(HL)
  7113*   FE FF          C      	CP	0FFH
  7115*   28 04          C      	JR	Z,KY.WEI
  7117*   F1             C      	POP	AF
  7118*   3C             C      	INC	A
  7119*   18 F2          C      	JR	KY.ATABE
                         C      ;------------------------------TAB:NR DER VERZ.EINTRAGUNGEN (EING.)------
  711B*                  C      KY.WEI:
  711B*   F1             C      	POP	AF
  711C*   C5             C      	PUSH	BC
  711D*   AF             C      	XOR	A
  711E*   57             C      	LD	D,A
  711F*   3A EC85        C      	LD	A,(BC.VTABE+3)
  7122*   47             C      	LD	B,A
  7123*   05             C      	DEC	B
  7124*   21 F902        C      	LD	HL,BC.TAB2
  7127*   FD 21 F96A     C      	LD	IY,BC.TAB2A
  712B*   DD 21 ECA2     C      	LD	IX,BC.VTABE+32	;???
  712F*                  C      KY.ZYK:
  712F*   14             C      	INC	D
  7130*   7E             C      	LD	A,(HL)
  7131*   DD BE 17       C      	CP	(IX+23)
  7134*   20 0B          C      	JR	NZ,KY.NE
  7136*   7A             C      	LD	A,D
  7137*   FD 77 00       C      	LD	(IY+0),A
  713A*   FD 36 01 FF    C      	LD	(IY+1),0FFH
  713E*   23             C      	INC	HL
  713F*   FD 23          C      	INC	IY
  7141*                  C      KY.NE:
  7141*   C5             C      	PUSH	BC
  7142*   01 0020        C      	LD	BC,32
  7145*   DD 09          C      	ADD	IX,BC
  7147*   C1             C      	POP	BC
  7148*   10 E5          C      	DJNZ	KY.ZYK
                         C      ;------------------------------------AUFBAU AUSGABEVERZ.-----
  714A*   3A E005        C      	LD	A,(BC.VTABA+3)
  714D*   47             C      	LD	B,A
  714E*   FE 01          C      	CP	01H
  7150*   28 08          C      	JR	Z,KY.EVZ
  7152*   21 E002        C      	LD	HL,BC.VTABA
  7155*   CD 72BE*       C      	CALL	KU.VVOR
  7158*   18 03          C      	JR	KY.EVZ1
  715A*                  C      KY.EVZ:
  715A*   21 E022        C      	LD	HL,BC.VTABA+32
  715D*                  C      KY.EVZ1:
  715D*   DD 21 F96A     C      	LD	IX,BC.TAB2A
  7161*   FD 21 F9D2     C      	LD	IY,BC.TAB3
  7165*   EB             C      	EX	DE,HL
  7166*   21 ECA2        C      	LD	HL,BC.VTABE+32
'Kopieren von MRES-Kassetten Teil 2'	MACRO-80 3.44	09-Dec-81	PAGE	1-78


  7169*   DD 7E 00       C      	LD	A,(IX+0)
  716C*   FE 01          C      	CP	01H
  716E*   28 05          C      	JR	Z,KY.VSTR
  7170*   3D             C      	DEC	A
  7171*   47             C      	LD	B,A
  7172*   CD 72BE*       C      	CALL	KU.VVOR
  7175*                  C      KY.VSTR:
  7175*   01 0020        C      	LD	BC,32
  7178*   ED B0          C      	LDIR
  717A*   FD 7E 00       C      	LD	A,(IY+0)
  717D*   EB             C      	EX	DE,HL
  717E*   01 0009        C      	LD	BC,9
  7181*   B7             C      	OR	A
  7182*   ED 42          C      	SBC	HL,BC
  7184*   77             C      	LD	(HL),A
  7185*   09             C      	ADD	HL,BC
  7186*   EB             C      	EX	DE,HL
  7187*   DD 7E 01       C      	LD	A,(IX+1)
  718A*   FE FF          C      	CP	0FFH
  718C*   28 10          C      	JR	Z,KY.COPY
  718E*   DD 96 00       C      	SUB	(IX+0)
  7191*   3D             C      	DEC	A
  7192*   47             C      	LD	B,A
  7193*   FE 00          C      	CP	00H
  7195*   C4 72BE*       C      	CALL	NZ,KU.VVOR
  7198*   FD 23          C      	INC	IY
  719A*   DD 23          C      	INC	IX
  719C*   18 D7          C      	JR	KY.VSTR
                         C      ;------------------------------------VERZ.SCHREIBEN (NUR NEUE SAETZE)---
  719E*                  C      KY.COPY:
  719E*   DD 21 2B03*    C      	LD	IX,UB.KTAB
  71A2*   CD 54FB*       C      	CALL	U1.KTIN1
  71A5*   DD 36 0A 20    C      	LD	(IX+10),20H
  71A9*   CD 5476*       C      	CALL	U1.AUS
  71AC*   3A E005        C      	LD	A,(BC.VTABA+3)
  71AF*   47             C      	LD	B,A
  71B0*   CD 60CA*       C      	CALL	UR.KBV	;AUSGABEKASSETTE
  71B3*   3D             C      	DEC	A
  71B4*   20 FA          C      	JR	NZ,$-4	;VORSTELLEN BIS HINTER LETZTEN ALTEN
  71B6*   21 E002        C      	LD	HL,BC.VTABA	;VERZ.SATZ
  71B9*   11 0020        C      	LD	DE,32
  71BC*   19             C      	ADD	HL,DE
  71BD*   10 FA          C      	DJNZ	$-4	;AUSGABEVERZ.ZEIGER
  71BF*   C1             C      	POP	BC
  71C0*   78             C      	LD	A,B
  71C1*   F5             C      	PUSH	AF
  71C2*                  C      KY.VSCHR:
  71C2*   11 0E65        C      	LD	DE,UE.PUF
  71C5*   01 0020        C      	LD	BC,32
  71C8*   ED B0          C      	LDIR
  71CA*   CD 60CA*       C      	CALL	UR.KBV
  71CD*   CD 60D0*       C      	CALL	UR.KBR
  71D0*   DD 36 04 08    C      	LD	(IX+4),08H
  71D4*   CD 5D2A*       C      	CALL	UF.EXEC
  71D7*   3D             C      	DEC	A
  71D8*   20 E8          C      	JR	NZ,KY.VSCHR
                         C      ;----------------------------------------------------------------
  71DA*   11 33FA        C      	LD	DE,SD.BWSA + 12*80 + 58	;33FAH	;''ES WIRD KOPIERT''
  71DD*   21 728A*       C      	LD	HL,KY.EWK
  71E0*   01 0010        C      	LD	BC,16
  71E3*   ED B0          C      	LDIR
                         C      ;------------------------------KOPIEREN--------------------------
  71E5*   21 F902        C      	LD	HL,BC.TAB2
  71E8*   11 F9D2        C      	LD	DE,BC.TAB3
  71EB*   FD 21 F96A     C      	LD	IY,BC.TAB2A
  71EF*   1A             C      	LD	A,(DE)
  71F0*   47             C      	LD	B,A
  71F1*   04             C      	INC	B
  71F2*   CD 60DF*       C      	CALL	UR.POSIK
  71F5*   7E             C      	LD	A,(HL)
  71F6*   47             C      	LD	B,A
  71F7*   04             C      	INC	B
  71F8*                  C      KY.KOPV:
  71F8*   CD 546D*       C      	CALL	U1.EIN
  71FB*   CD 60DF*       C      	CALL	UR.POSIK
  71FE*                  C      KY.KOP:
  71FE*   CD 542B*       C      	CALL	U1.BREAD
  7201*   7E             C      	LD	A,(HL)
  7202*   FE 01          C      	CP	01H
  7204*   CC 5486*       C      	CALL	Z,U1.VSX
                         C      ;------------------------ANZEIGE WELCHE DATEI KOPIERT WIRD-------------
  7207*   E5             C      	PUSH	HL
  7208*   D5             C      	PUSH	DE
'Kopieren von MRES-Kassetten Teil 2'	MACRO-80 3.44	09-Dec-81	PAGE	1-79


  7209*   FD 7E 00       C      	LD	A,(IY+0)
  720C*   47             C      	LD	B,A
  720D*   05             C      	DEC	B
  720E*   21 ECA2        C      	LD	HL,BC.VTABE+32
  7211*   FE 01          C      	CP	01H
  7213*   28 03          C      	JR	Z,KY.KOPAN
  7215*   CD 72BE*       C      	CALL	KU.VVOR
  7218*                  C      KY.KOPAN:
  7218*   11 34F0        C      	LD	DE,SD.BWSA + 15*80 + 64	;34F0H
  721B*   01 0006        C      	LD	BC,6
  721E*   ED B0          C      	LDIR
  7220*   13             C      	INC	DE
  7221*   13             C      	INC	DE
  7222*   01 0002        C      	LD	BC,2
  7225*   ED B0          C      	LDIR
  7227*   FD 23          C      	INC	IY
  7229*   D1             C      	POP	DE
  722A*   E1             C      	POP	HL
                         C      ;--------------------------------------------------------------------
  722B*   1A             C      	LD	A,(DE)
  722C*   FE 01          C      	CP	01H
  722E*   CC 547F*       C      	CALL	Z,U1.VS1
  7231*   32 0E65        C      	LD	(UE.PUF),A
  7234*   CD 5436*       C      	CALL	U1.BWRIT
  7237*   CD 5445*       C      	CALL	U1.COPB
  723A*   23             C      	INC	HL
  723B*   7E             C      	LD	A,(HL)
  723C*   FE FF          C      	CP	0FFH
  723E*   28 0B          C      	JR	Z,KY.EOV
  7240*   2B             C      	DEC	HL
  7241*   96             C      	SUB	(HL)
  7242*   23             C      	INC	HL
  7243*   13             C      	INC	DE
  7244*   47             C      	LD	B,A
  7245*   FE 01          C      	CP	01H
  7247*   20 AF          C      	JR	NZ,KY.KOPV
  7249*   18 B3          C      	JR	KY.KOP
                         C      ;-------------------------------------------------------------
  724B*                  C      KY.EOV:
  724B*   CD 5486*       C      	CALL	U1.VSX
  724E*   3A E003        C      	LD	A,(BC.VTABA+1)
  7251*   47             C      	LD	B,A
  7252*   F1             C      	POP	AF
  7253*   F5             C      	PUSH	AF
  7254*   80             C      	ADD	A,B
  7255*   32 0E65        C      	LD	(UE.PUF),A
  7258*   CD 54FB*       C      	CALL	U1.KTIN1
  725B*   DD 36 0A 20    C      	LD	(IX+10),20H
  725F*   CD 5436*       C      	CALL	U1.BWRIT
  7262*   CD 60C4*       C      	CALL	UR.KSL
  7265*   CD 6FDE*       C      	CALL	KX.ENDR
  7268*   CD 609A*       C      	CALL	UR.KRE
  726B*   CD 5496*       C      	CALL	U1.DSVG
  726E*   F1             C      	POP	AF
  726F*   F5             C      	PUSH	AF
  7270*   81             C      	ADD	A,C	;NEXT RECORD UND
  7271*   32 0E66        C      	LD	(UE.PUF+1),A
  7274*   F1             C      	POP	AF
  7275*   80             C      	ADD	A,B	;ANZAHL VERZ.EINTR. KORRIGIEREN
  7276*   32 0E68        C      	LD	(UE.PUF+3),A
  7279*   CD 60D0*       C      	CALL	UR.KBR
  727C*   DD 36 04 08    C      	LD	(IX+4),08H
  7280*   CD 5D2A*       C      	CALL	UF.EXEC	;NEUEN DS-SATZ SCHREIBEN
  7283*   CD 60A2*       C      	CALL	UR.KRW
  7286*   CD 60AC*       C      	CALL	UR.KRA
  7289*   C9             C      	RET
                         C      ;---------------------------------------------------------------
  728A*                  C      KY.EWK:
  728A*   45 73 20 77    C      	DB	'Es wird kopiert:'
  728E*   69 72 64 20    C      
  7292*   6B 6F 70 69    C      
  7296*   65 72 74 3A    C      
                         C      ;---------------------------------------------------------------
  729A*                  C      KY.JHL:
  729A*   3A 2B28*       C      	LD	A,(UB.PAR2)
  729D*   FE 4A          C      	CP	'J'
  729F*   20 01          C      	JR	NZ,$+3
  72A1*   77             C      	LD	(HL),A
  72A2*   C9             C      	RET
                         C      ;--------------------------------------------------------------
  72A3*                  C      KY.SATR:
  72A3*   11 2B34*       C      	LD	DE,UB.SATZ
  72A6*   01 0036        C      	LD	BC,54
'Kopieren von MRES-Kassetten Teil 2'	MACRO-80 3.44	09-Dec-81	PAGE	1-80


  72A9*   ED B0          C      	LDIR
  72AB*   3A 3326        C      	LD	A,(UE.BWSA + 10*80 +6)	;326H
  72AE*   FE 4A          C      	CP	'J'
  72B0*   CC 72B7*       C      	CALL	Z,KY.AJ
  72B3*   32 2B28*       C      	LD	(UB.PAR2),A
  72B6*   C9             C      	RET
  72B7*                  C      KY.AJ:
  72B7*   F5             C      	PUSH	AF
  72B8*   AF             C      	XOR	A
  72B9*   32 2B34*       C      	LD	(UB.SATZ),A
  72BC*   F1             C      	POP	AF
  72BD*   C9             C      	RET
                         C      ;--------------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Unterprogramme fuer KOPI'
                         C      	PAGE
'Unterprogramme fuer KOPI'	MACRO-80 3.44	09-Dec-81	PAGE	1-81


                         C      
                         C      ;	PN	KU
                         C      ;------------------------------------------------------------------
                         C      ;
                         C      ;          UNTERPROGRAMME FUER KOPI
                         C      ;
                         C      ;--------------------------------------------------------
  72BE*                  C      KU.VVOR:
  72BE*   C5             C      	PUSH	BC
  72BF*   01 0020        C      	LD	BC,32
  72C2*   09             C      	ADD	HL,BC
  72C3*   C1             C      	POP	BC
  72C4*   10 F8          C      	DJNZ	KU.VVOR
  72C6*   C9             C      	RET
  72C7*                  C      KU.TAB2L:
  72C7*   D1             C      	POP	DE
  72C8*   E1             C      	POP	HL
  72C9*   FD 7E 00       C      	LD	A,(IY+0)
  72CC*   FE FF          C      	CP	0FFH
  72CE*   28 22          C      	JR	Z,$+36
  72D0*   FD E5          C      	PUSH	IY
  72D2*   06 00          C      	LD	B,00H
  72D4*   FD 7E 00       C      	LD	A,(IY+0)
  72D7*   FE FF          C      	CP	0FFH
  72D9*   20 02          C      	JR	NZ,$+4
  72DB*   18 05          C      	JR	$+7
  72DD*   FD 23          C      	INC	IY
  72DF*   04             C      	INC	B
  72E0*   18 F2          C      	JR	$-12
  72E2*   FD E1          C      	POP	IY
  72E4*   FD E5          C      	PUSH	IY
  72E6*   FD 7E 01       C      	LD	A,(IY+1)
  72E9*   FD 77 00       C      	LD	(IY+0),A
  72EC*   FD 23          C      	INC	IY
  72EE*   10 F6          C      	DJNZ	$-8
  72F0*   FD E1          C      	POP	IY
  72F2*   C1             C      	POP	BC
  72F3*   05             C      	DEC	B
  72F4*   78             C      	LD	A,B
  72F5*   FE 00          C      	CP	00H
  72F7*   28 03          C      	JR	Z,$+5
  72F9*   C3 7068*       C      	JP	KY.DFR
  72FC*   C3 70D9*       C      	JP	KY.ATAA
  72FF*                  C      KU.ZEIR:
  72FF*   D1             C      	POP	DE
  7300*   E1             C      	POP	HL
  7301*   3A 2B00*       C      	LD	A,(UB.ZN)
  7304*   D6 02          C      	SUB	2
  7306*   FE 0D          C      	CP	13
  7308*   30 04          C      	JR	NC,$+6
  730A*   C1             C      	POP	BC
  730B*   C3 704A*       C      	JP	KY.MD
  730E*   32 2B00*       C      	LD	(UB.ZN),A
  7311*   01 0029        C      	LD	BC,41
  7314*   B7             C      	OR	A
  7315*   ED 42          C      	SBC	HL,BC
  7317*   FD 2B          C      	DEC	IY
  7319*   7E             C      	LD	A,(HL)
  731A*   FD BE 00       C      	CP	(IY+0)
  731D*   CC 732C*       C      	CALL	Z,KU.DECIY
  7320*   FD 23          C      	INC	IY
  7322*   01 0017        C      	LD	BC,23
  7325*   B7             C      	OR	A
  7326*   ED 42          C      	SBC	HL,BC
  7328*   C1             C      	POP	BC
  7329*   04             C      	INC	B
  732A*   18 CA          C      	JR	$-52
  732C*                  C      KU.DECIY:
  732C*   FD 2B          C      	DEC	IY
  732E*   C9             C      	RET
  732F*                  C      KU.DD:
  732F*   E5             C      	PUSH	HL
  7330*   21 5EF7*       C      	LD	HL,UA.VORH
  7333*   CD 595C*       C      	CALL	UR.MIMO
  7336*   38 17          C      	JR	C,$+25
  7338*   7E             C      	LD	A,(HL)
  7339*   FE 4A          C      	CP	'J'
  733B*   28 0C          C      	JR	Z,$+14
  733D*   FD 2B          C      	DEC	IY
  733F*   FD 36 00 FF    C      	LD	(IY+0),0FFH
  7343*   11 0050        C      	LD	DE,80
  7346*   B7             C      	OR	A
'Unterprogramme fuer KOPI'	MACRO-80 3.44	09-Dec-81	PAGE	1-82


  7347*   ED 52          C      	SBC	HL,DE
  7349*   36 20          C      	LD	(HL),20H
  734B*   21 2B00*       C      	LD	HL,UB.ZN
  734E*   35             C      	DEC	(HL)
  734F*   E1             C      	POP	HL
  7350*   C9             C      	RET
  7351*   E1             C      	POP	HL
  7352*   D1             C      	POP	DE
  7353*   DD 21 2B03*    C      	LD	IX,UB.KTAB
  7357*   C3 6FDE*       C      	JP	KX.ENDR
                         C      ;	END
                                ;
                         C      	INCLUDE KM.MAC
                         C      	TITLE	'Kmbg'
                         C      	PAGE
'Kmbg'	MACRO-80 3.44	09-Dec-81	PAGE	1-83


                         C      
                         C      ;	PN	KM01
                         C      ;****************************************************************
                         C      ;*                  DEG2000   V.1.2   ---   Programm:   K m b g *
                         C      ;*  Version         --------------------------------------------*
                         C      ;*                  Programmierer: R. Sieber   A d W            *
                         C      ;*  V 1 . 2         --------------------------------------------*
                         C      ;*                  Stand        : 25.Februar 1985              *
                         C      ;****************************************************************
                         C      
  0002                   C      SM.FNL      EQU   02
  0003                   C      SM.FDOWN    EQU   03
  0005                   C      SM.FLEFT    EQU   05
  0006                   C      SM.FPOS1    EQU   06
  0007                   C      SM.FRIGHT   EQU   07
  0008                   C      SM.FLTAB    EQU   08
  0009                   C      SM.FUP      EQU   09
  000A                   C      SM.FRTAB    EQU   10
  000C                   C      SM.FDEL     EQU   12
  001C                   C      SM.FABS     EQU   28
                         C      
  735A*                  C      KM.ANF:
  735A*   735A*          C      	DW	$
  735C*   4B 6D 62 67    C      	DB	'Kmbg'
  7360*   21 754F*       C      	LD	HL,KM.DEL	;Taste:   D E L
  7363*   22 0CF8        C      	LD	(SM.FKTAB+(2*SM.FDEL)),HL
  7366*   21 750D*       C      	LD	HL,KM.ABS	;Taste:   A B S
  7369*   22 0D18        C      	LD	(SM.FKTAB+(2*SM.FABS)),HL
  736C*   21 73B8*       C      	LD	HL,KM.HOME	;Taste:   H O M E
  736F*   22 0CEC        C      	LD	(SM.FKTAB+(2*SM.FPOS1)),HL
  7372*   21 73C2*       C      	LD	HL,KM.SL	;Taste:   SCH_LINKS
  7375*   22 0CF0        C      	LD	(SM.FKTAB+(2*SM.FLTAB)),HL
  7378*   21 73CF*       C      	LD	HL,KM.SR	;Taste:   SCH_RECHTS
  737B*   22 0CF4        C      	LD	(SM.FKTAB+(2*SM.FRTAB)),HL
  737E*   21 73AC*       C      	LD	HL,KM.CO	;Taste:   C_HOCH
  7381*   22 0CF2        C      	LD	(SM.FKTAB+(2*SM.FUP)),HL
  7384*   21 73D4*       C      	LD	HL,KM.CR	;Taste:   C_RECHTS
  7387*   22 0CEE        C      	LD	(SM.FKTAB+(2*SM.FRIGHT)),HL
  738A*   21 73BD*       C      	LD	HL,KM.CU	;Taste:   C_RUNTER
  738D*   22 0CE6        C      	LD	(SM.FKTAB+(2*SM.FDOWN)),HL
  7390*   21 73CA*       C      	LD	HL,KM.CL	;Taste:   C_LINKS
  7393*   22 0CEA        C      	LD	(SM.FKTAB+(2*SM.FLEFT)),HL
  7396*   21 73D9*       C      	LD	HL,KM.CNZA	;Taste:   C N Z A
  7399*   22 0CE4        C      	LD	(SM.FKTAB+(2*SM.FNL)),HL
  739C*   21 7409*       C      	LD	HL,KM.NEWL	;Taste:   E T 1
  739F*   22 0DAE        C      	LD	(KM.TNEWL),HL
  73A2*   21 742E*       C      	LD	HL,KM.EINA	;alphanum. Tasten
  73A5*   22 0DB0        C      	LD	(KM.TEINA),HL
                         C      
                         C      	; LD	HL,KM.UP13
                         C      	; LD	DE,KM.RAM
                         C      	; LD	BC,KM.UPEND-KM.UP13
                         C      	; LDIR
                         C      
  73A8*   DD 21 2B03*    C      	LD	IX,KM.KMTAB
  73AC*                  C      KM.CO:
  73AC*   DD CB 00 7E    C      	BIT	7,(IX)
  73B0*   C2 75F7*       C      	JP	NZ,KM.UP4-KM.UP13+KM.RAM
  73B3*   CD 755D*       C      	CALL	KM.UP2	;KMBG Reservieren EIN
  73B6*   31             C      	DB	31H
  73B7*   C9             C      	RET
                         C      
                         C      	PAGE
'Kmbg'	MACRO-80 3.44	09-Dec-81	PAGE	1-84


                         C      
                         C      ;****************************************************************
                         C      ;*                  Auswertung der Cursor-Tasten                *
                         C      ;****************************************************************
  73B8*                  C      KM.HOME:
  73B8*   CD 755A*       C      	CALL	KM.UP1	;KMBG Kassette zurueckspulen
  73BB*   21             C      	DB	21H
  73BC*   C9             C      	RET
                         C      
  73BD*                  C      KM.CU:
  73BD*   CD 755D*       C      	CALL	KM.UP2	;KMBG Reservieren AUS
  73C0*   41             C      	DB	41H
  73C1*   C9             C      	RET
                         C      
  73C2*                  C      KM.SL:
  73C2*   CD 755D*       C      	CALL	KM.UP2	;KMBG vorh.  Datensatz anzeigen
  73C5*   15             C      	DB	15H
  73C6*   CD 755A*       C      	CALL	KM.UP1
  73C9*   02             C      	DB	2
  73CA*                  C      KM.CL:
  73CA*   CD 755D*       C      	CALL	KM.UP2	;KMBG einen  Datensatz zuruecksetzen
  73CD*   15             C      	DB	15H
  73CE*   C9             C      	RET
                         C      
  73CF*                  C      KM.SR:
  73CF*   CD 755A*       C      	CALL	KM.UP1	;KMBG nachf. Datensatz anzeigen
  73D2*   02             C      	DB	2
  73D3*   C9             C      	RET
                         C      
  73D4*                  C      KM.CR:
  73D4*   CD 755D*       C      	CALL	KM.UP2	;KMBG einen  Datensatz vorsetzen
  73D7*   11             C      	DB	11H
  73D8*   C9             C      	RET
                         C      
  73D9*                  C      KM.CNZA:
  73D9*   DD CB 00 7E    C      	BIT	7,(IX)
  73DD*   C0             C      	RET	NZ
  73DE*   3A 7609*       C      	LD	A,(KM.TX2-KM.UP13+KM.RAM)
  73E1*   FE 6C          C      	CP	'l'
  73E3*   28 08          C      	JR	Z,KM.CNZA1
  73E5*   DD 36 09 00    C      	LD	(IX+9),0
  73E9*   DD 36 0A 01    C      	LD	(IX+10),1
  73ED*                  C      KM.CNZA1:
  73ED*   3E 71          C      	LD	A,71H
  73EF*   DD B6 04       C      	OR	(IX+4)
  73F2*   DD 77 04       C      	LD	(IX+4),A
  73F5*   CD 756E*       C      	CALL	KM.UP5
  73F8*   DD 7E 04       C      	LD	A,(IX+4)
  73FB*   CD 755A*       C      	CALL	KM.UP1
  73FE*   02             C      	DB	2
  73FF*   CD 755D*       C      	CALL	KM.UP2
  7402*   15             C      	DB	15H
  7403*   DD 77 04       C      	LD	(IX+4),A
  7406*   C3 75F7*       C      	JP	KM.UP4-KM.UP13+KM.RAM
                         C      ;****************************************************************
                         C      ;*                  Routine fuer die Taste   E T 1              *
                         C      ;****************************************************************
  7409*                  C      KM.NEWL:
  7409*   DD CB 00 7E    C      	BIT	7,(IX)
  740D*   C0             C      	RET	NZ
  740E*   21 0E66        C      	LD	HL,KM.PUFF
  7411*   22 2BE2*       C      	LD	(KM.KMTAB+0DFH),HL	;2BE0
  7414*   DD 7E 0A       C      	LD	A,(IX+10)
  7417*   3D             C      	DEC	A
  7418*   E6 F0          C      	AND	0F0H
  741A*   07             C      	RLCA
  741B*   07             C      	RLCA
  741C*   07             C      	RLCA
  741D*   07             C      	RLCA
  741E*   3C             C      	INC	A
  741F*   32 2BED*       C      	LD	(KM.KMTAB+0EAH),A	;2BEB
  7422*   CD 2060        C      	CALL	KM.MHOME
  7425*   CD 23BA        C      	CALL	KM.MINSL
  7428*   CD 225C        C      	CALL	ATACO
  742B*   C3 75F7*       C      	JP	KM.UP4-KM.UP13+KM.RAM
                         C      
                         C      	PAGE
'Kmbg'	MACRO-80 3.44	09-Dec-81	PAGE	1-85


                         C      
                         C      ;****************************************************************
                         C      ;*                  Auswertung der alphanumerischen Tasten      *
                         C      ;****************************************************************
  742E*                  C      KM.EINA:
  742E*   79             C      	LD	A,C
  742F*   21 0000        C      	LD	HL,0
  7432*   FE 72          C      	CP	'r'
  7434*   20 03          C      	JR	NZ,KM.EINA1
  7436*   21 7498*       C      	LD	HL,KM.EINAB
  7439*                  C      KM.EINA1:
  7439*   FE 7A          C      	CP	'z'
  743B*   20 03          C      	JR	NZ,KM.EINA2
  743D*   21 74A3*       C      	LD	HL,KM.EINAC
  7440*                  C      KM.EINA2:
  7440*   FE 70          C      	CP	'p'
  7442*   20 03          C      	JR	NZ,KM.EINA3
  7444*   21 0000        C      	LD	HL,0
  7447*                  C      KM.EINA3:
  7447*   FE 63          C      	CP	'c'
  7449*   20 03          C      	JR	NZ,KM.EINA4
  744B*   21 0000        C      	LD	HL,0
  744E*                  C      KM.EINA4:
  744E*   22 0DA8        C      	LD	(KM.TTABU),HL
  7451*   FE 30          C      	CP	'0'
  7453*   38 04          C      	JR	C,KM.EINA5
  7455*   FE 47          C      	CP	'G'
  7457*   38 06          C      	JR	C,KM.EINA7
  7459*                  C      KM.EINA5:
  7459*   32 7609*       C      	LD	(KM.TX2-KM.UP13+KM.RAM),A
  745C*                  C      KM.EINA6:
  745C*   C3 75F7*       C      	JP	KM.UP4-KM.UP13+KM.RAM
                         C      
  745F*                  C      KM.EINA7:
  745F*   3A 7609*       C      	LD	A,(KM.TX2-KM.UP13+KM.RAM)
  7462*   FE 67          C      	CP	'g'
  7464*   20 10          C      	JR	NZ,KM.EINA8
  7466*   79             C      	LD	A,C
  7467*   D6 30          C      	SUB	30H
  7469*   D8             C      	RET	C
  746A*   C8             C      	RET	Z
  746B*   FE 03          C      	CP	3
  746D*   D0             C      	RET	NC
  746E*   DD 77 03       C      	LD	(IX+3),A
  7471*   CD 74CE*       C      	CALL	KM.UP20
  7474*   18 E6          C      	JR	KM.EINA6
                         C      
  7476*                  C      KM.EINA8:
  7476*   FE 6C          C      	CP	'l'
  7478*   20 1D          C      	JR	NZ,KM.EINAA
  747A*   79             C      	LD	A,C
  747B*   D6 30          C      	SUB	30H
  747D*   FE 0A          C      	CP	00AH
  747F*   38 02          C      	JR	C,KM.EINA9
  7481*   D6 07          C      	SUB	7
  7483*                  C      KM.EINA9:
  7483*   5F             C      	LD	E,A
  7484*   16 00          C      	LD	D,0
  7486*   62             C      	LD	H,D
  7487*   DD 6E 0A       C      	LD	L,(IX+10)
  748A*   29             C      	ADD	HL,HL
  748B*   29             C      	ADD	HL,HL
  748C*   29             C      	ADD	HL,HL
  748D*   29             C      	ADD	HL,HL
  748E*   19             C      	ADD	HL,DE
  748F*   DD 74 09       C      	LD	(IX+9),H
  7492*   DD 75 0A       C      	LD	(IX+10),L
  7495*   18 C5          C      	JR	KM.EINA6
                         C      
  7497*                  C      KM.EINAA:
  7497*   C9             C      	RET
                         C      
  7498*                  C      KM.EINAB:
  7498*   CD 755D*       C      	CALL	KM.UP2
  749B*   08             C      	DB	8
  749C*   21 0000        C      	LD	HL,0
  749F*   22 0DAA        C      	LD	(SM.TABU),HL	;00DA8H
  74A2*   C9             C      	RET
                         C      
  74A3*                  C      KM.EINAC:
  74A3*   DD 36 0D 00    C      	LD	(IX+13),0
  74A7*   DD 36 0E 00    C      	LD	(IX+14),0
'Kmbg'	MACRO-80 3.44	09-Dec-81	PAGE	1-86


  74AB*                  C      KM.EINAD:
  74AB*   CD 755A*       C      	CALL	KM.UP1
  74AE*   02             C      	DB	2
  74AF*   DD 7E 09       C      	LD	A,(IX+9)
  74B2*   DD B6 0A       C      	OR	(IX+10)
  74B5*   28 08          C      	JR	Z,KM.EINAE
  74B7*   DD 34 0D       C      	INC	(IX+13)
  74BA*   CD 74BF*       C      	CALL	KM.EINAE
  74BD*   18 EC          C      	JR	KM.EINAD
                         C      
  74BF*                  C      KM.EINAE:
  74BF*   CD 75F7*       C      	CALL	KM.UP4-KM.UP13+KM.RAM
  74C2*   11 35E0        C      	LD	DE,SD.BWSA + 18*80 + 64	;5E0H
  74C5*   CD 7592*       C      	CALL	KM.UP10
  74C8*   62 7A 3A       C      	DB	'bz:'
  74CB*   0D             C      	DB	00DH
  74CC*   A0             C      	DB	20H+80H
  74CD*   C9             C      	RET
                         C      
  74CE*                  C      KM.UP20:
  74CE*   DD 4E 02       C      	LD	C,(IX+2)
  74D1*   0C             C      	INC	C	;???
  74D2*   0C             C      	INC	C
  74D3*   0C             C      	INC	C
  74D4*   0C             C      	INC	C
  74D5*   ED 40          C      	IN	B,(C)
  74D7*   FE 01          C      	CP	1
  74D9*   20 04          C      	JR	NZ,KM.UP21
  74DB*   CB 48          C      	BIT	1,B
  74DD*   20 29          C      	JR	NZ,KM.UP25
  74DF*                  C      KM.UP21:
  74DF*   CB D8          C      	SET	3,B
  74E1*   18 06          C      	JR	KM.UP22
  74E3*   CB 40          C      	BIT	0,B
  74E5*   20 21          C      	JR	NZ,KM.UP25
  74E7*   CB D0          C      	SET	2,B
  74E9*                  C      KM.UP22:
  74E9*   ED 41          C      	OUT	(C),B
  74EB*   0C             C      	INC	C
  74EC*   ED 50          C      	IN	D,(C)
  74EE*   0D             C      	DEC	C
  74EF*   CB 90          C      	RES	2,B
  74F1*   CB 98          C      	RES	3,B
  74F3*   ED 41          C      	OUT	(C),B
  74F5*   FE 01          C      	CP	1
  74F7*   20 04          C      	JR	NZ,KM.UP23
  74F9*   CB 62          C      	BIT	4,D
  74FB*   18 02          C      	JR	KM.UP24
                         C      
  74FD*                  C      KM.UP23:
  74FD*   CB 5A          C      	BIT	3,D
  74FF*                  C      KM.UP24:
  74FF*   28 07          C      	JR	Z,KM.UP25
  7501*   DD 36 00 00    C      	LD	(IX+0),0
  7505*   C3 73AC*       C      	JP	KM.CO
                         C      
  7508*                  C      KM.UP25:
  7508*   DD CB 00 FE    C      	SET	7,(IX+0)
  750C*   C9             C      	RET
                         C      
                         C      	PAGE
'Kmbg'	MACRO-80 3.44	09-Dec-81	PAGE	1-87


                         C      
  750D*                  C      KM.ABS:
  750D*   21 3000        C      	LD	HL,SD.BWSA
  7510*   06 11          C      	LD	B,17
  7512*                  C      KM.ABS1:
  7512*   C5             C      	PUSH	BC
  7513*   CD 751C*       C      	CALL	KM.UP30
  7516*   C1             C      	POP	BC
  7517*   10 F9          C      	DJNZ	KM.ABS1
  7519*   C3 752F*       C      	JP	KM.UP36
                         C      
  751C*                  C      KM.UP30:
  751C*   CD 753B*       C      	CALL	KM.UP34
  751F*   A0             C      	DB	0A0H
  7520*   28 15          C      	JR	Z,KM.UP33
  7522*   CD 753B*       C      	CALL	KM.UP34
  7525*   50             C      	DB	050H
  7526*   28 0C          C      	JR	Z,KM.UP32
  7528*                  C      KM.UP31:
  7528*   7E             C      	LD	A,(HL)
  7529*   23             C      	INC	HL
  752A*   CD 4040        C      	CALL	PRINT
  752D*   10 F9          C      	DJNZ	KM.UP31
  752F*                  C      KM.UP36:
  752F*   3E 1E          C      	LD	A,1EH
  7531*   C3 4040        C      	JP	PRINT
                         C      
  7534*                  C      KM.UP32:
  7534*   CD 752F*       C      	CALL	KM.UP36
  7537*                  C      KM.UP33:
  7537*   23             C      	INC	HL
  7538*   10 FD          C      	DJNZ	KM.UP33
  753A*   C9             C      	RET
                         C      
  753B*                  C      KM.UP34:
  753B*   E3             C      	EX	(SP),HL
  753C*   46             C      	LD	B,(HL)
  753D*   23             C      	INC	HL
  753E*   E3             C      	EX	(SP),HL
  753F*   E5             C      	PUSH	HL
  7540*   CD 7547*       C      	CALL	KM.UP35
  7543*   E1             C      	POP	HL
  7544*   06 50          C      	LD	B,80
  7546*   C9             C      	RET
                         C      
  7547*                  C      KM.UP35:
  7547*   3E 20          C      	LD	A,' '
  7549*   BE             C      	CP	(HL)
  754A*   23             C      	INC	HL
  754B*   C0             C      	RET	NZ
  754C*   10 F9          C      	DJNZ	KM.UP35
  754E*   C9             C      	RET
                         C      
  754F*                  C      KM.DEL:
  754F*   DD CB 00 BE    C      	RES	7,(IX+0)
  7553*   DD 36 01 00    C      	LD	(IX+1),0
  7557*   C3 75F7*       C      	JP	KM.UP4-KM.UP13+KM.RAM
                         C      
                         C      	PAGE
'Kmbg'	MACRO-80 3.44	09-Dec-81	PAGE	1-88


                         C      
                         C      ;****************************************************************
                         C      ;*                  Unterprogramme                              *
                         C      ;****************************************************************
  755A*                  C      KM.UP1:
  755A*   CD 757A*       C      	CALL	KM.LOE1
  755D*                  C      KM.UP2:
  755D*   DD CB 00 7E    C      	BIT	7,(IX)
  7561*   28 02          C      	JR	Z,KM.UP3
  7563*   E1             C      	POP	HL
  7564*   C0             C      	RET	NZ
  7565*                  C      KM.UP3:
  7565*   E3             C      	EX	(SP),HL
  7566*   F5             C      	PUSH	AF
  7567*   7E             C      	LD	A,(HL)
  7568*   23             C      	INC	HL
  7569*   DD 77 04       C      	LD	(IX+4),A
  756C*   F1             C      	POP	AF
  756D*   E3             C      	EX	(SP),HL
  756E*                  C      KM.UP5:
  756E*   CD 5C92*       C      	CALL	KM.KARO
  7571*   21 680C*       C      	LD	HL,FD.DASU	;05C01H
  7574*   22 0D6E        C      	LD	(SM.FKTAB+8EH),HL	;SM.ZSMER , SM.ZSTC
  7577*   C3 75F7*       C      	JP	KM.UP4-KM.UP13+KM.RAM
                         C      
  757A*                  C      KM.LOE1:
  757A*   21 0E65        C      	LD	HL,KM.PUFF-1
  757D*   36 00          C      	LD	(HL),0
  757F*   01 0103        C      	LD	BC,103H
  7582*   18 08          C      	JR	KM.LOE3
  7584*                  C      KM.LOE2:
  7584*   21 3000        C      	LD	HL,SD.BWSA
  7587*   01 077F        C      	LD	BC,24*80 -1 ;007FFH  (25*80-1 = 07CFH; 07FFH-07CFH=30H=48)
  758A*   36 20          C      	LD	(HL),' '
  758C*                  C      KM.LOE3:
  758C*   E5             C      	PUSH	HL
  758D*   D1             C      	POP	DE
  758E*   13             C      	INC	DE
  758F*   ED B0          C      	LDIR
  7591*   C9             C      	RET
                         C      
  7592*                  C      KM.UP10:
  7592*   E3             C      	EX	(SP),HL
  7593*                  C      KM.UP11:
  7593*   7E             C      	LD	A,(HL)
  7594*   E6 7F          C      	AND	07FH
  7596*   FE 20          C      	CP	' '
  7598*   38 02          C      	JR	C,KM.UP12
  759A*   12             C      	LD	(DE),A
  759B*   13             C      	INC	DE
  759C*                  C      KM.UP12:
  759C*   DC 75DB*       C      	CALL	C,KM.UP13-KM.UP13+KM.RAM
  759F*   CB 7E          C      	BIT	7,(HL)
  75A1*   23             C      	INC	HL
  75A2*   28 EF          C      	JR	Z,KM.UP11
  75A4*   E3             C      	EX	(SP),HL
  75A5*   C9             C      	RET
                         C      
  75A6*                  C      KM.UP41:
  75A6*   11 3000        C      	LD	DE,SD.BWSA
  75A9*   DD 7E 0A       C      	LD	A,(IX+10)
  75AC*   B7             C      	OR	A
  75AD*   20 0C          C      	JR	NZ,KM.UP42
  75AF*   DD CB 09 46    C      	BIT	0,(IX+9)
  75B3*   C8             C      	RET	Z
  75B4*   F5             C      	PUSH	AF
  75B5*   CD 201D        C      	CALL	KM.MANZ
  75B8*   F1             C      	POP	AF
  75B9*   D6 10          C      	SUB	10H
  75BB*                  C      KM.UP42:
  75BB*   F5             C      	PUSH	AF
  75BC*   CD 201D        C      	CALL	KM.MANZ
  75BF*   F1             C      	POP	AF
  75C0*   D6 10          C      	SUB	10H
  75C2*   C8             C      	RET	Z
  75C3*   D8             C      	RET	C
  75C4*   18 F5          C      	JR	KM.UP42
                         C      
  75C6*                  C      KM.UP43:
  75C6*   FE 1E          C      	CP	01EH
  75C8*   C8             C      	RET	Z
  75C9*   FE 0A          C      	CP	00AH
'Kmbg'	MACRO-80 3.44	09-Dec-81	PAGE	1-89


  75CB*   C8             C      	RET	Z
  75CC*   FE 0D          C      	CP	00DH
  75CE*   C8             C      	RET	Z
  75CF*   B7             C      	OR	A
  75D0*   C8             C      	RET	Z
  75D1*   FE 20          C      	CP	' '
  75D3*   38 03          C      	JR	C,KM.UP44
  75D5*   FE 80          C      	CP	080H
  75D7*   D8             C      	RET	C
  75D8*                  C      KM.UP44:
  75D8*   3E 7F          C      	LD	A,07FH
  75DA*   C9             C      	RET
                         C      
                         C      	PAGE
'Kmbg'	MACRO-80 3.44	09-Dec-81	PAGE	1-90


                         C      
                         C      ;	ORG	00300H
                         C      
  75DB*                  C      KM.UP13:
  75DB*   32 75E0*       C      	LD	(KM.UP15-KM.UP13+KM.RAM-1),A	;???
  75DE*   DD 7E 01       C      	LD	A,(IX+1)	;<<<
  75E1*                  C      KM.UP15:
  75E1*   EB             C      	EX	DE,HL
  75E2*   77             C      	LD	(HL),A
  75E3*   3E 33          C      	LD	A,33H
  75E5*   ED 67          C      	RRD
  75E7*   EB             C      	EX	DE,HL
  75E8*   F5             C      	PUSH	AF
  75E9*   1A             C      	LD	A,(DE)
  75EA*   CD 75EE*       C      	CALL	KM.UP14-KM.UP13+KM.RAM
  75ED*   F1             C      	POP	AF
  75EE*                  C      KM.UP14:
  75EE*   FE 3A          C      	CP	03AH
  75F0*   38 02          C      	JR	C,$+4	;---!
  75F2*   C6 07          C      	ADD	A,7	;   !
  75F4*   12             C      	LD	(DE),A	;<--!
  75F5*   13             C      	INC	DE
  75F6*   C9             C      	RET
                         C      
  75F7*                  C      KM.UP4:
  75F7*   F5             C      	PUSH	AF
  75F8*   CD 7584*       C      	CALL	KM.LOE2
  75FB*   DD 7E 03       C      	LD	A,(IX+3)
  75FE*   C6 30          C      	ADD	A,30H
  7600*   32 760D*       C      	LD	(KM.TX1-KM.UP13+KM.RAM),A
  7603*   11 35A0        C      	LD	DE,SD.BWSA + 18*80 ;5A0H
  7606*   CD 7592*       C      	CALL	KM.UP10
  7609*                  C      KM.TX2:
  7609*   67 20          C      	DB	'g '
  760B*   04             C      	DB	004H
  760C*   28             C      	DB	'('	;<<<
  760D*                  C      KM.TX1:
  760D*   32 29          C      	DB	'2)'	;<<<
  760F*   BA             C      	DB	3AH+80H	;":"
  7610*   11 35AE        C      	LD	DE,SD.BWSA + 18*80 + 14 ;5AEH	;18*80 +20	;5B4H
  7613*   CD 7592*       C      	CALL	KM.UP10
  7616*   6C 3A          C      	DB	'l:'
  7618*   09             C      	DB	9
  7619*   0A             C      	DB	10
  761A*   20 73 3A       C      	DB	' s:'
  761D*   00             C      	DB	0
  761E*   2F             C      	DB	'/'
  761F*   01             C      	DB	1
  7620*   20 20 20 20    C      	DB	'      '
  7624*   20 20          C      
  7626*   AD             C      	DB	2DH+80H	;"-"
  7627*   1B             C      	DEC	DE
  7628*   1B             C      	DEC	DE
  7629*   1B             C      	DEC	DE
  762A*   21 0E65        C      	LD	HL,KM.PUFF-1
  762D*   7E             C      	LD	A,(HL)
  762E*   23             C      	INC	HL
  762F*   CD 75E1*       C      	CALL	KM.UP15-KM.UP13+KM.RAM
  7632*   13             C      	INC	DE
  7633*   DD 46 0A       C      	LD	B,(IX+10)
  7636*   E5             C      	PUSH	HL
  7637*   23             C      	INC	HL
  7638*   10 FD          C      	DJNZ	$-1
  763A*   7E             C      	LD	A,(HL)
  763B*   CD 75E1*       C      	CALL	KM.UP15-KM.UP13+KM.RAM
  763E*   23             C      	INC	HL
  763F*   7E             C      	LD	A,(HL)
  7640*   CD 75E1*       C      	CALL	KM.UP15-KM.UP13+KM.RAM
  7643*   E1             C      	POP	HL
  7644*   E5             C      	PUSH	HL
  7645*   11 3640        C      	LD	DE,SD.BWSA + 20*80	;640H
  7648*   06 00          C      	LD	B,0
  764A*   7E             C      	LD	A,(HL)
  764B*   CD 75C6*       C      	CALL	KM.UP43
  764E*   12             C      	LD	(DE),A
  764F*   23             C      	INC	HL
  7650*   13             C      	INC	DE
  7651*   10 F7          C      	DJNZ	$-7
  7653*   E1             C      	POP	HL
  7654*                  C      KM.UP40:
  7654*   CD 75A6*       C      	CALL	KM.UP41
  7657*   F1             C      	POP	AF
'Kmbg'	MACRO-80 3.44	09-Dec-81	PAGE	1-91


  7658*   C9             C      	RET
                         C      
  7659*                  C      KM.UPEND	EQU	$
                         C      
                         C      ;SM.FKTAB	EQU	00D00H
  0DA8                   C      KM.TTABU  EQU	00DA8H
  0DAE                   C      KM.TNEWL  EQU	00DAEH
  0DB0                   C      KM.TEINA  EQU	00DB0H
  0E66                   C      KM.PUFF   EQU	00E66H
                         C      
  201D                   C      KM.MANZ   EQU	0201DH
  2060                   C      KM.MHOME  EQU	02060H
  23BA                   C      KM.MINSL  EQU	023BAH
                         C      ;ATACO    EQU	024F8H
                         C      
  2B03*                  C      KM.KMTAB  EQU	UB.KTAB
                         C      ;         DEFS  17,0
                         C      ;SD.BWSA  EQU	03000H
                         C      
  5C92*                  C      KM.KARO   EQU	KR.KARO   ;05A93H
                         C      
                         C      ;DRUZ     EQU	07C00H
                         C      
  75DB*                  C      KM.RAM    EQU	KM.UP13   ;0FF80H
                         C      
                         C      			;(C) Rainer Sieber     A d W
                         C      
                         C      
                         C      ;	END
                                ;
                                	TITLE 'Symbolliste S1b'
                                	END
'Symbolliste S1b'	MACRO-80 3.44	09-Dec-81	PAGE	S


Macros:

Symbols:
0030 	AKB             225C 	ATACO           0001 	BC.AGG          
0000 	BC.EGG          FA3A 	BC.END          E000 	BC.TAB1         
F902 	BC.TAB2         F96A 	BC.TAB2A        F9D2 	BC.TAB3         
E002 	BC.VTABA        EC82 	BC.VTABE        58B2*	CP.COMPR        
5915*	CP.INIT         58E5*	CP.KOM          58B7*	CP.NL           
58E5*	CP.OUT          58C5*	CP.OUTT         58EC*	CP.SOKOM        
5902*	CP.SOSTR        58CA*	CP.SPACE        58C1*	CP.STRNG        
5907*	CP.TAB          58D5*	CP.TEXT         5BB2*	CRC0            
5BB6*	CRC1            5BC9*	CRC2            591B*	DC.DCMPR        
5951*	DC.EOSPC        5956*	DC.INIT         591D*	DC.NL           
5941*	DC.SPACE        5937*	DC.TAB          5929*	DC.TEXT         
6AE2*	FD.BMGF         680C*	FD.DASU         6946*	FD.DECBZ        
69FD*	FD.DECHL        6ABD*	FD.DSPBB        6ACD*	FD.DSPBG        
6A72*	FD.END          6A9B*	FD.FDIN2        6859*	FD.FDINP        
68AC*	FD.FDOUT        68C9*	FD.FDOUT1       68E2*	FD.FDOUT2       
68E6*	FD.FDOUT3       6910*	FD.FDOW1        6914*	FD.FDOW2        
6939*	FD.FDOW3        692B*	FD.FDOW4        6900*	FD.FDOWR        
6950*	FD.FDUP         6A79*	FD.FOLWR        6A06*	FD.FOUT1        
6992*	FD.FSTRT        6805*	FD.KO01         67ED*	FD.POSK         
6AD7*	FD.RDEND        68A0*	FD.SDIN         6982*	FD.SDK0         
698C*	FD.SDK1         6978*	FD.SDK2         68FA*	FD.SDOUT        
6968*	FD.SDOW         69DF*	FD.SETJ         69F7*	FD.SETN         
69CA*	FD.STRT1        6828*	FD.WRRES        2B01*	K0.HSB          
2B02*	K0.LPD          5AB0*	K1.BRKMB        5BAF*	K1.CRC          
5AF1*	K1.KERN         6739*	KH.ANZB1        6744*	KH.ANZB2        
674C*	KH.ANZB3        674E*	KH.ANZB4        6736*	KH.ANZBL        
676E*	KH.AZ1Z         679F*	KH.AZ4B0        67C0*	KH.AZ4B1        
67AF*	KH.AZ4B3        679B*	KH.AZ4BY        6792*	KH.AZADR        
6755*	KH.AZBL1        6752*	KH.AZBLD        67DF*	KH.BILO         
67D9*	KH.BLEV1        67DB*	KH.BLEV2        67C4*	KH.BLEVG        
66E8*	KH.BMM          66E0*	KH.BMP          66BA*	KH.KSRA         
6674*	KH.KSRE         66C6*	KH.KSRM         66C9*	KH.KSRP         
6677*	KH.KSRW         6677*	KH.RD1          6765*	KH.RD2          
6681*	KH.RD3          6703*	KH.RDBA         6714*	KH.RDBM         
6725*	KH.RDSL         6669*	KH.RDSTA        6674*	KH.RES          
66FD*	KH.SYSRT        66F9*	KH.WBM          66ED*	KH.WREC         
66FB*	KH.WSL          6309*	KI.KM           62CA*	KI.KN           
6370*	KI.KO03         62ED*	KI.NMR          637B*	KI.RENA         
6398*	KI.RENA9        6352*	KI.VERZ         750D*	KM.ABS          
7512*	KM.ABS1         735A*	KM.ANF          73CA*	KM.CL           
73D9*	KM.CNZA         73ED*	KM.CNZA1        73AC*	KM.CO           
73D4*	KM.CR           73BD*	KM.CU           754F*	KM.DEL          
742E*	KM.EINA         7439*	KM.EINA1        7440*	KM.EINA2        
7447*	KM.EINA3        744E*	KM.EINA4        7459*	KM.EINA5        
745C*	KM.EINA6        745F*	KM.EINA7        7476*	KM.EINA8        
7483*	KM.EINA9        7497*	KM.EINAA        7498*	KM.EINAB        
74A3*	KM.EINAC        74AB*	KM.EINAD        74BF*	KM.EINAE        
73B8*	KM.HOME         5C92*	KM.KARO         2B03*	KM.KMTAB        
757A*	KM.LOE1         7584*	KM.LOE2         758C*	KM.LOE3         
201D 	KM.MANZ         2060 	KM.MHOME        23BA 	KM.MINSL        
7409*	KM.NEWL         0E66 	KM.PUFF         75DB*	KM.RAM          
73C2*	KM.SL           73CF*	KM.SR           0DB0 	KM.TEINA        
0DAE 	KM.TNEWL        0DA8 	KM.TTABU        760D*	KM.TX1          
7609*	KM.TX2          755A*	KM.UP1          7592*	KM.UP10         
7593*	KM.UP11         759C*	KM.UP12         75DB*	KM.UP13         
75EE*	KM.UP14         75E1*	KM.UP15         755D*	KM.UP2          
74CE*	KM.UP20         74DF*	KM.UP21         74E9*	KM.UP22         
74FD*	KM.UP23         74FF*	KM.UP24         7508*	KM.UP25         
7565*	KM.UP3          751C*	KM.UP30         7528*	KM.UP31         
7534*	KM.UP32         7537*	KM.UP33         753B*	KM.UP34         
7547*	KM.UP35         752F*	KM.UP36         75F7*	KM.UP4          
7654*	KM.UP40         75A6*	KM.UP41         75BB*	KM.UP42         
75C6*	KM.UP43         75D8*	KM.UP44         756E*	KM.UP5          
7659*	KM.UPEND        5DE3*	KO.KO04         5BA5*	KOMED           
5C8B*	KR.CKRA         5BDB*	KR.GR1          5BE5*	KR.GR2          
5BE7*	KR.GR3          5C92*	KR.KARO         5D10*	KR.KCL          
5D1F*	KR.TYPT         5C96*	KR.VORSP        5CBD*	KR.XKA1         
5CE1*	KR.YKA1         5CF6*	KR.YKA2         732F*	KU.DD           
732C*	KU.DECIY        72C7*	KU.TAB2L        72BE*	KU.VVOR         
72FF*	KU.ZEIR         6411*	KV.ANF          6634*	KV.ANZ          
64E1*	KV.AUSG         664A*	KV.AVZS         65BC*	KV.BSTR         
661F*	KV.DBCVM        65A4*	KV.DRU          65A2*	KV.DRU1         
65B1*	KV.KO02         6556*	KV.KRW          658A*	KV.P1           
662A*	KV.SBC          65E9*	KV.SPTR         647A*	KV.TABTR        
64C0*	KV.ZEIHO        6445*	KV.ZLTR         6FDE*	KX.ENDR         
6FFD*	KX.EXEC2        6FD3*	KX.RSPFR        702D*	KX.UPA          
72B7*	KY.AJ           70D9*	KY.ATAA         70FC*	KY.ATAB         
710D*	KY.ATABE        719E*	KY.COPY         7068*	KY.DFR          
724B*	KY.EOV          715A*	KY.EVZ          715D*	KY.EVZ1         
'Symbolliste S1b'	MACRO-80 3.44	09-Dec-81	PAGE	S-1


728A*	KY.EWK          70D6*	KY.EZYK1        729A*	KY.JHL          
71FE*	KY.KOP          7218*	KY.KOPAN        71F8*	KY.KOPV         
704A*	KY.MD           70D0*	KY.NDA          7141*	KY.NE           
72A3*	KY.SATR         70C2*	KY.SVGL         71C2*	KY.VSCHR        
7175*	KY.VSTR         70B7*	KY.VZVGL        711B*	KY.WEI          
712F*	KY.ZYK          6B2A*	LD.DATFU        6B05*	LD.DATN         
6B4B*	LD.DATPO        6BC6*	LD.LAD1         6BB5*	LD.LAD2         
6BB2*	LD.LADER        6BDB*	LD.LADF         6B1A*	LD.LD2          
6B24*	LD.LD21         6BAD*	LD.LD3          6B6B*	LD.LD4          
6B86*	LD.LD5          6BD2*	LD.LDEND        6BA3*	LD.START        
0080 	MAXBL           60E5*	POSIK1          4040 	PRINT           
4070 	PUF.KASS        6BE1*	RL.BEG          6CED*	RL.BF           
6CD9*	RL.DATNV        6CD4*	RL.ECHO         6CEF*	RL.FMELD        
6C72*	RL.M10          6C83*	RL.M11          6C12*	RL.M12          
6C50*	RL.M13          6C60*	RL.M14          6C68*	RL.M15          
6C01*	RL.M16          6C2F*	RL.M17          6C96*	RL.M21          
6CE9*	RL.MN           6CDD*	RL.OB           6CE1*	RL.RA           
6CE5*	RL.SV           6BF6*	RL.UG           6C89*	RL.UP6          
5B9D*	RLAD            5B98*	RRET            3000 	SD.BWSA         
8010 	SD.PFFI         8830 	SD.TPA          0DC6 	SM.END          
001C 	SM.FABS         000C 	SM.FDEL         0003 	SM.FDOWN        
0CE0 	SM.FKTAB        0005 	SM.FLEFT        0008 	SM.FLTAB        
0002 	SM.FNL          0006 	SM.FPOS1        0007 	SM.FRIGHT       
000A 	SM.FRTAB        0009 	SM.FUP          0E65 	SM.PUFFS        
0CE0 	SM.STACK        0DAA 	SM.TABU         0E5A 	SM.ZEIN         
5B94*	STF07           5B8A*	STF99           5B91*	STFRS           
5B48*	STT02           5B66*	STT08           5B22*	STT11           
5B22*	STT15           5B22*	STT21           5B22*	STT31           
5B22*	STT41           5B39*	STT5            5B2E*	STT51           
5B32*	STT61           5B36*	STT71           5B36*	STT75           
6DFD*	SV.BYANZ        6E8E*	SV.DALO1        6D2B*	SV.DATN         
6E08*	SV.DATS1        6D42*	SV.DATV1        6D4A*	SV.DATVO        
6E22*	SV.SAVE         6E33*	SV.SAVE1        6D84*	SV.SAVE3        
6D99*	SV.SAVE4        6DE1*	SV.SAVE5        6DD7*	SV.SAVE6        
6E86*	SV.STAD0        6D1E*	SV.SV20         6D36*	SV.SV21         
6D50*	SV.SV30         6D6A*	SV.SV31         6D58*	SV.SV37         
6E76*	SV.SVEN1        6E73*	SV.SVEN2        6E4A*	SV.SVLS         
6E66*	SV.SVLS1        6E50*	SV.SVLS2        6E99*	SV.SVSZ         
6EAD*	SV.SVSZ1        6E9B*	SV.SVSZ2        4036 	SY.RESC         
4033 	SY.SETCHL       000B 	SY.SYSTB        4026 	TA.ABFR1        
5476*	U1.AUS          55B1*	U1.BILO         542B*	U1.BREAD        
5436*	U1.BWRIT        5411*	U1.CLRB         5445*	U1.COPB         
5441*	U1.COPB2        5496*	U1.DSVG         546D*	U1.EIN          
55AB*	U1.INFO         5420*	U1.KBR4         55E6*	U1.KRWE         
54FB*	U1.KTIN1        54E2*	U1.KTINI        54C7*	U1.NMVGL        
55CF*	U1.PRADR        5408*	U1.RRST         5400*	U1.RSAVE        
55A6*	U1.TR           55C5*	U1.TST          5518*	U1.VERIN        
5520*	U1.VERNI        5542*	U1.VORS1        553A*	U1.VORST        
547F*	U1.VS1          5486*	U1.VSX          554E*	U1.VZS          
542A*	U1.WAIT         607A*	UA.ALTR         6061*	UA.ANZWD        
5F33*	UA.BMGF         5F44*	UA.DF           5F3D*	UA.DOK          
5E04*	UA.DS           5EC1*	UA.EABFR        5F2D*	UA.FRZ          
5E7C*	UA.GER          5E24*	UA.KNAME        5E4A*	UA.KOMMT        
5E8B*	UA.KOPFR        6036*	UA.LD           5E37*	UA.NR           
5F97*	UA.STADR        5EF7*	UA.VORH         5E5D*	UA.Z7E          
6016*	UA.ZKBA         5F71*	UA.ZKBEG        5FF0*	UA.ZKBEL        
6003*	UA.ZKBLG        6020*	UA.ZKBM         5F4B*	UA.ZKDAT        
5FAA*	UA.ZKDL         6036*	UA.ZKEE         5F84*	UA.ZKEND        
5FBD*	UA.ZKF          5F5E*	UA.ZKLAD        5FC8*	UA.ZKRES        
5FDB*	UA.ZKSDT        6029*	UA.ZKSL         6048*	UA.ZRSCH        
2B6E*	UB.DTAB         2B97*	UB.END          2B03*	UB.KTAB         
2B1E*	UB.KTABE        2B26*	UB.PAR1         2B28*	UB.PAR2         
2B2A*	UB.PAR3         2B2C*	UB.PAR4         2B2E*	UB.PAR5         
2B30*	UB.PATAB        2B34*	UB.SATZ         2B00*	UB.ZN           
57F2*	UC.ASCCO        57CF*	UC.CKONV        5699*	UC.CVABX        
56B4*	UC.CVAX         56C8*	UC.CVAXB        5792*	UC.CVBC         
5722*	UC.CVBD         572D*	UC.CVBD0        5720*	UC.CVBD1        
571C*	UC.CVBD2        5718*	UC.CVBD3        5714*	UC.CVBD4        
5710*	UC.CVBD5        56A3*	UC.CVBX         57A3*	UC.CVCB         
578A*	UC.CVD1B        5761*	UC.CVDB         56BF*	UC.CVHLX        
56EA*	UC.CVX1B        5705*	UC.CVXA         56D9*	UC.CVXB         
56F3*	UC.CVXER        568B*	UC.DIVR         57C4*	UC.DK1          
57D8*	UC.DK2          5852*	UC.DKOI         57B0*	UC.DKONV        
5672*	UC.HL10C        566B*	UC.HL10N        57BA*	UC.KONV         
57EE*	UC.KONV2        5AB0*	UE.BRKMB        3000 	UE.BWSA         
0060 	UE.COTAL        5BAF*	UE.CRC          0DC6 	UE.EDEND        
0132 	UE.KMPUL        8010 	UE.KPUFF        0E65 	UE.PUF          
0CE0 	UE.STANF        007D 	UE.SVL          000B 	UE.SYSTB        
00F7 	UE.TACL         00F9 	UE.TACR         001E 	UE.TAQUI        
00CD 	UE.TASYS        8830 	UE.TEXAN        0E5A 	UE.ZEIN         
5DA6*	UF.AZVB         5DDB*	UF.BEHB         5DE3*	UF.BEHB1        
5D5A*	UF.ERANZ        5D2A*	UF.EXEC         5D51*	UF.EXEC1        
5D4E*	UF.EXEC2        5DF8*	UF.FL14         5DFB*	UF.FL16         
'Symbolliste S1b'	MACRO-80 3.44	09-Dec-81	PAGE	S-2


5DF5*	UF.FL17         5DE9*	UF.FL18         5D25*	UF.RET          
5D96*	UF.SYS          5DA2*	UF.SYS1         6142*	UK.GETK         
6163*	UK.GETK2        616B*	UK.GETK3        6171*	UK.GETK4        
6167*	UK.GETK5        622F*	UK.KBA          61A2*	UK.KBW          
61E0*	UK.KBW1         61DC*	UK.KBW2         617F*	UK.KLPFB        
620A*	UK.KSPFB        61E6*	UK.PUTK         5A64*	UR.ALPH1        
5A5B*	UR.ALPHA        5A6F*	UR.ALPNU        5996*	UR.BBSA1        
598E*	UR.BBSAD        5AA0*	UR.BILR1        5A8E*	UR.BILRO        
6111*	UR.BM           599E*	UR.DSPZK        5A79*	UR.HEXAZ        
5A86*	UR.HEXZ1        60BE*	UR.KBM          60D0*	UR.KBR          
60CA*	UR.KBV          60B8*	UR.KLR          60B2*	UR.KLV          
60AC*	UR.KRA          609A*	UR.KRE          609E*	UR.KRE1         
60A2*	UR.KRW          60A8*	UR.KRWW         60C4*	UR.KSL          
60EA*	UR.LES          595C*	UR.MIMO         5978*	UR.MIMO1        
5970*	UR.MIMO2        597F*	UR.MIMO3        5A66*	UR.NUM          
611F*	UR.OK           60DF*	UR.POSIK        59EE*	UR.RET0         
60D6*	UR.RPOS         613E*	UR.RSP          5A88*	UR.TAREP        
59F8*	UR.TCL          5A0A*	UR.TCLN         5A0D*	UR.TCR          
5A1E*	UR.TCRN         5A28*	UR.TQUIT        5A20*	UR.TSYS         
59AB*	UR.ZINP         59B1*	UR.ZINP1        59B4*	UR.ZINP2        
59E2*	UR.ZINP3        59E8*	UR.ZINP4        59D0*	UR.ZINP5        
59F1*	UR.ZINP7        5A56*	UR.ZKON1        5A30*	UR.ZKONT        
55ED*	XY.CALP1        55F6*	XY.CALPE        5641*	XY.INCDX        
565A*	XY.JMPDX        5601*	XY.LDDX         5611*	XY.LIDX         
5621*	XY.STDX         5631*	XY.STIDX        



No Fatal error(s)


