	TITLE	'Initialisieren von MRES Kassetten'	PAGE;	PN	KI;----------------------------------------------------------------------;;      INITIALISIEREN VON MRES KASSETTEN;;----------------------------------------------------------------------	DW	$	DB	'INIT'	LD	A,(UE.BWSA+327H)	CALL	U1.TST	RET	C	PUSH	AF	CALL	U1.KTINI	POP	AF	LD	(IX+3),A	;GERAETEADR. -->TAB	CALL	UR.KRE	;RES. EIN	BIT	2,(IX)	JR	Z,$+7	LD	A,19H	CALL	UF.ERANZ	CALL	UR.KRWW	;RUECKSPULEN MIT WARTEN	CALL	UR.KBM	;BM SCHREIBEN	LD	HL,UE.PUF	;AUFBAU 1.BLOCK	LD	A,40H	LD	B,80	CALL	U1.TR	LD	A,00H	LD	B,48	CALL	U1.TR	LD	(IX+10),80H	LD	(IX+4),00H	;CMD SCHREIBEN	CALL	UF.EXEC	CALL	KI.KO03KI.KN:	CALL	U1.BILO	LD	A,13	LD	(UB.ZN),A	;ZEILENNR. 15	LD	HL,UA.KNAME	;ABFRAGE KASS.NAME	CALL	UR.MIMO	RET	C	LD	B,6	LD	DE,UE.PUF+4	;NAME IN PUFFER	CALL	UC.KONV	;MIT KONVERTIERUNG IN DKOI-CODEKI.NMR:	LD	HL,UA.NR	;ABFR. KASS.NUMMER	CALL	UR.MIMO	JR	C,KI.KN	;BEI SYS-TASTE ZU VORHERIGER	LD	B,3	LD	DE,UE.PUF+37	CALL	UC.KONVKI.KM:	LD	HL,UA.KOMMT	;ABFR. KOMMENTAR	CALL	UR.MIMO	JR	C,KI.KN	LD	B,11	LD	DE,UE.PUF+40	CALL	UC.KONV	CALL	UF.EXEC	;3.BLOCK SCHREIBEN	CALL	UR.KBM	;BM , 1.LABEL BEENDET	LD	HL,UA.ALTR	LD	DE,UE.PUF	LD	BC,20H	LDIR		;AUSGLEICH LFWSTLNZ->PUFFER	LD	(IX+10),20H	;NEUE BLOCKLAENGE	LD	(IX+4),00H	CALL	UF.EXEC	;SCHREIBEN	LD	HL,UA.DS	LD	DE,UE.PUF	LD	BC,32	LDIR		;DS-SATZ --> PUFFER	CALL	UF.EXEC	LD	A,0A5H	LD	B,32	LD	HL,UE.PUF	CALL	U1.TR	LD	B,68H	;103 VERZ.SAETZEKI.VERZ:	PUSH	BC	CALL	UF.EXEC	POP	BC	DJNZ	KI.VERZ	CALL	UR.KBM	CALL	U1.VS1	;1.DATEIVORSATZ -->PUFFER	LD	(IX+4),00H	CALL	UF.EXEC	CALL	UR.KSL	;SCHLUSSLUECKE SCHREIBEN	CALL	UR.KRW	CALL	UR.KRA	RET;KI.KO03:	CALL	UF.EXEC	;FUER KI14	LD	B,49	DEC	HL	DJNZ	$-1	LD	(HL),0D9H	RET;---------------------------------------------------------------------;	END