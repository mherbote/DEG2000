''	MACRO-80 3.44	09-Dec-81	PAGE	1


                         C      	INCLUDE K0.ASM	;EQUAL - Anweisungen fuer Assembler
                         C      	TITLE 'EQUAL - Anweisungen fuer Assembler'
                         C      	PAGE	87
'EQUAL - Anweisungen fuer Assembler'	MACRO-80 3.44	09-Dec-81	PAGE	1-1


                         C      
                         C      ;         PN    UE01
                         C      ;****************************************************************
                         C      ;*                  EQUAL - Anweisungen fuer Assembler          *
                         C      ;****************************************************************
  00F7                   C      UE.TACL  EQU	0F7H	;Kursor nach links
  00F9                   C      UE.TACR  EQU	0F9H	; ''    nach rechts
  00CD                   C      UE.TASYS EQU	0CDH	;SYS-Taste
  001E                   C      UE.TAQUI EQU	01EH	;ET1
  007D                   C      UE.SVL   EQU	07DH	;Laenge der SAVE-Bloecke
  0060                   C      UE.COTAL EQU	060H	;Laenge ASC/KOI Codetabelle
  0132                   C      UE.KMPUL EQU	132H	;max. Laenge E/A-Puffer
                         C      
  000B                   C      UE.SYSTB EQU	0000BH	;SY.SYSTB
  0CFE                   C      UE.STANF EQU	00CFEH	;STACK
  0DC4                   C      UE.EDEND EQU	00DC4H	;Speicherpl. fuer Adr. Editorende
  0E5A                   C      UE.ZEIN  EQU	00E5AH	;Pufferzaehler Eingabe
  0E66                   C      UE.PUF   EQU	00E66H	;System-Puffer
  3000                   C      UE.BWSA  EQU	03000H	;Bildwiederholspeicher
  8010                   C      UE.KPUFF EQU	08010H	;E/A Puffer
  8830                   C      UE.TEXAN EQU	08830H	;Begin Editorraum
                         C      
  4000'                  C      UE.BRKMB EQU	K1.BRKMB ;04000H	;phys. Kass.Routine
  40F2'                  C      UE.CRC   EQU	K1.CRC	;04740H	;CRC-Berechnung
                         C      
  6EE6                   C      UE.TARO  EQU	06EE6H	;Tast.Routine
  7C00                   C      UE.PRINT EQU	07C00H	;Ausgabe (A) auf Drucker
                         C      
                         C      ;         END
                         C      ;         PN    UB
                         C                ORG   2B00H
  2B00'                  C      UB.ZN:    DS	1,0
  2B01'                  C      UB.KTAB:  DS	27,0
  2B1C'   0000           C      UB.PAR1:  DW	0
  2B1E'   0000           C      UB.PAR2:  DW	0
  2B20'   0000           C      UB.PAR3:  DW	0
  2B22'   0000           C      UB.PAR4:  DW	0
  2B24'   0000           C      UB.PAR5:  DW	0
  2B26'                  C      UB.PATAB: DS	4,0
  2B2A'   00             C      UB.SATZ:  DB	0
  2B2B'   37             C                DB	55
  2B2C'   80             C                DB	80H
  2B2D'   20 20 20 20    C                DB	'                                                       '
  2B31'   20 20 20 20    C      
  2B35'   20 20 20 20    C      
  2B39'   20 20 20 20    C      
  2B3D'   20 20 20 20    C      
  2B41'   20 20 20 20    C      
  2B45'   20 20 20 20    C      
  2B49'   20 20 20 20    C      
  2B4D'   20 20 20 20    C      
  2B51'   20 20 20 20    C      
  2B55'   20 20 20 20    C      
  2B59'   20 20 20 20    C      
  2B5D'   20 20 20 20    C      
  2B61'   20 20 20       C      
  2B64'                  C      UB.DTAB:  DS	41,0
  2B8D'                  C      UB.END    EQU	$
                         C      ;         END
                         C      ;         PN    BC
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;        BEREICHE FUER KASSETTENKOPIEREN
                         C      ;
                         C      ;----------------------------------------------------------------------
  E000                   C      BC.TAB1    EQU	0E000H
  0000                   C      BC.EGG     EQU	0	;EINGABEGERAET
  0001                   C      BC.AGG     EQU	1	;AUSGABEGERAET
  E002                   C      BC.VTABA   EQU	0E002H
  EC82                   C      BC.VTABE   EQU	0E002H+3200
  F902                   C      BC.TAB2    EQU	0E002H+3200+3200
  F96A                   C      BC.TAB2A   EQU	0E002H+3200+3200+104
  F9D2                   C      BC.TAB3    EQU	0E002H+3200+3200+104+104
  FA3A                   C      BC.END     EQU	0E002H+3200+3200+104+104+104
                         C      ;	ORG	0E000H
                         C      ;BC.TAB1:   DS	2
                         C      ;
                         C      ;BC.EGG     EQU	0	;EINGABEGERAET
                         C      ;BC.AGG     EQU	1	;AUSGABEGERAET
                         C      ;----------------------------------------------------------------------
                         C      ;BC.VTABA:  DS	3200
                         C      ;BC.VTABE:  DS	3200
'EQUAL - Anweisungen fuer Assembler'	MACRO-80 3.44	09-Dec-81	PAGE	1-2


                         C      ;----------------------------------------------------------------------
                         C      ;BC.TAB2:   DS	104
                         C      ;BC.TAB2A:  DS	104
                         C      ;BC.TAB3:   DS	104
                         C      ;BC.END     EQU	$
                         C      ;----------------------------------------------------------------------
                         C      ;         END
                                ;	
                         C      	INCLUDE K1.ASM	;BAMOS/Emulator  ---  Kassettenmagnetband
                         C      	TITLE 'BAMOS/Emulator  ---  Kassettenmagnetband'
                         C      	PAGE
'BAMOS/Emulator  ---  Kassettenmagnetband'	MACRO-80 3.44	09-Dec-81	PAGE	1-3


                         C      
                         C      ;****************************************************************
                         C      ;*               BAMOS/Emulator  ---  Kassettenmagnetband       *
                         C      ;* OS - Version  -----------------------------------------------*
                         C      ;*               Programmierer: Marcus Herbote                  *
                         C      ;* V 1 . 2       -----------------------------------------------*
                         C      ;*               Stand        : 18.November 2022                *
                         C      ;****************************************************************
                         C      
                         C      ;****************************************************************
                         C      ;*               Geraetebedienroutine fuer Kassettenmagnetband  *
                         C      ;*               Anschluss von zwei Laufwerken K5200            *
                         C      ;*               an einer AKB K5020                             *
                         C      ;*               -----------------------------------------------*
                         C      ;*               E/A-Tabelle                                    *
                         C      ;*               Byte  0   Status                               *
                         C      ;*               Byte  1   Fehlerschluessel                     *
                         C      ;*               Byte  2   Laenge der Daten im Puffer           *
                         C      ;*                         1, 10H, 20H, 80H                     *
                         C      ;*               Byte  3   Basisadresse der AKB                 *
                         C      ;*               Byte  4   Subadresse                           *
                         C      ;*               Byte  5   Kommando                             *
                         C      ;*               Byte  6   HS-Bereich                           *
                         C      ;*               Byte  7   H-Teil Blockadresse                  *
                         C      ;*               Byte  8   L-Teil Blockadresse                  *
                         C      ;*                         n      bei suchen Bandmarke          *
                         C      ;*               -----------------------------------------------*
                         C      ;*               Byte  9 1 0F0H  Startbyte                      *
                         C      ;*               Byte 10 2       Kommando                       *
                         C      ;*               Byte 11 3       Subadresse                     *
                         C      ;*               Byte 12 4       Anzahl BM  bei 71, 75          *
                         C      ;*               Byte 12 4       'B'        bei 51              *
                         C      ;*               Byte 12 4       'S'        bei 61              *
                         C      ;*               Byte 12 4       HS-Bereich bei 02              *
                         C      ;*               Byte 12 4       Laenge     bei 08              *
                         C      ;*               Byte 12 4 0FFH             bei 31,41,21,11,15  *
                         C      ;*               Byte 13 5       H(Puffer)  bei 02              *
                         C      ;*               Byte 13 5       HS-Bereich bei 08              *
                         C      ;*               Byte 13 5 0FFH             bei 51,61,71,75     *
                         C      ;*               Byte 14 6       L(Puffer)  bei 02              *
                         C      ;*               Byte 14 6       H(Puffer)  bei 08              *
                         C      ;*               Byte 15 7       L(Puffer)  bei 08              *
                         C      ;*               Byte 15 7 0FFH             bei 02              *
                         C      ;*               Byte 16 8 0FFH             bei 08              *
                         C      ;****************************************************************
                         C      ;*               Kommandos:                                     *
                         C      ;*                 Hex   Kommando                               *
                         C      ;*                 02    naechsten Record einlesen              *
                         C      ;*                 08    naechsten Record schreiben             *
                         C      ;*                 11    einen Block vorsetzen                  *
                         C      ;*                 15    einen Block ruecksetzen                *
                         C      ;*                 21    umspulen                               *
                         C      ;*                 31    reservieren ein                        *
                         C      ;*                 41    reservieren aus                        *
                         C      ;*                 51    schreiben einer Bandmarke              *
                         C      ;*                 61    schreiben Schlussluecke                *
                         C      ;*                 71    suche n-te Bandmarke vorwaerts         *
                         C      ;*                 75    suche n-te Bandmarke rueckwaerts       *
                         C      ;****************************************************************
                         C      	PAGE
'BAMOS/Emulator  ---  Kassettenmagnetband'	MACRO-80 3.44	09-Dec-81	PAGE	1-4


                         C      
                         C      ;****************************************************************
                         C      ;*               Status                                         *
                         C      ;*               Bit 0     0 Geraet frei                        *
                         C      ;*                         1 Geraet besetzt                     *
                         C      ;*               Bit 1     0                                    *
                         C      ;*                         1 Datentraegerende                   *
                         C      ;*               Bit 2     0 Aufzeichnen erlaubt                *
                         C      ;*                         1 Aufzeichnen verboten               *
                         C      ;*               Bit 3     0 Kassettenseite A                   *
                         C      ;*                         1 Kassettenseite B                   *
                         C      ;*               Bit 4     0 Geraet       bereit                *
                         C      ;*                         1 Geraet nicht bereit                *
                         C      ;*               Bit 5     0 Geraet nicht reserviert            *
                         C      ;*                         1 Geraet       reserviert            *
                         C      ;*               Bit 6     0 Aufzeichnungsverf.  38 CM*S**-1    *
                         C      ;*                         1 Aufzeichnungsverf.  19 CM*S**-1    *
                         C      ;*               Bit 7     0 Kommando fehlerfrei ausgefuehrt    *
                         C      ;*                         1 Fehler (siehe Fehlerschluessel)    *
                         C      ;*               -----------------------------------------------*
                         C      ;*               Fehlerschluessel                               *
                         C      ;*                 Hex   Fehler                                 *
                         C      ;*                 10    falsches Kommando                      *
                         C      ;*                 11    angewaehltes Geraet nicht reserviert   *
                         C      ;*                 12    Subadresse falsch                      *
                         C      ;*                 13    Pufferl. kleiner 12 oder groesser 256  *
                         C      ;*                 14    Ende der Aufzeichnungen auf dieser     *
                         C      ;*                       Kassettenseite (Lesen)                 *
                         C      ;*                 15    angewaehltes Geraet besetzt            *
                         C      ;*                 16    Ende/Anfang der Aufzeichnungen         *
                         C      ;*                       (Bandmarke suchen)                     *
                         C      ;*                 17    gelesener Block laenger 260 Byte       *
                         C      ;*                 18    Bandmarke nicht gefunden               *
                         C      ;*                 19    Aufzeichnen verboten                   *
                         C      ;*                       (mit Kommando: Aufzeichnen)            *
                         C      ;****************************************************************
                         C          PAGE
'BAMOS/Emulator  ---  Kassettenmagnetband'	MACRO-80 3.44	09-Dec-81	PAGE	1-5


                         C      
                         C      ;****************************************************************
                         C      ;*               Hinweise zur Arbeit mit der Geraetebedienr.    *
                         C      ;*                - E/A-Tabelle laden (Basisadresse AKB)        *
                         C      ;*                - Adresse E/A-Tabelle in IX laden             *
                         C      ;*                - laden Schluessel fuer Kommando , Subadresse *
                         C      ;*                    Adresse Eintrittspunkt                    *
                         C      ;*                - Aufruf Geraetebedienroutine immer mit       *
                         C      ;*                    CALL   KR.BRKMB                           *
                         C      ;*                - wird keine Parallelarbeit mit anderen       *
                         C      ;*                  Programmen gewuenscht , kann wie in         *
                         C      ;*                  folgendem Beispiel verfahren werden:        *
                         C      ;*                        ...                                   *
                         C      ;*                        CALL KR.BRKMB ;Aufruf                 *
                         C      ;*                  MARKE:HALT                                  *
                         C      ;*                        JR   MARKE-#                          *
                         C      ;*                  ADREP:............  ;Adresse Eintrittspunkt *
                         C      ;*                        ...                                   *
                         C      ;*                - bei Rueckkehr der Bedienroutine zum Ein-    *
                         C      ;*                  trittspunkt ist die Adresse des folgenden   *
                         C      ;*                  Befehls , bei dem der letzte Interrupt      *
                         C      ;*                  angenommen wurde , noch im SP .             *
                         C      ;*                  Wird , wie im obigen Beispiel , diese       *
                         C      ;*                  Adresse nicht mehr benoetigt , so ist der   *
                         C      ;*                  SP  um 2 zu erhoehen.                       *
                         C      ;****************************************************************
                         C      	TITLE	'Steuerteil Geraetebedienroutine'
                         C          PAGE
'Steuerteil Geraetebedienroutine'	MACRO-80 3.44	09-Dec-81	PAGE	1-6


                         C      
                         C      	ORG	04000H
                         C      ;****************************************************************
                         C      ;*               Steuerteil der Geraetebedienroutine            *
                         C      ;****************************************************************
  4000'                  C      K1.BRKMB:
  4000'   F3             C          DI
  4001'   CD 40DA'       C          CALL    RRET
                         C      
                         C      ;****************************************************************
                         C      ;*               Analyse Kommando                               *
                         C      ;****************************************************************
  4004'   DD 7E 05       C          LD  A,(IX+5)
  4007'   FE 02          C          CP  002H    ;naechsten Record einlesen
  4009'   CA 408A'       C          JP  Z,STT02
  400C'   FE 08          C          CP  008H    ;naechsten Record schreiben
  400E'   CA 40A8'       C          JP  Z,STT08
  4011'   FE 11          C          CP  011H    ;einen Block vorsetzen
  4013'   CA 4062'       C          JP  Z,STT11
  4016'   FE 15          C          CP  015H    ;einen Block ruecksetzen
  4018'   CA 4062'       C          JP  Z,STT15
  401B'   FE 21          C          CP  021H    ;umspulen
  401D'   CA 4062'       C          JP  Z,STT21
  4020'   FE 1F          C          CP  031     ;reservieren ein
  4022'   CA 4062'       C          JP  Z,STT31
  4025'   FE 29          C          CP  041     ;reservieren aus
  4027'   CA 4062'       C          JP  Z,STT41
  402A'   FE 33          C          CP  051     ;schreiben einer Bandmarke
  402C'   CA 406E'       C          JP  Z,STT51
  402F'   FE 3D          C          CP  061     ;schreiben Schlussluecke
  4031'   CA 4072'       C          JP  Z,STT61
  4034'   FE 47          C          CP  071     ;suche n-te Bandmarke vorwaerts
  4036'   CA 4076'       C          JP  Z,STT71    
  4039'   FE 4B          C          CP  075     ;suche n-te Bandmarke rueckwaerts
  403B'   CA 4076'       C          JP  Z,STT75
  403E'   C3 40D6'       C          JP  STF07   ;falsches Kommando
                         C      
                         C      ;****************************************************************
                         C      ;*               Kernroutine MB                                 *
                         C      ;****************************************************************
  4041'                  C      Kern:
  4041'   DD 36 09 F0    C          LD  (IX+9),0F0H
  4045'   DD 77 0A       C          LD  (IX+10),A   ;Kommando
  4048'   DD 7E 04       C          LD  A,(IX+4)
  404B'   DD 77 0B       C          LD  (IX+11),A   ;Subadresse
                         C      
  404E'   DD 4E 03       C          LD  C,(IX+3)    ;Basisadresse der AKB
  4051'   DD E5          C          PUSH    IX
  4053'   E1             C          POP HL
  4054'   11 0009        C          LD  DE,9
  4057'   19             C          ADD  HL,DE
  4058'   ED B3          C          OTIR            ;KM - Routine aufrufen
  405A'   DD E5          C          PUSH    IX
  405C'   E1             C          POP HL
  405D'   06 03          C          LD  B,3
  405F'   ED B2          C          INIR            ;Status und Fehler holen
  4061'   C9             C          RET
                         C          PAGE
'Steuerteil Geraetebedienroutine'	MACRO-80 3.44	09-Dec-81	PAGE	1-7


                         C      
                         C      ;****************************************************************
                         C      ;*               reservieren ein / aus                          *
                         C      ;****************************************************************
  4062'                  C      STT31:
  4062'                  C      STT41:
                         C      ;****************************************************************
                         C      ;*               umspulen                                       *
                         C      ;****************************************************************
  4062'                  C      STT21:
                         C      ;****************************************************************
                         C      ;*               vor-/ruecksetzen um einen Block                *
                         C      ;****************************************************************
  4062'                  C      STT11:
  4062'                  C      STT15:
  4062'   DD 36 0C FF    C          LD  (IX+12),0FFH
                         C      
  4066'   06 04          C          LD  B,4
  4068'   CD 4041'       C          CALL Kern
  406B'   C3 40E8'       C          JP	KOMED	;Kommandoende
                         C      
                         C      ;****************************************************************
                         C      ;*               schreiben einer Bandmarke                      *
                         C      ;****************************************************************
  406E'                  C      STT51:
  406E'   3E 42          C          LD  A,'B'
  4070'   18 09          C          JR  STT5
                         C      ;****************************************************************
                         C      ;*               schreiben einer Schlussluecke                  *
                         C      ;****************************************************************
  4072'                  C      STT61:
  4072'   3E 53          C          LD  A,'S'
  4074'   18 05          C          JR  STT5
                         C      ;****************************************************************
                         C      ;*               suche Bandmarke vorwaerts / rueckwaerts        *
                         C      ;****************************************************************
  4076'                  C      STT71:
  4076'                  C      STT75:
  4076'   DD 7E 08       C          LD  A,(IX+8)
  4079'   18 00          C          JR  STT5
  407B'                  C      STT5:
  407B'   DD 77 0C       C          LD  (IX+12),A
  407E'   DD 36 0D FF    C          LD  (IX+13),0FFH
                         C      
  4082'   06 05          C          LD  B,5
  4084'   CD 4041'       C          CALL Kern
  4087'   C3 40E8'       C          JP	KOMED	;Kommandoende
                         C          PAGE
'Steuerteil Geraetebedienroutine'	MACRO-80 3.44	09-Dec-81	PAGE	1-8


                         C      
                         C      ;****************************************************************
                         C      ;*               Eingabezweig                                   *
                         C      ;****************************************************************
  408A'                  C      STT02:
  408A'   DD 7E 06       C          LD  A,(IX+6)
  408D'   DD 77 0C       C          LD  (IX+12),A
                         C      
  4090'   DD 7E 07       C          LD  A,(IX+7)
  4093'   DD 77 0D       C          LD  (IX+13),A
  4096'   DD 7E 08       C          LD  A,(IX+8)
  4099'   DD 77 0E       C          LD  (IX+14),A
                         C      
  409C'   DD 36 0F FF    C          LD  (IX+15),0FFH
                         C      
  40A0'   06 07          C          LD  B,7
  40A2'   CD 4041'       C          CALL Kern
  40A5'   C3 40E8'       C          JP	KOMED	;Kommandoende
                         C          
                         C      ;****************************************************************
                         C      ;*               Aufzeichnungszweig                             *
                         C      ;****************************************************************
  40A8'                  C      STT08:
  40A8'   DD 7E 02       C          LD  A,(IX+2)
  40AB'   DD 77 0C       C          LD  (IX+12),A
                         C      
  40AE'   DD 7E 06       C          LD  A,(IX+6)
  40B1'   DD 77 0D       C          LD  (IX+13),A
                         C      
  40B4'   DD 7E 07       C          LD  A,(IX+7)
  40B7'   DD 77 0E       C          LD  (IX+14),A
  40BA'   DD 7E 08       C          LD  A,(IX+8)
  40BD'   DD 77 0F       C          LD  (IX+15),A
                         C      
  40C0'   DD 36 10 FF    C          LD  (IX+16),0FFH
                         C      
  40C4'   06 08          C          LD  B,8
  40C6'   CD 4041'       C          CALL Kern
  40C9'   C3 40E8'       C          JP	KOMED	;Kommandoende
                         C      
                         C          PAGE
'Steuerteil Geraetebedienroutine'	MACRO-80 3.44	09-Dec-81	PAGE	1-9


                         C      
                         C      ;****************************************************************
                         C      ;*               Fehler                                         *
                         C      ;****************************************************************
  40CC'                  C      STF99:
  40CC'   DD 75 01       C      	LD	(IX+1),L	;Fehlerschluessel laden
  40CF'   DD CB 00 FE    C      	SET	7,(IX)	;Fehlerbit setzen
  40D3'                  C      STFRS:
  40D3'   C3 40E8'       C      	JP	KOMED	;Kommandoende
                         C      
  40D6'                  C      STF07:
  40D6'   2E 10          C      	LD	L,10H	;falsches Kommando
  40D8'   18 F2          C      	JR	STF99
                         C      
                         C          PAGE
'Steuerteil Geraetebedienroutine'	MACRO-80 3.44	09-Dec-81	PAGE	1-10


                         C      
                         C      ;****************************************************************
                         C      ;*               Register AF , BC , DE , HL retten in SP        *
                         C      ;****************************************************************
  40DA'                  C      RRET:
  40DA'   DD E5          C          PUSH    IX
  40DC'   E5             C      	PUSH	HL
  40DD'   D5             C      	PUSH	DE
  40DE'   C5             C      	PUSH	BC
  40DF'   F5             C      	PUSH	AF
  40E0'   C9             C          RET
                         C      ;****************************************************************
                         C      ;*               Register AF , BC , DE , HL laden aus SP        *
                         C      ;****************************************************************
  40E1'                  C      RLAD:
  40E1'   F1             C      	POP	AF
  40E2'   C1             C      	POP	BC
  40E3'   D1             C      	POP	DE
  40E4'   E1             C          POP HL
  40E5'   DD E1          C          POP IX
  40E7'   C9             C      	RET
                         C      
                         C      ;****************************************************************
                         C      ;*               Verzweigung aus Steuerteil zum Eintrittspunkt  *
                         C      ;*               des Steuerprogrammes                           *
                         C      ;****************************************************************
  40E8'                  C      KOMED:
  40E8'   F3             C      	DI
  40E9'   DD CB 00 86    C      	RES 0,(IX)
  40ED'   CD 40E1'       C      	CALL	RLAD
  40F0'   FB             C      	EI
  40F1'   C9             C      	RET
                         C          PAGE
'Steuerteil Geraetebedienroutine'	MACRO-80 3.44	09-Dec-81	PAGE	1-11


                         C      
                         C      ;****************************************************************
                         C      ;*               CRC-Zeichen berechnen                          *
                         C      ;*               <B>  = Blocklaenge , 0 = 256                   *
                         C      ;*               <HL> = Pufferadresse                           *
                         C      ;*               in  DE  nach Aufruf CRC-Zeichen                *
                         C      ;*                <D> = 1.Byte , wird zuerst gesendet           *
                         C      ;*                <E> = 2.Byte , wird danach gesendet           *
                         C      ;****************************************************************
  40F2'                  C      K1.CRC:
  40F2'   11 0000        C      	LD	DE,0
  40F5'                  C      CRC0:
  40F5'   C5             C      	PUSH	BC	;Bytelaenge
  40F6'   06 08          C      	LD	B,8
  40F8'   4E             C      	LD	C,(HL)
  40F9'                  C      CRC1:
  40F9'   79             C      	LD	A,C
  40FA'   AA             C      	XOR	D
  40FB'   0F             C      	RRCA		;Ergebnis Antivalenz Wort-Byte/CRC-Byte,Bit 0
  40FC'   F5             C      	PUSH	AF
  40FD'   CB 1B          C      	RR	E	;Verschiebung von DE um 1 Bit nach rechts
  40FF'   CB 1A          C      	RR	D
  4101'   F1             C      	POP	AF	;Rueckretten F
  4102'   30 08          C      	JR	NC,CRC2	;Sprung wenn Antivalenz 0 + 0 = 0
  4104'   7A             C      	LD	A,D	;Korrektur = Umkehr Bit 13/Bit 0
  4105'   EE 01          C      	XOR	1	;Maske fuer D
  4107'   57             C      	LD	D,A	;Korrektur  D
  4108'   7B             C      	LD	A,E
  4109'   EE 20          C      	XOR	20H	;Maske fuer E
  410B'   5F             C      	LD	E,A	;Korrektur  E
  410C'                  C      CRC2:
  410C'   CB 09          C      	RRC	C	;Schieben Datenbyte
  410E'   10 E9          C      	DJNZ	CRC1
  4110'   C1             C      	POP	BC	;Byte abgearbeitet
  4111'   0B             C      	DEC	BC
  4112'   79             C      	LD	A,C
  4113'   B0             C      	OR	B
  4114'   C8             C      	RET	Z
  4115'   23             C      	INC	HL
  4116'   18 DD          C      	JR	CRC0
                         C      
                         C      ;	END
                                ;
                                ;	INCLUDE	KR.ASM	;Kassettengrundroutinen
                                ;	INCLUDE	UF.ASM	;Fehleranzeige und Behandlung
                                ;	INCLUDE	UA.ASM	;Ausschriften
                         C      	INCLUDE K2.ASM	;Grundroutinen
                         C      	TITLE	'Kassettengrundroutinen'
                         C      	PAGE
'Kassettengrundroutinen'	MACRO-80 3.44	09-Dec-81	PAGE	1-12


                         C      
                         C      ;****************************************************************
                         C      ;*               Anschlussroutinen fC<r BAMOS/Emulator           *
                         C      ;* OS - Version  -----------------------------------------------*
                         C      ;*               Programmierer: Marcus Herbote                  *
                         C      ;* V 1 . 2       -----------------------------------------------*
                         C      ;*               Stand        : 18.November 2022                *
                         C      ;****************************************************************
                         C      ;	PN	KR
                         C      ;---------------------------------------------------------------------
                         C      ;        Kassettengrundroutinen
                         C      ;---------------------------------------------------------------------
  4118'   4118'          C      	DW	$
  411A'   4B 31 52 45    C      	DB	'K1RE'
  411E'                  C      KR.GR1:
  411E'   3E 01          C      	LD	A,01H
  4120'   18 08          C      	JR	KR.GR3
                         C      ;
  4122'   4122'          C      	DW	$
  4124'   4B 32 52 45    C      	DB	'K2RE'
  4128'                  C      KR.GR2:
  4128'   3E 02          C      	LD	A,02H
  412A'                  C      KR.GR3:
  412A'   CD 58FF'       C      	CALL	U1.KTINI
  412D'   DD 77 03       C      	LD	(IX+3),A
  4130'   CD 5629'       C      	CALL	UR.KRE
  4133'   C9             C      	RET
                         C      ;-------------------------------------------------------------------
  4134'   4134'          C      	DW	$
  4136'   4B 31 4C 2B    C      	DB	'K1L+'
  413A'   CD 411E'       C      	CALL	KR.GR1
  413D'   18 09          C      	JR	$+11
                         C      ;
  413F'   413F'          C      	DW	$
  4141'   4B 32 4C 2B    C      	DB	'K2L+'
  4145'   CD 4128'       C      	CALL	KR.GR2
  4148'   21 0001        C      	LD	HL,1	; IX + 8 := 1 / Anzahl BM
  414B'   CD 5A36'       C      	CALL	XY.STDX
  414E'   07             C      	DB	7
  414F'   CD 5641'       C      	CALL	UR.KLV
  4152'   C9             C      	RET
                         C      ;---------------------------------------------------------------------
  4153'   4153'          C      	DW	$
  4155'   4B 31 4C 2D    C      	DB	'K1L-'
  4159'   CD 411E'       C      	CALL	KR.GR1
  415C'   18 09          C      	JR	$+11
                         C      ;
  415E'   415E'          C      	DW	$
  4160'   4B 32 4C 2D    C      	DB	'K2L-'
  4164'   CD 4128'       C      	CALL	KR.GR2
  4167'   21 0001        C      	LD	HL,1	; IX + 8 := 1 / Anzahl BM
  416A'   CD 5A36'       C      	CALL	XY.STDX
  416D'   07             C      	DB	7
  416E'   CD 5647'       C      	CALL	UR.KLR
  4171'   C9             C      	RET
                         C      ;---------------------------------------------------------------------
  4172'   4172'          C      	DW	$
  4174'   4B 31 52 2B    C      	DB	'K1R+'
  4178'   CD 411E'       C      	CALL	KR.GR1
  417B'   18 09          C      	JR	$+11
                         C      ;
  417D'   417D'          C      	DW	$
  417F'   4B 32 52 2B    C      	DB	'K2R+'
  4183'   CD 4128'       C      	CALL	KR.GR2
  4186'   CD 5659'       C      	CALL	UR.KBV
  4189'   C9             C      	RET
                         C      ;--------------------------------------------------------------------
  418A'   418A'          C      	DW	$
  418C'   4B 31 52 2D    C      	DB	'K1R-'
  4190'   CD 411E'       C      	CALL	KR.GR1
  4193'   18 09          C      	JR	$+11
                         C      ;
  4195'   4195'          C      	DW	$
  4197'   4B 32 52 2D    C      	DB	'K2R-'
  419B'   CD 4128'       C      	CALL	KR.GR2
  419E'   CD 565F'       C      	CALL	UR.KBR
  41A1'   C9             C      	RET
                         C      ;--------------------------------------------------------------------
  41A2'   41A2'          C      	DW	$
  41A4'   4B 31 52 57    C      	DB	'K1RW'
  41A8'   CD 411E'       C      	CALL	KR.GR1
  41AB'   18 09          C      	JR	$+11
'Kassettengrundroutinen'	MACRO-80 3.44	09-Dec-81	PAGE	1-13


                         C      ;
  41AD'   41AD'          C      	DW	$
  41AF'   4B 32 52 57    C      	DB	'K2RW'
  41B3'   CD 4128'       C      	CALL	KR.GR2
  41B6'   CD 5631'       C      	CALL	UR.KRW
  41B9'   18 14          C      	JR	KR.CKRA
                         C      ;---------------------------------------------------------------------
  41BB'   41BB'          C      	DW	$
  41BD'   4B 31 52 41    C      	DB	'K1RA'
  41C1'   CD 411E'       C      	CALL	KR.GR1
  41C4'   18 09          C      	JR	$+11
                         C      ;
  41C6'   41C6'          C      	DW	$
  41C8'   4B 32 52 41    C      	DB	'K2RA'
  41CC'   CD 4128'       C      	CALL	KR.GR2
  41CF'                  C      KR.CKRA:
  41CF'   CD 563B'       C      	CALL	UR.KRA
  41D2'   C9             C      	RET
                         C      ;---------------------------------------------------------------------
  41D3'                  C      KR.KARO:
                         C      ;	LD	(IX+5),LOW(EINTR)	;Wiedereintrittspunkt
                         C      ;	LD	(IX+6),HIGH(EINTR)
  41D3'   CD 4000'       C      	CALL	UE.BRKMB	;AUFRUF PHYS.KASS.ROUTINE
                         C      ;	HALT
                         C      ;	JR	$-1
                         C      ;KR.EINTR:
                         C      ;	INC	SP
                         C      ;	INC	SP
  41D6'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  41D7'                  C      KR.VORSP:
  41D7'   11 3327        C      	LD	DE,UE.BWSA+327H
  41DA'   CD 5B74'       C      	CALL	UC.CVDB
  41DD'   45             C      	LD	B,L
  41DE'   3E 46          C      	LD	A,'F'
  41E0'   32 2B1E'       C      	LD	(UB.PAR2),A
  41E3'   CD 5629'       C      	CALL	UR.KRE
  41E6'   CD 566E'       C      	CALL	UR.POSIK
  41E9'   C9             C      	RET
                         C      ;---------------------------------------------------------------------
  41EA'   41EA'          C      	DW	$
  41EC'   58 4B 41 31    C      	DB	'XKA1'
  41F0'   CD 411E'       C      	CALL	KR.GR1
  41F3'   18 09          C      	JR	$+11
                         C      ;
  41F5'   41F5'          C      	DW	$
  41F7'   58 4B 41 32    C      	DB	'XKA2'
  41FB'   CD 4128'       C      	CALL	KR.GR2
  41FE'   CD 41D7'       C      	CALL	KR.VORSP
  4201'   CD 4B26'       C      	CALL	FD.FDINP
  4204'   CD 5631'       C      	CALL	UR.KRW
  4207'   CD 563B'       C      	CALL	UR.KRA
  420A'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  420B'   420B'          C      	DW	$
  420D'   59 4B 41 31    C      	DB	'YKA1'
  4211'   CD 411E'       C      	CALL	KR.GR1
  4214'   18 09          C      	JR	$+11
                         C      ;
  4216'   4216'          C      	DW	$
  4218'   59 4B 41 32    C      	DB	'YKA2'
  421C'   CD 4128'       C      	CALL	KR.GR2
  421F'   CD 5629'       C      	CALL	UR.KRE
  4222'   11 3327        C      	LD	DE,UE.BWSA+327H
  4225'   CD 5B74'       C      	CALL	UC.CVDB
  4228'   2D             C      	DEC	L
  4229'   28 09          C      	JR	Z,$+11
  422B'   DD 75 0A       C      	LD	(IX+10),L
  422E'   CD 425B'       C      	CALL	KR.TYPT
  4231'   CD 5641'       C      	CALL	UR.KLV
  4234'   CD 4B79'       C      	CALL	FD.FDOUT
  4237'   C9             C      	RET
                         C      ;---------------------------------------------------------------------------
  4238'   4238'          C      	DW	$
  423A'   4B 31 43 4C    C      	DB	'K1CL'
  423E'   CD 411E'       C      	CALL	KR.GR1
  4241'   18 09          C      	JR	$+11
                         C      ;
  4243'   4243'          C      	DW	$
  4245'   4B 32 43 4C    C      	DB	'K2CL'
  4249'   CD 4128'       C      	CALL	KR.GR2
  424C'   CD 564D'       C      	CALL	UR.KBM
  424F'   CD 5653'       C      	CALL	UR.KSL
'Kassettengrundroutinen'	MACRO-80 3.44	09-Dec-81	PAGE	1-14


  4252'   CD 5631'       C      	CALL	UR.KRW
  4255'   CD 563B'       C      	CALL	UR.KRA
  4258'   C3 000B        C      	JP	UE.SYSTB
                         C      ;--------------------------------------------------------------------
  425B'                  C      KR.TYPT:
  425B'   13             C      	INC	DE
  425C'   1A             C      	LD	A,(DE)
  425D'   32 2B1E'       C      	LD	(UB.PAR2),A
  4260'   C9             C      	RET
                         C      ;--------------------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Fehleranzeige und Behandlung'
                         C      	PAGE
'Fehleranzeige und Behandlung'	MACRO-80 3.44	09-Dec-81	PAGE	1-15


                         C      
                         C      ;	PN	UF
                         C      ;***************************************************************
                         C      ;
                         C      ;      Fehleranzeige  UND  BEHANDLUNG
                         C      ;
                         C      ;***************************************************************
  4261'                  C      UF.RET:
  4261'   F1             C      	POP	AF
  4262'   C1             C      	POP	BC
  4263'   D1             C      	POP	DE
  4264'   E1             C      	POP	HL
  4265'   C9             C      	RET
                         C      ;---------------------Ausfhr. Kass.kommando lt.Steuerblock-------------
  4266'                  C      UF.EXEC:
  4266'   E5             C      	PUSH	HL
  4267'   D5             C      	PUSH	DE
  4268'   C5             C      	PUSH	BC
  4269'   F5             C      	PUSH	AF
  426A'   DD CB 00 BE    C      	RES	7,(IX)
  426E'   DD 36 01 00    C      	LD	(IX+1),0
  4272'   CD 41D3'       C      	CALL	KR.KARO
  4275'                  C      UF.EXEC1:
  4275'   3E 41          C      	LD	A,41H
  4277'   DD BE 05       C      	CP	(IX+5)
                         C      ;	JR	Z,UF.EXEC2
                         C      ;	BIT	4,(IX)
                         C      ;	JR	NZ,UF.ERA1
                         C      ;UF.EXEC2:
  427A'   DD CB 00 7E    C      	BIT	7,(IX)
  427E'   28 E1          C      	JR	Z,UF.RET
                         C      ;-------------------------Fehlerbehandlung---------------
                         C      ;UF.ERA1:
                         C      ; 	RES	7,(IX)
                         C      ; 	LD	C,(IX+4)
                         C      ; 	LD	A,(IX+1)
                         C      ; 	JR	$+6
  4280'                  C      UF.ERANZ:
  4280'   E5             C      	PUSH	HL
  4281'   D5             C      	PUSH	DE
  4282'   C5             C      	PUSH	BC
  4283'   F5             C      	PUSH	AF
  4284'   F5             C      	PUSH	AF
  4285'   3E 13          C      	LD	A,19
  4287'   32 2B00'       C      	LD	(UB.ZN),A
  428A'   21 44E3'       C      	LD	HL,UA.ZKF	;IN: <A> Fehlerschluessel
  428D'   CD 56D1'       C      	CALL	UR.MIMO
  4290'   F1             C      	POP	AF
  4291'   F5             C      	PUSH	AF
  4292'   EB             C      	EX	DE,HL
  4293'   CD 5ABA'       C      	CALL	UC.CVBX+2
  4296'   F1             C      	POP	AF
  4297'   FE 17          C      	CP	17H
  4299'   CA 431B'       C      	JP	Z,UF.FL17
  429C'   FE 18          C      	CP	18H
  429E'   CA 430F'       C      	JP	Z,UF.FL18
  42A1'   FE 00          C      	CP	00H
  42A3'   CA 4301'       C      	JP	Z,UF.BEHB
  42A6'   FE 11          C      	CP	11H
  42A8'   CA 4301'       C      	JP	Z,UF.BEHB
  42AB'   FE 19          C      	CP	19H
  42AD'   28 1D          C      	JR	Z,UF.AZVB
  42AF'   FE 14          C      	CP	14H
  42B1'   CA 431E'       C      	JP	Z,UF.FL14
  42B4'   FE 16          C      	CP	16H
  42B6'   CA 4321'       C      	JP	Z,UF.FL16
  42B9'   C3 4261'       C      	JP	UF.RET
                         C      ;----------------------------------------------------------------------
  42BC'                  C      UF.SYS:
  42BC'   DD 7E 01       C      	LD	A,(IX+1)
  42BF'   11 35A8        C      	LD	DE,UE.BWSA+5A8H
  42C2'   CD 5ABA'       C      	CALL	UC.CVBX+2
  42C5'   00             C      	NOP
  42C6'   00             C      	NOP
  42C7'   00             C      	NOP
  42C8'                  C      UF.SYS1:
  42C8'   31 0CFE        C      	LD	SP,UE.STANF
  42CB'   C9             C      	RET
                         C      ;----------------------------------------------------------
  42CC'                  C      UF.AZVB:
  42CC'   DD CB 00 96    C      	RES	2,(IX)	;Aufzeichnen verboten
  42D0'   DD 36 05 41    C      	LD	(IX+5),41H
'Fehleranzeige und Behandlung'	MACRO-80 3.44	09-Dec-81	PAGE	1-16


  42D4'   CD 41D3'       C      	CALL	KR.KARO
  42D7'   DD CB 00 7E    C      	BIT	7,(IX)
  42DB'   20 DF          C      	JR	NZ,UF.SYS
  42DD'   21 4453'       C      	LD	HL,UA.FRZ
  42E0'   CD 56D1'       C      	CALL	UR.MIMO
  42E3'   38 E3          C      	JR	C,UF.SYS1
  42E5'   DD 36 05 31    C      	LD	(IX+5),31H
  42E9'   CD 41D3'       C      	CALL	KR.KARO
  42EC'   DD CB 00 66    C      	BIT	4,(IX)
  42F0'   20 CA          C      	JR	NZ,UF.SYS
  42F2'   DD CB 00 7E    C      	BIT	7,(IX)
  42F6'   20 C4          C      	JR	NZ,UF.SYS
  42F8'   DD CB 00 56    C      	BIT	2,(IX)
  42FC'   20 BE          C      	JR	NZ,UF.SYS
  42FE'   C3 4309'       C      	JP	UF.BEHB1
                         C      ;----------------------------------------------------------
  4301'                  C      UF.BEHB:
  4301'   21 4453'       C      	LD	HL,UA.FRZ
  4304'   CD 56D1'       C      	CALL	UR.MIMO
  4307'   38 BF          C      	JR	C,UF.SYS1
  4309'                  C      UF.BEHB1:
  4309'   DD 71 05       C      	LD	(IX+5),C	;??? Inhalt von C
  430C'   C3 426A'       C      	JP	UF.EXEC+4
                         C      ;---------------------------------------
  430F'                  C      UF.FL18:
                         C      	; LD	B,3
                         C      	; LD	(IX+5),15H
                         C      	; CALL	KR.KARO
                         C      	; BIT	7,(IX)
                         C      	; JP	NZ,UF.SYS
                         C      	; DJNZ	$-14
                         C      	; LD	B,8
                         C      	; LD	(IX+5),02H
                         C      	; CALL	KR.KARO
                         C      	; BIT	7,(IX)
                         C      	; JP	NZ,UF.SYS
                         C      	; LD	A,(IX+9)	;8 BLOECKE LESEN        ;###
                         C      	; OR	(IX+10)                             ;###
                         C      	; JR	Z,$+7
                         C      	; DJNZ	$-22
                         C      	; JP	UF.SYS
  430F'   21 4459'       C      	LD	HL,UA.BMGF
  4312'   CD 56D1'       C      	CALL	UR.MIMO
  4315'   DA 42C8'       C      	JP	C,UF.SYS1
  4318'   C3 4261'       C      	JP	UF.RET
                         C      ;------------------------------------------
  431B'                  C      UF.FL17:
                         C      ; 	LD	B,5
                         C      ; 	RES	7,(IX)
                         C      ; 	LD	(IX+4),15H
                         C      ; 	LD	H,2
                         C      ; 	CALL	KR.KARO
                         C      ; 	BIT	7,(IX)
                         C      ; 	JP	NZ,UF.SYS	;2 BLOECKE ZURUECK
                         C      ; 	DEC	H
                         C      ; 	JR	NZ,$-11
                         C      ; 	LD	(IX+4),C	;WDHLG
                         C      ; 	CALL	KR.KARO
                         C      ; 	BIT	7,(IX)
                         C      ; 	JR	NZ,$+5
                         C      ; 	JP	UF.RET
                         C      ; 	DJNZ	$-38
                         C      ;----------------------------------------------------------------------
                         C      ; 	RES	7,(IX)	;ERMITTELN DER BLOCKLAENGE
                         C      ; 	LD	(IX+5),15H
                         C      ; 	CALL	KR.KARO
                         C      ; 	BIT	7,(IX)
                         C      ; 	JP	NZ,UF.SYS
                         C      ; 	LD	(IX+5),02H
                         C      ; 	CALL	KR.KARO	;NAECHSTEN BLOCK LESEN
                         C      ; 	BIT	7,(IX)
                         C      ; 	JP	NZ,UF.SYS
                         C      ; 	LD	A,(IX+9)                            ;###
                         C      ; 	OR	(IX+10)	;BM ?                       ;###
                         C      ; 	PUSH	AF
                         C      ; 	LD	B,2
                         C      ; 	LD	(IX+5),15H
                         C      ; 	CALL	KR.KARO	;POS.VOR FEHLERHAFTEN BLOCK
                         C      ; 	BIT	7,(IX)
                         C      ; 	JP	NZ,UF.SYS
                         C      ; 	DJNZ	$-10
                         C      ; 	POP	AF
                         C      ; 	JR	NZ,$+35
'Fehleranzeige und Behandlung'	MACRO-80 3.44	09-Dec-81	PAGE	1-17


                         C      ; 	CALL	KR.KARO
                         C      ; 	BIT	7,(IX)
                         C      ; 	JP	NZ,UF.SYS
                         C      ; 	LD	(IX+5),02H
                         C      ; 	CALL	KR.KARO	;BLOCK VOR FEHLERHAFTEN B.LESEN
                         C      ; 	BIT	7,(IX)
                         C      ; 	JP	NZ,UF.SYS
                         C      ; 	LD	A,(IX+9)                            ;###
                         C      ; 	OR	(IX+10)                             ;###
                         C      ; 	JP	Z,UF.SYS	;WENN AUCH BM -->SYS
                         C      ; 	CALL	XY.LIDX	;BLOCKLAENGE -->HL
                         C      ; 	DB	9
                         C      ; 	LD	(IX+5),02H
                         C      ; 	CALL	KR.KARO	;FEHLERHAFTEN BLOCK LESEN
                         C      ; 	LD	B,L
                         C      ; 	LD	HL,UE.PUF
                         C      ; 	CALL	UE.CRC
                         C      ; 	INC	HL
                         C      ; 	LD	B,(HL)
                         C      ; 	INC	HL
                         C      ; 	LD	C,(HL)	;BC=CRC VON KASSETTE
                         C      ; 	EX	DE,HL
                         C      ; 	OR	A
                         C      ; 	SBC	HL,BC
                         C      ; 	JR	Z,$+7
                         C      ; 	LD	HL,UA.DF
                         C      ; 	JR	$+5
                         C      	; LD	HL,UA.DOK
                         C      	; CALL	UR.MIMO
                         C      	; LD	HL,UA.FRZ
                         C      	; CALL	UR.MIMO
                         C      	; JP	C,UF.SYS1
                         C      	; LD	A,(HL)
                         C      	; CP	'I'
                         C      	; JR	Z,$+41
                         C      	; CP	'U'
                         C      	; JR	NZ,$-16
                         C      	; RES	7,(IX)
                         C      	; LD	(IX+5),15H
                         C      	; CALL	KR.KARO
                         C      	; BIT	7,(IX)
                         C      	; JP	NZ,UF.SYS
                         C      	; LD	(IX+5),02H
                         C      	; CALL	KR.KARO	;NAECHSTEN BLOCK EINLESEN
                         C      	; BIT	7,(IX)
                         C      	; JP	NZ,UF.SYS
                         C      	; JP	UF.RET
                         C      	; RES	7,(IX)
                         C      	; LD	(IX+5),15H
                         C      	; CALL	KR.KARO
                         C      	; BIT	7,(IX)
                         C      	; JP	NZ,UF.SYS
                         C      	; LD	(IX+5),02H
  431B'   C3 4261'       C      	JP	UF.RET
                         C      ;-------------------------------------
  431E'                  C      UF.FL14:
  431E'   C3 4261'       C      	JP	UF.RET
                         C      	; LD	HL,UA.FRZ
                         C      	; CALL	UR.MIMO
                         C      	; JP	C,UF.SYS1
                         C      	; LD	A,(HL)
                         C      	; CP	'B'
                         C      	; JR	Z,$+12
                         C      	; CP	'S'
                         C      	; JR	NZ,$-16
                         C      	; LD	(IX+5),61H	;SL SCHREIBEN
                         C      	; JR	$+20
                         C      	; LD	(IX+5),15H
                         C      	; CALL	KR.KARO
                         C      	; BIT	7,(IX)
                         C      	; JP	NZ,UF.SYS
                         C      	; LD	(IX+5),51H	;BM HINTER LETZTEN BLOCK
                         C      	; INC	HL
                         C      	; LD	A,(HL)
                         C      	; CALL	U1.TST
                         C      	; JR	C,UF.FL14
                         C      	; LD	(IX+4),A
                         C      	; CALL	KR.KARO
                         C      	; BIT	7,(IX)
                         C      	; JP	Z,UF.SYS1
                         C      	; JP	UF.SYS
                         C      	; NOP
                         C      	; NOP
'Fehleranzeige und Behandlung'	MACRO-80 3.44	09-Dec-81	PAGE	1-18


                         C      	; NOP
                         C      	; NOP
                         C      	; NOP
                         C      	; NOP
                         C      	; NOP
  4321'                  C      UF.FL16:
  4321'   21 4453'       C      	LD	HL,UA.FRZ
  4324'   CD 56D1'       C      	CALL	UR.MIMO
  4327'   C3 4261'       C      	JP	UF.RET
                         C      	; JP	C,UF.SYS1
                         C      	; LD	A,(IX+5)
                         C      	; XOR	04H	;71 <-----> 75
                         C      	; LD	(IX+5),A
                         C      	; CALL	KR.KARO
                         C      	; BIT	7,(IX)
                         C      	; JP	Z,UF.SYS1
                         C      	; JP	UF.SYS
                         C      	; NOP
                         C      	; NOP
                         C      	; NOP
                         C      	; NOP
                         C      	; NOP
                         C      	; NOP
                         C      	; NOP
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                         C          PAGE
'Fehleranzeige und Behandlung'	MACRO-80 3.44	09-Dec-81	PAGE	1-19


                         C      
                         C      ;--------------------------------------------------------------------
                         C      	TITLE	'Ausschriften'
                         C      	PAGE
'Ausschriften'	MACRO-80 3.44	09-Dec-81	PAGE	1-20


                         C      
                         C      ;	PN	UA01
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;     AUSSCHRIFTEN
                         C      ;
                         C      ;----------------------------------------------------------------------
  432A'                  C      UA.DS:
  432A'   00             C      	DB	0
  432B'   01             C      	DB	1
  432C'   00             C      	DB	0
  432D'   01             C      	DB	1
  432E'   20 20 44 53    C      	DB	'  DS************   '
  4332'   2A 2A 2A 2A    C      
  4336'   2A 2A 2A 2A    C      
  433A'   2A 2A 2A 2A    C      
  433E'   20 20 20       C      
  4341'   01             C      	DB	1
  4342'   00             C      	DB	0
  4343'   00             C      	DB	0
  4344'   00             C      	DB	0
  4345'   00             C      	DB	0
  4346'   00             C      	DB	0
  4347'   00             C      	DB	0
  4348'   00             C      	DB	0
  4349'   00             C      	DB	0
                         C      ;----------------------------------------------------------------------
  434A'                  C      UA.KNAME:
  434A'   06             C      	DB	06H
  434B'   10             C      	DB	16
  434C'   40             C      	DB	40H
  434D'   20 4B 61 73    C      	DB	' KassettenName: '
  4351'   73 65 74 74    C      
  4355'   65 6E 4E 61    C      
  4359'   6D 65 3A 20    C      
  435D'                  C      UA.NR:
  435D'   03             C      	DB	03H
  435E'   10             C      	DB	16
  435F'   40             C      	DB	40H
  4360'   20 4B 61 73    C      	DB	' Kassetten-Nr.: '
  4364'   73 65 74 74    C      
  4368'   65 6E 2D 4E    C      
  436C'   72 2E 3A 20    C      
  4370'                  C      UA.KOMMT:
  4370'   0B             C      	DB	0BH
  4371'   10             C      	DB	16
  4372'   80             C      	DB	80H
  4373'   20 20 20 20    C      	DB	'     Kommentar: '
  4377'   20 4B 6F 6D    C      
  437B'   6D 65 6E 74    C      
  437F'   61 72 3A 20    C      
                         C      ;----------------------------------------------------------------------
  4383'                  C      UA.Z7E:
  4383'   45 69 6E 67    C      	DB	'Eingabe      =====>     Ausgabe'
  4387'   61 62 65 20    C      
  438B'   20 20 20 20    C      
  438F'   20 3D 3D 3D    C      
  4393'   3D 3D 3E 20    C      
  4397'   20 20 20 20    C      
  439B'   41 75 73 67    C      
  439F'   61 62 65       C      
  43A2'                  C      UA.GER:
  43A2'   20 20 20 20    C      	DB	'       Geraet: '
  43A6'   20 20 20 47    C      
  43AA'   65 72 61 65    C      
  43AE'   74 3A 20       C      
                         C      ;----------------------------------------------------------------------
  43B1'                  C      UA.KOPFR:
  43B1'   01             C      	DB	01H
  43B2'   33             C      	DB	51
  43B3'   80             C      	DB	80H
  43B4'   20 20 20 20    C      	DB	'                Datei               kopieren J/N ? '
  43B8'   20 20 20 20    C      
  43BC'   20 20 20 20    C      
  43C0'   20 20 20 20    C      
  43C4'   44 61 74 65    C      
  43C8'   69 20 20 20    C      
  43CC'   20 20 20 20    C      
  43D0'   20 20 20 20    C      
  43D4'   20 20 20 20    C      
  43D8'   6B 6F 70 69    C      
  43DC'   65 72 65 6E    C      
'Ausschriften'	MACRO-80 3.44	09-Dec-81	PAGE	1-21


  43E0'   20 4A 2F 4E    C      
  43E4'   20 3F 20       C      
  43E7'                  C      UA.EABFR:
  43E7'   01             C      	DB	01H
  43E8'   33             C      	DB	51
  43E9'   80             C      	DB	80H
  43EA'   20 20 20 20    C      	DB	'                Eingaben in Ordnung  ---->   J/N ? '
  43EE'   20 20 20 20    C      
  43F2'   20 20 20 20    C      
  43F6'   20 20 20 20    C      
  43FA'   45 69 6E 67    C      
  43FE'   61 62 65 6E    C      
  4402'   20 69 6E 20    C      
  4406'   4F 72 64 6E    C      
  440A'   75 6E 67 20    C      
  440E'   20 2D 2D 2D    C      
  4412'   2D 3E 20 20    C      
  4416'   20 4A 2F 4E    C      
  441A'   20 3F 20       C      
  441D'                  C      UA.VORH:
  441D'   01             C      	DB	1
  441E'   33             C      	DB	51
  441F'   80             C      	DB	80H
  4420'   2A 2A 2A 2A    C      	DB	'************* Datei vorh.;SYS-Ende,kopieren  J/N ? '
  4424'   2A 2A 2A 2A    C      
  4428'   2A 2A 2A 2A    C      
  442C'   2A 20 44 61    C      
  4430'   74 65 69 20    C      
  4434'   76 6F 72 68    C      
  4438'   2E 3B 53 59    C      
  443C'   53 2D 45 6E    C      
  4440'   64 65 2C 6B    C      
  4444'   6F 70 69 65    C      
  4448'   72 65 6E 20    C      
  444C'   20 4A 2F 4E    C      
  4450'   20 3F 20       C      
                         C      ;----------------------------------------------------------------------
  4453'                  C      UA.FRZ:
  4453'   02             C      	DB	2
  4454'   03             C      	DB	3
  4455'   80             C      	DB	80H
  4456'   3F 3F 20       C      	DB	'?? '
  4459'                  C      UA.BMGF:
  4459'   01             C      	DB	01H
  445A'   07             C      	DB	7
  445B'   80             C      	DB	80H
  445C'   42 4D 20 21    C      	DB	'BM ! ??'
  4460'   20 3F 3F       C      
  4463'                  C      UA.DOK:
  4463'   00             C      	DB	0
  4464'   04             C      	DB	4
  4465'   80             C      	DB	80H
  4466'   69 2E 4F 2E    C      	DB	'i.O.'
  446A'                  C      UA.DF:
  446A'   00             C      	DB	0
  446B'   04             C      	DB	4
  446C'   80             C      	DB	80H
  446D'   46 68 6C 2E    C      	DB	'Fhl.'
                         C      ;----------------------------------------------------------------------
  4471'                  C      UA.ZKDAT:
  4471'   06             C      	DB	6
  4472'   10             C      	DB	16
  4473'   40             C      	DB	40H
  4474'   20 20 20 20    C      	DB	'     Dateiname: '
  4478'   20 44 61 74    C      
  447C'   65 69 6E 61    C      
  4480'   6D 65 3A 20    C      
  4484'                  C      UA.ZKLAD:
  4484'   04             C      	DB	4
  4485'   10             C      	DB	16
  4486'   08             C      	DB	08H
  4487'   20 20 20 4C    C      	DB	'   Ladeadresse: '
  448B'   61 64 65 61    C      
  448F'   64 72 65 73    C      
  4493'   73 65 3A 20    C      
                         C      ;------------------------------------------------------------------
  4497'                  C      UA.ZKBEG:
  4497'   04             C      	DB	4
  4498'   10             C      	DB	16
  4499'   08             C      	DB	08H
  449A'   20 20 20 20    C      	DB	'        Beginn: '
  449E'   20 20 20 20    C      
  44A2'   42 65 67 69    C      
'Ausschriften'	MACRO-80 3.44	09-Dec-81	PAGE	1-22


  44A6'   6E 6E 3A 20    C      
  44AA'                  C      UA.ZKEND:
  44AA'   04             C      	DB	4
  44AB'   10             C      	DB	16
  44AC'   08             C      	DB	08H
  44AD'   20 20 20 20    C      	DB	'          Ende: '
  44B1'   20 20 20 20    C      
  44B5'   20 20 45 6E    C      
  44B9'   64 65 3A 20    C      
  44BD'                  C      UA.STADR:
  44BD'   04             C      	DB	4
  44BE'   10             C      	DB	16
  44BF'   08             C      	DB	08H
  44C0'   20 20 53 74    C      	DB	'  Startadresse: '
  44C4'   61 72 74 61    C      
  44C8'   64 72 65 73    C      
  44CC'   73 65 3A 20    C      
  44D0'                  C      UA.ZKDL:
  44D0'   01             C      	DB	1
  44D1'   10             C      	DB	16
  44D2'   20             C      	DB	20H
  44D3'   20 4C 6F 65    C      	DB	' Loeschen J/N : '
  44D7'   73 63 68 65    C      
  44DB'   6E 20 4A 2F    C      
  44DF'   4E 20 3A 20    C      
  44E3'                  C      UA.ZKF:
  44E3'   00             C      	DB	0
  44E4'   08             C      	DB	8
  44E5'   00             C      	DB	0
  44E6'   46 65 68 6C    C      	DB	'Fehler: '
  44EA'   65 72 3A 20    C      
                         C      ;----------------------------------------------------------------------
  44EE'                  C      UA.ZKRES:
  44EE'   03             C      	DB	3
  44EF'   10             C      	DB	16
  44F0'   10             C      	DB	10H
  44F1'   52 65 73 65    C      	DB	'Reservebloecke: '
  44F5'   72 76 65 62    C      
  44F9'   6C 6F 65 63    C      
  44FD'   6B 65 3A 20    C      
  4501'                  C      UA.ZKSDT:
  4501'   04             C      	DB	4
  4502'   12             C      	DB	18
  4503'   40             C      	DB	40H
  4504'   20 20 20 20    C      	DB	'     Dateiname:   '
  4508'   20 44 61 74    C      
  450C'   65 69 6E 61    C      
  4510'   6D 65 3A 20    C      
  4514'   20 20          C      
  4516'                  C      UA.ZKBEL:
  4516'   00             C      	DB	0
  4517'   10             C      	DB	16
  4518'   00             C      	DB	0
  4519'   42 6C 6F 65    C      	DB	'Bloecke belegt: '
  451D'   63 6B 65 20    C      
  4521'   62 65 6C 65    C      
  4525'   67 74 3A 20    C      
  4529'                  C      UA.ZKBLG:
  4529'   00             C      	DB	0
  452A'   10             C      	DB	16
  452B'   00             C      	DB	0
  452C'   42 6C 6F 65    C      	DB	'Bloecke gesamt: '
  4530'   63 6B 65 20    C      
  4534'   67 65 73 61    C      
  4538'   6D 74 3A 20    C      
                         C      ;----------------------------------------------------------------------
  453C'                  C      UA.ZKBM:
  453C'   42 61 6E 64    C      	DB	'Bandmarke'
  4540'   6D 61 72 6B    C      
  4544'   65             C      
                         C      ;----------------------------------------------------------------------
  4545'                  C      UA.LD:
  4545'   26             C      	DB	38
  4546'   0F             C      	DB	15
  4547'   80             C      	DB	80H
  4548'   20 20 20 20    C      	DB	'               '
  454C'   20 20 20 20    C      
  4550'   20 20 20 20    C      
  4554'   20 20 20       C      
  4557'                  C      UA.ZRSCH:
  4557'   01             C      	DB	1
  4558'   16             C      	DB	22
  4559'   80             C      	DB	80H
'Ausschriften'	MACRO-80 3.44	09-Dec-81	PAGE	1-23


  455A'   56 65 72 7A    C      	DB	'Verz. schreiben J/N ? '
  455E'   2E 20 73 63    C      
  4562'   68 72 65 69    C      
  4566'   62 65 6E 20    C      
  456A'   4A 2F 4E 20    C      
  456E'   3F 20          C      
  4570'                  C      UA.ANZWD:
  4570'   01             C      	DB	1
  4571'   16             C      	DB	22
  4572'   80             C      	DB	80H
  4573'   41 6E 7A 65    C      	DB	'Anzeige wdhln.  J/N ? '
  4577'   69 67 65 20    C      
  457B'   77 64 68 6C    C      
  457F'   6E 2E 20 20    C      
  4583'   4A 2F 4E 20    C      
  4587'   3F 20          C      
                         C      ;----------------------------------------------------------------------
  4589'                  C      UA.ALTR:
  4589'   20 41 55 53    C      	DB	' AUSGLEICH LAUFWERKSTOLERANZEN  '
  458D'   47 4C 45 49    C      
  4591'   43 48 20 4C    C      
  4595'   41 55 46 57    C      
  4599'   45 52 4B 53    C      
  459D'   54 4F 4C 45    C      
  45A1'   52 41 4E 5A    C      
  45A5'   45 4E 20 20    C      
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                                ;
                                ;	INCLUDE	KI.ASM	;Initialisieren von MRES Kassetten
                                ;	INCLUDE	KV.ASM	;Anzeigen und Aendern des MRES-Verzeichnisses
                                ;	INCLUDE	KH.ASM	;Kommandos: KRDx und KWRx
                                ;	INCLUDE	FD.ASM	;Ein-/Ausgabe im freien Format
                                ;	INCLUDE LD.ASM	;Laden von MRES-P-Dateien
                                ;	INCLUDE RL.ASM	;Relativloader fuer O-Dateien
                                ;	INCLUDE SV.ASM	;Retten von Maschinencodeprogrammen als MRES - P-Datei
                         C      	INCLUDE K3.ASM	;MRES Routinen
                         C      	TITLE	'Initialisieren von MRES Kassetten'
                         C      	PAGE
'Initialisieren von MRES Kassetten'	MACRO-80 3.44	09-Dec-81	PAGE	1-24


                         C      
                         C      ;	PN	KI
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;      INITIALISIEREN VON MRES KASSETTEN
                         C      ;
                         C      ;----------------------------------------------------------------------
  45A9'   45A9'          C      	DW	$
  45AB'   49 4E 49 54    C      	DB	'INIT'
  45AF'   3A 3327        C      	LD	A,(UE.BWSA+327H)
  45B2'   CD 59DA'       C      	CALL	U1.TST
  45B5'   D8             C      	RET	C
  45B6'   F5             C      	PUSH	AF
  45B7'   CD 58FF'       C      	CALL	U1.KTINI
  45BA'   F1             C      	POP	AF
  45BB'   DD 77 03       C      	LD	(IX+3),A	;GERAETEADR. -->TAB
  45BE'   CD 5629'       C      	CALL	UR.KRE	;RES. EIN
  45C1'   DD CB 00 56    C      	BIT	2,(IX)
  45C5'   28 05          C      	JR	Z,$+7
  45C7'   3E 19          C      	LD	A,19H
  45C9'   CD 4280'       C      	CALL	UF.ERANZ
  45CC'   CD 5637'       C      	CALL	UR.KRWW	;RUECKSPULEN MIT WARTEN
  45CF'   CD 564D'       C      	CALL	UR.KBM	;BM SCHREIBEN
  45D2'   21 0E66        C      	LD	HL,UE.PUF	;AUFBAU 1.BLOCK
  45D5'   3E 40          C      	LD	A,40H
  45D7'   06 50          C      	LD	B,80
  45D9'   CD 59BB'       C      	CALL	U1.TR
  45DC'   3E 00          C      	LD	A,00H
  45DE'   06 30          C      	LD	B,48
  45E0'   CD 59BB'       C      	CALL	U1.TR
  45E3'   DD 36 0A 80    C      	LD	(IX+10),80H
  45E7'   DD 36 04 00    C      	LD	(IX+4),00H	;CMD SCHREIBEN
  45EB'   CD 4266'       C      	CALL	UF.EXEC
  45EE'   CD 467C'       C      	CALL	KI.KO03
  45F1'                  C      KI.KN:
  45F1'   CD 59C6'       C      	CALL	U1.BILO
  45F4'   3E 0D          C      	LD	A,13
  45F6'   32 2B00'       C      	LD	(UB.ZN),A	;ZEILENNR. 15
  45F9'   21 434A'       C      	LD	HL,UA.KNAME	;ABFRAGE KASS.NAME
  45FC'   CD 56D1'       C      	CALL	UR.MIMO
  45FF'   D8             C      	RET	C
  4600'   06 06          C      	LD	B,6
  4602'   11 0E6A        C      	LD	DE,UE.PUF+4	;NAME IN PUFFER
  4605'   CD 5BCD'       C      	CALL	UC.KONV	;MIT KONVERTIERUNG IN DKOI-CODE
  4608'                  C      KI.NMR:
  4608'   21 435D'       C      	LD	HL,UA.NR	;ABFR. KASS.NUMMER
  460B'   CD 56D1'       C      	CALL	UR.MIMO
  460E'   38 E1          C      	JR	C,KI.KN	;BEI SYS-TASTE ZU VORHERIGER
  4610'   06 03          C      	LD	B,3
  4612'   11 0E8B        C      	LD	DE,UE.PUF+37
  4615'   CD 5BCD'       C      	CALL	UC.KONV
  4618'                  C      KI.KM:
  4618'   21 4370'       C      	LD	HL,UA.KOMMT	;ABFR. KOMMENTAR
  461B'   CD 56D1'       C      	CALL	UR.MIMO
  461E'   38 D1          C      	JR	C,KI.KN
  4620'   06 0B          C      	LD	B,11
  4622'   11 0E8E        C      	LD	DE,UE.PUF+40
  4625'   CD 5BCD'       C      	CALL	UC.KONV
  4628'   CD 4266'       C      	CALL	UF.EXEC	;3.BLOCK SCHREIBEN
  462B'   CD 564D'       C      	CALL	UR.KBM	;BM , 1.LABEL BEENDET
  462E'   21 4589'       C      	LD	HL,UA.ALTR
  4631'   11 0E66        C      	LD	DE,UE.PUF
  4634'   01 0020        C      	LD	BC,20H
  4637'   ED B0          C      	LDIR		;AUSGLEICH LFWSTLNZ->PUFFER
  4639'   DD 36 0A 20    C      	LD	(IX+10),20H	;NEUE BLOCKLAENGE
  463D'   DD 36 04 00    C      	LD	(IX+4),00H
  4641'   CD 4266'       C      	CALL	UF.EXEC	;SCHREIBEN
  4644'   21 432A'       C      	LD	HL,UA.DS
  4647'   11 0E66        C      	LD	DE,UE.PUF
  464A'   01 0020        C      	LD	BC,32
  464D'   ED B0          C      	LDIR		;DS-SATZ --> PUFFER
  464F'   CD 4266'       C      	CALL	UF.EXEC
  4652'   3E A5          C      	LD	A,0A5H
  4654'   06 20          C      	LD	B,32
  4656'   21 0E66        C      	LD	HL,UE.PUF
  4659'   CD 59BB'       C      	CALL	U1.TR
  465C'   06 68          C      	LD	B,68H	;103 VERZ.SAETZE
  465E'                  C      KI.VERZ:
  465E'   C5             C      	PUSH	BC
  465F'   CD 4266'       C      	CALL	UF.EXEC
  4662'   C1             C      	POP	BC
  4663'   10 F9          C      	DJNZ	KI.VERZ
'Initialisieren von MRES Kassetten'	MACRO-80 3.44	09-Dec-81	PAGE	1-25


  4665'   CD 564D'       C      	CALL	UR.KBM
  4668'   CD 589C'       C      	CALL	U1.VS1	;1.DATEIVORSATZ -->PUFFER
  466B'   DD 36 04 00    C      	LD	(IX+4),00H
  466F'   CD 4266'       C      	CALL	UF.EXEC
  4672'   CD 5653'       C      	CALL	UR.KSL	;SCHLUSSLUECKE SCHREIBEN
  4675'   CD 5631'       C      	CALL	UR.KRW
  4678'   CD 563B'       C      	CALL	UR.KRA
  467B'   C9             C      	RET
                         C      ;
  467C'                  C      KI.KO03:
  467C'   CD 4266'       C      	CALL	UF.EXEC	;FUER KI14
  467F'   06 31          C      	LD	B,49
  4681'   2B             C      	DEC	HL
  4682'   10 FD          C      	DJNZ	$-1
  4684'   36 D9          C      	LD	(HL),0D9H
  4686'   C9             C      	RET
                         C      ;---------------------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Anzeigen und Aendern des MRES-Verzeichnisses'
                         C      	PAGE
'Anzeigen und Aendern des MRES-Verzeichnisses'	MACRO-80 3.44	09-Dec-81	PAGE	1-26


                         C      
                         C      ;	PN	KV
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;    ANZEIGEN UND AENDERN DES VERZEICHNISSES VON MRES KASSETTEN
                         C      ;
                         C      ;----------------------------------------------------------------------
  4687'   4687'          C      	DW	$
  4689'   44 49 52 20    C      	DB	'DIR '
  468D'   3A 3326        C      	LD	A,(UE.BWSA+326H)
  4690'   CD 59DA'       C      	CALL	U1.TST
  4693'   D8             C      	RET	C
  4694'   CD 58FF'       C      	CALL	U1.KTINI
  4697'   DD 77 03       C      	LD	(IX+3),A
  469A'   CD 59C6'       C      	CALL	U1.BILO
  469D'   CD 5629'       C      	CALL	UR.KRE
  46A0'   CD 5637'       C      	CALL	UR.KRWW
  46A3'   CD 58B3'       C      	CALL	U1.DSVG
  46A6'   C5             C      	PUSH	BC
                         C      ;----------------------------------------------------------------------
  46A7'   CD 583C'       C      	CALL	U1.KBR4	;KASS.NAME,NR.,KOMMENTAR ANZEIGEN
  46AA'   DD 36 04 02    C      	LD	(IX+4),02H
  46AE'   CD 4266'       C      	CALL	UF.EXEC
  46B1'   21 0E6A        C      	LD	HL,UE.PUF+4
  46B4'   11 3240        C      	LD	DE,3240H	;=8.ZEILE,16.SPALTE
  46B7'   06 06          C      	LD	B,6
  46B9'   CD 5BC3'       C      	CALL	UC.DKONV
  46BC'   21 0E8B        C      	LD	HL,UE.PUF+37
  46BF'   13             C      	INC	DE
  46C0'   13             C      	INC	DE
  46C1'   06 03          C      	LD	B,3
  46C3'   CD 5BC3'       C      	CALL	UC.DKONV
  46C6'   13             C      	INC	DE
  46C7'   13             C      	INC	DE
  46C8'   06 0B          C      	LD	B,11
  46CA'   CD 5BC3'       C      	CALL	UC.DKONV
  46CD'   21 3290        C      	LD	HL,3290H
  46D0'   3E 3D          C      	LD	A,'='
  46D2'   77             C      	LD	(HL),A
  46D3'   E5             C      	PUSH	HL
  46D4'   D1             C      	POP	DE
  46D5'   13             C      	INC	DE
  46D6'   01 0017        C      	LD	BC,23
  46D9'   ED B0          C      	LDIR
                         C      ;----------------------------------------------------------------------
  46DB'   06 03          C      	LD	B,3	;POSITIONIEREN VOR DS-SATZ
  46DD'   CD 4266'       C      	CALL	UF.EXEC
  46E0'   10 FB          C      	DJNZ	$-3
  46E2'   CD 592D'       C      	CALL	U1.VERIN
  46E5'   CD 5637'       C      	CALL	UR.KRWW
  46E8'   06 07          C      	LD	B,7
  46EA'   CD 5957'       C      	CALL	U1.VORS1
  46ED'   C1             C      	POP	BC
  46EE'   05             C      	DEC	B
  46EF'   CD 491C'       C      	CALL	KV.ANZ
  46F2'   04             C      	INC	B
  46F3'   05             C      	DEC	B
  46F4'   CA 483E'       C      	JP	Z,KV.KRW
  46F7'   04             C      	INC	B
  46F8'   C5             C      	PUSH	BC
                         C      ;----------------------------------------------------------------------
  46F9'                  C      KV.ANF:
  46F9'   05             C      	DEC	B
  46FA'   78             C      	LD	A,B
  46FB'   58             C      	LD	E,B
  46FC'   D6 09          C      	SUB	9
  46FE'   38 05          C      	JR	C,$+7
  4700'   0E 09          C      	LD	C,9
  4702'   41             C      	LD	B,C
  4703'   18 03          C      	JR	$+5
  4705'   43             C      	LD	B,E
  4706'   48             C      	LD	C,B
  4707'   AF             C      	XOR	A
  4708'   F5             C      	PUSH	AF	;A=RESTL.ANZAHL ODER 0
  4709'   C5             C      	PUSH	BC
  470A'   21 2B2A'       C      	LD	HL,UB.SATZ
  470D'   36 00          C      	LD	(HL),00H
  470F'   23             C      	INC	HL
  4710'   36 37          C      	LD	(HL),55
  4712'   23             C      	INC	HL
  4713'   36 80          C      	LD	(HL),80H
  4715'   23             C      	INC	HL
'Anzeigen und Aendern des MRES-Verzeichnisses'	MACRO-80 3.44	09-Dec-81	PAGE	1-27


  4716'   06 37          C      	LD	B,55
  4718'   3E 20          C      	LD	A,20H
  471A'   CD 59BB'       C      	CALL	U1.TR	;AUSGABESATZ LOESCHEN
  471D'   3E 0D          C      	LD	A,13
  471F'   32 2B00'       C      	LD	(UB.ZN),A
  4722'   CD 59C6'       C      	CALL	U1.BILO
  4725'   11 2B3C'       C      	LD	DE,UB.SATZ+18
  4728'   D5             C      	PUSH	DE
  4729'   21 ECA2        C      	LD	HL,BC.VTABE+32	;ADR. VERZ.TABELLE
  472C'   E5             C      	PUSH	HL
                         C      ;---------------------------MAX 9 SAETZE ANZEIGEN----------------------
  472D'                  C      KV.ZLTR:
  472D'   CD 48A4'       C      	CALL	KV.BSTR	;VTABE-->UB.SATZ
  4730'   D1             C      	POP	DE	;VERZ.ADR.
  4731'   E1             C      	POP	HL	;ADR.AUSGABESATZ
  4732'   E5             C      	PUSH	HL
  4733'   D5             C      	PUSH	DE
  4734'   01 0012        C      	LD	BC,18
  4737'   B7             C      	OR	A
  4738'   ED 42          C      	SBC	HL,BC
  473A'   CD 56D1'       C      	CALL	UR.MIMO	;ANZEIGE EINE ZEILE
  473D'   E1             C      	POP	HL	;VERZ.ADR
  473E'   D1             C      	POP	DE
  473F'   01 0020        C      	LD	BC,32
  4742'   09             C      	ADD	HL,BC
  4743'   C1             C      	POP	BC
  4744'   05             C      	DEC	B
  4745'   28 05          C      	JR	Z,$+7
  4747'   C5             C      	PUSH	BC
  4748'   D5             C      	PUSH	DE
  4749'   E5             C      	PUSH	HL	;NEUE VERZ.TAB ADR
  474A'   18 E1          C      	JR	KV.ZLTR
                         C      ;----------------------------------------------------------------------
  474C'   41             C      	LD	B,C	;ANZAHL DER ANGEZEIGTEN ZEILEN
  474D'   3A 2B00'       C      	LD	A,(UB.ZN)
  4750'   90             C      	SUB	B
  4751'   32 2B00'       C      	LD	(UB.ZN),A	;KURSOR AUF ANFANG 12.ZEILE
  4754'   C5             C      	PUSH	BC
  4755'   D5             C      	PUSH	DE
  4756'   E5             C      	PUSH	HL
                         C      ;------------------------VERZ. ZEIGER AUF 1.ANGEZEIGTE EINTR.
  4757'   C5             C      	PUSH	BC
  4758'   01 0020        C      	LD	BC,32
  475B'   B7             C      	OR	A
  475C'   ED 42          C      	SBC	HL,BC
  475E'   C1             C      	POP	BC
  475F'   10 F6          C      	DJNZ	$-8
  4761'   E5             C      	PUSH	HL
                         C      ;----------------------------------------------------------------------
  4762'                  C      KV.TABTR:
  4762'   21 4545'       C      	LD	HL,UA.LD
  4765'   CD 56D1'       C      	CALL	UR.MIMO	;KURSOR AUF ANF.12.ZEILE
  4768'   DA 47A8'       C      	JP	C,KV.ZEIHO
  476B'   D1             C      	POP	DE
  476C'   D5             C      	PUSH	DE	;ZIELADR.IN VTAB
  476D'   CD 48D1'       C      	CALL	KV.SPTR	;ZEILE WIEDER IN SPEICHER
  4770'   E1             C      	POP	HL	;ZIELADR.IN VTAB
  4771'   01 0020        C      	LD	BC,32
  4774'   09             C      	ADD	HL,BC
  4775'   FD E1          C      	POP	IY
  4777'   D1             C      	POP	DE
  4778'   C1             C      	POP	BC
  4779'   05             C      	DEC	B
  477A'   28 07          C      	JR	Z,$+9
  477C'   C5             C      	PUSH	BC
  477D'   D5             C      	PUSH	DE
  477E'   FD E5          C      	PUSH	IY
  4780'   E5             C      	PUSH	HL
  4781'   18 DF          C      	JR	KV.TABTR
                         C      ;--------------------WEITERBLAETTERN ODER AUSGABE----------------------
  4783'   F1             C      	POP	AF
  4784'   B7             C      	OR	A
  4785'   28 42          C      	JR	Z,KV.AUSG	;KEINE WEITEREN ANZEIGEN
  4787'   D6 09          C      	SUB	9
  4789'   38 05          C      	JR	C,$+7
  478B'   06 09          C      	LD	B,9
  478D'   48             C      	LD	C,B
  478E'   18 05          C      	JR	$+7
  4790'   C6 09          C      	ADD	A,9
  4792'   47             C      	LD	B,A
  4793'   48             C      	LD	C,B
  4794'   AF             C      	XOR	A
  4795'   F5             C      	PUSH	AF
'Anzeigen und Aendern des MRES-Verzeichnisses'	MACRO-80 3.44	09-Dec-81	PAGE	1-28


  4796'   C5             C      	PUSH	BC
  4797'   D5             C      	PUSH	DE
  4798'   E5             C      	PUSH	HL
  4799'   3E 0D          C      	LD	A,13
  479B'   32 2B00'       C      	LD	(UB.ZN),A
  479E'   CD 59C6'       C      	CALL	U1.BILO
  47A1'   E1             C      	POP	HL
  47A2'   D1             C      	POP	DE
  47A3'   D5             C      	PUSH	DE
  47A4'   E5             C      	PUSH	HL
  47A5'   C3 472D'       C      	JP	KV.ZLTR
                         C      ;----------------------------------------------------------------------
  47A8'                  C      KV.ZEIHO:
  47A8'   21 2B00'       C      	LD	HL,UB.ZN
  47AB'   7E             C      	LD	A,(HL)
  47AC'   D6 0F          C      	SUB	15
  47AE'   38 15          C      	JR	C,$+23	;WENN IN 12. ZEILE SYS GEDRUECKT
  47B0'   35             C      	DEC	(HL)
  47B1'   35             C      	DEC	(HL)	;ZEILENNR.-2
  47B2'   E1             C      	POP	HL
  47B3'   01 0020        C      	LD	BC,32
  47B6'   B7             C      	OR	A
  47B7'   ED 42          C      	SBC	HL,BC	;VERZ.ZEIGER RUECKSETZEN
  47B9'   FD E1          C      	POP	IY
  47BB'   D1             C      	POP	DE
  47BC'   C1             C      	POP	BC
  47BD'   04             C      	INC	B
  47BE'   C5             C      	PUSH	BC
  47BF'   D5             C      	PUSH	DE
  47C0'   FD E5          C      	PUSH	IY
  47C2'   E5             C      	PUSH	HL
  47C3'   18 01          C      	JR	$+3
  47C5'   35             C      	DEC	(HL)
  47C6'   C3 4762'       C      	JP	KV.TABTR
                         C      ;----------------------------------------------------------------------
  47C9'                  C      KV.AUSG:
  47C9'   E5             C      	PUSH	HL
  47CA'   21 4557'       C      	LD	HL,UA.ZRSCH
  47CD'   CD 56D1'       C      	CALL	UR.MIMO
  47D0'   7E             C      	LD	A,(HL)
  47D1'   E1             C      	POP	HL
  47D2'   FE 4A          C      	CP	'J'
  47D4'   28 11          C      	JR	Z,$+19
  47D6'   21 4570'       C      	LD	HL,UA.ANZWD
  47D9'   CD 56D1'       C      	CALL	UR.MIMO
  47DC'   7E             C      	LD	A,(HL)
  47DD'   FE 4A          C      	CP	'J'
  47DF'   C1             C      	POP	BC
  47E0'   C2 483E'       C      	JP	NZ,KV.KRW
  47E3'   C5             C      	PUSH	BC
  47E4'   C3 46F9'       C      	JP	KV.ANF
                         C      ;--------------------------------Dateien am Ende loeschen ? ---------
  47E7'   CD 4912'       C      	CALL	KV.SBC
  47EA'   20 34          C      	JR	NZ,$+54
  47EC'   3A EC85        C      	LD	A,(BC.VTABE+3)
  47EF'   3D             C      	DEC	A
  47F0'   5F             C      	LD	E,A
  47F1'   16 00          C      	LD	D,0
  47F3'   3E 01          C      	LD	A,1
  47F5'   82             C      	ADD	A,D
  47F6'   57             C      	LD	D,A
  47F7'   1D             C      	DEC	E
  47F8'   28 05          C      	JR	Z,$+7
  47FA'   CD 4912'       C      	CALL	KV.SBC
  47FD'   28 F4          C      	JR	Z,$-10
  47FF'   C1             C      	POP	BC	;D: Anzahl zu loeschender Dateien
  4800'   79             C      	LD	A,C
  4801'   92             C      	SUB	D
  4802'   32 0E67        C      	LD	(UE.PUF+1),A	;DS-Satz korrigieren
  4805'   78             C      	LD	A,B
  4806'   92             C      	SUB	D
  4807'   32 0E69        C      	LD	(UE.PUF+3),A
  480A'   CD 565F'       C      	CALL	UR.KBR
  480D'   CD 565F'       C      	CALL	UR.KBR
  4810'   CD 5659'       C      	CALL	UR.KBV
  4813'   DD 36 04 08    C      	LD	(IX+4),08H
  4817'   CD 4266'       C      	CALL	UF.EXEC	;und schreiben
  481A'   47             C      	LD	B,A
  481B'   05             C      	DEC	B
  481C'   28 20          C      	JR	Z,$+34
  481E'   04             C      	INC	B
  481F'   C5             C      	PUSH	BC
                         C      ;-------------------------------------Verzeichnis schreiben -----------
'Anzeigen und Aendern des MRES-Verzeichnisses'	MACRO-80 3.44	09-Dec-81	PAGE	1-29


  4820'   C1             C      	POP	BC
  4821'   05             C      	DEC	B
  4822'   21 ECA2        C      	LD	HL,BC.VTABE+32
  4825'   C5             C      	PUSH	BC
  4826'   11 0E66        C      	LD	DE,UE.PUF
  4829'   01 0020        C      	LD	BC,32
  482C'   ED B0          C      	LDIR
  482E'   CD 5659'       C      	CALL	UR.KBV
  4831'   CD 565F'       C      	CALL	UR.KBR
  4834'   DD 36 04 08    C      	LD	(IX+4),08H	;OHNE RAW
  4838'   CD 4266'       C      	CALL	UF.EXEC
  483B'   C1             C      	POP	BC
  483C'   10 E7          C      	DJNZ	$-23
                         C      ;---------------------------------------------------------------------
  483E'                  C      KV.KRW:
  483E'   CD 5631'       C      	CALL	UR.KRW
  4841'   CD 563B'       C      	CALL	UR.KRA
  4844'   3A 3328        C      	LD	A,(UE.BWSA+328H)
  4847'   FE 44          C      	CP	'D'
  4849'   C0             C      	RET	NZ
  484A'   21 323D        C      	LD	HL,UE.BWSA+23DH
  484D'   00             C      	NOP
  484E'   CD 488A'       C      	CALL	KV.DRU1
  4851'   21 328D        C      	LD	HL,UE.BWSA+28DH
  4854'   CD 488A'       C      	CALL	KV.DRU1
  4857'   CD 7C00        C      	CALL	UE.PRINT
  485A'   21 2B64'       C      	LD	HL,UB.DTAB
  485D'   11 2B65'       C      	LD	DE,UB.DTAB+1
  4860'   01 0028        C      	LD	BC,40
  4863'   36 20          C      	LD	(HL),20H
  4865'   ED B0          C      	LDIR
  4867'   3A EC85        C      	LD	A,(BC.VTABE+3)
  486A'   47             C      	LD	B,A
  486B'   05             C      	DEC	B
  486C'   21 EC82        C      	LD	HL,BC.VTABE
  486F'   11 0020        C      	LD	DE,32
  4872'                  C      KV.P1:
  4872'   C5             C      	PUSH	BC
  4873'   19             C      	ADD	HL,DE
  4874'   E5             C      	PUSH	HL
  4875'   D5             C      	PUSH	DE
  4876'   11 2B64'       C      	LD	DE,UB.DTAB
  4879'   CD 48A4'       C      	CALL	KV.BSTR
  487C'   21 2B64'       C      	LD	HL,UB.DTAB
  487F'   06 28          C      	LD	B,40
  4881'   CD 488C'       C      	CALL	KV.DRU
  4884'   D1             C      	POP	DE
  4885'   E1             C      	POP	HL
  4886'   C1             C      	POP	BC
  4887'   10 E9          C      	DJNZ	KV.P1
  4889'   C9             C      	RET
                         C      
  488A'                  C      KV.DRU1:
  488A'   06 1E          C      	LD	B,30
  488C'                  C      KV.DRU:
  488C'   7E             C      	LD	A,(HL)
  488D'   23             C      	INC	HL
  488E'   CD 4899'       C      	CALL	KV.KO02
  4891'   10 F9          C      	DJNZ	KV.DRU
  4893'   3E 1E          C      	LD	A,1EH
  4895'   CD 7C00        C      	CALL	UE.PRINT
  4898'   C9             C      	RET
                         C      ;
  4899'                  C      KV.KO02:
  4899'   CB BF          C      	RES	7,A	;FUER KV17 (DRUCKERAUSGABE)
  489B'   FE 20          C      	CP	20H
  489D'   30 02          C      	JR	NC,$+4
  489F'   3E 2A          C      	LD	A,2AH
  48A1'   C3 7C00        C      	JP	UE.PRINT
                         C      ;---------------------------------------------------------------------
  48A4'                  C      KV.BSTR:
  48A4'   01 0006        C      	LD	BC,6	;Aufbereitung des Verz.Satzes
  48A7'   C5             C      	PUSH	BC
  48A8'   ED B0          C      	LDIR		;Transport VTABE--->UB.SATZ
  48AA'   13             C      	INC	DE
  48AB'   13             C      	INC	DE
  48AC'   13             C      	INC	DE
  48AD'   01 0002        C      	LD	BC,2
  48B0'   ED B0          C      	LDIR
  48B2'   13             C      	INC	DE
  48B3'   13             C      	INC	DE
  48B4'   13             C      	INC	DE
  48B5'   C1             C      	POP	BC
'Anzeigen und Aendern des MRES-Verzeichnisses'	MACRO-80 3.44	09-Dec-81	PAGE	1-30


  48B6'   C5             C      	PUSH	BC
  48B7'   ED B0          C      	LDIR
  48B9'   13             C      	INC	DE
  48BA'   13             C      	INC	DE
  48BB'   13             C      	INC	DE
  48BC'   C1             C      	POP	BC
  48BD'   ED B0          C      	LDIR
  48BF'   13             C      	INC	DE
  48C0'   13             C      	INC	DE
  48C1'   13             C      	INC	DE
  48C2'   01 0003        C      	LD	BC,3
  48C5'   ED B0          C      	LDIR
  48C7'   13             C      	INC	DE
  48C8'   13             C      	INC	DE
  48C9'   13             C      	INC	DE
  48CA'   6E             C      	LD	L,(HL)	;Konvertierung Labelnummer
  48CB'   26 00          C      	LD	H,0
  48CD'   CD 5B2F'       C      	CALL	UC.CVBD2
  48D0'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  48D1'                  C      KV.SPTR:
  48D1'   7E             C      	LD	A,(HL)
  48D2'   FE 09          C      	CP	09H	;Soll Satz geloescht werden?
  48D4'   20 02          C      	JR	NZ,$+4
  48D6'   AF             C      	XOR	A
  48D7'   77             C      	LD	(HL),A
  48D8'   01 0006        C      	LD	BC,6
  48DB'   C5             C      	PUSH	BC
  48DC'   ED B0          C      	LDIR		;Ruecktransport BWSA--->VTABE
  48DE'   23             C      	INC	HL
  48DF'   23             C      	INC	HL
  48E0'   23             C      	INC	HL
  48E1'   01 0002        C      	LD	BC,2
  48E4'   ED B0          C      	LDIR
  48E6'   23             C      	INC	HL
  48E7'   23             C      	INC	HL
  48E8'   23             C      	INC	HL
  48E9'   C1             C      	POP	BC
  48EA'   C5             C      	PUSH	BC
  48EB'   ED B0          C      	LDIR
  48ED'   23             C      	INC	HL
  48EE'   23             C      	INC	HL
  48EF'   23             C      	INC	HL
  48F0'   C1             C      	POP	BC
  48F1'   ED B0          C      	LDIR
  48F3'   23             C      	INC	HL
  48F4'   23             C      	INC	HL
  48F5'   23             C      	INC	HL
  48F6'   01 0003        C      	LD	BC,3
  48F9'   ED B0          C      	LDIR
  48FB'   23             C      	INC	HL
  48FC'   23             C      	INC	HL
  48FD'   23             C      	INC	HL
  48FE'   D5             C      	PUSH	DE
  48FF'   EB             C      	EX	DE,HL
  4900'   CD 4907'       C      	CALL	KV.DBCVM
  4903'   7D             C      	LD	A,L
  4904'   E1             C      	POP	HL
  4905'   77             C      	LD	(HL),A
  4906'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  4907'                  C      KV.DBCVM:
  4907'   06 02          C      	LD	B,2	;FELDLAENGE
  4909'   CD 5B74'       C      	CALL	UC.CVDB	;KONVERTIER. DEZI-->BINAER
  490C'   D0             C      	RET	NC		;OHNE FEHLER
  490D'   C0             C      	RET	NZ
  490E'   13             C      	INC	DE	;1.ZEICHEN WAR KEINE DEZ.ZAHL
  490F'   10 F8          C      	DJNZ	$-6
  4911'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  4912'                  C      KV.SBC:
  4912'   01 0020        C      	LD	BC,32
  4915'   B7             C      	OR	A
  4916'   ED 42          C      	SBC	HL,BC
  4918'   7E             C      	LD	A,(HL)
  4919'   FE 00          C      	CP	00H
  491B'   C9             C      	RET	
                         C      ;---------------------------------------------------------------------
  491C'                  C      KV.ANZ:
  491C'   C5             C      	PUSH	BC
  491D'   68             C      	LD	L,B
  491E'   26 00          C      	LD	H,0
  4920'   11 3332        C      	LD	DE,3332H
'Anzeigen und Aendern des MRES-Verzeichnisses'	MACRO-80 3.44	09-Dec-81	PAGE	1-31


  4923'   CD 5B2B'       C      	CALL	UC.CVBD3
  4926'   13             C      	INC	DE
  4927'   13             C      	INC	DE
  4928'   21 4932'       C      	LD	HL,KV.AVZS
  492B'   01 0011        C      	LD	BC,17
  492E'   ED B0          C      	LDIR
  4930'   C1             C      	POP	BC
  4931'   C9             C      	RET
                         C      ;-----------------------------------------------------------------------
  4932'                  C      KV.AVZS:
  4932'   56 65 72 7A    C      	DB	'Verzeichnissaetze'
  4936'   65 69 63 68    C      
  493A'   6E 69 73 73    C      
  493E'   61 65 74 7A    C      
  4942'   65             C      
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Kommandos: KRDx und KWRx'
                         C      	PAGE
'Kommandos: KRDx und KWRx'	MACRO-80 3.44	09-Dec-81	PAGE	1-32


                         C      
                         C      ;	PN	KH
                         C      ;**********************************************************************
                         C      ;
                         C      ;   Kommando:
                         C      ;        KRDx...Block einlesen und anzeigen
                         C      ;               zusaetlich werden die entsprechenden Puffer-
                         C      ;               adressen angezeigt.
                         C      ;        KWRx...Block schreiben, standardmaessig nach 'KRDx'
                         C      ;               Ansonsten muessen Blockadresse und Blocklaenge in der
                         C      ;               Verstaendigungstabelle eingetragen werden.
                         C      ;
                         C      ;**********************************************************************
  4943'   4943'          C      	DW	$
  4945'   4B 52 44 31    C      	DB	'KRD1'
  4949'   18 06          C      	JR	KH.RDSTA
                         C      ;
  494B'   494B'          C      	DW	$
  494D'   4B 52 44 32    C      	DB	'KRD2'
  4951'                  C      KH.RDSTA:
  4951'   CD 58FF'       C      	CALL	U1.KTINI	;Initialisierung E/A-Tab.
  4954'   3A 3325        C      	LD	A,(UE.BWSA+325H)
  4957'   E6 0F          C      	AND	0FH
  4959'   DD 77 03       C      	LD	(IX+3),A	;Subadresse eintragen
  495C'                  C      KH.RES:
  495C'   CD 5629'       C      	CALL	UR.KRE	;Reservieren
  495F'                  C      KH.RD1:
  495F'   DD 36 04 02    C      	LD	(IX+4),02H	;Block wiedergeben
  4963'   CD 4266'       C      	CALL	UF.EXEC
  4966'   DD 7E 09       C      	LD	A,(IX+9)
  4969'   DD B6 0A       C      	OR	(IX+10)
  496C'   CA 49CF'       C      	JP	Z,KH.RDBM
  496F'   CD 4AAC'       C      	CALL	KH.BILO
  4972'   CD 49E0'       C      	CALL	KH.ANZBL	;Block anzeigen
  4975'                  C      KH.RD3:
  4975'   CD 57F4'       C      	CALL	UR.TAREP	;Tastaturabfrage
  4978'   FE 89          C      	CP	089H
  497A'   28 E3          C      	JR	Z,KH.RD1	;---> P 10
  497C'   FE 8B          C      	CP	08BH
  497E'                  C      KH.RD6:
  497E'   CC 49C6'       C      	CALL	Z,KH.RD2	;---> P 12
  4981'   28 DC          C      	JR	Z,KH.RD1
  4983'   FE CD          C      	CP	0CDH
  4985'                  C      KH.RD4:
  4985'   28 3B          C      	JR	Z,KH.SYSRT	;---> SYS
  4987'   FE 85          C      	CP	85H
  4989'   CC 4AA4'       C      	CALL	Z,KH.KBRS	;---> P 6
  498C'   FE 86          C      	CP	86H
  498E'   DD 36 0A 01    C      	LD	(IX+10),1
  4992'   F5             C      	PUSH	AF
  4993'   CC 5641'       C      	CALL	Z,UR.KLV	;---> P 7
  4996'   F1             C      	POP	AF
  4997'   28 DC          C      	JR	Z,KH.RD3
  4999'   FE 87          C      	CP	87H
  499B'   F5             C      	PUSH	AF
  499C'   CC 563B'       C      	CALL	Z,UR.KRA	;---> P 8
  499F'   F1             C      	POP	AF
  49A0'   28 D3          C      	JR	Z,KH.RD3
  49A2'   FE 88          C      	CP	88H
  49A4'   F5             C      	PUSH	AF
  49A5'   CC 5647'       C      	CALL	Z,UR.KLR	;---> P 9
  49A8'   F1             C      	POP	AF
  49A9'   28 CA          C      	JR	Z,KH.RD3
  49AB'   FE E2          C      	CP	0E2H	;CTRL,US,B : BM SCHREIBEN
  49AD'   F5             C      	PUSH	AF
  49AE'   CC 564D'       C      	CALL	Z,UR.KBM
  49B1'   F1             C      	POP	AF
  49B2'   CA 4975'       C      	JP	Z,KH.RD3
  49B5'   FE 83          C      	CP	83H
  49B7'   CA 495C'       C      	JP	Z,KH.RES	;---> P 4
  49BA'   FE 84          C      	CP	84H
  49BC'   CC 5637'       C      	CALL	Z,UR.KRWW	;---> P 5
  49BF'   C3 4975'       C      	JP	KH.RD3
  49C2'                  C      KH.SYSRT:
  49C2'   CD 4AAC'       C      	CALL	KH.BILO	;Systemruecksprung
  49C5'   C9             C      	RET
  49C6'                  C      KH.RD2:
  49C6'   F5             C      	PUSH	AF	;Flags retten
  49C7'   CD 565F'       C      	CALL	UR.KBR	;Block ruecksetzen
  49CA'   CD 565F'       C      	CALL	UR.KBR
  49CD'   F1             C      	POP	AF
  49CE'   C9             C      	RET
'Kommandos: KRDx und KWRx'	MACRO-80 3.44	09-Dec-81	PAGE	1-33


  49CF'                  C      KH.RDBM:
  49CF'   CD 4AAC'       C      	CALL	KH.BILO
  49D2'   21 453C'       C      	LD	HL,UA.ZKBM	;"Bandmarke"
  49D5'   11 3000        C      	LD	DE,UE.BWSA
  49D8'   01 0009        C      	LD	BC,9
  49DB'   ED B0          C      	LDIR
  49DD'   C3 4975'       C      	JP	KH.RD3
  49E0'                  C      KH.ANZBL:
  49E0'   CD 4AAC'       C      	CALL	KH.BILO
  49E3'                  C      KH.ANZB1:
  49E3'   21 0E66        C      	LD	HL,UE.PUF
  49E6'   CD 49EA'       C      	CALL	KH.AZBLD	;Bild anzeigen (24 Zeilen)
  49E9'   C9             C      	RET		; IN...HL:=akt. Pufferadresse
  49EA'                  C      KH.AZBLD:
  49EA'   06 18          C      	LD	B,24	; 24 Zeilen anzeigen
  49EC'   11 3000        C      	LD	DE,UE.BWSA
  49EF'                  C      KH.AZBL1:
  49EF'   C5             C      	PUSH	BC
  49F0'   CD 49FF'       C      	CALL	KH.AZ1Z	; 1 Zeile anzeigen
  49F3'   C1             C      	POP	BC
  49F4'   E5             C      	PUSH	HL	;akt. Pufferadresse retten
  49F5'   EB             C      	EX	DE,HL
  49F6'   11 0050        C      	LD	DE,80
  49F9'   19             C      	ADD	HL,DE	;neuen Zeilenanfang berechnen
  49FA'   EB             C      	EX	DE,HL
  49FB'   E1             C      	POP	HL
  49FC'   10 F1          C      	DJNZ	KH.AZBL1
  49FE'   C9             C      	RET
                         C      ;                                IN...HL:= Pufferadresse
                         C      ;                                     DE:= Zeilenanfang
  49FF'                  C      KH.AZ1Z:
  49FF'   D5             C      	PUSH	DE	;eine Zeile anzeigen
  4A00'   E5             C      	PUSH	HL
  4A01'   D5             C      	PUSH	DE
  4A02'   E1             C      	POP	HL
  4A03'   01 0040        C      	LD	BC,64
  4A06'   09             C      	ADD	HL,BC
  4A07'   E5             C      	PUSH	HL
  4A08'   C1             C      	POP	BC	;BC:= Anfang ASCII-Darstellung
  4A09'   E1             C      	POP	HL
  4A0A'   CD 4A23'       C      	CALL	KH.AZADR	;Adresse anzeigen
  4A0D'   13             C      	INC	DE
  4A0E'   13             C      	INC	DE
  4A0F'   CD 4A2C'       C      	CALL	KH.AZ4BY	;1. Vierergruppe
  4A12'   13             C      	INC	DE
  4A13'   13             C      	INC	DE
  4A14'   CD 4A2C'       C      	CALL	KH.AZ4BY	;2.      "
  4A17'   13             C      	INC	DE
  4A18'   13             C      	INC	DE
  4A19'   CD 4A2C'       C      	CALL	KH.AZ4BY	;3.      "
  4A1C'   13             C      	INC	DE
  4A1D'   13             C      	INC	DE
  4A1E'   CD 4A2C'       C      	CALL	KH.AZ4BY	;4.      "
  4A21'   D1             C      	POP	DE
  4A22'   C9             C      	RET
  4A23'                  C      KH.AZADR:
  4A23'   7C             C      	LD	A,H	;Anzeige der Adresse
  4A24'   CD 5ABA'       C      	CALL	UC.CVBX+2
  4A27'   7D             C      	LD	A,L
  4A28'   CD 5ABA'       C      	CALL	UC.CVBX+2
  4A2B'   C9             C      	RET
  4A2C'                  C      KH.AZ4BY:
  4A2C'   AF             C      	XOR	A	;Anzeige einer Vierergruppe
  4A2D'   32 2B1C'       C      	LD	(UB.PAR1),A
  4A30'                  C      KH.AZ4B0:
  4A30'   7E             C      	LD	A,(HL)
  4A31'   F5             C      	PUSH	AF
  4A32'   CD 5ABA'       C      	CALL	UC.CVBX+2	;Code als Hexadezimalzahl
  4A35'   F1             C      	POP	AF
  4A36'   13             C      	INC	DE
  4A37'   23             C      	INC	HL
  4A38'   FE 20          C      	CP	20H
  4A3A'   38 15          C      	JR	C,KH.AZ4B1	;nicht darstellbar
  4A3C'   FE 7F          C      	CP	7FH
  4A3E'   30 11          C      	JR	NC,KH.AZ4B1	;nicht darstellbar
  4A40'                  C      KH.AZ4B3:
  4A40'   02             C      	LD	(BC),A	;Code als ASCII-Zeichen
  4A41'   03             C      	INC	BC
  4A42'   CD 4A55'       C      	CALL	KH.BLEVG	;Test auf Blockende
  4A45'   3A 2B1C'       C      	LD	A,(UB.PAR1)
  4A48'   3C             C      	INC	A
  4A49'   FE 04          C      	CP	4
  4A4B'   C8             C      	RET	Z
'Kommandos: KRDx und KWRx'	MACRO-80 3.44	09-Dec-81	PAGE	1-34


  4A4C'   32 2B1C'       C      	LD	(UB.PAR1),A
  4A4F'   18 DF          C      	JR	KH.AZ4B0
  4A51'                  C      KH.AZ4B1:
  4A51'   3E 7F          C      	LD	A,07FH
  4A53'   18 EB          C      	JR	KH.AZ4B3
  4A55'                  C      KH.BLEVG:
  4A55'   D5             C      	PUSH	DE	;Blockendetest
  4A56'   E5             C      	PUSH	HL
  4A57'   11 0E66        C      	LD	DE,UE.PUF	;DE:= Pufferanfang
  4A5A'   B7             C      	OR	A
  4A5B'   ED 52          C      	SBC	HL,DE	;HL:= Anzahl der angezeigten
  4A5D'   EB             C      	EX	DE,HL
  4A5E'   CD 5A26'       C      	CALL	XY.LIDX
  4A61'   09             C      	DB	9
  4A62'   B7             C      	OR	A
  4A63'   ED 52          C      	SBC	HL,DE
  4A65'   E1             C      	POP	HL
  4A66'   D1             C      	POP	DE
  4A67'   28 01          C      	JR	Z,KH.BLEV1
  4A69'   C9             C      	RET
  4A6A'                  C      KH.BLEV1:
  4A6A'   06 0C          C      	LD	B,12
  4A6C'                  C      KH.BLEV2:
  4A6C'   33             C      	INC	SP
  4A6D'   10 FD          C      	DJNZ	KH.BLEV2
  4A6F'   C9             C      	RET		;---> Anzeige beendet
                         C      ;*********************************************************************
  4A70'   4A70'          C      	DW	$
  4A72'   4B 57 52 31    C      	DB	'KWR1'
  4A76'   18 06          C      	JR	KH.WRSTA
                         C      ;
  4A78'   4A78'          C      	DW	$
  4A7A'   4B 57 52 32    C      	DB	'KWR2'
  4A7E'                  C      KH.WRSTA:
  4A7E'   3A 3325        C      	LD	A,(UE.BWSA+325H)
  4A81'   DD 21 2B01'    C      	LD	IX,UB.KTAB	;Block aufzeichnen
  4A85'   DD CB 00 56    C      	BIT	2,(IX)
  4A89'   28 07          C      	JR	Z,$+9
  4A8B'   F5             C      	PUSH	AF
  4A8C'   3E 19          C      	LD	A,19H
  4A8E'   CD 4280'       C      	CALL	UF.ERANZ
  4A91'   F1             C      	POP	AF
  4A92'   E6 0F          C      	AND	0FH
  4A94'   DD 77 03       C      	LD	(IX+3),A
  4A97'   DD 36 04 00    C      	LD	(IX+4),00H
  4A9B'   CD 4266'       C      	CALL	UF.EXEC
  4A9E'   CD 565F'       C      	CALL	UR.KBR
  4AA1'   C3 495F'       C      	JP	KH.RD1
  4AA4'                  C      KH.KBRS:
  4AA4'   CD 565F'       C      	CALL	UR.KBR
  4AA7'   CD 4AAC'       C      	CALL	KH.BILO
  4AAA'   D1             C      	POP	DE
  4AAB'   C9             C      	RET
                         C      ;----------------------------------------------------
  4AAC'                  C      KH.BILO:
  4AAC'   21 3000        C      	LD	HL,3000H
  4AAF'   01 0800        C      	LD	BC,800H
  4AB2'   36 20          C      	LD	(HL),20H
  4AB4'   E5             C      	PUSH	HL
  4AB5'   D1             C      	POP	DE
  4AB6'   13             C      	INC	DE
  4AB7'   ED B0          C      	LDIR
  4AB9'   C9             C      	RET
                         C      ;------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Ein-/Ausgabe im freien Format'
                         C      	PAGE
'Ein-/Ausgabe im freien Format'	MACRO-80 3.44	09-Dec-81	PAGE	1-35


                         C      
                         C      ;	PN	FD
                         C      ;**********************************************************************
                         C      ;
                         C      ;      Ein-/Ausgabe von Dateien im freien Format in bzw. aus demEditor-
                         C      ;      raum von bzw. auf MRES-Kassetten
                         C      ;
                         C      ;**********************************************************************
                         C      ;      Positionieren auf Datei, IN: <C>:= Labelnummer
                         C      ;
  4ABA'                  C      FD.POSK:
  4ABA'   C5             C      	PUSH	BC
  4ABB'   41             C      	LD	B,C
  4ABC'   04             C      	INC	B
  4ABD'   CD 566E'       C      	CALL	UR.POSIK
  4AC0'   CD 4AD2'       C      	CALL	FD.KO01
  4AC3'   3A 0E66        C      	LD	A,(UE.PUF)
  4AC6'   B9             C      	CP	C
  4AC7'   C1             C      	POP	BC
  4AC8'   20 01          C      	JR	NZ,$+3
  4ACA'   C9             C      	RET
  4ACB'   D1             C      	POP	DE
  4ACC'   3E 94          C      	LD	A,94H
  4ACE'   CD 4280'       C      	CALL	UF.ERANZ
  4AD1'   C9             C      	RET
                         C      ;
  4AD2'   DD 36 05 02    C      FD.KO01:	LD	(IX+5),2	;FUER FD19
  4AD6'   C3 4266'       C      	JP	UF.EXEC
                         C      ;----------------------------------------------------------------------
                         C      ;      Datei im Verzeichnis suchen
                         C      ;      HL:= Dateiname, <B>:= Anzahl Verzeichniseintragungen + 1
                         C      ;      <D>:= Dateityp
                         C      ;      O:  CY:= 0 Datei nicht vorhanden, <C> unveraendert
                         C      ;          CY:= 1 <C>:= Labelnummer
                         C      ;      K:  B
  4AD9'                  C      FD.DASU:
  4AD9'   D5             C      	PUSH	DE
  4ADA'   05             C      	DEC	B
  4ADB'   28 0A          C      	JR	Z,$+12
  4ADD'   CD 4AD2'       C      	CALL	FD.KO01
  4AE0'   CD 58E4'       C      	CALL	U1.NMVGL
  4AE3'   38 05          C      	JR	C,$+7
  4AE5'   10 F6          C      	DJNZ	$-8
  4AE7'   B7             C      	OR	A
  4AE8'   D1             C      	POP	DE
  4AE9'   C9             C      	RET
  4AEA'   5F             C      	LD	E,A
  4AEB'   3A 0E6C        C      	LD	A,(UE.PUF+6)
  4AEE'   BA             C      	CP	D
  4AEF'   20 F4          C      	JR	NZ,$-10
  4AF1'   4B             C      	LD	C,E
  4AF2'   37             C      	SCF
  4AF3'   18 F3          C      	JR	$-11
                         C      ;----------------------------------------------------------------------
                         C      ;      Reservebloecke schreiben
                         C      ;
  4AF5'                  C      FD.WRRES:
  4AF5'   C5             C      	PUSH	BC
  4AF6'   D5             C      	PUSH	DE
  4AF7'   E5             C      	PUSH	HL
  4AF8'   21 44EE'       C      	LD	HL,UA.ZKRES
  4AFB'   CD 56D1'       C      	CALL	UR.MIMO
  4AFE'   EB             C      	EX	DE,HL
  4AFF'   CD 5B74'       C      	CALL	UC.CVDB
  4B02'   7C             C      	LD	A,H
  4B03'   B5             C      	OR	L
  4B04'   20 04          C      	JR	NZ,$+6
  4B06'   E1             C      	POP	HL
  4B07'   D1             C      	POP	DE
  4B08'   C1             C      	POP	BC
  4B09'   C9             C      	RET
  4B0A'   E5             C      	PUSH	HL
  4B0B'   21 0E66        C      	LD	HL,UE.PUF
  4B0E'   01 0090        C      	LD	BC,90H
  4B11'   CD 582D'       C      	CALL	U1.CLRB
  4B14'   21 0080        C      	LD	HL,80H
  4B17'   CD 5A46'       C      	CALL	XY.STIDX
  4B1A'   09             C      	DB	9
  4B1B'   E1             C      	POP	HL
  4B1C'   CD 5E5D'       C      	CALL	UK.KBA
  4B1F'   2B             C      	DEC	HL
  4B20'   7C             C      	LD	A,H
'Ein-/Ausgabe im freien Format'	MACRO-80 3.44	09-Dec-81	PAGE	1-36


  4B21'   B5             C      	OR	L
  4B22'   20 E6          C      	JR	NZ,$-24
  4B24'   18 E0          C      	JR	$-30
                         C      ;----------------------------------------------------------------------
                         C      ;      F/S - Datei in den Editorraum einlesen
                         C      ;
  4B26'                  C      FD.FDINP:
  4B26'   21 0000        C      	LD	HL,0
  4B29'   CD 5A36'       C      	CALL	XY.STDX
  4B2C'   11             C      	DB	17
  4B2D'   CD 5DAC'       C      	CALL	UK.KLPFB	;Pufferbereitstellung
  4B30'   21 3328        C      	LD	HL,UE.BWSA+328H
  4B33'   06 05          C      	LD	B,5
  4B35'   7E             C      	LD	A,(HL)
  4B36'   FE 45          C      	CP	'E'
  4B38'   28 05          C      	JR	Z,$+7
  4B3A'   23             C      	INC	HL
  4B3B'   10 F8          C      	DJNZ	$-6
  4B3D'   18 05          C      	JR	$+7
  4B3F'   2A 0DC4        C      	LD	HL,(UE.EDEND)
  4B42'   18 03          C      	JR	$+5
  4B44'   21 8830        C      	LD	HL,UE.TEXAN
  4B47'   D9             C      	EXX
  4B48'   CD 5D69'       C      	CALL	DC.INIT	;Dekomprimierung initialisieren
  4B4B'   D9             C      	EXX
  4B4C'   3A 2B1E'       C      	LD	A,(UB.PAR2)	;Dateitypmerker
  4B4F'   FE 53          C      	CP	'S'
  4B51'   F5             C      	PUSH	AF
  4B52'   CC 4B6D'       C      	CALL	Z,FD.SDIN	;Zeicheneingabe S- Datei
  4B55'   77             C      	LD	(HL),A
  4B56'   B7             C      	OR	A
  4B57'   28 12          C      	JR	Z,$+20
  4B59'   F1             C      	POP	AF
  4B5A'   28 07          C      	JR	Z,$+9
  4B5C'   C4 5D6F'       C      	CALL	NZ,UK.GETK	;Zeicheneingabe F- Datei
  4B5F'   77             C      	LD	(HL),A	;Zeichen in Speicher eintragen
  4B60'   BE             C      	CP	(HL)	;Echolesen
  4B61'   20 10          C      	JR	NZ,$+18
  4B63'   B7             C      	OR	A	;<A>:= 0, Z:= 1
  4B64'   C8             C      	RET	Z
  4B65'   23             C      	INC	HL	;HL:= HL + 1
  4B66'   22 0DC4        C      	LD	(UE.EDEND),HL	;Textende
  4B69'   18 E1          C      	JR	$-29
  4B6B'   F1             C      	POP	AF
  4B6C'   C9             C      	RET
  4B6D'                  C      FD.SDIN:
  4B6D'   D9             C      	EXX
  4B6E'   CD 5D2E'       C      	CALL	DC.DCMPR
  4B71'   D9             C      	EXX
  4B72'   C9             C      	RET
  4B73'   3E 93          C      	LD	A,93H	;Fehlerschluessel
  4B75'   CD 4280'       C      	CALL	UF.ERANZ
  4B78'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;      Ausgabe einer F/S - Datei (neuer Bestand)
                         C      ;
  4B79'                  C      FD.FDOUT:
  4B79'   21 0000        C      	LD	HL,0	;Blockzaehler loeschen
  4B7C'   CD 5A36'       C      	CALL	XY.STDX
  4B7F'   11             C      	DB	17
  4B80'   21 0080        C      	LD	HL,80H	;Blocklaenge eintragen
  4B83'   CD 5A46'       C      	CALL	XY.STIDX
  4B86'   09             C      	DB	9
  4B87'   CD 5E38'       C      	CALL	UK.KSPFB	;Pufferbereitstellung
  4B8A'   21 8830        C      	LD	HL,UE.TEXAN	;HL:= Textanfang
  4B8D'   ED 5B 0DC4     C      	LD	DE,(UE.EDEND)	;BC:= Textende
  4B91'   D9             C      	EXX
  4B92'   CD 5D28'       C      	CALL	CP.INIT
  4B95'   D9             C      	EXX
  4B96'   B7             C      	OR	A	;CY:= 0
  4B97'   E5             C      	PUSH	HL
  4B98'   ED 52          C      	SBC	HL,DE
  4B9A'   30 13          C      	JR	NC,$+21
  4B9C'   E1             C      	POP	HL
  4B9D'   3A 2B1E'       C      	LD	A,(UB.PAR2)
  4BA0'   FE 53          C      	CP	'S'
  4BA2'   F5             C      	PUSH	AF
  4BA3'   7E             C      	LD	A,(HL)
  4BA4'   CC 4BC7'       C      	CALL	Z,FD.SDOUT
  4BA7'   F1             C      	POP	AF
  4BA8'   7E             C      	LD	A,(HL)
  4BA9'   C4 5E14'       C      	CALL	NZ,UK.PUTK
  4BAC'   23             C      	INC	HL
'Ein-/Ausgabe im freien Format'	MACRO-80 3.44	09-Dec-81	PAGE	1-37


  4BAD'   18 E7          C      	JR	$-23
  4BAF'   E1             C      	POP	HL	;Endebehandlung
  4BB0'   01 0120        C      	LD	BC,288
  4BB3'   AF             C      	XOR	A
  4BB4'   CD 5E14'       C      	CALL	UK.PUTK
  4BB7'   0B             C      	DEC	BC
  4BB8'   78             C      	LD	A,B
  4BB9'   B1             C      	OR	C
  4BBA'   20 F7          C      	JR	NZ,$-7
  4BBC'   CD 4D8B'       C      	CALL	FD.DSPBB
  4BBF'   CD 4AF5'       C      	CALL	FD.WRRES	;Reservebloecke schreiben
  4BC2'   CD 5A16'       C      	CALL	XY.LDDX	;HL:= Blockzaehler
  4BC5'   11             C      	DB	17
  4BC6'   C9             C      	RET
  4BC7'                  C      FD.SDOUT:
  4BC7'   D9             C      	EXX
  4BC8'   CD 5CC5'       C      	CALL	CP.COMPR
  4BCB'   D9             C      	EXX
  4BCC'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;      Ausgabe einer F/S - Datei (alter Bestand)
                         C      ;
  4BCD'                  C      FD.FDOWR:
  4BCD'   21 0000        C      	LD	HL,0
  4BD0'   CD 5A36'       C      	CALL	XY.STDX
  4BD3'   11             C      	DB	17
  4BD4'   21 8830        C      	LD	HL,UE.TEXAN
  4BD7'   D9             C      	EXX
  4BD8'   CD 5D28'       C      	CALL	CP.INIT
  4BDB'   D9             C      	EXX
  4BDC'   E5             C      	PUSH	HL
  4BDD'                  C      FD.FDOW1:
  4BDD'   CD 4C1D'       C      	CALL	FD.FDUP
  4BE0'   E1             C      	POP	HL
  4BE1'                  C      FD.FDOW2:
  4BE1'   E5             C      	PUSH	HL
  4BE2'   ED 5B 0DC4     C      	LD	DE,(UE.EDEND)
  4BE6'   B7             C      	OR	A
  4BE7'   ED 52          C      	SBC	HL,DE
  4BE9'   30 1B          C      	JR	NC,FD.FDOW3
  4BEB'   E1             C      	POP	HL
  4BEC'   3A 2B1E'       C      	LD	A,(UB.PAR2)
  4BEF'   FE 53          C      	CP	'S'
  4BF1'   7E             C      	LD	A,(HL)
  4BF2'   28 42          C      	JR	Z,FD.SDOW
  4BF4'   CD 5E14'       C      	CALL	UK.PUTK
  4BF7'   0B             C      	DEC	BC
  4BF8'                  C      FD.FDOW4:
  4BF8'   23             C      	INC	HL
  4BF9'   78             C      	LD	A,B
  4BFA'   B1             C      	OR	C
  4BFB'   20 E4          C      	JR	NZ,FD.FDOW2
  4BFD'   CD 5E5D'       C      	CALL	UK.KBA	;Block schreiben
  4C00'   E5             C      	PUSH	HL
  4C01'   CD 4C13'       C      	CALL	FD.DECBZ
  4C04'   18 D7          C      	JR	FD.FDOW1
  4C06'                  C      FD.FDOW3:
  4C06'   E1             C      	POP	HL
  4C07'   AF             C      	XOR	A	;Endekennzeichen 00H 
  4C08'   CD 5E14'       C      	CALL	UK.PUTK
  4C0B'   CD 5E5D'       C      	CALL	UK.KBA
  4C0E'   CD 4C13'       C      	CALL	FD.DECBZ
  4C11'   B7             C      	OR	A
  4C12'   C9             C      	RET
  4C13'                  C      FD.DECBZ:
  4C13'   CD 5A16'       C      	CALL	XY.LDDX
  4C16'   11             C      	DB	17
  4C17'   2B             C      	DEC	HL
  4C18'   CD 5A36'       C      	CALL	XY.STDX
  4C1B'   11             C      	DB	17
  4C1C'   C9             C      	RET
  4C1D'                  C      FD.FDUP:
  4C1D'   CD 5DCF'       C      	CALL	UK.KBW
  4C20'   DD 7E 09       C      	LD	A,(IX+9)
  4C23'   DD B6 0A       C      	OR	(IX+10)
  4C26'   CA 4DB1'       C      	JP	Z,FD.BMGF
  4C29'   CD 565F'       C      	CALL	UR.KBR
  4C2C'   CD 5A26'       C      	CALL	XY.LIDX
  4C2F'   09             C      	DB	9
  4C30'   E5             C      	PUSH	HL
  4C31'   C1             C      	POP	BC
  4C32'   CD 5E38'       C      	CALL	UK.KSPFB
  4C35'   C9             C      	RET
'Ein-/Ausgabe im freien Format'	MACRO-80 3.44	09-Dec-81	PAGE	1-38


  4C36'                  C      FD.SDOW:
  4C36'   CD 4BC7'       C      	CALL	FD.SDOUT
  4C39'   78             C      	LD	A,B
  4C3A'   A1             C      	AND	C
  4C3B'   FE FF          C      	CP	0FFH
  4C3D'   28 1B          C      	JR	Z,FD.SDK1
  4C3F'   FE FE          C      	CP	0FEH
  4C41'   28 03          C      	JR	Z,FD.SDK2
  4C43'   C3 4BF8'       C      	JP	FD.FDOW4
  4C46'                  C      FD.SDK2:
  4C46'   EB             C      	EX	DE,HL
  4C47'   CD 4C1D'       C      	CALL	FD.FDUP
  4C4A'   3E 09          C      	LD	A,09H
  4C4C'   CD 5E14'       C      	CALL	UK.PUTK
  4C4F'   0B             C      	DEC	BC
  4C50'                  C      FD.SDK0:
  4C50'   3E 3B          C      	LD	A,';'
  4C52'   CD 5E14'       C      	CALL	UK.PUTK
  4C55'   0B             C      	DEC	BC
  4C56'   EB             C      	EX	DE,HL
  4C57'   C3 4BF8'       C      	JP	FD.FDOW4
  4C5A'                  C      FD.SDK1:
  4C5A'   EB             C      	EX	DE,HL
  4C5B'   CD 4C1D'       C      	CALL	FD.FDUP
  4C5E'   18 F0          C      	JR	FD.SDK0
                         C      ;--------------------------------------------------------------
                         C      ;        Startroutine Ein-/Ausgabe
                         C      ;
  4C60'                  C      FD.FSTRT:
  4C60'   CD 59C6'       C      	CALL	U1.BILO
  4C63'   CD 58FF'       C      	CALL	U1.KTINI
  4C66'   3A 3326        C      	LD	A,(UE.BWSA+326H)
  4C69'   CD 59DA'       C      	CALL	U1.TST
  4C6C'   DA 4C98'       C      	JP	C,FD.STRT1
  4C6F'   DD 77 03       C      	LD	(IX+3),A
  4C72'   CD 5629'       C      	CALL	UR.KRE
  4C75'   CD 5637'       C      	CALL	UR.KRWW
  4C78'   CD 58B3'       C      	CALL	U1.DSVG
  4C7B'   3E 0E          C      	LD	A,14
  4C7D'   32 2B00'       C      	LD	(UB.ZN),A
  4C80'   3A 3328        C      	LD	A,(UE.BWSA+328H)
  4C83'   FE 53          C      	CP	'S'
  4C85'   28 02          C      	JR	Z,$+4
  4C87'   3E 46          C      	LD	A,'F'
  4C89'   57             C      	LD	D,A
  4C8A'   32 2B1E'       C      	LD	(UB.PAR2),A
  4C8D'   21 4501'       C      	LD	HL,UA.ZKSDT
  4C90'   28 03          C      	JR	Z,$+5
  4C92'   21 4471'       C      	LD	HL,UA.ZKDAT
  4C95'   CD 56D1'       C      	CALL	UR.MIMO
  4C98'                  C      FD.STRT1:
  4C98'   FD E1          C      	POP	IY
  4C9A'   D8             C      	RET	C
  4C9B'   FD E5          C      	PUSH	IY
  4C9D'   3E 53          C      	LD	A,'S'
  4C9F'   BA             C      	CP	D
  4CA0'   CC 4CCB'       C      	CALL	Z,FD.DECHL
  4CA3'   CD 4AD9'       C      	CALL	FD.DASU
  4CA6'   DC 4CAD'       C      	CALL	C,FD.SETJ
  4CA9'   D4 4CC5'       C      	CALL	NC,FD.SETN
  4CAC'   C9             C      	RET
  4CAD'                  C      FD.SETJ:
  4CAD'   C5             C      	PUSH	BC
  4CAE'   D5             C      	PUSH	DE
  4CAF'   E5             C      	PUSH	HL
  4CB0'   EB             C      	EX	DE,HL
  4CB1'   06 08          C      	LD	B,8
  4CB3'   13             C      	INC	DE
  4CB4'   10 FD          C      	DJNZ	$-1
  4CB6'   21 0E6E        C      	LD	HL,UE.PUF+8
  4CB9'   01 0006        C      	LD	BC,6
  4CBC'   ED B0          C      	LDIR
  4CBE'   E1             C      	POP	HL
  4CBF'   D1             C      	POP	DE
  4CC0'   C1             C      	POP	BC
  4CC1'   3E 4A          C      	LD	A,'J'
  4CC3'   18 02          C      	JR	$+4
  4CC5'                  C      FD.SETN:
  4CC5'   3E 4E          C      	LD	A,'N'
  4CC7'   32 2B1C'       C      	LD	(UB.PAR1),A
  4CCA'   C9             C      	RET
  4CCB'                  C      FD.DECHL:
  4CCB'   2B             C      	DEC	HL
'Ein-/Ausgabe im freien Format'	MACRO-80 3.44	09-Dec-81	PAGE	1-39


  4CCC'   2B             C      	DEC	HL
  4CCD'   C9             C      	RET
                         C      ;****************************************************************
                         C      ;        Ausgabeprogramm
                         C      ;****************************************************************
  4CCE'   4CCE'          C      	DW	$
  4CD0'   41 55 53 20    C      	DB	'AUS '
  4CD4'                  C      FD.FOUT1:
  4CD4'   CD 4C60'       C      	CALL	FD.FSTRT
  4CD7'   3A 2B1C'       C      	LD	A,(UB.PAR1)
  4CDA'   FE 4A          C      	CP	'J'	;DATEI SCHON VORHANDEN ?
  4CDC'   CA 4D47'       C      	JP	Z,FD.FOLWR	;JA
                         C      ;-------------------------------NEIN--> NEUE ERSTELLEN-----------------
  4CDF'   79             C      	LD	A,C	;NEXT RECORD
  4CE0'   32 2B1C'       C      	LD	(UB.PAR1),A
  4CE3'   3E 7F          C      	LD	A,7FH
  4CE5'   32 2B20'       C      	LD	(UB.PAR3),A	;PARAMETER KOMMENTARABFRAGE JA
  4CE8'   CD 5963'       C      	CALL	U1.VZS	;NEUEN VERZ.SATZ SCHREIBEN
  4CEB'   CD 4ABA'       C      	CALL	FD.POSK
  4CEE'   C5             C      	PUSH	BC
  4CEF'   CD 4B79'       C      	CALL	FD.FDOUT
  4CF2'   E5             C      	PUSH	HL	;BLOCKZAEHLER
  4CF3'   CD 564D'       C      	CALL	UR.KBM
  4CF6'   21 0020        C      	LD	HL,32
  4CF9'   CD 5A46'       C      	CALL	XY.STIDX
  4CFC'   09             C      	DB	9
  4CFD'   CD 58A3'       C      	CALL	U1.VSX
  4D00'   E1             C      	POP	HL
  4D01'   C1             C      	POP	BC
  4D02'   E5             C      	PUSH	HL
  4D03'   79             C      	LD	A,C
  4D04'   3C             C      	INC	A
  4D05'   32 0E66        C      	LD	(UE.PUF),A
  4D08'   F5             C      	PUSH	AF
  4D09'   DD 36 04 00    C      	LD	(IX+4),00H
  4D0D'   CD 4266'       C      	CALL	UF.EXEC
  4D10'   CD 5637'       C      	CALL	UR.KRWW
  4D13'   CD 58B3'       C      	CALL	U1.DSVG
  4D16'   CD 565F'       C      	CALL	UR.KBR
  4D19'   F1             C      	POP	AF
  4D1A'   32 0E67        C      	LD	(UE.PUF+1),A
  4D1D'   78             C      	LD	A,B
  4D1E'   3C             C      	INC	A
  4D1F'   32 0E69        C      	LD	(UE.PUF+3),A
  4D22'   DD 36 04 00    C      	LD	(IX+4),00H
  4D26'   CD 4266'       C      	CALL	UF.EXEC
  4D29'   DD 36 04 02    C      	LD	(IX+4),02H
  4D2D'   CD 4266'       C      	CALL	UF.EXEC
  4D30'   10 FB          C      	DJNZ	$-3
  4D32'   CD 565F'       C      	CALL	UR.KBR
  4D35'   E1             C      	POP	HL
  4D36'   22 0E7F        C      	LD	(UE.PUF+25),HL
  4D39'   DD 36 04 00    C      	LD	(IX+4),00H
  4D3D'   CD 4266'       C      	CALL	UF.EXEC
  4D40'                  C      FD.END:
  4D40'   CD 5631'       C      	CALL	UR.KRW
  4D43'   CD 563B'       C      	CALL	UR.KRA
  4D46'   C9             C      	RET
  4D47'                  C      FD.FOLWR:
  4D47'   21 44D0'       C      	LD	HL,UA.ZKDL	;DATEI UEBERSCHREIBEN?
  4D4A'   CD 56D1'       C      	CALL	UR.MIMO
  4D4D'   D8             C      	RET	C
  4D4E'   7E             C      	LD	A,(HL)
  4D4F'   FE 4A          C      	CP	'J'
  4D51'   C0             C      	RET	NZ
  4D52'   CD 4ABA'       C      	CALL	FD.POSK
  4D55'   CD 4BCD'       C      	CALL	FD.FDOWR
  4D58'   CD 4D8B'       C      	CALL	FD.DSPBB
  4D5B'   CD 4DA5'       C      	CALL	FD.RDEND
  4D5E'   CD 4D9B'       C      	CALL	FD.DSPBG
  4D61'   18 DD          C      	JR	$-33
                         C      ;**********************************************************************
                         C      ;      Eingabeprogramm
                         C      ;**********************************************************************
  4D63'   4D63'          C      	DW	$
  4D65'   45 49 4E 20    C      	DB	'EIN '
  4D69'                  C      FD.FDIN2:
  4D69'   CD 4C60'       C      	CALL	FD.FSTRT
  4D6C'   3A 2B1C'       C      	LD	A,(UB.PAR1)
  4D6F'   FE 4A          C      	CP	'J'
  4D71'   28 07          C      	JR	Z,$+9
  4D73'   3E 91          C      	LD	A,91H
  4D75'   CD 4280'       C      	CALL	UF.ERANZ
'Ein-/Ausgabe im freien Format'	MACRO-80 3.44	09-Dec-81	PAGE	1-40


  4D78'   18 C6          C      	JR	FD.END
  4D7A'   CD 4ABA'       C      	CALL	FD.POSK
  4D7D'   CD 4B26'       C      	CALL	FD.FDINP
  4D80'   CD 4D8B'       C      	CALL	FD.DSPBB
  4D83'   CD 4DA5'       C      	CALL	FD.RDEND
  4D86'   CD 4D9B'       C      	CALL	FD.DSPBG
  4D89'   18 B5          C      	JR	FD.END
                         C      ;----------------------------------------------------------------------
  4D8B'                  C      FD.DSPBB:
  4D8B'   CD 5A16'       C      	CALL	XY.LDDX
  4D8E'   11             C      	DB	17
  4D8F'   EB             C      	EX	DE,HL
  4D90'   21 4516'       C      	LD	HL,UA.ZKBEL
  4D93'   CD 56D1'       C      	CALL	UR.MIMO
  4D96'   EB             C      	EX	DE,HL
  4D97'   CD 5B2B'       C      	CALL	UC.CVBD3
  4D9A'   C9             C      	RET
  4D9B'                  C      FD.DSPBG:
  4D9B'   CD 5A16'       C      	CALL	XY.LDDX
  4D9E'   11             C      	DB	17
  4D9F'   EB             C      	EX	DE,HL
  4DA0'   21 4529'       C      	LD	HL,UA.ZKBLG
  4DA3'   18 EE          C      	JR	$-16
  4DA5'                  C      FD.RDEND:
  4DA5'   CD 5DCF'       C      	CALL	UK.KBW
  4DA8'   DD 7E 09       C      	LD	A,(IX+9)
  4DAB'   DD B6 0A       C      	OR	(IX+10)
  4DAE'   C8             C      	RET	Z
  4DAF'   18 F4          C      	JR	FD.RDEND
  4DB1'                  C      FD.BMGF:
  4DB1'   3E 95          C      	LD	A,95H
  4DB3'   CD 4280'       C      	CALL	UF.ERANZ
  4DB6'   D1             C      	POP	DE
  4DB7'   D1             C      	POP	DE
  4DB8'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Laden von MRES-P-Dateien'
                         C      	PAGE
'Laden von MRES-P-Dateien'	MACRO-80 3.44	09-Dec-81	PAGE	1-41


                         C      
                         C      ;	PN	LD
                         C      ;***********************************************************
                         C      ;
                         C      ;        Laden von MRES-P-Dateien
                         C      ;
                         C      ;***********************************************************
  4DB9'   4DB9'          C      	DW	$
  4DBB'   4C 4F 41 44    C      	DB	'LOAD'
  4DBF'   3A 3327        C      	LD	A,(UE.BWSA+327H)
  4DC2'   CD 59DA'       C      	CALL	U1.TST
  4DC5'   D8             C      	RET	C
  4DC6'   CD 58FF'       C      	CALL	U1.KTINI
  4DC9'   DD 77 03       C      	LD	(IX+3),A
  4DCC'   CD 59C6'       C      	CALL	U1.BILO
  4DCF'   3E 0D          C      	LD	A,13
  4DD1'   32 2B00'       C      	LD	(UB.ZN),A
  4DD4'                  C      LD.DATN:
  4DD4'   21 4471'       C      	LD	HL,UA.ZKDAT	;Dateiname ?
  4DD7'   CD 56D1'       C      	CALL	UR.MIMO
  4DDA'   D8             C      	RET	C
  4DDB'   CD 5629'       C      	CALL	UR.KRE
  4DDE'   CD 5637'       C      	CALL	UR.KRWW
  4DE1'   CD 58B3'       C      	CALL	U1.DSVG
  4DE4'   3E 01          C      	LD	A,01H
  4DE6'   B8             C      	CP	B
  4DE7'   28 0A          C      	JR	Z,LD.LD21	;NEU INITIALISIERTE KASSETTE
  4DE9'                  C      LD.LD2:
  4DE9'   CD 5DCF'       C      	CALL	UK.KBW
  4DEC'   CD 58E4'       C      	CALL	U1.NMVGL	;Dateiname vergleichen
  4DEF'   38 08          C      	JR	C,LD.DATFU	;---> Datei gefunden
  4DF1'   10 F6          C      	DJNZ	LD.LD2
  4DF3'                  C      LD.LD21:
  4DF3'   3E 91          C      	LD	A,91H	;Datei nicht vorhanden
  4DF5'   CD 4280'       C      	CALL	UF.ERANZ	;FEHLERANZEIGE
  4DF8'   C9             C      	RET
  4DF9'                  C      LD.DATFU:
  4DF9'   3A 0E6C        C      	LD	A,(UE.PUF+6)	;TYP
  4DFC'   FE 4F          C      	CP	'O'
  4DFE'   F5             C      	PUSH	AF
  4DFF'   21 0E7D        C      	LD	HL,UE.PUF+23
  4E02'   7E             C      	LD	A,(HL)
  4E03'   F5             C      	PUSH	AF
  4E04'   47             C      	LD	B,A
  4E05'   04             C      	INC	B
  4E06'   CD 566E'       C      	CALL	UR.POSIK	;Positionieren
  4E09'   CD 5DCF'       C      	CALL	UK.KBW
  4E0C'   F1             C      	POP	AF
  4E0D'   21 0E66        C      	LD	HL,UE.PUF
  4E10'   BE             C      	CP	(HL)
  4E11'   28 07          C      	JR	Z,LD.DATPO	;Datei richtig positioniert
  4E13'   F1             C      	POP	AF
  4E14'   3E 94          C      	LD	A,94H
  4E16'   CD 4280'       C      	CALL	UF.ERANZ
  4E19'   C9             C      	RET
  4E1A'                  C      LD.DATPO:
  4E1A'   F1             C      	POP	AF
  4E1B'   CA 4EB0'       C      	JP	Z,RL.BEG
  4E1E'   3A 3329        C      	LD	A,(UE.BWSA+329H)
  4E21'   FE 56          C      	CP	'V'
  4E23'   20 57          C      	JR	NZ,LD.LD3
  4E25'   21 4484'       C      	LD	HL,UA.ZKLAD	;Ladeadresse ?
  4E28'   CD 56D1'       C      	CALL	UR.MIMO
  4E2B'   DA 4DD4'       C      	JP	C,LD.DATN
  4E2E'   CD 59E4'       C      	CALL	U1.PRADR	;ADRESSE EINGEGEBEN
  4E31'   38 F2          C      	JR	C,$-12
  4E33'   EB             C      	EX	DE,HL
  4E34'   21 2B1C'       C      	LD	HL,UB.PAR1
  4E37'   CD 5B18'       C      	CALL	UC.CVXA
  4E3A'                  C      LD.LD4:
  4E3A'   CD 5DAC'       C      	CALL	UK.KLPFB
  4E3D'   CD 5D6F'       C      	CALL	UK.GETK
  4E40'   CD 5D6F'       C      	CALL	UK.GETK
  4E43'   67             C      	LD	H,A
  4E44'   CD 5D6F'       C      	CALL	UK.GETK
  4E47'   6F             C      	LD	L,A
  4E48'   7A             C      	LD	A,D
  4E49'   B3             C      	OR	E
  4E4A'   28 09          C      	JR	Z,LD.LD5
  4E4C'   ED 5B 2B1C'    C      	LD	DE,(UB.PAR1)
  4E50'   EB             C      	EX	DE,HL
  4E51'   B7             C      	OR	A
'Laden von MRES-P-Dateien'	MACRO-80 3.44	09-Dec-81	PAGE	1-42


  4E52'   ED 52          C      	SBC	HL,DE
  4E54'   EB             C      	EX	DE,HL	;DE:= Verschiebung zur ersten
  4E55'                  C      LD.LD5:
  4E55'   CD 565F'       C      	CALL	UR.KBR
  4E58'   CD 4E81'       C      	CALL	LD.LADER
  4E5B'   22 2B1E'       C      	LD	(UB.PAR2),HL
  4E5E'   21 3329        C      	LD	HL,UE.BWSA+329H
  4E61'   06 04          C      	LD	B,4
  4E63'   7E             C      	LD	A,(HL)
  4E64'   FE 53          C      	CP	'S'
  4E66'   28 0A          C      	JR	Z,LD.START
  4E68'   23             C      	INC	HL
  4E69'   10 F8          C      	DJNZ	$-6
  4E6B'   CD 5631'       C      	CALL	UR.KRW
  4E6E'   CD 563B'       C      	CALL	UR.KRA
  4E71'   C9             C      	RET
  4E72'                  C      LD.START:
  4E72'   CD 5631'       C      	CALL	UR.KRW
  4E75'   CD 563B'       C      	CALL	UR.KRA
  4E78'   2A 2B1E'       C      	LD	HL,(UB.PAR2)
  4E7B'   E9             C      	JP	(HL)
  4E7C'                  C      LD.LD3:
  4E7C'   11 0000        C      	LD	DE,0
  4E7F'   18 B9          C      	JR	LD.LD4
                         C      ;--------------------------------------------------------------
  4E81'                  C      LD.LADER:
  4E81'   CD 5DAC'       C      	CALL	UK.KLPFB
  4E84'                  C      LD.LAD2:
  4E84'   CD 5D6F'       C      	CALL	UK.GETK
  4E87'   FE 00          C      	CP	0
  4E89'   28 16          C      	JR	Z,LD.LDEND
  4E8B'   47             C      	LD	B,A
  4E8C'   CD 5D6F'       C      	CALL	UK.GETK
  4E8F'   67             C      	LD	H,A
  4E90'   CD 5D6F'       C      	CALL	UK.GETK
  4E93'   6F             C      	LD	L,A
  4E94'   19             C      	ADD	HL,DE
  4E95'                  C      LD.LAD1:
  4E95'   CD 5D6F'       C      	CALL	UK.GETK
  4E98'   77             C      	LD	(HL),A
  4E99'   BE             C      	CP	(HL)
  4E9A'   20 0E          C      	JR	NZ,LD.LADF
  4E9C'   23             C      	INC	HL
  4E9D'   10 F6          C      	DJNZ	LD.LAD1
  4E9F'   18 E3          C      	JR	LD.LAD2
  4EA1'                  C      LD.LDEND:
  4EA1'   CD 5D6F'       C      	CALL	UK.GETK
  4EA4'   67             C      	LD	H,A
  4EA5'   CD 5D6F'       C      	CALL	UK.GETK
  4EA8'   6F             C      	LD	L,A
  4EA9'   C9             C      	RET
  4EAA'                  C      LD.LADF:
  4EAA'   3E 93          C      	LD	A,93H
  4EAC'   CD 4280'       C      	CALL	UF.ERANZ
  4EAF'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Relativloader fuer O-Dateien'
                         C      	PAGE
'Relativloader fuer O-Dateien'	MACRO-80 3.44	09-Dec-81	PAGE	1-43


                         C      
                         C      ;	PN	RL
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;     RELATIVLOADER FUER O-DATEIEN
                         C      ;
                         C      ;----------------------------------------------------------------------
  4EB0'                  C      RL.BEG:
  4EB0'   21 4497'       C      	LD	HL,UA.ZKBEG	;BEGINN ?
  4EB3'   CD 56D1'       C      	CALL	UR.MIMO
  4EB6'   DA 4DD4'       C      	JP	C,LD.DATN
  4EB9'   CD 59E4'       C      	CALL	U1.PRADR
  4EBC'   38 F2          C      	JR	C,RL.BEG
  4EBE'   EB             C      	EX	DE,HL
  4EBF'   21 2B26'       C      	LD	HL,UB.PATAB
  4EC2'   CD 5B18'       C      	CALL	UC.CVXA
  4EC5'                  C      RL.UG:
  4EC5'   CD 5DCF'       C      	CALL	UK.KBW
  4EC8'   2A 2B26'       C      	LD	HL,(UB.PATAB)	;BGADR---->HL
  4ECB'   0E 01          C      	LD	C,001H	;LADEN BLOCKZAEHLER MIT
                         C      			;ANFANGSWERT
  4ECD'   CD 4F58'       C      	CALL	RL.UP6	; AUFRUF EINGABE-UP
                         C      ;********** TEST BEFEHLSKENNZEICHENBYTE *******************************
  4ED0'                  C      RL.M16:
  4ED0'   CB 5A          C      	BIT	3,D	;TEST ORG-BEFEHL
  4ED2'   C2 4FAC'       C      	JP	NZ,RL.OB	;JA--->FEHLER
  4ED5'   CB 62          C      	BIT	4,D	;TEST BER -BEFEHL
  4ED7'   C2 4F41'       C      	JP	NZ,RL.M10
  4EDA'   3E 07          C      	LD	A,007H
  4EDC'   A2             C      	AND	D	;TEST BEFEHLS LAENGE=0 ?
  4EDD'   CA 4F52'       C      	JP	Z,RL.M11
  4EE0'   47             C      	LD	B,A	;BEFEHLSLAENGE-->B
  4EE1'                  C      RL.M12:
  4EE1'   CD 4F58'       C      	CALL	RL.UP6
  4EE4'   72             C      	LD	(HL),D
  4EE5'   23             C      	INC	HL
  4EE6'   10 F9          C      	DJNZ	RL.M12	;EINGABE BEFEHL
  4EE8'   CD 4F58'       C      	CALL	RL.UP6
  4EEB'   CB 7A          C      	BIT	7,D	;TEST BEFEHLSKENNZEICHENBYTE ?
  4EED'   20 E1          C      	JR	NZ,RL.M16	; JA
                         C      ;******* TEST ADRESSKENNZEICHENBYTE ***********************************
  4EEF'   CB 6A          C      	BIT	5,D	;TEST OB REL.ADR. FOLGT
  4EF1'   CA 4FB0'       C      	JP	Z,RL.RA	;NEIN-->FEHLER
  4EF4'   CB 72          C      	BIT	6,D	;FOLGT BEZUGNAHME AUF
                         C      			;SYMBOLVERZEICHNIS
  4EF6'   C2 4FB4'       C      	JP	NZ,RL.SV	;JA--->FEHLER
  4EF9'   CB 52          C      	BIT	2,D	;MINUS ?
  4EFB'   C2 4FB8'       C      	JP	NZ,RL.MN
  4EFE'                  C      RL.M17:
  4EFE'   3E 03          C      	LD	A,003H
  4F00'   A2             C      	AND	D	;TEST ADRESSLAENGE
  4F01'   F5             C      	PUSH	AF
  4F02'   E5             C      	PUSH	HL
  4F03'   CD 4F58'       C      	CALL	RL.UP6
  4F06'   62             C      	LD	H,D	;ADRESSE ---->HL
  4F07'   CD 4F58'       C      	CALL	RL.UP6
  4F0A'   6A             C      	LD	L,D
  4F0B'   C5             C      	PUSH	BC
  4F0C'   E5             C      	PUSH	HL
  4F0D'   21 2B26'       C      	LD	HL,UB.PATAB
  4F10'   4E             C      	LD	C,(HL)	;BEGINN(LADE)ADRESSE--->BC
  4F11'   23             C      	INC	HL
  4F12'   46             C      	LD	B,(HL)
  4F13'   E1             C      	POP	HL
  4F14'   09             C      	ADD	HL,BC	;ERMITTELN SPEICHERADRESSE
  4F15'   EB             C      	EX	DE,HL	;SP.ADR.--->DE
  4F16'   C1             C      	POP	BC
  4F17'   E1             C      	POP	HL
  4F18'   F1             C      	POP	AF
  4F19'   28 04          C      	JR	Z,RL.M13
  4F1B'   CB 47          C      	BIT	0,A	;NUR L-TEIL DER ADRESSE ?
  4F1D'   28 10          C      	JR	Z,RL.M14	; JA
                         C      ;********** ADRESSE IN SPEICHER EINTRAGEN *****************************
  4F1F'                  C      RL.M13:
  4F1F'   73             C      	LD	(HL),E
  4F20'   F5             C      	PUSH	AF
  4F21'   7B             C      	LD	A,E
  4F22'   BE             C      	CP	(HL)
  4F23'   C2 4FA3'       C      	JP	NZ,RL.ECHO
  4F26'   F1             C      	POP	AF
  4F27'   23             C      	INC	HL
  4F28'   FE 03          C      	CP	003H
'Relativloader fuer O-Dateien'	MACRO-80 3.44	09-Dec-81	PAGE	1-44


  4F2A'   28 03          C      	JR	Z,RL.M14
  4F2C'   B7             C      	OR	A	;NUR H-TEIL DER ADRESSE ?
  4F2D'   20 08          C      	JR	NZ,RL.M15	; JA
  4F2F'                  C      RL.M14:
  4F2F'   72             C      	LD	(HL),D
  4F30'   F5             C      	PUSH	AF
  4F31'   7A             C      	LD	A,D
  4F32'   BE             C      	CP	(HL)
  4F33'   20 6E          C      	JR	NZ,RL.ECHO
  4F35'   F1             C      	POP	AF
  4F36'   23             C      	INC	HL
  4F37'                  C      RL.M15:
  4F37'   CD 4F58'       C      	CALL	RL.UP6
  4F3A'   CB 7A          C      	BIT	7,D	; TEST BEFEHLSKENNZEICHENBYTE
  4F3C'   20 92          C      	JR	NZ,RL.M16
  4F3E'   C3 4FBC'       C      	JP	RL.BF	; NEIN--->FEHLER
                         C      ;----------------------------------------------------------------------
  4F41'                  C      RL.M10:
  4F41'   CD 4F58'       C      	CALL	RL.UP6	;BEI BER-BEFEHL ADDIEREN DER
  4F44'   D5             C      	PUSH	DE	;DEF. BEREICHSLAENGE ZU
  4F45'   CD 4F58'       C      	CALL	RL.UP6	;ADRESSE
  4F48'   7A             C      	LD	A,D
  4F49'   D1             C      	POP	DE
  4F4A'   5F             C      	LD	E,A
  4F4B'   19             C      	ADD	HL,DE
  4F4C'   CD 4F58'       C      	CALL	RL.UP6
  4F4F'   C3 4ED0'       C      	JP	RL.M16
  4F52'                  C      RL.M11:
  4F52'   CD 4F58'       C      	CALL	RL.UP6	;BEI BFL=0 SPRUNG ZUM TEST
  4F55'   C3 4EFE'       C      	JP	RL.M17	;ADRESSKENNZEICHENBYTE
                         C      ;******* UP ZUR ZEICHENWEISE EINGABE DER O-DATEI **********************
  4F58'                  C      RL.UP6:
  4F58'   CD 5D6F'       C      	CALL	UK.GETK
  4F5B'   57             C      	LD	D,A
  4F5C'   0D             C      	DEC	C	;REDUZIEREN BLOCKLAENGE
  4F5D'   C0             C      	RET	NZ		;RET BEI UNGLEICH NULL
  4F5E'   A7             C      	AND	A	;IST NAECHSTE BLOCKLAENGE NULL ?
  4F5F'   28 04          C      	JR	Z,RL.M21	;JA-->VERZWEIGUNG ENDEBEH
  4F61'   4F             C      	LD	C,A	;NEIN-->EINTRAGEN BLKLAENGE
  4F62'   0C             C      	INC	C
  4F63'   18 F3          C      	JR	RL.UP6
                         C      ;*********** ENDEBEHANDLUNG *******************************************
  4F65'                  C      RL.M21:
  4F65'   D1             C      	POP	DE
  4F66'   E5             C      	PUSH	HL
  4F67'   3E 0F          C      	LD	A,15
  4F69'   32 2B00'       C      	LD	(UB.ZN),A
  4F6C'   21 44AD'       C      	LD	HL,UA.ZKEND+3
  4F6F'   11 3460        C      	LD	DE,3460H
  4F72'   01 0010        C      	LD	BC,16
  4F75'   ED B0          C      	LDIR
  4F77'   21 2B00'       C      	LD	HL,UB.ZN
  4F7A'   34             C      	INC	(HL)
  4F7B'   E1             C      	POP	HL
  4F7C'   2B             C      	DEC	HL
  4F7D'   11 3470        C      	LD	DE,3470H	;HINTER AUSSCHRIFT ENDE
  4F80'   CD 5AD4'       C      	CALL	UC.CVHLX
  4F83'   21 44BD'       C      	LD	HL,UA.STADR	;STARTADRESSE ?
  4F86'   CD 56D1'       C      	CALL	UR.MIMO
  4F89'   D8             C      	RET	C
  4F8A'   EB             C      	EX	DE,HL
  4F8B'   21 2B28'       C      	LD	HL,UB.PATAB+2
  4F8E'   CD 5B18'       C      	CALL	UC.CVXA	;STARTADR.-->BINAER
  4F91'   3A 3329        C      	LD	A,(UE.BWSA+329H)
  4F94'   FE 53          C      	CP	'S'
  4F96'   20 04          C      	JR	NZ,$+6
  4F98'   2A 2B28'       C      	LD	HL,(UB.PATAB+2)
  4F9B'   E9             C      	JP	(HL)
  4F9C'   CD 5631'       C      	CALL	UR.KRW
  4F9F'   CD 563B'       C      	CALL	UR.KRA
  4FA2'   C9             C      	RET
                         C      ;---------------------------------------------------------------------
  4FA3'                  C      RL.ECHO:
  4FA3'   D1             C      	POP	DE
  4FA4'   3E 93          C      	LD	A,93H
  4FA6'   18 16          C      	JR	RL.FMELD
  4FA8'                  C      RL.DATNV:
  4FA8'   3E 91          C      	LD	A,91H
  4FAA'   18 12          C      	JR	RL.FMELD
  4FAC'                  C      RL.OB:
  4FAC'   3E 96          C      	LD	A,96H
  4FAE'   18 0E          C      	JR	RL.FMELD
  4FB0'                  C      RL.RA:
'Relativloader fuer O-Dateien'	MACRO-80 3.44	09-Dec-81	PAGE	1-45


  4FB0'   3E 97          C      	LD	A,97H
  4FB2'   18 0A          C      	JR	RL.FMELD
  4FB4'                  C      RL.SV:
  4FB4'   3E 98          C      	LD	A,98H
  4FB6'   18 06          C      	JR	RL.FMELD
  4FB8'                  C      RL.MN:
  4FB8'   3E 99          C      	LD	A,99H
  4FBA'   18 02          C      	JR	RL.FMELD
  4FBC'                  C      RL.BF:
  4FBC'   3E 9A          C      	LD	A,9AH
  4FBE'                  C      RL.FMELD:
  4FBE'   CD 4280'       C      	CALL	UF.ERANZ
  4FC1'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Retten von Maschinencodeprogrammen als MRES - P-Datei'
                         C      	PAGE
'Retten von Maschinencodeprogrammen als MRES - P-Datei'	MACRO-80 3.44	09-Dec-81	PAGE	1-46


                         C      
                         C      ;	PN	SV
                         C      ;**********************************************************************
                         C      ;
                         C      ;      Retten von Maschinencodeprogrammen als MRES - P-Datei
                         C      ;
                         C      ;**********************************************************************
  4FC2'   4FC2'          C      	DW	$
  4FC4'   53 41 56 45    C      	DB	'SAVE'
  4FC8'   3A 3327        C      	LD	A,(UE.BWSA+327H)
  4FCB'   CD 59DA'       C      	CALL	U1.TST
  4FCE'   D8             C      	RET	C
  4FCF'   CD 58FF'       C      	CALL	U1.KTINI
  4FD2'   DD 77 03       C      	LD	(IX+3),A
  4FD5'   AF             C      	XOR	A
  4FD6'   32 2B1D'       C      	LD	(UB.PAR1+1),A
  4FD9'   CD 59C6'       C      	CALL	U1.BILO	;BS LOESCHEN
  4FDC'   CD 5629'       C      	CALL	UR.KRE
  4FDF'   DD CB 00 56    C      	BIT	2,(IX)
  4FE3'   28 05          C      	JR	Z,$+7
  4FE5'   3E 19          C      	LD	A,19H
  4FE7'   CD 4280'       C      	CALL	UF.ERANZ
  4FEA'   CD 5637'       C      	CALL	UR.KRWW
  4FED'                  C      SV.SV20:
  4FED'   CD 58B3'       C      	CALL	U1.DSVG
  4FF0'   C5             C      	PUSH	BC
  4FF1'   79             C      	LD	A,C
  4FF2'   32 2B1C'       C      	LD	(UB.PAR1),A	;NEXT RECORD
  4FF5'   3E 0D          C      	LD	A,13
  4FF7'   32 2B00'       C      	LD	(UB.ZN),A
  4FFA'                  C      SV.DATN:
  4FFA'   21 4471'       C      	LD	HL,UA.ZKDAT	;Dateiname ?
  4FFD'   CD 56D1'       C      	CALL	UR.MIMO
  5000'   D8             C      	RET	C
  5001'   C1             C      	POP	BC
  5002'   05             C      	DEC	B
  5003'   28 1A          C      	JR	Z,SV.SV30	;NEUE KASSETTE
  5005'                  C      SV.SV21:
  5005'   CD 5DCF'       C      	CALL	UK.KBW
  5008'   CD 58E4'       C      	CALL	U1.NMVGL
  500B'   38 04          C      	JR	C,SV.DATV1	;Dateiname bereits vorhanden
  500D'   10 F6          C      	DJNZ	SV.SV21
  500F'   18 0E          C      	JR	SV.SV30
  5011'                  C      SV.DATV1:
  5011'   3E 01          C      	LD	A,01H
  5013'   B8             C      	CP	B
  5014'   CC 515D'       C      	CALL	Z,SV.DALO1
  5017'   28 0E          C      	JR	Z,SV.SV37
  5019'                  C      SV.DATVO:
  5019'   3E 92          C      	LD	A,92H
  501B'   CD 4280'       C      	CALL	UF.ERANZ
  501E'   C9             C      	RET
  501F'                  C      SV.SV30:
  501F'   3E 50          C      	LD	A,'P'
  5021'   32 2B1E'       C      	LD	(UB.PAR2),A
  5024'   CD 5963'       C      	CALL	U1.VZS
  5027'                  C      SV.SV37:
  5027'   3A 2B1D'       C      	LD	A,(UB.PAR1+1)
  502A'   FE 4C          C      	CP	'L'
  502C'   20 0B          C      	JR	NZ,SV.SV31
  502E'   21 44D0'       C      	LD	HL,UA.ZKDL
  5031'   CD 56D1'       C      	CALL	UR.MIMO
  5034'   7E             C      	LD	A,(HL)
  5035'   FE 4A          C      	CP	'J'
  5037'   20 E0          C      	JR	NZ,SV.DATVO
  5039'                  C      SV.SV31:
  5039'   3A 2B1C'       C      	LD	A,(UB.PAR1)	;NEXT RECORD
  503C'   47             C      	LD	B,A
  503D'   C5             C      	PUSH	BC
  503E'   04             C      	INC	B
  503F'   CD 566E'       C      	CALL	UR.POSIK
  5042'   CD 5DCF'       C      	CALL	UK.KBW
  5045'   21 0E66        C      	LD	HL,UE.PUF
  5048'   C1             C      	POP	BC
  5049'   7E             C      	LD	A,(HL)
  504A'   B8             C      	CP	B
  504B'   28 06          C      	JR	Z,SV.SAVE3
  504D'   3E 94          C      	LD	A,94H
  504F'   CD 4280'       C      	CALL	UF.ERANZ
  5052'   C9             C      	RET
  5053'                  C      SV.SAVE3:
  5053'   21 4497'       C      	LD	HL,UA.ZKBEG	;Beginn ?
'Retten von Maschinencodeprogrammen als MRES - P-Datei'	MACRO-80 3.44	09-Dec-81	PAGE	1-47


  5056'   CD 56D1'       C      	CALL	UR.MIMO
  5059'   DA 4FFA'       C      	JP	C,SV.DATN
  505C'   CD 59E4'       C      	CALL	U1.PRADR
  505F'   38 F2          C      	JR	C,SV.SAVE3
  5061'   EB             C      	EX	DE,HL
  5062'   21 2B1E'       C      	LD	HL,UB.PAR2
  5065'   CD 5B18'       C      	CALL	UC.CVXA
  5068'                  C      SV.SAVE4:
  5068'   21 44AA'       C      	LD	HL,UA.ZKEND	;Ende ?
  506B'   CD 56D1'       C      	CALL	UR.MIMO
  506E'   38 E3          C      	JR	C,SV.SAVE3
  5070'   CD 59E4'       C      	CALL	U1.PRADR
  5073'   38 F3          C      	JR	C,SV.SAVE4
  5075'   EB             C      	EX	DE,HL
  5076'   21 2B20'       C      	LD	HL,UB.PAR3
  5079'   CD 5B18'       C      	CALL	UC.CVXA
  507C'   CD 50CC'       C      	CALL	SV.BYANZ
  507F'   38 D2          C      	JR	C,SV.SAVE3
  5081'   28 D0          C      	JR	Z,SV.SAVE3
  5083'   CD 50F1'       C      	CALL	SV.SAVE
  5086'   CD 564D'       C      	CALL	UR.KBM
  5089'   CD 50D7'       C      	CALL	SV.DATS1	;1.DATEISATZ SCHREIBEN
  508C'   CD 5653'       C      	CALL	UR.KSL
  508F'   CD 5637'       C      	CALL	UR.KRWW
  5092'   CD 58B3'       C      	CALL	U1.DSVG
  5095'   05             C      	DEC	B
  5096'   3A 2B1D'       C      	LD	A,(UB.PAR1+1)
  5099'   FE 4C          C      	CP	'L'
  509B'   28 13          C      	JR	Z,SV.SAVE5
  509D'   21 0E67        C      	LD	HL,UE.PUF+1
  50A0'   34             C      	INC	(HL)	;NEXT RECORD+1
  50A1'   21 0E69        C      	LD	HL,UE.PUF+3
  50A4'   46             C      	LD	B,(HL)
  50A5'   34             C      	INC	(HL)	;ANZ.VERZ.EINTR.+1
  50A6'                  C      SV.SAVE6:
  50A6'   CD 565F'       C      	CALL	UR.KBR
  50A9'   DD 36 04 00    C      	LD	(IX+4),00H	;NEUEN DS-SATZ AUSGEBEN
  50AD'   CD 4266'       C      	CALL	UF.EXEC
  50B0'                  C      SV.SAVE5:
  50B0'   CD 5DCF'       C      	CALL	UK.KBW
  50B3'   10 FB          C      	DJNZ	SV.SAVE5
  50B5'   CD 565F'       C      	CALL	UR.KBR
  50B8'   2A 2B24'       C      	LD	HL,(UB.PAR5)
  50BB'   22 0E7F        C      	LD	(UE.PUF+25),HL	;DATEILAENGE EINTRAGEN
  50BE'   DD 36 04 00    C      	LD	(IX+4),00H
  50C2'   CD 4266'       C      	CALL	UF.EXEC
  50C5'   CD 5631'       C      	CALL	UR.KRW
  50C8'   CD 563B'       C      	CALL	UR.KRA
  50CB'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  50CC'                  C      SV.BYANZ:
  50CC'   2A 2B20'       C      	LD	HL,(UB.PAR3)	;Byteanzahl berechnen
  50CF'   ED 5B 2B1E'    C      	LD	DE,(UB.PAR2)
  50D3'   B7             C      	OR	A
  50D4'   ED 52          C      	SBC	HL,DE
  50D6'   C9             C      	RET
  50D7'                  C      SV.DATS1:
  50D7'   21 0020        C      	LD	HL,32	;1. Dateisatz schreiben
  50DA'   CD 5A46'       C      	CALL	XY.STIDX
  50DD'   09             C      	DB	9
  50DE'   CD 58A3'       C      	CALL	U1.VSX
  50E1'   21 0E66        C      	LD	HL,UE.PUF
  50E4'   3A 2B1C'       C      	LD	A,(UB.PAR1)	;NEXT RECORD
  50E7'   3C             C      	INC	A
  50E8'   77             C      	LD	(HL),A
  50E9'   DD 36 04 00    C      	LD	(IX+4),00H
  50ED'   CD 4266'       C      	CALL	UF.EXEC
  50F0'   C9             C      	RET
  50F1'                  C      SV.SAVE:
  50F1'   21 0000        C      	LD	HL,0
  50F4'   CD 5A36'       C      	CALL	XY.STDX
  50F7'   11             C      	DB	17
  50F8'   21 0080        C      	LD	HL,80H	;Blocklaenge
  50FB'   CD 5A46'       C      	CALL	XY.STIDX
  50FE'   09             C      	DB	9
  50FF'   CD 5E38'       C      	CALL	UK.KSPFB	;Pufferbereitstellung
  5102'                  C      SV.SAVE1:
  5102'   CD 50CC'       C      	CALL	SV.BYANZ	;Byteanzahl berechnen
  5105'   23             C      	INC	HL
  5106'   E5             C      	PUSH	HL
  5107'   7C             C      	LD	A,H
  5108'   B5             C      	OR	L
  5109'   E1             C      	POP	HL
'Retten von Maschinencodeprogrammen als MRES - P-Datei'	MACRO-80 3.44	09-Dec-81	PAGE	1-48


  510A'   28 13          C      	JR	Z,SV.SVLS2	;---> 0 Byte
  510C'   01 007D        C      	LD	BC,UE.SVL	;Satzlaenge
  510F'   B7             C      	OR	A
  5110'   ED 42          C      	SBC	HL,BC
  5112'   38 05          C      	JR	C,SV.SVLS	;---> letzter Satz
  5114'   CD 5168'       C      	CALL	SV.SVSZ
  5117'   18 E9          C      	JR	SV.SAVE1
  5119'                  C      SV.SVLS:
  5119'   7D             C      	LD	A,L
  511A'   C6 7D          C      	ADD	A,UE.SVL	;A:= Laenge des letzten Satzes
  511C'   CD 516A'       C      	CALL	SV.SVSZ2
  511F'                  C      SV.SVLS2:
  511F'   AF             C      	XOR	A
  5120'   CD 5E14'       C      	CALL	UK.PUTK
  5123'   21 44BD'       C      	LD	HL,UA.STADR	;Startadresse
  5126'   CD 56D1'       C      	CALL	UR.MIMO
  5129'   7E             C      	LD	A,(HL)
  512A'   FE 20          C      	CP	' '
  512C'   28 27          C      	JR	Z,SV.STAD0	;KEINE EINGABE (0000)
  512E'   EB             C      	EX	DE,HL
  512F'   21 2B22'       C      	LD	HL,UB.PAR4
  5132'   CD 5B18'       C      	CALL	UC.CVXA
  5135'                  C      SV.SVLS1:
  5135'   2A 2B22'       C      	LD	HL,(UB.PAR4)
  5138'   7C             C      	LD	A,H	;Startadresse ausgeben
  5139'   CD 5E14'       C      	CALL	UK.PUTK
  513C'   7D             C      	LD	A,L
  513D'   CD 5E14'       C      	CALL	UK.PUTK
  5140'   0E 03          C      	LD	C,3
  5142'                  C      SV.SVEN2:
  5142'   06 80          C      	LD	B,80H
  5144'   AF             C      	XOR	A
  5145'                  C      SV.SVEN1:
  5145'   CD 5E14'       C      	CALL	UK.PUTK
  5148'   10 FB          C      	DJNZ	SV.SVEN1
  514A'   0D             C      	DEC	C
  514B'   20 F5          C      	JR	NZ,SV.SVEN2
  514D'   CD 5A16'       C      	CALL	XY.LDDX
  5150'   11             C      	DB	17
  5151'   22 2B24'       C      	LD	(UB.PAR5),HL
  5154'   C9             C      	RET
  5155'                  C      SV.STAD0:
  5155'   21 0000        C      	LD	HL,0
  5158'   22 2B22'       C      	LD	(UB.PAR4),HL
  515B'   18 D8          C      	JR	SV.SVLS1
  515D'                  C      SV.DALO1:
  515D'   F5             C      	PUSH	AF
  515E'   21 2B1C'       C      	LD	HL,UB.PAR1
  5161'   35             C      	DEC	(HL)
  5162'   23             C      	INC	HL
  5163'   3E 4C          C      	LD	A,'L'
  5165'   77             C      	LD	(HL),A
  5166'   F1             C      	POP	AF
  5167'   C9             C      	RET
  5168'                  C      SV.SVSZ:
  5168'   3E 7D          C      	LD	A,UE.SVL
  516A'                  C      SV.SVSZ2:
  516A'   F5             C      	PUSH	AF
  516B'   CD 5E14'       C      	CALL	UK.PUTK
  516E'   ED 5B 2B1E'    C      	LD	DE,(UB.PAR2)
  5172'   7A             C      	LD	A,D
  5173'   CD 5E14'       C      	CALL	UK.PUTK
  5176'   7B             C      	LD	A,E
  5177'   CD 5E14'       C      	CALL	UK.PUTK
  517A'   F1             C      	POP	AF
  517B'   47             C      	LD	B,A
  517C'                  C      SV.SVSZ1:
  517C'   1A             C      	LD	A,(DE)
  517D'   CD 5E14'       C      	CALL	UK.PUTK
  5180'   13             C      	INC	DE
  5181'   10 F9          C      	DJNZ	SV.SVSZ1
  5183'   ED 53 2B1E'    C      	LD	(UB.PAR2),DE
  5187'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                                ;	
                                ;	INCLUDE	KX.ASM	;Kopieren von MRES-Kassetten Teil 1
                                ;	INCLUDE	KY.ASM	;Kopieren von MRES-Kassetten Teil 2
                                ;	INCLUDE	KU.ASM	;Unterprogramme fuer KOPI
                         C      	INCLUDE K6.ASM	;Kopieren MRES
                         C      	TITLE	'Kopieren von MRES-Kassetten Teil 1'
                         C      	PAGE
'Kopieren von MRES-Kassetten Teil 1'	MACRO-80 3.44	09-Dec-81	PAGE	1-49


                         C      
                         C      ;	PN	KX
                         C      ;------------------------------------------------------------------
                         C      ;
                         C      ;          KOPIEREN VON MRES-KASSETTEN       TEIL1
                         C      ;
                         C      ;----------------------------------------------------------------
  5188'   5188'          C      	DW	$
  518A'   4B 4F 50 49    C      	DB	'KOPI'
  518E'   CD 58FF'       C      	CALL	U1.KTINI
  5191'   11 E000        C      	LD	DE,BC.TAB1
  5194'   21 3327        C      	LD	HL,UE.BWSA+327H
  5197'   7E             C      	LD	A,(HL)
  5198'   CD 59DA'       C      	CALL	U1.TST
  519B'   D8             C      	RET	C
  519C'   12             C      	LD	(DE),A
  519D'   23             C      	INC	HL
  519E'   EE 33          C      	XOR	33H
  51A0'   BE             C      	CP	(HL)
  51A1'   C0             C      	RET	NZ
  51A2'   EE 30          C      	XOR	30H
  51A4'   13             C      	INC	DE
  51A5'   12             C      	LD	(DE),A
  51A6'   3A 3326        C      	LD	A,(UE.BWSA+326H)
  51A9'   FE 4A          C      	CP	'J'
  51AB'   28 05          C      	JR	Z,$+7	;BEI KOPIJ WERDEN WEITERE PARAMETER
  51AD'   23             C      	INC	HL	;IGNORIERT
  51AE'   23             C      	INC	HL
  51AF'   7E             C      	LD	A,(HL)
  51B0'   FE 20          C      	CP	20H
  51B2'   F5             C      	PUSH	AF
  51B3'   20 0C          C      	JR	NZ,$+14
  51B5'   CD 588A'       C      	CALL	U1.EIN
  51B8'   CD 59FB'       C      	CALL	U1.KRWE
  51BB'   CD 5893'       C      	CALL	U1.AUS
  51BE'   CD 59FB'       C      	CALL	U1.KRWE
  51C1'   CD 52FC'       C      	CALL	KX.UPA
  51C4'   F1             C      	POP	AF
  51C5'   28 13          C      	JR	Z,$+21
  51C7'   FE 41          C      	CP	'A'
  51C9'   28 0A          C      	JR	Z,$+12
  51CB'   FE 4C          C      	CP	'L'
  51CD'   20 0B          C      	JR	NZ,$+13
  51CF'   CD 5861'       C      	CALL	U1.COPB
  51D2'   C3 52A2'       C      	JP	KX.RSPFR
  51D5'   CD 585D'       C      	CALL	U1.COPB2
  51D8'   18 FB          C      	JR	$-3
                         C      ;-------------------------------------------------------------------
  51DA'   CD 588A'       C      	CALL	U1.EIN
  51DD'   CD 58B3'       C      	CALL	U1.DSVG
  51E0'   CD 583C'       C      	CALL	U1.KBR4
  51E3'   CD 5847'       C      	CALL	U1.BREAD
  51E6'   21 4383'       C      	LD	HL,UA.Z7E
  51E9'   11 3163        C      	LD	DE,3163H
  51EC'   01 001F        C      	LD	BC,31
  51EF'   ED B0          C      	LDIR
  51F1'   21 43A2'       C      	LD	HL,UA.GER
  51F4'   11 31EA        C      	LD	DE,31EAH
  51F7'   CD 59C0'       C      	CALL	U1.INFO
  51FA'   21 434D'       C      	LD	HL,UA.KNAME+3
  51FD'   11 323A        C      	LD	DE,323AH
  5200'   CD 59C0'       C      	CALL	U1.INFO
  5203'   21 4360'       C      	LD	HL,UA.NR+3
  5206'   11 328A        C      	LD	DE,328AH
  5209'   CD 59C0'       C      	CALL	U1.INFO
  520C'   21 4373'       C      	LD	HL,UA.KOMMT+3
  520F'   11 32DA        C      	LD	DE,32DAH
  5212'   CD 59C0'       C      	CALL	U1.INFO
  5215'   11 3203        C      	LD	DE,3203H
  5218'   3A E000        C      	LD	A,(BC.TAB1)
  521B'   CD 5ABA'       C      	CALL	UC.CVBX+2
  521E'   11 321B        C      	LD	DE,321BH
  5221'   3A E001        C      	LD	A,(BC.TAB1+1)
  5224'   CD 5ABA'       C      	CALL	UC.CVBX+2
  5227'   21 0E6A        C      	LD	HL,UE.PUF+4
  522A'   11 3253        C      	LD	DE,3253H
  522D'   06 06          C      	LD	B,6
  522F'   CD 5BC3'       C      	CALL	UC.DKONV
  5232'   21 0E8B        C      	LD	HL,UE.PUF+37
  5235'   11 32A3        C      	LD	DE,32A3H
  5238'   06 03          C      	LD	B,3
  523A'   CD 5BC3'       C      	CALL	UC.DKONV
'Kopieren von MRES-Kassetten Teil 1'	MACRO-80 3.44	09-Dec-81	PAGE	1-50


  523D'   11 32F3        C      	LD	DE,32F3H
  5240'   06 0B          C      	LD	B,11
  5242'   CD 5BC3'       C      	CALL	UC.DKONV
  5245'   CD 5659'       C      	CALL	UR.KBV
  5248'   CD 5659'       C      	CALL	UR.KBV
  524B'   CD 5847'       C      	CALL	U1.BREAD
  524E'   3A 0E69        C      	LD	A,(UE.PUF+3)
  5251'   3D             C      	DEC	A
  5252'   CA 52AD'       C      	JP	Z,KX.ENDR
  5255'   CD 592D'       C      	CALL	U1.VERIN
  5258'   CD 5893'       C      	CALL	U1.AUS
  525B'   CD 58B3'       C      	CALL	U1.DSVG
  525E'   CD 583C'       C      	CALL	U1.KBR4
  5261'   DD 36 04 02    C      	LD	(IX+4),02H
  5265'   CD 4266'       C      	CALL	UF.EXEC
  5268'   21 0E6A        C      	LD	HL,UE.PUF+4
  526B'   11 326B        C      	LD	DE,326BH
  526E'   06 06          C      	LD	B,6
  5270'   CD 5BC3'       C      	CALL	UC.DKONV
  5273'   21 0E8B        C      	LD	HL,UE.PUF+37
  5276'   11 32BB        C      	LD	DE,32BBH
  5279'   06 03          C      	LD	B,3
  527B'   CD 5BC3'       C      	CALL	UC.DKONV
  527E'   11 330B        C      	LD	DE,330BH
  5281'   06 0B          C      	LD	B,11
  5283'   CD 5BC3'       C      	CALL	UC.DKONV
  5286'   CD 5659'       C      	CALL	UR.KBV
  5289'   CD 5659'       C      	CALL	UR.KBV
  528C'   DD 36 04 02    C      	LD	(IX+4),02H
  5290'   CD 4266'       C      	CALL	UF.EXEC
  5293'   CD 59C6'       C      	CALL	U1.BILO
  5296'   11 E002        C      	LD	DE,BC.VTABA
  5299'   CD 5935'       C      	CALL	U1.VERNI
  529C'   CD 594F'       C      	CALL	U1.VORST
  529F'   C3 5319'       C      	JP	KY.MD
  52A2'                  C      KX.RSPFR:
  52A2'   F5             C      	PUSH	AF
  52A3'   23             C      	INC	HL
  52A4'   23             C      	INC	HL
  52A5'   7E             C      	LD	A,(HL)
  52A6'   B7             C      	OR	A
  52A7'   FE 52          C      	CP	'R'
  52A9'   20 06          C      	JR	NZ,$+8
  52AB'   18 01          C      	JR	$+3
  52AD'                  C      KX.ENDR:
  52AD'   F5             C      	PUSH	AF
  52AE'   37             C      	SCF
  52AF'   18 04          C      	JR	$+6
  52B1'   FE 46          C      	CP	'F'
  52B3'   20 15          C      	JR	NZ,$+23
  52B5'   CD 588A'       C      	CALL	U1.EIN
  52B8'   DC 5631'       C      	CALL	C,UR.KRW
  52BB'   CD 563B'       C      	CALL	UR.KRA
  52BE'   CD 5893'       C      	CALL	U1.AUS
  52C1'   CD 5629'       C      	CALL	UR.KRE
  52C4'   DC 5637'       C      	CALL	C,UR.KRWW
  52C7'   CD 563B'       C      	CALL	UR.KRA
  52CA'   F1             C      	POP	AF
  52CB'   C9             C      	RET
  52CC'                  C      KX.EXEC2:
  52CC'   F5             C      	PUSH	AF
  52CD'   DD CB 00 BE    C      	RES	7,(IX)
  52D1'   DD 36 01 00    C      	LD	(IX+1),0
  52D5'   CD 41D3'       C      	CALL	KR.KARO
  52D8'   DD CB 00 7E    C      	BIT	7,(IX)
  52DC'   28 0A          C      	JR	Z,$+12
  52DE'   DD 7E 01       C      	LD	A,(IX+1)
  52E1'   FE 14          C      	CP	14H
  52E3'   28 05          C      	JR	Z,$+7
  52E5'   CD 4280'       C      	CALL	UF.ERANZ
  52E8'   F1             C      	POP	AF
  52E9'   C9             C      	RET
  52EA'   DD CB 00 BE    C      	RES	7,(IX)
  52EE'   CD 5893'       C      	CALL	U1.AUS
  52F1'   CD 5653'       C      	CALL	UR.KSL
  52F4'   F1             C      	POP	AF
  52F5'   06 06          C      	LD	B,6
  52F7'   33             C      	INC	SP
  52F8'   10 FD          C      	DJNZ	$-1	;STACK BERICHTIGEN
  52FA'   18 A6          C      	JR	KX.RSPFR
  52FC'                  C      KX.UPA:
  52FC'   CD 588A'       C      	CALL	U1.EIN
  52FF'   CD 5629'       C      	CALL	UR.KRE
'Kopieren von MRES-Kassetten Teil 1'	MACRO-80 3.44	09-Dec-81	PAGE	1-51


  5302'   DD 36 00 00    C      	LD	(IX+0),0
  5306'   CD 5893'       C      	CALL	U1.AUS
  5309'   CD 5629'       C      	CALL	UR.KRE
  530C'   DD CB 00 56    C      	BIT	2,(IX)
  5310'   28 05          C      	JR	Z,$+7
  5312'   D1             C      	POP	DE
  5313'   3E 19          C      	LD	A,19H
  5315'   CD 4280'       C      	CALL	UF.ERANZ
  5318'   C9             C      	RET
                         C      ;	END
                         C      	TITLE	'Kopieren von MRES-Kassetten Teil 2'
                         C      	PAGE
'Kopieren von MRES-Kassetten Teil 2'	MACRO-80 3.44	09-Dec-81	PAGE	1-52


                         C      
                         C      ;	PN	KY
                         C      ;---------------------------------------------------------------------
                         C      ;
                         C      ;          KOPIEREN VON MRES-KASSETTEN           TEIL 2
                         C      ;
                         C      ;--------------------------------------------------------------------
  5319'                  C      KY.MD:
  5319'   CD 59C6'       C      	CALL	U1.BILO
  531C'   21 43B1'       C      	LD	HL,UA.KOPFR
  531F'   CD 5572'       C      	CALL	KY.SATR
  5322'   3E 0D          C      	LD	A,13
  5324'   32 2B00'       C      	LD	(UB.ZN),A
  5327'   21 ECA2        C      	LD	HL,BC.VTABE+32
  532A'   FD 21 F902     C      	LD	IY,BC.TAB2
  532E'   FD 36 00 FF    C      	LD	(IY+0),0FFH
  5332'   3A EC85        C      	LD	A,(BC.VTABE+3)
  5335'   47             C      	LD	B,A
  5336'   05             C      	DEC	B
                         C      ;--------------------------------ABFRAGEZYKLUS------------------------
  5337'                  C      KY.DFR:
  5337'   C5             C      	PUSH	BC
  5338'   11 2B44'       C      	LD	DE,UB.SATZ+26
  533B'   01 0006        C      	LD	BC,6
  533E'   ED B0          C      	LDIR
  5340'   13             C      	INC	DE
  5341'   13             C      	INC	DE
  5342'   01 0002        C      	LD	BC,2
  5345'   ED B0          C      	LDIR
  5347'   01 0018        C      	LD	BC,24
  534A'   09             C      	ADD	HL,BC
  534B'   E5             C      	PUSH	HL
  534C'   21 2B2A'       C      	LD	HL,UB.SATZ
  534F'   CD 56D1'       C      	CALL	UR.MIMO
  5352'   DC 55CE'       C      	CALL	C,KU.ZEIR
  5355'   CD 5569'       C      	CALL	KY.JHL	;BEI KOPIJ WIRD J GESETZT
  5358'   7E             C      	LD	A,(HL)
  5359'   FE 4A          C      	CP	'J'
  535B'   C4 5596'       C      	CALL	NZ,KU.TAB2L
  535E'   E1             C      	POP	HL
  535F'   01 0009        C      	LD	BC,9
  5362'   B7             C      	OR	A
  5363'   ED 42          C      	SBC	HL,BC
  5365'   7E             C      	LD	A,(HL)
  5366'   FD 77 00       C      	LD	(IY+0),A
  5369'   FD 23          C      	INC	IY
  536B'   FD 36 00 FF    C      	LD	(IY+0),0FFH
  536F'   09             C      	ADD	HL,BC
  5370'   3A E005        C      	LD	A,(BC.VTABA+3)
  5373'   FE 01          C      	CP	01H
  5375'   28 2E          C      	JR	Z,KY.EZYK1
  5377'   E5             C      	PUSH	HL
  5378'   01 0020        C      	LD	BC,32
  537B'   B7             C      	OR	A
  537C'   ED 42          C      	SBC	HL,BC
  537E'   EB             C      	EX	DE,HL
  537F'   E1             C      	POP	HL
  5380'   DD 21 E002     C      	LD	IX,BC.VTABA
  5384'   47             C      	LD	B,A
  5385'   05             C      	DEC	B
  5386'                  C      KY.VZVGL:
  5386'   C5             C      	PUSH	BC
  5387'   01 0020        C      	LD	BC,32
  538A'   DD 09          C      	ADD	IX,BC
  538C'   DD E5          C      	PUSH	IX
  538E'   06 07          C      	LD	B,7
  5390'   D5             C      	PUSH	DE
  5391'                  C      KY.SVGL:
  5391'   1A             C      	LD	A,(DE)
  5392'   DD BE 00       C      	CP	(IX+0)
  5395'   20 08          C      	JR	NZ,KY.NDA
  5397'   DD 23          C      	INC	IX
  5399'   13             C      	INC	DE
  539A'   10 F5          C      	DJNZ	KY.SVGL
  539C'   CD 55FE'       C      	CALL	KU.DD	;DATEI SCHON VORHANDEN
  539F'                  C      KY.NDA:
  539F'   D1             C      	POP	DE
  53A0'   DD E1          C      	POP	IX
  53A2'   C1             C      	POP	BC
  53A3'   10 E1          C      	DJNZ	KY.VZVGL
  53A5'                  C      KY.EZYK1:
  53A5'   C1             C      	POP	BC
'Kopieren von MRES-Kassetten Teil 2'	MACRO-80 3.44	09-Dec-81	PAGE	1-53


  53A6'   10 8F          C      	DJNZ	KY.DFR
                         C      ;---------------------------------------------------------------------
  53A8'                  C      KY.ATAA:
  53A8'   06 03          C      	LD	B,3	;WARTESCHLEIFE FUER
  53AA'   21 FFFF        C      	LD	HL,0FFFFH
  53AD'   2B             C      	DEC	HL
  53AE'   7C             C      	LD	A,H
  53AF'   B5             C      	OR	L
  53B0'   20 FB          C      	JR	NZ,$-3
  53B2'   10 F6          C      	DJNZ	$-8
  53B4'   21 43E7'       C      	LD	HL,UA.EABFR
  53B7'   CD 5572'       C      	CALL	KY.SATR
  53BA'   21 2B2A'       C      	LD	HL,UB.SATZ
  53BD'   CD 56D1'       C      	CALL	UR.MIMO
  53C0'   38 F8          C      	JR	C,$-6
  53C2'   CD 5569'       C      	CALL	KY.JHL
  53C5'   7E             C      	LD	A,(HL)
  53C6'   FE 4A          C      	CP	'J'
  53C8'   C2 5319'       C      	JP	NZ,KY.MD
                         C      ;--------------------------------Labelnummern fuer Ausgabe ---------
  53CB'                  C      KY.ATAB:
  53CB'   06 00          C      	LD	B,0
  53CD'   21 F902        C      	LD	HL,BC.TAB2
  53D0'   11 F9D2        C      	LD	DE,BC.TAB3
  53D3'   7E             C      	LD	A,(HL)
  53D4'   FE FF          C      	CP	0FFH	;KEINE DATEI KOPIEREN
  53D6'   CA 52AD'       C      	JP	Z,KX.ENDR
  53D9'   3A E003        C      	LD	A,(BC.VTABA+1)
  53DC'                  C      KY.ATABE:
  53DC'   12             C      	LD	(DE),A
  53DD'   23             C      	INC	HL
  53DE'   13             C      	INC	DE
  53DF'   04             C      	INC	B
  53E0'   F5             C      	PUSH	AF
  53E1'   7E             C      	LD	A,(HL)
  53E2'   FE FF          C      	CP	0FFH
  53E4'   28 04          C      	JR	Z,KY.WEI
  53E6'   F1             C      	POP	AF
  53E7'   3C             C      	INC	A
  53E8'   18 F2          C      	JR	KY.ATABE
                         C      ;------------------------------TAB:NR DER VERZ.EINTRAGUNGEN (EING.)------
  53EA'                  C      KY.WEI:
  53EA'   F1             C      	POP	AF
  53EB'   C5             C      	PUSH	BC
  53EC'   AF             C      	XOR	A
  53ED'   57             C      	LD	D,A
  53EE'   3A EC85        C      	LD	A,(BC.VTABE+3)
  53F1'   47             C      	LD	B,A
  53F2'   05             C      	DEC	B
  53F3'   21 F902        C      	LD	HL,BC.TAB2
  53F6'   FD 21 F96A     C      	LD	IY,BC.TAB2A
  53FA'   DD 21 ECA2     C      	LD	IX,BC.VTABE+32
  53FE'                  C      KY.ZYK:
  53FE'   14             C      	INC	D
  53FF'   7E             C      	LD	A,(HL)
  5400'   DD BE 17       C      	CP	(IX+23)
  5403'   20 0B          C      	JR	NZ,KY.NE
  5405'   7A             C      	LD	A,D
  5406'   FD 77 00       C      	LD	(IY+0),A
  5409'   FD 36 01 FF    C      	LD	(IY+1),0FFH
  540D'   23             C      	INC	HL
  540E'   FD 23          C      	INC	IY
  5410'                  C      KY.NE:
  5410'   C5             C      	PUSH	BC
  5411'   01 0020        C      	LD	BC,32
  5414'   DD 09          C      	ADD	IX,BC
  5416'   C1             C      	POP	BC
  5417'   10 E5          C      	DJNZ	KY.ZYK
                         C      ;------------------------------------AUFBAU AUSGABEVERZ.-----
  5419'   3A E005        C      	LD	A,(BC.VTABA+3)
  541C'   47             C      	LD	B,A
  541D'   FE 01          C      	CP	01H
  541F'   28 08          C      	JR	Z,KY.EVZ
  5421'   21 E002        C      	LD	HL,BC.VTABA
  5424'   CD 558D'       C      	CALL	KU.VVOR
  5427'   18 03          C      	JR	KY.EVZ1
  5429'                  C      KY.EVZ:
  5429'   21 E022        C      	LD	HL,BC.VTABA+32
  542C'                  C      KY.EVZ1:
  542C'   DD 21 F96A     C      	LD	IX,BC.TAB2A
  5430'   FD 21 F9D2     C      	LD	IY,BC.TAB3
  5434'   EB             C      	EX	DE,HL
  5435'   21 ECA2        C      	LD	HL,BC.VTABE+32
'Kopieren von MRES-Kassetten Teil 2'	MACRO-80 3.44	09-Dec-81	PAGE	1-54


  5438'   DD 7E 00       C      	LD	A,(IX+0)
  543B'   FE 01          C      	CP	01H
  543D'   28 05          C      	JR	Z,KY.VSTR
  543F'   3D             C      	DEC	A
  5440'   47             C      	LD	B,A
  5441'   CD 558D'       C      	CALL	KU.VVOR
  5444'                  C      KY.VSTR:
  5444'   01 0020        C      	LD	BC,32
  5447'   ED B0          C      	LDIR
  5449'   FD 7E 00       C      	LD	A,(IY+0)
  544C'   EB             C      	EX	DE,HL
  544D'   01 0009        C      	LD	BC,9
  5450'   B7             C      	OR	A
  5451'   ED 42          C      	SBC	HL,BC
  5453'   77             C      	LD	(HL),A
  5454'   09             C      	ADD	HL,BC
  5455'   EB             C      	EX	DE,HL
  5456'   DD 7E 01       C      	LD	A,(IX+1)
  5459'   FE FF          C      	CP	0FFH
  545B'   28 10          C      	JR	Z,KY.COPY
  545D'   DD 96 00       C      	SUB	(IX+0)
  5460'   3D             C      	DEC	A
  5461'   47             C      	LD	B,A
  5462'   FE 00          C      	CP	00H
  5464'   C4 558D'       C      	CALL	NZ,KU.VVOR
  5467'   FD 23          C      	INC	IY
  5469'   DD 23          C      	INC	IX
  546B'   18 D7          C      	JR	KY.VSTR
                         C      ;------------------------------------VERZ.SCHREIBEN (NUR NEUE SAETZE)---
  546D'                  C      KY.COPY:
  546D'   DD 21 2B01'    C      	LD	IX,UB.KTAB
  5471'   CD 5918'       C      	CALL	U1.KTIN1
  5474'   DD 36 0A 20    C      	LD	(IX+10),20H
  5478'   CD 5893'       C      	CALL	U1.AUS
  547B'   3A E005        C      	LD	A,(BC.VTABA+3)
  547E'   47             C      	LD	B,A
  547F'   CD 5659'       C      	CALL	UR.KBV	;AUSGABEKASSETTE
  5482'   3D             C      	DEC	A
  5483'   20 FA          C      	JR	NZ,$-4	;VORSTELLEN BIS HINTER LETZTEN ALTEN
  5485'   21 E002        C      	LD	HL,BC.VTABA	;VERZ.SATZ
  5488'   11 0020        C      	LD	DE,32
  548B'   19             C      	ADD	HL,DE
  548C'   10 FA          C      	DJNZ	$-4	;AUSGABEVERZ.ZEIGER
  548E'   C1             C      	POP	BC
  548F'   78             C      	LD	A,B
  5490'   F5             C      	PUSH	AF
  5491'                  C      KY.VSCHR:
  5491'   11 0E66        C      	LD	DE,UE.PUF
  5494'   01 0020        C      	LD	BC,32
  5497'   ED B0          C      	LDIR
  5499'   CD 5659'       C      	CALL	UR.KBV
  549C'   CD 565F'       C      	CALL	UR.KBR
  549F'   DD 36 05 08    C      	LD	(IX+5),08H
  54A3'   CD 4266'       C      	CALL	UF.EXEC
  54A6'   3D             C      	DEC	A
  54A7'   20 E8          C      	JR	NZ,KY.VSCHR
                         C      ;----------------------------------------------------------------
  54A9'   11 33FA        C      	LD	DE,33FAH	;''ES WIRD KOPIERT''
  54AC'   21 5559'       C      	LD	HL,KY.EWK
  54AF'   01 0010        C      	LD	BC,16
  54B2'   ED B0          C      	LDIR
                         C      ;------------------------------KOPIEREN--------------------------
  54B4'   21 F902        C      	LD	HL,BC.TAB2
  54B7'   11 F9D2        C      	LD	DE,BC.TAB3
  54BA'   FD 21 F96A     C      	LD	IY,BC.TAB2A
  54BE'   1A             C      	LD	A,(DE)
  54BF'   47             C      	LD	B,A
  54C0'   04             C      	INC	B
  54C1'   CD 566E'       C      	CALL	UR.POSIK
  54C4'   7E             C      	LD	A,(HL)
  54C5'   47             C      	LD	B,A
  54C6'   04             C      	INC	B
  54C7'                  C      KY.KOPV:
  54C7'   CD 588A'       C      	CALL	U1.EIN
  54CA'   CD 566E'       C      	CALL	UR.POSIK
  54CD'                  C      KY.KOP:
  54CD'   CD 5847'       C      	CALL	U1.BREAD
  54D0'   7E             C      	LD	A,(HL)
  54D1'   FE 01          C      	CP	01H
  54D3'   CC 58A3'       C      	CALL	Z,U1.VSX
                         C      ;------------------------ANZEIGE WELCHE DATEI KOPIERT WIRD-------------
  54D6'   E5             C      	PUSH	HL
  54D7'   D5             C      	PUSH	DE
'Kopieren von MRES-Kassetten Teil 2'	MACRO-80 3.44	09-Dec-81	PAGE	1-55


  54D8'   FD 7E 00       C      	LD	A,(IY+0)
  54DB'   47             C      	LD	B,A
  54DC'   05             C      	DEC	B
  54DD'   21 ECA2        C      	LD	HL,BC.VTABE+32
  54E0'   FE 01          C      	CP	01H
  54E2'   28 03          C      	JR	Z,KY.KOPAN
  54E4'   CD 558D'       C      	CALL	KU.VVOR
  54E7'                  C      KY.KOPAN:
  54E7'   11 34F0        C      	LD	DE,34F0H
  54EA'   01 0006        C      	LD	BC,6
  54ED'   ED B0          C      	LDIR
  54EF'   13             C      	INC	DE
  54F0'   13             C      	INC	DE
  54F1'   01 0002        C      	LD	BC,2
  54F4'   ED B0          C      	LDIR
  54F6'   FD 23          C      	INC	IY
  54F8'   D1             C      	POP	DE
  54F9'   E1             C      	POP	HL
                         C      ;--------------------------------------------------------------------
  54FA'   1A             C      	LD	A,(DE)
  54FB'   FE 01          C      	CP	01H
  54FD'   CC 589C'       C      	CALL	Z,U1.VS1
  5500'   32 0E66        C      	LD	(UE.PUF),A
  5503'   CD 5852'       C      	CALL	U1.BWRIT
  5506'   CD 5861'       C      	CALL	U1.COPB
  5509'   23             C      	INC	HL
  550A'   7E             C      	LD	A,(HL)
  550B'   FE FF          C      	CP	0FFH
  550D'   28 0B          C      	JR	Z,KY.EOV
  550F'   2B             C      	DEC	HL
  5510'   96             C      	SUB	(HL)
  5511'   23             C      	INC	HL
  5512'   13             C      	INC	DE
  5513'   47             C      	LD	B,A
  5514'   FE 01          C      	CP	01H
  5516'   20 AF          C      	JR	NZ,KY.KOPV
  5518'   18 B3          C      	JR	KY.KOP
                         C      ;-------------------------------------------------------------
  551A'                  C      KY.EOV:
  551A'   CD 58A3'       C      	CALL	U1.VSX
  551D'   3A E003        C      	LD	A,(BC.VTABA+1)
  5520'   47             C      	LD	B,A
  5521'   F1             C      	POP	AF
  5522'   F5             C      	PUSH	AF
  5523'   80             C      	ADD	A,B
  5524'   32 0E66        C      	LD	(UE.PUF),A
  5527'   CD 5918'       C      	CALL	U1.KTIN1
  552A'   DD 36 0A 20    C      	LD	(IX+10),20H
  552E'   CD 5852'       C      	CALL	U1.BWRIT
  5531'   CD 5653'       C      	CALL	UR.KSL
  5534'   CD 52AD'       C      	CALL	KX.ENDR
  5537'   CD 5629'       C      	CALL	UR.KRE
  553A'   CD 58B3'       C      	CALL	U1.DSVG
  553D'   F1             C      	POP	AF
  553E'   F5             C      	PUSH	AF
  553F'   81             C      	ADD	A,C	;NEXT RECORD UND
  5540'   32 0E67        C      	LD	(UE.PUF+1),A
  5543'   F1             C      	POP	AF
  5544'   80             C      	ADD	A,B	;ANZAHL VERZ.EINTR. KORRIGIEREN
  5545'   32 0E69        C      	LD	(UE.PUF+3),A
  5548'   CD 565F'       C      	CALL	UR.KBR
  554B'   DD 36 04 08    C      	LD	(IX+4),08H
  554F'   CD 4266'       C      	CALL	UF.EXEC	;NEUEN DS-SATZ SCHREIBEN
  5552'   CD 5631'       C      	CALL	UR.KRW
  5555'   CD 563B'       C      	CALL	UR.KRA
  5558'   C9             C      	RET
                         C      ;---------------------------------------------------------------
  5559'                  C      KY.EWK:
  5559'   45 73 20 77    C      	DB	'Es wird kopiert:'
  555D'   69 72 64 20    C      
  5561'   6B 6F 70 69    C      
  5565'   65 72 74 3A    C      
                         C      ;---------------------------------------------------------------
  5569'                  C      KY.JHL:
  5569'   3A 2B1E'       C      	LD	A,(UB.PAR2)
  556C'   FE 4A          C      	CP	'J'
  556E'   20 01          C      	JR	NZ,$+3
  5570'   77             C      	LD	(HL),A
  5571'   C9             C      	RET
                         C      ;--------------------------------------------------------------
  5572'                  C      KY.SATR:
  5572'   11 2B2A'       C      	LD	DE,UB.SATZ
  5575'   01 0036        C      	LD	BC,54
'Kopieren von MRES-Kassetten Teil 2'	MACRO-80 3.44	09-Dec-81	PAGE	1-56


  5578'   ED B0          C      	LDIR
  557A'   3A 3326        C      	LD	A,(UE.BWSA+326H)
  557D'   FE 4A          C      	CP	'J'
  557F'   CC 5586'       C      	CALL	Z,KY.AJ
  5582'   32 2B1E'       C      	LD	(UB.PAR2),A
  5585'   C9             C      	RET
  5586'                  C      KY.AJ:
  5586'   F5             C      	PUSH	AF
  5587'   AF             C      	XOR	A
  5588'   32 2B2A'       C      	LD	(UB.SATZ),A
  558B'   F1             C      	POP	AF
  558C'   C9             C      	RET
                         C      ;--------------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Unterprogramme fuer KOPI'
                         C      	PAGE
'Unterprogramme fuer KOPI'	MACRO-80 3.44	09-Dec-81	PAGE	1-57


                         C      
                         C      ;	PN	KU
                         C      ;------------------------------------------------------------------
                         C      ;
                         C      ;          UNTERPROGRAMME FUER KOPI
                         C      ;
                         C      ;--------------------------------------------------------
  558D'                  C      KU.VVOR:
  558D'   C5             C      	PUSH	BC
  558E'   01 0020        C      	LD	BC,32
  5591'   09             C      	ADD	HL,BC
  5592'   C1             C      	POP	BC
  5593'   10 F8          C      	DJNZ	KU.VVOR
  5595'   C9             C      	RET
  5596'                  C      KU.TAB2L:
  5596'   D1             C      	POP	DE
  5597'   E1             C      	POP	HL
  5598'   FD 7E 00       C      	LD	A,(IY+0)
  559B'   FE FF          C      	CP	0FFH
  559D'   28 22          C      	JR	Z,$+36
  559F'   FD E5          C      	PUSH	IY
  55A1'   06 00          C      	LD	B,00H
  55A3'   FD 7E 00       C      	LD	A,(IY+0)
  55A6'   FE FF          C      	CP	0FFH
  55A8'   20 02          C      	JR	NZ,$+4
  55AA'   18 05          C      	JR	$+7
  55AC'   FD 23          C      	INC	IY
  55AE'   04             C      	INC	B
  55AF'   18 F2          C      	JR	$-12
  55B1'   FD E1          C      	POP	IY
  55B3'   FD E5          C      	PUSH	IY
  55B5'   FD 7E 01       C      	LD	A,(IY+1)
  55B8'   FD 77 00       C      	LD	(IY+0),A
  55BB'   FD 23          C      	INC	IY
  55BD'   10 F6          C      	DJNZ	$-8
  55BF'   FD E1          C      	POP	IY
  55C1'   C1             C      	POP	BC
  55C2'   05             C      	DEC	B
  55C3'   78             C      	LD	A,B
  55C4'   FE 00          C      	CP	00H
  55C6'   28 03          C      	JR	Z,$+5
  55C8'   C3 5337'       C      	JP	KY.DFR
  55CB'   C3 53A8'       C      	JP	KY.ATAA
  55CE'                  C      KU.ZEIR:
  55CE'   D1             C      	POP	DE
  55CF'   E1             C      	POP	HL
  55D0'   3A 2B00'       C      	LD	A,(UB.ZN)
  55D3'   D6 02          C      	SUB	2
  55D5'   FE 0D          C      	CP	13
  55D7'   30 04          C      	JR	NC,$+6
  55D9'   C1             C      	POP	BC
  55DA'   C3 5319'       C      	JP	KY.MD
  55DD'   32 2B00'       C      	LD	(UB.ZN),A
  55E0'   01 0029        C      	LD	BC,41
  55E3'   B7             C      	OR	A
  55E4'   ED 42          C      	SBC	HL,BC
  55E6'   FD 2B          C      	DEC	IY
  55E8'   7E             C      	LD	A,(HL)
  55E9'   FD BE 00       C      	CP	(IY+0)
  55EC'   CC 55FB'       C      	CALL	Z,KU.DECIY
  55EF'   FD 23          C      	INC	IY
  55F1'   01 0017        C      	LD	BC,23
  55F4'   B7             C      	OR	A
  55F5'   ED 42          C      	SBC	HL,BC
  55F7'   C1             C      	POP	BC
  55F8'   04             C      	INC	B
  55F9'   18 CA          C      	JR	$-52
  55FB'                  C      KU.DECIY:
  55FB'   FD 2B          C      	DEC	IY
  55FD'   C9             C      	RET
  55FE'                  C      KU.DD:
  55FE'   E5             C      	PUSH	HL
  55FF'   21 441D'       C      	LD	HL,UA.VORH
  5602'   CD 56D1'       C      	CALL	UR.MIMO
  5605'   38 17          C      	JR	C,$+25
  5607'   7E             C      	LD	A,(HL)
  5608'   FE 4A          C      	CP	'J'
  560A'   28 0C          C      	JR	Z,$+14
  560C'   FD 2B          C      	DEC	IY
  560E'   FD 36 00 FF    C      	LD	(IY+0),0FFH
  5612'   11 0050        C      	LD	DE,80
  5615'   B7             C      	OR	A
'Unterprogramme fuer KOPI'	MACRO-80 3.44	09-Dec-81	PAGE	1-58


  5616'   ED 52          C      	SBC	HL,DE
  5618'   36 20          C      	LD	(HL),20H
  561A'   21 2B00'       C      	LD	HL,UB.ZN
  561D'   35             C      	DEC	(HL)
  561E'   E1             C      	POP	HL
  561F'   C9             C      	RET
  5620'   E1             C      	POP	HL
  5621'   D1             C      	POP	DE
  5622'   DD 21 2B01'    C      	LD	IX,UB.KTAB
  5626'   C3 52AD'       C      	JP	KX.ENDR
                         C      ;	END
                                ;	
                         C      	INCLUDE K7.ASM	;Routinen fuer Kassette,Monitor UND Tastatur (UR.ASM)
                         C      	TITLE 'Routinen fuer Kassette,Monitor UND Tastatur'
                         C      	PAGE
'Routinen fuer Kassette,Monitor UND Tastatur'	MACRO-80 3.44	09-Dec-81	PAGE	1-59


                         C      
                         C      ;	PN	UR
                         C      ;	ORG	49A0H
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;   ROUTINEN FUER KASSETTE,MONITOR UND TASTATUR
                         C      ;
                         C      ;----------------------------------------------------------------------
                         C      ;   1.     KASSETTE
                         C      ;----------------------------------------------------------------------
  5629'                  C      UR.KRE:
  5629'   DD 36 05 31    C      	LD	(IX+5),31H
  562D'                  C      UR.KRE1:
  562D'   CD 4266'       C      	CALL	UF.EXEC
  5630'   C9             C      	RET
  5631'                  C      UR.KRW:
  5631'   DD 36 05 21    C      	LD	(IX+5),21H
  5635'   18 F6          C      	JR	UR.KRE1	;Umspulen
  5637'                  C      UR.KRWW:
  5637'   CD 5631'       C      	CALL	UR.KRW
  563A'   C9             C      	RET
  563B'                  C      UR.KRA:
  563B'   DD 36 05 41    C      	LD	(IX+5),41H
  563F'   18 EC          C      	JR	UR.KRE1	;Reservieren aus
  5641'                  C      UR.KLV:
  5641'   DD 36 05 71    C      	LD	(IX+5),71H
  5645'   18 E6          C      	JR	UR.KRE1	;Label vorsetzen
  5647'                  C      UR.KLR:
  5647'   DD 36 05 75    C      	LD	(IX+5),75H
  564B'   18 E0          C      	JR	UR.KRE1	;LABEL RUECKSETZEN
  564D'                  C      UR.KBM:
  564D'   DD 36 05 51    C      	LD	(IX+5),51H
  5651'   18 DA          C      	JR	UR.KRE1	;BANDMARKE SCHREIBEN
  5653'                  C      UR.KSL:
  5653'   DD 36 05 61    C      	LD	(IX+5),61H
  5657'   18 D4          C      	JR	UR.KRE1	;SCHLUSSLUECKE SCHREIBEN
  5659'                  C      UR.KBV:
  5659'   DD 36 05 11    C      	LD	(IX+5),11H
  565D'   18 CE          C      	JR	UR.KRE1	;Block vorsetzen
  565F'                  C      UR.KBR:
  565F'   DD 36 05 15    C      	LD	(IX+5),15H
  5663'   18 C8          C      	JR	UR.KRE1
                         C      ;--------------------------------------------------------------------
  5665'                  C      UR.RPOS:
  5665'   E5             C      	PUSH	HL
  5666'   D5             C      	PUSH	DE
  5667'   F5             C      	PUSH	AF
  5668'   C5             C      	PUSH	BC
  5669'   AF             C      	XOR	A
  566A'   3D             C      	DEC	A
  566B'   4F             C      	LD	C,A
  566C'   18 06          C      	JR	POSIK1
  566E'                  C      UR.POSIK:
  566E'   E5             C      	PUSH	HL
  566F'   D5             C      	PUSH	DE
  5670'   F5             C      	PUSH	AF
  5671'   C5             C      	PUSH	BC	;Positionieren
  5672'   AF             C      	XOR	A
  5673'   4F             C      	LD	C,A
  5674'                  C      POSIK1:
  5674'   06 00          C      	LD	B,0
  5676'   11 0000        C      	LD	DE,0
  5679'                  C      UR.LES:
  5679'   DD 36 05 02    C      	LD	(IX+5),02H
  567D'   CD 4266'       C      	CALL	UF.EXEC	;BLOCK LESEN
  5680'   DD 7E 02       C      	LD	A,(IX+2)
  5683'   FE 01          C      	CP	1	;BANDMARKE?
  5685'   28 19          C      	JR	Z,UR.BM
  5687'   04             C      	INC	B	;ANZAHL BLOECKE
  5688'   78             C      	LD	A,B
  5689'   FE 04          C      	CP	4
  568B'   28 21          C      	JR	Z,UR.OK
  568D'   21 0000        C      	LD	HL,0
  5690'   CD 5A26'       C      	CALL	XY.LIDX
  5693'   09             C      	DB	9	;HL<--BLOCKLAENGE
  5694'   19             C      	ADD	HL,DE
  5695'   EB             C      	EX	DE,HL
  5696'   21 012C        C      	LD	HL,300
  5699'   B7             C      	OR	A
  569A'   ED 52          C      	SBC	HL,DE
  569C'   38 10          C      	JR	C,UR.OK
  569E'   18 D9          C      	JR	UR.LES
'Routinen fuer Kassette,Monitor UND Tastatur'	MACRO-80 3.44	09-Dec-81	PAGE	1-60


  56A0'                  C      UR.BM:
  56A0'   AF             C      	XOR	A
  56A1'   B1             C      	OR	C
  56A2'   28 04          C      	JR	Z,$+6
  56A4'   C1             C      	POP	BC
  56A5'   04             C      	INC	B
  56A6'   18 C9          C      	JR	UR.POSIK+3
  56A8'   C1             C      	POP	BC
  56A9'   05             C      	DEC	B
  56AA'   28 21          C      	JR	Z,UR.RSP
  56AC'   18 C3          C      	JR	UR.POSIK+3
  56AE'                  C      UR.OK:
  56AE'   AF             C      	XOR	A
  56AF'   B1             C      	OR	C
  56B0'   28 08          C      	JR	Z,$+10
  56B2'   DD 70 0A       C      	LD	(IX+10),B	;??? IX+10
  56B5'   CD 5647'       C      	CALL	UR.KLR
  56B8'   18 13          C      	JR	UR.RSP
  56BA'   DD 36 05 15    C      	LD	(IX+5),15H
  56BE'   CD 4266'       C      	CALL	UF.EXEC
  56C1'   10 F7          C      	DJNZ	$-7
  56C3'   C1             C      	POP	BC
  56C4'   05             C      	DEC	B
  56C5'   28 06          C      	JR	Z,UR.RSP
  56C7'   DD 70 0A       C      	LD	(IX+10),B	;??? IX+10
  56CA'   CD 5641'       C      	CALL	UR.KLV
  56CD'                  C      UR.RSP:
  56CD'   F1             C      	POP	AF
  56CE'   D1             C      	POP	DE
  56CF'   E1             C      	POP	HL
  56D0'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;     2.     MONITOR
                         C      ;----------------------------------------------------------------------
  56D1'                  C      UR.MIMO:
  56D1'   D5             C      	PUSH	DE	;Register DE, BC retten
  56D2'   C5             C      	PUSH	BC
  56D3'   46             C      	LD	B,(HL)	;Anzahl einzugebender Zeichen
  56D4'   23             C      	INC	HL
  56D5'   4E             C      	LD	C,(HL)	;Laenge der Zeichenkette
  56D6'   23             C      	INC	HL
  56D7'   5E             C      	LD	E,(HL)	;Zeichenschluessel
  56D8'   23             C      	INC	HL
  56D9'   3A 2B00'       C      	LD	A,(UB.ZN)	;Zeilennummer
  56DC'   57             C      	LD	D,A	;D:= Zeilennummer
  56DD'   AF             C      	XOR	A
  56DE'   B9             C      	CP	C
  56DF'   28 0C          C      	JR	Z,UR.MIMO1	;Anzeige entfaellt
  56E1'   D5             C      	PUSH	DE
  56E2'   CD 5713'       C      	CALL	UR.DSPZK	;Anzeige
  56E5'                  C      UR.MIMO2:
  56E5'   D1             C      	POP	DE
  56E6'   CD 5720'       C      	CALL	UR.ZINP	;Zeicheneingabe ueber Tastatur
  56E9'   C1             C      	POP	BC
  56EA'   D1             C      	POP	DE
  56EB'   18 07          C      	JR	UR.MIMO3
  56ED'                  C      UR.MIMO1:
  56ED'   D5             C      	PUSH	DE
  56EE'   CD 5703'       C      	CALL	UR.BBSAD	;BWS - Adresse berechnen
  56F1'   EB             C      	EX	DE,HL	;HL:= akt. Bildschirmposition
  56F2'   18 F1          C      	JR	UR.MIMO2
  56F4'                  C      UR.MIMO3:
  56F4'   F5             C      	PUSH	AF
  56F5'   3A 2B00'       C      	LD	A,(UB.ZN)
  56F8'   3C             C      	INC	A
  56F9'   FE 18          C      	CP	24
  56FB'   CC 57FA'       C      	CALL	Z,UR.BILRO	;Zeile 24 ---> Bild rollen
  56FE'   32 2B00'       C      	LD	(UB.ZN),A
  5701'   F1             C      	POP	AF
  5702'   C9             C      	RET
  5703'                  C      UR.BBSAD:
  5703'   E5             C      	PUSH	HL	;Berechnung der BWS-Adresse
  5704'   C5             C      	PUSH	BC	;IN:    D...Zeilennummer
  5705'   21 2FB0        C      	LD	HL,UE.BWSA-80	;OUT:   DE..BWS-Adresse
  5708'   01 0050        C      	LD	BC,80	;BC:= Zeichen/Zeile
  570B'                  C      UR.BBSA1:
  570B'   09             C      	ADD	HL,BC
  570C'   15             C      	DEC	D
  570D'   20 FC          C      	JR	NZ,UR.BBSA1
  570F'   EB             C      	EX	DE,HL
  5710'   C1             C      	POP	BC
  5711'   E1             C      	POP	HL
  5712'   C9             C      	RET
'Routinen fuer Kassette,Monitor UND Tastatur'	MACRO-80 3.44	09-Dec-81	PAGE	1-61


  5713'                  C      UR.DSPZK:
  5713'   D5             C      	PUSH	DE	;Anzeige
  5714'   C5             C      	PUSH	BC	;IN   HL...Anfangsadresse ZK
  5715'   CD 5703'       C      	CALL	UR.BBSAD	;      D...Zeilennummer
  5718'   06 00          C      	LD	B,0	;      C...Zeichenkettenlaenge
  571A'   ED B0          C      	LDIR		;OUT  HL...akt. BWS-Adresse
  571C'   EB             C      	EX	DE,HL
  571D'   C1             C      	POP	BC
  571E'   D1             C      	POP	DE
  571F'   C9             C      	RET
  5720'                  C      UR.ZINP:
  5720'   E5             C      	PUSH	HL	;Zeicheneingabe ueber Tastatur
  5721'   AF             C      	XOR	A	;IN    B...Zeichenanzahl (max.)
  5722'   50             C      	LD	D,B	;     HL...akt. Adresse
  5723'   B8             C      	CP	B	;      E...Zeichenschluessel
  5724'   28 38          C      	JR	Z,UR.RET0	;keine Zeicheneingabe
  5726'                  C      UR.ZINP1:
  5726'   CB FE          C      	SET	7,(HL)	;Kursor setzen
  5728'                  C      UR.ZINP2:
  5728'   CD 57F4'       C      	CALL	UR.TAREP	;Tastaturabfrage
  572B'   CD 5768'       C      	CALL	UR.TCL	; <---
  572E'   CD 577B'       C      	CALL	UR.TCR	; --->
  5731'   CD 578C'       C      	CALL	UR.TSYS	; SYS
  5734'   CD 5794'       C      	CALL	UR.TQUIT	; POS.QUIT
  5737'   CD 579C'       C      	CALL	UR.ZKONT	;Zeichenkontrolle
  573A'   CB BE          C      	RES	7,(HL)	;Kursor loeschen
  573C'   77             C      	LD	(HL),A	;Zeichen anzeigen
  573D'   23             C      	INC	HL	;akt. Adresse erhoehen
  573E'   10 E6          C      	DJNZ	UR.ZINP1	;B > 0, naechstes Zeichen
  5740'   CB FE          C      	SET	7,(HL)	;Kursor setzen
  5742'                  C      UR.ZINP5:
  5742'   CD 57F4'       C      	CALL	UR.TAREP
  5745'   FE F7          C      	CP	UE.TACL
  5747'   CC 5761'       C      	CALL	Z,UR.ZINP7
  574A'   FE 1E          C      	CP	UE.TAQUI
  574C'   28 06          C      	JR	Z,UR.ZINP3	;---> POS.QUIT
  574E'   FE CD          C      	CP	UE.TASYS
  5750'   28 07          C      	JR	Z,UR.ZINP4	;---> SYS
  5752'   18 EE          C      	JR	UR.ZINP5
  5754'                  C      UR.ZINP3:
  5754'   CB BE          C      	RES	7,(HL)	;Kursor loeschen
  5756'   E1             C      	POP	HL	;BWS - Adresse auskellern
  5757'   AF             C      	XOR	A	;CY:= 0
  5758'   C9             C      	RET
  5759'                  C      UR.ZINP4:
  5759'   CB BE          C      	RES	7,(HL)	;Kursor loeschen
  575B'   E1             C      	POP	HL
  575C'   37             C      	SCF		;CY:= 1
  575D'   C9             C      	RET
  575E'                  C      UR.RET0:
  575E'   E1             C      	POP	HL	;keine Zeicheneingabe
  575F'   AF             C      	XOR	A
  5760'   C9             C      	RET
  5761'                  C      UR.ZINP7:
  5761'   CD 5768'       C      	CALL	UR.TCL
  5764'   33             C      	INC	SP
  5765'   33             C      	INC	SP
  5766'   18 C0          C      	JR	UR.ZINP2
  5768'                  C      UR.TCL:
  5768'   FE F7          C      	CP	UE.TACL	;   <---
  576A'   C0             C      	RET	NZ		;Taste nicht gedrueckt
  576B'   F5             C      	PUSH	AF	;Tastencode retten
  576C'   04             C      	INC	B
  576D'   7A             C      	LD	A,D
  576E'   B8             C      	CP	B
  576F'   38 07          C      	JR	C,UR.TCLN	;Linksbewegung nicht zulaessig
  5771'   CB BE          C      	RES	7,(HL)	;Kursor loeschen
  5773'   2B             C      	DEC	HL	;BWS - Adresse decrementieren
  5774'   CB FE          C      	SET	7,(HL)	;Kursor setzen
  5776'   F1             C      	POP	AF	;Code auskellern
  5777'   C9             C      	RET
  5778'                  C      UR.TCLN:
  5778'   05             C      	DEC	B
  5779'   F1             C      	POP	AF
  577A'   C9             C      	RET
  577B'                  C      UR.TCR:
  577B'   FE F9          C      	CP	UE.TACR	;   --->
  577D'   C0             C      	RET	NZ
  577E'   F5             C      	PUSH	AF
  577F'   78             C      	LD	A,B
  5780'   FE 02          C      	CP	2
  5782'   38 06          C      	JR	C,UR.TCRN
  5784'   05             C      	DEC	B
'Routinen fuer Kassette,Monitor UND Tastatur'	MACRO-80 3.44	09-Dec-81	PAGE	1-62


  5785'   CB BE          C      	RES	7,(HL)
  5787'   23             C      	INC	HL
  5788'   CB FE          C      	SET	7,(HL)
  578A'                  C      UR.TCRN:
  578A'   F1             C      	POP	AF
  578B'   C9             C      	RET
  578C'                  C      UR.TSYS:
  578C'   FE CD          C      	CP	UE.TASYS	; SYS-Taste
  578E'   C0             C      	RET	NZ
  578F'   33             C      	INC	SP
  5790'   33             C      	INC	SP	;Returnadresse uebergehen
  5791'   C3 5759'       C      	JP	UR.ZINP4
  5794'                  C      UR.TQUIT:
  5794'   FE 1E          C      	CP	UE.TAQUI	; POS.QUIT
  5796'   C0             C      	RET	NZ
  5797'   33             C      	INC	SP
  5798'   33             C      	INC	SP
  5799'   C3 5754'       C      	JP	UR.ZINP3
  579C'                  C      UR.ZKONT:
  579C'   FE 7F          C      	CP	7FH
  579E'   30 22          C      	JR	NC,UR.ZKON1
  57A0'   CB 7B          C      	BIT	7,E	;Zeichenschluesselauswertung
  57A2'   C0             C      	RET	NZ		;Bit 7 = L, alle Tasten erlaubt
  57A3'   FE 20          C      	CP	20H
  57A5'   C8             C      	RET	Z		;Leertaste
  57A6'   CB 6B          C      	BIT	5,E
  57A8'   37             C      	SCF
  57A9'   C4 57C7'       C      	CALL	NZ,UR.ALPHA
  57AC'   D0             C      	RET	NC		;Bit 5 = L, nur Buchstaben
  57AD'   CB 63          C      	BIT	4,E
  57AF'   37             C      	SCF
  57B0'   C4 57D2'       C      	CALL	NZ,UR.NUM
  57B3'   D0             C      	RET	NC		;Bit 4 = L, nur Ziffern
  57B4'   CB 73          C      	BIT	6,E
  57B6'   37             C      	SCF
  57B7'   C4 57DB'       C      	CALL	NZ,UR.ALPNU
  57BA'   D0             C      	RET	NC		;Bit 6 = L, Buchstaben und
                         C      			;            Ziffern
  57BB'   CB 5B          C      	BIT	3,E
  57BD'   37             C      	SCF
  57BE'   C4 57E5'       C      	CALL	NZ,UR.HEXAZ
  57C1'   D0             C      	RET	NC		;BIT 3 = L ,HEXAZEICHEN
  57C2'                  C      UR.ZKON1:
  57C2'   33             C      	INC	SP
  57C3'   33             C      	INC	SP
  57C4'   C3 5728'       C      	JP	UR.ZINP2	;unerlaubter Tastencode
  57C7'                  C      UR.ALPHA:
  57C7'   FE 41          C      	CP	41H
  57C9'   D8             C      	RET	C
  57CA'   FE 5B          C      	CP	5BH
  57CC'   38 02          C      	JR	C,UR.ALPH1
  57CE'   37             C      	SCF
  57CF'   C9             C      	RET
  57D0'                  C      UR.ALPH1:
  57D0'   3F             C      	CCF
  57D1'   C9             C      	RET
  57D2'                  C      UR.NUM:
  57D2'   FE 30          C      	CP	30H
  57D4'   D8             C      	RET	C
  57D5'   FE 3A          C      	CP	3AH
  57D7'   38 F7          C      	JR	C,UR.ALPH1
  57D9'   37             C      	SCF
  57DA'   C9             C      	RET
  57DB'                  C      UR.ALPNU:
  57DB'   CD 57C7'       C      	CALL	UR.ALPHA
  57DE'   D0             C      	RET	NC
  57DF'   CD 57D2'       C      	CALL	UR.NUM
  57E2'   D0             C      	RET	NC
  57E3'   37             C      	SCF
  57E4'   C9             C      	RET
  57E5'                  C      UR.HEXAZ:
  57E5'   CD 57D2'       C      	CALL	UR.NUM
  57E8'   D0             C      	RET	NC
  57E9'   FE 41          C      	CP	'A'
  57EB'   D8             C      	RET	C
  57EC'   FE 47          C      	CP	'G'
  57EE'   38 02          C      	JR	C,UR.HEXZ1
  57F0'   37             C      	SCF
  57F1'   C9             C      	RET
  57F2'                  C      UR.HEXZ1:
  57F2'   3F             C      	CCF
  57F3'   C9             C      	RET
                         C      
'Routinen fuer Kassette,Monitor UND Tastatur'	MACRO-80 3.44	09-Dec-81	PAGE	1-63


  57F4'                  C      UR.TAREP:
  57F4'   CD 6EE6        C      	CALL	UE.TARO	;TASTATURROUTINE FUER ATS
  57F7'   28 FB          C      	JR	Z,$-3	;ES LIEGT KEIN ZEICHEN AN
  57F9'   C9             C      	RET
                         C      
  57FA'                  C      UR.BILRO:
  57FA'   C5             C      	PUSH	BC
  57FB'   D5             C      	PUSH	DE
  57FC'   E5             C      	PUSH	HL
  57FD'   01 03C0        C      	LD	BC,960
  5800'   11 3370        C      	LD	DE,UE.BWSA+880
  5803'   21 33C0        C      	LD	HL,UE.BWSA+960
  5806'   ED B0          C      	LDIR
  5808'   3E 20          C      	LD	A,20H	;letzte Zeile loeschen
  580A'   06 50          C      	LD	B,80
  580C'                  C      UR.BILR1:
  580C'   12             C      	LD	(DE),A
  580D'   10 FD          C      	DJNZ	UR.BILR1
  580F'   E1             C      	POP	HL
  5810'   AF             C      	XOR	A
  5811'   01 0050        C      	LD	BC,80
  5814'   ED 42          C      	SBC	HL,BC	;aktuelle BWS-Adresse nach  ROLL
  5816'   3A 2B00'       C      	LD	A,(UB.ZN)
  5819'   D1             C      	POP	DE
  581A'   C1             C      	POP	BC
  581B'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                                ;	
                                ;	INCLUDE	U1.ASM	;Allgemeine Unterprogramme
                                ;	INCLUDE	XY.ASM	;Handling f. IX/IY-adressierte Bereiche
                                ;	INCLUDE	UC.ASM	;Konvertierungen
                                ;	INCLUDE	CP.ASM	;Komprimierung
                                ;	INCLUDE	DC.ASM	;Dekomprimierung
                                ;	INCLUDE	UK.ASM	;Einzelzeicheneingabe fuer KMBG
                         C      	INCLUDE K8.ASM	;Allgemeine Unterprogramme
                         C      	TITLE	'Allgemeine Unterprogramme'
                         C      	PAGE
'Allgemeine Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-64


                         C      
                         C      ;	PN	U1
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;        Allgemeine Unterprogramme
                         C      ;
                         C      ;----------------------------------------------------------------------
  581C'                  C      U1.RSAVE:
  581C'   E3             C      	EX	(SP),HL	;Register retten (nicht AF)
  581D'   D5             C      	PUSH	DE
  581E'   C5             C      	PUSH	BC
  581F'   FD E5          C      	PUSH	IY
  5821'   DD E5          C      	PUSH	IX
  5823'   E9             C      	JP	(HL)
  5824'                  C      U1.RRST:
  5824'   E1             C      	POP	HL	;Register wieder herstellen
  5825'   DD E1          C      	POP	IX
  5827'   FD E1          C      	POP	IY
  5829'   C1             C      	POP	BC
  582A'   D1             C      	POP	DE
  582B'   E3             C      	EX	(SP),HL
  582C'   C9             C      	RET
  582D'                  C      U1.CLRB:
  582D'   E5             C      	PUSH	HL	;Bereich loeschen
  582E'   D5             C      	PUSH	DE
  582F'   C5             C      	PUSH	BC
  5830'   E5             C      	PUSH	HL	;IN:  HL= Bereichsanfang
  5831'   D1             C      	POP	DE	;     BC= Bereichslaenge
  5832'   13             C      	INC	DE
  5833'   AF             C      	XOR	A
  5834'   77             C      	LD	(HL),A
  5835'   0B             C      	DEC	BC
  5836'   ED B0          C      	LDIR
  5838'   C1             C      	POP	BC
  5839'   D1             C      	POP	DE
  583A'   E1             C      	POP	HL
  583B'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  583C'                  C      U1.KBR4:
  583C'   C5             C      	PUSH	BC
  583D'   06 04          C      	LD	B,4
  583F'   CD 565F'       C      	CALL	UR.KBR
  5842'   10 FB          C      	DJNZ	$-3
  5844'   C1             C      	POP	BC
  5845'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  5846'                  C      U1.WAIT:
                         C      	; PUSH	AF
                         C      	; CALL	UE.BERT
                         C      	; JR	C,$-3
                         C      	; POP	AF
  5846'   C9             C      	RET
                         C      ;--------------------------------------------------------------------
  5847'                  C      U1.BREAD:
  5847'   CD 588A'       C      	CALL	U1.EIN	;BLOCK LESEN VON EINGABE
  584A'   DD 36 04 02    C      	LD	(IX+4),02H
  584E'   CD 4266'       C      	CALL	UF.EXEC
  5851'   C9             C      	RET
  5852'                  C      U1.BWRIT:
  5852'   CD 5893'       C      	CALL	U1.AUS	;BLOCK SCHREIBEN AUF AUSGABE
  5855'   DD 36 04 00    C      	LD	(IX+4),00H
  5859'   CD 4266'       C      	CALL	UF.EXEC
  585C'   C9             C      	RET
  585D'                  C      U1.COPB2:
  585D'   F5             C      	PUSH	AF
  585E'   37             C      	SCF
  585F'   18 02          C      	JR	$+4
  5861'                  C      U1.COPB:
  5861'   F5             C      	PUSH	AF
  5862'   B7             C      	OR	A
  5863'   CD 588A'       C      	CALL	U1.EIN
  5866'   DD 36 04 02    C      	LD	(IX+4),02H
  586A'   DC 52CC'       C      	CALL	C,KX.EXEC2
  586D'   D4 4266'       C      	CALL	NC,UF.EXEC
  5870'   F5             C      	PUSH	AF
  5871'   CD 5893'       C      	CALL	U1.AUS
  5874'   DD 7E 09       C      	LD	A,(IX+9)
  5877'   DD B6 0A       C      	OR	(IX+10)
  587A'   28 08          C      	JR	Z,$+10
  587C'   CD 5852'       C      	CALL	U1.BWRIT
  587F'   F1             C      	POP	AF
  5880'   38 DC          C      	JR	C,$-34
'Allgemeine Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-65


  5882'   30 DE          C      	JR	NC,$-32
  5884'   CD 564D'       C      	CALL	UR.KBM
  5887'   F1             C      	POP	AF
  5888'   F1             C      	POP	AF
  5889'   C9             C      	RET
  588A'                  C      U1.EIN:
  588A'   F5             C      	PUSH	AF
  588B'   3A E000        C      	LD	A,(BC.TAB1)
  588E'   DD 77 03       C      	LD	(IX+3),A
  5891'   F1             C      	POP	AF
  5892'   C9             C      	RET
  5893'                  C      U1.AUS:
  5893'   F5             C      	PUSH	AF
  5894'   3A E001        C      	LD	A,(BC.TAB1+1)
  5897'   DD 77 03       C      	LD	(IX+3),A
  589A'   F1             C      	POP	AF
  589B'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  589C'                  C      U1.VS1:
  589C'   E5             C      	PUSH	HL
  589D'   C5             C      	PUSH	BC
  589E'   F5             C      	PUSH	AF
  589F'   3E 01          C      	LD	A,01H	;1.DATEIVORSATZ IM PUFFER
  58A1'   18 04          C      	JR	$+6
  58A3'                  C      U1.VSX:
  58A3'   E5             C      	PUSH	HL
  58A4'   C5             C      	PUSH	BC
  58A5'   F5             C      	PUSH	AF
  58A6'   AF             C      	XOR	A	;00-DATEIVORSATZ IM PUFFER
  58A7'   06 20          C      	LD	B,32
  58A9'   21 0E66        C      	LD	HL,UE.PUF
  58AC'   CD 59BB'       C      	CALL	U1.TR
  58AF'   F1             C      	POP	AF
  58B0'   C1             C      	POP	BC
  58B1'   E1             C      	POP	HL
  58B2'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  58B3'                  C      U1.DSVG:
  58B3'   E5             C      	PUSH	HL
  58B4'   D5             C      	PUSH	DE
  58B5'   F5             C      	PUSH	AF
  58B6'   06 07          C      	LD	B,7	;MRES KASSETTE ?
  58B8'   CD 5957'       C      	CALL	U1.VORS1
  58BB'   11 0E6C        C      	LD	DE,UE.PUF+6
  58BE'   21 4330'       C      	LD	HL,UA.DS+6
  58C1'   06 0E          C      	LD	B,14
  58C3'   1A             C      	LD	A,(DE)
  58C4'   BE             C      	CP	(HL)
  58C5'   20 10          C      	JR	NZ,$+18
  58C7'   13             C      	INC	DE
  58C8'   23             C      	INC	HL
  58C9'   10 F8          C      	DJNZ	$-6
  58CB'   3A 0E67        C      	LD	A,(UE.PUF+1)
  58CE'   4F             C      	LD	C,A	;C <-- NEXT RECORD
  58CF'   3A 0E69        C      	LD	A,(UE.PUF+3)
  58D2'   47             C      	LD	B,A	;B <-- ANZ.VERZ.EINTRAG.
  58D3'   F1             C      	POP	AF
  58D4'   D1             C      	POP	DE
  58D5'   E1             C      	POP	HL
  58D6'   C9             C      	RET
  58D7'   F1             C      	POP	AF
  58D8'   D1             C      	POP	DE
  58D9'   E1             C      	POP	HL
  58DA'   FD E1          C      	POP	IY
  58DC'   3E 90          C      	LD	A,90H
  58DE'   CD 4280'       C      	CALL	UF.ERANZ
  58E1'   C3 000B        C      	JP	UE.SYSTB
                         C      ;----------------------------------------------------------------------
  58E4'                  C      U1.NMVGL:
  58E4'   C5             C      	PUSH	BC
  58E5'   D5             C      	PUSH	DE
  58E6'   E5             C      	PUSH	HL
  58E7'   06 06          C      	LD	B,6
  58E9'   11 0E66        C      	LD	DE,UE.PUF
  58EC'   1A             C      	LD	A,(DE)
  58ED'   BE             C      	CP	(HL)	;HL:ZU SUCHENDER PROGR.NAME
  58EE'   20 0C          C      	JR	NZ,$+14
  58F0'   23             C      	INC	HL
  58F1'   13             C      	INC	DE
  58F2'   10 F8          C      	DJNZ	$-6
  58F4'   3A 0E7D        C      	LD	A,(UE.PUF+23)	;LABELNR. -->A
  58F7'   37             C      	SCF		;CY=1,WENN PROGR. GEFUNDEN
  58F8'   E1             C      	POP	HL
'Allgemeine Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-66


  58F9'   D1             C      	POP	DE
  58FA'   C1             C      	POP	BC
  58FB'   C9             C      	RET
  58FC'   B7             C      	OR	A
  58FD'   18 F9          C      	JR	$-5
                         C      ;----------------------------------------------------------------------
  58FF'                  C      U1.KTINI:
  58FF'   E5             C      	PUSH	HL
  5900'   C5             C      	PUSH	BC
  5901'   F5             C      	PUSH	AF
  5902'   CD 59C6'       C      	CALL	U1.BILO	;UNTERE HAELFTE BS LOESCHEN
  5905'   DD 21 2B01'    C      	LD	IX,UB.KTAB	;ADR. STEUERTAB. F.KASS.ROUTINE
  5909'   DD E5          C      	PUSH	IX
  590B'   E1             C      	POP	HL
  590C'   AF             C      	XOR	A
  590D'   06 1B          C      	LD	B,27
  590F'   CD 59BB'       C      	CALL	U1.TR	;TAB. AUF 00 LOESCHEN
  5912'   DD 36 03 30    C      	LD	(IX+3),30H
                         C      ;	CALL	UE.KINI
  5916'   18 03          C      	JR	$+5
  5918'                  C      U1.KTIN1:
  5918'   E5             C      	PUSH	HL
  5919'   C5             C      	PUSH	BC
  591A'   F5             C      	PUSH	AF
                         C      ;	LD	(IX+11),7	;ANZAHL LESE/SCHREIBWDHLGNN
                         C      ;	LD	(IX+12),4	;ANZAHL
  591B'   21 0E66        C      	LD	HL,UE.PUF
  591E'   CD 5A36'       C      	CALL	XY.STDX
  5921'   07             C      	DB	7	;SYSTEMPUFFERADR.-->TAB
  5922'   21 8010        C      	LD	HL,UE.KPUFF
  5925'   CD 5A36'       C      	CALL	XY.STDX
  5928'   19             C      	DB	25	;E/A PUFFERADR.-->TAB	;???
  5929'   F1             C      	POP	AF
  592A'   C1             C      	POP	BC
  592B'   E1             C      	POP	HL
  592C'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  592D'                  C      U1.VERIN:
  592D'   E5             C      	PUSH	HL
  592E'   C5             C      	PUSH	BC
  592F'   F5             C      	PUSH	AF
  5930'   11 EC82        C      	LD	DE,BC.VTABE	;VERZ. EINGABEGER. EINLESEN
  5933'   18 03          C      	JR	$+5
  5935'                  C      U1.VERNI:
  5935'   E5             C      	PUSH	HL
  5936'   C5             C      	PUSH	BC
  5937'   F5             C      	PUSH	AF
  5938'   3A 0E69        C      	LD	A,(UE.PUF+3)	;ANZ. DATEIEN-->B
  593B'   47             C      	LD	B,A
  593C'   C5             C      	PUSH	BC
  593D'   21 0E66        C      	LD	HL,UE.PUF
  5940'   01 0020        C      	LD	BC,32
  5943'   ED B0          C      	LDIR
  5945'   CD 4266'       C      	CALL	UF.EXEC
  5948'   C1             C      	POP	BC
  5949'   10 F1          C      	DJNZ	$-13
  594B'   F1             C      	POP	AF
  594C'   C1             C      	POP	BC
  594D'   E1             C      	POP	HL
  594E'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  594F'                  C      U1.VORST:
  594F'   C5             C      	PUSH	BC
  5950'   CD 5637'       C      	CALL	UR.KRWW
  5953'   06 06          C      	LD	B,6
  5955'   18 01          C      	JR	$+3
  5957'                  C      U1.VORS1:
  5957'   C5             C      	PUSH	BC
  5958'   DD 36 04 02    C      	LD	(IX+4),02H
  595C'   CD 4266'       C      	CALL	UF.EXEC
  595F'   10 FB          C      	DJNZ	$-3
  5961'   C1             C      	POP	BC
  5962'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  5963'                  C      U1.VZS:
  5963'   D5             C      	PUSH	DE
  5964'   C5             C      	PUSH	BC
  5965'   E5             C      	PUSH	HL
  5966'   F5             C      	PUSH	AF
  5967'   CD 5659'       C      	CALL	UR.KBV
  596A'   CD 565F'       C      	CALL	UR.KBR
  596D'   11 0E66        C      	LD	DE,UE.PUF
  5970'   01 0006        C      	LD	BC,6
'Allgemeine Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-67


  5973'   ED B0          C      	LDIR		;PROGR.NAME --> PUFFER
  5975'   3A 2B1E'       C      	LD	A,(UB.PAR2)	;DATEITYP
  5978'   12             C      	LD	(DE),A
  5979'   13             C      	INC	DE
  597A'   3E 44          C      	LD	A,'D'
  597C'   12             C      	LD	(DE),A
  597D'   13             C      	INC	DE
  597E'   3A 2B20'       C      	LD	A,(UB.PAR3)
  5981'   FE 7F          C      	CP	7FH
  5983'   20 0F          C      	JR	NZ,$+17
  5985'   21 4370'       C      	LD	HL,UA.KOMMT	;FRAGE KOMMENTAR WENN PAR3=7F
  5988'   CD 56D1'       C      	CALL	UR.MIMO
  598B'   01 0006        C      	LD	BC,6
  598E'   ED B0          C      	LDIR
  5990'   06 09          C      	LD	B,9
  5992'   18 02          C      	JR	$+4
  5994'   06 0F          C      	LD	B,15
  5996'   3E 20          C      	LD	A,' '
  5998'   12             C      	LD	(DE),A
  5999'   13             C      	INC	DE
  599A'   10 FC          C      	DJNZ	$-2
  599C'   3A 2B1C'       C      	LD	A,(UB.PAR1)
  599F'   12             C      	LD	(DE),A
  59A0'   13             C      	INC	DE
  59A1'   06 08          C      	LD	B,8
  59A3'   AF             C      	XOR	A
  59A4'   12             C      	LD	(DE),A
  59A5'   13             C      	INC	DE
  59A6'   10 FC          C      	DJNZ	$-2
  59A8'   21 0020        C      	LD	HL,32
  59AB'   CD 5A46'       C      	CALL	XY.STIDX
  59AE'   09             C      	DB	9
  59AF'   DD 36 04 00    C      	LD	(IX+4),00H
  59B3'   CD 4266'       C      	CALL	UF.EXEC
  59B6'   F1             C      	POP	AF
  59B7'   E1             C      	POP	HL
  59B8'   C1             C      	POP	BC
  59B9'   D1             C      	POP	DE
  59BA'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  59BB'                  C      U1.TR:
  59BB'   77             C      	LD	(HL),A	;A=INHALT
  59BC'   23             C      	INC	HL
  59BD'   10 FC          C      	DJNZ	U1.TR	;B=ANZAHL
  59BF'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  59C0'                  C      U1.INFO:
  59C0'   01 000E        C      	LD	BC,14
  59C3'   ED B0          C      	LDIR
  59C5'   C9             C      	RET
  59C6'                  C      U1.BILO:
  59C6'   CD 581C'       C      	CALL	U1.RSAVE
  59C9'   21 3370        C      	LD	HL,3370H
  59CC'   01 0460        C      	LD	BC,1120
  59CF'   36 20          C      	LD	(HL),20H
  59D1'   54             C      	LD	D,H
  59D2'   5D             C      	LD	E,L
  59D3'   13             C      	INC	DE
  59D4'   ED B0          C      	LDIR
  59D6'   CD 5824'       C      	CALL	U1.RRST
  59D9'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  59DA'                  C      U1.TST:
  59DA'   B7             C      	OR	A
  59DB'   D6 30          C      	SUB	30H
  59DD'   47             C      	LD	B,A
  59DE'   05             C      	DEC	B
  59DF'   C8             C      	RET	Z
  59E0'   05             C      	DEC	B
  59E1'   C8             C      	RET	Z
  59E2'   37             C      	SCF
  59E3'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
  59E4'                  C      U1.PRADR:
  59E4'   E5             C      	PUSH	HL
  59E5'   C5             C      	PUSH	BC
  59E6'   06 04          C      	LD	B,4
  59E8'   7E             C      	LD	A,(HL)
  59E9'   FE 20          C      	CP	' '
  59EB'   28 07          C      	JR	Z,$+9
  59ED'   23             C      	INC	HL
  59EE'   10 F8          C      	DJNZ	$-6
  59F0'   B7             C      	OR	A
'Allgemeine Unterprogramme'	MACRO-80 3.44	09-Dec-81	PAGE	1-68


  59F1'   C1             C      	POP	BC
  59F2'   E1             C      	POP	HL
  59F3'   C9             C      	RET
  59F4'   37             C      	SCF
  59F5'   21 2B00'       C      	LD	HL,UB.ZN
  59F8'   35             C      	DEC	(HL)
  59F9'   18 F6          C      	JR	$-8
                         C      ;---------------------------------------------------------------------
  59FB'                  C      U1.KRWE:
  59FB'   CD 5629'       C      	CALL	UR.KRE
  59FE'   CD 5637'       C      	CALL	UR.KRWW
  5A01'   C9             C      	RET
                         C      ;---------------------------------------------------------------------
                         C      ;	END
                         C      	TITLE 'Handling f. IX/IY-adressierte Bereiche'
                         C      	PAGE
'Handling f. IX/IY-adressierte Bereiche'	MACRO-80 3.44	09-Dec-81	PAGE	1-69


                         C      
                         C      ;	PN	XY ; Unterprogramme
                         C      ;**********************************************************************
                         C      ;*                                                                    *
                         C      ;*       Handling f. IX/IY-adressierte Steuer-Bloecke bzw.            *
                         C      ;*                                     Arbeits-Bereiche               *
                         C      ;*                                                                    *
                         C      ;*--------------------------------------------------------------------*
                         C      ;*                                                                    *
                         C      ;*       Ausser den angegebenen Registern bzw. Flags wird nur noch    *
                         C      ;*       die angegebene Anzahl der ersten freien Stack-Plaetze (je    *
                         C      ;*       Byte) veraendert. Weiterer RAM-Platz wird nicht benoetigt.   *
                         C      ;*                                                                    *
                         C      ;**********************************************************************
                         C      ;*                                                                    *
                         C      ;*       Technische (Hilfs-) Unter-Programme                          *
                         C      ;*                                                                    *
                         C      ;**********************************************************************
                         C      			;
                         C      ;        Uebernahme von nach dem CALL stehenden Parameter
                         C      ;        ++++++++++++++++++++++++++++++++++++++++++++++++
                         C      ;        erwarten Stack:           Return-Adresse f.uebergeordnetes UP
                         C      ;                       (SP) -->   Return-Adresse f.CALPn
                         C      ;        geben Stack zurueck:      Return-Adresse f.uebergeordn.UP + n
                         C      ;                                  (DE)
                         C      ;                       (SP) -->   (HL)
                         C      ;        geben in Reg.zurueck:     (DE):  Wert    1.Parameter-Byte
                         C      ;                                  (HL):  Adresse 2.Parameter-Byte
                         C      ;        --------------------------------------------------------------
                         C      			;
  5A02'                  C      XY.CALP1	EQU	$	; 1 Byte-Parameter
                         C      			; ++++++++++++++++++++++++++++++
  5A02'   E5             C      	PUSH	HL	; Retten HL
  5A03'   E1             C      	POP	HL
                         C      			;
  5A04'   EB             C      	EX	DE,HL	; DE <--> RET-Adr.f.CALPn
  5A05'   E3             C      	EX	(SP),HL
  5A06'   EB             C      	EX	DE,HL
                         C      			;
  5A07'   E1             C      	POP	HL	; (SP) --> RET-Adr.f.ueberg.UP
                         C      			;
  5A08'   E1             C      	POP	HL	; Laden u. korrig. ...
  5A09'   23             C      	INC	HL
  5A0A'   E5             C      	PUSH	HL
  5A0B'                  C      XY.CALPE:
  5A0B'   2B             C      	DEC	HL
                         C      			;
  5A0C'   3B             C      	DEC	SP	; (SP) --> (DE)
  5A0D'   3B             C      	DEC	SP
  5A0E'   3B             C      	DEC	SP	; (SP) --> (HL)
  5A0F'   3B             C      	DEC	SP
                         C      			;
  5A10'   D5             C      	PUSH	DE	; RET-Adr.f.CALPn
                         C      			;
  5A11'   5E             C      	LD	E,(HL)	; Laden DE, HL
  5A12'   16 00          C      	LD	D,0
  5A14'   23             C      	INC	HL
                         C      			;
  5A15'   C9             C      	RET
                         C      			;
                         C      			;
                         C      ;**********************************************************************
                         C      ;*                                                                    *
                         C      ;*       Lade-, Speicher- und Transport-Unterprogramme                *
                         C      ;*                                                                    *
                         C      ;**********************************************************************
                         C      ;
                         C      ;    CALL  LDDX    'Load':              HL := (IX+d)
                         C      ;    DB    d                                              Stack: 4
                         C      ;    -----------   ----------------------------------------------------
                         C      			;
  5A16'                  C      XY.LDDX:
  5A16'   CD 5A02'       C      	CALL	XY.CALP1	; Uebernahme d
                         C      			;
  5A19'   DD E5          C      	PUSH	IX	; HL := IX+d
  5A1B'   E1             C      	POP	HL	;               <--- LDDY
  5A1C'   F5             C      	PUSH	AF
  5A1D'   19             C      	ADD	HL,DE
  5A1E'   F1             C      	POP	AF
                         C      			;
  5A1F'   5E             C      	LD	E,(HL)	; HL := (IX+d)
  5A20'   23             C      	INC	HL
'Handling f. IX/IY-adressierte Bereiche'	MACRO-80 3.44	09-Dec-81	PAGE	1-70


  5A21'   56             C      	LD	D,(HL)
  5A22'   EB             C      	EX	DE,HL
                         C      			;
  5A23'   D1             C      	POP	DE	; Return
  5A24'   D1             C      	POP	DE
  5A25'   C9             C      	RET
                         C      			;
                         C      ;**********************************************************************
                         C      ;
                         C      ;    CALL  LIDX    'Load inverse':      LH := (IX+d)
                         C      ;    DB    d                                              Stack: 4
                         C      ;    -----------   ----------------------------------------------------
                         C      			;
  5A26'                  C      XY.LIDX:
  5A26'   CD 5A02'       C      	CALL	XY.CALP1	; Uebernahme d
                         C      			;
  5A29'   DD E5          C      	PUSH	IX	; HL := IX+d
  5A2B'   E1             C      	POP	HL	;               <--- LIDY
  5A2C'   F5             C      	PUSH	AF
  5A2D'   19             C      	ADD	HL,DE
  5A2E'   F1             C      	POP	AF
                         C      			;
  5A2F'   56             C      	LD	D,(HL)	; LH := (IX+d)
  5A30'   23             C      	INC	HL
  5A31'   5E             C      	LD	E,(HL)
  5A32'   EB             C      	EX	DE,HL
                         C      			;
  5A33'   D1             C      	POP	DE	; Return
  5A34'   D1             C      	POP	DE
  5A35'   C9             C      	RET
                         C      			;
                         C      ;**********************************************************************
                         C      ;
                         C      ;    CALL  STDX    'Store':            (IX+d) := HL
                         C      ;    DB    d                                                  Stack: 4
                         C      ;    -----------   ----------------------------------------------------
                         C      			;
  5A36'                  C      XY.STDX:
  5A36'   CD 5A02'       C      	CALL	XY.CALP1	; Uebernahme d
                         C      			;
  5A39'   DD E5          C      	PUSH	IX	; HL := IX+d
  5A3B'   E1             C      	POP	HL	;               <--- STDY
  5A3C'   F5             C      	PUSH	AF
  5A3D'   19             C      	ADD	HL,DE
  5A3E'   F1             C      	POP	AF
                         C      			;
  5A3F'   D1             C      	POP	DE
  5A40'   73             C      	LD	(HL),E	; (IX+d) := HL
  5A41'   23             C      	INC	HL
  5A42'   72             C      	LD	(HL),D
  5A43'   EB             C      	EX	DE,HL
                         C      			;
  5A44'   D1             C      	POP	DE	; Return
  5A45'   C9             C      	RET
                         C      			;
                         C      ;**********************************************************************
                         C      ;
                         C      ;    CALL  STIDX    'Store inverse':    (IX+d) := LH
                         C      ;    DB    d                                                  Stack: 4
                         C      ;    -----------   ----------------------------------------------------
                         C      			;
  5A46'                  C      XY.STIDX:
  5A46'   CD 5A02'       C      	CALL	XY.CALP1	; Uebernahme d
                         C      			;
  5A49'   DD E5          C      	PUSH	IX	; HL := IX+d
  5A4B'   E1             C      	POP	HL	;               <--- STIDY
  5A4C'   F5             C      	PUSH	AF
  5A4D'   19             C      	ADD	HL,DE
  5A4E'   F1             C      	POP	AF
                         C      			;
  5A4F'   D1             C      	POP	DE
  5A50'   72             C      	LD	(HL),D	; (IX+d) := LH
  5A51'   23             C      	INC	HL
  5A52'   73             C      	LD	(HL),E
  5A53'   EB             C      	EX	DE,HL
                         C      			;
  5A54'   D1             C      	POP	DE	; Return
  5A55'   C9             C      	RET
                         C      			;
                         C      ;**********************************************************************
                         C      ;
                         C      ;    CALL  INCDX    'Increment':        (IX+d) := (IX+d) + 1
                         C      ;    DB    d                                    Flags wie ADC HL,...
'Handling f. IX/IY-adressierte Bereiche'	MACRO-80 3.44	09-Dec-81	PAGE	1-71


                         C      ;                                                             Stack: 4
                         C      ;    -----------   ----------------------------------------------------
                         C      			;
  5A56'                  C      XY.INCDX:
  5A56'   CD 5A02'       C      	CALL	XY.CALP1	; Uebernahme d
                         C      			;
  5A59'   DD E5          C      	PUSH	IX	; HL := IX+d
  5A5B'   E1             C      	POP	HL	;               <--- INCDY
  5A5C'   19             C      	ADD	HL,DE
                         C      			;
  5A5D'   5E             C      	LD	E,(HL)	; DE := (IX+d)
  5A5E'   23             C      	INC	HL
  5A5F'   56             C      	LD	D,(HL)
                         C      			;
  5A60'   E5             C      	PUSH	HL	; DE := (IX+d) + 1
  5A61'   21 0001        C      	LD	HL,1
  5A64'   B7             C      	OR	A
  5A65'   ED 5A          C      	ADC	HL,DE
  5A67'   EB             C      	EX	DE,HL
  5A68'   E1             C      	POP	HL
  5A69'   72             C      	LD	(HL),D
  5A6A'   2B             C      	DEC	HL
  5A6B'   73             C      	LD	(HL),E
                         C      			;
  5A6C'   E1             C      	POP	HL	; Return
  5A6D'   D1             C      	POP	DE
  5A6E'   C9             C      	RET
                         C      			;
                         C      ;**********************************************************************
                         C      ;*                                                                    *
                         C      ;*       Unterprogramm  'Unbedingter Sprung'                          *
                         C      ;*                                                                    *
                         C      ;**********************************************************************
                         C      ;
                         C      ;    CALL  JMPDX   'Jump':              JMP  (IX+d)
                         C      ;    DB    d                                              Stack: 4
                         C      ;                                       Achtung!
                         C      ;                                           Veraendert freie Stack-Pl.
                         C      ;    -----------   ----------------------------------------------------
                         C      			;
  5A6F'                  C      XY.JMPDX:
  5A6F'   CD 5A02'       C      	CALL	XY.CALP1	; Uebernahme d
                         C      			;
  5A72'   DD E5          C      	PUSH	IX	; HL := IX+d
  5A74'   E1             C      	POP	HL	;               <--- JMPDY
  5A75'   F5             C      	PUSH	AF
  5A76'   19             C      	ADD	HL,DE
  5A77'   F1             C      	POP	AF
                         C      			;
  5A78'   5E             C      	LD	E,(HL)	; HL := (IX+d)
  5A79'   23             C      	INC	HL
  5A7A'   56             C      	LD	D,(HL)
  5A7B'   EB             C      	EX	DE,HL
                         C      			;
  5A7C'   D1             C      	POP	DE	; Return = Jump
  5A7D'   E3             C      	EX	(SP),HL
  5A7E'   EB             C      	EX	DE,HL
  5A7F'   C9             C      	RET
                         C      			;
                         C      ;**********************************************************************
                         C      ;	END
                         C      	TITLE 'Konvertierungen'
                         C      	PAGE
'Konvertierungen'	MACRO-80 3.44	09-Dec-81	PAGE	1-72


                         C      
                         C      ;	PN	UC
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;       KONVERTIERUNGEN
                         C      ;
                         C      ;----------------------------------------------------------------------
                         C      ;                            HL := HL * 10
                         C      ;                                      (ohne Kontrolle auf Uebertrag)
  5A80'                  C      UC.HL10N:
  5A80'   E5             C      	PUSH	HL
  5A81'   D1             C      	POP	DE	; alter Wert in DE
  5A82'   29             C      	ADD	HL,HL
  5A83'   29             C      	ADD	HL,HL
  5A84'   19             C      	ADD	HL,DE
  5A85'   29             C      	ADD	HL,HL
  5A86'   C9             C      	RET
                         C      ;                            HL := HL * 10
                         C      ;                                            -->  C: Uebertrag in A
  5A87'                  C      UC.HL10C:
  5A87'   E5             C      	PUSH	HL
  5A88'   D1             C      	POP	DE	; alter Wert in DE
  5A89'   AF             C      	XOR	A
  5A8A'   29             C      	ADD	HL,HL
  5A8B'   30 01          C      	JR	NC,$+3
  5A8D'   3C             C      	INC	A
  5A8E'   87             C      	ADD	A,A
  5A8F'   29             C      	ADD	HL,HL
  5A90'   30 01          C      	JR	NC,$+3
  5A92'   3C             C      	INC	A
  5A93'   19             C      	ADD	HL,DE
  5A94'   30 01          C      	JR	NC,$+3
  5A96'   3C             C      	INC	A
  5A97'   87             C      	ADD	A,A
  5A98'   29             C      	ADD	HL,HL
  5A99'   30 01          C      	JR	NC,$+3
  5A9B'   3C             C      	INC	A
  5A9C'   B7             C      	OR	A
  5A9D'   C8             C      	RET	Z
  5A9E'   37             C      	SCF
  5A9F'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      ;                            Division mit Rest:  A  := HL / DE
                         C      ;                                                HL := Rest
                         C      			;      Cy(A) --->  A=255
                         C      			;-------------------------------
  5AA0'                  C      UC.DIVR:
  5AA0'   AF             C      	XOR	A
  5AA1'   ED 52          C      	SBC	HL,DE
  5AA3'   3C             C      	INC	A
  5AA4'   20 03          C      	JR	NZ,$+5
  5AA6'   3D             C      	DEC	A
  5AA7'   38 03          C      	JR	C,$+5
  5AA9'   30 F6          C      	JR	NC,$-8
  5AAB'   3D             C      	DEC	A
  5AAC'   19             C      	ADD	HL,DE
  5AAD'   C9             C      	RET
                         C      			;
                         C      ;**********************************************************************
                         C      ;*                                                                    *
                         C      ;*       CV...               Konvertierungen     (convert ...)        *
                         C      ;*                                                                    *
                         C      ;*--------------------------------------------------------------------*
                         C      ;*       ..A..:              in A                                     *
                         C      ;*       ..?*.:              von Typ *                                *
                         C      ;*       ..?.*:              nach Typ *                               *
                         C      ;*                                                                    *
                         C      ;*       Typen:              B - binaer                               *
                         C      ;*                           X - hexadezimal ASCII                    *
                         C      ;*                           A - Adresse binaer (L,H)                 *
                         C      ;*                           D - dezimal ASCII                        *
                         C      ;*                                                                    *
                         C      ;**********************************************************************
                         C      			;
                         C      ;                            In A:      Binaer < 16 --> ASCII hexa
                         C      ;                            ------------------------------------------
  5AAE'                  C      UC.CVABX:
  5AAE'   E6 0F          C      	AND	0FH
  5AB0'   F6 30          C      	OR	30H
  5AB2'   FE 3A          C      	CP	3AH
  5AB4'   D8             C      	RET	C
'Konvertierungen'	MACRO-80 3.44	09-Dec-81	PAGE	1-73


  5AB5'   C6 07          C      	ADD	A,7H
  5AB7'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      ;                            Byte binaer (HL) --> 2 ASCII hexa (DE)
                         C      ;                                                            HL+1, DE+2
                         C      ;                            ------------------------------------------
  5AB8'                  C      UC.CVBX:
  5AB8'   7E             C      	LD	A,(HL)
  5AB9'   23             C      	INC	HL	; benutzt: A, 2 Stack-P.
                         C      			;
  5ABA'   F5             C      	PUSH	AF	;ENTRY,WENN ZEICHEN IN A
  5ABB'   0F             C      	RRCA
  5ABC'   0F             C      	RRCA
  5ABD'   0F             C      	RRCA
  5ABE'   0F             C      	RRCA
  5ABF'   CD 5AC3'       C      	CALL	$+4
  5AC2'   F1             C      	POP	AF
                         C      			;
  5AC3'   CD 5AAE'       C      	CALL	UC.CVABX
  5AC6'   12             C      	LD	(DE),A
  5AC7'   13             C      	INC	DE
  5AC8'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      ;                       Adresse (L,H) binaer (HL) --> 4 ASCII hexa (DE)
                         C      ;                                                            HL+2, DE+4
                         C      ;                       -----------------------------------------------
  5AC9'                  C      UC.CVAX:
  5AC9'   23             C      	INC	HL
  5ACA'   CD 5AB8'       C      	CALL	UC.CVBX	; benutzt: A, 3 Stack-P.
  5ACD'   2B             C      	DEC	HL
  5ACE'   2B             C      	DEC	HL
  5ACF'   CD 5AB8'       C      	CALL	UC.CVBX
  5AD2'   23             C      	INC	HL
  5AD3'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      ;                       Adresse aus HL, binaer    --> 4 ASCII hexa (DE)
                         C      ;                                                                  DE+4
                         C      ;                       -----------------------------------------------
  5AD4'                  C      UC.CVHLX:
  5AD4'   7C             C      	LD	A,H
  5AD5'   CD 5ABA'       C      	CALL	UC.CVBX+2	; benutzt: A, 3 Stack-P.
  5AD8'   7D             C      	LD	A,L
  5AD9'   CD 5ABA'       C      	CALL	UC.CVBX+2
  5ADC'   C9             C      	RET
                         C      			;
                         C      			;
                         C      ;      ---------------------------------------------------------------
                         C      ;                            In A:     ASCII hexa --> binaer < 16
                         C      ;
                         C      ;                                       Datenfehler: Cy, A undefiniert
                         C      ;                            ------------------------------------------
  5ADD'                  C      UC.CVAXB:
  5ADD'   D6 30          C      	SUB	30H
  5ADF'   D8             C      	RET	C		;       (A) < '0'
  5AE0'   FE 0A          C      	CP	10
  5AE2'   3F             C      	CCF
  5AE3'   D0             C      	RET	NC
  5AE4'   FE 11          C      	CP	11H
  5AE6'   D8             C      	RET	C		; '9' < (A) < 'A'
  5AE7'   FE 17          C      	CP	17H
  5AE9'   3F             C      	CCF
  5AEA'   D8             C      	RET	C		; 'F' < (A)
  5AEB'   D6 07          C      	SUB	7H
  5AED'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      ;                            2 ASCII hexa (DE) --> Byte binaer (HL)
                         C      ;                                                            DE+2, HL+1
                         C      ;
                         C      ;                                       mit Datenfehler-Behandlung
                         C      ;                            ------------------------------------------
  5AEE'                  C      UC.CVXB:
  5AEE'   C5             C      	PUSH	BC
                         C      			; benutzt: A, 3 Stack-P.
  5AEF'   CD 5AFF'       C      	CALL	UC.CVX1B
  5AF2'   87             C      	ADD	A,A
  5AF3'   87             C      	ADD	A,A
  5AF4'   87             C      	ADD	A,A
  5AF5'   87             C      	ADD	A,A
  5AF6'   4F             C      	LD	C,A
'Konvertierungen'	MACRO-80 3.44	09-Dec-81	PAGE	1-74


                         C      			;
  5AF7'   CD 5AFF'       C      	CALL	UC.CVX1B
  5AFA'   81             C      	ADD	A,C
                         C      			;
  5AFB'   77             C      	LD	(HL),A
  5AFC'   23             C      	INC	HL
  5AFD'   C1             C      	POP	BC
  5AFE'   C9             C      	RET
                         C      			;
  5AFF'                  C      UC.CVX1B:
  5AFF'   1A             C      	LD	A,(DE)	; ASCII hexa (DE) --> A binaer,
  5B00'   CD 5ADD'       C      	CALL	UC.CVAXB	;                           DE+1
  5B03'   DC 5B08'       C      	CALL	C,UC.CVXER
  5B06'   13             C      	INC	DE
  5B07'   C9             C      	RET
                         C      			;
  5B08'                  C      UC.CVXER:
  5B08'   EB             C      	EX	DE,HL       ; Datenfehler-Behandlung hexa
  5B09'   CB FE          C      	SET	7,(HL)      ;         set cursor
  5B0B'   CD 57F4'       C          CALL  UR.TAREP  ; <-+     tast.request
  5B0E'   77             C          LD    (HL),A    ;   |     write in conv.-area
  5B0F'   CD 5ADD'       C          CALL  UC.CVAXB  ;   |     conv.in A
  5B12'   38 F7          C          JR    C,$-7     ; --+     on error ...
  5B14'   CB BE          C          RES   7,(HL)
  5B16'   EB             C          EX    DE,HL
  5B17'   C9             C          RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      ;                       4 ASCII hexa (DE) --> Adresse (L,H) binaer (HL)
                         C      ;                                                            DE+4, HL+2
                         C      ;
                         C      ;                                       mit Datenfehler-Behandlung
                         C      ;                       -----------------------------------------------
  5B18'                  C      UC.CVXA:
  5B18'   23             C      	INC	HL
  5B19'   CD 5AEE'       C      	CALL	UC.CVXB	; benutzt: A, 4 Stack-P.
  5B1C'   2B             C      	DEC	HL
  5B1D'   2B             C      	DEC	HL
  5B1E'   CD 5AEE'       C      	CALL	UC.CVXB
  5B21'   23             C      	INC	HL
  5B22'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      ;                     2 Byte binaer in HL ---> 1...5-stellig dezi (DE),
                         C      ;                                                             DE+1...5
                         C      ;                                  mit Vor-Null-Unterdrueckung
                         C      ;                                                    (nach nicht-dezi),
                         C      ;                                  zu wenig Stellen -->
                         C      ;                                      '*' in der obersten angeg.Stelle
                         C      ;                      ------------------------------------------------
  5B23'                  C      UC.CVBD5:
  5B23'   3E 05          C      	LD	A,5	; benutzt: A, 7 Stack-P.
  5B25'   18 0E          C      	JR	$+16
  5B27'                  C      UC.CVBD4:
  5B27'   3E 04          C      	LD	A,4
  5B29'   18 0A          C      	JR	$+12
  5B2B'                  C      UC.CVBD3:
  5B2B'   3E 03          C      	LD	A,3
  5B2D'   18 06          C      	JR	$+8
  5B2F'                  C      UC.CVBD2:
  5B2F'   3E 02          C      	LD	A,2
  5B31'   18 02          C      	JR	$+4
  5B33'                  C      UC.CVBD1:
  5B33'   3E 01          C      	LD	A,1
                         C      			;
  5B35'   C5             C      UC.CVBD:	PUSH	BC	; Zeichenzahl in A
  5B36'   E5             C      	PUSH	HL
  5B37'   47             C      	LD	B,A
  5B38'   CD 5B40'       C      	CALL	UC.CVBD0
  5B3B'   10 FB          C      	DJNZ	$-3
  5B3D'   E1             C      	POP	HL
  5B3E'   C1             C      	POP	BC
  5B3F'   C9             C      	RET
                         C      			;
                         C      ;                          Abspaltung B-te Stelle dezi von HL nach (DE)
                         C      ;                                                                  DE+1
                         C      ;                          B-te nicht fuehrende Stelle: '*' nach (DE)
                         C      ;                          --------------------------------------------
  5B40'                  C      UC.CVBD0:
  5B40'   C5             C      	PUSH	BC	; benutzt: A, 5 Stack-P.
                         C      			; --------
  5B41'   7D             C      	LD	A,L
  5B42'   F6 30          C      	OR	'0'
'Konvertierungen'	MACRO-80 3.44	09-Dec-81	PAGE	1-75


  5B44'   05             C      	DEC	B
  5B45'   28 29          C          JR   Z,$+43	  ; -------+
                         C                        ;        |
  5B47'   D5             C          PUSH DE       ;        |
  5B48'   E5             C          PUSH HL       ; DE := (B-1)-te Zehner-Potenz
  5B49'   21 0001        C          LD   HL,1     ;        |
  5B4C'   CD 5A80'       C          CALL UC.HL10N ;        |
  5B4F'   10 FB          C          DJNZ $-3      ;        |
  5B51'   EB             C          EX   DE,HL    ;        |
  5B52'   E1             C          POP  HL       ;        |
                         C                        ;        |
  5B53'   CD 5AA0'       C          CALL UC.DIVR  ; A := HL / B-te Zehner-Potenz
  5B56'   D1             C          POP  DE       ;        |     HL := Rest
                         C                        ;        |
  5B57'   FE 0A          C          CP   10       ; test to decimal
  5B59'   38 04          C          JR   C,$+6    ; ---+   |
  5B5B'   3E 2A          C          LD   A,'*'    ;    |   |
  5B5D'   18 11          C          JR   $+19     ; -------+
                         C                        ; <--+   |
  5B5F'   F6 30          C          OR   '0'      ; conv.to decimal
                         C                        ;        |
  5B61'   FE 30          C          CP   '0'      ; Vor-Null ?
  5B63'   20 0B          C          JR   NZ,$+13  ; -------+
  5B65'   1B             C          DEC  DE       ;        |
  5B66'   4F             C          LD   C,A      ;        |
  5B67'   CD 5B9D'       C          CALL UC.CVD1B ;        |
  5B6A'   79             C          LD   A,C      ;        |
  5B6B'   13             C          INC  DE       ;        |
  5B6C'   30 02          C          JR   NC,$+4   ;        |
  5B6E'   3E 20          C          LD   A,' '    ;        |
                         C                        ; <------+
  5B70'   12             C      	LD	(DE),A
  5B71'   13             C      	INC	DE
  5B72'   C1             C      	POP	BC
  5B73'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      ;                      Dezi von (DE) bis (-->DE) nicht-dezi
                         C      ;                                                --->      binaer in HL
                         C      ;
                         C      ;                         Fehler:
                         C      ;                         -------
                         C      ;                         Cy, NZ: Zahl zu gross, HL ohne letzte Ziffer
                         C      ;                         Cy, Z:  Leere Zahl (1.Position keine Ziffer),
                         C      ;                                        -->     HL = 0
                         C      ;                      ------------------------------------------------
  5B74'                  C      UC.CVDB:
  5B74'   26 00          C      	LD	H,0
  5B76'   CD 5B9D'       C      	CALL	UC.CVD1B
  5B79'   6F             C      	LD	L,A
  5B7A'   30 04          C      	JR	NC,$+6
  5B7C'   AF             C      	XOR	A
  5B7D'   6F             C      	LD	L,A
  5B7E'   37             C      	SCF
  5B7F'   C9             C      	RET		; ---> abend C, Z
                         C      			;
  5B80'   13             C      	INC	DE
  5B81'   CD 5B9D'       C      	CALL	UC.CVD1B
  5B84'   3F             C      	CCF
  5B85'   D0             C      	RET	NC		; ---> normal end
  5B86'   D5             C          PUSH  DE
  5B87'   F5             C          PUSH  AF
  5B88'   CD 5A87'       C          CALL  UC.HL10C
  5B8B'   38 0B          C          JR    C,$+13    ; ----------+
  5B8D'   F1             C          POP   AF        ;           |
  5B8E'   85             C          ADD   A,L       ;           |
  5B8F'   6F             C          LD    L,A       ;           |
  5B90'   30 03          C          JR    NC,$+5	; --+       |
  5B92'   24             C          INC   H         ;   |       |
  5B93'   28 04          C          JR    Z,$+6     ;   |    ---|--+
  5B95'   D1             C          POP   DE        ; <-+       |  |
  5B96'   18 E8          C          JR    $-22      ;           |  |
                         C                          ;      <----+  !
  5B98'   E1             C          POP   HL        ; abend Cy, NZ !
  5B99'   25             C          DEC   H         ;              |
  5B9A'   EB             C          EX    DE,HL     ;        <-----+
  5B9B'   D1             C          POP   DE
  5B9C'   C9             C          RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      ;                            Ziffer dezi (DE) ---> binaer nach A, DE+1
                         C      ;                                                  Cy: nicht-dezi
                         C      ;                            ------------------------------------------
'Konvertierungen'	MACRO-80 3.44	09-Dec-81	PAGE	1-76


  5B9D'                  C      UC.CVD1B:
  5B9D'   1A             C      	LD	A,(DE)
  5B9E'   D6 30          C      	SUB	30H
  5BA0'   D8             C      	RET	C
  5BA1'   FE 0A          C      	CP	10
  5BA3'   3F             C      	CCF
  5BA4'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      ;                    Byte binaer (HL) --> Byte ASCII-Symbol (DE)
                         C      ;                                         (sonst: 7FH )
                         C      ;                                                     HL+1, DE+1
                         C      ;                    --------------------------------------------------
  5BA5'                  C      UC.CVBC:
  5BA5'   7E             C      	LD	A,(HL)	; benutzt: A, 0 Stack-P.
  5BA6'   23             C      	INC	HL	; --------
  5BA7'   FE 20          C      	CP	20H
  5BA9'   30 02          C      	JR	NC,$+4
  5BAB'   3E 7F          C      	LD	A,7FH
  5BAD'   FE 7F          C      	CP	7FH
  5BAF'   38 02          C      	JR	C,$+4
  5BB1'   3E 7F          C      	LD	A,7FH
  5BB3'   12             C      	LD	(DE),A
  5BB4'   13             C      	INC	DE
  5BB5'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      ;                       Byte ASCII-Symbol (DE)   -->   Byte binaer (HL)
                         C      ;                                                      DE+1, HL+1
                         C      ;                       -----------------------------------------------
  5BB6'                  C      UC.CVCB:
  5BB6'   1A             C      	LD	A,(DE)	; benutzt: A, 0 Stack-P.
  5BB7'   13             C      	INC	DE
  5BB8'   FE 20          C      	CP	20H
  5BBA'   38 05          C      	JR	C,$+7
  5BBC'   FE 7E          C      	CP	7EH
  5BBE'   30 01          C      	JR	NC,$+3
  5BC0'   77             C      	LD	(HL),A
  5BC1'   23             C      	INC	HL
  5BC2'   C9             C      	RET
                         C      			;
                         C      
                         C      ;**********************************************************************
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;      KONVERTIERUNGEN
                         C      ;
                         C      ;----------------------------------------------------------------------
  5BC3'                  C      UC.DKONV:
  5BC3'   7E             C      	LD	A,(HL)	;DKOI--->ASCII
  5BC4'   CD 5BD7'       C      	CALL	UC.DK1	;(HL)--->(DE)
  5BC7'   12             C      	LD	(DE),A
  5BC8'   23             C      	INC	HL
  5BC9'   13             C      	INC	DE
  5BCA'   10 F7          C      	DJNZ	UC.DKONV
  5BCC'   C9             C      	RET
                         C      ;------------------------------------
  5BCD'                  C      UC.KONV:
  5BCD'   7E             C      	LD	A,(HL)	;ASCII--->DKOI
  5BCE'   CD 5BE2'       C      	CALL	UC.CKONV	;(HL) --->(DE)
  5BD1'   12             C      	LD	(DE),A
  5BD2'   23             C      	INC	HL
  5BD3'   13             C      	INC	DE
  5BD4'   10 F7          C      	DJNZ	UC.KONV
  5BD6'   C9             C      	RET
                         C      ;-----------------------------
  5BD7'                  C      UC.DK1:
  5BD7'   E5             C      	PUSH	HL	;DKOI--->ASCII
  5BD8'   D5             C      	PUSH	DE
  5BD9'   C5             C      	PUSH	BC
  5BDA'   21 5C05'       C      	LD	HL,UC.ASCCO
  5BDD'   11 5C65'       C      	LD	DE,UC.DKOI
  5BE0'   18 09          C      	JR	UC.DK2
  5BE2'                  C      UC.CKONV:
  5BE2'   E5             C      	PUSH	HL	;ASCII ---> DKOI
  5BE3'   D5             C      	PUSH	DE
  5BE4'   C5             C      	PUSH	BC
  5BE5'   21 5C65'       C      	LD	HL,UC.DKOI	;HL:= Anfangsadresse
  5BE8'   11 5C05'       C      	LD	DE,UC.ASCCO	;DE:= Anfangsadresse
  5BEB'                  C      UC.DK2:
  5BEB'   F5             C      	PUSH	AF	;Quellcodebyte retten
  5BEC'   AF             C      	XOR	A	;CY = 0
  5BED'   ED 52          C      	SBC	HL,DE	;Tabellendistanz berechnen
'Konvertierungen'	MACRO-80 3.44	09-Dec-81	PAGE	1-77


  5BEF'   2B             C      	DEC	HL
  5BF0'   E5             C      	PUSH	HL
  5BF1'   C1             C      	POP	BC	;BC:= Tabellendistanz - 1
  5BF2'   EB             C      	EX	DE,HL	;HL:= Anfangsadresse
  5BF3'   F1             C      	POP	AF	;Zeichen wieder herstellen
  5BF4'   C5             C      	PUSH	BC	;Tabellendistanz retten
  5BF5'   01 0060        C      	LD	BC,UE.COTAL	;BC:= Tabellenlaenge
  5BF8'   ED B1          C      	CPIR		;Quellcodebyte suchen
  5BFA'   37             C      	SCF		;CY = 1
  5BFB'   C1             C      	POP	BC	;Tabellendistanz auskellern
  5BFC'   20 03          C      	JR	NZ,UC.KONV2	;---> Quellcodebyte nicht
  5BFE'   09             C      	ADD	HL,BC	;Zielcodeadresse berechnen
  5BFF'   AF             C      	XOR	A	;CY = 0
  5C00'   7E             C      	LD	A,(HL)	;Zielcodebyte laden
  5C01'                  C      UC.KONV2:
  5C01'   C1             C      	POP	BC
  5C02'   D1             C      	POP	DE
  5C03'   E1             C      	POP	HL
  5C04'   C9             C      	RET
                         C      ;****************************************************************
                         C      ;         ASCII - Codetabelle
                         C      ;****************************************************************
  5C05'                  C      UC.ASCCO:
  5C05'   20 21 22 23    C      	DB	' !"#$%&'
  5C09'   24 25 26       C      
  5C0C'   27             C      	DB	27H	;'
  5C0D'   28 29 2A 2B    C      	DB	'()*+,-./'
  5C11'   2C 2D 2E 2F    C      
  5C15'   30 31 32 33    C      	DB	'0123456789'
  5C19'   34 35 36 37    C      
  5C1D'   38 39          C      
  5C1F'   3A 3B 3C 3D    C      	DB	':;<=>?@'
  5C23'   3E 3F 40       C      
  5C26'   41 42 43 44    C      	DB	'ABCDEFGHIJKLMNOPQRSTUVWXYZ'
  5C2A'   45 46 47 48    C      
  5C2E'   49 4A 4B 4C    C      
  5C32'   4D 4E 4F 50    C      
  5C36'   51 52 53 54    C      
  5C3A'   55 56 57 58    C      
  5C3E'   59 5A          C      
  5C40'   5B 5C 5D 5E    C      	DB	'[\]^_`'
  5C44'   5F 60          C      
  5C46'   61 62 63 64    C      	DB	'abcdefghijklmnopqrstuvwxyz'
  5C4A'   65 66 67 68    C      
  5C4E'   69 6A 6B 6C    C      
  5C52'   6D 6E 6F 70    C      
  5C56'   71 72 73 74    C      
  5C5A'   75 76 77 78    C      
  5C5E'   79 7A          C      
  5C60'   7B 7C 7D 7E    C      	DB	'{|}~'
  5C64'   7F             C      	DB	7FH	;DEL
                         C      ;***************************************************************
                         C      ;         DKOI - Codetabelle
                         C      ;***************************************************************
  5C65'                  C      UC.DKOI:
  5C65'   40             C      	DB	40H	;blank
  5C66'   4F             C      	DB	4FH	;!
  5C67'   7F             C      	DB	7FH	;"
  5C68'   7B             C      	DB	7BH	;#
  5C69'   5B             C      	DB	5BH	;$
  5C6A'   6C             C      	DB	6CH	;%
  5C6B'   50             C      	DB	50H	;&
  5C6C'   7D             C      	DB	7DH	;'
  5C6D'   4D             C      	DB	4DH	;(
  5C6E'   5D             C      	DB	5DH	;)
  5C6F'   5C             C      	DB	5CH	;*
  5C70'   4E             C      	DB	4EH	;+
  5C71'   6B             C      	DB	6BH	;,
  5C72'   60             C      	DB	60H	;-
  5C73'   4B             C      	DB	4BH	;.
  5C74'   61             C      	DB	61H	;/
  5C75'   F0             C      	DB	0F0H	;0
  5C76'   F1             C      	DB	0F1H	;1
  5C77'   F2             C      	DB	0F2H	;2
  5C78'   F3             C      	DB	0F3H	;3
  5C79'   F4             C      	DB	0F4H	;4
  5C7A'   F5             C      	DB	0F5H	;5
  5C7B'   F6             C      	DB	0F6H	;6
  5C7C'   F7             C      	DB	0F7H	;7
  5C7D'   F8             C      	DB	0F8H	;8
  5C7E'   F9             C      	DB	0F9H	;9
  5C7F'   7A             C      	DB	7AH	;:
  5C80'   5E             C      	DB	5EH	;;
'Konvertierungen'	MACRO-80 3.44	09-Dec-81	PAGE	1-78


  5C81'   4C             C      	DB	4CH	;<
  5C82'   7E             C      	DB	7EH	;=
  5C83'   6E             C      	DB	6EH	;>
  5C84'   6F             C      	DB	6FH	;?
  5C85'   7C             C      	DB	7CH	;@
  5C86'   C1             C      	DB	0C1H	;A
  5C87'   C2             C      	DB	0C2H	;B
  5C88'   C3             C      	DB	0C3H	;C
  5C89'   C4             C      	DB	0C4H	;D
  5C8A'   C5             C      	DB	0C5H	;E
  5C8B'   C6             C      	DB	0C6H	;F
  5C8C'   C7             C      	DB	0C7H	;G
  5C8D'   C8             C      	DB	0C8H	;H
  5C8E'   C9             C      	DB	0C9H	;I
  5C8F'   D1             C      	DB	0D1H	;J
  5C90'   D2             C      	DB	0D2H	;K
  5C91'   D3             C      	DB	0D3H	;L
  5C92'   D4             C      	DB	0D4H	;M
  5C93'   D5             C      	DB	0D5H	;N
  5C94'   D6             C      	DB	0D6H	;O
  5C95'   D7             C      	DB	0D7H	;P
  5C96'   D8             C      	DB	0D8H	;Q
  5C97'   D9             C      	DB	0D9H	;R
  5C98'   E2             C      	DB	0E2H	;S
  5C99'   E3             C      	DB	0E3H	;T
  5C9A'   E4             C      	DB	0E4H	;U
  5C9B'   E5             C      	DB	0E5H	;V
  5C9C'   E6             C      	DB	0E6H	;W
  5C9D'   E7             C      	DB	0E7H	;X
  5C9E'   E8             C      	DB	0E8H	;Y
  5C9F'   E9             C      	DB	0E9H	;Z
  5CA0'   4A             C      	DB	4AH	;[
  5CA1'   E0             C      	DB	0E0H	;\
  5CA2'   5A             C      	DB	5AH	;]
  5CA3'   5F             C      	DB	5FH	;^
  5CA4'   6D             C      	DB	6DH	;_
  5CA5'   79             C      	DB	79H	;`
  5CA6'   81             C      	DB	81H	;a
  5CA7'   82             C      	DB	82H	;b
  5CA8'   83             C      	DB	83H	;c
  5CA9'   84             C      	DB	84H	;d
  5CAA'   85             C      	DB	85H	;e
  5CAB'   86             C      	DB	86H	;f
  5CAC'   87             C      	DB	87H	;g
  5CAD'   88             C      	DB	88H	;h
  5CAE'   89             C      	DB	89H	;i
  5CAF'   91             C      	DB	91H	;j
  5CB0'   92             C      	DB	92H	;k
  5CB1'   93             C      	DB	93H	;l
  5CB2'   94             C      	DB	94H	;m
  5CB3'   95             C      	DB	95H	;n
  5CB4'   96             C      	DB	96H	;o
  5CB5'   97             C      	DB	97H	;p
  5CB6'   98             C      	DB	98H	;q
  5CB7'   99             C      	DB	99H	;r
  5CB8'   A2             C      	DB	0A2H	;s
  5CB9'   A3             C      	DB	0A3H	;t
  5CBA'   A4             C      	DB	0A4H	;u
  5CBB'   A5             C      	DB	0A5H	;v
  5CBC'   A6             C      	DB	0A6H	;w
  5CBD'   A7             C      	DB	0A7H	;x
  5CBE'   A8             C      	DB	0A8H	;y
  5CBF'   A9             C      	DB	0A9H	;z
  5CC0'   C0             C      	DB	0C0H	;{
  5CC1'   6A             C      	DB	6AH	;|
  5CC2'   D0             C      	DB	0D0H	;}
  5CC3'   A1             C      	DB	0A1H	;~
  5CC4'   FF             C      	DB	0FFH	;DEL
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                         C      	TITLE	'Komprimierung'
                         C      	PAGE
'Komprimierung'	MACRO-80 3.44	09-Dec-81	PAGE	1-79


                         C      
                         C      ;	PN	CP
                         C      ;**********************************************************************
                         C      ;*       COMPR:    Komprimierung                                      *
                         C      ;*                 EDIT - F/Q-Format   --->  MRES20 - Quelltextformat *
                         C      ;**********************************************************************
                         C      			;
  5CC5'                  C      CP.COMPR	EQU	$	; A  Uebergabe/-nahme Zeichen
                         C      			; HL: Status von COMPR
                         C      			; B:  dekr. Tabulator-Zaehler
                         C      			;-------------------------------
                         C      			; OUTA: Einzelzeichen-Ausgabe
                         C      			;         (Zeichen in Reg. A)
                         C      ;----------------------------------------------------------------------
                         C      			;
  5CC5'   FE 1E          C      	CP	1EH	; NL ?
  5CC7'   28 01          C      	JR	Z,CP.NL
  5CC9'   E9             C      	JP	(HL)
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      			; Status "New-Line"
                         C      			;-------------------------------
  5CCA'                  C      CP.NL:
  5CCA'   CD 5A56'       C      	CALL	XY.INCDX	;         Satz-Zaehler + 1
  5CCD'   13             C      	DB	19
  5CCE'   06 03          C      	LD	B,3	;         noch 3 TAB erlaubt
  5CD0'   3E 0A          C      	LD	A,0AH	;         MRES20-NL
  5CD2'   18 04          C      	JR	CP.OUTT
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      			; Status "String"
                         C      			;-------------------------------
  5CD4'                  C      CP.STRNG:
  5CD4'   FE 27          C      	CP	27H	;         Apostroph
  5CD6'   20 20          C      	JR	NZ,CP.OUT
                         C      			;
  5CD8'                  C      CP.OUTT:
  5CD8'   21 5CE8'       C      	LD	HL,CP.TEXT	;         --> Status "Text"
  5CDB'   18 1B          C      	JR	CP.OUT
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      			; Status "Space"
                         C      			;-------------------------------
  5CDD'                  C      CP.SPACE:
  5CDD'   FE 20          C      	CP	' '
  5CDF'   C8             C      	RET	Z
  5CE0'   FE 09          C      	CP	09H	;         Tabulator
  5CE2'   C8             C      	RET	Z
  5CE3'   21 5CE8'       C      	LD	HL,CP.TEXT	;         ---> Status "Text"
  5CE6'   18 08          C      	JR	CP.TEXT+8
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      			; Status "Text"
                         C      			;-------------------------------
  5CE8'                  C      CP.TEXT:
  5CE8'   FE 20          C      	CP	' '
  5CEA'   28 2E          C      	JR	Z,CP.TAB
  5CEC'   FE 09          C      	CP	09H	;         Tabulator
  5CEE'   28 2A          C      	JR	Z,CP.TAB
  5CF0'   FE 3B          C      	CP	';'
  5CF2'   28 0B          C      	JR	Z,CP.SOKOM
  5CF4'   FE 27          C      	CP	27H	;         Apostroph
  5CF6'   28 1D          C      	JR	Z,CP.SOSTR
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      			; Status "Kom"
                         C      			;-------------------------------
  5CF8'                  C      CP.KOM	EQU	$
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      			; Einzelzeichen-Ausgabe u. Ret.
                         C      			;-------------------------------
  5CF8'                  C      CP.OUT:
  5CF8'   CD 5E14'       C      	CALL	UK.PUTK
  5CFB'   D9             C      	EXX
  5CFC'   0B             C      	DEC	BC
  5CFD'   D9             C      	EXX
  5CFE'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      			; Start "Kommentar"
                         C      			;-------------------------------
'Komprimierung'	MACRO-80 3.44	09-Dec-81	PAGE	1-80


  5CFF'                  C      CP.SOKOM:
  5CFF'   78             C          LD	A,B	;         0 oder 3 TAB vorher
  5D00'   FE 03          C          CP   3
  5D02'   28 0A          C          JR   Z,$+12
  5D04'   B7             C          OR   A
  5D05'   28 07          C          JR   Z,$+9      ;         ---+
  5D07'   3E 09          C          LD   A,09H      ;         <-+|
  5D09'   CD 5CF8'       C          CALL CP.OUT     ;           ||
  5D0C'   10 F9          C          DJNZ $-5        ;         --+|
  5D0E'   3E 3B          C          LD   A,';'      ;         <--+
  5D10'   21 5CF8'       C          LD   HL,CP.KOM
  5D13'   18 E3          C          JR   CP.OUT
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      			; Start "String"
                         C      			;-------------------------------
  5D15'                  C      CP.SOSTR:
  5D15'   21 5CD4'       C      	LD	HL,CP.STRNG
  5D18'   18 DE          C      	JR	CP.OUT
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      			; Tabulator-Behandlung
                         C      			;-------------------------------
  5D1A'                  C      CP.TAB:
  5D1A'   78             C      	LD	A,B
  5D1B'   B7             C      	OR	A
  5D1C'   3E 20          C      	LD	A,' '
  5D1E'   28 D8          C      	JR	Z,CP.OUT
  5D20'   05             C      	DEC	B
  5D21'   3E 09          C      	LD	A,09H	;         Tabulator MRES20
  5D23'   21 5CDD'       C      	LD	HL,CP.SPACE
  5D26'   18 D0          C      	JR	CP.OUT
                         C      			;
                         C      ;**********************************************************************
                         C      			;
  5D28'                  C      CP.INIT:
  5D28'   06 03          C      	LD	B,3	; Initialisierung COMPR
  5D2A'   21 5CE8'       C      	LD	HL,CP.TEXT
  5D2D'   C9             C      	RET
                         C      			;
                         C      ;**********************************************************************
                         C      ;	END
                         C      	TITLE	'Dekomprimierung'
                         C      	PAGE
'Dekomprimierung'	MACRO-80 3.44	09-Dec-81	PAGE	1-81


                         C      
                         C      ;	PN	DC
                         C      ;**********************************************************************
                         C      ;*       DCMPR:    Dekomprimierung                                    *
                         C      ;*                 MRES20-Quelltexte   --->   EDIT - Format F         *
                         C      ;**********************************************************************
                         C      			;
  5D2E'                  C      DC.DCMPR	EQU	$
                         C      			; A:  Uebergabe/-nahme Zeichen
                         C      			; HL: Status-Register DCMPR
                         C      			; B:  Position (Spalte)
                         C      			;-------------------------------
                         C      			; INA: Einzelzeichen-Eingabe
                         C      			;      nach Reg. A
                         C      ;        --------------------------------------------------------------
  5D2E'   04             C      	INC	B	;         Position + 1
  5D2F'   E9             C      	JP	(HL)
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      			; Status "Neue Zeile"
                         C      			;-------------------------------
  5D30'                  C      DC.NL:
  5D30'   CD 5A56'       C      	CALL	XY.INCDX	;         Satzzaehler + 1
  5D33'   13             C      	DB	19
  5D34'   3E 1E          C      	LD	A,1EH	;         EDIT-New-Line
  5D36'   06 01          C      	LD	B,1	;         Pos.=1
  5D38'   21 5D3C'       C      	LD	HL,DC.TEXT	;         Status "TEXT"
  5D3B'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      			; Status "Text"
                         C      			;-------------------------------
  5D3C'                  C      DC.TEXT:
  5D3C'   CD 5D6F'       C      	CALL	UK.GETK	;         Einzelzeichen-Eingabe
  5D3F'   B7             C      	OR	A
  5D40'   C8             C      	RET	Z
  5D41'   FE 0A          C      	CP	0AH	;         NL ?
  5D43'   28 EB          C      	JR	Z,DC.NL
  5D45'   FE 09          C      	CP	09H	;         TAB ?
  5D47'   28 01          C      	JR	Z,DC.TAB
  5D49'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      			; Tabulator-Behandlung
                         C      			;-------------------------------
  5D4A'                  C      DC.TAB:
  5D4A'   78             C      	LD	A,B
  5D4B'   FE 28          C      	CP	40
  5D4D'   D0             C      	RET	NC
  5D4E'   21 5D54'       C      	LD	HL,DC.SPACE	;         ---> Status "Space"
  5D51'   3E 20          C      	LD	A,' '	;         anstelle TAB Space
  5D53'   C9             C      	RET
                         C      			;
                         C      ;        --------------------------------------------------------------
                         C      			; Status "Space"
                         C      			;-------------------------------
  5D54'                  C      DC.SPACE:
  5D54'   78             C      	LD	A,B
  5D55'   FE 0B          C      	CP	10+1
  5D57'   28 0B          C      	JR	Z,DC.EOSPC
  5D59'   FE 11          C      	CP	16+1
  5D5B'   28 07          C      	JR	Z,DC.EOSPC
  5D5D'   FE 24          C      	CP	35+1
  5D5F'   28 03          C      	JR	Z,DC.EOSPC
  5D61'   3E 20          C      	LD	A,' '
  5D63'   C9             C      	RET
                         C      			;
  5D64'                  C      DC.EOSPC:
  5D64'   21 5D3C'       C      	LD	HL,DC.TEXT	; TAB-Position erreicht
  5D67'   18 D3          C      	JR	DC.TEXT
                         C      			;
                         C      			;
                         C      ;**********************************************************************
  5D69'                  C      DC.INIT:
  5D69'   21 5D3C'       C      	LD	HL,DC.TEXT	; Initialisierung
  5D6C'   06 01          C      	LD	B,1
  5D6E'   C9             C      	RET
                         C      			;
                         C      ;**********************************************************************
                         C      ;	END
                         C      	TITLE	'Einzelzeicheneingabe fuer KMBG'
                         C      	PAGE
'Einzelzeicheneingabe fuer KMBG'	MACRO-80 3.44	09-Dec-81	PAGE	1-82


                         C      
                         C      ;	PN	UK
                         C      ;----------------------------------------------------------------------
                         C      ;
                         C      ;        Einzelzeicheneingabe fuer KMBG
                         C      ;
                         C      ;----------------------------------------------------------------------
                         C      ;
  5D6F'                  C      UK.GETK:
  5D6F'   CD 581C'       C      	CALL	U1.RSAVE
  5D72'   CD 5A26'       C      	CALL	XY.LIDX	;HL:= Blocklaenge
  5D75'   07             C      	DB	7
  5D76'   E5             C      	PUSH	HL
  5D77'   CD 5A16'       C      	CALL	XY.LDDX
  5D7A'   17             C      	DB	23
  5D7B'   EB             C      	EX	DE,HL	;DE:= Pufferzaehler
  5D7C'   AF             C      	XOR	A
  5D7D'   E1             C      	POP	HL	;HL:= Blocklaenge
  5D7E'   ED 52          C      	SBC	HL,DE
  5D80'   E5             C      	PUSH	HL	;Restbyteanzahl retten
  5D81'   7C             C      	LD	A,H
  5D82'   B5             C      	OR	L
  5D83'   CC 5DCF'       C      	CALL	Z,UK.KBW	;Block lesen
  5D86'   E1             C      	POP	HL
  5D87'   AF             C      	XOR	A
  5D88'   BC             C      	CP	H
  5D89'   20 05          C      	JR	NZ,UK.GETK2
  5D8B'   7D             C      	LD	A,L
  5D8C'   FE 01          C      	CP	1
  5D8E'   28 08          C      	JR	Z,UK.GETK3	;---> letztes Datenbyte des
  5D90'                  C      UK.GETK2:
  5D90'   CD 5D9E'       C      	CALL	UK.GETK4
  5D93'   B7             C      	OR	A
  5D94'                  C      UK.GETK5:
  5D94'   CD 5824'       C      	CALL	U1.RRST
  5D97'   C9             C      	RET
                         C      ;
                         C      ;
  5D98'                  C      UK.GETK3:
  5D98'   CD 5D9E'       C      	CALL	UK.GETK4
  5D9B'   37             C      	SCF
  5D9C'   18 F6          C      	JR	UK.GETK5
                         C      ;
  5D9E'                  C      UK.GETK4:
  5D9E'   CD 5A16'       C      	CALL	XY.LDDX	;HL:= aktuelle Pufferadresse
  5DA1'   15             C      	DB	21
  5DA2'   7E             C      	LD	A,(HL)	;Datenbyte laden
  5DA3'   CD 5A56'       C      	CALL	XY.INCDX	;Pufferzeiger erhoehen
  5DA6'   15             C      	DB	21
  5DA7'   CD 5A56'       C      	CALL	XY.INCDX	;Pufferzaehler erhoehen
  5DAA'   17             C      	DB	23
  5DAB'   C9             C      	RET
                         C      ;
                         C      ;******************************************************************
                         C      ;
                         C      ;        KMBG  Eingabepuffer bereitstellen
                         C      ;
                         C      ;*******************************************************************
                         C      ;
  5DAC'                  C      UK.KLPFB:
  5DAC'   CD 581C'       C      	CALL	U1.RSAVE
  5DAF'   CD 5918'       C      	CALL	U1.KTIN1
  5DB2'   21 0100        C      	LD	HL,100H	;max. Blocklaenge Kassette
  5DB5'   CD 5A46'       C      	CALL	XY.STIDX	;max. Blocklaenge initialisieren
  5DB8'   07             C      	DB	7
  5DB9'   E5             C      	PUSH	HL
  5DBA'   C1             C      	POP	BC	;BC:= Blocklaenge
  5DBB'   CD 5A36'       C      	CALL	XY.STDX	;Pufferzaehler "Leer"
  5DBE'   17             C      	DB	23
  5DBF'   21 0E66        C      	LD	HL,UE.PUF	;Systempuffer Kassette
  5DC2'   CD 582D'       C      	CALL	U1.CLRB	;Systempuffer loeschen
  5DC5'   21 8010        C      	LD	HL,UE.KPUFF
  5DC8'   CD 582D'       C      	CALL	U1.CLRB
  5DCB'   CD 5824'       C      	CALL	U1.RRST
  5DCE'   C9             C      	RET
                         C      ;
                         C      ;******************************************************************
                         C      ;
                         C      ;        Einlesen eines Blockes von Kassette
                         C      ;
                         C      ;         - Besonderheit gegenueber MBW: Blockinhalt wird vom
                         C      ;           Systempuffer in den E/A-Puffer uebertragen
'Einzelzeicheneingabe fuer KMBG'	MACRO-80 3.44	09-Dec-81	PAGE	1-83


                         C      ;
                         C      ;*******************************************************************
                         C      ;
  5DCF'                  C      UK.KBW:
  5DCF'   CD 581C'       C      	CALL	U1.RSAVE
  5DD2'   CD 5DAC'       C      	CALL	UK.KLPFB
  5DD5'   DD 36 04 02    C      	LD	(IX+4),02H
  5DD9'   CD 4266'       C      	CALL	UF.EXEC
  5DDC'   DD 7E 09       C      	LD	A,(IX+9)
  5DDF'   DD B6 0A       C      	OR	(IX+10)
  5DE2'   28 2A          C      	JR	Z,UK.KBW1	;EOF
  5DE4'   CD 5A16'       C      	CALL	XY.LDDX	;HL:= Blockadresse
  5DE7'   07             C      	DB	7
  5DE8'   DD 46 09       C      	LD	B,(IX+9)	;BC:= Blocklaenge
  5DEB'   DD 4E 0A       C      	LD	C,(IX+10)
  5DEE'   E5             C      	PUSH	HL	;E/A-Puffer
  5DEF'   CD 5A16'       C      	CALL	XY.LDDX
  5DF2'   19             C      	DB	25
  5DF3'   EB             C      	EX	DE,HL
  5DF4'   E1             C      	POP	HL
  5DF5'   ED B0          C      	LDIR		;Transport in E/A-Puffer
  5DF7'   CD 5A16'       C      	CALL	XY.LDDX
  5DFA'   19             C      	DB	25
  5DFB'   CD 5A36'       C      	CALL	XY.STDX	;Pufferzeiger auf Anfang
  5DFE'   15             C      	DB	21
  5DFF'   21 0000        C      	LD	HL,0
  5E02'   CD 5A36'       C      	CALL	XY.STDX	;Pufferzaehler rueckstellen
  5E05'   17             C      	DB	23
  5E06'   CD 5A56'       C      	CALL	XY.INCDX	;Blockzaehler incrementieren
  5E09'   11             C      	DB	17
  5E0A'                  C      UK.KBW2:
  5E0A'   CD 5824'       C      	CALL	U1.RRST
  5E0D'   C9             C      	RET
                         C      ;
  5E0E'                  C      UK.KBW1:
  5E0E'   CD 5A56'       C      	CALL	XY.INCDX	;Labelzaehler incrementieren
  5E11'   11             C      	DB	17
  5E12'   18 F6          C      	JR	UK.KBW2
                         C      ;
                         C      ;********************************************************************
                         C      ;
                         C      ;        Einzelzeichenausgabe fuer KMBG
                         C      ;
                         C      ;*********************************************************************
                         C      ;
  5E14'                  C      UK.PUTK:
  5E14'   CD 581C'       C      	CALL	U1.RSAVE
  5E17'   F5             C      	PUSH	AF	;Zeichen retten
  5E18'   CD 5A16'       C      	CALL	XY.LDDX	;HL:= Pufferzaehler
  5E1B'   17             C      	DB	23
  5E1C'   01 0132        C      	LD	BC,UE.KMPUL	;BC:= max. Pufferlaenge
  5E1F'   B7             C      	OR	A
  5E20'   ED 42          C      	SBC	HL,BC
  5E22'   3F             C      	CCF
  5E23'   CC 5E5D'       C      	CALL	Z,UK.KBA	;---> Puffer voll
  5E26'   F1             C      	POP	AF	;Zeichen auskellern
  5E27'   CD 5A16'       C      	CALL	XY.LDDX
  5E2A'   15             C      	DB	21
  5E2B'   77             C      	LD	(HL),A	;Zeichen in Puffer eintragen
  5E2C'   CD 5A56'       C      	CALL	XY.INCDX	;Pufferzeiger erhoehen
  5E2F'   15             C      	DB	21
  5E30'   CD 5A56'       C      	CALL	XY.INCDX	;Pufferzaehler erhoehen
  5E33'   17             C      	DB	23
  5E34'   CD 5824'       C      	CALL	U1.RRST
  5E37'   C9             C      	RET
                         C      ;
                         C      ;******************************************************************
                         C      ;
                         C      ;        Ausgabepufferbereitstellung fuer KMBG
                         C      ;
                         C      ;*******************************************************************
                         C      ;
  5E38'                  C      UK.KSPFB:
  5E38'   CD 581C'       C      	CALL	U1.RSAVE
  5E3B'   CD 5918'       C      	CALL	U1.KTIN1
  5E3E'   CD 5A26'       C      	CALL	XY.LIDX
  5E41'   07             C      	DB	7
  5E42'   E5             C      	PUSH	HL
  5E43'   C1             C      	POP	BC	;BC:= Blocklaenge
  5E44'   21 0000        C      	LD	HL,0
  5E47'   CD 5A36'       C      	CALL	XY.STDX	;Pufferzaehler = 0
  5E4A'   17             C      	DB	23
  5E4B'   CD 5A16'       C      	CALL	XY.LDDX
'Einzelzeicheneingabe fuer KMBG'	MACRO-80 3.44	09-Dec-81	PAGE	1-84


  5E4E'   19             C      	DB	25
  5E4F'   CD 5A36'       C      	CALL	XY.STDX	;Pufferzeiger setzen
  5E52'   15             C      	DB	21
  5E53'   21 0E66        C      	LD	HL,UE.PUF
  5E56'   CD 582D'       C      	CALL	U1.CLRB
  5E59'   CD 5824'       C      	CALL	U1.RRST
  5E5C'   C9             C      	RET
                         C      ;
                         C      ;*******************************************************************
                         C      ;
                         C      ;        Ausgabe eines Blockes auf KMBG
                         C      ;
                         C      ;*******************************************************************
                         C      ;
  5E5D'                  C      UK.KBA:
  5E5D'   CD 581C'       C      	CALL	U1.RSAVE
  5E60'   CD 5E38'       C      	CALL	UK.KSPFB
  5E63'   CD 5A16'       C      	CALL	XY.LDDX
  5E66'   07             C      	DB	7
  5E67'   EB             C      	EX	DE,HL	;DE:= Blockadresse
  5E68'   D5             C      	PUSH	DE	;Blockadresse retten
  5E69'   CD 5A26'       C      	CALL	XY.LIDX
  5E6C'   09             C      	DB	9
  5E6D'   E5             C      	PUSH	HL
  5E6E'   C1             C      	POP	BC	;BC:= Blocklaenge
  5E6F'   D1             C      	POP	DE	;DE:= Blockadresse
  5E70'   C5             C      	PUSH	BC	;Blocklaenge retten
  5E71'   CD 5A16'       C      	CALL	XY.LDDX	;HL:= E/A-Pufferanfang
  5E74'   19             C      	DB	25
  5E75'   ED B0          C      	LDIR		;Block in Systempuffer
  5E77'   C1             C      	POP	BC	;BC:= Blocklaenge
  5E78'   E5             C      	PUSH	HL	;aktuelle Pufferadresse retten
  5E79'   21 0132        C      	LD	HL,UE.KMPUL	;HL:= max. Laenge
  5E7C'   B7             C      	OR	A
  5E7D'   ED 42          C      	SBC	HL,BC	;HL:= Restbyteanzahl
  5E7F'   CD 5A36'       C      	CALL	XY.STDX	;Pufferzaehler setzen
  5E82'   17             C      	DB	23
  5E83'   E5             C      	PUSH	HL
  5E84'   C1             C      	POP	BC	;BC:= Restbyteanzahl
  5E85'   CD 5A16'       C      	CALL	XY.LDDX	;HL:= aktuelle Pufferadresse
  5E88'   19             C      	DB	25
  5E89'   EB             C      	EX	DE,HL	;DE:= Pufferanfang
  5E8A'   E1             C      	POP	HL
  5E8B'   ED B0          C      	LDIR
  5E8D'   EB             C      	EX	DE,HL	;HL:= aktuelle Pufferadresse
  5E8E'   CD 5A36'       C      	CALL	XY.STDX	;Pufferzeiger setzen
  5E91'   15             C      	DB	21
  5E92'   DD 36 04 00    C      	LD	(IX+4),00H
  5E96'   CD 4266'       C      	CALL	UF.EXEC	;physische Blockausgabe
  5E99'   F5             C      	PUSH	AF
  5E9A'   CD 5A56'       C      	CALL	XY.INCDX	;Blockzaehler erhoehen
  5E9D'   11             C      	DB	17
  5E9E'   F1             C      	POP	AF
  5E9F'   CD 5824'       C      	CALL	U1.RRST
  5EA2'   C9             C      	RET
                         C      ;----------------------------------------------------------------------
                         C      ;	END
                                ;
                                ;	INCLUDE KM.ASM
                                
                                	TITLE ''
                                	END
''	MACRO-80 3.44	09-Dec-81	PAGE	S


Macros:

Symbols:
0001 	BC.AGG          0000 	BC.EGG          FA3A 	BC.END          
E000 	BC.TAB1         F902 	BC.TAB2         F96A 	BC.TAB2A        
F9D2 	BC.TAB3         E002 	BC.VTABA        EC82 	BC.VTABE        
5CC5'	CP.COMPR        5D28'	CP.INIT         5CF8'	CP.KOM          
5CCA'	CP.NL           5CF8'	CP.OUT          5CD8'	CP.OUTT         
5CFF'	CP.SOKOM        5D15'	CP.SOSTR        5CDD'	CP.SPACE        
5CD4'	CP.STRNG        5D1A'	CP.TAB          5CE8'	CP.TEXT         
40F5'	CRC0            40F9'	CRC1            410C'	CRC2            
5D2E'	DC.DCMPR        5D64'	DC.EOSPC        5D69'	DC.INIT         
5D30'	DC.NL           5D54'	DC.SPACE        5D4A'	DC.TAB          
5D3C'	DC.TEXT         4DB1'	FD.BMGF         4AD9'	FD.DASU         
4C13'	FD.DECBZ        4CCB'	FD.DECHL        4D8B'	FD.DSPBB        
4D9B'	FD.DSPBG        4D40'	FD.END          4D69'	FD.FDIN2        
4B26'	FD.FDINP        4B79'	FD.FDOUT        4BDD'	FD.FDOW1        
4BE1'	FD.FDOW2        4C06'	FD.FDOW3        4BF8'	FD.FDOW4        
4BCD'	FD.FDOWR        4C1D'	FD.FDUP         4D47'	FD.FOLWR        
4CD4'	FD.FOUT1        4C60'	FD.FSTRT        4AD2'	FD.KO01         
4ABA'	FD.POSK         4DA5'	FD.RDEND        4B6D'	FD.SDIN         
4C50'	FD.SDK0         4C5A'	FD.SDK1         4C46'	FD.SDK2         
4BC7'	FD.SDOUT        4C36'	FD.SDOW         4CAD'	FD.SETJ         
4CC5'	FD.SETN         4C98'	FD.STRT1        4AF5'	FD.WRRES        
4000'	K1.BRKMB        40F2'	K1.CRC          4041'	KERN            
49E3'	KH.ANZB1        49E0'	KH.ANZBL        49FF'	KH.AZ1Z         
4A30'	KH.AZ4B0        4A51'	KH.AZ4B1        4A40'	KH.AZ4B3        
4A2C'	KH.AZ4BY        4A23'	KH.AZADR        49EF'	KH.AZBL1        
49EA'	KH.AZBLD        4AAC'	KH.BILO         4A6A'	KH.BLEV1        
4A6C'	KH.BLEV2        4A55'	KH.BLEVG        4AA4'	KH.KBRS         
495F'	KH.RD1          49C6'	KH.RD2          4975'	KH.RD3          
4985'	KH.RD4          497E'	KH.RD6          49CF'	KH.RDBM         
4951'	KH.RDSTA        495C'	KH.RES          49C2'	KH.SYSRT        
4A7E'	KH.WRSTA        4618'	KI.KM           45F1'	KI.KN           
467C'	KI.KO03         4608'	KI.NMR          465E'	KI.VERZ         
40E8'	KOMED           41CF'	KR.CKRA         411E'	KR.GR1          
4128'	KR.GR2          412A'	KR.GR3          41D3'	KR.KARO         
425B'	KR.TYPT         41D7'	KR.VORSP        55FE'	KU.DD           
55FB'	KU.DECIY        5596'	KU.TAB2L        558D'	KU.VVOR         
55CE'	KU.ZEIR         46F9'	KV.ANF          491C'	KV.ANZ          
47C9'	KV.AUSG         4932'	KV.AVZS         48A4'	KV.BSTR         
4907'	KV.DBCVM        488C'	KV.DRU          488A'	KV.DRU1         
4899'	KV.KO02         483E'	KV.KRW          4872'	KV.P1           
4912'	KV.SBC          48D1'	KV.SPTR         4762'	KV.TABTR        
47A8'	KV.ZEIHO        472D'	KV.ZLTR         52AD'	KX.ENDR         
52CC'	KX.EXEC2        52A2'	KX.RSPFR        52FC'	KX.UPA          
5586'	KY.AJ           53A8'	KY.ATAA         53CB'	KY.ATAB         
53DC'	KY.ATABE        546D'	KY.COPY         5337'	KY.DFR          
551A'	KY.EOV          5429'	KY.EVZ          542C'	KY.EVZ1         
5559'	KY.EWK          53A5'	KY.EZYK1        5569'	KY.JHL          
54CD'	KY.KOP          54E7'	KY.KOPAN        54C7'	KY.KOPV         
5319'	KY.MD           539F'	KY.NDA          5410'	KY.NE           
5572'	KY.SATR         5391'	KY.SVGL         5491'	KY.VSCHR        
5444'	KY.VSTR         5386'	KY.VZVGL        53EA'	KY.WEI          
53FE'	KY.ZYK          4DF9'	LD.DATFU        4DD4'	LD.DATN         
4E1A'	LD.DATPO        4E95'	LD.LAD1         4E84'	LD.LAD2         
4E81'	LD.LADER        4EAA'	LD.LADF         4DE9'	LD.LD2          
4DF3'	LD.LD21         4E7C'	LD.LD3          4E3A'	LD.LD4          
4E55'	LD.LD5          4EA1'	LD.LDEND        4E72'	LD.START        
5674'	POSIK1          4EB0'	RL.BEG          4FBC'	RL.BF           
4FA8'	RL.DATNV        4FA3'	RL.ECHO         4FBE'	RL.FMELD        
4F41'	RL.M10          4F52'	RL.M11          4EE1'	RL.M12          
4F1F'	RL.M13          4F2F'	RL.M14          4F37'	RL.M15          
4ED0'	RL.M16          4EFE'	RL.M17          4F65'	RL.M21          
4FB8'	RL.MN           4FAC'	RL.OB           4FB0'	RL.RA           
4FB4'	RL.SV           4EC5'	RL.UG           4F58'	RL.UP6          
40E1'	RLAD            40DA'	RRET            40D6'	STF07           
40CC'	STF99           40D3'	STFRS           408A'	STT02           
40A8'	STT08           4062'	STT11           4062'	STT15           
4062'	STT21           4062'	STT31           4062'	STT41           
407B'	STT5            406E'	STT51           4072'	STT61           
4076'	STT71           4076'	STT75           50CC'	SV.BYANZ        
515D'	SV.DALO1        4FFA'	SV.DATN         50D7'	SV.DATS1        
5011'	SV.DATV1        5019'	SV.DATVO        50F1'	SV.SAVE         
5102'	SV.SAVE1        5053'	SV.SAVE3        5068'	SV.SAVE4        
50B0'	SV.SAVE5        50A6'	SV.SAVE6        5155'	SV.STAD0        
4FED'	SV.SV20         5005'	SV.SV21         501F'	SV.SV30         
5039'	SV.SV31         5027'	SV.SV37         5145'	SV.SVEN1        
5142'	SV.SVEN2        5119'	SV.SVLS         5135'	SV.SVLS1        
511F'	SV.SVLS2        5168'	SV.SVSZ         517C'	SV.SVSZ1        
516A'	SV.SVSZ2        5893'	U1.AUS          59C6'	U1.BILO         
5847'	U1.BREAD        5852'	U1.BWRIT        582D'	U1.CLRB         
''	MACRO-80 3.44	09-Dec-81	PAGE	S-1


5861'	U1.COPB         585D'	U1.COPB2        58B3'	U1.DSVG         
588A'	U1.EIN          59C0'	U1.INFO         583C'	U1.KBR4         
59FB'	U1.KRWE         5918'	U1.KTIN1        58FF'	U1.KTINI        
58E4'	U1.NMVGL        59E4'	U1.PRADR        5824'	U1.RRST         
581C'	U1.RSAVE        59BB'	U1.TR           59DA'	U1.TST          
592D'	U1.VERIN        5935'	U1.VERNI        5957'	U1.VORS1        
594F'	U1.VORST        589C'	U1.VS1          58A3'	U1.VSX          
5963'	U1.VZS          5846'	U1.WAIT         4589'	UA.ALTR         
4570'	UA.ANZWD        4459'	UA.BMGF         446A'	UA.DF           
4463'	UA.DOK          432A'	UA.DS           43E7'	UA.EABFR        
4453'	UA.FRZ          43A2'	UA.GER          434A'	UA.KNAME        
4370'	UA.KOMMT        43B1'	UA.KOPFR        4545'	UA.LD           
435D'	UA.NR           44BD'	UA.STADR        441D'	UA.VORH         
4383'	UA.Z7E          4497'	UA.ZKBEG        4516'	UA.ZKBEL        
4529'	UA.ZKBLG        453C'	UA.ZKBM         4471'	UA.ZKDAT        
44D0'	UA.ZKDL         44AA'	UA.ZKEND        44E3'	UA.ZKF          
4484'	UA.ZKLAD        44EE'	UA.ZKRES        4501'	UA.ZKSDT        
4557'	UA.ZRSCH        2B64'	UB.DTAB         2B8D'	UB.END          
2B01'	UB.KTAB         2B1C'	UB.PAR1         2B1E'	UB.PAR2         
2B20'	UB.PAR3         2B22'	UB.PAR4         2B24'	UB.PAR5         
2B26'	UB.PATAB        2B2A'	UB.SATZ         2B00'	UB.ZN           
5C05'	UC.ASCCO        5BE2'	UC.CKONV        5AAE'	UC.CVABX        
5AC9'	UC.CVAX         5ADD'	UC.CVAXB        5BA5'	UC.CVBC         
5B35'	UC.CVBD         5B40'	UC.CVBD0        5B33'	UC.CVBD1        
5B2F'	UC.CVBD2        5B2B'	UC.CVBD3        5B27'	UC.CVBD4        
5B23'	UC.CVBD5        5AB8'	UC.CVBX         5BB6'	UC.CVCB         
5B9D'	UC.CVD1B        5B74'	UC.CVDB         5AD4'	UC.CVHLX        
5AFF'	UC.CVX1B        5B18'	UC.CVXA         5AEE'	UC.CVXB         
5B08'	UC.CVXER        5AA0'	UC.DIVR         5BD7'	UC.DK1          
5BEB'	UC.DK2          5C65'	UC.DKOI         5BC3'	UC.DKONV        
5A87'	UC.HL10C        5A80'	UC.HL10N        5BCD'	UC.KONV         
5C01'	UC.KONV2        4000'	UE.BRKMB        3000 	UE.BWSA         
0060 	UE.COTAL        40F2'	UE.CRC          0DC4 	UE.EDEND        
0132 	UE.KMPUL        8010 	UE.KPUFF        7C00 	UE.PRINT        
0E66 	UE.PUF          0CFE 	UE.STANF        007D 	UE.SVL          
000B 	UE.SYSTB        00F7 	UE.TACL         00F9 	UE.TACR         
001E 	UE.TAQUI        6EE6 	UE.TARO         00CD 	UE.TASYS        
8830 	UE.TEXAN        0E5A 	UE.ZEIN         42CC'	UF.AZVB         
4301'	UF.BEHB         4309'	UF.BEHB1        4280'	UF.ERANZ        
4266'	UF.EXEC         4275'	UF.EXEC1        431E'	UF.FL14         
4321'	UF.FL16         431B'	UF.FL17         430F'	UF.FL18         
4261'	UF.RET          42BC'	UF.SYS          42C8'	UF.SYS1         
5D6F'	UK.GETK         5D90'	UK.GETK2        5D98'	UK.GETK3        
5D9E'	UK.GETK4        5D94'	UK.GETK5        5E5D'	UK.KBA          
5DCF'	UK.KBW          5E0E'	UK.KBW1         5E0A'	UK.KBW2         
5DAC'	UK.KLPFB        5E38'	UK.KSPFB        5E14'	UK.PUTK         
57D0'	UR.ALPH1        57C7'	UR.ALPHA        57DB'	UR.ALPNU        
570B'	UR.BBSA1        5703'	UR.BBSAD        580C'	UR.BILR1        
57FA'	UR.BILRO        56A0'	UR.BM           5713'	UR.DSPZK        
57E5'	UR.HEXAZ        57F2'	UR.HEXZ1        564D'	UR.KBM          
565F'	UR.KBR          5659'	UR.KBV          5647'	UR.KLR          
5641'	UR.KLV          563B'	UR.KRA          5629'	UR.KRE          
562D'	UR.KRE1         5631'	UR.KRW          5637'	UR.KRWW         
5653'	UR.KSL          5679'	UR.LES          56D1'	UR.MIMO         
56ED'	UR.MIMO1        56E5'	UR.MIMO2        56F4'	UR.MIMO3        
57D2'	UR.NUM          56AE'	UR.OK           566E'	UR.POSIK        
575E'	UR.RET0         5665'	UR.RPOS         56CD'	UR.RSP          
57F4'	UR.TAREP        5768'	UR.TCL          5778'	UR.TCLN         
577B'	UR.TCR          578A'	UR.TCRN         5794'	UR.TQUIT        
578C'	UR.TSYS         5720'	UR.ZINP         5726'	UR.ZINP1        
5728'	UR.ZINP2        5754'	UR.ZINP3        5759'	UR.ZINP4        
5742'	UR.ZINP5        5761'	UR.ZINP7        57C2'	UR.ZKON1        
579C'	UR.ZKONT        5A02'	XY.CALP1        5A0B'	XY.CALPE        
5A56'	XY.INCDX        5A6F'	XY.JMPDX        5A16'	XY.LDDX         
5A26'	XY.LIDX         5A36'	XY.STDX         5A46'	XY.STIDX        



No Fatal error(s)


    
577B'	UR.TCR          578A'	UR.TCRN         5794'	UR.TQUIT        
578C'	UR.TSYS         5720'	UR.ZINP         5726'	UR